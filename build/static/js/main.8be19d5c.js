/*! For license information please see main.8be19d5c.js.LICENSE.txt */
(()=>{var e={219:(e,t,n)=>{"use strict";var r=n(3763),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function l(e){return r.isMemo(e)?o:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=o;var u=Object.defineProperty,c=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(f){var i=p(n);i&&i!==f&&e(t,i,r)}var o=c(n);h&&(o=o.concat(h(n)));for(var a=l(t),m=l(n),g=0;g<o.length;++g){var v=o[g];if(!s[v]&&(!r||!r[v])&&(!m||!m[v])&&(!a||!a[v])){var y=d(n,v);try{u(t,v,y)}catch(b){}}}}return t}},457:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A});var r=n(7868)},528:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler");Symbol.for("react.provider");var a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.for("react.offscreen"),m=Symbol.for("react.client.reference");function g(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case o:case s:case c:case h:return e;default:switch(e=e&&e.$$typeof){case l:case u:case p:case d:case a:return e;default:return t}}case r:return t}}}t.vM=u,t.lD=d},551:()=>{},579:(e,t,n)=>{"use strict";e.exports=n(1153)},869:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});n(5043);var r=n(3290),i=n(579);function s(e){const{styles:t,defaultTheme:n={}}=e,s="function"===typeof t?e=>{return t(void 0===(r=e)||null===r||0===Object.keys(r).length?n:e);var r}:t;return(0,i.jsx)(r.mL,{styles:s})}},918:(e,t,n)=>{"use strict";function r(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}n.d(t,{A:()=>r})},1153:(e,t,n)=>{"use strict";var r=n(5043),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,s={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:u,ref:c,props:s,_owner:a.current}}t.Fragment=s,t.jsx=u,t.jsxs=u},1188:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,n))}},1234:()=>{},1722:(e,t,n)=>{"use strict";n.d(t,{Rk:()=>r,SF:()=>i,sk:()=>s});function r(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):n&&(r+=n+" ")})),r}var i=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},s=function(e,t,n){i(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var s=t;do{e.insert(t===s?"."+r:"",s,e.sheet,!0),s=s.next}while(void 0!==s)}}},2374:(e,t,n)=>{"use strict";t.A=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(5043)),i=n(3174);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}t.A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=r.useContext(i.ThemeContext);return t&&(n=t,0!==Object.keys(n).length)?t:e;var n}},2430:function(e,t,n){var r;!function(i,s,o){var a,l=256,u=o.pow(l,6),c=o.pow(2,52),h=2*c,d=255;function p(e,t,n){var r=[],d=v(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(s)]:null==e?function(){try{var e;return a&&(e=a.randomBytes)?e=e(l):(e=new Uint8Array(l),(i.crypto||i.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=i.navigator,n=t&&t.plugins;return[+new Date,i,n,i.screen,y(s)]}}():e,3),r),p=new f(r),b=function(){for(var e=p.g(6),t=u,n=0;e<c;)e=(e+n)*l,t*=l,n=p.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|p.g(4)},b.quick=function(){return p.g(4)/4294967296},b.double=b,v(y(p.S),s),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,p),e.state=function(){return m(p,{})}),n?(o.random=e,t):e})(b,d,"global"in t?t.global:this==o,t.state)}function f(e){var t,n=e.length,r=this,i=0,s=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);i<l;)o[i]=i++;for(i=0;i<l;i++)o[i]=o[s=d&s+e[i%n]+(t=o[i])],o[s]=t;(r.g=function(e){for(var t,n=0,i=r.i,s=r.j,o=r.S;e--;)t=o[i=d&i+1],n=n*l+o[d&(o[i]=o[s=d&s+t])+(o[s]=t)];return r.i=i,r.j=s,n})(l)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n,r=[],i=typeof e;if(t&&"object"==i)for(n in e)try{r.push(g(e[n],t-1))}catch(s){}return r.length?r:"string"==i?e:e+"\0"}function v(e,t){for(var n,r=e+"",i=0;i<r.length;)t[d&i]=d&(n^=19*t[d&i])+r.charCodeAt(i++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(v(o.random(),s),e.exports){e.exports=p;try{a=n(1234)}catch(b){}}else void 0===(r=function(){return p}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2730:(e,t,n)=>{"use strict";var r=n(5043),i=n(8853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(f,e)||!h.call(p,e)&&(d.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),T=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),_=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function F(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var M,L=Object.assign;function P(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var z=!1;function B(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?P(e):""}function U(e){switch(e.tag){case 5:return P(e.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case k:return"Portal";case C:return"Profiler";case I:return"StrictMode";case A:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case $:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return W(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function j(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=j(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Q(e,t);var n=j(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,j(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+j(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:j(n)}}function se(e,t){var n=j(t.value),r=j(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,he=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Se=null,Ie=null;function Ce(e){if(e=bi(e)){if("function"!==typeof ke)throw Error(s(280));var t=e.stateNode;t&&(t=wi(t),ke(e.stateNode,e.type,t))}}function Ee(e){Se?Ie?Ie.push(e):Ie=[e]:Se=e}function Te(){if(Se){var e=Se,t=Ie;if(Ie=Se=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ne(e,t){return e(t)}function Ae(){}var Re=!1;function $e(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ne(e,t,n)}finally{Re=!1,(null!==Se||null!==Ie)&&(Ae(),Te())}}function _e(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Oe=!1;if(c)try{var De={};Object.defineProperty(De,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ce){Oe=!1}function Fe(e,t,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Me=!1,Le=null,Pe=!1,ze=null,Be={onError:function(e){Me=!0,Le=e}};function Ue(e,t,n,r,i,s,o,a,l){Me=!1,Le=null,Fe.apply(Be,arguments)}function We(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function je(e){if(We(e)!==e)throw Error(s(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return je(i),e;if(o===r)return je(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var qe=i.unstable_scheduleCallback,Ke=i.unstable_cancelCallback,Xe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Qe=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=ht(a):0!==(s&=o)&&(r=ht(s))}else 0!==(o=n&~i)?r=ht(o):0!==s&&(r=ht(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,St,It,Ct,Et=!1,Tt=[],Nt=null,At=null,Rt=null,$t=new Map,_t=new Map,Ot=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":$t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_t.delete(t.pointerId)}}function Mt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Lt(e){var t=yi(e.target);if(null!==t){var n=We(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Ct(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Pt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function zt(e,t,n){Pt(e)&&n.delete(t)}function Bt(){Et=!1,null!==Nt&&Pt(Nt)&&(Nt=null),null!==At&&Pt(At)&&(At=null),null!==Rt&&Pt(Rt)&&(Rt=null),$t.forEach(zt),_t.forEach(zt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bt)))}function Wt(e){function t(t){return Ut(t,e)}if(0<Tt.length){Ut(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Nt&&Ut(Nt,e),null!==At&&Ut(At,e),null!==Rt&&Ut(Rt,e),$t.forEach(t),_t.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Lt(n),null===n.blockedOn&&Ot.shift()}var Vt=x.ReactCurrentBatchConfig,jt=!0;function Gt(e,t,n,r){var i=bt,s=Vt.transition;Vt.transition=null;try{bt=1,qt(e,t,n,r)}finally{bt=i,Vt.transition=s}}function Ht(e,t,n,r){var i=bt,s=Vt.transition;Vt.transition=null;try{bt=4,qt(e,t,n,r)}finally{bt=i,Vt.transition=s}}function qt(e,t,n,r){if(jt){var i=Xt(e,t,n,r);if(null===i)jr(e,t,r,Kt,n),Ft(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Nt=Mt(Nt,e,t,n,r,i),!0;case"dragenter":return At=Mt(At,e,t,n,r,i),!0;case"mouseover":return Rt=Mt(Rt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return $t.set(s,Mt($t.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,_t.set(s,Mt(_t.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ft(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==i;){var s=bi(i);if(null!==s&&wt(s),null===(s=Xt(e,t,n,r))&&jr(e,t,r,Kt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else jr(e,t,r,null,n)}}var Kt=null;function Xt(e,t,n,r){if(Kt=null,null!==(e=yi(e=we(r))))if(null===(t=We(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,i="value"in Qt?Qt.value:Qt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=sn(un),hn=L({},un,{view:0,detail:0}),dn=sn(hn),pn=L({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=sn(pn),mn=sn(L({},pn,{dataTransfer:0})),gn=sn(L({},hn,{relatedTarget:0})),vn=sn(L({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(yn),xn=sn(L({},un,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function In(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Cn(){return In}var En=L({},hn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=sn(En),Nn=sn(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=sn(L({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Rn=sn(L({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),$n=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),_n=sn($n),On=[9,13,27,32],Dn=c&&"CompositionEvent"in window,Fn=null;c&&"documentMode"in document&&(Fn=document.documentMode);var Mn=c&&"TextEvent"in window&&!Fn,Ln=c&&(!Dn||Fn&&8<Fn&&11>=Fn),Pn=String.fromCharCode(32),zn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Gn(e,t,n,r){Ee(r),0<(t=Hr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,qn=null;function Kn(e){Pr(e,0)}function Xn(e){if(q(xi(e)))return e}function Yn(e,t){if("change"===e)return t}var Qn=!1;if(c){var Jn;if(c){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),qn=Hn=null)}function nr(e){if("value"===e.propertyName&&Xn(qn)){var t=[];Gn(t,qn,e,we(e)),$e(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),qn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(qn)}function sr(e,t){if("click"===e)return Xn(t)}function or(e,t){if("input"===e||"change"===e)return Xn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=cr(n,s);var o=cr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==K(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Hr(vr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},Ir={};function Cr(e){if(Sr[e])return Sr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ir)return Sr[e]=n[t];return e}c&&(Ir=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Er=Cr("animationend"),Tr=Cr("animationiteration"),Nr=Cr("animationstart"),Ar=Cr("transitionend"),Rr=new Map,$r="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _r(e,t){Rr.set(e,t),l(t,[e])}for(var Or=0;Or<$r.length;Or++){var Dr=$r[Or];_r(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}_r(Er,"onAnimationEnd"),_r(Tr,"onAnimationIteration"),_r(Nr,"onAnimationStart"),_r("dblclick","onDoubleClick"),_r("focusin","onFocus"),_r("focusout","onBlur"),_r(Ar,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,u){if(Ue.apply(this,arguments),Me){if(!Me)throw Error(s(198));var c=Le;Me=!1,Le=null,Pe||(Pe=!0,ze=c)}}(r,t,void 0,e),e.currentTarget=null}function Pr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Lr(i,a,u),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Lr(i,a,u),s=l}}}if(Pe)throw e=ze,Pe=!1,ze=null,e}function zr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Wr(e){if(!e[Ur]){e[Ur]=!0,o.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,Br("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Yt(t)){case 1:var i=Gt;break;case 4:i=Ht;break;default:i=qt}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function jr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=yi(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}$e((function(){var r=s,i=we(n),o=[];e:{var a=Rr.get(e);if(void 0!==a){var l=cn,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Tn;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case Er:case Tr:case Nr:l=vn;break;case Ar:l=Rn;break;case"scroll":l=dn;break;case"wheel":l=_n;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Nn}var c=0!==(4&t),h=!c&&"scroll"===e,d=c?null!==a?a+"Capture":null:a;c=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=_e(f,d))&&c.push(Gr(f,m,p)))),h)break;f=f.return}0<c.length&&(a=new l(a,u,null,n,i),o.push({event:a,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===xe||!(u=n.relatedTarget||n.fromElement)||!yi(u)&&!u[fi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?yi(u):null)&&(u!==(h=We(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=fn,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(c=Nn,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?a:xi(l),p=null==u?a:xi(u),(a=new c(m,f+"leave",l,n,i)).target=h,a.relatedTarget=p,m=null,yi(i)===r&&((c=new c(d,f+"enter",u,n,i)).target=p,c.relatedTarget=h,m=c),h=m,l&&u)e:{for(d=u,f=0,p=c=l;p;p=qr(p))f++;for(p=0,m=d;m;m=qr(m))p++;for(;0<f-p;)c=qr(c),f--;for(;0<p-f;)d=qr(d),p--;for(;f--;){if(c===d||null!==d&&c===d.alternate)break e;c=qr(c),d=qr(d)}c=null}else c=null;null!==l&&Kr(o,a,l,c,!1),null!==u&&null!==h&&Kr(o,h,u,c,!0)}if("select"===(l=(a=r?xi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Yn;else if(jn(a))if(Qn)g=or;else{g=ir;var v=rr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=sr);switch(g&&(g=g(e,r))?Gn(o,g,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=r?xi(r):window,e){case"focusin":(jn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(o,n,i)}var y;if(Dn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Wn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wn&&(y=en()):(Jt="value"in(Qt=i)?Qt.value:Qt.textContent,Wn=!0)),0<(v=Hr(r,b)).length&&(b=new xn(b,e,null,n,i),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=Un(n))&&(b.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(zn=!0,Pn);case"textInput":return(e=t.data)===Pn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!Dn&&Bn(e,t)?(e=en(),Zt=Jt=Qt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=y))}Pr(o,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=_e(e,n))&&r.unshift(Gr(e,s,i)),null!=(s=_e(e,t))&&r.push(Gr(e,s,i))),e=e.return}return r}function qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==u&&(a=u,i?null!=(l=_e(n,s))&&o.unshift(Gr(n,l,a)):i||null!=(l=_e(n,s))&&o.push(Gr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Xr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Xr,"\n").replace(Yr,"")}function Jr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Wt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Wt(t)}function ui(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,pi="__reactProps$"+hi,fi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function yi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[di])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[di]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wi(e){return e[pi]||null}var ki=[],Si=-1;function Ii(e){return{current:e}}function Ci(e){0>Si||(e.current=ki[Si],ki[Si]=null,Si--)}function Ei(e,t){Si++,ki[Si]=e.current,e.current=t}var Ti={},Ni=Ii(Ti),Ai=Ii(!1),Ri=Ti;function $i(e,t){var n=e.type.contextTypes;if(!n)return Ti;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function _i(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){Ci(Ai),Ci(Ni)}function Di(e,t,n){if(Ni.current!==Ti)throw Error(s(168));Ei(Ni,t),Ei(Ai,n)}function Fi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,V(e)||"Unknown",i));return L({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ti,Ri=Ni.current,Ei(Ni,e),Ei(Ai,Ai.current),!0}function Li(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Fi(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,Ci(Ai),Ci(Ni),Ei(Ni,e)):Ci(Ai),Ei(Ai,n)}var Pi=null,zi=!1,Bi=!1;function Ui(e){null===Pi?Pi=[e]:Pi.push(e)}function Wi(){if(!Bi&&null!==Pi){Bi=!0;var e=0,t=bt;try{var n=Pi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Pi=null,zi=!1}catch(i){throw null!==Pi&&(Pi=Pi.slice(e+1)),qe(Ze,Wi),i}finally{bt=t,Bi=!1}}return null}var Vi=[],ji=0,Gi=null,Hi=0,qi=[],Ki=0,Xi=null,Yi=1,Qi="";function Ji(e,t){Vi[ji++]=Hi,Vi[ji++]=Gi,Gi=e,Hi=t}function Zi(e,t,n){qi[Ki++]=Yi,qi[Ki++]=Qi,qi[Ki++]=Xi,Xi=e;var r=Yi;e=Qi;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Yi=1<<32-ot(t)+i|n<<i|r,Qi=s+e}else Yi=1<<s|n<<i|r,Qi=e}function es(e){null!==e.return&&(Ji(e,1),Zi(e,1,0))}function ts(e){for(;e===Gi;)Gi=Vi[--ji],Vi[ji]=null,Hi=Vi[--ji],Vi[ji]=null;for(;e===Xi;)Xi=qi[--Ki],qi[Ki]=null,Qi=qi[--Ki],qi[Ki]=null,Yi=qi[--Ki],qi[Ki]=null}var ns=null,rs=null,is=!1,ss=null;function os(e,t){var n=$u(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ui(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xi?{id:Yi,overflow:Qi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=$u(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function us(e){if(is){var t=rs;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=ui(n.nextSibling);var r=ns;t&&as(e,t)?os(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function cs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!is)return cs(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=ui(t.nextSibling)}if(cs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ui(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ui(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=rs;e;)e=ui(e.nextSibling)}function ps(){rs=ns=null,is=!1}function fs(e){null===ss?ss=[e]:ss.push(e)}var ms=x.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Ou(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lu(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){var s=n.type;return s===S?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===_&&ys(s)===t.type)?((r=i(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Du(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Pu(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=Fu(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Du(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case k:return(t=Pu(t,e.mode,n)).return=e,t;case _:return d(e,(0,t._init)(t._payload),n)}if(te(t)||F(t))return(t=Fu(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?u(e,t,n,r):null;case k:return n.key===i?c(e,t,n,r):null;case _:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||F(n))return null!==i?null:h(e,t,n,r,null);vs(e,n)}return null}function f(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case k:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case _:return f(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||F(r))return h(t,e=e.get(n)||null,r,i,null);vs(t,r)}return null}function m(i,s,a,l){for(var u=null,c=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=p(i,h,a[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(i,h),s=o(v,s,m),null===c?u=v:c.sibling=v,c=v,h=g}if(m===a.length)return n(i,h),is&&Ji(i,m),u;if(null===h){for(;m<a.length;m++)null!==(h=d(i,a[m],l))&&(s=o(h,s,m),null===c?u=h:c.sibling=h,c=h);return is&&Ji(i,m),u}for(h=r(i,h);m<a.length;m++)null!==(g=f(h,i,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===c?u=g:c.sibling=g,c=g);return e&&h.forEach((function(e){return t(i,e)})),is&&Ji(i,m),u}function g(i,a,l,u){var c=F(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var h=c=null,m=a,g=a=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(i,m,y.value,u);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),a=o(b,a,g),null===h?c=b:h.sibling=b,h=b,m=v}if(y.done)return n(i,m),is&&Ji(i,g),c;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(i,y.value,u))&&(a=o(y,a,g),null===h?c=y:h.sibling=y,h=y);return is&&Ji(i,g),c}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=f(m,i,g,y.value,u))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=o(y,a,g),null===h?c=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(i,e)})),is&&Ji(i,g),c}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var u=o.key,c=s;null!==c;){if(c.key===u){if((u=o.type)===S){if(7===c.tag){n(r,c.sibling),(s=i(c,o.props.children)).return=r,r=s;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===_&&ys(u)===c.type){n(r,c.sibling),(s=i(c,o.props)).ref=gs(r,c,o),s.return=r,r=s;break e}n(r,c);break}t(r,c),c=c.sibling}o.type===S?((s=Fu(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Du(o.type,o.key,o.props,null,r.mode,l)).ref=gs(r,s,o),l.return=r,r=l)}return a(r);case k:e:{for(c=o.key;null!==s;){if(s.key===c){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Pu(o,r.mode,l)).return=r,r=s}return a(r);case _:return e(r,s,(c=o._init)(o._payload),l)}if(te(o))return m(r,s,o,l);if(F(o))return g(r,s,o,l);vs(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Lu(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var xs=bs(!0),ws=bs(!1),ks=Ii(null),Ss=null,Is=null,Cs=null;function Es(){Cs=Is=Ss=null}function Ts(e){var t=ks.current;Ci(ks),e._currentValue=t}function Ns(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function As(e,t){Ss=e,Cs=Is=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ba=!0),e.firstContext=null)}function Rs(e){var t=e._currentValue;if(Cs!==e)if(e={context:e,memoizedValue:t,next:null},null===Is){if(null===Ss)throw Error(s(308));Is=e,Ss.dependencies={lanes:0,firstContext:e}}else Is=Is.next=e;return t}var $s=null;function _s(e){null===$s?$s=[e]:$s.push(e)}function Os(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,_s(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ds(e,r)}function Ds(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Fs=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ps(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zs(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ds(e,n)}return null===(i=r.interleaved)?(t.next=t,_s(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ds(e,n)}function Bs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Us(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ws(e,t,n,r){var i=e.updateQueue;Fs=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,u=l.next;l.next=null,null===o?s=u:o.next=u,o=l;var c=e.alternate;null!==c&&((a=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===a?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,c=u=l=null,a=s;;){var d=a.lane,p=a.eventTime;if((r&d)===d){null!==c&&(c=c.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(d=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break e;h=L({},h,d);break e;case 2:Fs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===c?(u=c=p,l=h):c=c.next=p,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===c&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Ml|=o,e.lanes=o,e.memoizedState=h}}function Vs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var js={},Gs=Ii(js),Hs=Ii(js),qs=Ii(js);function Ks(e){if(e===js)throw Error(s(174));return e}function Xs(e,t){switch(Ei(qs,t),Ei(Hs,e),Ei(Gs,js),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ci(Gs),Ei(Gs,t)}function Ys(){Ci(Gs),Ci(Hs),Ci(qs)}function Qs(e){Ks(qs.current);var t=Ks(Gs.current),n=le(t,e.type);t!==n&&(Ei(Hs,e),Ei(Gs,n))}function Js(e){Hs.current===e&&(Ci(Gs),Ci(Hs))}var Zs=Ii(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=x.ReactCurrentDispatcher,io=x.ReactCurrentBatchConfig,so=0,oo=null,ao=null,lo=null,uo=!1,co=!1,ho=0,po=0;function fo(){throw Error(s(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function go(e,t,n,r,i,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?Zo:ea,e=n(r,i),co){o=0;do{if(co=!1,ho=0,25<=o)throw Error(s(301));o+=1,lo=ao=null,t.updateQueue=null,ro.current=ta,e=n(r,i)}while(co)}if(ro.current=Jo,t=null!==ao&&null!==ao.next,so=0,lo=ao=oo=null,uo=!1,t)throw Error(s(300));return e}function vo(){var e=0!==ho;return ho=0,e}function yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function bo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function xo(e,t){return"function"===typeof t?t(e):t}function wo(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=ao,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,u=null,c=o;do{var h=c.lane;if((so&h)===h)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=d,a=r):u=u.next=d,oo.lanes|=h,Ml|=h}c=c.next}while(null!==c&&c!==o);null===u?a=r:u.next=l,ar(r,t.memoizedState)||(ba=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,oo.lanes|=o,Ml|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ko(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);ar(o,t.memoizedState)||(ba=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function So(){}function Io(e,t){var n=oo,r=bo(),i=t(),o=!ar(r.memoizedState,i);if(o&&(r.memoizedState=i,ba=!0),r=r.queue,Mo(To.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,$o(9,Eo.bind(null,n,r,i,t),void 0,null),null===Al)throw Error(s(349));0!==(30&so)||Co(n,t,i)}return i}function Co(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Eo(e,t,n,r){t.value=n,t.getSnapshot=r,No(t)&&Ao(e)}function To(e,t,n){return n((function(){No(t)&&Ao(e)}))}function No(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Ao(e){var t=Ds(e,1);null!==t&&nu(t,e,1,-1)}function Ro(e){var t=yo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xo,lastRenderedState:e},t.queue=e,e=e.dispatch=Ko.bind(null,oo,e),[t.memoizedState,e]}function $o(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function _o(){return bo().memoizedState}function Oo(e,t,n,r){var i=yo();oo.flags|=e,i.memoizedState=$o(1|t,n,void 0,void 0===r?null:r)}function Do(e,t,n,r){var i=bo();r=void 0===r?null:r;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==r&&mo(r,o.deps))return void(i.memoizedState=$o(t,n,s,r))}oo.flags|=e,i.memoizedState=$o(1|t,n,s,r)}function Fo(e,t){return Oo(8390656,8,e,t)}function Mo(e,t){return Do(2048,8,e,t)}function Lo(e,t){return Do(4,2,e,t)}function Po(e,t){return Do(4,4,e,t)}function zo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Do(4,4,zo.bind(null,t,e),n)}function Uo(){}function Wo(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Vo(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function jo(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,ba=!0),e.memoizedState=n):(ar(n,t)||(n=mt(),oo.lanes|=n,Ml|=n,e.baseState=!0),t)}function Go(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=io.transition;io.transition={};try{e(!1),t()}finally{bt=n,io.transition=r}}function Ho(){return bo().memoizedState}function qo(e,t,n){var r=tu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xo(e))Yo(t,n);else if(null!==(n=Os(e,t,n,r))){nu(n,e,r,eu()),Qo(n,t,r)}}function Ko(e,t,n){var r=tu(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xo(e))Yo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,o)){var l=t.interleaved;return null===l?(i.next=i,_s(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(u){}null!==(n=Os(e,t,i,r))&&(nu(n,e,r,i=eu()),Qo(n,t,r))}}function Xo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Yo(e,t){co=uo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Qo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Jo={readContext:Rs,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useInsertionEffect:fo,useLayoutEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useMutableSource:fo,useSyncExternalStore:fo,useId:fo,unstable_isNewReconciler:!1},Zo={readContext:Rs,useCallback:function(e,t){return yo().memoizedState=[e,void 0===t?null:t],e},useContext:Rs,useEffect:Fo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4194308,4,zo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oo(4,2,e,t)},useMemo:function(e,t){var n=yo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=yo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=qo.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},yo().memoizedState=e},useState:Ro,useDebugValue:Uo,useDeferredValue:function(e){return yo().memoizedState=e},useTransition:function(){var e=Ro(!1),t=e[0];return e=Go.bind(null,e[1]),yo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,i=yo();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Al)throw Error(s(349));0!==(30&so)||Co(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Fo(To.bind(null,r,o,e),[e]),r.flags|=2048,$o(9,Eo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=yo(),t=Al.identifierPrefix;if(is){var n=Qi;t=":"+t+"R"+(n=(Yi&~(1<<32-ot(Yi)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Rs,useCallback:Wo,useContext:Rs,useEffect:Mo,useImperativeHandle:Bo,useInsertionEffect:Lo,useLayoutEffect:Po,useMemo:Vo,useReducer:wo,useRef:_o,useState:function(){return wo(xo)},useDebugValue:Uo,useDeferredValue:function(e){return jo(bo(),ao.memoizedState,e)},useTransition:function(){return[wo(xo)[0],bo().memoizedState]},useMutableSource:So,useSyncExternalStore:Io,useId:Ho,unstable_isNewReconciler:!1},ta={readContext:Rs,useCallback:Wo,useContext:Rs,useEffect:Mo,useImperativeHandle:Bo,useInsertionEffect:Lo,useLayoutEffect:Po,useMemo:Vo,useReducer:ko,useRef:_o,useState:function(){return ko(xo)},useDebugValue:Uo,useDeferredValue:function(e){var t=bo();return null===ao?t.memoizedState=e:jo(t,ao.memoizedState,e)},useTransition:function(){return[ko(xo)[0],bo().memoizedState]},useMutableSource:So,useSyncExternalStore:Io,useId:Ho,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ra(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=eu(),i=tu(e),s=Ps(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=zs(e,s,i))&&(nu(t,e,i,r),Bs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=eu(),i=tu(e),s=Ps(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=zs(e,s,i))&&(nu(t,e,i,r),Bs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=eu(),r=tu(e),i=Ps(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=zs(e,i,r))&&(nu(t,e,r,n),Bs(t,e,r))}};function sa(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function oa(e,t,n){var r=!1,i=Ti,s=t.contextType;return"object"===typeof s&&null!==s?s=Rs(s):(i=_i(t)?Ri:Ni.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?$i(e,i):Ti),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function la(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Ms(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Rs(s):(s=_i(t)?Ri:Ni.current,i.context=$i(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ra(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ia.enqueueReplaceState(i,i.state,null),Ws(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ua(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function ca(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var da="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,n){(n=Ps(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){jl||(jl=!0,Gl=r),ha(0,t)},n}function fa(e,t,n){(n=Ps(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ha(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!==typeof r&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new da;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Cu.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ps(-1,1)).tag=2,zs(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ya=x.ReactCurrentOwner,ba=!1;function xa(e,t,n,r){t.child=null===e?ws(t,null,n,r):xs(t,e.child,n,r)}function wa(e,t,n,r,i){n=n.render;var s=t.ref;return As(t,i),r=go(e,t,n,r,s,i),n=vo(),null===e||ba?(is&&n&&es(t),t.flags|=1,xa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ja(e,t,i))}function ka(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||_u(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Du(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Sa(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return ja(e,t,i)}return t.flags|=1,(e=Ou(s,r)).ref=t.ref,e.return=t,t.child=e}function Sa(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(ba=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,ja(e,t,i);0!==(131072&e.flags)&&(ba=!0)}}return Ea(e,t,n,r,i)}function Ia(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ei(Ol,_l),_l|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ei(Ol,_l),_l|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ei(Ol,_l),_l|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ei(Ol,_l),_l|=r;return xa(e,t,i,n),t.child}function Ca(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ea(e,t,n,r,i){var s=_i(n)?Ri:Ni.current;return s=$i(t,s),As(t,i),n=go(e,t,n,r,s,i),r=vo(),null===e||ba?(is&&r&&es(t),t.flags|=1,xa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ja(e,t,i))}function Ta(e,t,n,r,i){if(_i(n)){var s=!0;Mi(t)}else s=!1;if(As(t,i),null===t.stateNode)Va(e,t),oa(t,n,r),la(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=n.contextType;"object"===typeof u&&null!==u?u=Rs(u):u=$i(t,u=_i(n)?Ri:Ni.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==u)&&aa(t,o,r,u),Fs=!1;var d=t.memoizedState;o.state=d,Ws(t,r,o,i),l=t.memoizedState,a!==r||d!==l||Ai.current||Fs?("function"===typeof c&&(ra(t,n,c,r),l=t.memoizedState),(a=Fs||sa(t,n,a,r,d,l,u))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ls(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:na(t.type,a),o.props=u,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Rs(l):l=$i(t,l=_i(n)?Ri:Ni.current);var p=n.getDerivedStateFromProps;(c="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&aa(t,o,r,l),Fs=!1,d=t.memoizedState,o.state=d,Ws(t,r,o,i);var f=t.memoizedState;a!==h||d!==f||Ai.current||Fs?("function"===typeof p&&(ra(t,n,p,r),f=t.memoizedState),(u=Fs||sa(t,n,u,r,d,f,l)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Na(e,t,n,r,s,i)}function Na(e,t,n,r,i,s){Ca(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Li(t,n,!1),ja(e,t,s);r=t.stateNode,ya.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=xs(t,e.child,null,s),t.child=xs(t,null,a,s)):xa(e,t,a,s),t.memoizedState=r.state,i&&Li(t,n,!0),t.child}function Aa(e){var t=e.stateNode;t.pendingContext?Di(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Di(0,t.context,!1),Xs(e,t.containerInfo)}function Ra(e,t,n,r,i){return ps(),fs(i),t.flags|=256,xa(e,t,n,r),t.child}var $a,_a,Oa,Da,Fa={dehydrated:null,treeContext:null,retryLane:0};function Ma(e){return{baseLanes:e,cachePool:null,transitions:null}}function La(e,t,n){var r,i=t.pendingProps,o=Zs.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ei(Zs,1&o),null===e)return us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Mu(l,i,0,null),e=Fu(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ma(n),t.memoizedState=Fa,e):Pa(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,za(e,t,a,r=ca(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Mu({mode:"visible",children:r.children},i,0,null),(o=Fu(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&xs(t,e.child,null,a),t.child.memoizedState=Ma(a),t.memoizedState=Fa,o);if(0===(1&t.mode))return za(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,za(e,t,a,r=ca(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),ba||l){if(null!==(r=Al)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ds(e,i),nu(r,e,i,-1))}return mu(),za(e,t,a,r=ca(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Tu.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,rs=ui(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(qi[Ki++]=Yi,qi[Ki++]=Qi,qi[Ki++]=Xi,Yi=e.id,Qi=e.overflow,Xi=t),t=Pa(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=u,t.deletions=null):(i=Ou(o,u)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Ou(r,a):(a=Fu(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?Ma(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Fa,i}return e=(a=e.child).sibling,i=Ou(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Pa(e,t){return(t=Mu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function za(e,t,n,r){return null!==r&&fs(r),xs(t,e.child,null,n),(e=Pa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ba(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ns(e.return,t,n)}function Ua(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Wa(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(xa(e,t,r.children,n),0!==(2&(r=Zs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ba(e,n,t);else if(19===e.tag)Ba(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ei(Zs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ua(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===eo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ua(t,!0,n,null,s);break;case"together":Ua(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Va(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ja(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Ou(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ou(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ga(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ha(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function qa(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ha(t),null;case 1:case 17:return _i(t.type)&&Oi(),Ha(t),null;case 3:return r=t.stateNode,Ys(),Ci(Ai),Ci(Ni),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ou(ss),ss=null))),_a(e,t),Ha(t),null;case 5:Js(t);var i=Ks(qs.current);if(n=t.type,null!==e&&null!=t.stateNode)Oa(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ha(t),null}if(e=Ks(Gs.current),hs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[di]=t,r[pi]=o,e=0!==(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(i=0;i<Fr.length;i++)zr(Fr[i],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":Y(r,o),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},zr("invalid",r);break;case"textarea":ie(r,o),zr("invalid",r)}for(var l in ye(n,o),i=null,o)if(o.hasOwnProperty(l)){var u=o[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,u,e),i=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,u,e),i=["children",""+u]):a.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&zr("scroll",r)}switch(n){case"input":H(r),Z(r,o,!0);break;case"textarea":H(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[pi]=r,$a(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":zr("cancel",e),zr("close",e),i=r;break;case"iframe":case"object":case"embed":zr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Fr.length;i++)zr(Fr[i],e);i=r;break;case"source":zr("error",e),i=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),i=r;break;case"details":zr("toggle",e),i=r;break;case"input":Y(e,r),i=X(e,r),zr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=L({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),zr("invalid",e)}for(o in ye(n,i),u=i)if(u.hasOwnProperty(o)){var c=u[o];"style"===o?ge(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&he(e,c):"children"===o?"string"===typeof c?("textarea"!==n||""!==c)&&de(e,c):"number"===typeof c&&de(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=c&&"onScroll"===o&&zr("scroll",e):null!=c&&b(e,o,c,l))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+j(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ha(t),null;case 6:if(e&&null!=t.stateNode)Da(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Ks(qs.current),Ks(Gs.current),hs(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(o=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return Ha(t),null;case 13:if(Ci(Zs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))ds(),ps(),t.flags|=98560,o=!1;else if(o=hs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[di]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ha(t),o=!1}else null!==ss&&(ou(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Dl&&(Dl=3):mu())),null!==t.updateQueue&&(t.flags|=4),Ha(t),null);case 4:return Ys(),_a(e,t),null===e&&Wr(t.stateNode.containerInfo),Ha(t),null;case 10:return Ts(t.type._context),Ha(t),null;case 19:if(Ci(Zs),null===(o=t.memoizedState))return Ha(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Ga(o,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Ga(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ei(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==o.tail&&Qe()>Wl&&(t.flags|=128,r=!0,Ga(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ga(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!is)return Ha(t),null}else 2*Qe()-o.renderingStartTime>Wl&&1073741824!==n&&(t.flags|=128,r=!0,Ga(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qe(),t.sibling=null,n=Zs.current,Ei(Zs,r?1&n|2:1&n),t):(Ha(t),null);case 22:case 23:return hu(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&_l)&&(Ha(t),6&t.subtreeFlags&&(t.flags|=8192)):Ha(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ka(e,t){switch(ts(t),t.tag){case 1:return _i(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),Ci(Ai),Ci(Ni),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Js(t),null;case 13:if(Ci(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ci(Zs),null;case 4:return Ys(),null;case 10:return Ts(t.type._context),null;case 22:case 23:return hu(),null;default:return null}}$a=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},_a=function(){},Oa=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ks(Gs.current);var s,o=null;switch(n){case"input":i=X(e,i),r=X(e,r),o=[];break;case"select":i=L({},i,{value:void 0}),r=L({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(c in ye(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(a.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(s in l)!l.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&l[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(o||(o=[]),o.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(o=o||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(a.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&zr("scroll",e),o||l===u||(o=[])):(o=o||[]).push(c,u))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},Da=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xa=!1,Ya=!1,Qa="function"===typeof WeakSet?WeakSet:Set,Ja=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Iu(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Iu(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&el(t,n,s)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[pi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var cl=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Ya||Za(n,t);case 6:var r=cl,i=hl;cl=null,dl(e,t,n),hl=i,null!==(cl=r)&&(hl?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(hl?(e=cl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Wt(e)):li(cl,n.stateNode));break;case 4:r=cl,i=hl,cl=n.stateNode.containerInfo,hl=!0,dl(e,t,n),cl=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),i=i.next}while(i!==r)}dl(e,t,n);break;case 1:if(!Ya&&(Za(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Iu(n,t,a)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Ya=(r=Ya)||null!==n.memoizedState,dl(e,t,n),Ya=r):dl(e,t,n);break;default:dl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qa),t.forEach((function(t){var r=Nu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,hl=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===cl)throw Error(s(160));pl(o,a,i),cl=null,hl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(c){Iu(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Iu(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Iu(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&r&&null!==n&&Za(n,n.return);break;case 5:if(ml(t,e),vl(e),512&r&&null!==n&&Za(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){Iu(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===o.type&&null!=o.name&&Q(i,o),be(l,a);var c=be(l,o);for(a=0;a<u.length;a+=2){var h=u[a],d=u[a+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):b(i,h,d,c)}switch(l){case"input":J(i,o);break;case"textarea":se(i,o);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(i,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[pi]=o}catch(g){Iu(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Iu(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(g){Iu(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Ul=Qe())),4&r&&fl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(c=Ya)||h,ml(t,e),Ya=c):ml(t,e),vl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!h&&0!==(1&e.mode))for(Ja=e,h=e.child;null!==h;){for(d=Ja=h;null!==Ja;){switch(f=(p=Ja).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Za(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Iu(r,n,g)}}break;case 5:Za(p,p.return);break;case 22:if(null!==p.memoizedState){wl(d);continue}}null!==f?(f.return=p,Ja=f):wl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,c?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(u=d.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",a))}catch(g){Iu(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Iu(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),vl(e),4&r&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),ul(e,al(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,al(e),o);break;default:throw Error(s(161))}}catch(a){Iu(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Ja=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Ja;){var i=Ja,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Xa;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Xa;var u=Ya;if(Xa=o,(Ya=l)&&!u)for(Ja=i;null!==Ja;)l=(o=Ja).child,22===o.tag&&null!==o.memoizedState?kl(i):null!==l?(l.return=o,Ja=l):kl(i);for(;null!==s;)Ja=s,bl(s,t,n),s=s.sibling;Ja=i,Xa=a,Ya=u}xl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Ja=s):xl(e)}}function xl(e){for(;null!==Ja;){var t=Ja;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ya||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ya)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Vs(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Wt(d)}}}break;default:throw Error(s(163))}Ya||512&t.flags&&il(t)}catch(p){Iu(t,t.return,p)}}if(t===e){Ja=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ja=n;break}Ja=t.return}}function wl(e){for(;null!==Ja;){var t=Ja;if(t===e){Ja=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ja=n;break}Ja=t.return}}function kl(e){for(;null!==Ja;){var t=Ja;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Iu(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Iu(t,i,l)}}var s=t.return;try{il(t)}catch(l){Iu(t,s,l)}break;case 5:var o=t.return;try{il(t)}catch(l){Iu(t,o,l)}}}catch(l){Iu(t,t.return,l)}if(t===e){Ja=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ja=a;break}Ja=t.return}}var Sl,Il=Math.ceil,Cl=x.ReactCurrentDispatcher,El=x.ReactCurrentOwner,Tl=x.ReactCurrentBatchConfig,Nl=0,Al=null,Rl=null,$l=0,_l=0,Ol=Ii(0),Dl=0,Fl=null,Ml=0,Ll=0,Pl=0,zl=null,Bl=null,Ul=0,Wl=1/0,Vl=null,jl=!1,Gl=null,Hl=null,ql=!1,Kl=null,Xl=0,Yl=0,Ql=null,Jl=-1,Zl=0;function eu(){return 0!==(6&Nl)?Qe():-1!==Jl?Jl:Jl=Qe()}function tu(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==$l?$l&-$l:null!==ms.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nu(e,t,n,r){if(50<Yl)throw Yl=0,Ql=null,Error(s(185));vt(e,n,r),0!==(2&Nl)&&e===Al||(e===Al&&(0===(2&Nl)&&(Ll|=n),4===Dl&&au(e,$l)),ru(e,r),1===n&&0===Nl&&0===(1&t.mode)&&(Wl=Qe()+500,zi&&Wi()))}function ru(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=pt(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=dt(e,e===Al?$l:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){zi=!0,Ui(e)}(lu.bind(null,e)):Ui(lu.bind(null,e)),oi((function(){0===(6&Nl)&&Wi()})),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Au(n,iu.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function iu(e,t){if(Jl=-1,Zl=0,0!==(6&Nl))throw Error(s(327));var n=e.callbackNode;if(ku()&&e.callbackNode!==n)return null;var r=dt(e,e===Al?$l:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gu(e,r);else{t=r;var i=Nl;Nl|=2;var o=fu();for(Al===e&&$l===t||(Vl=null,Wl=Qe()+500,du(e,t));;)try{yu();break}catch(l){pu(e,l)}Es(),Cl.current=o,Nl=i,null!==Rl?t=0:(Al=null,$l=0,t=Dl)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(r=i,t=su(e,i))),1===t)throw n=Fl,du(e,0),au(e,r),ru(e,Qe()),n;if(6===t)au(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ar(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gu(e,r))&&(0!==(o=ft(e))&&(r=o,t=su(e,o))),1===t))throw n=Fl,du(e,0),au(e,r),ru(e,Qe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:wu(e,Bl,Vl);break;case 3:if(au(e,r),(130023424&r)===r&&10<(t=Ul+500-Qe())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){eu(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(wu.bind(null,e,Bl,Vl),t);break}wu(e,Bl,Vl);break;case 4:if(au(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Il(r/1960))-r)){e.timeoutHandle=ri(wu.bind(null,e,Bl,Vl),r);break}wu(e,Bl,Vl);break;default:throw Error(s(329))}}}return ru(e,Qe()),e.callbackNode===n?iu.bind(null,e):null}function su(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(du(e,t).flags|=256),2!==(e=gu(e,t))&&(t=Bl,Bl=n,null!==t&&ou(t)),e}function ou(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function au(e,t){for(t&=~Pl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function lu(e){if(0!==(6&Nl))throw Error(s(327));ku();var t=dt(e,0);if(0===(1&t))return ru(e,Qe()),null;var n=gu(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=su(e,r))}if(1===n)throw n=Fl,du(e,0),au(e,t),ru(e,Qe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wu(e,Bl,Vl),ru(e,Qe()),null}function uu(e,t){var n=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=n)&&(Wl=Qe()+500,zi&&Wi())}}function cu(e){null!==Kl&&0===Kl.tag&&0===(6&Nl)&&ku();var t=Nl;Nl|=1;var n=Tl.transition,r=bt;try{if(Tl.transition=null,bt=1,e)return e()}finally{bt=r,Tl.transition=n,0===(6&(Nl=t))&&Wi()}}function hu(){_l=Ol.current,Ci(Ol)}function du(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Rl)for(n=Rl.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:Ys(),Ci(Ai),Ci(Ni),no();break;case 5:Js(r);break;case 4:Ys();break;case 13:case 19:Ci(Zs);break;case 10:Ts(r.type._context);break;case 22:case 23:hu()}n=n.return}if(Al=e,Rl=e=Ou(e.current,null),$l=_l=t,Dl=0,Fl=null,Pl=Ll=Ml=0,Bl=zl=null,null!==$s){for(t=0;t<$s.length;t++)if(null!==(r=(n=$s[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}$s=null}return e}function pu(e,t){for(;;){var n=Rl;try{if(Es(),ro.current=Jo,uo){for(var r=oo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}uo=!1}if(so=0,lo=ao=oo=null,co=!1,ho=0,El.current=null,null===n||null===n.return){Dl=1,Fl=t,Rl=null;break}e:{var o=e,a=n.return,l=n,u=t;if(t=$l,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=ga(a);if(null!==f){f.flags&=-257,va(f,a,l,0,t),1&f.mode&&ma(o,c,t),u=c;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(0===(1&t)){ma(o,c,t),mu();break e}u=Error(s(426))}else if(is&&1&l.mode){var v=ga(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),va(v,a,l,0,t),fs(ua(u,l));break e}}o=u=ua(u,l),4!==Dl&&(Dl=2),null===zl?zl=[o]:zl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Us(o,pa(0,u,t));break e;case 1:l=u;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Hl||!Hl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Us(o,fa(o,l,t));break e}}o=o.return}while(null!==o)}xu(n)}catch(x){t=x,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function fu(){var e=Cl.current;return Cl.current=Jo,null===e?Jo:e}function mu(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Al||0===(268435455&Ml)&&0===(268435455&Ll)||au(Al,$l)}function gu(e,t){var n=Nl;Nl|=2;var r=fu();for(Al===e&&$l===t||(Vl=null,du(e,t));;)try{vu();break}catch(i){pu(e,i)}if(Es(),Nl=n,Cl.current=r,null!==Rl)throw Error(s(261));return Al=null,$l=0,Dl}function vu(){for(;null!==Rl;)bu(Rl)}function yu(){for(;null!==Rl&&!Xe();)bu(Rl)}function bu(e){var t=Sl(e.alternate,e,_l);e.memoizedProps=e.pendingProps,null===t?xu(e):Rl=t,El.current=null}function xu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=qa(n,t,_l)))return void(Rl=n)}else{if(null!==(n=Ka(n,t)))return n.flags&=32767,void(Rl=n);if(null===e)return Dl=6,void(Rl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rl=t);Rl=t=e}while(null!==t);0===Dl&&(Dl=5)}function wu(e,t,n){var r=bt,i=Tl.transition;try{Tl.transition=null,bt=1,function(e,t,n,r){do{ku()}while(null!==Kl);if(0!==(6&Nl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Al&&(Rl=Al=null,$l=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||ql||(ql=!0,Au(tt,(function(){return ku(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Tl.transition,Tl.transition=null;var a=bt;bt=1;var l=Nl;Nl|=4,El.current=null,function(e,t){if(ei=jt,pr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var a=0,l=-1,u=-1,c=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==o||0!==r&&3!==d.nodeType||(u=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++c===i&&(l=a),p===o&&++h===r&&(u=a),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},jt=!1,Ja=t;null!==Ja;)if(e=(t=Ja).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ja=e;else for(;null!==Ja;){t=Ja;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(s(163))}}catch(w){Iu(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Ja=e;break}Ja=t.return}m=tl,tl=!1}(e,n),gl(n,e),fr(ti),jt=!!ei,ti=ei=null,e.current=n,yl(n,e,i),Ye(),Nl=l,bt=a,Tl.transition=o}else e.current=n;if(ql&&(ql=!1,Kl=e,Xl=i),o=e.pendingLanes,0===o&&(Hl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ru(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(jl)throw jl=!1,e=Gl,Gl=null,e;0!==(1&Xl)&&0!==e.tag&&ku(),o=e.pendingLanes,0!==(1&o)?e===Ql?Yl++:(Yl=0,Ql=e):Yl=0,Wi()}(e,t,n,r)}finally{Tl.transition=i,bt=r}return null}function ku(){if(null!==Kl){var e=xt(Xl),t=Tl.transition,n=bt;try{if(Tl.transition=null,bt=16>e?16:e,null===Kl)var r=!1;else{if(e=Kl,Kl=null,Xl=0,0!==(6&Nl))throw Error(s(331));var i=Nl;for(Nl|=4,Ja=e.current;null!==Ja;){var o=Ja,a=o.child;if(0!==(16&Ja.flags)){var l=o.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Ja=c;null!==Ja;){var h=Ja;switch(h.tag){case 0:case 11:case 15:nl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Ja=d;else for(;null!==Ja;){var p=(h=Ja).sibling,f=h.return;if(sl(h),h===c){Ja=null;break}if(null!==p){p.return=f,Ja=p;break}Ja=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Ja=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Ja=a;else e:for(;null!==Ja;){if(0!==(2048&(o=Ja).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Ja=y;break e}Ja=o.return}}var b=e.current;for(Ja=b;null!==Ja;){var x=(a=Ja).child;if(0!==(2064&a.subtreeFlags)&&null!==x)x.return=a,Ja=x;else e:for(a=b;null!==Ja;){if(0!==(2048&(l=Ja).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(k){Iu(l,l.return,k)}if(l===a){Ja=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Ja=w;break e}Ja=l.return}}if(Nl=i,Wi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(k){}r=!0}return r}finally{bt=n,Tl.transition=t}}return!1}function Su(e,t,n){e=zs(e,t=pa(0,t=ua(n,t),1),1),t=eu(),null!==e&&(vt(e,1,t),ru(e,t))}function Iu(e,t,n){if(3===e.tag)Su(e,e,n);else for(;null!==t;){if(3===t.tag){Su(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Hl||!Hl.has(r))){t=zs(t,e=fa(t,e=ua(n,e),1),1),e=eu(),null!==t&&(vt(t,1,e),ru(t,e));break}}t=t.return}}function Cu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=eu(),e.pingedLanes|=e.suspendedLanes&n,Al===e&&($l&n)===n&&(4===Dl||3===Dl&&(130023424&$l)===$l&&500>Qe()-Ul?du(e,0):Pl|=n),ru(e,t)}function Eu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=eu();null!==(e=Ds(e,t))&&(vt(e,t,n),ru(e,n))}function Tu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Eu(e,n)}function Nu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Eu(e,n)}function Au(e,t){return qe(e,t)}function Ru(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $u(e,t,n,r){return new Ru(e,t,n,r)}function _u(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ou(e,t){var n=e.alternate;return null===n?((n=$u(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Du(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)_u(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case S:return Fu(n.children,i,o,t);case I:a=8,i|=8;break;case C:return(e=$u(12,n,t,2|i)).elementType=C,e.lanes=o,e;case A:return(e=$u(13,n,t,i)).elementType=A,e.lanes=o,e;case R:return(e=$u(19,n,t,i)).elementType=R,e.lanes=o,e;case O:return Mu(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:a=10;break e;case T:a=9;break e;case N:a=11;break e;case $:a=14;break e;case _:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=$u(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Fu(e,t,n,r){return(e=$u(7,e,r,t)).lanes=n,e}function Mu(e,t,n,r){return(e=$u(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Lu(e,t,n){return(e=$u(6,e,null,t)).lanes=n,e}function Pu(e,t,n){return(t=$u(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zu(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bu(e,t,n,r,i,s,o,a,l){return e=new zu(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=$u(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function Uu(e){if(!e)return Ti;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(_i(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(_i(n))return Fi(e,n,t)}return t}function Wu(e,t,n,r,i,s,o,a,l){return(e=Bu(n,r,!0,e,0,s,0,a,l)).context=Uu(null),n=e.current,(s=Ps(r=eu(),i=tu(n))).callback=void 0!==t&&null!==t?t:null,zs(n,s,i),e.current.lanes=i,vt(e,i,r),ru(e,r),e}function Vu(e,t,n,r){var i=t.current,s=eu(),o=tu(i);return n=Uu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ps(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=zs(i,t,o))&&(nu(e,i,o,s),Bs(e,i,o)),o}function ju(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hu(e,t){Gu(e,t),(e=e.alternate)&&Gu(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ai.current)ba=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ba=!1,function(e,t,n){switch(t.tag){case 3:Aa(t),ps();break;case 5:Qs(t);break;case 1:_i(t.type)&&Mi(t);break;case 4:Xs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ei(ks,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ei(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?La(e,t,n):(Ei(Zs,1&Zs.current),null!==(e=ja(e,t,n))?e.sibling:null);Ei(Zs,1&Zs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Wa(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ei(Zs,Zs.current),r)break;return null;case 22:case 23:return t.lanes=0,Ia(e,t,n)}return ja(e,t,n)}(e,t,n);ba=0!==(131072&e.flags)}else ba=!1,is&&0!==(1048576&t.flags)&&Zi(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Va(e,t),e=t.pendingProps;var i=$i(t,Ni.current);As(t,n),i=go(null,t,r,e,i,n);var o=vo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,_i(r)?(o=!0,Mi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ms(t),i.updater=ia,t.stateNode=i,i._reactInternals=t,la(t,r,e,n),t=Na(null,t,r,!0,o,n)):(t.tag=0,is&&o&&es(t),xa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Va(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return _u(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===N)return 11;if(e===$)return 14}return 2}(r),e=na(r,e),i){case 0:t=Ea(null,t,r,e,n);break e;case 1:t=Ta(null,t,r,e,n);break e;case 11:t=wa(null,t,r,e,n);break e;case 14:t=ka(null,t,r,na(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ea(e,t,r,i=t.elementType===r?i:na(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ta(e,t,r,i=t.elementType===r?i:na(r,i),n);case 3:e:{if(Aa(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Ls(e,t),Ws(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ra(e,t,r,n,i=ua(Error(s(423)),t));break e}if(r!==i){t=Ra(e,t,r,n,i=ua(Error(s(424)),t));break e}for(rs=ui(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=ws(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),r===i){t=ja(e,t,n);break e}xa(e,t,r,n)}t=t.child}return t;case 5:return Qs(t),null===e&&us(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==o&&ni(r,o)&&(t.flags|=32),Ca(e,t),xa(e,t,a,n),t.child;case 6:return null===e&&us(t),null;case 13:return La(e,t,n);case 4:return Xs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=xs(t,null,r,n):xa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,wa(e,t,r,i=t.elementType===r?i:na(r,i),n);case 7:return xa(e,t,t.pendingProps,n),t.child;case 8:case 12:return xa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Ei(ks,r._currentValue),r._currentValue=a,null!==o)if(ar(o.value,a)){if(o.children===i.children&&!Ai.current){t=ja(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===o.tag){(u=Ps(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}o.lanes|=n,null!==(u=o.alternate)&&(u.lanes|=n),Ns(o.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ns(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}xa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,As(t,n),r=r(i=Rs(i)),t.flags|=1,xa(e,t,r,n),t.child;case 14:return i=na(r=t.type,t.pendingProps),ka(e,t,r,i=na(r.type,i),n);case 15:return Sa(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:na(r,i),Va(e,t),t.tag=1,_i(r)?(e=!0,Mi(t)):e=!1,As(t,n),oa(t,r,i),la(t,r,i,n),Na(null,t,r,!0,e,n);case 19:return Wa(e,t,n);case 22:return Ia(e,t,n)}throw Error(s(156,t.tag))};var qu="function"===typeof reportError?reportError:function(e){console.error(e)};function Ku(e){this._internalRoot=e}function Xu(e){this._internalRoot=e}function Yu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Ju(){}function Zu(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=ju(o);a.call(e)}}Vu(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=ju(o);s.call(e)}}var o=Wu(t,r,e,0,null,!1,0,"",Ju);return e._reactRootContainer=o,e[fi]=o.current,Wr(8===e.nodeType?e.parentNode:e),cu(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=ju(l);a.call(e)}}var l=Bu(e,0,!1,null,0,!1,0,"",Ju);return e._reactRootContainer=l,e[fi]=l.current,Wr(8===e.nodeType?e.parentNode:e),cu((function(){Vu(t,l,n,r)})),l}(n,t,e,i,r);return ju(o)}Xu.prototype.render=Ku.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Vu(e,t,null,null)},Xu.prototype.unmount=Ku.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cu((function(){Vu(null,e,null,null)})),t[fi]=null}},Xu.prototype.unstable_scheduleHydration=function(e){if(e){var t=It();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),ru(t,Qe()),0===(6&Nl)&&(Wl=Qe()+500,Wi()))}break;case 13:cu((function(){var t=Ds(e,1);if(null!==t){var n=eu();nu(t,e,1,n)}})),Hu(e,1)}},kt=function(e){if(13===e.tag){var t=Ds(e,134217728);if(null!==t)nu(t,e,134217728,eu());Hu(e,134217728)}},St=function(e){if(13===e.tag){var t=tu(e),n=Ds(e,t);if(null!==n)nu(n,e,t,eu());Hu(e,t)}},It=function(){return bt},Ct=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(s(90));q(r),J(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ne=uu,Ae=cu;var ec={usingClientEntryPoint:!1,Events:[bi,xi,wi,Ee,Te,uu]},tc={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nc={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{it=rc.inject(nc),st=rc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yu(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yu(e))throw Error(s(299));var n=!1,r="",i=qu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Bu(e,1,!1,null,0,n,0,r,i),e[fi]=t.current,Wr(8===e.nodeType?e.parentNode:e),new Ku(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return cu(e)},t.hydrate=function(e,t,n){if(!Qu(t))throw Error(s(200));return Zu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yu(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=qu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Wu(t,null,e,1,null!=n?n:null,i,0,o,a),e[fi]=t.current,Wr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Xu(t)},t.render=function(e,t,n){if(!Qu(t))throw Error(s(200));return Zu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qu(e))throw Error(s(40));return!!e._reactRootContainer&&(cu((function(){Zu(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=uu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Qu(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},3174:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalStyles:()=>k.A,StyledEngineProvider:()=>w,ThemeContext:()=>i.T,css:()=>v.AH,default:()=>S,internal_processStyles:()=>I,keyframes:()=>v.i7});var r=n(8168),i=n(9369),s=n(6598),o=n(9436),a=n(1722),l=n(5043),u=n(918),c=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,h=(0,u.A)((function(e){return c.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),d=function(e){return"theme"!==e},p=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?h:d},f=function(e,t,n){var r;if(t){var i=t.shouldForwardProp;r=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},m=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return(0,a.SF)(t,n,r),(0,o.s)((function(){return(0,a.sk)(t,n,r)})),null},g=function e(t,n){var o,u,c=t.__emotion_real===t,h=c&&t.__emotion_base||t;void 0!==n&&(o=n.label,u=n.target);var d=f(t,n,c),g=d||p(h),v=!g("as");return function(){var y=arguments,b=c&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==o&&b.push("label:"+o+";"),null==y[0]||void 0===y[0].raw)b.push.apply(b,y);else{var x=y[0];b.push(x[0]);for(var w=y.length,k=1;k<w;k++)b.push(y[k],x[k])}var S=(0,i.w)((function(e,t,n){var r=v&&e.as||h,o="",c=[],f=e;if(null==e.theme){for(var y in f={},e)f[y]=e[y];f.theme=l.useContext(i.T)}"string"===typeof e.className?o=(0,a.Rk)(t.registered,c,e.className):null!=e.className&&(o=e.className+" ");var x=(0,s.J)(b.concat(c),t.registered,f);o+=t.key+"-"+x.name,void 0!==u&&(o+=" "+u);var w=v&&void 0===d?p(r):g,k={};for(var S in e)v&&"as"===S||w(S)&&(k[S]=e[S]);return k.className=o,n&&(k.ref=n),l.createElement(l.Fragment,null,l.createElement(m,{cache:t,serialized:x,isStringTag:"string"===typeof r}),l.createElement(r,k))}));return S.displayName=void 0!==o?o:"Styled("+("string"===typeof h?h:h.displayName||h.name||"Component")+")",S.defaultProps=t.defaultProps,S.__emotion_real=S,S.__emotion_base=h,S.__emotion_styles=b,S.__emotion_forwardProp=d,Object.defineProperty(S,"toString",{value:function(){return"."+u}}),S.withComponent=function(t,i){return e(t,(0,r.A)({},n,i,{shouldForwardProp:f(S,i,!0)})).apply(void 0,b)},S}}.bind(null);["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){g[e]=g(e)}));var v=n(3290),y=n(3803),b=n(579);let x;function w(e){const{injectFirst:t,children:n}=e;return t&&x?(0,b.jsx)(i.C,{value:x,children:n}):n}"object"===typeof document&&(x=(0,y.A)({key:"css",prepend:!0}));var k=n(869);function S(e,t){return g(e,t)}const I=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}},3234:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A,extendSxProp:()=>i.A,unstable_createStyleFunctionSx:()=>r.k,unstable_defaultSxConfig:()=>s.A});var r=n(8812),i=n(8698),s=n(7758)},3290:(e,t,n)=>{"use strict";n.d(t,{AH:()=>c,i7:()=>h,mL:()=>u});var r=n(9369),i=n(5043),s=n(1722),o=n(9436),a=n(6598),l=(n(3803),n(219),function(e,t){var n=arguments;if(null==t||!r.h.call(t,"css"))return i.createElement.apply(void 0,n);var s=n.length,o=new Array(s);o[0]=r.E,o[1]=(0,r.c)(e,t);for(var a=2;a<s;a++)o[a]=n[a];return i.createElement.apply(null,o)});!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(l||(l={}));var u=(0,r.w)((function(e,t){var n=e.styles,l=(0,a.J)([n],void 0,i.useContext(r.T)),u=i.useRef();return(0,o.i)((function(){var e=t.key+"-global",n=new t.sheet.constructor({key:e,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),r=!1,i=document.querySelector('style[data-emotion="'+e+" "+l.name+'"]');return t.sheet.tags.length&&(n.before=t.sheet.tags[0]),null!==i&&(r=!0,i.setAttribute("data-emotion",e),n.hydrate([i])),u.current=[n,r],function(){n.flush()}}),[t]),(0,o.i)((function(){var e=u.current,n=e[0];if(e[1])e[1]=!1;else{if(void 0!==l.next&&(0,s.sk)(t,l.next,!0),n.tags.length){var r=n.tags[n.tags.length-1].nextElementSibling;n.before=r,n.flush()}t.insert("",l,n,!1)}}),[t,l.name]),null}));function c(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.J)(t)}function h(){var e=c.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}},3382:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l,getFunctionName:()=>s});var r=n(528);const i=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function s(e){const t=`${e}`.match(i);return t&&t[1]||""}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.displayName||e.name||s(e)||t}function a(e,t,n){const r=o(t);return e.displayName||(""!==r?`${n}(${r})`:n)}function l(e){if(null!=e){if("string"===typeof e)return e;if("function"===typeof e)return o(e,"Component");if("object"===typeof e)switch(e.$$typeof){case r.vM:return a(e,e.render,"ForwardRef");case r.lD:return a(e,e.type,"memo");default:return}}}},3763:(e,t,n)=>{"use strict";e.exports=n(4983)},3803:(e,t,n)=>{"use strict";n.d(t,{A:()=>ie});var r=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),i=Math.abs,s=String.fromCharCode,o=Object.assign;function a(e){return e.trim()}function l(e,t,n){return e.replace(t,n)}function u(e,t){return e.indexOf(t)}function c(e,t){return 0|e.charCodeAt(t)}function h(e,t,n){return e.slice(t,n)}function d(e){return e.length}function p(e){return e.length}function f(e,t){return t.push(e),e}var m=1,g=1,v=0,y=0,b=0,x="";function w(e,t,n,r,i,s,o){return{value:e,root:t,parent:n,type:r,props:i,children:s,line:m,column:g,length:o,return:""}}function k(e,t){return o(w("",null,null,"",null,null,0),e,{length:-e.length},t)}function S(){return b=y>0?c(x,--y):0,g--,10===b&&(g=1,m--),b}function I(){return b=y<v?c(x,y++):0,g++,10===b&&(g=1,m++),b}function C(){return c(x,y)}function E(){return y}function T(e,t){return h(x,e,t)}function N(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function A(e){return m=g=1,v=d(x=e),y=0,[]}function R(e){return x="",e}function $(e){return a(T(y-1,D(91===e?e+2:40===e?e+1:e)))}function _(e){for(;(b=C())&&b<33;)I();return N(e)>2||N(b)>3?"":" "}function O(e,t){for(;--t&&I()&&!(b<48||b>102||b>57&&b<65||b>70&&b<97););return T(e,E()+(t<6&&32==C()&&32==I()))}function D(e){for(;I();)switch(b){case e:return y;case 34:case 39:34!==e&&39!==e&&D(b);break;case 40:41===e&&D(e);break;case 92:I()}return y}function F(e,t){for(;I()&&e+b!==57&&(e+b!==84||47!==C()););return"/*"+T(t,y-1)+"*"+s(47===e?e:I())}function M(e){for(;!N(C());)I();return T(e,y)}var L="-ms-",P="-moz-",z="-webkit-",B="comm",U="rule",W="decl",V="@keyframes";function j(e,t){for(var n="",r=p(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function G(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case W:return e.return=e.return||e.value;case B:return"";case V:return e.return=e.value+"{"+j(e.children,r)+"}";case U:e.value=e.props.join(",")}return d(n=j(e.children,r))?e.return=e.value+"{"+n+"}":""}function H(e){return R(q("",null,null,null,[""],e=A(e),0,[0],e))}function q(e,t,n,r,i,o,a,h,p){for(var m=0,g=0,v=a,y=0,b=0,x=0,w=1,k=1,T=1,N=0,A="",R=i,D=o,L=r,P=A;k;)switch(x=N,N=I()){case 40:if(108!=x&&58==c(P,v-1)){-1!=u(P+=l($(N),"&","&\f"),"&\f")&&(T=-1);break}case 34:case 39:case 91:P+=$(N);break;case 9:case 10:case 13:case 32:P+=_(x);break;case 92:P+=O(E()-1,7);continue;case 47:switch(C()){case 42:case 47:f(X(F(I(),E()),t,n),p);break;default:P+="/"}break;case 123*w:h[m++]=d(P)*T;case 125*w:case 59:case 0:switch(N){case 0:case 125:k=0;case 59+g:-1==T&&(P=l(P,/\f/g,"")),b>0&&d(P)-v&&f(b>32?Y(P+";",r,n,v-1):Y(l(P," ","")+";",r,n,v-2),p);break;case 59:P+=";";default:if(f(L=K(P,t,n,m,g,i,h,A,R=[],D=[],v),o),123===N)if(0===g)q(P,t,L,L,R,o,v,h,D);else switch(99===y&&110===c(P,3)?100:y){case 100:case 108:case 109:case 115:q(e,L,L,r&&f(K(e,L,L,0,0,i,h,A,i,R=[],v),D),i,D,v,h,r?R:D);break;default:q(P,L,L,L,[""],D,0,h,D)}}m=g=b=0,w=T=1,A=P="",v=a;break;case 58:v=1+d(P),b=x;default:if(w<1)if(123==N)--w;else if(125==N&&0==w++&&125==S())continue;switch(P+=s(N),N*w){case 38:T=g>0?1:(P+="\f",-1);break;case 44:h[m++]=(d(P)-1)*T,T=1;break;case 64:45===C()&&(P+=$(I())),y=C(),g=v=d(A=P+=M(E())),N++;break;case 45:45===x&&2==d(P)&&(w=0)}}return o}function K(e,t,n,r,s,o,u,c,d,f,m){for(var g=s-1,v=0===s?o:[""],y=p(v),b=0,x=0,k=0;b<r;++b)for(var S=0,I=h(e,g+1,g=i(x=u[b])),C=e;S<y;++S)(C=a(x>0?v[S]+" "+I:l(I,/&\f/g,v[S])))&&(d[k++]=C);return w(e,t,n,0===s?U:c,d,f,m)}function X(e,t,n){return w(e,t,n,B,s(b),h(e,2,-2),0)}function Y(e,t,n,r){return w(e,t,n,W,h(e,0,r),h(e,r+1,-1),r)}var Q=function(e,t,n){for(var r=0,i=0;r=i,i=C(),38===r&&12===i&&(t[n]=1),!N(i);)I();return T(e,y)},J=function(e,t){return R(function(e,t){var n=-1,r=44;do{switch(N(r)){case 0:38===r&&12===C()&&(t[n]=1),e[n]+=Q(y-1,t,n);break;case 2:e[n]+=$(r);break;case 4:if(44===r){e[++n]=58===C()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=s(r)}}while(r=I());return e}(A(e),t))},Z=new WeakMap,ee=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Z.get(n))&&!r){Z.set(e,!0);for(var i=[],s=J(t,i),o=n.props,a=0,l=0;a<s.length;a++)for(var u=0;u<o.length;u++,l++)e.props[l]=i[a]?s[a].replace(/&\f/g,o[u]):o[u]+" "+s[a]}}},te=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function ne(e,t){switch(function(e,t){return 45^c(e,0)?(((t<<2^c(e,0))<<2^c(e,1))<<2^c(e,2))<<2^c(e,3):0}(e,t)){case 5103:return z+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return z+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return z+e+P+e+L+e+e;case 6828:case 4268:return z+e+L+e+e;case 6165:return z+e+L+"flex-"+e+e;case 5187:return z+e+l(e,/(\w+).+(:[^]+)/,z+"box-$1$2"+L+"flex-$1$2")+e;case 5443:return z+e+L+"flex-item-"+l(e,/flex-|-self/,"")+e;case 4675:return z+e+L+"flex-line-pack"+l(e,/align-content|flex-|-self/,"")+e;case 5548:return z+e+L+l(e,"shrink","negative")+e;case 5292:return z+e+L+l(e,"basis","preferred-size")+e;case 6060:return z+"box-"+l(e,"-grow","")+z+e+L+l(e,"grow","positive")+e;case 4554:return z+l(e,/([^-])(transform)/g,"$1"+z+"$2")+e;case 6187:return l(l(l(e,/(zoom-|grab)/,z+"$1"),/(image-set)/,z+"$1"),e,"")+e;case 5495:case 3959:return l(e,/(image-set\([^]*)/,z+"$1$`$1");case 4968:return l(l(e,/(.+:)(flex-)?(.*)/,z+"box-pack:$3"+L+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+z+e+e;case 4095:case 3583:case 4068:case 2532:return l(e,/(.+)-inline(.+)/,z+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(d(e)-1-t>6)switch(c(e,t+1)){case 109:if(45!==c(e,t+4))break;case 102:return l(e,/(.+:)(.+)-([^]+)/,"$1"+z+"$2-$3$1"+P+(108==c(e,t+3)?"$3":"$2-$3"))+e;case 115:return~u(e,"stretch")?ne(l(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==c(e,t+1))break;case 6444:switch(c(e,d(e)-3-(~u(e,"!important")&&10))){case 107:return l(e,":",":"+z)+e;case 101:return l(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+z+(45===c(e,14)?"inline-":"")+"box$3$1"+z+"$2$3$1"+L+"$2box$3")+e}break;case 5936:switch(c(e,t+11)){case 114:return z+e+L+l(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return z+e+L+l(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return z+e+L+l(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return z+e+L+e+e}return e}var re=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case W:e.return=ne(e.value,e.length);break;case V:return j([k(e,{value:l(e.value,"@","@"+z)})],r);case U:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return j([k(e,{props:[l(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return j([k(e,{props:[l(t,/:(plac\w+)/,":"+z+"input-$1")]}),k(e,{props:[l(t,/:(plac\w+)/,":-moz-$1")]}),k(e,{props:[l(t,/:(plac\w+)/,L+"input-$1")]})],r)}return""}))}}],ie=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var i,s,o=e.stylisPlugins||re,a={},l=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)a[t[n]]=!0;l.push(e)}));var u,c,h=[G,(c=function(e){u.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],d=function(e){var t=p(e);return function(n,r,i,s){for(var o="",a=0;a<t;a++)o+=e[a](n,r,i,s)||"";return o}}([ee,te].concat(o,h));s=function(e,t,n,r){u=n,j(H(e?e+"{"+t.styles+"}":t.styles),d),r&&(f.inserted[t.name]=!0)};var f={key:t,sheet:new r({key:t,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:s};return f.sheet.hydrate(l),f}},3815:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(9172);const i=function(e,t){return t?(0,r.A)(e,t,{clone:!1}):e}},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,m(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)k.call(t,i)&&!I.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:S.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+N(l,0):s,w(o)?(i="",null!=e&&(i=e.replace(T,"$&/")+"/"),A(o,t,i,"",(function(e){return e}))):null!=o&&(E(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(T,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",w(e))for(var u=0;u<e.length;u++){var c=s+N(a=e[u],u);l+=A(a,t,i,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(a=e.next()).done;)l+=A(a=a.value,t,i,c=s+N(a,u++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function R(e,t,n){if(null==e)return e;var r=[],i=0;return A(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function $(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var _={current:null},O={transition:null},D={ReactCurrentDispatcher:_,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};function F(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=F,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)k.call(t,u)&&!I.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:$}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=F,t.useCallback=function(e,t){return _.current.useCallback(e,t)},t.useContext=function(e){return _.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return _.current.useDeferredValue(e)},t.useEffect=function(e,t){return _.current.useEffect(e,t)},t.useId=function(){return _.current.useId()},t.useImperativeHandle=function(e,t,n){return _.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return _.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return _.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return _.current.useMemo(e,t)},t.useReducer=function(e,t,n){return _.current.useReducer(e,t,n)},t.useRef=function(e){return _.current.useRef(e)},t.useState=function(e){return _.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return _.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return _.current.useTransition()},t.version="18.3.1"},4334:(e,t,n)=>{var r=n(7359),i=n(7066),s=n(9016),o=n(9538),a=n(6288),l=n(5262),u=n(2430);u.alea=r,u.xor128=i,u.xorwow=s,u.xorshift7=o,u.xor4096=a,u.tychei=l,e.exports=u},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4530:()=>{},4634:e=>{function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4853:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(8587),i=n(8168);const s=["values","unit","step"],o=e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>(0,i.A)({},e,{[t.key]:t.val})),{})};function a(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:a=5}=e,l=(0,r.A)(e,s),u=o(t),c=Object.keys(u);function h(e){return`@media (min-width:${"number"===typeof t[e]?t[e]:e}${n})`}function d(e){return`@media (max-width:${("number"===typeof t[e]?t[e]:e)-a/100}${n})`}function p(e,r){const i=c.indexOf(r);return`@media (min-width:${"number"===typeof t[e]?t[e]:e}${n}) and (max-width:${(-1!==i&&"number"===typeof t[c[i]]?t[c[i]]:r)-a/100}${n})`}return(0,i.A)({keys:c,values:u,up:h,down:d,between:p,only:function(e){return c.indexOf(e)+1<c.length?p(e,c[c.indexOf(e)+1]):h(e)},not:function(e){const t=c.indexOf(e);return 0===t?h(c[1]):t===c.length-1?d(c[t]):p(e,c[c.indexOf(e)+1]).replace("@media","@media not all and")},unit:n},l)}},4893:e=>{e.exports=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n},e.exports.__esModule=!0,e.exports.default=e.exports},4983:(e,t)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,s=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case h:case s:case a:case o:case p:return e;default:switch(e=e&&e.$$typeof){case u:case d:case g:case m:case l:return e;default:return t}}case i:return t}}}function k(e){return w(e)===h}t.AsyncMode=c,t.ConcurrentMode=h,t.ContextConsumer=u,t.ContextProvider=l,t.Element=r,t.ForwardRef=d,t.Fragment=s,t.Lazy=g,t.Memo=m,t.Portal=i,t.Profiler=a,t.StrictMode=o,t.Suspense=p,t.isAsyncMode=function(e){return k(e)||w(e)===c},t.isConcurrentMode=k,t.isContextConsumer=function(e){return w(e)===u},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===d},t.isFragment=function(e){return w(e)===s},t.isLazy=function(e){return w(e)===g},t.isMemo=function(e){return w(e)===m},t.isPortal=function(e){return w(e)===i},t.isProfiler=function(e){return w(e)===a},t.isStrictMode=function(e){return w(e)===o},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===s||e===h||e===a||e===o||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===d||e.$$typeof===y||e.$$typeof===b||e.$$typeof===x||e.$$typeof===v)},t.typeOf=w},4989:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A,private_createBreakpoints:()=>i.A,unstable_applyStyles:()=>s.A});var r=n(8280),i=n(4853),s=n(9703)},4994:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5262:function(e,t,n){var r;!function(e,i){function s(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function a(e,t){var n=new s(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=a:n.amdD&&n.amdO?void 0===(r=function(){return a}.call(t,n,t,i))||(i.exports=r):this.tychei=a}(0,e=n.nmd(e),n.amdD)},5817:()=>{},6288:function(e,t,n){var r;!function(e,i){function s(e){var t=this;t.next=function(){var e,n,r=t.w,i=t.X,s=t.i;return t.w=r=r+1640531527|0,n=i[s+34&127],e=i[s=s+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[s]=n^e,t.i=s,n+(r^r>>>16)|0},function(e,t){var n,r,i,s,o,a=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),i=0,s=-32;s<l;++s)t&&(r^=t.charCodeAt((s+32)%t.length)),0===s&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,s>=0&&(o=o+1640531527|0,i=0==(n=a[127&s]^=r+o)?i+1:0);for(i>=128&&(a[127&(t&&t.length||0)]=-1),i=127,s=512;s>0;--s)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,a[i]=r^n;e.w=o,e.X=a,e.i=i}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function a(e,t){null==e&&(e=+new Date);var n=new s(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.X&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=a:n.amdD&&n.amdO?void 0===(r=function(){return a}.call(t,n,t,i))||(i.exports=r):this.xor4096=a}(0,e=n.nmd(e),n.amdD)},6531:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A});var r=n(1188)},6598:(e,t,n)=>{"use strict";n.d(t,{J:()=>g});var r={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},i=n(918),s=!1,o=/[A-Z]|^ms/g,a=/_EMO_([^_]+?)_([^]*?)_EMO_/g,l=function(e){return 45===e.charCodeAt(1)},u=function(e){return null!=e&&"boolean"!==typeof e},c=(0,i.A)((function(e){return l(e)?e:e.replace(o,"-$&").toLowerCase()})),h=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(a,(function(e,t,n){return f={name:t,styles:n,next:f},t}))}return 1===r[e]||l(e)||"number"!==typeof t||0===t?t:t+"px"},d="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function p(e,t,n){if(null==n)return"";var r=n;if(void 0!==r.__emotion_styles)return r;switch(typeof n){case"boolean":return"";case"object":var i=n;if(1===i.anim)return f={name:i.name,styles:i.styles,next:f},i.name;var o=n;if(void 0!==o.styles){var a=o.next;if(void 0!==a)for(;void 0!==a;)f={name:a.name,styles:a.styles,next:f},a=a.next;return o.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=p(e,t,n[i])+";";else for(var o in n){var a=n[o];if("object"!==typeof a){var l=a;null!=t&&void 0!==t[l]?r+=o+"{"+t[l]+"}":u(l)&&(r+=c(o)+":"+h(o,l)+";")}else{if("NO_COMPONENT_SELECTOR"===o&&s)throw new Error(d);if(!Array.isArray(a)||"string"!==typeof a[0]||null!=t&&void 0!==t[a[0]]){var f=p(e,t,a);switch(o){case"animation":case"animationName":r+=c(o)+":"+f+";";break;default:r+=o+"{"+f+"}"}}else for(var m=0;m<a.length;m++)u(a[m])&&(r+=c(o)+":"+h(o,a[m])+";")}}return r}(e,t,n);case"function":if(void 0!==e){var l=f,m=n(e);return f=l,p(e,t,m)}}var g=n;if(null==t)return g;var v=t[g];return void 0!==v?v:g}var f,m=/label:\s*([^\s;{]+)\s*(;|$)/g;function g(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,i="";f=void 0;var s=e[0];null==s||void 0===s.raw?(r=!1,i+=p(n,t,s)):i+=s[0];for(var o=1;o<e.length;o++){if(i+=p(n,t,e[o]),r)i+=s[o]}m.lastIndex=0;for(var a,l="";null!==(a=m.exec(i));)l+="-"+a[1];var u=function(e){for(var t,n=0,r=0,i=e.length;i>=4;++r,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(i)+l;return{name:u,styles:i,next:f}}},7029:function(e,t,n){var r;r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,n){"use strict";n.r(t);var r=n("react"),i=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)},o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function a(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)}"undefined"!==typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise((function(n,r){t.call(navigator,e,n,r)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}));var l=function(e){function t(t){var n=e.call(this,t)||this;return n.canvas=null,n.ctx=null,n.requestUserMediaId=0,n.unmounted=!1,n.state={hasUserMedia:!1},n}return i(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;this.unmounted=!1,a()?(e.hasUserMedia||this.requestUserMedia(),t.children&&"function"!=typeof t.children&&console.warn("children must be a function")):t.onUserMediaError("getUserMedia not supported")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(a()){var n=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),r=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),i=e.minScreenshotWidth!==t.minScreenshotWidth,s=e.minScreenshotHeight!==t.minScreenshotHeight;(r||i||s)&&(this.canvas=null,this.ctx=null),(n||r)&&(this.stopAndCleanup(),this.requestUserMedia())}else t.onUserMediaError("getUserMedia not supported")},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map((function(t){e.removeTrack(t),t.stop()})),e.getAudioTracks().map((function(t){e.removeTrack(t),t.stop()}))):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,n=this.props;if(!t.hasUserMedia)return null;var r=this.getCanvas(e);return r&&r.toDataURL(n.screenshotFormat,n.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,n=this.props;if(!this.video)return null;if(!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var r=this.video.videoWidth,i=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var s=r/i;i=(r=n.minScreenshotWidth||this.video.clientWidth)/s,n.minScreenshotHeight&&i<n.minScreenshotHeight&&(r=(i=n.minScreenshotHeight)*s)}this.canvas=document.createElement("canvas"),this.canvas.width=(null===e||void 0===e?void 0:e.width)||r,this.canvas.height=(null===e||void 0===e?void 0:e.height)||i,this.ctx=this.canvas.getContext("2d")}var o=this.ctx,a=this.canvas;return o&&a&&(a.width=(null===e||void 0===e?void 0:e.width)||a.width,a.height=(null===e||void 0===e?void 0:e.height)||a.height,n.mirrored&&(o.translate(a.width,0),o.scale(-1,1)),o.imageSmoothingEnabled=n.imageSmoothing,o.drawImage(this.video,0,0,(null===e||void 0===e?void 0:e.width)||a.width,(null===e||void 0===e?void 0:e.height)||a.height),n.mirrored&&(o.scale(-1,1),o.translate(-a.width,0))),a},t.prototype.requestUserMedia=function(){var e=this,n=this.props,r=function(r,i){var s={video:"undefined"===typeof i||i};n.audio&&(s.audio="undefined"===typeof r||r),e.requestUserMediaId++;var o=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(s).then((function(n){e.unmounted||o!==e.requestUserMediaId?t.stopMediaStream(n):e.handleUserMedia(null,n)})).catch((function(t){e.handleUserMedia(t)}))};if("mediaDevices"in navigator)r(n.audioConstraints,n.videoConstraints);else{var i=function(e){return{optional:[{sourceId:e}]}},s=function(e){var t=e.deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources((function(e){var t=null,o=null;e.forEach((function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(o=e.id)}));var a=s(n.audioConstraints);a&&(t=a);var l=s(n.videoConstraints);l&&(o=l),r(i(t),i(o))}))}},t.prototype.handleUserMedia=function(e,t){var n=this.props;if(e||!t)return this.setState({hasUserMedia:!1}),void n.onUserMediaError(e);this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(r){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}n.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,n=this.props,i=n.audio,a=(n.forceScreenshotSourceSize,n.disablePictureInPicture),l=(n.onUserMedia,n.onUserMediaError,n.screenshotFormat,n.screenshotQuality,n.minScreenshotWidth,n.minScreenshotHeight,n.audioConstraints,n.videoConstraints,n.imageSmoothing,n.mirrored),u=n.style,c=void 0===u?{}:u,h=n.children,d=o(n,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),p=l?s(s({},c),{transform:(c.transform||"")+" scaleX(-1)"}):c,f={getScreenshot:this.getScreenshot.bind(this)};return r.createElement(r.Fragment,null,r.createElement("video",s({autoPlay:!0,disablePictureInPicture:a,src:t.src,muted:!i,playsInline:!0,ref:function(t){e.video=t},style:p},d)),h&&h(f))},t.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(r.Component);t.default=l},react:function(t,n){t.exports=e}}).default},e.exports=r(n(5043))},7066:function(e,t,n){var r;!function(e,i){function s(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function a(e,t){var n=new s(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=a:n.amdD&&n.amdO?void 0===(r=function(){return a}.call(t,n,t,i))||(i.exports=r):this.xor128=a}(0,e=n.nmd(e),n.amdD)},7162:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>a,BO:()=>o,Yn:()=>s});var r=n(7598),i=n(9751);function s(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){const n=`vars.${t}`.split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=n)return n}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function o(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||i:s(e,n)||i,t&&(r=t(r,i,e)),r}const a=function(e){const{prop:t,cssProperty:n=e.prop,themeKey:a,transform:l}=e,u=e=>{if(null==e[t])return null;const u=e[t],c=s(e.theme,a)||{};return(0,i.NI)(e,u,(e=>{let i=o(c,l,e);return e===i&&"string"===typeof e&&(i=o(c,l,`${t}${"default"===e?"":(0,r.A)(e)}`,e)),!1===n?i:{[n]:i}}))};return u.propTypes={},u.filterProps=[t],u}},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],u=a+1,c=e[u];if(0>s(l,n))u<i&&0>s(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[a]=n,r=a);else{if(!(u<i&&0>s(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],c=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function w(e){if(g=!1,x(e),!m)if(null!==r(u))m=!0,O(k);else{var t=r(c);null!==t&&D(w,t.startTime-e)}}function k(e,n){m=!1,g&&(g=!1,y(E),E=-1),f=!0;var s=p;try{for(x(n),d=r(u);null!==d&&(!(d.expirationTime>n)||e&&!A());){var o=d.callback;if("function"===typeof o){d.callback=null,p=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(u)&&i(u),x(n)}else i(u);d=r(u)}if(null!==d)var l=!0;else{var h=r(c);null!==h&&D(w,h.startTime-n),l=!1}return l}finally{d=null,p=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,I=!1,C=null,E=-1,T=5,N=-1;function A(){return!(t.unstable_now()-N<T)}function R(){if(null!==C){var e=t.unstable_now();N=e;var n=!0;try{n=C(!0,e)}finally{n?S():(I=!1,C=null)}}else I=!1}if("function"===typeof b)S=function(){b(R)};else if("undefined"!==typeof MessageChannel){var $=new MessageChannel,_=$.port2;$.port1.onmessage=R,S=function(){_.postMessage(null)}}else S=function(){v(R,0)};function O(e){C=e,I||(I=!0,S())}function D(e,n){E=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,O(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(c,e),null===r(u)&&e===r(c)&&(g?(y(E),E=-1):g=!0,D(w,s-o))):(e.sortIndex=a,n(u,e),m||f||(m=!0,O(k))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},7266:(e,t,n)=>{"use strict";var r=n(4994);t.X4=p,t.e$=f,t.eM=function(e,t){const n=d(e),r=d(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},t.a=m;var i=r(n(457)),s=r(n(6531));function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,s.default)(e,t,n)}function a(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&1===n[0].length&&(n=n.map((e=>e+e))),n?`rgb${4===n.length?"a":""}(${n.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", ")})`:""}function l(e){if(e.type)return e;if("#"===e.charAt(0))return l(a(e));const t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error((0,i.default)(9,e));let r,s=e.substring(t+1,e.length-1);if("color"===n){if(s=s.split(" "),r=s.shift(),4===s.length&&"/"===s[3].charAt(0)&&(s[3]=s[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error((0,i.default)(10,r))}else s=s.split(",");return s=s.map((e=>parseFloat(e))),{type:n,values:s,colorSpace:r}}const u=e=>{const t=l(e);return t.values.slice(0,3).map(((e,n)=>-1!==t.type.indexOf("hsl")&&0!==n?`${e}%`:e)).join(" ")};function c(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return-1!==t.indexOf("rgb")?r=r.map(((e,t)=>t<3?parseInt(e,10):e)):-1!==t.indexOf("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),r=-1!==t.indexOf("color")?`${n} ${r.join(" ")}`:`${r.join(", ")}`,`${t}(${r})`}function h(e){e=l(e);const{values:t}=e,n=t[0],r=t[1]/100,i=t[2]/100,s=r*Math.min(i,1-i),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return i-s*Math.max(Math.min(t-3,9-t,1),-1)};let a="rgb";const u=[Math.round(255*o(0)),Math.round(255*o(8)),Math.round(255*o(4))];return"hsla"===e.type&&(a+="a",u.push(t[3])),c({type:a,values:u})}function d(e){let t="hsl"===(e=l(e)).type||"hsla"===e.type?l(h(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function p(e,t){return e=l(e),t=o(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,c(e)}function f(e,t){if(e=l(e),t=o(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return c(e)}function m(e,t){if(e=l(e),t=o(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return c(e)}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return d(e)>.5?f(e,t):m(e,t)}},7353:e=>{e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(C){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var i={},s={};function o(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=s[e])?r:(n=l(e,(0|e)<0?-1:0,!0),o&&(s[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=i[e])?r:(n=l(e,e<0?-1:0,!1),o&&(i[e]=n),n)}function a(e,t){if(isNaN(e))return t?v:g;if(t){if(e<0)return v;if(e>=p)return k}else{if(e<=-f)return S;if(e+1>=f)return w}return e<0?a(-e,t).neg():l(e%d|0,e/d|0,t)}function l(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=a,n.fromBits=l;var u=Math.pow;function c(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return c(e.substring(1),t,n).neg();for(var i=a(u(n,8)),s=g,o=0;o<e.length;o+=8){var l=Math.min(8,e.length-o),h=parseInt(e.substring(o,o+l),n);if(l<8){var d=a(u(n,l));s=s.mul(d).add(a(h))}else s=(s=s.mul(i)).add(a(h))}return s.unsigned=t,s}function h(e,t){return"number"===typeof e?a(e,t):"string"===typeof e?c(e,t):l(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=c,n.fromValue=h;var d=4294967296,p=d*d,f=p/2,m=o(1<<24),g=o(0);n.ZERO=g;var v=o(0,!0);n.UZERO=v;var y=o(1);n.ONE=y;var b=o(1,!0);n.UONE=b;var x=o(-1);n.NEG_ONE=x;var w=l(-1,2147483647,!1);n.MAX_VALUE=w;var k=l(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var S=l(0,-2147483648,!1);n.MIN_VALUE=S;var I=n.prototype;I.toInt=function(){return this.unsigned?this.low>>>0:this.low},I.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},I.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=a(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=a(u(e,6),this.unsigned),s=this,o="";;){var l=s.div(i),c=(s.sub(l.mul(i)).toInt()>>>0).toString(e);if((s=l).isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}},I.getHighBits=function(){return this.high},I.getHighBitsUnsigned=function(){return this.high>>>0},I.getLowBits=function(){return this.low},I.getLowBitsUnsigned=function(){return this.low>>>0},I.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},I.isZero=function(){return 0===this.high&&0===this.low},I.eqz=I.isZero,I.isNegative=function(){return!this.unsigned&&this.high<0},I.isPositive=function(){return this.unsigned||this.high>=0},I.isOdd=function(){return 1===(1&this.low)},I.isEven=function(){return 0===(1&this.low)},I.equals=function(e){return r(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},I.eq=I.equals,I.notEquals=function(e){return!this.eq(e)},I.neq=I.notEquals,I.ne=I.notEquals,I.lessThan=function(e){return this.comp(e)<0},I.lt=I.lessThan,I.lessThanOrEqual=function(e){return this.comp(e)<=0},I.lte=I.lessThanOrEqual,I.le=I.lessThanOrEqual,I.greaterThan=function(e){return this.comp(e)>0},I.gt=I.greaterThan,I.greaterThanOrEqual=function(e){return this.comp(e)>=0},I.gte=I.greaterThanOrEqual,I.ge=I.greaterThanOrEqual,I.compare=function(e){if(r(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},I.comp=I.compare,I.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(y)},I.neg=I.negate,I.add=function(e){r(e)||(e=h(e));var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,s=65535&this.low,o=e.high>>>16,a=65535&e.high,u=e.low>>>16,c=0,d=0,p=0,f=0;return p+=(f+=s+(65535&e.low))>>>16,d+=(p+=i+u)>>>16,c+=(d+=n+a)>>>16,c+=t+o,l((p&=65535)<<16|(f&=65535),(c&=65535)<<16|(d&=65535),this.unsigned)},I.subtract=function(e){return r(e)||(e=h(e)),this.add(e.neg())},I.sub=I.subtract,I.multiply=function(e){if(this.isZero())return g;if(r(e)||(e=h(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(S))return e.isOdd()?S:g;if(e.eq(S))return this.isOdd()?S:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return a(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,i=65535&this.high,s=this.low>>>16,o=65535&this.low,u=e.high>>>16,c=65535&e.high,d=e.low>>>16,p=65535&e.low,f=0,v=0,y=0,b=0;return y+=(b+=o*p)>>>16,v+=(y+=s*p)>>>16,y&=65535,v+=(y+=o*d)>>>16,f+=(v+=i*p)>>>16,v&=65535,f+=(v+=s*d)>>>16,v&=65535,f+=(v+=o*c)>>>16,f+=n*p+i*d+s*c+o*u,l((y&=65535)<<16|(b&=65535),(f&=65535)<<16|(v&=65535),this.unsigned)},I.mul=I.multiply,I.divide=function(e){if(r(e)||(e=h(e)),e.isZero())throw Error("division by zero");var n,i,s;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return b;s=v}else{if(this.eq(S))return e.eq(y)||e.eq(x)?S:e.eq(S)?y:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?y:x:(i=this.sub(e.mul(n)),s=n.add(i.div(e)));if(e.eq(S))return this.unsigned?v:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=g}for(i=this;i.gte(e);){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),c=o<=48?1:u(2,o-48),d=a(n),p=d.mul(e);p.isNegative()||p.gt(i);)p=(d=a(n-=c,this.unsigned)).mul(e);d.isZero()&&(d=y),s=s.add(d),i=i.sub(p)}return s},I.div=I.divide,I.modulo=function(e){return r(e)||(e=h(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},I.mod=I.modulo,I.rem=I.modulo,I.not=function(){return l(~this.low,~this.high,this.unsigned)},I.and=function(e){return r(e)||(e=h(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},I.or=function(e){return r(e)||(e=h(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},I.xor=function(e){return r(e)||(e=h(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},I.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},I.shl=I.shiftLeft,I.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},I.shr=I.shiftRight,I.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},I.shru=I.shiftRightUnsigned,I.shr_u=I.shiftRightUnsigned,I.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},I.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},I.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},I.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},I.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},7359:function(e,t,n){var r;!function(e,i){function s(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function a(e,t){var n=new s(e),r=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=a:n.amdD&&n.amdO?void 0===(r=function(){return a}.call(t,n,t,i))||(i.exports=r):this.alea=a}(0,e=n.nmd(e),n.amdD)},7598:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(7868);function i(e){if("string"!==typeof e)throw new Error((0,r.A)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},7758:(e,t,n)=>{"use strict";n.d(t,{A:()=>D});var r=n(8604),i=n(7162),s=n(3815);const o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>(t.filterProps.forEach((n=>{e[n]=t})),e)),{}),i=e=>Object.keys(e).reduce(((t,n)=>r[n]?(0,s.A)(t,r[n](e)):t),{});return i.propTypes={},i.filterProps=t.reduce(((e,t)=>e.concat(t.filterProps)),[]),i};var a=n(9751);function l(e){return"number"!==typeof e?e:`${e}px solid`}function u(e,t){return(0,i.Ay)({prop:e,themeKey:"borders",transform:t})}const c=u("border",l),h=u("borderTop",l),d=u("borderRight",l),p=u("borderBottom",l),f=u("borderLeft",l),m=u("borderColor"),g=u("borderTopColor"),v=u("borderRightColor"),y=u("borderBottomColor"),b=u("borderLeftColor"),x=u("outline",l),w=u("outlineColor"),k=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=(0,r.MA)(e.theme,"shape.borderRadius",4,"borderRadius"),n=e=>({borderRadius:(0,r._W)(t,e)});return(0,a.NI)(e,e.borderRadius,n)}return null};k.propTypes={},k.filterProps=["borderRadius"];o(c,h,d,p,f,m,g,v,y,b,k,x,w);const S=e=>{if(void 0!==e.gap&&null!==e.gap){const t=(0,r.MA)(e.theme,"spacing",8,"gap"),n=e=>({gap:(0,r._W)(t,e)});return(0,a.NI)(e,e.gap,n)}return null};S.propTypes={},S.filterProps=["gap"];const I=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=(0,r.MA)(e.theme,"spacing",8,"columnGap"),n=e=>({columnGap:(0,r._W)(t,e)});return(0,a.NI)(e,e.columnGap,n)}return null};I.propTypes={},I.filterProps=["columnGap"];const C=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=(0,r.MA)(e.theme,"spacing",8,"rowGap"),n=e=>({rowGap:(0,r._W)(t,e)});return(0,a.NI)(e,e.rowGap,n)}return null};C.propTypes={},C.filterProps=["rowGap"];o(S,I,C,(0,i.Ay)({prop:"gridColumn"}),(0,i.Ay)({prop:"gridRow"}),(0,i.Ay)({prop:"gridAutoFlow"}),(0,i.Ay)({prop:"gridAutoColumns"}),(0,i.Ay)({prop:"gridAutoRows"}),(0,i.Ay)({prop:"gridTemplateColumns"}),(0,i.Ay)({prop:"gridTemplateRows"}),(0,i.Ay)({prop:"gridTemplateAreas"}),(0,i.Ay)({prop:"gridArea"}));function E(e,t){return"grey"===t?t:e}o((0,i.Ay)({prop:"color",themeKey:"palette",transform:E}),(0,i.Ay)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:E}),(0,i.Ay)({prop:"backgroundColor",themeKey:"palette",transform:E}));function T(e){return e<=1&&0!==e?100*e+"%":e}const N=(0,i.Ay)({prop:"width",transform:T}),A=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{var n,r;const i=(null==(n=e.theme)||null==(n=n.breakpoints)||null==(n=n.values)?void 0:n[t])||a.zu[t];return i?"px"!==(null==(r=e.theme)||null==(r=r.breakpoints)?void 0:r.unit)?{maxWidth:`${i}${e.theme.breakpoints.unit}`}:{maxWidth:i}:{maxWidth:T(t)}};return(0,a.NI)(e,e.maxWidth,t)}return null};A.filterProps=["maxWidth"];const R=(0,i.Ay)({prop:"minWidth",transform:T}),$=(0,i.Ay)({prop:"height",transform:T}),_=(0,i.Ay)({prop:"maxHeight",transform:T}),O=(0,i.Ay)({prop:"minHeight",transform:T}),D=((0,i.Ay)({prop:"size",cssProperty:"width",transform:T}),(0,i.Ay)({prop:"size",cssProperty:"height",transform:T}),o(N,A,R,$,_,O,(0,i.Ay)({prop:"boxSizing"})),{border:{themeKey:"borders",transform:l},borderTop:{themeKey:"borders",transform:l},borderRight:{themeKey:"borders",transform:l},borderBottom:{themeKey:"borders",transform:l},borderLeft:{themeKey:"borders",transform:l},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:l},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:k},color:{themeKey:"palette",transform:E},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:E},backgroundColor:{themeKey:"palette",transform:E},p:{style:r.Ms},pt:{style:r.Ms},pr:{style:r.Ms},pb:{style:r.Ms},pl:{style:r.Ms},px:{style:r.Ms},py:{style:r.Ms},padding:{style:r.Ms},paddingTop:{style:r.Ms},paddingRight:{style:r.Ms},paddingBottom:{style:r.Ms},paddingLeft:{style:r.Ms},paddingX:{style:r.Ms},paddingY:{style:r.Ms},paddingInline:{style:r.Ms},paddingInlineStart:{style:r.Ms},paddingInlineEnd:{style:r.Ms},paddingBlock:{style:r.Ms},paddingBlockStart:{style:r.Ms},paddingBlockEnd:{style:r.Ms},m:{style:r.Lc},mt:{style:r.Lc},mr:{style:r.Lc},mb:{style:r.Lc},ml:{style:r.Lc},mx:{style:r.Lc},my:{style:r.Lc},margin:{style:r.Lc},marginTop:{style:r.Lc},marginRight:{style:r.Lc},marginBottom:{style:r.Lc},marginLeft:{style:r.Lc},marginX:{style:r.Lc},marginY:{style:r.Lc},marginInline:{style:r.Lc},marginInlineStart:{style:r.Lc},marginInlineEnd:{style:r.Lc},marginBlock:{style:r.Lc},marginBlockStart:{style:r.Lc},marginBlockEnd:{style:r.Lc},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:S},rowGap:{style:C},columnGap:{style:I},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:T},maxWidth:{style:A},minWidth:{transform:T},height:{transform:T},maxHeight:{transform:T},minHeight:{transform:T},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}})},7868:(e,t,n)=>{"use strict";function r(e){let t="https://mui.com/production-error/?code="+e;for(let n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}n.d(t,{A:()=>r})},7918:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A});var r=n(7598)},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8052:(e,t,n)=>{"use strict";var r=n(4994);t.Ay=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=m,rootShouldForwardProp:r=f,slotShouldForwardProp:l=f}=e,c=e=>(0,u.default)((0,i.default)({},e,{theme:v((0,i.default)({},e,{defaultTheme:n,themeId:t}))}));return c.__mui_systemSx=!0,function(e){let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.internal_processStyles)(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:h,slot:p,skipVariantsResolver:m,skipSx:x,overridesResolver:w=y(g(p))}=u,k=(0,s.default)(u,d),S=void 0!==m?m:p&&"Root"!==p&&"root"!==p||!1,I=x||!1;let C=f;"Root"===p||"root"===p?C=r:p?C=l:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(C=void 0);const E=(0,o.default)(e,(0,i.default)({shouldForwardProp:C,label:undefined},k)),T=e=>"function"===typeof e&&e.__emotion_real!==e||(0,a.isPlainObject)(e)?r=>b(e,(0,i.default)({},r,{theme:v({theme:r.theme,defaultTheme:n,themeId:t})})):e,N=function(r){let s=T(r);for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];const u=a?a.map(T):[];h&&w&&u.push((e=>{const r=v((0,i.default)({},e,{defaultTheme:n,themeId:t}));if(!r.components||!r.components[h]||!r.components[h].styleOverrides)return null;const s=r.components[h].styleOverrides,o={};return Object.entries(s).forEach((t=>{let[n,s]=t;o[n]=b(s,(0,i.default)({},e,{theme:r}))})),w(e,o)})),h&&!S&&u.push((e=>{var r;const s=v((0,i.default)({},e,{defaultTheme:n,themeId:t}));return b({variants:null==s||null==(r=s.components)||null==(r=r[h])?void 0:r.variants},(0,i.default)({},e,{theme:s}))})),I||u.push(c);const d=u.length-a.length;if(Array.isArray(r)&&d>0){const e=new Array(d).fill("");s=[...r,...e],s.raw=[...r.raw,...e]}const p=E(s,...u);return e.muiName&&(p.muiName=e.muiName),p};return E.withConfig&&(N.withConfig=E.withConfig),N}};var i=r(n(4634)),s=r(n(4893)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(r,s,o):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(n(3174)),a=n(9482),l=(r(n(7918)),r(n(3382)),r(n(4989))),u=r(n(3234));const c=["ownerState"],h=["variants"],d=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function f(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const m=(0,l.default)(),g=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function v(e){let{defaultTheme:t,theme:n,themeId:r}=e;return i=n,0===Object.keys(i).length?t:n[r]||n;var i}function y(e){return e?(t,n)=>n[e]:null}function b(e,t){let{ownerState:n}=t,r=(0,s.default)(t,c);const o="function"===typeof e?e((0,i.default)({ownerState:n},r)):e;if(Array.isArray(o))return o.flatMap((e=>b(e,(0,i.default)({ownerState:n},r))));if(o&&"object"===typeof o&&Array.isArray(o.variants)){const{variants:e=[]}=o;let t=(0,s.default)(o,h);return e.forEach((e=>{let s=!0;"function"===typeof e.props?s=e.props((0,i.default)({ownerState:n},r,n)):Object.keys(e.props).forEach((t=>{(null==n?void 0:n[t])!==e.props[t]&&r[t]!==e.props[t]&&(s=!1)})),s&&(Array.isArray(t)||(t=[t]),t.push("function"===typeof e.style?e.style((0,i.default)({ownerState:n},r,n)):e.style))})),t}return o}},8108:()=>{},8168:(e,t,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(null,arguments)}n.d(t,{A:()=>r})},8280:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var r=n(8168),i=n(8587),s=n(9172),o=n(4853);const a={borderRadius:4};var l=n(8604);var u=n(8812),c=n(7758),h=n(9703);const d=["breakpoints","palette","spacing","shape"];const p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:n={},spacing:p,shape:f={}}=e,m=(0,i.A)(e,d),g=(0,o.A)(t),v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;const t=(0,l.LX)({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0===n.length?[1]:n).map((e=>{const n=t(e);return"number"===typeof n?`${n}px`:n})).join(" ")};return n.mui=!0,n}(p);let y=(0,s.A)({breakpoints:g,direction:"ltr",components:{},palette:(0,r.A)({mode:"light"},n),spacing:v,shape:(0,r.A)({},a,f)},m);y.applyStyles=h.A;for(var b=arguments.length,x=new Array(b>1?b-1:0),w=1;w<b;w++)x[w-1]=arguments[w];return y=x.reduce(((e,t)=>(0,s.A)(e,t)),y),y.unstable_sxConfig=(0,r.A)({},c.A,null==m?void 0:m.unstable_sxConfig),y.unstable_sx=function(e){return(0,u.A)({sx:e,theme:this})},y}},8587:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}n.d(t,{A:()=>r})},8590:()=>{},8604:(e,t,n)=>{"use strict";n.d(t,{LX:()=>f,MA:()=>p,_W:()=>m,Lc:()=>y,Ms:()=>b});var r=n(9751),i=n(7162),s=n(3815);const o={m:"margin",p:"padding"},a={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},l={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},u=function(e){const t={};return n=>(void 0===t[n]&&(t[n]=e(n)),t[n])}((e=>{if(e.length>2){if(!l[e])return[e];e=l[e]}const[t,n]=e.split(""),r=o[t],i=a[n]||"";return Array.isArray(i)?i.map((e=>r+e)):[r+i]})),c=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],h=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],d=[...c,...h];function p(e,t,n,r){var s;const o=null!=(s=(0,i.Yn)(e,t,!1))?s:n;return"number"===typeof o?e=>"string"===typeof e?e:o*e:Array.isArray(o)?e=>"string"===typeof e?e:o[e]:"function"===typeof o?o:()=>{}}function f(e){return p(e,"spacing",8)}function m(e,t){if("string"===typeof t||null==t)return t;const n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:`-${n}`}function g(e,t,n,i){if(-1===t.indexOf(n))return null;const s=function(e,t){return n=>e.reduce(((e,r)=>(e[r]=m(t,n),e)),{})}(u(n),i),o=e[n];return(0,r.NI)(e,o,s)}function v(e,t){const n=f(e.theme);return Object.keys(e).map((r=>g(e,t,r,n))).reduce(s.A,{})}function y(e){return v(e,c)}function b(e){return v(e,h)}function x(e){return v(e,d)}y.propTypes={},y.filterProps=c,b.propTypes={},b.filterProps=h,x.propTypes={},x.filterProps=d},8698:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(8168),i=n(8587),s=n(9172),o=n(7758);const a=["sx"],l=e=>{var t,n;const r={systemProps:{},otherProps:{}},i=null!=(t=null==e||null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:o.A;return Object.keys(e).forEach((t=>{i[t]?r.systemProps[t]=e[t]:r.otherProps[t]=e[t]})),r};function u(e){const{sx:t}=e,n=(0,i.A)(e,a),{systemProps:o,otherProps:u}=l(n);let c;return c=Array.isArray(t)?[o,...t]:"function"===typeof t?function(){const e=t(...arguments);return(0,s.Q)(e)?(0,r.A)({},o,e):o}:(0,r.A)({},o,t),(0,r.A)({},u,{sx:c})}},8812:(e,t,n)=>{"use strict";n.d(t,{A:()=>c,k:()=>l});var r=n(7598),i=n(3815),s=n(7162),o=n(9751),a=n(7758);function l(){function e(e,t,n,i){const a={[e]:t,theme:n},l=i[e];if(!l)return{[e]:t};const{cssProperty:u=e,themeKey:c,transform:h,style:d}=l;if(null==t)return null;if("typography"===c&&"inherit"===t)return{[e]:t};const p=(0,s.Yn)(n,c)||{};if(d)return d(a);return(0,o.NI)(a,t,(t=>{let n=(0,s.BO)(p,h,t);return t===n&&"string"===typeof t&&(n=(0,s.BO)(p,h,`${e}${"default"===t?"":(0,r.A)(t)}`,t)),!1===u?n:{[u]:n}}))}return function t(n){var r;const{sx:s,theme:l={}}=n||{};if(!s)return null;const u=null!=(r=l.unstable_sxConfig)?r:a.A;function c(n){let r=n;if("function"===typeof n)r=n(l);else if("object"!==typeof n)return n;if(!r)return null;const s=(0,o.EU)(l.breakpoints),a=Object.keys(s);let c=s;return Object.keys(r).forEach((n=>{const s=(a=r[n],h=l,"function"===typeof a?a(h):a);var a,h;if(null!==s&&void 0!==s)if("object"===typeof s)if(u[n])c=(0,i.A)(c,e(n,s,l,u));else{const e=(0,o.NI)({theme:l},s,(e=>({[n]:e})));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>e.concat(Object.keys(t))),[]),i=new Set(r);return t.every((e=>i.size===Object.keys(e).length))}(e,s)?c=(0,i.A)(c,e):c[n]=t({sx:s,theme:l})}else c=(0,i.A)(c,e(n,s,l,u))})),(0,o.vf)(a,c)}return Array.isArray(s)?s.map(c):c(s)}}const u=l();u.filterProps=["sx"];const c=u},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},9016:function(e,t,n){var r;!function(e,i){function s(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function a(e,t){var n=new s(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=a:n.amdD&&n.amdO?void 0===(r=function(){return a}.call(t,n,t,i))||(i.exports=r):this.xorwow=a}(0,e=n.nmd(e),n.amdD)},9172:(e,t,n)=>{"use strict";n.d(t,{A:()=>a,Q:()=>s});var r=n(8168),i=n(5043);function s(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function o(e){if(i.isValidElement(e)||!s(e))return e;const t={};return Object.keys(e).forEach((n=>{t[n]=o(e[n])})),t}function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const l=n.clone?(0,r.A)({},e):e;return s(e)&&s(t)&&Object.keys(t).forEach((r=>{i.isValidElement(t[r])?l[r]=t[r]:s(t[r])&&Object.prototype.hasOwnProperty.call(e,r)&&s(e[r])?l[r]=a(e[r],t[r],n):n.clone?l[r]=s(t[r])?o(t[r]):t[r]:l[r]=t[r]})),l}},9369:(e,t,n)=>{"use strict";n.d(t,{C:()=>u,E:()=>g,T:()=>h,c:()=>f,h:()=>d,w:()=>c});var r=n(5043),i=n(3803),s=n(1722),o=n(6598),a=n(9436),l=r.createContext("undefined"!==typeof HTMLElement?(0,i.A)({key:"css"}):null),u=l.Provider,c=function(e){return(0,r.forwardRef)((function(t,n){var i=(0,r.useContext)(l);return e(t,i,n)}))},h=r.createContext({});var d={}.hasOwnProperty,p="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",f=function(e,t){var n={};for(var r in t)d.call(t,r)&&(n[r]=t[r]);return n[p]=e,n},m=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return(0,s.SF)(t,n,r),(0,a.s)((function(){return(0,s.sk)(t,n,r)})),null},g=c((function(e,t,n){var i=e.css;"string"===typeof i&&void 0!==t.registered[i]&&(i=t.registered[i]);var a=e[p],l=[i],u="";"string"===typeof e.className?u=(0,s.Rk)(t.registered,l,e.className):null!=e.className&&(u=e.className+" ");var c=(0,o.J)(l,void 0,r.useContext(h));u+=t.key+"-"+c.name;var f={};for(var g in e)d.call(e,g)&&"css"!==g&&g!==p&&(f[g]=e[g]);return f.className=u,n&&(f.ref=n),r.createElement(r.Fragment,null,r.createElement(m,{cache:t,serialized:c,isStringTag:"string"===typeof a}),r.createElement(a,f))}))},9436:(e,t,n)=>{"use strict";var r;n.d(t,{i:()=>a,s:()=>o});var i=n(5043),s=!!(r||(r=n.t(i,2))).useInsertionEffect&&(r||(r=n.t(i,2))).useInsertionEffect,o=s||function(e){return e()},a=s||i.useLayoutEffect},9482:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A,isPlainObject:()=>r.Q});var r=n(9172)},9538:function(e,t,n){var r;!function(e,i){function s(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],n^=(e^=e<<13)^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function a(e,t){null==e&&(e=+new Date);var n=new s(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.x&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=a:n.amdD&&n.amdO?void 0===(r=function(){return a}.call(t,n,t,i))||(i.exports=r):this.xorshift7=a}(0,e=n.nmd(e),n.amdD)},9703:(e,t,n)=>{"use strict";function r(e,t){const n=this;if(n.vars&&"function"===typeof n.getColorSchemeSelector){const r=n.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)");return{[r]:t}}return n.palette.mode===e?t:{}}n.d(t,{A:()=>r})},9751:(e,t,n)=>{"use strict";n.d(t,{EU:()=>a,NI:()=>o,iZ:()=>u,kW:()=>c,vf:()=>l,zu:()=>i});var r=n(9172);const i={xs:0,sm:600,md:900,lg:1200,xl:1536},s={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${i[e]}px)`};function o(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const e=r.breakpoints||s;return t.reduce(((r,i,s)=>(r[e.up(e.keys[s])]=n(t[s]),r)),{})}if("object"===typeof t){const e=r.breakpoints||s;return Object.keys(t).reduce(((r,s)=>{if(-1!==Object.keys(e.values||i).indexOf(s)){r[e.up(s)]=n(t[s],s)}else{const e=s;r[e]=t[e]}return r}),{})}return n(t)}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return(null==(t=e.keys)?void 0:t.reduce(((t,n)=>(t[e.up(n)]={},t)),{}))||{}}function l(e,t){return e.reduce(((e,t)=>{const n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function u(e){const t=a(e);for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];const o=[t,...i].reduce(((e,t)=>(0,r.A)(e,t)),{});return l(Object.keys(t),o)}function c(e){let{values:t,breakpoints:n,base:r}=e;const i=r||function(e,t){if("object"!==typeof e)return{};const n={},r=Object.keys(t);return Array.isArray(e)?r.forEach(((t,r)=>{r<e.length&&(n[t]=!0)})):r.forEach((t=>{null!=e[t]&&(n[t]=!0)})),n}(t,n),s=Object.keys(i);if(0===s.length)return t;let o;return s.reduce(((e,n,r)=>(Array.isArray(t)?(e[n]=null!=t[r]?t[r]:t[o],o=r):"object"===typeof t?(e[n]=null!=t[n]?t[n]:t[o],o=n):e[n]=t,e)),{})}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>r[e]));return o.default=()=>r,n.d(s,o),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".9e1fc54f.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="remote-patient-monitoring-baadi:";n.l=(r,i,s,o)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==s)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var h=u[c];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=r),e[r]=[i];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,s,o=r[0],a=r[1],l=r[2],u=0;if(o.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);u<o.length;u++)s=o[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkremote_patient_monitoring_baadi=self.webpackChunkremote_patient_monitoring_baadi||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{assertParamsValid:()=>JL,computeFlatOffset:()=>hP,computeOutShape:()=>eP,getNormalizedAxes:()=>iP,isSliceContinous:()=>cP,maskToAxes:()=>ZL,parseSliceParams:()=>dP,sliceInfo:()=>pP,startForAxis:()=>lP,startIndicesWithElidedDims:()=>sP,stopForAxis:()=>uP,stopIndicesWithElidedDims:()=>oP,stridesForAxis:()=>aP,stridesWithElidedDims:()=>tP});var t={};n.r(t),n.d(t,{collectGatherOpShapeInfo:()=>OW,computeOutShape:()=>_W,segOpComputeOptimalWindowSize:()=>$W});var r={};n.r(r),n.d(r,{ERF_A1:()=>XU,ERF_A2:()=>YU,ERF_A3:()=>QU,ERF_A4:()=>JU,ERF_A5:()=>ZU,ERF_P:()=>KU,PARALLELIZE_THRESHOLD:()=>DU,RowPartitionType:()=>NU,SELU_SCALE:()=>qU,SELU_SCALEALPHA:()=>HU,applyActivation:()=>RB,assertAndGetBroadcastShape:()=>FL,assertAxesAreInnerMostDims:()=>Sz,assertParamsConsistent:()=>EU,assignToTypedArray:()=>sW,axesAreInnerMostDims:()=>bz,calculateShapes:()=>GU,checkEinsumDimSizes:()=>fW,checkPadOnDimRoundingMode:()=>_P,combineLocations:()=>xz,combineRaggedTensorToTensorShapes:()=>RU,complexWithEvenIndex:()=>nW,complexWithOddIndex:()=>rW,computeConv2DInfo:()=>wP,computeConv3DInfo:()=>kP,computeDefaultPad:()=>SP,computeDilation2DInfo:()=>yP,computeOptimalWindowSize:()=>FU,computeOutAndReduceShapes:()=>wz,computeOutShape:()=>TU,computePool2DInfo:()=>bP,computePool3DInfo:()=>xP,convertConv2DDataFormat:()=>$P,decodeEinsumEquation:()=>dW,eitherStridesOrDilationsAreOne:()=>AP,expandShapeToKeepDim:()=>kz,exponent:()=>aW,exponents:()=>oW,fromStringArrayToUint8:()=>FW,fromUint8ToStringArray:()=>DW,getAxesPermutation:()=>Iz,getBroadcastDims:()=>OL,getComplexWithIndex:()=>iW,getEinsumComputePath:()=>mW,getEinsumPermutation:()=>pW,getFusedBiasGradient:()=>AB,getFusedDyActivation:()=>NB,getImageCenter:()=>MU,getInnerMostAxes:()=>Ez,getPermuted:()=>PU,getRaggedRank:()=>_U,getReductionAxes:()=>DL,getReshaped:()=>LU,getReshapedPermuted:()=>zU,getRowPartitionTypesHelper:()=>$U,getSliceBeginCoords:()=>BU,getSliceSize:()=>UU,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>bW,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>xW,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>wW,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>IW,getSparseReshapeInputOutputMismatchErrorMessage:()=>EW,getSparseReshapeInputOutputMultipleErrorMessage:()=>CW,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>kW,getSparseReshapeNegativeOutputDimErrorMessage:()=>SW,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>RW,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>TW,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>NW,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>AW,getUndoAxesPermutation:()=>Cz,isIdentityPermutation:()=>gW,log:()=>WD,mergeRealAndImagArrays:()=>eW,prepareAndValidate:()=>WU,prepareSplitSize:()=>yW,segment_util:()=>t,shouldFuse:()=>$B,slice_util:()=>e,splitRealAndImagArrays:()=>tW,stridesOrDilationsArePositive:()=>RP,tupleValuesAreOne:()=>NP,upcastType:()=>GF,validateDefaultValueShape:()=>OU,validateInput:()=>jU,validateUpdateShape:()=>VU,warn:()=>UD});var i={};n.r(i),n.d(i,{mx:()=>EJ,XI:()=>yZ,Nk:()=>bZ,f6:()=>wZ,ct:()=>wJ,YG:()=>IZ,hH:()=>RZ,z3:()=>f0,sG:()=>C0,uM:()=>R0,vS:()=>q0,qB:()=>t1,GG:()=>r1,lg:()=>l1,rq:()=>s1,cu:()=>w1,WR:()=>y1,GE:()=>I1,px:()=>E1,jC:()=>U1,He:()=>j1,hE:()=>e2,BF:()=>o0,Dk:()=>c2,cl:()=>y2,_B:()=>$2,ub:()=>M2,_f:()=>z2,Ku:()=>G2,qy:()=>q2,Zy:()=>s3,bu:()=>l3,zv:()=>dJ,dH:()=>FJ,HS:()=>fZ,yH:()=>N3,l3:()=>R3,z9:()=>_3,x6:()=>L3,_m:()=>j3,eW:()=>X3,GK:()=>J3,SP:()=>t4,yr:()=>r4,dl:()=>M0,Dw:()=>l4,xT:()=>h4,_X:()=>WJ,wz:()=>g4});var s,o,a=n(5043),l=n.t(a,2),u=n(4391);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}(o=s||(s={})).Pop="POP",o.Push="PUSH",o.Replace="REPLACE";const h="popstate";function d(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function p(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function f(e,t){return{usr:e.state,key:e.key,idx:t}}function m(e,t,n,r){return void 0===n&&(n=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?v(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function g(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function v(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function y(e,t,n,r){void 0===r&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,l=s.Pop,u=null,p=v();function v(){return(a.state||{idx:null}).idx}function y(){l=s.Pop;let e=v(),t=null==e?null:e-p;p=e,u&&u({action:l,location:x.location,delta:t})}function b(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,n="string"===typeof e?e:g(e);return n=n.replace(/ $/,"%20"),d(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==p&&(p=0,a.replaceState(c({},a.state,{idx:p}),""));let x={get action(){return l},get location(){return e(i,a)},listen(e){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(h,y),u=e,()=>{i.removeEventListener(h,y),u=null}},createHref:e=>t(i,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=s.Push;let r=m(x.location,e,t);n&&n(r,e),p=v()+1;let c=f(r,p),h=x.createHref(r);try{a.pushState(c,"",h)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;i.location.assign(h)}o&&u&&u({action:l,location:x.location,delta:1})},replace:function(e,t){l=s.Replace;let r=m(x.location,e,t);n&&n(r,e),p=v();let i=f(r,p),c=x.createHref(r);a.replaceState(i,"",c),o&&u&&u({action:l,location:x.location,delta:0})},go:e=>a.go(e)};return x}var b,x;(x=b||(b={})).data="data",x.deferred="deferred",x.redirect="redirect",x.error="error";new Set(["lazy","caseSensitive","path","id","index","children"]);function w(e,t,n){return void 0===n&&(n="/"),k(e,t,n,!1)}function k(e,t,n,r){let i=M(("string"===typeof t?v(t):t).pathname||"/",n);if(null==i)return null;let s=S(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let o=null;for(let a=0;null==o&&a<s.length;++a){let e=F(i);o=O(s[a],e,r)}return o}function S(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,s)=>{let o={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(d(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));let a=U([r,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(d(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),S(e.children,t,l,a)),(null!=e.path||e.index)&&t.push({path:a,score:_(a,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of I(e.path))i(e,t,r);else i(e,t)})),t}function I(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return i?[s,""]:[s];let o=I(r.join("/")),a=[];return a.push(...o.map((e=>""===e?s:[s,e].join("/")))),i&&a.push(...o),a.map((t=>e.startsWith("/")&&""===t?"/":t))}const C=/^:[\w-]+$/,E=3,T=2,N=1,A=10,R=-2,$=e=>"*"===e;function _(e,t){let n=e.split("/"),r=n.length;return n.some($)&&(r+=R),t&&(r+=T),n.filter((e=>!$(e))).reduce(((e,t)=>e+(C.test(t)?E:""===t?N:A)),r)}function O(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,i={},s="/",o=[];for(let a=0;a<r.length;++a){let e=r[a],l=a===r.length-1,u="/"===s?t:t.slice(s.length)||"/",c=D({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},u),h=e.route;if(!c&&l&&n&&!r[r.length-1].route.index&&(c=D({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},u)),!c)return null;Object.assign(i,c.params),o.push({params:i,pathname:U([s,c.pathname]),pathnameBase:W(U([s,c.pathnameBase])),route:h}),"/"!==c.pathnameBase&&(s=U([s,c.pathnameBase]))}return o}function D(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);p("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=a[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=a[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:s,pathnameBase:o,pattern:e}}function F(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return p(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function M(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function L(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function P(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function z(e,t){let n=P(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function B(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=v(e):(i=c({},e),d(!i.pathname||!i.pathname.includes("?"),L("?","pathname","search",i)),d(!i.pathname||!i.pathname.includes("#"),L("#","pathname","hash",i)),d(!i.search||!i.search.includes("#"),L("#","search","hash",i)));let s,o=""===e||""===i.pathname,a=o?"/":i.pathname;if(null==a)s=n;else{let e=t.length-1;if(!r&&a.startsWith("..")){let t=a.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?v(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:V(r),hash:j(i)}}(i,s),u=a&&"/"!==a&&a.endsWith("/"),h=(o||"."===a)&&n.endsWith("/");return l.pathname.endsWith("/")||!u&&!h||(l.pathname+="/"),l}const U=e=>e.join("/").replace(/\/\/+/g,"/"),W=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),V=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",j=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function G(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const H=["post","put","patch","delete"],q=(new Set(H),["get",...H]);new Set(q),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},K.apply(this,arguments)}const X=a.createContext(null);const Y=a.createContext(null);const Q=a.createContext(null);const J=a.createContext(null);const Z=a.createContext({outlet:null,matches:[],isDataRoute:!1});const ee=a.createContext(null);function te(){return null!=a.useContext(J)}function ne(){return te()||d(!1),a.useContext(J).location}function re(e){a.useContext(Q).static||a.useLayoutEffect(e)}function ie(){let{isDataRoute:e}=a.useContext(Z);return e?function(){let{router:e}=fe(de.UseNavigateStable),t=ge(pe.UseNavigateStable),n=a.useRef(!1);return re((()=>{n.current=!0})),a.useCallback((function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,K({fromRouteId:t},i)))}),[e,t])}():function(){te()||d(!1);let e=a.useContext(X),{basename:t,future:n,navigator:r}=a.useContext(Q),{matches:i}=a.useContext(Z),{pathname:s}=ne(),o=JSON.stringify(z(i,n.v7_relativeSplatPath)),l=a.useRef(!1);return re((()=>{l.current=!0})),a.useCallback((function(n,i){if(void 0===i&&(i={}),!l.current)return;if("number"===typeof n)return void r.go(n);let a=B(n,JSON.parse(o),s,"path"===i.relative);null==e&&"/"!==t&&(a.pathname="/"===a.pathname?t:U([t,a.pathname])),(i.replace?r.replace:r.push)(a,i.state,i)}),[t,r,o,s,e])}()}function se(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=a.useContext(Q),{matches:i}=a.useContext(Z),{pathname:s}=ne(),o=JSON.stringify(z(i,r.v7_relativeSplatPath));return a.useMemo((()=>B(e,JSON.parse(o),s,"path"===n)),[e,o,s,n])}function oe(e,t,n,r){te()||d(!1);let{navigator:i,static:o}=a.useContext(Q),{matches:l}=a.useContext(Z),u=l[l.length-1],c=u?u.params:{},h=(u&&u.pathname,u?u.pathnameBase:"/");u&&u.route;let p,f=ne();if(t){var m;let e="string"===typeof t?v(t):t;"/"===h||(null==(m=e.pathname)?void 0:m.startsWith(h))||d(!1),p=e}else p=f;let g=p.pathname||"/",y=g;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=!o&&n&&n.matches&&n.matches.length>0?n.matches:w(e,{pathname:y});let x=he(b&&b.map((e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:U([h,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:U([h,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,n,r);return t&&x?a.createElement(J.Provider,{value:{location:K({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:s.Pop}},x):x}function ae(){let e=function(){var e;let t=a.useContext(ee),n=me(pe.UseRouteError),r=ge(pe.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=G(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),n?a.createElement("pre",{style:i},n):null,null)}const le=a.createElement(ae,null);class ue extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(Z.Provider,{value:this.props.routeContext},a.createElement(ee.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ce(e){let{routeContext:t,match:n,children:r}=e,i=a.useContext(X);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),a.createElement(Z.Provider,{value:t},r)}function he(e,t,n,r){var i;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var s;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(s=r)&&s.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(i=n)?void 0:i.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||d(!1),o=o.slice(0,Math.min(o.length,e+1))}let u=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let a=0;a<o.length;a++){let e=o[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=a),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){u=!0,o=c>=0?o.slice(0,c+1):[o[0]];break}}}return o.reduceRight(((e,r,i)=>{let s,h=!1,d=null,p=null;var f;n&&(s=l&&r.route.id?l[r.route.id]:void 0,d=r.route.errorElement||le,u&&(c<0&&0===i?(f="route-fallback",!1||ve[f]||(ve[f]=!0),h=!0,p=null):c===i&&(h=!0,p=r.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,i+1)),g=()=>{let t;return t=s?d:h?p:r.route.Component?a.createElement(r.route.Component,null):r.route.element?r.route.element:e,a.createElement(ce,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===i)?a.createElement(ue,{location:n.location,revalidation:n.revalidation,component:d,error:s,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var de=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(de||{}),pe=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(pe||{});function fe(e){let t=a.useContext(X);return t||d(!1),t}function me(e){let t=a.useContext(Y);return t||d(!1),t}function ge(e){let t=function(){let e=a.useContext(Z);return e||d(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||d(!1),n.route.id}const ve={};function ye(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}l.startTransition;function be(e){let{to:t,replace:n,state:r,relative:i}=e;te()||d(!1);let{future:s,static:o}=a.useContext(Q),{matches:l}=a.useContext(Z),{pathname:u}=ne(),c=ie(),h=B(t,z(l,s.v7_relativeSplatPath),u,"path"===i),p=JSON.stringify(h);return a.useEffect((()=>c(JSON.parse(p),{replace:n,state:r,relative:i})),[c,p,i,n,r]),null}function xe(e){d(!1)}function we(e){let{basename:t="/",children:n=null,location:r,navigationType:i=s.Pop,navigator:o,static:l=!1,future:u}=e;te()&&d(!1);let c=t.replace(/^\/*/,"/"),h=a.useMemo((()=>({basename:c,navigator:o,static:l,future:K({v7_relativeSplatPath:!1},u)})),[c,u,o,l]);"string"===typeof r&&(r=v(r));let{pathname:p="/",search:f="",hash:m="",state:g=null,key:y="default"}=r,b=a.useMemo((()=>{let e=M(p,c);return null==e?null:{location:{pathname:e,search:f,hash:m,state:g,key:y},navigationType:i}}),[c,p,f,m,g,y,i]);return null==b?null:a.createElement(Q.Provider,{value:h},a.createElement(J.Provider,{children:n,value:b}))}function ke(e){let{children:t,location:n}=e;return oe(Se(t),n)}new Promise((()=>{}));a.Component;function Se(e,t){void 0===t&&(t=[]);let n=[];return a.Children.forEach(e,((e,r)=>{if(!a.isValidElement(e))return;let i=[...t,r];if(e.type===a.Fragment)return void n.push.apply(n,Se(e.props.children,i));e.type!==xe&&d(!1),e.props.index&&e.props.children&&d(!1);let s={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=Se(e.props.children,i)),n.push(s)})),n}var Ie=n(8168),Ce=n(8587);function Ee(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=Ee(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const Te=function(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=Ee(e))&&(r&&(r+=" "),r+=t);return r};var Ne=n(3174),Ae=n(8812),Re=n(8698),$e=n(8280),_e=n(9369);const Oe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=a.useContext(_e.T);return t&&(n=t,0!==Object.keys(n).length)?t:e;var n},De=(0,$e.A)();const Fe=function(){return Oe(arguments.length>0&&void 0!==arguments[0]?arguments[0]:De)};var Me=n(579);const Le=["className","component"];const Pe=e=>e,ze=(()=>{let e=Pe;return{configure(t){e=t},generate:t=>e(t),reset(){e=Pe}}})();var Be=n(7868),Ue=n(9172),We=n(7758);var Ve=n(7266);const je={black:"#000",white:"#fff"},Ge={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},He={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},qe={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Ke={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Xe={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Ye={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Qe={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Je=["mode","contrastThreshold","tonalOffset"],Ze={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:je.white,default:je.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},et={text:{primary:je.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:je.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function tt(e,t,n,r){const i=r.light||r,s=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=(0,Ve.a)(e.main,i):"dark"===t&&(e.dark=(0,Ve.e$)(e.main,s)))}function nt(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:r=.2}=e,i=(0,Ce.A)(e,Je),s=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Xe[200],light:Xe[50],dark:Xe[400]}:{main:Xe[700],light:Xe[400],dark:Xe[800]}}(t),o=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:He[200],light:He[50],dark:He[400]}:{main:He[500],light:He[300],dark:He[700]}}(t),a=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:qe[500],light:qe[300],dark:qe[700]}:{main:qe[700],light:qe[400],dark:qe[800]}}(t),l=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Ye[400],light:Ye[300],dark:Ye[700]}:{main:Ye[700],light:Ye[500],dark:Ye[900]}}(t),u=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Qe[400],light:Qe[300],dark:Qe[700]}:{main:Qe[800],light:Qe[500],dark:Qe[900]}}(t),c=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Ke[400],light:Ke[300],dark:Ke[700]}:{main:"#ed6c02",light:Ke[500],dark:Ke[900]}}(t);function h(e){return(0,Ve.eM)(e,et.text.primary)>=n?et.text.primary:Ze.text.primary}const d=e=>{let{color:t,name:n,mainShade:i=500,lightShade:s=300,darkShade:o=700}=e;if(t=(0,Ie.A)({},t),!t.main&&t[i]&&(t.main=t[i]),!t.hasOwnProperty("main"))throw new Error((0,Be.A)(11,n?` (${n})`:"",i));if("string"!==typeof t.main)throw new Error((0,Be.A)(12,n?` (${n})`:"",JSON.stringify(t.main)));return tt(t,"light",s,r),tt(t,"dark",o,r),t.contrastText||(t.contrastText=h(t.main)),t},p={dark:et,light:Ze};return(0,Ue.A)((0,Ie.A)({common:(0,Ie.A)({},je),mode:t,primary:d({color:s,name:"primary"}),secondary:d({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:d({color:a,name:"error"}),warning:d({color:c,name:"warning"}),info:d({color:l,name:"info"}),success:d({color:u,name:"success"}),grey:Ge,contrastThreshold:n,getContrastText:h,augmentColor:d,tonalOffset:r},p[t]),i)}const rt=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const it={textTransform:"uppercase"},st='"Roboto", "Helvetica", "Arial", sans-serif';function ot(e,t){const n="function"===typeof t?t(e):t,{fontFamily:r=st,fontSize:i=14,fontWeightLight:s=300,fontWeightRegular:o=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:u=16,allVariants:c,pxToRem:h}=n,d=(0,Ce.A)(n,rt);const p=i/14,f=h||(e=>e/u*p+"rem"),m=(e,t,n,i,s)=>{return(0,Ie.A)({fontFamily:r,fontWeight:e,fontSize:f(t),lineHeight:n},r===st?{letterSpacing:(o=i/t,Math.round(1e5*o)/1e5)+"em"}:{},s,c);var o},g={h1:m(s,96,1.167,-1.5),h2:m(s,60,1.2,-.5),h3:m(o,48,1.167,0),h4:m(o,34,1.235,.25),h5:m(o,24,1.334,0),h6:m(a,20,1.6,.15),subtitle1:m(o,16,1.75,.15),subtitle2:m(a,14,1.57,.1),body1:m(o,16,1.5,.15),body2:m(o,14,1.43,.15),button:m(a,14,1.75,.4,it),caption:m(o,12,1.66,.4),overline:m(o,12,2.66,1,it),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return(0,Ue.A)((0,Ie.A)({htmlFontSize:u,pxToRem:f,fontFamily:r,fontSize:i,fontWeightLight:s,fontWeightRegular:o,fontWeightMedium:a,fontWeightBold:l},g),d,{clone:!1})}function at(){return[`${arguments.length<=0?void 0:arguments[0]}px ${arguments.length<=1?void 0:arguments[1]}px ${arguments.length<=2?void 0:arguments[2]}px ${arguments.length<=3?void 0:arguments[3]}px rgba(0,0,0,0.2)`,`${arguments.length<=4?void 0:arguments[4]}px ${arguments.length<=5?void 0:arguments[5]}px ${arguments.length<=6?void 0:arguments[6]}px ${arguments.length<=7?void 0:arguments[7]}px rgba(0,0,0,0.14)`,`${arguments.length<=8?void 0:arguments[8]}px ${arguments.length<=9?void 0:arguments[9]}px ${arguments.length<=10?void 0:arguments[10]}px ${arguments.length<=11?void 0:arguments[11]}px rgba(0,0,0,0.12)`].join(",")}const lt=["none",at(0,2,1,-1,0,1,1,0,0,1,3,0),at(0,3,1,-2,0,2,2,0,0,1,5,0),at(0,3,3,-2,0,3,4,0,0,1,8,0),at(0,2,4,-1,0,4,5,0,0,1,10,0),at(0,3,5,-1,0,5,8,0,0,1,14,0),at(0,3,5,-1,0,6,10,0,0,1,18,0),at(0,4,5,-2,0,7,10,1,0,2,16,1),at(0,5,5,-3,0,8,10,1,0,3,14,2),at(0,5,6,-3,0,9,12,1,0,3,16,2),at(0,6,6,-3,0,10,14,1,0,4,18,3),at(0,6,7,-4,0,11,15,1,0,4,20,3),at(0,7,8,-4,0,12,17,2,0,5,22,4),at(0,7,8,-4,0,13,19,2,0,5,24,4),at(0,7,9,-4,0,14,21,2,0,5,26,4),at(0,8,9,-5,0,15,22,2,0,6,28,5),at(0,8,10,-5,0,16,24,2,0,6,30,5),at(0,8,11,-5,0,17,26,2,0,6,32,5),at(0,9,11,-5,0,18,28,2,0,7,34,6),at(0,9,12,-6,0,19,29,2,0,7,36,6),at(0,10,13,-6,0,20,31,3,0,8,38,7),at(0,10,13,-6,0,21,33,3,0,8,40,7),at(0,10,14,-6,0,22,35,3,0,8,42,7),at(0,11,14,-7,0,23,36,3,0,9,44,8),at(0,11,15,-7,0,24,38,3,0,9,46,8)],ut=["duration","easing","delay"],ct={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},ht={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function dt(e){return`${Math.round(e)}ms`}function pt(e){if(!e)return 0;const t=e/36;return Math.round(10*(4+15*t**.25+t/5))}function ft(e){const t=(0,Ie.A)({},ct,e.easing),n=(0,Ie.A)({},ht,e.duration);return(0,Ie.A)({getAutoHeightDuration:pt,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:i=n.standard,easing:s=t.easeInOut,delay:o=0}=r;(0,Ce.A)(r,ut);return(Array.isArray(e)?e:[e]).map((e=>`${e} ${"string"===typeof i?i:dt(i)} ${s} ${"string"===typeof o?o:dt(o)}`)).join(",")}},e,{easing:t,duration:n})}const mt={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},gt=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function vt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mixins:t={},palette:n={},transitions:r={},typography:i={}}=e,s=(0,Ce.A)(e,gt);if(e.vars&&void 0===e.generateCssVars)throw new Error((0,Be.A)(18));const o=nt(n),a=(0,$e.A)(e);let l=(0,Ue.A)(a,{mixins:(u=a.breakpoints,c=t,(0,Ie.A)({toolbar:{minHeight:56,[u.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[u.up("sm")]:{minHeight:64}}},c)),palette:o,shadows:lt.slice(),typography:ot(o,i),transitions:ft(r),zIndex:(0,Ie.A)({},mt)});var u,c;l=(0,Ue.A)(l,s);for(var h=arguments.length,d=new Array(h>1?h-1:0),p=1;p<h;p++)d[p-1]=arguments[p];return l=d.reduce(((e,t)=>(0,Ue.A)(e,t)),l),l.unstable_sxConfig=(0,Ie.A)({},We.A,null==s?void 0:s.unstable_sxConfig),l.unstable_sx=function(e){return(0,Ae.A)({sx:e,theme:this})},l}const yt=vt,bt="$$material",xt={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function wt(e,t){const n=xt[t];return n?`${arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui"}-${n}`:`${ze.generate(e)}-${t}`}function kt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const r={};return t.forEach((t=>{r[t]=wt(e,t,n)})),r}const St=kt("MuiBox",["root"]),It=yt(),Ct=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:i}=e,s=(0,Ne.default)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(Ae.A);return a.forwardRef((function(e,o){const a=Fe(n),l=(0,Re.A)(e),{className:u,component:c="div"}=l,h=(0,Ce.A)(l,Le);return(0,Me.jsx)(s,(0,Ie.A)({as:c,ref:o,className:Te(u,i?i(r):r),theme:t&&a[t]||a},h))}))}({themeId:bt,defaultTheme:It,defaultClassName:St.root,generateClassName:ze.generate}),Et=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Tt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,u=t>>2,c=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[u],n[c],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Et(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new Nt;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Nt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const At=function(e){return function(e){const t=Et(e);return Tt.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Rt=function(e){try{return Tt.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const $t=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,_t=()=>{try{return $t()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&Rt(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},Ot=e=>{var t,n;return null===(n=null===(t=_t())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},Dt=()=>{var e;return null===(e=_t())||void 0===e?void 0:e.config},Ft=e=>{var t;return null===(t=_t())||void 0===t?void 0:t[`_${e}`]};class Mt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function Lt(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Pt(){try{return"object"===typeof indexedDB}catch(e){return!1}}function zt(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class Bt extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Bt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ut.prototype.create)}}class Ut{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(Wt,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(r,t):"Error",s=`${this.serviceName}: ${i} (${n}).`;return new Bt(n,s,t)}}const Wt=/\{\$([^}]+)}/g;function Vt(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(jt(n)&&jt(s)){if(!Vt(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function jt(e){return null!==e&&"object"===typeof e}function Gt(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Ht(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function qt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Kt{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Xt),void 0===r.error&&(r.error=Xt),void 0===r.complete&&(r.complete=Xt);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function Xt(){}function Yt(e){return e&&e._delegate?e._delegate:e}class Qt{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Jt="[DEFAULT]";class Zt{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Mt;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Jt})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jt;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jt;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jt;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===Jt?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jt;return this.component?this.component.multipleInstances?e:Jt:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class en{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Zt(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const tn=[];var nn,rn;(rn=nn||(nn={}))[rn.DEBUG=0]="DEBUG",rn[rn.VERBOSE=1]="VERBOSE",rn[rn.INFO=2]="INFO",rn[rn.WARN=3]="WARN",rn[rn.ERROR=4]="ERROR",rn[rn.SILENT=5]="SILENT";const sn={debug:nn.DEBUG,verbose:nn.VERBOSE,info:nn.INFO,warn:nn.WARN,error:nn.ERROR,silent:nn.SILENT},on=nn.INFO,an={[nn.DEBUG]:"log",[nn.VERBOSE]:"log",[nn.INFO]:"info",[nn.WARN]:"warn",[nn.ERROR]:"error"},ln=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=an[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r](`[${n}]  ${e.name}:`,...s)};class un{constructor(e){this.name=e,this._logLevel=on,this._logHandler=ln,this._userLogHandler=null,tn.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in nn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?sn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,nn.DEBUG,...t),this._logHandler(this,nn.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,nn.VERBOSE,...t),this._logHandler(this,nn.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,nn.INFO,...t),this._logHandler(this,nn.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,nn.WARN,...t),this._logHandler(this,nn.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,nn.ERROR,...t),this._logHandler(this,nn.ERROR,...t)}}let cn,hn;const dn=new WeakMap,pn=new WeakMap,fn=new WeakMap,mn=new WeakMap,gn=new WeakMap;let vn={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return pn.get(e);if("objectStoreNames"===t)return e.objectStoreNames||fn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xn(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function yn(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(hn||(hn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(wn(this),n),xn(dn.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return xn(e.apply(wn(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(wn(this),t,...r);return fn.set(s,t.sort?t.sort():[t]),xn(s)}}function bn(e){return"function"===typeof e?yn(e):(e instanceof IDBTransaction&&function(e){if(pn.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));pn.set(e,t)}(e),t=e,(cn||(cn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,vn):e);var t}function xn(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(xn(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&dn.set(t,e)})).catch((()=>{})),gn.set(t,e),t}(e);if(mn.has(e))return mn.get(e);const t=bn(e);return t!==e&&(mn.set(e,t),gn.set(t,e)),t}const wn=e=>gn.get(e);const kn=["get","getKey","getAll","getAllKeys","count"],Sn=["put","add","delete","clear"],In=new Map;function Cn(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(In.get(t))return In.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Sn.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!kn.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return In.set(t,s),s}vn=(e=>({...e,get:(t,n,r)=>Cn(t,n)||e.get(t,n,r),has:(t,n)=>!!Cn(t,n)||e.has(t,n)}))(vn);class En{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Tn="@firebase/app",Nn="0.9.13",An=new un("@firebase/app"),Rn="@firebase/app-compat",$n="@firebase/analytics-compat",_n="@firebase/analytics",On="@firebase/app-check-compat",Dn="@firebase/app-check",Fn="@firebase/auth",Mn="@firebase/auth-compat",Ln="@firebase/database",Pn="@firebase/database-compat",zn="@firebase/functions",Bn="@firebase/functions-compat",Un="@firebase/installations",Wn="@firebase/installations-compat",Vn="@firebase/messaging",jn="@firebase/messaging-compat",Gn="@firebase/performance",Hn="@firebase/performance-compat",qn="@firebase/remote-config",Kn="@firebase/remote-config-compat",Xn="@firebase/storage",Yn="@firebase/storage-compat",Qn="@firebase/firestore",Jn="@firebase/firestore-compat",Zn="firebase",er="[DEFAULT]",tr={[Tn]:"fire-core",[Rn]:"fire-core-compat",[_n]:"fire-analytics",[$n]:"fire-analytics-compat",[Dn]:"fire-app-check",[On]:"fire-app-check-compat",[Fn]:"fire-auth",[Mn]:"fire-auth-compat",[Ln]:"fire-rtdb",[Pn]:"fire-rtdb-compat",[zn]:"fire-fn",[Bn]:"fire-fn-compat",[Un]:"fire-iid",[Wn]:"fire-iid-compat",[Vn]:"fire-fcm",[jn]:"fire-fcm-compat",[Gn]:"fire-perf",[Hn]:"fire-perf-compat",[qn]:"fire-rc",[Kn]:"fire-rc-compat",[Xn]:"fire-gcs",[Yn]:"fire-gcs-compat",[Qn]:"fire-fst",[Jn]:"fire-fst-compat","fire-js":"fire-js",[Zn]:"fire-js-all"},nr=new Map,rr=new Map;function ir(e,t){try{e.container.addComponent(t)}catch(n){An.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function sr(e){const t=e.name;if(rr.has(t))return An.debug(`There were multiple attempts to register component ${t}.`),!1;rr.set(t,e);for(const n of nr.values())ir(n,e);return!0}function or(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const ar=new Ut("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class lr{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Qt("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ar.create("app-deleted",{appName:this._name})}}const ur="9.23.0";function cr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:er,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw ar.create("bad-app-name",{appName:String(i)});if(n||(n=Dt()),!n)throw ar.create("no-options");const s=nr.get(i);if(s){if(Vt(n,s.options)&&Vt(r,s.config))return s;throw ar.create("duplicate-app",{appName:i})}const o=new en(i);for(const l of rr.values())o.addComponent(l);const a=new lr(n,r,o);return nr.set(i,a),a}function hr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er;const t=nr.get(e);if(!t&&e===er&&Dt())return cr();if(!t)throw ar.create("no-app",{appName:e});return t}function dr(e,t,n){var r;let i=null!==(r=tr[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void An.warn(e.join(" "))}sr(new Qt(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const pr="firebase-heartbeat-store";let fr=null;function mr(){return fr||(fr=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=xn(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(xn(o.result),e.oldVersion,e.newVersion,xn(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(pr)}}).catch((e=>{throw ar.create("idb-open",{originalErrorMessage:e.message})}))),fr}async function gr(e,t){try{const n=(await mr()).transaction(pr,"readwrite"),r=n.objectStore(pr);await r.put(t,vr(e)),await n.done}catch(n){if(n instanceof Bt)An.warn(n.message);else{const e=ar.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});An.warn(e.message)}}}function vr(e){return`${e.name}!${e.options.appId}`}class yr{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new xr(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=br();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=br(),{heartbeatsToSend:t,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),wr(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),wr(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=At(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function br(){return(new Date).toISOString().substring(0,10)}class xr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Pt()&&zt().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){try{const t=await mr();return await t.transaction(pr).objectStore(pr).get(vr(e))}catch(t){if(t instanceof Bt)An.warn(t.message);else{const e=ar.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});An.warn(e.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return gr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return gr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function wr(e){return At(JSON.stringify({version:2,heartbeats:e})).length}var kr;kr="",sr(new Qt("platform-logger",(e=>new En(e)),"PRIVATE")),sr(new Qt("heartbeat",(e=>new yr(e)),"PRIVATE")),dr(Tn,Nn,kr),dr(Tn,Nn,"esm2017"),dr("fire-js","");function Sr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Ir(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Cr=Ir,Er=new Ut("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Tr=new un("@firebase/auth");function Nr(e){if(Tr.logLevel<=nn.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Tr.error(`Auth (${ur}): ${e}`,...n)}}function Ar(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw _r(e,...n)}function Rr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return _r(e,...n)}function $r(e,t,n){const r=Object.assign(Object.assign({},Cr()),{[t]:n});return new Ut("auth","Firebase",r).create(t,{appName:e.name})}function _r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Er.create(e,...n)}function Or(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw _r(t,...r)}}function Dr(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Nr(t),new Error(t)}function Fr(e,t){e||Dr(t)}function Mr(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Lr(){return"http:"===Pr()||"https:"===Pr()}function Pr(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function zr(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Lr()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Br{constructor(e,t){this.shortDelay=e,this.longDelay=t,Fr(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Lt())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return zr()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ur(e,t){Fr(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Wr{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void Dr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void Dr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void Dr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Vr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},jr=new Br(3e4,6e4);function Gr(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Hr(e,t,n,r){return qr(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=Gt(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),Wr.fetch()(Xr(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function qr(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Vr),t);try{const t=new Yr(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Qr(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Qr(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Qr(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Qr(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw $r(e,a,o);Ar(e,a)}}catch(i){if(i instanceof Bt)throw i;Ar(e,"network-request-failed",{message:String(i)})}}async function Kr(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Hr(e,t,n,r,i);return"mfaPendingCredential"in s&&Ar(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Xr(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?Ur(e.config,i):`${e.config.apiScheme}://${i}`}class Yr{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Rr(this.auth,"network-request-failed"))),jr.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Qr(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Rr(e,t,r);return i.customData._tokenResponse=n,i}function Jr(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Zr(e){return 1e3*Number(e)}function ei(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Nr("JWT malformed, contained fewer than 3 sections"),null;try{const e=Rt(n);return e?JSON.parse(e):(Nr("Failed to decode base64 JWT payload"),null)}catch(i){return Nr("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}async function ti(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof Bt&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class ni{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class ri{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Jr(this.lastLoginAt),this.creationTime=Jr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ii(e){var t;const n=e.auth,r=await e.getIdToken(),i=await ti(e,async function(e,t){return Hr(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));Or(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=Sr(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const a=(l=e.providerData,u=o,[...l.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var l,u;const c=e.isAnonymous,h=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),d=!!c&&h,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ri(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,p)}class si{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Or(e.idToken,"internal-error"),Or("undefined"!==typeof e.idToken,"internal-error"),Or("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){const t=ei(e);return Or(t,"internal-error"),Or("undefined"!==typeof t.exp,"internal-error"),Or("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Or(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await qr(e,{},(async()=>{const n=Gt({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Xr(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Wr.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new si;return n&&(Or("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Or("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Or("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new si,this.toJSON())}_performRefresh(){return Dr("not implemented")}}function oi(e,t){Or("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class ai{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Sr(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ni(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ri(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ti(this,this.stsTokenManager.getToken(this.auth,e));return Or(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Yt(e),r=await n.getIdToken(t),i=ei(r);Or(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Jr(Zr(i.auth_time)),issuedAtTime:Jr(Zr(i.iat)),expirationTime:Jr(Zr(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Yt(e);await ii(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Or(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ai(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Or(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ii(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ti(this,async function(e,t){return Hr(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,u;const c=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,f=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:y,emailVerified:b,isAnonymous:x,providerData:w,stsTokenManager:k}=t;Or(y&&k,e,"internal-error");const S=si.fromJSON(this.name,k);Or("string"===typeof y,e,"internal-error"),oi(c,e.name),oi(h,e.name),Or("boolean"===typeof b,e,"internal-error"),Or("boolean"===typeof x,e,"internal-error"),oi(d,e.name),oi(p,e.name),oi(f,e.name),oi(m,e.name),oi(g,e.name),oi(v,e.name);const I=new ai({uid:y,auth:e,email:h,emailVerified:b,displayName:c,isAnonymous:x,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:S,createdAt:g,lastLoginAt:v});return w&&Array.isArray(w)&&(I.providerData=w.map((e=>Object.assign({},e)))),m&&(I._redirectEventId=m),I}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new si;r.updateFromServerResponse(t);const i=new ai({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await ii(i),i}}const li=new Map;function ui(e){Fr(e instanceof Function,"Expected a class definition");let t=li.get(e);return t?(Fr(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,li.set(e,t),t)}class ci{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ci.type="NONE";const hi=ci;function di(e,t,n){return`firebase:${e}:${t}:${n}`}class pi{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=di(this.userKey,r.apiKey,i),this.fullPersistenceKey=di("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ai._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new pi(ui(hi),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||ui(hi);const s=di(n,e.config.apiKey,e.name);let o=null;for(const u of t)try{const t=await u._get(s);if(t){const n=ai._fromJSON(e,t);u!==i&&(o=n),i=u;break}}catch(l){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(l){}}))),new pi(i,e,n)):new pi(i,e,n)}}function fi(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(yi(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(mi(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(xi(t))return"Blackberry";if(wi(t))return"Webos";if(gi(t))return"Safari";if((t.includes("chrome/")||vi(t))&&!t.includes("edge/"))return"Chrome";if(bi(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function mi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt();return/firefox\//i.test(e)}function gi(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt();return/crios\//i.test(e)}function yi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt();return/iemobile/i.test(e)}function bi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt();return/android/i.test(e)}function xi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt();return/blackberry/i.test(e)}function wi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt();return/webos/i.test(e)}function ki(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Si(){return function(){const e=Lt();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Ii(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt();return ki(e)||bi(e)||wi(e)||xi(e)||/windows phone/i.test(e)||yi(e)}function Ci(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=fi(Lt());break;case"Worker":t=`${fi(Lt())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${ur}/${r}`}async function Ei(e,t){return Hr(e,"GET","/v2/recaptchaConfig",Gr(e,t))}function Ti(e){return void 0!==e&&void 0!==e.enterprise}class Ni{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some((e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState))}}function Ai(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Rr("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Ri(e){return`__${e}${Math.floor(1e6*Math.random())}`}class $i{constructor(e){this.type="recaptcha-enterprise",this.auth=Fi(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;Ti(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Ei(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Ni(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&Ti(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));Ai("https://www.google.com/recaptcha/enterprise.js?render="+i).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function _i(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new $i(e);let s;try{s=await i.verify(n)}catch(a){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}class Oi{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(i){r(i)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Di{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Mi(this),this.idTokenSubscription=new Mi(this),this.beforeStateQueue=new Oi(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Er,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ui(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await pi.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(s)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Or(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ii(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Yt(e):null;return t&&Or(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Or(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(ui(e))}))}async initializeRecaptchaConfig(){const e=await Ei(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new Ni(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){new $i(this).verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ut("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ui(e)||this._popupRedirectResolver;Or(t,this,"argument-error"),this.redirectPersistenceManager=await pi.create(this,[ui(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return Or(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Or(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ci(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Tr.logLevel<=nn.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Tr.warn(`Auth (${ur}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function Fi(e){return Yt(e)}class Mi{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Kt(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Or(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Li(e,t,n){const r=Fi(e);Or(r._canInitEmulator,r,"emulator-config-failed"),Or(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Pi(t),{host:o,port:a}=function(e){const t=Pi(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:zi(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:zi(t)}}}(t),l=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Pi(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function zi(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Bi{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Dr("not implemented")}_getIdTokenResponse(e){return Dr("not implemented")}_linkToIdToken(e,t){return Dr("not implemented")}_getReauthenticationResolver(e){return Dr("not implemented")}}async function Ui(e,t){return Hr(e,"POST","/v1/accounts:update",t)}async function Wi(e,t){return Kr(e,"POST","/v1/accounts:signInWithPassword",Gr(e,t))}async function Vi(e,t){return Hr(e,"POST","/v1/accounts:sendOobCode",Gr(e,t))}async function ji(e,t){return Vi(e,t)}class Gi extends Bi{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Gi(e,t,"password")}static _fromEmailAndCode(e,t){return new Gi(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await _i(e,n,"signInWithPassword");return Wi(e,t)}return Wi(e,n).catch((async t=>{if("auth/missing-recaptcha-token"===t.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await _i(e,n,"signInWithPassword");return Wi(e,t)}return Promise.reject(t)}));case"emailLink":return async function(e,t){return Kr(e,"POST","/v1/accounts:signInWithEmailLink",Gr(e,t))}(e,{email:this._email,oobCode:this._password});default:Ar(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ui(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Kr(e,"POST","/v1/accounts:signInWithEmailLink",Gr(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Ar(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Hi(e,t){return Kr(e,"POST","/v1/accounts:signInWithIdp",Gr(e,t))}class qi extends Bi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ar("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Sr(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new qi(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Hi(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Hi(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Hi(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Gt(t)}return e}}const Ki={USER_NOT_FOUND:"user-not-found"};class Xi extends Bi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Xi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Xi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Kr(e,"POST","/v1/accounts:signInWithPhoneNumber",Gr(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Kr(e,"POST","/v1/accounts:signInWithPhoneNumber",Gr(e,t));if(n.temporaryProof)throw Qr(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Kr(e,"POST","/v1/accounts:signInWithPhoneNumber",Gr(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Ki)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Xi({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Yi{constructor(e){var t,n,r,i,s,o;const a=Ht(qt(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,c=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Or(l&&u&&c,"argument-error"),this.apiKey=l,this.operation=c,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=Ht(qt(e)).link,n=t?Ht(qt(t)).deep_link_id:null,r=Ht(qt(e)).deep_link_id;return(r?Ht(qt(r)).link:null)||r||n||t||e}(e);try{return new Yi(t)}catch(n){return null}}}class Qi{constructor(){this.providerId=Qi.PROVIDER_ID}static credential(e,t){return Gi._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Yi.parseLink(t);return Or(n,"argument-error"),Gi._fromEmailAndCode(e,n.code,n.tenantId)}}Qi.PROVIDER_ID="password",Qi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Qi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ji{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Zi extends Ji{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class es extends Zi{constructor(){super("facebook.com")}static credential(e){return qi._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return es.credential(t.oauthAccessToken)}catch(n){return null}}}es.FACEBOOK_SIGN_IN_METHOD="facebook.com",es.PROVIDER_ID="facebook.com";class ts extends Zi{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qi._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return ts.credential(n,r)}catch(i){return null}}}ts.GOOGLE_SIGN_IN_METHOD="google.com",ts.PROVIDER_ID="google.com";class ns extends Zi{constructor(){super("github.com")}static credential(e){return qi._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ns.credential(t.oauthAccessToken)}catch(n){return null}}}ns.GITHUB_SIGN_IN_METHOD="github.com",ns.PROVIDER_ID="github.com";class rs extends Zi{constructor(){super("twitter.com")}static credential(e,t){return qi._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return rs.credential(n,r)}catch(i){return null}}}async function is(e,t){return Kr(e,"POST","/v1/accounts:signUp",Gr(e,t))}rs.TWITTER_SIGN_IN_METHOD="twitter.com",rs.PROVIDER_ID="twitter.com";class ss{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await ai._fromIdTokenResponse(e,n,r),s=os(n);return new ss({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=os(n);return new ss({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function os(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class as extends Bt{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,as.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new as(e,t,n,r)}}function ls(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw as._fromErrorAndOperation(e,n,t,r);throw n}))}async function us(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await ti(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ss._forOperation(e,"link",r)}async function cs(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e,i="reauthenticate";try{const s=await ti(e,ls(r,i,t,e),n);Or(s.idToken,r,"internal-error");const o=ei(s.idToken);Or(o,r,"internal-error");const{sub:a}=o;return Or(e.uid===a,r,"user-mismatch"),ss._forOperation(e,i,s)}catch(s){throw"auth/user-not-found"===(null===s||void 0===s?void 0:s.code)&&Ar(r,"user-mismatch"),s}}async function hs(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="signIn",i=await ls(e,r,t),s=await ss._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function ds(e,t){return hs(Fi(e),t)}function ps(e,t,n){var r;Or((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),Or("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Or(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Or(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function fs(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const i=Yt(e),s={idToken:await i.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},o=await ti(i,async function(e,t){return Hr(e,"POST","/v1/accounts:update",t)}(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}async function ms(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await ti(e,Ui(r,i));await e._updateTokensIfNecessary(s,!0)}new WeakMap;const gs="__sak";class vs{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(gs,"1"),this.storage.removeItem(gs),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class ys extends vs{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=Lt();return gi(e)||ki(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Ii(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Si()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ys.type="LOCAL";const bs=ys;class xs extends vs{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}xs.type="SESSION";const ws=xs;class ks{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new ks(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ss(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}ks.receivers=[];class Is{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const l=Ss("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Cs(){return window}function Es(){return"undefined"!==typeof Cs().WorkerGlobalScope&&"function"===typeof Cs().importScripts}const Ts="firebaseLocalStorageDb",Ns="firebaseLocalStorage",As="fbase_key";class Rs{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function $s(e,t){return e.transaction([Ns],t?"readwrite":"readonly").objectStore(Ns)}function _s(){const e=indexedDB.open(Ts,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Ns,{keyPath:As})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Ns)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ts);return new Rs(e).toPromise()}(),t(await _s()))}))}))}async function Os(e,t,n){const r=$s(e,!0).put({[As]:t,value:n});return new Rs(r).toPromise()}function Ds(e,t){const n=$s(e,!0).delete(t);return new Rs(n).toPromise()}class Fs{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await _s()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Es()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ks._getInstance(Es()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Is(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _s();return await Os(e,gs,"1"),await Ds(e,gs),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Os(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=$s(e,!1).get(t),r=await new Rs(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Ds(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=$s(e,!1).getAll();return new Rs(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Fs.type="LOCAL";const Ms=Fs;Ri("rcb"),new Br(3e4,6e4);const Ls="recaptcha";async function Ps(e,t,n){var r;const i=await n.verify();try{let s;if(Or("string"===typeof i,e,"argument-error"),Or(n.type===Ls,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Or("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Hr(e,"POST","/v2/accounts/mfaEnrollment:start",Gr(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Or("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Or(n,e,"missing-multi-factor-info");const o=await function(e,t){return Hr(e,"POST","/v2/accounts/mfaSignIn:start",Gr(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Hr(e,"POST","/v1/accounts:sendVerificationCode",Gr(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class zs{constructor(e){this.providerId=zs.PROVIDER_ID,this.auth=Fi(e)}verifyPhoneNumber(e,t){return Ps(this.auth,e,Yt(t))}static credential(e,t){return Xi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return zs.credentialFromTaggedObject(t)}static credentialFromError(e){return zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Xi._fromTokenResponse(n,r):null}}function Bs(e,t){return t?ui(t):(Or(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}zs.PROVIDER_ID="phone",zs.PHONE_SIGN_IN_METHOD="phone";class Us extends Bi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ws(e){return hs(e.auth,new Us(e),e.bypassAuthState)}function Vs(e){const{auth:t,user:n}=e;return Or(n,t,"internal-error"),cs(n,new Us(e),e.bypassAuthState)}async function js(e){const{auth:t,user:n}=e;return Or(n,t,"internal-error"),us(n,new Us(e),e.bypassAuthState)}class Gs{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ws;case"linkViaPopup":case"linkViaRedirect":return js;case"reauthViaPopup":case"reauthViaRedirect":return Vs;default:Ar(this.auth,"internal-error")}}resolve(e){Fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Hs=new Br(2e3,1e4);class qs extends Gs{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,qs.currentPopupAction&&qs.currentPopupAction.cancel(),qs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Or(e,this.auth,"internal-error"),e}async onExecution(){Fr(1===this.filter.length,"Popup operations only handle one event");const e=Ss();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Rr(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Rr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Rr(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Hs.get())};e()}}qs.currentPopupAction=null;const Ks=new Map;class Xs extends Gs{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Ks.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Js(t),r=Qs(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Ks.set(this.auth._key(),e)}return this.bypassAuthState||Ks.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ys(e,t){Ks.set(e._key(),t)}function Qs(e){return ui(e._redirectPersistence)}function Js(e){return di("pendingRedirect",e.config.apiKey,e.name)}async function Zs(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=Fi(e),i=Bs(r,t),s=new Xs(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class eo{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return no(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!no(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Rr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(to(e))}saveEventToCache(e){this.cachedEventUids.add(to(e)),this.lastProcessedEventTime=Date.now()}}function to(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function no(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const ro=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,io=/^https?/;async function so(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Hr(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(oo(r))return}catch(n){}Ar(e,"unauthorized-domain")}function oo(e){const t=Mr(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!io.test(n))return!1;if(ro.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const ao=new Br(3e4,6e4);function lo(){const e=Cs().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}let uo=null;function co(e){return uo=uo||function(e){return new Promise(((t,n)=>{var r,i,s;function o(){lo(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{lo(),n(Rr(e,"network-request-failed"))},timeout:ao.get()})}if(null===(i=null===(r=Cs().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Cs().gapi)||void 0===s?void 0:s.load)){const t=Ri("iframefcb");return Cs()[t]=()=>{gapi.load?o():n(Rr(e,"network-request-failed"))},Ai(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw uo=null,e}))}(e),uo}const ho=new Br(5e3,15e3),po={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fo=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mo(e){const t=e.config;Or(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Ur(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:ur},i=fo.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Gt(r).slice(1)}`}const go={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class vo{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function yo(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},go),{width:r.toString(),height:i.toString(),top:s,left:o}),u=Lt().toLowerCase();n&&(a=vi(u)?"_blank":n),mi(u)&&(t=t||"http://localhost",l.scrollbars="yes");const c=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`}),"");if(function(){var e;return ki(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new vo(null);const h=window.open(t||"",a,c);Or(h,e,"popup-blocked");try{h.focus()}catch(d){}return new vo(h)}const bo="__/auth/handler",xo="emulator/auth/handler",wo=encodeURIComponent("fac");async function ko(e,t,n,r,i,s){Or(e.config.authDomain,e,"auth-domain-config-required"),Or(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:ur,eventId:i};if(t instanceof Ji){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Zi){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const c of Object.keys(a))void 0===a[c]&&delete a[c];const l=await e._getAppCheckToken(),u=l?`#${wo}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${bo}`;return Ur(t,xo)}(e)}?${Gt(a).slice(1)}${u}`}const So="webStorageSupport";const Io=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ws,this._completeRedirectFn=Zs,this._overrideRedirectResult=Ys}async _openPopup(e,t,n,r){var i;Fr(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return yo(e,await ko(e,t,n,Mr(),r),Ss())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Cs().location.href=e}(await ko(e,t,n,Mr(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Fr(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await co(e),n=Cs().gapi;return Or(n,e,"internal-error"),t.open({where:document.body,url:mo(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:po,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Rr(e,"network-request-failed"),s=Cs().setTimeout((()=>{r(i)}),ho.get());function o(){Cs().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new eo(e);return t.register("authEvent",(t=>{Or(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(So,{type:So},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[So];void 0!==i&&t(!!i),Ar(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=so(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ii()||gi()||ki()}};var Co="@firebase/auth",Eo="0.23.2";class To{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Or(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const No=Ft("authIdTokenMaxAge")||300;let Ao=null;var Ro;Ro="Browser",sr(new Qt("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Or(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:Ro,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ci(Ro)},u=new Di(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ui);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(u,n),u}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),sr(new Qt("auth-internal",(e=>(e=>new To(e))(Fi(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),dr(Co,Eo,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Ro)),dr(Co,Eo,"esm2017");var $o,_o="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Oo={},Do=Do||{},Fo=_o||self;function Mo(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Lo(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Po="closure_uid_"+(1e9*Math.random()>>>0),zo=0;function Bo(e,t,n){return e.call.apply(e.bind,arguments)}function Uo(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Wo(e,t,n){return(Wo=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Bo:Uo).apply(null,arguments)}function Vo(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function jo(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function Go(){this.s=this.s,this.o=this.o}Go.prototype.s=!1,Go.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Po)&&e[Po]||(e[Po]=++zo))},Go.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ho=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function qo(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function Ko(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(Mo(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function Xo(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Xo.prototype.h=function(){this.defaultPrevented=!0};var Yo=function(){if(!Fo.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Fo.addEventListener("test",(()=>{}),t),Fo.removeEventListener("test",(()=>{}),t)}catch(n){}return e}();function Qo(e){return/^[\s\xa0]*$/.test(e)}function Jo(){var e=Fo.navigator;return e&&(e=e.userAgent)?e:""}function Zo(e){return-1!=Jo().indexOf(e)}function ea(e){return ea[" "](e),e}ea[" "]=function(){};var ta,na,ra=Zo("Opera"),ia=Zo("Trident")||Zo("MSIE"),sa=Zo("Edge"),oa=sa||ia,aa=Zo("Gecko")&&!(-1!=Jo().toLowerCase().indexOf("webkit")&&!Zo("Edge"))&&!(Zo("Trident")||Zo("MSIE"))&&!Zo("Edge"),la=-1!=Jo().toLowerCase().indexOf("webkit")&&!Zo("Edge");function ua(){var e=Fo.document;return e?e.documentMode:void 0}e:{var ca="",ha=function(){var e=Jo();return aa?/rv:([^\);]+)(\)|;)/.exec(e):sa?/Edge\/([\d\.]+)/.exec(e):ia?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):la?/WebKit\/(\S+)/.exec(e):ra?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(ha&&(ca=ha?ha[1]:""),ia){var da=ua();if(null!=da&&da>parseFloat(ca)){ta=String(da);break e}}ta=ca}if(Fo.document&&ia){var pa=ua();na=pa||(parseInt(ta,10)||void 0)}else na=void 0;var fa=na;function ma(e,t){if(Xo.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(aa){e:{try{ea(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:ga[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ma.$.h.call(this)}}jo(ma,Xo);var ga={2:"touch",3:"pen",4:"mouse"};ma.prototype.h=function(){ma.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var va="closure_listenable_"+(1e6*Math.random()|0),ya=0;function ba(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++ya,this.fa=this.ia=!1}function xa(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function wa(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function ka(e){const t={};for(const n in e)t[n]=e[n];return t}const Sa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ia(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<Sa.length;t++)n=Sa[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Ca(e){this.src=e,this.g={},this.h=0}function Ea(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Ho(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(xa(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Ta(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==r)return i}return-1}Ca.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=Ta(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new ba(t,this.src,s,!!r,i)).ia=n,e.push(t)),t};var Na="closure_lm_"+(1e6*Math.random()|0),Aa={};function Ra(e,t,n,r,i){if(r&&r.once)return _a(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)Ra(e,t[s],n,r,i);return null}return n=za(n),e&&e[va]?e.O(t,n,Lo(r)?!!r.capture:!!r,i):$a(e,t,n,!1,r,i)}function $a(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=Lo(i)?!!i.capture:!!i,a=La(e);if(a||(e[Na]=a=new Ca(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Ma;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Yo||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Fa(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function _a(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)_a(e,t[s],n,r,i);return null}return n=za(n),e&&e[va]?e.P(t,n,Lo(r)?!!r.capture:!!r,i):$a(e,t,n,!0,r,i)}function Oa(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Oa(e,t[s],n,r,i);else r=Lo(r)?!!r.capture:!!r,n=za(n),e&&e[va]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Ta(s=e.g[t],n,r,i))&&(xa(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=La(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Ta(t,n,r,i)),(n=-1<e?t[e]:null)&&Da(n))}function Da(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[va])Ea(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Fa(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=La(t))?(Ea(n,e),0==n.h&&(n.src=null,t[Na]=null)):xa(e)}}}function Fa(e){return e in Aa?Aa[e]:Aa[e]="on"+e}function Ma(e,t){if(e.fa)e=!0;else{t=new ma(t,this);var n=e.listener,r=e.la||e.src;e.ia&&Da(e),e=n.call(r,t)}return e}function La(e){return(e=e[Na])instanceof Ca?e:null}var Pa="__closure_events_fn_"+(1e9*Math.random()>>>0);function za(e){return"function"===typeof e?e:(e[Pa]||(e[Pa]=function(t){return e.handleEvent(t)}),e[Pa])}function Ba(){Go.call(this),this.i=new Ca(this),this.S=this,this.J=null}function Ua(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"===typeof t)t=new Xo(t,e);else if(t instanceof Xo)t.target=t.target||e;else{var i=t;Ia(t=new Xo(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Wa(o,r,!0,t)&&i}if(i=Wa(o=t.g=e,r,!0,t)&&i,i=Wa(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Wa(o=t.g=n[s],r,!1,t)&&i}function Wa(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&Ea(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}jo(Ba,Go),Ba.prototype[va]=!0,Ba.prototype.removeEventListener=function(e,t,n,r){Oa(this,e,t,n,r)},Ba.prototype.N=function(){if(Ba.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)xa(n[r]);delete t.g[e],t.h--}}this.J=null},Ba.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Ba.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Va=Fo.JSON.stringify;function ja(){var e=Qa;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Ga=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new Ha),(e=>e.reset()));class Ha{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function qa(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Ka(e){Fo.setTimeout((()=>{throw e}),0)}let Xa,Ya=!1,Qa=new class{constructor(){this.h=this.g=null}add(e,t){const n=Ga.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},Ja=()=>{const e=Fo.Promise.resolve(void 0);Xa=()=>{e.then(Za)}};var Za=()=>{for(var e;e=ja();){try{e.h.call(e.g)}catch(n){Ka(n)}var t=Ga;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Ya=!1};function el(e,t){Ba.call(this),this.h=e||1,this.g=t||Fo,this.j=Wo(this.qb,this),this.l=Date.now()}function tl(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function nl(e,t,n){if("function"===typeof e)n&&(e=Wo(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Wo(e.handleEvent,e)}return 2147483647<Number(t)?-1:Fo.setTimeout(e,t||0)}function rl(e){e.g=nl((()=>{e.g=null,e.i&&(e.i=!1,rl(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}jo(el,Ba),($o=el.prototype).ga=!1,$o.T=null,$o.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ua(this,"tick"),this.ga&&(tl(this),this.start()))}},$o.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},$o.N=function(){el.$.N.call(this),tl(this),delete this.g};class il extends Go{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:rl(this)}N(){super.N(),this.g&&(Fo.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function sl(e){Go.call(this),this.h=e,this.g={}}jo(sl,Go);var ol=[];function al(e,t,n,r){Array.isArray(n)||(n&&(ol[0]=n.toString()),n=ol);for(var i=0;i<n.length;i++){var s=Ra(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function ll(e){wa(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Da(e)}),e),e.g={}}function ul(){this.g=!0}function cl(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Va(n)}catch(a){return t}}(e,n)+(r?" "+r:"")}))}sl.prototype.N=function(){sl.$.N.call(this),ll(this)},sl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ul.prototype.Ea=function(){this.g=!1},ul.prototype.info=function(){};var hl={},dl=null;function pl(){return dl=dl||new Ba}function fl(e){Xo.call(this,hl.Ta,e)}function ml(e){const t=pl();Ua(t,new fl(t))}function gl(e,t){Xo.call(this,hl.STAT_EVENT,e),this.stat=t}function vl(e){const t=pl();Ua(t,new gl(t,e))}function yl(e,t){Xo.call(this,hl.Ua,e),this.size=t}function bl(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return Fo.setTimeout((function(){e()}),t)}hl.Ta="serverreachability",jo(fl,Xo),hl.STAT_EVENT="statevent",jo(gl,Xo),hl.Ua="timingevent",jo(yl,Xo);var xl={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},wl={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function kl(){}function Sl(e){return e.h||(e.h=e.i())}function Il(){}kl.prototype.h=null;var Cl,El={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Tl(){Xo.call(this,"d")}function Nl(){Xo.call(this,"c")}function Al(){}function Rl(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new sl(this),this.P=_l,e=oa?125:void 0,this.V=new el(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new $l}function $l(){this.i=null,this.g="",this.h=!1}jo(Tl,Xo),jo(Nl,Xo),jo(Al,kl),Al.prototype.g=function(){return new XMLHttpRequest},Al.prototype.i=function(){return{}},Cl=new Al;var _l=45e3,Ol={},Dl={};function Fl(e,t,n){e.L=1,e.v=eu(Xl(t)),e.s=n,e.S=!0,Ml(e,null)}function Ml(e,t){e.G=Date.now(),Bl(e),e.A=Xl(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),pu(n.i,"t",r),e.C=0,n=e.l.J,e.h=new $l,e.g=fc(e.l,n?t:null,!e.s),0<e.O&&(e.M=new il(Wo(e.Pa,e,e.g),e.O)),al(e.U,e.g,"readystatechange",e.nb),t=e.I?ka(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),ml(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");o=2<=h.length&&"type"==h[1]?o+(c+"=")+u+"&":o+(c+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function Ll(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function Pl(e,t,n){let r,i=!0;for(;!e.J&&e.C<n.length;){if(r=zl(e,n),r==Dl){4==t&&(e.o=4,vl(14),i=!1),cl(e.j,e.m,null,"[Incomplete Response]");break}if(r==Ol){e.o=4,vl(15),cl(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}cl(e.j,e.m,r,null),Gl(e,r)}Ll(e)&&r!=Dl&&r!=Ol&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,vl(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),oc(t),t.M=!0,vl(11))):(cl(e.j,e.m,n,"[Invalid Chunked Response]"),jl(e),Vl(e))}function zl(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Dl:(n=Number(t.substring(n,r)),isNaN(n)?Ol:(r+=1)+n>t.length?Dl:(t=t.slice(r,r+n),e.C=r+n,t))}function Bl(e){e.Y=Date.now()+e.P,Ul(e,e.P)}function Ul(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=bl(Wo(e.lb,e),t)}function Wl(e){e.B&&(Fo.clearTimeout(e.B),e.B=null)}function Vl(e){0==e.l.H||e.J||uc(e.l,e)}function jl(e){Wl(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,tl(e.V),ll(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Gl(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||xu(n.i,e)))if(!e.K&&xu(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;lc(n),Ju(n)}sc(n),vl(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=bl(Wo(n.ib,n),6e3));if(1>=bu(n.i)&&n.oa){try{n.oa()}catch(u){}n.oa=void 0}}else hc(n,11)}else if((e.K||n.g==e)&&lc(n),!Qo(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const t=u[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const i=u[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const c=u[5];null!=c&&"number"===typeof c&&0<c&&(r=1.5*c,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(wu(s,s.h),s.h=null))}if(r.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,Zl(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((r=n).wa=pc(r,r.J?r.pa:null,r.Y),o.K){ku(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.B&&(Wl(a),Bl(a)),r.g=o}else ic(r);0<n.j.length&&ec(n)}else"stop"!=u[0]&&"close"!=u[0]||hc(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?hc(n,7):Qu(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}ml()}catch(u){}}function Hl(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Mo(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(Mo(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(Mo(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}($o=Rl.prototype).setTimeout=function(e){this.P=e},$o.nb=function(e){e=e.target;const t=this.M;t&&3==Gu(e)?t.l():this.Pa(e)},$o.Pa=function(e){try{if(e==this.g)e:{const c=Gu(this.g);var t=this.g.Ia();this.g.da();if(!(3>c)&&(3!=c||oa||this.g&&(this.h.h||this.g.ja()||Hu(this.g)))){this.J||4!=c||7==t||ml(),Wl(this);var n=this.g.da();this.ca=n;t:if(Ll(this)){var r=Hu(this.g);e="";var i=r.length,s=4==Gu(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){jl(this),Vl(this);var o="";break t}this.h.i=new Fo.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.W,c,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Qo(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,vl(12),jl(this),Vl(this);break e}cl(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gl(this,n)}this.S?(Pl(this,c,o),oa&&this.i&&3==c&&(al(this.U,this.V,"tick",this.mb),this.V.start())):(cl(this.j,this.m,o,null),Gl(this,o)),4==c&&jl(this),this.i&&!this.J&&(4==c?uc(this.l,this):(this.i=!1,Bl(this)))}else(function(e){const t={};e=(e.g&&2<=Gu(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(Qo(e[r]))continue;var n=qa(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,vl(12)):(this.o=0,vl(13)),jl(this),Vl(this)}}}catch(c){}},$o.mb=function(){if(this.g){var e=Gu(this.g),t=this.g.ja();this.C<t.length&&(Wl(this),Pl(this,e,t),this.i&&4!=e&&Bl(this))}},$o.cancel=function(){this.J=!0,jl(this)},$o.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(ml(),vl(17)),jl(this),this.o=2,Vl(this)):Ul(this,this.Y-e)};var ql=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Kl(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Kl){this.h=e.h,Yl(this,e.j),this.s=e.s,this.g=e.g,Ql(this,e.m),this.l=e.l;var t=e.i,n=new uu;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Jl(this,n),this.o=e.o}else e&&(t=String(e).match(ql))?(this.h=!1,Yl(this,t[1]||"",!0),this.s=tu(t[2]||""),this.g=tu(t[3]||"",!0),Ql(this,t[4]),this.l=tu(t[5]||"",!0),Jl(this,t[6]||"",!0),this.o=tu(t[7]||"")):(this.h=!1,this.i=new uu(null,this.h))}function Xl(e){return new Kl(e)}function Yl(e,t,n){e.j=n?tu(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Ql(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Jl(e,t,n){t instanceof uu?(e.i=t,function(e,t){t&&!e.j&&(cu(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(hu(this,t),pu(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=nu(t,au)),e.i=new uu(t,e.h))}function Zl(e,t,n){e.i.set(t,n)}function eu(e){return Zl(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function tu(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function nu(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,ru),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ru(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Kl.prototype.toString=function(){var e=[],t=this.j;t&&e.push(nu(t,iu,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(nu(t,iu,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(nu(n,"/"==n.charAt(0)?ou:su,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",nu(n,lu)),e.join("")};var iu=/[#\/\?@]/g,su=/[#\?:]/g,ou=/[#\?]/g,au=/[#\?@]/g,lu=/#/g;function uu(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function cu(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function hu(e,t){cu(e),t=fu(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function du(e,t){return cu(e),t=fu(e,t),e.g.has(t)}function pu(e,t,n){hu(e,t),0<n.length&&(e.i=null,e.g.set(fu(e,t),qo(n)),e.h+=n.length)}function fu(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}($o=uu.prototype).add=function(e,t){cu(this),this.i=null,e=fu(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},$o.forEach=function(e,t){cu(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},$o.ta=function(){cu(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},$o.Z=function(e){cu(this);let t=[];if("string"===typeof e)du(this,e)&&(t=t.concat(this.g.get(fu(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},$o.set=function(e,t){return cu(this),this.i=null,du(this,e=fu(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},$o.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},$o.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};var mu=class{constructor(e,t){this.g=e,this.map=t}};function gu(e){this.l=e||vu,Fo.PerformanceNavigationTiming?e=0<(e=Fo.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Fo.g&&Fo.g.Ka&&Fo.g.Ka()&&Fo.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var vu=10;function yu(e){return!!e.h||!!e.g&&e.g.size>=e.j}function bu(e){return e.h?1:e.g?e.g.size:0}function xu(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function wu(e,t){e.g?e.g.add(t):e.h=t}function ku(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Su(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return qo(e.i)}gu.prototype.cancel=function(){if(this.i=Su(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Iu,Cu=class{stringify(e){return Fo.JSON.stringify(e,void 0)}parse(e){return Fo.JSON.parse(e,void 0)}};function Eu(){this.g=new Cu}function Tu(e,t,n){const r=n||"";try{Hl(e,(function(e,n){let i=e;Lo(e)&&(i=Va(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Nu(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(s){}}function Au(e){this.l=e.fc||null,this.j=e.ob||!1}function Ru(e,t){Ba.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=$u,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}jo(Au,kl),Au.prototype.g=function(){return new Ru(this.l,this.j)},Au.prototype.i=(Iu={},function(){return Iu}),jo(Ru,Ba);var $u=0;function _u(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function Ou(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Du(e)}function Du(e){e.onreadystatechange&&e.onreadystatechange.call(e)}($o=Ru.prototype).open=function(e,t){if(this.readyState!=$u)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Du(this)},$o.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||Fo).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},$o.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ou(this)),this.readyState=$u},$o.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Du(this)),this.g&&(this.readyState=3,Du(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof Fo.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;_u(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},$o.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ou(this):Du(this),3==this.readyState&&_u(this)}},$o.Za=function(e){this.g&&(this.response=this.responseText=e,Ou(this))},$o.Ya=function(e){this.g&&(this.response=e,Ou(this))},$o.ka=function(){this.g&&Ou(this)},$o.setRequestHeader=function(e,t){this.v.append(e,t)},$o.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},$o.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ru.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Fu=Fo.JSON.parse;function Mu(e){Ba.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Lu,this.L=this.M=!1}jo(Mu,Ba);var Lu="",Pu=/^https?$/i,zu=["POST","PUT"];function Bu(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Uu(e),Vu(e)}function Uu(e){e.F||(e.F=!0,Ua(e,"complete"),Ua(e,"error"))}function Wu(e){if(e.h&&"undefined"!=typeof Do&&(!e.C[1]||4!=Gu(e)||2!=e.da()))if(e.v&&4==Gu(e))nl(e.La,0,e);else if(Ua(e,"readystatechange"),4==Gu(e)){e.h=!1;try{const a=e.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){var i=String(e.I).match(ql)[1]||null;!i&&Fo.self&&Fo.self.location&&(i=Fo.self.location.protocol.slice(0,-1)),r=!Pu.test(i?i.toLowerCase():"")}n=r}if(n)Ua(e,"complete"),Ua(e,"success");else{e.m=6;try{var s=2<Gu(e)?e.g.statusText:""}catch(o){s=""}e.j=s+" ["+e.da()+"]",Uu(e)}}finally{Vu(e)}}}function Vu(e,t){if(e.g){ju(e);const r=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Ua(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function ju(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(Fo.clearTimeout(e.A),e.A=null)}function Gu(e){return e.g?e.g.readyState:0}function Hu(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case Lu:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function qu(e){let t="";return wa(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Ku(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=qu(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Zl(e,t,n))}function Xu(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Yu(e){this.Ga=0,this.j=[],this.l=new ul,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Xu("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Xu("baseRetryDelayMs",5e3,e),this.hb=Xu("retryDelaySeedMs",1e4,e),this.eb=Xu("forwardChannelMaxRetries",2,e),this.xa=Xu("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new gu(e&&e.concurrentRequestLimit),this.Ja=new Eu,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Qu(e){if(Zu(e),3==e.H){var t=e.W++,n=Xl(e.I);if(Zl(n,"SID",e.K),Zl(n,"RID",t),Zl(n,"TYPE","terminate"),nc(e,n),(t=new Rl(e,e.l,t)).L=2,t.v=eu(Xl(n)),n=!1,Fo.navigator&&Fo.navigator.sendBeacon)try{n=Fo.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&Fo.Image&&((new Image).src=t.v,n=!0),n||(t.g=fc(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Bl(t)}dc(e)}function Ju(e){e.g&&(oc(e),e.g.cancel(),e.g=null)}function Zu(e){Ju(e),e.u&&(Fo.clearTimeout(e.u),e.u=null),lc(e),e.i.cancel(),e.m&&("number"===typeof e.m&&Fo.clearTimeout(e.m),e.m=null)}function ec(e){if(!yu(e.i)&&!e.m){e.m=!0;var t=e.Na;Xa||Ja(),Ya||(Xa(),Ya=!0),Qa.add(t,e),e.C=0}}function tc(e,t){var n;n=t?t.m:e.W++;const r=Xl(e.I);Zl(r,"SID",e.K),Zl(r,"RID",n),Zl(r,"AID",e.V),nc(e,r),e.o&&e.s&&Ku(r,e.o,e.s),n=new Rl(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=rc(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),wu(e.i,n),Fl(n,r,t)}function nc(e,t){e.na&&wa(e.na,(function(e,n){Zl(t,n,e)})),e.h&&Hl({},(function(e,n){Zl(t,n,e)}))}function rc(e,t,n){n=Math.min(e.j.length,n);var r=e.h?Wo(e.h.Va,e.h,e):null;e:{var i=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let a=0;a<n;a++){let n=i[a].g;const l=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),o=!1;else try{Tu(l,e,"req"+n+"_")}catch(s){r&&r(l)}}if(o){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function ic(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Xa||Ja(),Ya||(Xa(),Ya=!0),Qa.add(t,e),e.A=0}}function sc(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=bl(Wo(e.Ma,e),cc(e,e.A)),e.A++,!0)}function oc(e){null!=e.B&&(Fo.clearTimeout(e.B),e.B=null)}function ac(e){e.g=new Rl(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Xl(e.wa);Zl(t,"RID","rpc"),Zl(t,"SID",e.K),Zl(t,"AID",e.V),Zl(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Zl(t,"TO",e.qa),Zl(t,"TYPE","xmlhttp"),nc(e,t),e.o&&e.s&&Ku(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=eu(Xl(t)),n.s=null,n.S=!0,Ml(n,e)}function lc(e){null!=e.v&&(Fo.clearTimeout(e.v),e.v=null)}function uc(e,t){var n=null;if(e.g==t){lc(e),oc(e),e.g=null;var r=2}else{if(!xu(e.i,t))return;n=t.F,ku(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;Ua(r=pl(),new yl(r,n)),ec(e)}else ic(e);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(bu(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=bl(Wo(e.Na,e,t),cc(e,e.C)),e.C++,!0))}(e,t)||2==r&&sc(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:hc(e,5);break;case 4:hc(e,10);break;case 3:hc(e,6);break;default:hc(e,2)}}function cc(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function hc(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=Wo(e.pb,e);n||(n=new Kl("//www.google.com/images/cleardot.gif"),Fo.location&&"http"==Fo.location.protocol||Yl(n,"https"),eu(n)),function(e,t){const n=new ul;if(Fo.Image){const r=new Image;r.onload=Vo(Nu,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Vo(Nu,n,r,"TestLoadImage: error",!1,t),r.onabort=Vo(Nu,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Vo(Nu,n,r,"TestLoadImage: timeout",!1,t),Fo.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else vl(2);e.H=0,e.h&&e.h.za(t),dc(e),Zu(e)}function dc(e){if(e.H=0,e.ma=[],e.h){const t=Su(e.i);0==t.length&&0==e.j.length||(Ko(e.ma,t),Ko(e.ma,e.j),e.i.i.length=0,qo(e.j),e.j.length=0),e.h.ya()}}function pc(e,t,n){var r=n instanceof Kl?Xl(n):new Kl(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Ql(r,r.m);else{var i=Fo.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Kl(null);r&&Yl(s,r),t&&(s.g=t),i&&Ql(s,i),n&&(s.l=n),r=s}return n=e.F,t=e.Da,n&&t&&Zl(r,n,t),Zl(r,"VER",e.ra),nc(e,r),r}function fc(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new Mu(new Au({ob:!0})):new Mu(e.va)).Oa(e.J),t}function mc(){}function gc(){if(ia&&!(10<=Number(fa)))throw Error("Environmental error: no available transport.")}function vc(e,t){Ba.call(this),this.g=new Yu(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Qo(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Qo(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new xc(this)}function yc(e){Tl.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function bc(){Nl.call(this),this.status=1}function xc(e){this.g=e}function wc(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function kc(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function Sc(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}($o=Mu.prototype).Oa=function(e){this.M=e},$o.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Cl.g(),this.C=this.u?Sl(this.u):Sl(Cl),this.g.onreadystatechange=Wo(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){return void Bu(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=Fo.FormData&&e instanceof Fo.FormData,!(0<=Ho(zu,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,a]of n)this.g.setRequestHeader(o,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{ju(this),0<this.B&&((this.L=function(e){return ia&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Wo(this.ua,this)):this.A=nl(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Bu(this,s)}},$o.ua=function(){"undefined"!=typeof Do&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ua(this,"timeout"),this.abort(8))},$o.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Ua(this,"complete"),Ua(this,"abort"),Vu(this))},$o.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Vu(this,!0)),Mu.$.N.call(this)},$o.La=function(){this.s||(this.G||this.v||this.l?Wu(this):this.kb())},$o.kb=function(){Wu(this)},$o.isActive=function(){return!!this.g},$o.da=function(){try{return 2<Gu(this)?this.g.status:-1}catch(Iu){return-1}},$o.ja=function(){try{return this.g?this.g.responseText:""}catch(Iu){return""}},$o.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Fu(t)}},$o.Ia=function(){return this.m},$o.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},($o=Yu.prototype).ra=8,$o.H=1,$o.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new Rl(this,this.l,e);let s=this.s;if(this.U&&(s?(s=ka(s),Ia(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=rc(this,i,t),Zl(n=Xl(this.I),"RID",e),Zl(n,"CVER",22),this.F&&Zl(n,"X-HTTP-Session-Id",this.F),nc(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(qu(s)))+"&"+t:this.o&&Ku(n,this.o,s)),wu(this.i,i),this.bb&&Zl(n,"TYPE","init"),this.P?(Zl(n,"$req",t),Zl(n,"SID","null"),i.aa=!0,Fl(i,n,null)):Fl(i,n,t),this.H=2}}else 3==this.H&&(e?tc(this,e):0==this.j.length||yu(this.i)||tc(this))},$o.Ma=function(){if(this.u=null,ac(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=bl(Wo(this.jb,this),e)}},$o.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,vl(10),Ju(this),ac(this))},$o.ib=function(){null!=this.v&&(this.v=null,Ju(this),sc(this),vl(19))},$o.pb=function(e){e?(this.l.info("Successfully pinged google.com"),vl(2)):(this.l.info("Failed to ping google.com"),vl(1))},$o.isActive=function(){return!!this.h&&this.h.isActive(this)},($o=mc.prototype).Ba=function(){},$o.Aa=function(){},$o.za=function(){},$o.ya=function(){},$o.isActive=function(){return!0},$o.Va=function(){},gc.prototype.g=function(e,t){return new vc(e,t)},jo(vc,Ba),vc.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;vl(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=pc(e,null,e.Y),ec(e)},vc.prototype.close=function(){Qu(this.g)},vc.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Va(e),e=n);t.j.push(new mu(t.fb++,e)),3==t.H&&ec(t)},vc.prototype.N=function(){this.g.h=null,delete this.j,Qu(this.g),delete this.g,vc.$.N.call(this)},jo(yc,Tl),jo(bc,Nl),jo(xc,mc),xc.prototype.Ba=function(){Ua(this.g,"a")},xc.prototype.Aa=function(e){Ua(this.g,new yc(e))},xc.prototype.za=function(e){Ua(this.g,new bc)},xc.prototype.ya=function(){Ua(this.g,"b")},jo(wc,(function(){this.blockSize=-1})),wc.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},wc.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)kc(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){kc(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){kc(this,r),i=0;break}}this.h=i,this.i+=t},wc.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var Ic={};function Cc(e){return-128<=e&&128>e?function(e,t){var n=Ic;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new Sc([0|e],0>e?-1:0)})):new Sc([0|e],0>e?-1:0)}function Ec(e){if(isNaN(e)||!isFinite(e))return Nc;if(0>e)return Oc(Ec(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=Tc;return new Sc(t,0)}var Tc=4294967296,Nc=Cc(0),Ac=Cc(1),Rc=Cc(16777216);function $c(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function _c(e){return-1==e.h}function Oc(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new Sc(n,~e.h).add(Ac)}function Dc(e,t){return e.add(Oc(t))}function Fc(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Mc(e,t){this.g=e,this.h=t}function Lc(e,t){if($c(t))throw Error("division by zero");if($c(e))return new Mc(Nc,Nc);if(_c(e))return t=Lc(Oc(e),t),new Mc(Oc(t.g),Oc(t.h));if(_c(t))return t=Lc(e,Oc(t)),new Mc(Oc(t.g),t.h);if(30<e.g.length){if(_c(e)||_c(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Ac,r=t;0>=r.X(e);)n=Pc(n),r=Pc(r);var i=zc(n,1),s=zc(r,1);for(r=zc(r,2),n=zc(n,2);!$c(r);){var o=s.add(r);0>=o.X(e)&&(i=i.add(n),s=o),r=zc(r,1),n=zc(n,1)}return t=Dc(e,i.R(t)),new Mc(i,t)}for(i=Nc;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Ec(n)).R(t);_c(o)||0<o.X(e);)o=(s=Ec(n-=r)).R(t);$c(s)&&(s=Ac),i=i.add(s),e=Dc(e,o)}return new Mc(i,e)}function Pc(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new Sc(n,e.h)}function zc(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new Sc(i,e.h)}($o=Sc.prototype).ea=function(){if(_c(this))return-Oc(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:Tc+r)*t,t*=Tc}return e},$o.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if($c(this))return"0";if(_c(this))return"-"+Oc(this).toString(e);for(var t=Ec(Math.pow(e,6)),n=this,r="";;){var i=Lc(n,t).g,s=((0<(n=Dc(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if($c(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},$o.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},$o.X=function(e){return _c(e=Dc(this,e))?-1:$c(e)?0:1},$o.abs=function(){return _c(this)?Oc(this):this},$o.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&e.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Sc(n,-2147483648&n[n.length-1]?-1:0)},$o.R=function(e){if($c(this)||$c(e))return Nc;if(_c(this))return _c(e)?Oc(this).R(Oc(e)):Oc(Oc(this).R(e));if(_c(e))return Oc(this.R(Oc(e)));if(0>this.X(Rc)&&0>e.X(Rc))return Ec(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=e.D(i)>>>16,l=65535&e.D(i);n[2*r+2*i]+=o*l,Fc(n,2*r+2*i),n[2*r+2*i+1]+=s*l,Fc(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Fc(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Fc(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new Sc(n,0)},$o.gb=function(e){return Lc(this,e).h},$o.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new Sc(n,this.h&e.h)},$o.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new Sc(n,this.h|e.h)},$o.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new Sc(n,this.h^e.h)},gc.prototype.createWebChannel=gc.prototype.g,vc.prototype.send=vc.prototype.u,vc.prototype.open=vc.prototype.m,vc.prototype.close=vc.prototype.close,xl.NO_ERROR=0,xl.TIMEOUT=8,xl.HTTP_ERROR=6,wl.COMPLETE="complete",Il.EventType=El,El.OPEN="a",El.CLOSE="b",El.ERROR="c",El.MESSAGE="d",Ba.prototype.listen=Ba.prototype.O,Mu.prototype.listenOnce=Mu.prototype.P,Mu.prototype.getLastError=Mu.prototype.Sa,Mu.prototype.getLastErrorCode=Mu.prototype.Ia,Mu.prototype.getStatus=Mu.prototype.da,Mu.prototype.getResponseJson=Mu.prototype.Wa,Mu.prototype.getResponseText=Mu.prototype.ja,Mu.prototype.send=Mu.prototype.ha,Mu.prototype.setWithCredentials=Mu.prototype.Oa,wc.prototype.digest=wc.prototype.l,wc.prototype.reset=wc.prototype.reset,wc.prototype.update=wc.prototype.j,Sc.prototype.add=Sc.prototype.add,Sc.prototype.multiply=Sc.prototype.R,Sc.prototype.modulo=Sc.prototype.gb,Sc.prototype.compare=Sc.prototype.X,Sc.prototype.toNumber=Sc.prototype.ea,Sc.prototype.toString=Sc.prototype.toString,Sc.prototype.getBits=Sc.prototype.D,Sc.fromNumber=Ec,Sc.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Oc(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Ec(Math.pow(n,8)),i=Nc,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=Ec(Math.pow(n,o)),i=i.R(o).add(Ec(a))):i=(i=i.R(r)).add(Ec(a))}return i};var Bc=Oo.createWebChannelTransport=function(){return new gc},Uc=Oo.getStatEventTarget=function(){return pl()},Wc=Oo.ErrorCode=xl,Vc=Oo.EventType=wl,jc=Oo.Event=hl,Gc=Oo.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Hc=Oo.FetchXmlHttpFactory=Au,qc=Oo.WebChannel=Il,Kc=Oo.XhrIo=Mu,Xc=Oo.Md5=wc,Yc=Oo.Integer=Sc;const Qc="@firebase/firestore";class Jc{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Jc.UNAUTHENTICATED=new Jc(null),Jc.GOOGLE_CREDENTIALS=new Jc("google-credentials-uid"),Jc.FIRST_PARTY=new Jc("first-party-uid"),Jc.MOCK_USER=new Jc("mock-user");let Zc="9.23.0";const eh=new un("@firebase/firestore");function th(){return eh.logLevel}function nh(e){if(eh.logLevel<=nn.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(sh);eh.debug(`Firestore (${Zc}): ${e}`,...i)}}function rh(e){if(eh.logLevel<=nn.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(sh);eh.error(`Firestore (${Zc}): ${e}`,...i)}}function ih(e){if(eh.logLevel<=nn.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(sh);eh.warn(`Firestore (${Zc}): ${e}`,...i)}}function sh(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function oh(){const e=`FIRESTORE (${Zc}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw rh(e),new Error(e)}function ah(e,t){e||oh()}function lh(e,t){return e}const uh={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ch extends Bt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class hh{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class dh{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ph{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Jc.UNAUTHENTICATED)))}shutdown(){}}class fh{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class mh{constructor(e){this.t=e,this.currentUser=Jc.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new hh;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new hh,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{nh("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(nh("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new hh)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(nh("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(ah("string"==typeof t.accessToken),new dh(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ah(null===e||"string"==typeof e),new Jc(e)}}class gh{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=Jc.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class vh{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new gh(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(Jc.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class yh{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bh{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&nh("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.T;return this.T=e.token,nh("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{nh("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?r(e):nh("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(ah("string"==typeof e.token),this.T=e.token,new yh(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function xh(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class wh{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=xh(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function kh(e,t){return e<t?-1:e>t?1:0}function Sh(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class Ih{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ch(uh.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ch(uh.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ch(uh.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ch(uh.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ih.fromMillis(Date.now())}static fromDate(e){return Ih.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Ih(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?kh(this.nanoseconds,e.nanoseconds):kh(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ch{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ch(e)}static min(){return new Ch(new Ih(0,0))}static max(){return new Ch(new Ih(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Eh{constructor(e,t,n){void 0===t?t=0:t>e.length&&oh(),void 0===n?n=e.length-t:n>e.length-t&&oh(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Eh.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Eh?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Th extends Eh{construct(e,t,n){return new Th(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new ch(uh.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((e=>e.length>0)))}return new Th(e)}static emptyPath(){return new Th([])}}const Nh=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ah extends Eh{construct(e,t,n){return new Ah(e,t,n)}static isValidIdentifier(e){return Nh.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ah.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ah(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new ch(uh.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new ch(uh.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new ch(uh.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new ch(uh.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ah(t)}static emptyPath(){return new Ah([])}}class Rh{constructor(e){this.path=e}static fromPath(e){return new Rh(Th.fromString(e))}static fromName(e){return new Rh(Th.fromString(e).popFirst(5))}static empty(){return new Rh(Th.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Th.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Th.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Rh(new Th(e.slice()))}}class $h{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}$h.UNKNOWN_ID=-1;function _h(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Ch.fromTimestamp(1e9===r?new Ih(n+1,0):new Ih(n,r));return new Dh(i,Rh.empty(),t)}function Oh(e){return new Dh(e.readTime,e.key,-1)}class Dh{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Dh(Ch.min(),Rh.empty(),-1)}static max(){return new Dh(Ch.max(),Rh.empty(),-1)}}function Fh(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Rh.comparator(e.documentKey,t.documentKey),0!==n?n:kh(e.largestBatchId,t.largestBatchId))}const Mh="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Lh{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ph(e){if(e.code!==uh.FAILED_PRECONDITION||e.message!==Mh)throw e;nh("LocalStore","Unexpectedly lost primary lease")}class zh{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&oh(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new zh(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof zh?t:zh.resolve(t)}catch(e){return zh.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):zh.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):zh.reject(t)}static resolve(e){return new zh(((t,n)=>{t(e)}))}static reject(e){return new zh(((t,n)=>{n(e)}))}static waitFor(e){return new zh(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=zh.resolve(!1);for(const n of e)t=t.next((e=>e?zh.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new zh(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next((e=>{s[l]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new zh(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}function Bh(e){return"IndexedDbTransactionError"===e.name}class Uh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function Wh(e){return null==e}function Vh(e){return 0===e&&1/e==-1/0}function jh(e){return"number"==typeof e&&Number.isInteger(e)&&!Vh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}Uh.ct=-1;const Gh=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Hh=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],qh=Hh;function Kh(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Xh(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Yh(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Qh{constructor(e,t){this.comparator=e,this.root=t||Zh.EMPTY}insert(e,t){return new Qh(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Zh.BLACK,null,null))}remove(e){return new Qh(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zh.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jh(this.root,e,this.comparator,!0)}}class Jh{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zh{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Zh.RED,this.left=null!=r?r:Zh.EMPTY,this.right=null!=i?i:Zh.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Zh(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Zh.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Zh.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zh.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zh.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw oh();if(this.right.isRed())throw oh();const e=this.left.check();if(e!==this.right.check())throw oh();return e+(this.isRed()?0:1)}}Zh.EMPTY=null,Zh.RED=!0,Zh.BLACK=!1,Zh.EMPTY=new class{constructor(){this.size=0}get key(){throw oh()}get value(){throw oh()}get color(){throw oh()}get left(){throw oh()}get right(){throw oh()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Zh(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ed{constructor(e){this.comparator=e,this.data=new Qh(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new td(this.data.getIterator())}getIteratorFrom(e){return new td(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof ed))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ed(this.comparator);return t.data=e,t}}class td{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class nd{constructor(e){this.fields=e,e.sort(Ah.comparator)}static empty(){return new nd([])}unionWith(e){let t=new ed(Ah.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new nd(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Sh(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class rd extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class id{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new rd("Invalid base64 string: "+e):e}}(e);return new id(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new id(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return kh(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}id.EMPTY_BYTE_STRING=new id("");const sd=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function od(e){if(ah(!!e),"string"==typeof e){let t=0;const n=sd.exec(e);if(ah(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ad(e.seconds),nanos:ad(e.nanos)}}function ad(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ld(e){return"string"==typeof e?id.fromBase64String(e):id.fromUint8Array(e)}function ud(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function cd(e){const t=e.mapValue.fields.__previous_value__;return ud(t)?cd(t):t}function hd(e){const t=od(e.mapValue.fields.__local_write_time__.timestampValue);return new Ih(t.seconds,t.nanos)}class dd{constructor(e,t,n,r,i,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class pd{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new pd("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof pd&&e.projectId===this.projectId&&e.database===this.database}}const fd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function md(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ud(e)?4:Ad(e)?9007199254740991:10:oh()}function gd(e,t){if(e===t)return!0;const n=md(e);if(n!==md(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return hd(e).isEqual(hd(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=od(e.timestampValue),r=od(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ld(e.bytesValue).isEqual(ld(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return ad(e.geoPointValue.latitude)===ad(t.geoPointValue.latitude)&&ad(e.geoPointValue.longitude)===ad(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return ad(e.integerValue)===ad(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=ad(e.doubleValue),r=ad(t.doubleValue);return n===r?Vh(n)===Vh(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Sh(e.arrayValue.values||[],t.arrayValue.values||[],gd);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Kh(n)!==Kh(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!gd(n[i],r[i])))return!1;return!0}(e,t);default:return oh()}}function vd(e,t){return void 0!==(e.values||[]).find((e=>gd(e,t)))}function yd(e,t){if(e===t)return 0;const n=md(e),r=md(t);if(n!==r)return kh(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return kh(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=ad(e.integerValue||e.doubleValue),r=ad(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return bd(e.timestampValue,t.timestampValue);case 4:return bd(hd(e),hd(t));case 5:return kh(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ld(e),r=ld(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=kh(n[i],r[i]);if(0!==e)return e}return kh(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=kh(ad(e.latitude),ad(t.latitude));return 0!==n?n:kh(ad(e.longitude),ad(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=yd(n[i],r[i]);if(e)return e}return kh(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===fd.mapValue&&t===fd.mapValue)return 0;if(e===fd.mapValue)return 1;if(t===fd.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=kh(r[o],s[o]);if(0!==e)return e;const t=yd(n[r[o]],i[s[o]]);if(0!==t)return t}return kh(r.length,s.length)}(e.mapValue,t.mapValue);default:throw oh()}}function bd(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return kh(e,t);const n=od(e),r=od(t),i=kh(n.seconds,r.seconds);return 0!==i?i:kh(n.nanos,r.nanos)}function xd(e){return wd(e)}function wd(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=od(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?ld(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Rh.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=wd(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${wd(e.fields[i])}`;return n+"}"}(e.mapValue):oh();var t,n}function kd(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Sd(e){return!!e&&"integerValue"in e}function Id(e){return!!e&&"arrayValue"in e}function Cd(e){return!!e&&"nullValue"in e}function Ed(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Td(e){return!!e&&"mapValue"in e}function Nd(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Xh(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Nd(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Nd(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Ad(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Rd{constructor(e){this.value=e}static empty(){return new Rd({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Td(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nd(t)}setAll(e){let t=Ah.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Nd(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Td(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gd(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Td(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Xh(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new Rd(Nd(this.value))}}function $d(e){const t=[];return Xh(e.fields,((e,n)=>{const r=new Ah([e]);if(Td(n)){const e=$d(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new nd(t)}class _d{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new _d(e,0,Ch.min(),Ch.min(),Ch.min(),Rd.empty(),0)}static newFoundDocument(e,t,n,r){return new _d(e,1,t,Ch.min(),n,r,0)}static newNoDocument(e,t){return new _d(e,2,t,Ch.min(),Ch.min(),Rd.empty(),0)}static newUnknownDocument(e,t){return new _d(e,3,t,Ch.min(),Ch.min(),Rd.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ch.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rd.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rd.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ch.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof _d&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _d(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Od{constructor(e,t){this.position=e,this.inclusive=t}}function Dd(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Rh.comparator(Rh.fromName(o.referenceValue),n.key):yd(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Fd(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!gd(e.position[n],t.position[n]))return!1;return!0}class Md{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Ld(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Pd{}class zd extends Pd{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new qd(e,t,n):"array-contains"===t?new Qd(e,n):"in"===t?new Jd(e,n):"not-in"===t?new Zd(e,n):"array-contains-any"===t?new ep(e,n):new zd(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Kd(e,n):new Xd(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(yd(t,this.value)):null!==t&&md(this.value)===md(t)&&this.matchesComparison(yd(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return oh()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Bd extends Pd{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new Bd(e,t)}matches(e){return Ud(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft((e=>e.isInequality()));return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Ud(e){return"and"===e.op}function Wd(e){return Vd(e)&&Ud(e)}function Vd(e){for(const t of e.filters)if(t instanceof Bd)return!1;return!0}function jd(e){if(e instanceof zd)return e.field.canonicalString()+e.op.toString()+xd(e.value);if(Wd(e))return e.filters.map((e=>jd(e))).join(",");{const t=e.filters.map((e=>jd(e))).join(",");return`${e.op}(${t})`}}function Gd(e,t){return e instanceof zd?function(e,t){return t instanceof zd&&e.op===t.op&&e.field.isEqual(t.field)&&gd(e.value,t.value)}(e,t):e instanceof Bd?function(e,t){return t instanceof Bd&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&Gd(n,t.filters[r])),!0)}(e,t):void oh()}function Hd(e){return e instanceof zd?function(e){return`${e.field.canonicalString()} ${e.op} ${xd(e.value)}`}(e):e instanceof Bd?function(e){return e.op.toString()+" {"+e.getFilters().map(Hd).join(" ,")+"}"}(e):"Filter"}class qd extends zd{constructor(e,t,n){super(e,t,n),this.key=Rh.fromName(n.referenceValue)}matches(e){const t=Rh.comparator(e.key,this.key);return this.matchesComparison(t)}}class Kd extends zd{constructor(e,t){super(e,"in",t),this.keys=Yd("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Xd extends zd{constructor(e,t){super(e,"not-in",t),this.keys=Yd("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Yd(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Rh.fromName(e.referenceValue)))}class Qd extends zd{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Id(t)&&vd(t.arrayValue,this.value)}}class Jd extends zd{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&vd(this.value.arrayValue,t)}}class Zd extends zd{constructor(e,t){super(e,"not-in",t)}matches(e){if(vd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!vd(this.value.arrayValue,t)}}class ep extends zd{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Id(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>vd(this.value.arrayValue,e)))}}class tp{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.dt=null}}function np(e){return new tp(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function rp(e){const t=lh(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>jd(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Wh(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>xd(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>xd(e))).join(",")),t.dt=e}return t.dt}function ip(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Ld(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Gd(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Fd(e.startAt,t.startAt)&&Fd(e.endAt,t.endAt)}function sp(e){return Rh.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class op{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.wt=null,this._t=null,this.startAt,this.endAt}}function ap(e,t,n,r,i,s,o,a){return new op(e,t,n,r,i,s,o,a)}function lp(e){return new op(e)}function up(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function cp(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function hp(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function dp(e){return null!==e.collectionGroup}function pp(e){const t=lh(e);if(null===t.wt){t.wt=[];const e=hp(t),n=cp(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new Md(e)),t.wt.push(new Md(Ah.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new Md(Ah.keyField(),e))}}}return t.wt}function fp(e){const t=lh(e);if(!t._t)if("F"===t.limitType)t._t=np(t.path,t.collectionGroup,pp(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of pp(t)){const t="desc"===i.dir?"asc":"desc";e.push(new Md(i.field,t))}const n=t.endAt?new Od(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Od(t.startAt.position,t.startAt.inclusive):null;t._t=np(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t._t}function mp(e,t){t.getFirstInequalityField(),hp(e);const n=e.filters.concat([t]);return new op(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function gp(e,t,n){return new op(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function vp(e,t){return ip(fp(e),fp(t))&&e.limitType===t.limitType}function yp(e){return`${rp(fp(e))}|lt:${e.limitType}`}function bp(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Hd(e))).join(", ")}]`),Wh(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>xd(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>xd(e))).join(",")),`Target(${t})`}(fp(e))}; limitType=${e.limitType})`}function xp(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Rh.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of pp(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Dd(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,pp(e),t))&&!(e.endAt&&!function(e,t,n){const r=Dd(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,pp(e),t))}(e,t)}function wp(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function kp(e){return(t,n)=>{let r=!1;for(const i of pp(e)){const e=Sp(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Sp(e,t,n){const r=e.field.isKeyField()?Rh.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?yd(r,i):oh()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return oh()}}class Ip{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Xh(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return Yh(this.inner)}size(){return this.innerSize}}const Cp=new Qh(Rh.comparator);function Ep(){return Cp}const Tp=new Qh(Rh.comparator);function Np(){let e=Tp;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Ap(e){let t=Tp;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Rp(){return _p()}function $p(){return _p()}function _p(){return new Ip((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Op=new Qh(Rh.comparator),Dp=new ed(Rh.comparator);function Fp(){let e=Dp;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Mp=new ed(kh);function Lp(){return Mp}function Pp(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vh(t)?"-0":t}}function zp(e){return{integerValue:""+e}}function Bp(e,t){return jh(t)?zp(t):Pp(e,t)}class Up{constructor(){this._=void 0}}function Wp(e,t,n){return e instanceof Gp?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&ud(t)&&(t=cd(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Hp?qp(e,t):e instanceof Kp?Xp(e,t):function(e,t){const n=jp(e,t),r=Qp(n)+Qp(e.gt);return Sd(n)&&Sd(e.gt)?zp(r):Pp(e.serializer,r)}(e,t)}function Vp(e,t,n){return e instanceof Hp?qp(e,t):e instanceof Kp?Xp(e,t):n}function jp(e,t){return e instanceof Yp?Sd(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class Gp extends Up{}class Hp extends Up{constructor(e){super(),this.elements=e}}function qp(e,t){const n=Jp(t);for(const r of e.elements)n.some((e=>gd(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Kp extends Up{constructor(e){super(),this.elements=e}}function Xp(e,t){let n=Jp(t);for(const r of e.elements)n=n.filter((e=>!gd(e,r)));return{arrayValue:{values:n}}}class Yp extends Up{constructor(e,t){super(),this.serializer=e,this.gt=t}}function Qp(e){return ad(e.integerValue||e.doubleValue)}function Jp(e){return Id(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Zp{constructor(e,t){this.version=e,this.transformResults=t}}class ef{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ef}static exists(e){return new ef(void 0,e)}static updateTime(e){return new ef(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function tf(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class nf{}function rf(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new ff(e.key,ef.none()):new uf(e.key,e.data,ef.none());{const n=e.data,r=Rd.empty();let i=new ed(Ah.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new cf(e.key,r,new nd(i.toArray()),ef.none())}}function sf(e,t,n){e instanceof uf?function(e,t,n){const r=e.value.clone(),i=df(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof cf?function(e,t,n){if(!tf(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=df(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(hf(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function of(e,t,n,r){return e instanceof uf?function(e,t,n,r){if(!tf(e.precondition,t))return n;const i=e.value.clone(),s=pf(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof cf?function(e,t,n,r){if(!tf(e.precondition,t))return n;const i=pf(e.fieldTransforms,r,t),s=t.data;return s.setAll(hf(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return tf(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function af(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=jp(r.transform,e||null);null!=i&&(null===n&&(n=Rd.empty()),n.set(r.field,i))}return n||null}function lf(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Sh(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Hp&&t instanceof Hp||e instanceof Kp&&t instanceof Kp?Sh(e.elements,t.elements,gd):e instanceof Yp&&t instanceof Yp?gd(e.gt,t.gt):e instanceof Gp&&t instanceof Gp}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class uf extends nf{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class cf extends nf{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function hf(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function df(e,t,n){const r=new Map;ah(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Vp(o,a,n[i]))}return r}function pf(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Wp(e,s,t))}return r}class ff extends nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mf extends nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class gf{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&sf(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=of(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=of(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=$p();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=rf(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Ch.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Fp())}isEqual(e){return this.batchId===e.batchId&&Sh(this.mutations,e.mutations,((e,t)=>lf(e,t)))&&Sh(this.baseMutations,e.baseMutations,((e,t)=>lf(e,t)))}}class vf{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){ah(e.mutations.length===n.length);let r=Op;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new vf(e,t,n,r)}}class yf{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class bf{constructor(e,t){this.count=e,this.unchangedNames=t}}var xf,wf;function kf(e){switch(e){default:return oh();case uh.CANCELLED:case uh.UNKNOWN:case uh.DEADLINE_EXCEEDED:case uh.RESOURCE_EXHAUSTED:case uh.INTERNAL:case uh.UNAVAILABLE:case uh.UNAUTHENTICATED:return!1;case uh.INVALID_ARGUMENT:case uh.NOT_FOUND:case uh.ALREADY_EXISTS:case uh.PERMISSION_DENIED:case uh.FAILED_PRECONDITION:case uh.ABORTED:case uh.OUT_OF_RANGE:case uh.UNIMPLEMENTED:case uh.DATA_LOSS:return!0}}function Sf(e){if(void 0===e)return rh("GRPC error has no .code"),uh.UNKNOWN;switch(e){case xf.OK:return uh.OK;case xf.CANCELLED:return uh.CANCELLED;case xf.UNKNOWN:return uh.UNKNOWN;case xf.DEADLINE_EXCEEDED:return uh.DEADLINE_EXCEEDED;case xf.RESOURCE_EXHAUSTED:return uh.RESOURCE_EXHAUSTED;case xf.INTERNAL:return uh.INTERNAL;case xf.UNAVAILABLE:return uh.UNAVAILABLE;case xf.UNAUTHENTICATED:return uh.UNAUTHENTICATED;case xf.INVALID_ARGUMENT:return uh.INVALID_ARGUMENT;case xf.NOT_FOUND:return uh.NOT_FOUND;case xf.ALREADY_EXISTS:return uh.ALREADY_EXISTS;case xf.PERMISSION_DENIED:return uh.PERMISSION_DENIED;case xf.FAILED_PRECONDITION:return uh.FAILED_PRECONDITION;case xf.ABORTED:return uh.ABORTED;case xf.OUT_OF_RANGE:return uh.OUT_OF_RANGE;case xf.UNIMPLEMENTED:return uh.UNIMPLEMENTED;case xf.DATA_LOSS:return uh.DATA_LOSS;default:return oh()}}(wf=xf||(xf={}))[wf.OK=0]="OK",wf[wf.CANCELLED=1]="CANCELLED",wf[wf.UNKNOWN=2]="UNKNOWN",wf[wf.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wf[wf.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wf[wf.NOT_FOUND=5]="NOT_FOUND",wf[wf.ALREADY_EXISTS=6]="ALREADY_EXISTS",wf[wf.PERMISSION_DENIED=7]="PERMISSION_DENIED",wf[wf.UNAUTHENTICATED=16]="UNAUTHENTICATED",wf[wf.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wf[wf.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wf[wf.ABORTED=10]="ABORTED",wf[wf.OUT_OF_RANGE=11]="OUT_OF_RANGE",wf[wf.UNIMPLEMENTED=12]="UNIMPLEMENTED",wf[wf.INTERNAL=13]="INTERNAL",wf[wf.UNAVAILABLE=14]="UNAVAILABLE",wf[wf.DATA_LOSS=15]="DATA_LOSS";class If{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Cf}static getOrCreateInstance(){return null===Cf&&(Cf=new If),Cf}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach((t=>t(e)))}}let Cf=null;function Ef(){return new TextEncoder}const Tf=new Yc([4294967295,4294967295],0);function Nf(e){const t=Ef().encode(e),n=new Xc;return n.update(t),new Uint8Array(n.digest())}function Af(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Yc([n,r],0),new Yc([i,s],0)]}class Rf{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new $f(`Invalid padding: ${t}`);if(n<0)throw new $f(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new $f(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new $f(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=Yc.fromNumber(this.It)}Et(e,t,n){let r=e.add(t.multiply(Yc.fromNumber(n)));return 1===r.compare(Tf)&&(r=new Yc([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=Nf(e),[n,r]=Af(t);for(let i=0;i<this.hashCount;i++){const e=this.Et(n,r,i);if(!this.At(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Rf(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.It)return;const t=Nf(e),[n,r]=Af(t);for(let i=0;i<this.hashCount;i++){const e=this.Et(n,r,i);this.Rt(e)}}Rt(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class $f extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class _f{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Of.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new _f(Ch.min(),r,new Qh(kh),Ep(),Fp())}}class Of{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Of(n,t,Fp(),Fp(),Fp())}}class Df{constructor(e,t,n,r){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=r}}class Ff{constructor(e,t){this.targetId=e,this.Vt=t}}class Mf{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:id.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Lf{constructor(){this.St=0,this.Dt=Bf(),this.Ct=id.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Fp(),t=Fp(),n=Fp();return this.Dt.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:oh()}})),new Of(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=Bf()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Pf{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Ep(),this.zt=zf(),this.Wt=new Qh(kh)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,(t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:oh()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach(((e,n)=>{this.te(n)&&t(n)}))}ne(e){var t;const n=e.targetId,r=e.Vt.count,i=this.se(n);if(i){const s=i.target;if(sp(s))if(0===r){const e=new Rh(s.path);this.Yt(n,e,_d.newNoDocument(e,Ch.min()))}else ah(1===r);else{const i=this.ie(n);if(i!==r){const r=this.re(e,i);if(0!==r){this.ee(n);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,e)}null===(t=If.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,i,s,o,a,l;const u={localCacheCount:t,existenceFilterCount:n.count},c=n.unchangedNames;return c&&(u.bloomFilter={applied:0===e,hashCount:null!==(r=null==c?void 0:c.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(o=null===(s=null===(i=null==c?void 0:c.bits)||void 0===i?void 0:i.bitmap)||void 0===s?void 0:s.length)&&void 0!==o?o:0,padding:null!==(l=null===(a=null==c?void 0:c.bits)||void 0===a?void 0:a.padding)&&void 0!==l?l:0}),u}(r,i,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:r}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=n;let a,l;try{a=ld(i).toUint8Array()}catch(e){if(e instanceof rd)return ih("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{l=new Rf(a,s,o)}catch(e){return ih(e instanceof $f?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===l.It?1:r!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let r=0;return n.forEach((n=>{const i=this.Gt.ue(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;t.vt(s)||(this.Yt(e,n,null),r++)})),r}ce(e){const t=new Map;this.Qt.forEach(((n,r)=>{const i=this.se(r);if(i){if(n.current&&sp(i.target)){const t=new Rh(i.target.path);null!==this.jt.get(t)||this.ae(r,t)||this.Yt(r,t,_d.newNoDocument(t,e))}n.Mt&&(t.set(r,n.Ot()),n.Ft())}}));let n=Fp();this.zt.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.se(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.jt.forEach(((t,n)=>n.setReadTime(e)));const r=new _f(e,t,this.Wt,this.jt,n);return this.jt=Ep(),this.zt=zf(),this.Wt=new Qh(kh),r}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new Lf,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new ed(kh),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||nh("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new Lf),this.Gt.getRemoteKeysForTarget(e).forEach((t=>{this.Yt(e,t,null)}))}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function zf(){return new Qh(Rh.comparator)}function Bf(){return new Qh(Rh.comparator)}const Uf={asc:"ASCENDING",desc:"DESCENDING"},Wf={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Vf={and:"AND",or:"OR"};class jf{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gf(e,t){return e.useProto3Json||Wh(t)?t:{value:t}}function Hf(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function qf(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Kf(e,t){return Hf(e,t.toTimestamp())}function Xf(e){return ah(!!e),Ch.fromTimestamp(function(e){const t=od(e);return new Ih(t.seconds,t.nanos)}(e))}function Yf(e,t){return function(e){return new Th(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Qf(e){const t=Th.fromString(e);return ah(vm(t)),t}function Jf(e,t){return Yf(e.databaseId,t.path)}function Zf(e,t){const n=Qf(t);if(n.get(1)!==e.databaseId.projectId)throw new ch(uh.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new ch(uh.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Rh(rm(n))}function em(e,t){return Yf(e.databaseId,t)}function tm(e){const t=Qf(e);return 4===t.length?Th.emptyPath():rm(t)}function nm(e){return new Th(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function rm(e){return ah(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function im(e,t,n){return{name:Jf(e,t),fields:n.value.mapValue.fields}}function sm(e,t){let n;if(t instanceof uf)n={update:im(e,t.key,t.value)};else if(t instanceof ff)n={delete:Jf(e,t.key)};else if(t instanceof cf)n={update:im(e,t.key,t.data),updateMask:gm(t.fieldMask)};else{if(!(t instanceof mf))return oh();n={verify:Jf(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Gp)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Hp)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Kp)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Yp)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw oh()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Kf(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:oh()}(e,t.precondition)),n}function om(e,t){return{documents:[em(e,t.path)]}}function am(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=em(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=em(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0!==e.length)return mm(Bd.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:pm(e.field),direction:cm(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=Gf(e,t.limit);var a;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function lm(e){let t=tm(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ah(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=um(e);return t instanceof Bd&&Wd(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new Md(fm(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Wh(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Od(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new Od(n,t)}(n.endAt)),ap(t,i,o,s,a,"F",l,u)}function um(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=fm(e.unaryFilter.field);return zd.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=fm(e.unaryFilter.field);return zd.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=fm(e.unaryFilter.field);return zd.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=fm(e.unaryFilter.field);return zd.create(i,"!=",{nullValue:"NULL_VALUE"});default:return oh()}}(e):void 0!==e.fieldFilter?function(e){return zd.create(fm(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return oh()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Bd.create(e.compositeFilter.filters.map((e=>um(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return oh()}}(e.compositeFilter.op))}(e):oh()}function cm(e){return Uf[e]}function hm(e){return Wf[e]}function dm(e){return Vf[e]}function pm(e){return{fieldPath:e.canonicalString()}}function fm(e){return Ah.fromServerFormat(e.fieldPath)}function mm(e){return e instanceof zd?function(e){if("=="===e.op){if(Ed(e.value))return{unaryFilter:{field:pm(e.field),op:"IS_NAN"}};if(Cd(e.value))return{unaryFilter:{field:pm(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ed(e.value))return{unaryFilter:{field:pm(e.field),op:"IS_NOT_NAN"}};if(Cd(e.value))return{unaryFilter:{field:pm(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pm(e.field),op:hm(e.op),value:e.value}}}(e):e instanceof Bd?function(e){const t=e.getFilters().map((e=>mm(e)));return 1===t.length?t[0]:{compositeFilter:{op:dm(e.op),filters:t}}}(e):oh()}function gm(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function vm(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class ym{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ch.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ch.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:id.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new ym(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ym(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ym(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ym(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class bm{constructor(e){this.fe=e}}function xm(e){const t=lm({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?gp(t,t.limit,"L"):t}class wm{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(ad(e.integerValue));else if("doubleValue"in e){const n=ad(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),Vh(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(ld(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?Ad(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):oh()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const r of Object.keys(n))this.Te(r,t),this.me(n[r],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const r of n)this.me(r,t)}ve(e,t){this.ye(t,37),Rh.fromName(e).path.forEach((e=>{this.ye(t,60),this.be(e,t)}))}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}wm.Ve=new wm;class km{constructor(){this.rn=new Sm}addToCollectionParentIndex(e,t){return this.rn.add(t),zh.resolve()}getCollectionParents(e,t){return zh.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return zh.resolve()}deleteFieldIndex(e,t){return zh.resolve()}getDocumentsMatchingTarget(e,t){return zh.resolve(null)}getIndexType(e,t){return zh.resolve(0)}getFieldIndexes(e,t){return zh.resolve([])}getNextCollectionGroupToUpdate(e){return zh.resolve(null)}getMinOffset(e,t){return zh.resolve(Dh.min())}getMinOffsetFromCollectionGroup(e,t){return zh.resolve(Dh.min())}updateCollectionGroup(e,t,n){return zh.resolve()}updateIndexEntries(e,t){return zh.resolve()}}class Sm{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new ed(Th.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new ed(Th.comparator)).toArray()}}new Uint8Array(0);class Im{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Im(e,Im.DEFAULT_COLLECTION_PERCENTILE,Im.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Im.DEFAULT_COLLECTION_PERCENTILE=10,Im.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Im.DEFAULT=new Im(41943040,Im.DEFAULT_COLLECTION_PERCENTILE,Im.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Im.DISABLED=new Im(-1,0,0);class Cm{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Cm(0)}static Mn(){return new Cm(-1)}}class Em{constructor(){this.changes=new Ip((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,_d.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?zh.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Tm{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Nm{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&of(n.mutation,e,nd.empty(),Ih.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Fp()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fp();const r=Rp();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Np();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Rp();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Fp())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Ep();const s=_p(),o=_p();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof cf)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),of(o.mutation,t,o.mutation.getFieldMask(),Ih.now())):s.set(t.key,nd.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Tm(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=_p();let r=new Qh(((e,t)=>e-t)),i=Fp();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||nd.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Fp()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,u=$p();l.forEach((e=>{if(!i.has(e)){const r=rf(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return zh.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return Rh.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):zh.resolve(Rp());let o=-1,a=i;return s.next((t=>zh.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?zh.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Fp()))).next((e=>({batchId:o,changes:Ap(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Rh(t)).next((e=>{let t=Np();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let i=Np();return this.indexManager.getCollectionParents(e,r).next((s=>zh.forEach(s,(s=>{const o=function(e,t){return new op(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.getDocumentsMatchingCollectionQuery(e,o,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((i=>(r=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)))).next((e=>{r.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,_d.newInvalidDocument(r)))}));let n=Np();return e.forEach(((e,i)=>{const s=r.get(e);void 0!==s&&of(s.mutation,i,nd.empty(),Ih.now()),xp(t,i)&&(n=n.insert(e,i))})),n}))}}class Am{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return zh.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Xf(n.createTime)}),zh.resolve()}getNamedQuery(e,t){return zh.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:xm(e.bundledQuery),readTime:Xf(e.readTime)}}(t)),zh.resolve()}}class Rm{constructor(){this.overlays=new Qh(Rh.comparator),this.ls=new Map}getOverlay(e,t){return zh.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Rp();return zh.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.we(e,t,r)})),zh.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.ls.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.ls.delete(n)),zh.resolve()}getOverlaysForCollection(e,t,n){const r=Rp(),i=t.length+1,s=new Rh(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return zh.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Qh(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Rp(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Rp(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return zh.resolve(o)}we(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new yf(t,n));let i=this.ls.get(t);void 0===i&&(i=Fp(),this.ls.set(t,i)),this.ls.set(t,i.add(n.key))}}class $m{constructor(){this.fs=new ed(_m.ds),this.ws=new ed(_m._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new _m(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.ys(new _m(e,t))}ps(e,t){e.forEach((e=>this.removeReference(e,t)))}Is(e){const t=new Rh(new Th([])),n=new _m(t,e),r=new _m(t,e+1),i=[];return this.ws.forEachInRange([n,r],(e=>{this.ys(e),i.push(e.key)})),i}Ts(){this.fs.forEach((e=>this.ys(e)))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Rh(new Th([])),n=new _m(t,e),r=new _m(t,e+1);let i=Fp();return this.ws.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new _m(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class _m{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Rh.comparator(e.key,t.key)||kh(e.As,t.As)}static _s(e,t){return kh(e.As,t.As)||Rh.comparator(e.key,t.key)}}class Om{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new ed(_m.ds)}checkEmpty(e){return zh.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new gf(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.Rs=this.Rs.add(new _m(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return zh.resolve(s)}lookupMutationBatch(e,t){return zh.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.bs(n),i=r<0?0:r;return zh.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return zh.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return zh.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new _m(t,0),r=new _m(t,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([n,r],(e=>{const t=this.Ps(e.As);i.push(t)})),zh.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ed(kh);return t.forEach((e=>{const t=new _m(e,0),r=new _m(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,r],(e=>{n=n.add(e.As)}))})),zh.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Rh.isDocumentKey(i)||(i=i.child(""));const s=new _m(new Rh(i),0);let o=new ed(kh);return this.Rs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.As)),!0)}),s),zh.resolve(this.Vs(o))}Vs(e){const t=[];return e.forEach((e=>{const n=this.Ps(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){ah(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return zh.forEach(t.mutations,(r=>{const i=new _m(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Rs=n}))}Cn(e){}containsKey(e,t){const n=new _m(t,0),r=this.Rs.firstAfterOrEqual(n);return zh.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,zh.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Dm{constructor(e){this.Ds=e,this.docs=new Qh(Rh.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return zh.resolve(n?n.document.mutableCopy():_d.newInvalidDocument(t))}getEntries(e,t){let n=Ep();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():_d.newInvalidDocument(e))})),zh.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Ep();const s=t.path,o=new Rh(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Fh(Oh(o),n)<=0||(r.has(o.key)||xp(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return zh.resolve(i)}getAllFromCollectionGroup(e,t,n,r){oh()}Cs(e,t){return zh.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Fm(this)}getSize(e){return zh.resolve(this.size)}}class Fm extends Em{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.os.addEntry(e,r)):this.os.removeEntry(n)})),zh.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class Mm{constructor(e){this.persistence=e,this.xs=new Ip((e=>rp(e)),ip),this.lastRemoteSnapshotVersion=Ch.min(),this.highestTargetId=0,this.Ns=0,this.ks=new $m,this.targetCount=0,this.Ms=Cm.kn()}forEachTarget(e,t){return this.xs.forEach(((e,n)=>t(n))),zh.resolve()}getLastRemoteSnapshotVersion(e){return zh.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return zh.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),zh.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),zh.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Cm(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,zh.resolve()}updateTargetData(e,t){return this.Fn(t),zh.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,zh.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.xs.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.xs.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),zh.waitFor(i).next((()=>r))}getTargetCount(e){return zh.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return zh.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),zh.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),zh.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),zh.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return zh.resolve(n)}containsKey(e,t){return zh.resolve(this.ks.containsKey(t))}}class Lm{constructor(e,t){this.$s={},this.overlays={},this.Os=new Uh(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Mm(this),this.indexManager=new km,this.remoteDocumentCache=function(e){return new Dm(e)}((e=>this.referenceDelegate.Ls(e))),this.serializer=new bm(t),this.qs=new Am(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Rm,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new Om(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){nh("MemoryPersistence","Starting transaction:",e);const r=new Pm(this.Os.next());return this.referenceDelegate.Us(),n(r).next((e=>this.referenceDelegate.Ks(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Gs(e,t){return zh.or(Object.values(this.$s).map((n=>()=>n.containsKey(e,t))))}}class Pm extends Lh{constructor(e){super(),this.currentSequenceNumber=e}}class zm{constructor(e){this.persistence=e,this.Qs=new $m,this.js=null}static zs(e){return new zm(e)}get Ws(){if(this.js)return this.js;throw oh()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),zh.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),zh.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),zh.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach((e=>this.Ws.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Ws.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return zh.forEach(this.Ws,(n=>{const r=Rh.fromPath(n);return this.Hs(e,r).next((e=>{e||t.removeEntry(r,Ch.min())}))})).next((()=>(this.js=null,t.apply(e))))}updateLimboDocument(e,t){return this.Hs(e,t).next((e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())}))}Ls(e){return 0}Hs(e,t){return zh.or([()=>zh.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class Bm{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=r}static Li(e,t){let n=Fp(),r=Fp();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Bm(e,t.fromCache,n,r)}}class Um{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ki(e,t).next((i=>i||this.Gi(e,t,r,n))).next((n=>n||this.Qi(e,t)))}Ki(e,t){if(up(t))return zh.resolve(null);let n=fp(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=gp(t,null,"F"),n=fp(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=Fp(...r);return this.Ui.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.ji(t,r);return this.zi(t,s,i,n.readTime)?this.Ki(e,gp(t,null,"F")):this.Wi(e,s,t,n)}))))})))))}Gi(e,t,n,r){return up(t)||r.isEqual(Ch.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next((i=>{const s=this.ji(t,i);return this.zi(t,s,n,r)?this.Qi(e,t):(th()<=nn.DEBUG&&nh("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),bp(t)),this.Wi(e,s,t,_h(r,-1)))}))}ji(e,t){let n=new ed(kp(e));return t.forEach(((t,r)=>{xp(e,r)&&(n=n.add(r))})),n}zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Qi(e,t){return th()<=nn.DEBUG&&nh("QueryEngine","Using full collection scan to execute query:",bp(t)),this.Ui.getDocumentsMatchingQuery(e,t,Dh.min())}Wi(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Wm{constructor(e,t,n,r){this.persistence=e,this.Hi=t,this.serializer=r,this.Ji=new Qh(kh),this.Yi=new Ip((e=>rp(e)),ip),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Nm(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ji)))}}function Vm(e,t,n,r){return new Wm(e,t,n,r)}async function jm(e,t){const n=lh(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.tr(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=Fp();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({er:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function Gm(e){const t=lh(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Bs.getLastRemoteSnapshotVersion(e)))}function Hm(e,t,n){let r=Fp(),i=Fp();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Ep();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Ch.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):nh("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{nr:r,sr:i}}))}function qm(e,t){const n=lh(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Km(e,t){const n=lh(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Bs.getTargetData(e,t).next((i=>i?(r=i,zh.resolve(r)):n.Bs.allocateTargetId(e).next((i=>(r=new ym(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ji.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e}))}async function Xm(e,t,n){const r=lh(e),i=r.Ji.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Bh(e))throw e;nh("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ji=r.Ji.remove(t),r.Yi.delete(i.target)}function Ym(e,t,n){const r=lh(e);let i=Ch.min(),s=Fp();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=lh(e),i=r.Yi.get(n);return void 0!==i?zh.resolve(r.Ji.get(i)):r.Bs.getTargetData(t,n)}(r,e,fp(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.Hi.getDocumentsMatchingQuery(e,t,n?i:Ch.min(),n?s:Fp()))).next((e=>(Qm(r,wp(t),e),{documents:e,ir:s})))))}function Qm(e,t,n){let r=e.Xi.get(t)||Ch.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Xi.set(t,r)}class Jm{constructor(){this.activeTargetIds=Lp()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Zm{constructor(){this.Hr=new Jm,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Jm,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class eg{Yr(e){}shutdown(){}}class tg{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){nh("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){nh("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ng=null;function rg(){return null===ng?ng=268435456+Math.round(2147483648*Math.random()):ng++,"0x"+ng.toString(16)}const ig={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sg{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const og="WebChannelConnection";class ag extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,r,i){const s=rg(),o=this.To(e,t);nh("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={};return this.Eo(a,r,i),this.Ao(e,o,a,n).then((t=>(nh("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw ih("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}vo(e,t,n,r,i,s){return this.Io(e,t,n,r,i)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Zc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}To(e,t){const n=ig[e];return`${this.mo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,r){const i=rg();return new Promise(((s,o)=>{const a=new Kc;a.setWithCredentials(!0),a.listenOnce(Vc.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Wc.NO_ERROR:const t=a.getResponseJson();nh(og,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case Wc.TIMEOUT:nh(og,`RPC '${e}' ${i} timed out`),o(new ch(uh.DEADLINE_EXCEEDED,"Request time out"));break;case Wc.HTTP_ERROR:const n=a.getStatus();if(nh(og,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(uh).indexOf(t)>=0?t:uh.UNKNOWN}(t.status);o(new ch(e,t.message))}else o(new ch(uh.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new ch(uh.UNAVAILABLE,"Connection failed."));break;default:oh()}}finally{nh(og,`RPC '${e}' ${i} completed.`)}}));const l=JSON.stringify(r);nh(og,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",l,n,15)}))}Ro(e,t,n){const r=rg(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Bc(),o=Uc(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.xmlHttpFactory=new Hc({})),this.Eo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=i.join("");nh(og,`Creating RPC '${e}' stream ${r}: ${u}`,a);const c=s.createWebChannel(u,a);let h=!1,d=!1;const p=new sg({ro:t=>{d?nh(og,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(nh(og,`Opening RPC '${e}' stream ${r} transport.`),c.open(),h=!0),nh(og,`RPC '${e}' stream ${r} sending:`,t),c.send(t))},oo:()=>c.close()}),f=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return f(c,qc.EventType.OPEN,(()=>{d||nh(og,`RPC '${e}' stream ${r} transport opened.`)})),f(c,qc.EventType.CLOSE,(()=>{d||(d=!0,nh(og,`RPC '${e}' stream ${r} transport closed`),p.wo())})),f(c,qc.EventType.ERROR,(t=>{d||(d=!0,ih(og,`RPC '${e}' stream ${r} transport errored:`,t),p.wo(new ch(uh.UNAVAILABLE,"The operation could not be completed")))})),f(c,qc.EventType.MESSAGE,(t=>{var n;if(!d){const i=t.data[0];ah(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){nh(og,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=xf[e];if(void 0!==t)return Sf(t)}(t),i=o.message;void 0===n&&(n=uh.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),d=!0,p.wo(new ch(n,i)),c.close()}else nh(og,`RPC '${e}' stream ${r} received:`,i),p._o(i)}})),f(o,jc.STAT_EVENT,(t=>{t.stat===Gc.PROXY?nh(og,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Gc.NOPROXY&&nh(og,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.fo()}),0),p}}function lg(){return"undefined"!=typeof document?document:null}function ug(e){return new jf(e,!0)}class cg{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ii=e,this.timerId=t,this.Po=n,this.bo=r,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),r=Math.max(0,t-n);r>0&&nh("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,(()=>(this.Co=Date.now(),e()))),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class hg{constructor(e,t,n,r,i,s,o,a){this.ii=e,this.$o=n,this.Oo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new cg(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(()=>this.zo())))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===uh.RESOURCE_EXHAUSTED?(rh(t.toString()),rh("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===uh.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.Fo===t&&this.Zo(n,r)}),(t=>{e((()=>{const e=new ch(uh.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)}))}))}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo((()=>{n((()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,(()=>(this.Ko()&&(this.state=3),Promise.resolve()))),this.listener.uo())))})),this.stream.ao((e=>{n((()=>this.tu(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Go(){this.state=5,this.qo.No((async()=>{this.state=0,this.start()}))}tu(e){return nh("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget((()=>this.Fo===e?t():(nh("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dg extends hg{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:oh()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(ah(void 0===t||"string"==typeof t),id.fromBase64String(t||"")):(ah(void 0===t||t instanceof Uint8Array),id.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?uh.UNKNOWN:Sf(e.code);return new ch(t,e.message||"")}(o);n=new Mf(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Zf(e,r.document.name),s=Xf(r.document.updateTime),o=r.document.createTime?Xf(r.document.createTime):Ch.min(),a=new Rd({mapValue:{fields:r.document.fields}}),l=_d.newFoundDocument(i,s,o,a),u=r.targetIds||[],c=r.removedTargetIds||[];n=new Df(u,c,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Zf(e,r.document),s=r.readTime?Xf(r.readTime):Ch.min(),o=_d.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Df([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Zf(e,r.document),s=r.removedTargetIds||[];n=new Df([],s,i,null)}else{if(!("filter"in t))return oh();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new bf(r,i),o=e.targetId;n=new Ff(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ch.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ch.min():t.readTime?Xf(t.readTime):Ch.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=nm(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=sp(r)?{documents:om(e,r)}:{query:am(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=qf(e,t.resumeToken);const r=Gf(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Ch.min())>0){n.readTime=Hf(e,t.snapshotVersion.toTimestamp());const r=Gf(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oh()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=nm(this.serializer),t.removeTarget=e,this.Wo(t)}}class pg extends hg{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(ah(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function(e,t){return e&&e.length>0?(ah(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Xf(e.updateTime):Xf(t);return n.isEqual(Ch.min())&&(n=Xf(t)),new Zp(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Xf(e.commitTime);return this.listener.cu(n,t)}return ah(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=nm(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>sm(this.serializer,e)))};this.Wo(t)}}class fg extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new ch(uh.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((r=>{let[i,s]=r;return this.connection.Io(e,t,n,i,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===uh.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ch(uh.UNKNOWN,e.toString())}))}vo(e,t,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.vo(e,t,n,s,o,r)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===uh.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ch(uh.UNKNOWN,e.toString())}))}terminate(){this.lu=!0}}class mg{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve()))))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(rh(t),this.mu=!1):nh("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class gg{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr((e=>{n.enqueueAndForget((async()=>{Cg(this)&&(nh("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=lh(e);t.vu.add(4),await yg(t),t.bu.set("Unknown"),t.vu.delete(4),await vg(t)}(this))}))})),this.bu=new mg(n,r)}}async function vg(e){if(Cg(e))for(const t of e.Ru)await t(!0)}async function yg(e){for(const t of e.Ru)await t(!1)}function bg(e,t){const n=lh(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),Ig(n)?Sg(n):Vg(n).Ko()&&wg(n,t))}function xg(e,t){const n=lh(e),r=Vg(n);n.Au.delete(t),r.Ko()&&kg(n,t),0===n.Au.size&&(r.Ko()?r.jo():Cg(n)&&n.bu.set("Unknown"))}function wg(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ch.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Vg(e).su(t)}function kg(e,t){e.Vu.qt(t),Vg(e).iu(t)}function Sg(e){e.Vu=new Pf({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),le:t=>e.Au.get(t)||null,ue:()=>e.datastore.serializer.databaseId}),Vg(e).start(),e.bu.gu()}function Ig(e){return Cg(e)&&!Vg(e).Uo()&&e.Au.size>0}function Cg(e){return 0===lh(e).vu.size}function Eg(e){e.Vu=void 0}async function Tg(e){e.Au.forEach(((t,n)=>{wg(e,t)}))}async function Ng(e,t){Eg(e),Ig(e)?(e.bu.Iu(t),Sg(e)):e.bu.set("Unknown")}async function Ag(e,t,n){if(e.bu.set("Online"),t instanceof Mf&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Au.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Au.delete(r),e.Vu.removeTarget(r))}(e,t)}catch(n){nh("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Rg(e,n)}else if(t instanceof Df?e.Vu.Ht(t):t instanceof Ff?e.Vu.ne(t):e.Vu.Xt(t),!n.isEqual(Ch.min()))try{const t=await Gm(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Vu.ce(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Au.get(r);i&&e.Au.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.Au.get(t);if(!r)return;e.Au.set(t,r.withResumeToken(id.EMPTY_BYTE_STRING,r.snapshotVersion)),kg(e,t);const i=new ym(r.target,t,n,r.sequenceNumber);wg(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){nh("RemoteStore","Failed to raise snapshot:",t),await Rg(e,t)}}async function Rg(e,t,n){if(!Bh(t))throw t;e.vu.add(1),await yg(e),e.bu.set("Offline"),n||(n=()=>Gm(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{nh("RemoteStore","Retrying IndexedDB access"),await n(),e.vu.delete(1),await vg(e)}))}function $g(e,t){return t().catch((n=>Rg(e,n,t)))}async function _g(e){const t=lh(e),n=jg(t);let r=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;Og(t);)try{const e=await qm(t.localStore,r);if(null===e){0===t.Eu.length&&n.jo();break}r=e.batchId,Dg(t,e)}catch(e){await Rg(t,e)}Fg(t)&&Mg(t)}function Og(e){return Cg(e)&&e.Eu.length<10}function Dg(e,t){e.Eu.push(t);const n=jg(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function Fg(e){return Cg(e)&&!jg(e).Uo()&&e.Eu.length>0}function Mg(e){jg(e).start()}async function Lg(e){jg(e).hu()}async function Pg(e){const t=jg(e);for(const n of e.Eu)t.uu(n.mutations)}async function zg(e,t,n){const r=e.Eu.shift(),i=vf.from(r,t,n);await $g(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await _g(e)}async function Bg(e,t){t&&jg(e).ou&&await async function(e,t){if(kf(n=t.code)&&n!==uh.ABORTED){const n=e.Eu.shift();jg(e).Qo(),await $g(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await _g(e)}var n}(e,t),Fg(e)&&Mg(e)}async function Ug(e,t){const n=lh(e);n.asyncQueue.verifyOperationInProgress(),nh("RemoteStore","RemoteStore received new credentials");const r=Cg(n);n.vu.add(3),await yg(n),r&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),await vg(n)}async function Wg(e,t){const n=lh(e);t?(n.vu.delete(2),await vg(n)):t||(n.vu.add(2),await yg(n),n.bu.set("Unknown"))}function Vg(e){return e.Su||(e.Su=function(e,t,n){const r=lh(e);return r.fu(),new dg(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:Tg.bind(null,e),ao:Ng.bind(null,e),nu:Ag.bind(null,e)}),e.Ru.push((async t=>{t?(e.Su.Qo(),Ig(e)?Sg(e):e.bu.set("Unknown")):(await e.Su.stop(),Eg(e))}))),e.Su}function jg(e){return e.Du||(e.Du=function(e,t,n){const r=lh(e);return r.fu(),new pg(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:Lg.bind(null,e),ao:Bg.bind(null,e),au:Pg.bind(null,e),cu:zg.bind(null,e)}),e.Ru.push((async t=>{t?(e.Du.Qo(),await _g(e)):(await e.Du.stop(),e.Eu.length>0&&(nh("RemoteStore",`Stopping write stream with ${e.Eu.length} pending writes`),e.Eu=[]))}))),e.Du}class Gg{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new hh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Gg(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ch(uh.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hg(e,t){if(rh("AsyncQueue",`${t}: ${e}`),Bh(e))return new ch(uh.UNAVAILABLE,`${t}: ${e}`);throw e}class qg{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Rh.comparator(t.key,n.key):(e,t)=>Rh.comparator(e.key,t.key),this.keyedMap=Np(),this.sortedSet=new Qh(this.comparator)}static emptySet(e){return new qg(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof qg))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new qg;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Kg{constructor(){this.Cu=new Qh(Rh.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):oh():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Xg{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new Xg(e,t,qg.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Yg{constructor(){this.Nu=void 0,this.listeners=[]}}class Qg{constructor(){this.queries=new Ip((e=>yp(e)),vp),this.onlineState="Unknown",this.ku=new Set}}async function Jg(e,t){const n=lh(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Yg),i)try{s.Nu=await n.onListen(r)}catch(e){const n=Hg(e,`Initialization of query '${bp(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.Mu(n.onlineState),s.Nu&&t.$u(s.Nu)&&nv(n)}async function Zg(e,t){const n=lh(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function ev(e,t){const n=lh(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.$u(i)&&(r=!0);t.Nu=i}}r&&nv(n)}function tv(e,t,n){const r=lh(e),i=r.queries.get(t);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(t)}function nv(e){e.ku.forEach((e=>{e.next()}))}class rv{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Xg(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Uu(e){e=Xg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class iv{constructor(e){this.key=e}}class sv{constructor(e){this.key=e}}class ov{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Fp(),this.mutatedKeys=Fp(),this.tc=kp(e),this.ec=new qg(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new Kg,r=t?t.ec:this.ec;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),c=xp(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let p=!1;u&&c?u.data.isEqual(c.data)?h!==d&&(n.track({type:3,doc:c}),p=!0):this.rc(u,c)||(n.track({type:2,doc:c}),p=!0,(a&&this.tc(c,a)>0||l&&this.tc(c,l)<0)&&(o=!0)):!u&&c?(n.track({type:0,doc:c}),p=!0):u&&!c&&(n.track({type:1,doc:u}),p=!0,(a||l)&&(o=!0)),p&&(c?(s=s.add(c),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{ec:s,ic:n,zi:o,mutatedKeys:i}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const i=e.ic.xu();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oh()}};return n(e)-n(t)}(e.type,t.type)||this.tc(e.doc,t.doc))),this.oc(n);const s=t?this.uc():[],o=0===this.Zu.size&&this.current?1:0,a=o!==this.Xu;return this.Xu=o,0!==i.length||a?{snapshot:new Xg(this.query,e.ec,r,i,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:s}:{cc:s}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Kg,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach((e=>this.Yu=this.Yu.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Yu=this.Yu.delete(e))),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Fp(),this.ec.forEach((e=>{this.ac(e.key)&&(this.Zu=this.Zu.add(e.key))}));const t=[];return e.forEach((e=>{this.Zu.has(e)||t.push(new sv(e))})),this.Zu.forEach((n=>{e.has(n)||t.push(new iv(n))})),t}hc(e){this.Yu=e.ir,this.Zu=Fp();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return Xg.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class av{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class lv{constructor(e){this.key=e,this.fc=!1}}class uv{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.dc={},this.wc=new Ip((e=>yp(e)),vp),this._c=new Map,this.mc=new Set,this.gc=new Qh(Rh.comparator),this.yc=new Map,this.Ic=new $m,this.Tc={},this.Ec=new Map,this.Ac=Cm.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function cv(e,t){const n=Nv(e);let r,i;const s=n.wc.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.lc();else{const e=await Km(n.localStore,fp(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await hv(n,t,r,"current"===s,e.resumeToken),n.isPrimaryClient&&bg(n.remoteStore,e)}return i}async function hv(e,t,n,r,i){e.Rc=(t,n,r)=>async function(e,t,n,r){let i=t.view.sc(n);i.zi&&(i=await Ym(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.sc(n,i)})));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return kv(e,t.targetId,o.cc),o.snapshot}(e,t,n,r);const s=await Ym(e.localStore,t,!0),o=new ov(t,s.ir),a=o.sc(s.documents),l=Of.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,l);kv(e,n,u.cc);const c=new av(t,n,o);return e.wc.set(t,c),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),u.snapshot}async function dv(e,t){const n=lh(e),r=n.wc.get(t),i=n._c.get(r.targetId);if(i.length>1)return n._c.set(r.targetId,i.filter((e=>!vp(e,t)))),void n.wc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Xm(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),xg(n.remoteStore,r.targetId),xv(n,r.targetId)})).catch(Ph)):(xv(n,r.targetId),await Xm(n.localStore,r.targetId,!0))}async function pv(e,t){const n=lh(e);try{const e=await function(e,t){const n=lh(e),r=t.snapshotVersion;let i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Zi.newChangeBuffer({trackRemovals:!0});i=n.Ji;const o=[];t.targetChanges.forEach(((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Bs.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Bs.addMatchingKeys(e,s.addedDocuments,a))));let u=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(id.EMPTY_BYTE_STRING,Ch.min()).withLastLimboFreeSnapshotVersion(Ch.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,u,s)&&o.push(n.Bs.updateTargetData(e,u))}));let a=Ep(),l=Fp();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Hm(e,s,t.documentUpdates).next((e=>{a=e.nr,l=e.sr}))),!r.isEqual(Ch.min())){const t=n.Bs.getLastRemoteSnapshotVersion(e).next((t=>n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return zh.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,l))).next((()=>a))})).then((e=>(n.Ji=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.yc.get(t);r&&(ah(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.fc=!0:e.modifiedDocuments.size>0?ah(r.fc):e.removedDocuments.size>0&&(ah(r.fc),r.fc=!1))})),await Cv(n,e,t)}catch(e){await Ph(e)}}function fv(e,t,n){const r=lh(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.wc.forEach(((n,r)=>{const i=r.view.Mu(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=lh(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.listeners)i.Mu(t)&&(r=!0)})),r&&nv(n)}(r.eventManager,t),e.length&&r.dc.nu(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function mv(e,t,n){const r=lh(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.yc.get(t),s=i&&i.key;if(s){let e=new Qh(Rh.comparator);e=e.insert(s,_d.newNoDocument(s,Ch.min()));const n=Fp().add(s),i=new _f(Ch.min(),new Map,new Qh(kh),e,n);await pv(r,i),r.gc=r.gc.remove(s),r.yc.delete(t),Iv(r)}else await Xm(r.localStore,t,!1).then((()=>xv(r,t,n))).catch(Ph)}async function gv(e,t){const n=lh(e),r=t.batch.batchId;try{const e=await function(e,t){const n=lh(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=zh.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);ah(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Fp();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);bv(n,r,null),yv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Cv(n,e)}catch(e){await Ph(e)}}async function vv(e,t,n){const r=lh(e);try{const e=await function(e,t){const n=lh(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(ah(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);bv(r,t,n),yv(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Cv(r,e)}catch(n){await Ph(n)}}function yv(e,t){(e.Ec.get(t)||[]).forEach((e=>{e.resolve()})),e.Ec.delete(t)}function bv(e,t,n){const r=lh(e);let i=r.Tc[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Tc[r.currentUser.toKey()]=i}}function xv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e._c.get(t))e.wc.delete(r),n&&e.dc.Pc(r,n);e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach((t=>{e.Ic.containsKey(t)||wv(e,t)}))}function wv(e,t){e.mc.delete(t.path.canonicalString());const n=e.gc.get(t);null!==n&&(xg(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),Iv(e))}function kv(e,t,n){for(const r of n)r instanceof iv?(e.Ic.addReference(r.key,t),Sv(e,r)):r instanceof sv?(nh("SyncEngine","Document no longer in limbo: "+r.key),e.Ic.removeReference(r.key,t),e.Ic.containsKey(r.key)||wv(e,r.key)):oh()}function Sv(e,t){const n=t.key,r=n.path.canonicalString();e.gc.get(n)||e.mc.has(r)||(nh("SyncEngine","New document in limbo: "+n),e.mc.add(r),Iv(e))}function Iv(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){const t=e.mc.values().next().value;e.mc.delete(t);const n=new Rh(Th.fromString(t)),r=e.Ac.next();e.yc.set(r,new lv(n)),e.gc=e.gc.insert(n,r),bg(e.remoteStore,new ym(fp(lp(n.path)),r,"TargetPurposeLimboResolution",Uh.ct))}}async function Cv(e,t,n){const r=lh(e),i=[],s=[],o=[];r.wc.isEmpty()||(r.wc.forEach(((e,a)=>{o.push(r.Rc(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=Bm.Li(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.dc.nu(i),await async function(e,t){const n=lh(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>zh.forEach(t,(t=>zh.forEach(t.Fi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>zh.forEach(t.Bi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Bh(e))throw e;nh("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ji.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ji=n.Ji.insert(e,i)}}}(r.localStore,s))}async function Ev(e,t){const n=lh(e);if(!n.currentUser.isEqual(t)){nh("SyncEngine","User change. New user:",t.toKey());const e=await jm(n.localStore,t);n.currentUser=t,function(e){e.Ec.forEach((e=>{e.forEach((e=>{e.reject(new ch(uh.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ec.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Cv(n,e.er)}}function Tv(e,t){const n=lh(e),r=n.yc.get(t);if(r&&r.fc)return Fp().add(r.key);{let e=Fp();const r=n._c.get(t);if(!r)return e;for(const t of r){const r=n.wc.get(t);e=e.unionWith(r.view.nc)}return e}}function Nv(e){const t=lh(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=pv.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Tv.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=mv.bind(null,t),t.dc.nu=ev.bind(null,t.eventManager),t.dc.Pc=tv.bind(null,t.eventManager),t}function Av(e){const t=lh(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=gv.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=vv.bind(null,t),t}class Rv{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=ug(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Vm(this.persistence,new Um,e.initialUser,this.serializer)}createPersistence(e){return new Lm(zm.zs,this.serializer)}createSharedClientState(e){return new Zm}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class $v{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>fv(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ev.bind(null,this.syncEngine),await Wg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Qg}createDatastore(e){const t=ug(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new ag(r));var r;return function(e,t,n,r){return new fg(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>fv(this.syncEngine,e,0),s=tg.D()?new tg:new eg,new gg(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new uv(e,t,n,r,i,s);return o&&(a.vc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=lh(e);nh("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await yg(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}class _v{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):rh("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class Ov{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Jc.UNAUTHENTICATED,this.clientId=wh.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{nh("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(nh("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new ch(uh.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new hh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Hg(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Dv(e,t){e.asyncQueue.verifyOperationInProgress(),nh("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await jm(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Fv(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Lv(e);nh("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>Ug(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Ug(t.remoteStore,n))),e._onlineComponents=t}function Mv(e){return"FirebaseError"===e.name?e.code===uh.FAILED_PRECONDITION||e.code===uh.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function Lv(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){nh("FirestoreClient","Using user provided OfflineComponentProvider");try{await Dv(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!Mv(n))throw n;ih("Error using user provided cache. Falling back to memory cache: "+n),await Dv(e,new Rv)}}else nh("FirestoreClient","Using default OfflineComponentProvider"),await Dv(e,new Rv);return e._offlineComponents}async function Pv(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(nh("FirestoreClient","Using user provided OnlineComponentProvider"),await Fv(e,e._uninitializedComponentsProvider._online)):(nh("FirestoreClient","Using default OnlineComponentProvider"),await Fv(e,new $v))),e._onlineComponents}function zv(e){return Pv(e).then((e=>e.syncEngine))}async function Bv(e){const t=await Pv(e),n=t.eventManager;return n.onListen=cv.bind(null,t.syncEngine),n.onUnlisten=dv.bind(null,t.syncEngine),n}function Uv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new hh;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new _v({next:s=>{t.enqueueAndForget((()=>Zg(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new ch(uh.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new ch(uh.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new rv(lp(n.path),s,{includeMetadataChanges:!0,Ku:!0});return Jg(e,o)}(await Bv(e),e.asyncQueue,t,n,r))),r.promise}function Wv(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Vv=new Map;function jv(e,t,n){if(!n)throw new ch(uh.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Gv(e){if(!Rh.isDocumentKey(e))throw new ch(uh.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Hv(e){if(Rh.isDocumentKey(e))throw new ch(uh.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function qv(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":oh()}function Kv(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ch(uh.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=qv(e);throw new ch(uh.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Xv(e,t){if(t<=0)throw new ch(uh.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class Yv{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new ch(uh.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ch(uh.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new ch(uh.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Wv(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new ch(uh.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new ch(uh.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new ch(uh.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class Qv{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yv({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new ch(uh.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ch(uh.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yv(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ph;switch(e.type){case"firstParty":return new vh(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ch(uh.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Vv.get(e);t&&(nh("ComponentProvider","Removing Datastore"),Vv.delete(e),t.terminate())}(this),Promise.resolve()}}function Jv(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=Kv(e,Qv))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&ih("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Jc.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[At(JSON.stringify({alg:"none",type:"JWT"})),At(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new ch(uh.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Jc(s)}e._authCredentials=new fh(new dh(t,n))}}class Zv{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ty(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zv(this.firestore,e,this._key)}}class ey{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ey(this.firestore,e,this._query)}}class ty extends ey{constructor(e,t,n){super(e,t,lp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zv(this.firestore,null,new Rh(e))}withConverter(e){return new ty(this.firestore,e,this._path)}}function ny(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Yt(e),jv("collection","path",t),e instanceof Qv){const n=Th.fromString(t,...r);return Hv(n),new ty(e,null,n)}{if(!(e instanceof Zv||e instanceof ty))throw new ch(uh.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Th.fromString(t,...r));return Hv(n),new ty(e.firestore,null,n)}}function ry(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Yt(e),1===arguments.length&&(t=wh.A()),jv("doc","path",t),e instanceof Qv){const n=Th.fromString(t,...r);return Gv(n),new Zv(e,null,new Rh(n))}{if(!(e instanceof Zv||e instanceof ty))throw new ch(uh.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Th.fromString(t,...r));return Gv(n),new Zv(e.firestore,e instanceof ty?e.converter:null,new Rh(n))}}class iy{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new cg(this,"async_queue_retry"),this.Xc=()=>{const e=lg();e&&nh("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=lg();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=lg();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise((()=>{}));const t=new hh;return this.ta((()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Qc.push(e),this.ea())))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!Bh(e))throw e;nh("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No((()=>this.ea()))}}ta(e){const t=this.Gc.then((()=>(this.Hc=!0,e().catch((e=>{this.Wc=e,this.Hc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw rh("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Hc=!1,e))))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const r=Gg.createAndSchedule(this,e,t,n,(e=>this.na(e)));return this.zc.push(r),r}Zc(){this.Wc&&oh()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then((()=>{this.zc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()}))}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function sy(e){return function(e){if("object"!=typeof e||null===e)return!1;const t=e;for(const n of["next","error","complete"])if(n in t&&"function"==typeof t[n])return!0;return!1}(e)}class oy extends Qv{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new iy,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ly(this),this._firestoreClient.terminate()}}function ay(e){return e._firestoreClient||ly(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function ly(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new dd(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Wv(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new Ov(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}class uy{constructor(e){this._byteString=e}static fromBase64String(e){try{return new uy(id.fromBase64String(e))}catch(e){throw new ch(uh.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new uy(id.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class cy{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new ch(uh.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ah(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hy{constructor(e){this._methodName=e}}class dy{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ch(uh.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ch(uh.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return kh(this._lat,e._lat)||kh(this._long,e._long)}}const py=/^__.*__$/;class fy{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new cf(e,this.data,this.fieldMask,t,this.fieldTransforms):new uf(e,this.data,t,this.fieldTransforms)}}function my(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oh()}}class gy{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new gy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return Ny(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(my(this.ca)&&py.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class vy{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ug(e)}ya(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new gy({ca:e,methodName:t,ga:n,path:Ah.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yy(e){const t=e._freezeSettings(),n=ug(e._databaseId);return new vy(e._databaseId,!!t.ignoreUndefinedProperties,n)}function by(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.ya(s.merge||s.mergeFields?2:0,t,n,i);Iy("Data must be an object, but it was:",o,r);const a=ky(r,o);let l,u;if(s.merge)l=new nd(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Cy(t,r,n);if(!o.contains(i))throw new ch(uh.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Ay(e,i)||e.push(i)}l=new nd(e),u=o.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,u=o.fieldTransforms;return new fy(new Rd(a),l,u)}function xy(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return wy(n,e.ya(r?4:3,t))}function wy(e,t){if(Sy(e=Yt(e)))return Iy("Unsupported field value:",t,e),ky(e,t);if(e instanceof hy)return function(e,t){if(!my(t.ca))throw t._a(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t._a(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=wy(i,t.wa(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Yt(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Bp(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ih.fromDate(e);return{timestampValue:Hf(t.serializer,n)}}if(e instanceof Ih){const n=new Ih(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Hf(t.serializer,n)}}if(e instanceof dy)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof uy)return{bytesValue:qf(t.serializer,e._byteString)};if(e instanceof Zv){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t._a(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Yf(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a(`Unsupported field value: ${qv(e)}`)}(e,t)}function ky(e,t){const n={};return Yh(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Xh(e,((e,r)=>{const i=wy(r,t.ha(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function Sy(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ih||e instanceof dy||e instanceof uy||e instanceof Zv||e instanceof hy)}function Iy(e,t,n){if(!Sy(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=qv(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}}function Cy(e,t,n){if((t=Yt(t))instanceof cy)return t._internalPath;if("string"==typeof t)return Ty(e,t);throw Ny("Field path arguments must be of type string or ",e,!1,void 0,n)}const Ey=new RegExp("[~\\*/\\[\\]]");function Ty(e,t,n){if(t.search(Ey)>=0)throw Ny(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new cy(...t.split("."))._internalPath}catch(r){throw Ny(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Ny(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ch(uh.INVALID_ARGUMENT,a+e+l)}function Ay(e,t){return e.some((e=>e.isEqual(t)))}class Ry{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Zv(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new $y(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(_y("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class $y extends Ry{data(){return super.data()}}function _y(e,t){return"string"==typeof t?Ty(e,t):t instanceof cy?t._internalPath:t._delegate._internalPath}function Oy(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new ch(uh.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Dy{}class Fy extends Dy{}class My extends Fy{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new My(e,t,n)}_apply(e){const t=this._parse(e);return Wy(e._query,t),new ey(e.firestore,e.converter,mp(e._query,t))}_parse(e){const t=yy(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new ch(uh.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Uy(o,s);const t=[];for(const n of o)t.push(By(r,e,n));a={arrayValue:{values:t}}}else a=By(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Uy(o,s),a=xy(n,"where",o,"in"===s||"not-in"===s);return zd.create(i,s,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class Ly extends Dy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ly(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Bd.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Wy(n,i),n=mp(n,i)}(e._query,t),new ey(e.firestore,e.converter,mp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Py extends Fy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Py(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new ch(uh.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new ch(uh.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Md(t,n);return function(e,t){if(null===cp(e)){const n=hp(e);null!==n&&Vy(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new ey(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new op(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class zy extends Fy{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new zy(e,t,n)}_apply(e){return new ey(e.firestore,e.converter,gp(e._query,this._limit,this._limitType))}}function By(e,t,n){if("string"==typeof(n=Yt(n))){if(""===n)throw new ch(uh.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dp(t)&&-1!==n.indexOf("/"))throw new ch(uh.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Th.fromString(n));if(!Rh.isDocumentKey(r))throw new ch(uh.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return kd(e,new Rh(r))}if(n instanceof Zv)return kd(e,n._key);throw new ch(uh.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${qv(n)}.`)}function Uy(e,t){if(!Array.isArray(e)||0===e.length)throw new ch(uh.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Wy(e,t){if(t.isInequality()){const n=hp(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new ch(uh.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${r.toString()}'`);const i=cp(e);null!==i&&Vy(e,r,i)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new ch(uh.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new ch(uh.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Vy(e,t,n){if(!n.isEqual(t))throw new ch(uh.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class jy{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(md(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ad(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ld(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw oh()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Xh(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new dy(ad(e.latitude),ad(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=cd(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(hd(e));default:return null}}convertTimestamp(e){const t=od(e);return new Ih(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Th.fromString(e);ah(vm(n));const r=new pd(n.get(1),n.get(3)),i=new Rh(n.popFirst(5));return r.isEqual(t)||rh(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Gy(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Hy{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class qy extends Ry{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Ky(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(_y("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Ky extends qy{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Xy{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Hy(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Ky(this._firestore,this._userDataWriter,n.key,n,new Hy(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ch(uh.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Ky(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Hy(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Ky(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Hy(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Yy(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Yy(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oh()}}class Qy extends jy{constructor(e){super(),this.firestore=e}convertBytes(e){return new uy(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Zv(this.firestore,null,t)}}function Jy(e,t,n){e=Kv(e,Zv);const r=Kv(e.firestore,oy),i=Gy(e.converter,t,n);return eb(r,[by(yy(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,ef.none())])}function Zy(e,t){const n=Kv(e.firestore,oy),r=ry(e),i=Gy(e.converter,t);return eb(n,[by(yy(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,ef.exists(!1))]).then((()=>r))}function eb(e,t){return function(e,t){const n=new hh;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Av(e);try{const e=await function(e,t){const n=lh(e),r=Ih.now(),i=t.reduce(((e,t)=>e.add(t.key)),Fp());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Ep(),l=Fp();return n.Zi.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=af(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new cf(e.key,t,$d(t.value.mapValue),ef.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:Ap(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Tc[e.currentUser.toKey()];r||(r=new Qh(kh)),r=r.insert(t,n),e.Tc[e.currentUser.toKey()]=r}(r,e.batchId,n),await Cv(r,e.changes),await _g(r.remoteStore)}catch(e){const t=Hg(e,"Failed to persist write");n.reject(t)}}(await zv(e),t,n))),n.promise}(ay(e),t)}function tb(e,t,n){const r=n.docs.get(t._key),i=new Qy(e);return new qy(e,i,t._key,r,new Hy(n.hasPendingWrites,n.fromCache),t.converter)}!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Zc=e}(ur),sr(new Qt("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new oy(new mh(e.getProvider("auth-internal")),new bh(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ch(uh.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pd(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),dr(Qc,"3.13.0",e),dr(Qc,"3.13.0","esm2017")}();dr("firebase","9.23.0","app");let nb,rb;const ib=new WeakMap,sb=new WeakMap,ob=new WeakMap,ab=new WeakMap,lb=new WeakMap;let ub={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return sb.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ob.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return db(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function cb(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(rb||(rb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(pb(this),n),db(ib.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return db(e.apply(pb(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(pb(this),t,...r);return ob.set(s,t.sort?t.sort():[t]),db(s)}}function hb(e){return"function"===typeof e?cb(e):(e instanceof IDBTransaction&&function(e){if(sb.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));sb.set(e,t)}(e),t=e,(nb||(nb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,ub):e);var t}function db(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(db(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&ib.set(t,e)})).catch((()=>{})),lb.set(t,e),t}(e);if(ab.has(e))return ab.get(e);const t=hb(e);return t!==e&&(ab.set(e,t),lb.set(t,e)),t}const pb=e=>lb.get(e);const fb=["get","getKey","getAll","getAllKeys","count"],mb=["put","add","delete","clear"],gb=new Map;function vb(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(gb.get(t))return gb.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=mb.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!fb.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return gb.set(t,s),s}!function(e){ub=e(ub)}((e=>({...e,get:(t,n,r)=>vb(t,n)||e.get(t,n,r),has:(t,n)=>!!vb(t,n)||e.has(t,n)})));const yb="@firebase/installations",bb="0.6.4",xb=1e4,wb=`w:${bb}`,kb="FIS_v2",Sb=36e5,Ib=new Ut("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Cb(e){return e instanceof Bt&&e.code.includes("request-failed")}function Eb(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function Tb(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Nb(e,t){const n=(await t.json()).error;return Ib.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Ab(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Rb(e,t){let{refreshToken:n}=t;const r=Ab(e);return r.append("Authorization",function(e){return`${kb} ${e}`}(n)),r}async function $b(e){const t=await e();return t.status>=500&&t.status<600?e():t}function _b(e){return new Promise((t=>{setTimeout(t,e)}))}const Ob=/^[cdef][\w-]{21}$/;function Db(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return Ob.test(t)?t:""}catch(e){return""}}function Fb(e){return`${e.appName}!${e.appId}`}const Mb=new Map;function Lb(e,t){const n=Fb(e);Pb(n,t),function(e,t){const n=Bb();n&&n.postMessage({key:e,fid:t});Ub()}(n,t)}function Pb(e,t){const n=Mb.get(e);if(n)for(const r of n)r(t)}let zb=null;function Bb(){return!zb&&"BroadcastChannel"in self&&(zb=new BroadcastChannel("[Firebase] FID Change"),zb.onmessage=e=>{Pb(e.data.key,e.data.fid)}),zb}function Ub(){0===Mb.size&&zb&&(zb.close(),zb=null)}const Wb="firebase-installations-store";let Vb=null;function jb(){return Vb||(Vb=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=db(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(db(o.result),e.oldVersion,e.newVersion,db(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Wb)}})),Vb}async function Gb(e,t){const n=Fb(e),r=(await jb()).transaction(Wb,"readwrite"),i=r.objectStore(Wb),s=await i.get(n);return await i.put(t,n),await r.done,s&&s.fid===t.fid||Lb(e,t.fid),t}async function Hb(e){const t=Fb(e),n=(await jb()).transaction(Wb,"readwrite");await n.objectStore(Wb).delete(t),await n.done}async function qb(e,t){const n=Fb(e),r=(await jb()).transaction(Wb,"readwrite"),i=r.objectStore(Wb),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.done,!o||s&&s.fid===o.fid||Lb(e,o.fid),o}async function Kb(e){let t;const n=await qb(e.appConfig,(n=>{const r=function(e){const t=e||{fid:Db(),registrationStatus:0};return Qb(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Ib.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:i}=t;const s=Eb(n),o=Ab(n),a=r.getImmediate({optional:!0});if(a){const e=await a.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}const l={fid:i,authVersion:kb,appId:n.appId,sdkVersion:wb},u={method:"POST",headers:o,body:JSON.stringify(l)},c=await $b((()=>fetch(s,u)));if(c.ok){const e=await c.json();return{fid:e.fid||i,registrationStatus:2,refreshToken:e.refreshToken,authToken:Tb(e.authToken)}}throw await Nb("Create Installation",c)}(e,t);return Gb(e.appConfig,n)}catch(n){throw Cb(n)&&409===n.customData.serverCode?await Hb(e.appConfig):await Gb(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Xb(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function Xb(e){let t=await Yb(e.appConfig);for(;1===t.registrationStatus;)await _b(100),t=await Yb(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Kb(e);return n||t}return t}function Yb(e){return qb(e,(e=>{if(!e)throw Ib.create("installation-not-found");return Qb(e)}))}function Qb(e){return 1===(t=e).registrationStatus&&t.registrationTime+xb<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Jb(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const i=function(e,t){let{fid:n}=t;return`${Eb(e)}/${n}/authTokens:generate`}(n,t),s=Rb(n,t),o=r.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const a={installation:{sdkVersion:wb,appId:n.appId}},l={method:"POST",headers:s,body:JSON.stringify(a)},u=await $b((()=>fetch(i,l)));if(u.ok){return Tb(await u.json())}throw await Nb("Generate Auth Token",u)}async function Zb(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await qb(e.appConfig,(r=>{if(!tx(r))throw Ib.create("not-registered");const i=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Sb}(e)}(i))return r;if(1===i.requestStatus)return t=async function(e,t){let n=await ex(e.appConfig);for(;1===n.authToken.requestStatus;)await _b(100),n=await ex(e.appConfig);const r=n.authToken;return 0===r.requestStatus?Zb(e,t):r}(e,n),r;{if(!navigator.onLine)throw Ib.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await Jb(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await Gb(e.appConfig,r),n}catch(n){if(!Cb(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Gb(e.appConfig,n)}else await Hb(e.appConfig);throw n}}(e,n),n}}));return t?await t:r.authToken}function ex(e){return qb(e,(e=>{if(!tx(e))throw Ib.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+xb<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function tx(e){return void 0!==e&&2===e.registrationStatus}async function nx(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await Kb(e);t&&await t}(n);return(await Zb(n,t)).token}function rx(e){return Ib.create("missing-app-config-values",{valueName:e})}const ix="installations",sx=e=>{const t=or(e.getProvider("app").getImmediate(),ix).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Kb(t);return r?r.catch(console.error):Zb(t).catch(console.error),n.fid}(t),getToken:e=>nx(t,e)}};sr(new Qt(ix,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw rx("App Configuration");if(!e.name)throw rx("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw rx(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:or(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),sr(new Qt("installations-internal",sx,"PRIVATE")),dr(yb,bb),dr(yb,bb,"esm2017");let ox,ax;const lx=new WeakMap,ux=new WeakMap,cx=new WeakMap,hx=new WeakMap,dx=new WeakMap;let px={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ux.get(e);if("objectStoreNames"===t)return e.objectStoreNames||cx.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return gx(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function fx(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ax||(ax=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(vx(this),n),gx(lx.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return gx(e.apply(vx(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(vx(this),t,...r);return cx.set(s,t.sort?t.sort():[t]),gx(s)}}function mx(e){return"function"===typeof e?fx(e):(e instanceof IDBTransaction&&function(e){if(ux.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));ux.set(e,t)}(e),t=e,(ox||(ox=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,px):e);var t}function gx(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(gx(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&lx.set(t,e)})).catch((()=>{})),dx.set(t,e),t}(e);if(hx.has(e))return hx.get(e);const t=mx(e);return t!==e&&(hx.set(e,t),dx.set(t,e)),t}const vx=e=>dx.get(e);function yx(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=gx(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(gx(o.result),e.oldVersion,e.newVersion,gx(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}function bx(e){let{blocked:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(()=>t())),gx(n).then((()=>{}))}const xx=["get","getKey","getAll","getAllKeys","count"],wx=["put","add","delete","clear"],kx=new Map;function Sx(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(kx.get(t))return kx.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=wx.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!xx.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return kx.set(t,s),s}!function(e){px=e(px)}((e=>({...e,get:(t,n,r)=>Sx(t,n)||e.get(t,n,r),has:(t,n)=>!!Sx(t,n)||e.has(t,n)})));const Ix="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Cx="google.c.a.c_id";var Ex,Tx,Nx;function Ax(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Rx(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}(Tx=Ex||(Ex={}))[Tx.DATA_MESSAGE=1]="DATA_MESSAGE",Tx[Tx.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION",function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(Nx||(Nx={}));const $x="fcm_token_details_db",_x="fcm_token_object_Store";const Ox="firebase-messaging-store";let Dx=null;function Fx(){return Dx||(Dx=yx("firebase-messaging-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Ox)}})),Dx}async function Mx(e){const t=Px(e),n=await Fx(),r=await n.transaction(Ox).objectStore(Ox).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map((e=>e.name));if(!e.includes($x))return null}let t=null;return(await yx($x,5,{upgrade:async(n,r,i,s)=>{var o;if(r<2)return;if(!n.objectStoreNames.contains(_x))return;const a=s.objectStore(_x),l=await a.index("fcmSenderId").get(e);if(await a.clear(),l)if(2===r){const e=l;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(o=e.createTime)&&void 0!==o?o:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"===typeof e.vapidKey?e.vapidKey:Ax(e.vapidKey)}}}else if(3===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:Ax(e.auth),p256dh:Ax(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:Ax(e.vapidKey)}}}else if(4===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:Ax(e.auth),p256dh:Ax(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:Ax(e.vapidKey)}}}}})).close(),await bx($x),await bx("fcm_vapid_details_db"),await bx("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"===typeof e.createTime&&e.createTime>0&&"string"===typeof e.token&&e.token.length>0&&"string"===typeof t.auth&&t.auth.length>0&&"string"===typeof t.p256dh&&t.p256dh.length>0&&"string"===typeof t.endpoint&&t.endpoint.length>0&&"string"===typeof t.swScope&&t.swScope.length>0&&"string"===typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await Lx(e,t),t}}async function Lx(e,t){const n=Px(e),r=(await Fx()).transaction(Ox,"readwrite");return await r.objectStore(Ox).put(t,n),await r.done,t}function Px(e){let{appConfig:t}=e;return t.appId}const zx=new Ut("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});async function Bx(e,t){const n={method:"DELETE",headers:await Wx(e)};try{const r=await fetch(`${Ux(e.appConfig)}/${t}`,n),i=await r.json();if(i.error){const e=i.error.message;throw zx.create("token-unsubscribe-failed",{errorInfo:e})}}catch(r){throw zx.create("token-unsubscribe-failed",{errorInfo:null===r||void 0===r?void 0:r.toString()})}}function Ux(e){let{projectId:t}=e;return`https://fcmregistrations.googleapis.com/v1/projects/${t}/registrations`}async function Wx(e){let{appConfig:t,installations:n}=e;const r=await n.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${r}`})}function Vx(e){let{p256dh:t,auth:n,endpoint:r,vapidKey:i}=e;const s={web:{endpoint:r,auth:n,p256dh:t}};return i!==Ix&&(s.web.applicationPubKey=i),s}async function jx(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Rx(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:Ax(t.getKey("auth")),p256dh:Ax(t.getKey("p256dh"))},r=await Mx(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,s=t.p256dh===e.p256dh;return n&&r&&i&&s}(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await Wx(e),r=Vx(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch(`${Ux(e.appConfig)}/${t.token}`,i);s=await n.json()}catch(o){throw zx.create("token-update-failed",{errorInfo:null===o||void 0===o?void 0:o.toString()})}if(s.error){const e=s.error.message;throw zx.create("token-update-failed",{errorInfo:e})}if(!s.token)throw zx.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await Lx(e.firebaseDependencies,r),n}catch(n){throw await Gx(e),n}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await Bx(e.firebaseDependencies,r.token)}catch(i){console.warn(i)}return Hx(e.firebaseDependencies,n)}return Hx(e.firebaseDependencies,n)}async function Gx(e){const t=await Mx(e.firebaseDependencies);t&&(await Bx(e.firebaseDependencies,t.token),await async function(e){const t=Px(e),n=(await Fx()).transaction(Ox,"readwrite");await n.objectStore(Ox).delete(t),await n.done}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function Hx(e,t){const n=await async function(e,t){const n=await Wx(e),r=Vx(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(Ux(e.appConfig),i);s=await t.json()}catch(o){throw zx.create("token-subscribe-failed",{errorInfo:null===o||void 0===o?void 0:o.toString()})}if(s.error){const e=s.error.message;throw zx.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw zx.create("token-subscribe-no-token");return s.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await Lx(e,r),r.token}function qx(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i);const s=t.notification.icon;s&&(e.notification.icon=s)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,i,s,o;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const a=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(s=t.notification)||void 0===s?void 0:s.click_action;a&&(e.fcmOptions.link=a);const l=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;l&&(e.fcmOptions.analyticsLabel=l)}(t,e),t}function Kx(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function Xx(e){return zx.create("missing-app-config-values",{valueName:e})}Kx("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Kx("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Yx{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw Xx("App Configuration Object");if(!e.name)throw Xx("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const r of t)if(!n[r])throw Xx(r);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}async function Qx(e){try{e.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),e.swRegistration.update().catch((()=>{}))}catch(t){throw zx.create("failed-service-worker-registration",{browserErrorMessage:null===t||void 0===t?void 0:t.message})}}async function Jx(e,t){if(!navigator)throw zx.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw zx.create("permission-blocked");return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=Ix)}(e,null===t||void 0===t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await Qx(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw zx.create("invalid-sw-registration");e.swRegistration=t}}(e,null===t||void 0===t?void 0:t.serviceWorkerRegistration),jx(e)}async function Zx(e,t,n){const r=function(e){switch(e){case Nx.NOTIFICATION_CLICKED:return"notification_open";case Nx.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[Cx],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function ew(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===Nx.PUSH_RECEIVED&&("function"===typeof e.onMessageHandler?e.onMessageHandler(qx(n)):e.onMessageHandler.next(qx(n)));const r=n.data;var i;"object"===typeof(i=r)&&i&&Cx in i&&"1"===r["google.c.a.e"]&&await Zx(e,n.messageType,r)}const tw="@firebase/messaging",nw="0.12.4",rw=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>Jx(t,e)}};async function iw(){try{await zt()}catch(e){return!1}return"undefined"!==typeof window&&Pt()&&!("undefined"===typeof navigator||!navigator.cookieEnabled)&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}sr(new Qt("messaging",(e=>{const t=new Yx(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",(e=>ew(t,e))),t}),"PUBLIC")),sr(new Qt("messaging-internal",rw,"PRIVATE")),dr(tw,nw),dr(tw,nw,"esm2017");const sw=cr({apiKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_API_KEY,authDomain:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_AUTH_DOMAIN,projectId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_PROJECT_ID,storageBucket:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_STORAGE_BUCKET,messagingSenderId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,appId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_APP_ID}),ow=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hr();const t=or(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=or(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Vt(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Ar(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Io,persistence:[Ms,bs,ws]}),r=Ft("authTokenSyncURL");if(r){const e=(i=r,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>No)return;const r=null===t||void 0===t?void 0:t.token;Ao!==r&&(Ao=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){Yt(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(e,t,n,r){Yt(e).onIdTokenChanged(t,n,r)}(n,(t=>e(t)))}var i;const s=Ot("auth");return s&&Li(n,`http://${s}`),n}(sw),aw=function(e,t){const n="string"==typeof e?e:t||"(default)",r=or("object"==typeof e?e:hr(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(e=>{const t=Ot(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&Jv(r,...e)}return r}(sw),lw=async()=>{try{return await iw()?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hr();return iw().then((e=>{if(!e)throw zx.create("unsupported-browser")}),(e=>{throw zx.create("indexed-db-unsupported")})),or(Yt(e),"messaging").getImmediate()}(sw):(console.log("Firebase Cloud Messaging is not supported in this environment"),null)}catch(e){return console.error("Error initializing Firebase Cloud Messaging:",e),null}},uw=(0,a.createContext)();function cw(){return(0,a.useContext)(uw)}function hw(e){let{children:t}=e;const[n,r]=(0,a.useState)(null),[i,s]=(0,a.useState)(null),[o,l]=(0,a.useState)(!0);async function u(e){try{const t=ry(aw,"users",e),n=await function(e){e=Kv(e,Zv);const t=Kv(e.firestore,oy);return Uv(ay(t),e._key).then((n=>tb(t,e,n)))}(t);return n.exists()?{id:n.id,...n.data()}:(console.error("No user profile found"),null)}catch(t){return console.error("Error fetching user profile:",t),null}}(0,a.useEffect)((()=>{var e,t,n;return e=async e=>{if(r(e),e){const t=await u(e.uid);s(t)}else s(null);l(!1)},Yt(ow).onAuthStateChanged(e,t,n)}),[]);const c={currentUser:n,userProfile:i,loading:o,signup:async function(e,t,n,r,i){try{const s=await async function(e,t,n){var r;const i=Fi(e),s={returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"};let o;if(null===(r=i._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){const e=await _i(i,s,"signUpPassword");o=is(i,e)}else o=is(i,s).catch((async e=>{if("auth/missing-recaptcha-token"===e.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const e=await _i(i,s,"signUpPassword");return is(i,e)}return Promise.reject(e)}));const a=await o.catch((e=>Promise.reject(e))),l=await ss._fromIdTokenResponse(i,"signIn",a);return await i._updateCurrentUser(l.user),l}(ow,e,t),o=s.user;return await fs(o,{displayName:`${n} ${r}`}),await Jy(ry(aw,"users",o.uid),{firstName:n,lastName:r,email:e,role:i||"primary_caregiver",createdAt:new Date,settings:{alertSensitivity:"medium",notificationPreferences:{email:!0,push:!0,sms:!1}}}),o}catch(s){throw s}},login:function(e,t){return function(e,t,n){return ds(Yt(e),Qi.credential(t,n))}(ow,e,t)},logout:function(){return Yt(ow).signOut()},resetPassword:function(e){return async function(e,t,n){var r;const i=Fi(e),s={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};if(null===(r=i._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){const e=await _i(i,s,"getOobCode",!0);n&&ps(i,e,n),await ji(i,e)}else n&&ps(i,s,n),await ji(i,s).catch((async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const e=await _i(i,s,"getOobCode",!0);n&&ps(i,e,n),await ji(i,e)}}))}(ow,e)},updateUserEmail:function(e){return t=e,ms(Yt(n),t,null);var t},updateUserPassword:function(e){return t=e,ms(Yt(n),null,t);var t},updateUserProfile:async function(e){if(n)try{await Jy(ry(aw,"users",n.uid),e,{merge:!0});const t=await u(n.uid);return s(t),t}catch(t){throw t}}};return(0,Me.jsx)(uw.Provider,{value:c,children:t})}function dw(e){let{children:t}=e;const{currentUser:n,loading:r}=cw();return r?(0,Me.jsx)("div",{children:"Loading..."}):n?t:(0,Me.jsx)(be,{to:"/login"})}var pw=n(7950),fw=n.t(pw,2);function mw(){return mw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mw.apply(this,arguments)}function gw(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const vw=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(dae){}new Map;const yw=l.startTransition;fw.flushSync,l.useId;function bw(e){let{basename:t,children:n,future:r,window:i}=e,s=a.useRef();var o;null==s.current&&(s.current=(void 0===(o={window:i,v5Compat:!0})&&(o={}),y((function(e,t){let{pathname:n,search:r,hash:i}=e.location;return m("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:g(t)}),null,o)));let l=s.current,[u,c]=a.useState({action:l.action,location:l.location}),{v7_startTransition:h}=r||{},d=a.useCallback((e=>{h&&yw?yw((()=>c(e))):c(e)}),[c,h]);return a.useLayoutEffect((()=>l.listen(d)),[l,d]),a.useEffect((()=>ye(r)),[r]),a.createElement(we,{basename:t,children:n,location:u.location,navigationType:u.action,navigator:l,future:r})}const xw="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,ww=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kw=a.forwardRef((function(e,t){let n,{onClick:r,relative:i,reloadDocument:s,replace:o,state:l,target:u,to:c,preventScrollReset:h,viewTransition:p}=e,f=gw(e,vw),{basename:m}=a.useContext(Q),v=!1;if("string"===typeof c&&ww.test(c)&&(n=c,xw))try{let e=new URL(window.location.href),t=c.startsWith("//")?new URL(e.protocol+c):new URL(c),n=M(t.pathname,m);t.origin===e.origin&&null!=n?c=n+t.search+t.hash:v=!0}catch(dae){}let y=function(e,t){let{relative:n}=void 0===t?{}:t;te()||d(!1);let{basename:r,navigator:i}=a.useContext(Q),{hash:s,pathname:o,search:l}=se(e,{relative:n}),u=o;return"/"!==r&&(u="/"===o?r:U([r,o])),i.createHref({pathname:u,search:l,hash:s})}(c,{relative:i}),b=function(e,t){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:l}=void 0===t?{}:t,u=ie(),c=ne(),h=se(e,{relative:o});return a.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:g(c)===g(h);u(e,{replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:l})}}),[c,u,h,r,i,n,e,s,o,l])}(c,{replace:o,state:l,target:u,preventScrollReset:h,relative:i,viewTransition:p});return a.createElement("a",mw({},f,{href:n||y,onClick:v||s?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:t,target:u}))}));var Sw,Iw,Cw,Ew;(Iw=Sw||(Sw={})).UseScrollRestoration="useScrollRestoration",Iw.UseSubmit="useSubmit",Iw.UseSubmitFetcher="useSubmitFetcher",Iw.UseFetcher="useFetcher",Iw.useViewTransitionState="useViewTransitionState",(Ew=Cw||(Cw={})).UseFetcher="useFetcher",Ew.UseFetchers="useFetchers",Ew.UseScrollRestoration="useScrollRestoration";function Tw(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const r={};return Object.keys(e).forEach((i=>{r[i]=e[i].reduce(((e,r)=>{if(r){const i=t(r);""!==i&&e.push(i),n&&n[r]&&e.push(n[r])}return e}),[]).join(" ")})),r}var Nw=n(7598);function Aw(e,t){const n=(0,Ie.A)({},t);return Object.keys(e).forEach((r=>{if(r.toString().match(/^(components|slots)$/))n[r]=(0,Ie.A)({},e[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const i=e[r]||{},s=t[r];n[r]={},s&&Object.keys(s)?i&&Object.keys(i)?(n[r]=(0,Ie.A)({},s),Object.keys(i).forEach((e=>{n[r][e]=Aw(i[e],s[e])}))):n[r]=s:n[r]=i}else void 0===n[r]&&(n[r]=e[r])})),n}function Rw(e){let{props:t,name:n,defaultTheme:r,themeId:i}=e,s=Fe(r);i&&(s=s[i]||s);const o=function(e){const{theme:t,name:n,props:r}=e;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?Aw(t.components[n].defaultProps,r):r}({theme:s,name:n,props:t});return o}const $w=["ownerState"],_w=["variants"],Ow=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Dw(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const Fw=(0,$e.A)(),Mw=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function Lw(e){let{defaultTheme:t,theme:n,themeId:r}=e;return i=n,0===Object.keys(i).length?t:n[r]||n;var i}function Pw(e){return e?(t,n)=>n[e]:null}function zw(e,t){let{ownerState:n}=t,r=(0,Ce.A)(t,$w);const i="function"===typeof e?e((0,Ie.A)({ownerState:n},r)):e;if(Array.isArray(i))return i.flatMap((e=>zw(e,(0,Ie.A)({ownerState:n},r))));if(i&&"object"===typeof i&&Array.isArray(i.variants)){const{variants:e=[]}=i;let t=(0,Ce.A)(i,_w);return e.forEach((e=>{let i=!0;"function"===typeof e.props?i=e.props((0,Ie.A)({ownerState:n},r,n)):Object.keys(e.props).forEach((t=>{(null==n?void 0:n[t])!==e.props[t]&&r[t]!==e.props[t]&&(i=!1)})),i&&(Array.isArray(t)||(t=[t]),t.push("function"===typeof e.style?e.style((0,Ie.A)({ownerState:n},r,n)):e.style))})),t}return i}const Bw=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=Fw,rootShouldForwardProp:r=Dw,slotShouldForwardProp:i=Dw}=e,s=e=>(0,Ae.A)((0,Ie.A)({},e,{theme:Lw((0,Ie.A)({},e,{defaultTheme:n,themeId:t}))}));return s.__mui_systemSx=!0,function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Ne.internal_processStyles)(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:a,slot:l,skipVariantsResolver:u,skipSx:c,overridesResolver:h=Pw(Mw(l))}=o,d=(0,Ce.A)(o,Ow),p=void 0!==u?u:l&&"Root"!==l&&"root"!==l||!1,f=c||!1;let m=Dw;"Root"===l||"root"===l?m=r:l?m=i:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(m=void 0);const g=(0,Ne.default)(e,(0,Ie.A)({shouldForwardProp:m,label:undefined},d)),v=e=>"function"===typeof e&&e.__emotion_real!==e||(0,Ue.Q)(e)?r=>zw(e,(0,Ie.A)({},r,{theme:Lw({theme:r.theme,defaultTheme:n,themeId:t})})):e,y=function(r){let i=v(r);for(var o=arguments.length,l=new Array(o>1?o-1:0),u=1;u<o;u++)l[u-1]=arguments[u];const c=l?l.map(v):[];a&&h&&c.push((e=>{const r=Lw((0,Ie.A)({},e,{defaultTheme:n,themeId:t}));if(!r.components||!r.components[a]||!r.components[a].styleOverrides)return null;const i=r.components[a].styleOverrides,s={};return Object.entries(i).forEach((t=>{let[n,i]=t;s[n]=zw(i,(0,Ie.A)({},e,{theme:r}))})),h(e,s)})),a&&!p&&c.push((e=>{var r;const i=Lw((0,Ie.A)({},e,{defaultTheme:n,themeId:t}));return zw({variants:null==i||null==(r=i.components)||null==(r=r[a])?void 0:r.variants},(0,Ie.A)({},e,{theme:i}))})),f||c.push(s);const d=c.length-l.length;if(Array.isArray(r)&&d>0){const e=new Array(d).fill("");i=[...r,...e],i.raw=[...r.raw,...e]}const m=g(i,...c);return e.muiName&&(m.muiName=e.muiName),m};return g.withConfig&&(y.withConfig=g.withConfig),y}}(),Uw=["className","component","disableGutters","fixed","maxWidth","classes"],Ww=(0,$e.A)(),Vw=Bw("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`maxWidth${(0,Nw.A)(String(n.maxWidth))}`],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),jw=e=>Rw({props:e,name:"MuiContainer",defaultTheme:Ww});const Gw=Nw.A;var Hw=n(8052);const qw=yt();const Kw=function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e},Xw=e=>Kw(e)&&"classes"!==e,Yw=(0,Hw.Ay)({themeId:bt,defaultTheme:qw,rootShouldForwardProp:Xw}),Qw=a.createContext(void 0);function Jw(e){let{props:t,name:n}=e;return function(e){const{theme:t,name:n,props:r}=e;if(!t||!t.components||!t.components[n])return r;const i=t.components[n];return i.defaultProps?Aw(i.defaultProps,r):i.styleOverrides||i.variants?r:Aw(i,r)}({props:t,name:n,theme:{components:a.useContext(Qw)}})}const Zw=function(e){let{value:t,children:n}=e;return(0,Me.jsx)(Qw.Provider,{value:t,children:n})};function ek(e){return Jw(e)}const tk=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:t=Vw,useThemeProps:n=jw,componentName:r="MuiContainer"}=e,i=t((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!n.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}})}),(e=>{let{theme:t,ownerState:n}=e;return n.fixed&&Object.keys(t.breakpoints.values).reduce(((e,n)=>{const r=n,i=t.breakpoints.values[r];return 0!==i&&(e[t.breakpoints.up(r)]={maxWidth:`${i}${t.breakpoints.unit}`}),e}),{})}),(e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({},"xs"===n.maxWidth&&{[t.breakpoints.up("xs")]:{maxWidth:Math.max(t.breakpoints.values.xs,444)}},n.maxWidth&&"xs"!==n.maxWidth&&{[t.breakpoints.up(n.maxWidth)]:{maxWidth:`${t.breakpoints.values[n.maxWidth]}${t.breakpoints.unit}`}})}));return a.forwardRef((function(e,t){const s=n(e),{className:o,component:a="div",disableGutters:l=!1,fixed:u=!1,maxWidth:c="lg"}=s,h=(0,Ce.A)(s,Uw),d=(0,Ie.A)({},s,{component:a,disableGutters:l,fixed:u,maxWidth:c}),p=((e,t)=>{const{classes:n,fixed:r,disableGutters:i,maxWidth:s}=e;return Tw({root:["root",s&&`maxWidth${(0,Nw.A)(String(s))}`,r&&"fixed",i&&"disableGutters"]},(e=>wt(t,e)),n)})(d,r);return(0,Me.jsx)(i,(0,Ie.A)({as:a,ownerState:d,className:Te(p.root,o),ref:t},h))}))}({createStyledComponent:Yw("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`maxWidth${Gw(String(n.maxWidth))}`],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),useThemeProps:e=>ek({props:e,name:"MuiContainer"})});function nk(e){return wt("MuiTypography",e)}kt("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const rk=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],ik=Yw("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],"inherit"!==n.align&&t[`align${Gw(n.align)}`],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({margin:0},"inherit"===n.variant&&{font:"inherit"},"inherit"!==n.variant&&t.typography[n.variant],"inherit"!==n.align&&{textAlign:n.align},n.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.gutterBottom&&{marginBottom:"0.35em"},n.paragraph&&{marginBottom:16})})),sk={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},ok={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},ak=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiTypography"}),r=(e=>ok[e]||e)(n.color),i=(0,Re.A)((0,Ie.A)({},n,{color:r})),{align:s="inherit",className:o,component:a,gutterBottom:l=!1,noWrap:u=!1,paragraph:c=!1,variant:h="body1",variantMapping:d=sk}=i,p=(0,Ce.A)(i,rk),f=(0,Ie.A)({},i,{align:s,color:r,className:o,component:a,gutterBottom:l,noWrap:u,paragraph:c,variant:h,variantMapping:d}),m=a||(c?"p":d[h]||sk[h])||"span",g=(e=>{const{align:t,gutterBottom:n,noWrap:r,paragraph:i,variant:s,classes:o}=e;return Tw({root:["root",s,"inherit"!==e.align&&`align${Gw(t)}`,n&&"gutterBottom",r&&"noWrap",i&&"paragraph"]},nk,o)})(f);return(0,Me.jsx)(ik,(0,Ie.A)({as:m,ref:t,ownerState:f,className:Te(g.root,o)},p))})),lk=ak,uk=e=>{let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,(t/100).toFixed(2)};function ck(e){return wt("MuiPaper",e)}kt("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const hk=["className","component","elevation","square","variant"],dk=Yw("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],!n.square&&t.rounded,"elevation"===n.variant&&t[`elevation${n.elevation}`]]}})((e=>{let{theme:t,ownerState:n}=e;var r;return(0,Ie.A)({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!n.square&&{borderRadius:t.shape.borderRadius},"outlined"===n.variant&&{border:`1px solid ${(t.vars||t).palette.divider}`},"elevation"===n.variant&&(0,Ie.A)({boxShadow:(t.vars||t).shadows[n.elevation]},!t.vars&&"dark"===t.palette.mode&&{backgroundImage:`linear-gradient(${(0,Ve.X4)("#fff",uk(n.elevation))}, ${(0,Ve.X4)("#fff",uk(n.elevation))})`},t.vars&&{backgroundImage:null==(r=t.vars.overlays)?void 0:r[n.elevation]}))})),pk=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiPaper"}),{className:r,component:i="div",elevation:s=1,square:o=!1,variant:a="elevation"}=n,l=(0,Ce.A)(n,hk),u=(0,Ie.A)({},n,{component:i,elevation:s,square:o,variant:a}),c=(e=>{const{square:t,elevation:n,variant:r,classes:i}=e;return Tw({root:["root",r,!t&&"rounded","elevation"===r&&`elevation${n}`]},ck,i)})(u);return(0,Me.jsx)(dk,(0,Ie.A)({as:i,ownerState:u,className:Te(c.root,r),ref:t},l))})),fk=pk;function mk(e){return wt("MuiCard",e)}kt("MuiCard",["root"]);const gk=["className","raised"],vk=Yw(fk,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),yk=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiCard"}),{className:r,raised:i=!1}=n,s=(0,Ce.A)(n,gk),o=(0,Ie.A)({},n,{raised:i}),a=(e=>{const{classes:t}=e;return Tw({root:["root"]},mk,t)})(o);return(0,Me.jsx)(vk,(0,Ie.A)({className:Te(a.root,r),elevation:i?8:void 0,ref:t,ownerState:o},s))}));function bk(e){return wt("MuiCardContent",e)}kt("MuiCardContent",["root"]);const xk=["className","component"],wk=Yw("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),kk=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiCardContent"}),{className:r,component:i="div"}=n,s=(0,Ce.A)(n,xk),o=(0,Ie.A)({},n,{component:i}),a=(e=>{const{classes:t}=e;return Tw({root:["root"]},bk,t)})(o);return(0,Me.jsx)(wk,(0,Ie.A)({as:i,className:Te(a.root,r),ownerState:o,ref:t},s))}));function Sk(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function Ik(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.useMemo((()=>t.every((e=>null==e))?null:e=>{t.forEach((t=>{Sk(t,e)}))}),t)}const Ck=function(e){return"string"===typeof e};const Ek=function(e,t,n){return void 0===e||Ck(e)?t:(0,Ie.A)({},t,{ownerState:(0,Ie.A)({},t.ownerState,n)})};const Tk=function(e,t,n){return"function"===typeof e?e(t,n):e};const Nk=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const n={};return Object.keys(e).filter((n=>n.match(/^on[A-Z]/)&&"function"===typeof e[n]&&!t.includes(n))).forEach((t=>{n[t]=e[t]})),n};const Ak=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t]))).forEach((n=>{t[n]=e[n]})),t};const Rk=function(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:s}=e;if(!t){const e=Te(null==n?void 0:n.className,s,null==i?void 0:i.className,null==r?void 0:r.className),t=(0,Ie.A)({},null==n?void 0:n.style,null==i?void 0:i.style,null==r?void 0:r.style),o=(0,Ie.A)({},n,i,r);return e.length>0&&(o.className=e),Object.keys(t).length>0&&(o.style=t),{props:o,internalRef:void 0}}const o=Nk((0,Ie.A)({},i,r)),a=Ak(r),l=Ak(i),u=t(o),c=Te(null==u?void 0:u.className,null==n?void 0:n.className,s,null==i?void 0:i.className,null==r?void 0:r.className),h=(0,Ie.A)({},null==u?void 0:u.style,null==n?void 0:n.style,null==i?void 0:i.style,null==r?void 0:r.style),d=(0,Ie.A)({},u,n,l,a);return c.length>0&&(d.className=c),Object.keys(h).length>0&&(d.style=h),{props:d,internalRef:u.ref}},$k=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],_k=["component","slots","slotProps"],Ok=["component"];function Dk(e,t){const{className:n,elementType:r,ownerState:i,externalForwardedProps:s,getSlotOwnerState:o,internalForwardedProps:a}=t,l=(0,Ce.A)(t,$k),{component:u,slots:c={[e]:void 0},slotProps:h={[e]:void 0}}=s,d=(0,Ce.A)(s,_k),p=c[e]||r,f=Tk(h[e],i),m=Rk((0,Ie.A)({className:n},l,{externalForwardedProps:"root"===e?d:void 0,externalSlotProps:f})),{props:{component:g},internalRef:v}=m,y=(0,Ce.A)(m.props,Ok),b=Ik(v,null==f?void 0:f.ref,t.ref),x=o?o(y):{},w=(0,Ie.A)({},i,x),k="root"===e?g||u:g,S=Ek(p,(0,Ie.A)({},"root"===e&&!u&&!c[e]&&a,"root"!==e&&!c[e]&&a,y,k&&{as:k},{ref:b}),w);return Object.keys(x).forEach((e=>{delete S[e]})),[p,S]}function Fk(e){return wt("MuiAlert",e)}const Mk=kt("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),Lk=Ik,Pk="undefined"!==typeof window?a.useLayoutEffect:a.useEffect;const zk=function(e){const t=a.useRef(e);return Pk((()=>{t.current=e})),a.useRef((function(){return(0,t.current)(...arguments)})).current},Bk=zk,Uk={};const Wk=[];class Vk{constructor(){this.currentId=null,this.clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new Vk}start(e,t){this.clear(),this.currentId=setTimeout((()=>{this.currentId=null,t()}),e)}}function jk(){const e=function(e,t){const n=a.useRef(Uk);return n.current===Uk&&(n.current=e(t)),n}(Vk.create).current;var t;return t=e.disposeEffect,a.useEffect(t,Wk),e}let Gk=!0,Hk=!1;const qk=new Vk,Kk={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Xk(e){e.metaKey||e.altKey||e.ctrlKey||(Gk=!0)}function Yk(){Gk=!1}function Qk(){"hidden"===this.visibilityState&&Hk&&(Gk=!0)}function Jk(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch(n){}return Gk||function(e){const{type:t,tagName:n}=e;return!("INPUT"!==n||!Kk[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}function Zk(){const e=a.useCallback((e=>{var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",Xk,!0),t.addEventListener("mousedown",Yk,!0),t.addEventListener("pointerdown",Yk,!0),t.addEventListener("touchstart",Yk,!0),t.addEventListener("visibilitychange",Qk,!0))}),[]),t=a.useRef(!1);return{isFocusVisibleRef:t,onFocus:function(e){return!!Jk(e)&&(t.current=!0,!0)},onBlur:function(){return!!t.current&&(Hk=!0,qk.start(100,(()=>{Hk=!1})),t.current=!1,!0)},ref:e}}const eS=Zk;function tS(e,t){return tS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tS(e,t)}function nS(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,tS(e,t)}const rS=a.createContext(null);function iS(e,t){var n=Object.create(null);return e&&a.Children.map(e,(function(e){return e})).forEach((function(e){n[e.key]=function(e){return t&&(0,a.isValidElement)(e)?t(e):e}(e)})),n}function sS(e,t,n){return null!=n[t]?n[t]:e.props[t]}function oS(e,t,n){var r=iS(e.children),i=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,i=Object.create(null),s=[];for(var o in e)o in t?s.length&&(i[o]=s,s=[]):s.push(o);var a={};for(var l in t){if(i[l])for(r=0;r<i[l].length;r++){var u=i[l][r];a[i[l][r]]=n(u)}a[l]=n(l)}for(r=0;r<s.length;r++)a[s[r]]=n(s[r]);return a}(t,r);return Object.keys(i).forEach((function(s){var o=i[s];if((0,a.isValidElement)(o)){var l=s in t,u=s in r,c=t[s],h=(0,a.isValidElement)(c)&&!c.props.in;!u||l&&!h?u||!l||h?u&&l&&(0,a.isValidElement)(c)&&(i[s]=(0,a.cloneElement)(o,{onExited:n.bind(null,o),in:c.props.in,exit:sS(o,"exit",e),enter:sS(o,"enter",e)})):i[s]=(0,a.cloneElement)(o,{in:!1}):i[s]=(0,a.cloneElement)(o,{onExited:n.bind(null,o),in:!0,exit:sS(o,"exit",e),enter:sS(o,"enter",e)})}})),i}var aS=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},lS=function(e){function t(t,n){var r,i=(r=e.call(this,t,n)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}nS(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var n,r,i=t.children,s=t.handleExited;return{children:t.firstRender?(n=e,r=s,iS(n.children,(function(e){return(0,a.cloneElement)(e,{onExited:r.bind(null,e),in:!0,appear:sS(e,"appear",n),enter:sS(e,"enter",n),exit:sS(e,"exit",n)})}))):oS(e,i,s),firstRender:!1}},n.handleExited=function(e,t){var n=iS(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=(0,Ie.A)({},t.children);return delete n[e.key],{children:n}})))},n.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=(0,Ce.A)(e,["component","childFactory"]),i=this.state.contextValue,s=aS(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?a.createElement(rS.Provider,{value:i},s):a.createElement(rS.Provider,{value:i},a.createElement(t,r,s))},t}(a.Component);lS.propTypes={},lS.defaultProps={component:"div",childFactory:function(e){return e}};const uS=lS;var cS=n(3290);const hS=function(e){const{className:t,classes:n,pulsate:r=!1,rippleX:i,rippleY:s,rippleSize:o,in:l,onExited:u,timeout:c}=e,[h,d]=a.useState(!1),p=Te(t,n.ripple,n.rippleVisible,r&&n.ripplePulsate),f={width:o,height:o,top:-o/2+s,left:-o/2+i},m=Te(n.child,h&&n.childLeaving,r&&n.childPulsate);return l||h||d(!0),a.useEffect((()=>{if(!l&&null!=u){const e=setTimeout(u,c);return()=>{clearTimeout(e)}}}),[u,l,c]),(0,Me.jsx)("span",{className:p,style:f,children:(0,Me.jsx)("span",{className:m})})};const dS=kt("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),pS=["center","classes","className"];let fS,mS,gS,vS,yS=e=>e;const bS=(0,cS.i7)(fS||(fS=yS`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),xS=(0,cS.i7)(mS||(mS=yS`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),wS=(0,cS.i7)(gS||(gS=yS`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),kS=Yw("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),SS=Yw(hS,{name:"MuiTouchRipple",slot:"Ripple"})(vS||(vS=yS`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),dS.rippleVisible,bS,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),dS.ripplePulsate,(e=>{let{theme:t}=e;return t.transitions.duration.shorter}),dS.child,dS.childLeaving,xS,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),dS.childPulsate,wS,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut})),IS=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiTouchRipple"}),{center:r=!1,classes:i={},className:s}=n,o=(0,Ce.A)(n,pS),[l,u]=a.useState([]),c=a.useRef(0),h=a.useRef(null);a.useEffect((()=>{h.current&&(h.current(),h.current=null)}),[l]);const d=a.useRef(!1),p=jk(),f=a.useRef(null),m=a.useRef(null),g=a.useCallback((e=>{const{pulsate:t,rippleX:n,rippleY:r,rippleSize:s,cb:o}=e;u((e=>[...e,(0,Me.jsx)(SS,{classes:{ripple:Te(i.ripple,dS.ripple),rippleVisible:Te(i.rippleVisible,dS.rippleVisible),ripplePulsate:Te(i.ripplePulsate,dS.ripplePulsate),child:Te(i.child,dS.child),childLeaving:Te(i.childLeaving,dS.childLeaving),childPulsate:Te(i.childPulsate,dS.childPulsate)},timeout:550,pulsate:t,rippleX:n,rippleY:r,rippleSize:s},c.current)])),c.current+=1,h.current=o}),[i]),v=a.useCallback((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};const{pulsate:i=!1,center:s=r||t.pulsate,fakeElement:o=!1}=t;if("mousedown"===(null==e?void 0:e.type)&&d.current)return void(d.current=!1);"touchstart"===(null==e?void 0:e.type)&&(d.current=!0);const a=o?null:m.current,l=a?a.getBoundingClientRect():{width:0,height:0,left:0,top:0};let u,c,h;if(s||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)u=Math.round(l.width/2),c=Math.round(l.height/2);else{const{clientX:t,clientY:n}=e.touches&&e.touches.length>0?e.touches[0]:e;u=Math.round(t-l.left),c=Math.round(n-l.top)}if(s)h=Math.sqrt((2*l.width**2+l.height**2)/3),h%2===0&&(h+=1);else{const e=2*Math.max(Math.abs((a?a.clientWidth:0)-u),u)+2,t=2*Math.max(Math.abs((a?a.clientHeight:0)-c),c)+2;h=Math.sqrt(e**2+t**2)}null!=e&&e.touches?null===f.current&&(f.current=()=>{g({pulsate:i,rippleX:u,rippleY:c,rippleSize:h,cb:n})},p.start(80,(()=>{f.current&&(f.current(),f.current=null)}))):g({pulsate:i,rippleX:u,rippleY:c,rippleSize:h,cb:n})}),[r,g,p]),y=a.useCallback((()=>{v({},{pulsate:!0})}),[v]),b=a.useCallback(((e,t)=>{if(p.clear(),"touchend"===(null==e?void 0:e.type)&&f.current)return f.current(),f.current=null,void p.start(0,(()=>{b(e,t)}));f.current=null,u((e=>e.length>0?e.slice(1):e)),h.current=t}),[p]);return a.useImperativeHandle(t,(()=>({pulsate:y,start:v,stop:b})),[y,v,b]),(0,Me.jsx)(kS,(0,Ie.A)({className:Te(dS.root,i.root,s),ref:m},o,{children:(0,Me.jsx)(uS,{component:null,exit:!0,children:l})}))}));function CS(e){return wt("MuiButtonBase",e)}const ES=kt("MuiButtonBase",["root","disabled","focusVisible"]),TS=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],NS=Yw("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${ES.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),AS=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiButtonBase"}),{action:r,centerRipple:i=!1,children:s,className:o,component:l="button",disabled:u=!1,disableRipple:c=!1,disableTouchRipple:h=!1,focusRipple:d=!1,LinkComponent:p="a",onBlur:f,onClick:m,onContextMenu:g,onDragLeave:v,onFocus:y,onFocusVisible:b,onKeyDown:x,onKeyUp:w,onMouseDown:k,onMouseLeave:S,onMouseUp:I,onTouchEnd:C,onTouchMove:E,onTouchStart:T,tabIndex:N=0,TouchRippleProps:A,touchRippleRef:R,type:$}=n,_=(0,Ce.A)(n,TS),O=a.useRef(null),D=a.useRef(null),F=Lk(D,R),{isFocusVisibleRef:M,onFocus:L,onBlur:P,ref:z}=eS(),[B,U]=a.useState(!1);u&&B&&U(!1),a.useImperativeHandle(r,(()=>({focusVisible:()=>{U(!0),O.current.focus()}})),[]);const[W,V]=a.useState(!1);a.useEffect((()=>{V(!0)}),[]);const j=W&&!c&&!u;function G(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h;return Bk((r=>{t&&t(r);return!n&&D.current&&D.current[e](r),!0}))}a.useEffect((()=>{B&&d&&!c&&W&&D.current.pulsate()}),[c,d,B,W]);const H=G("start",k),q=G("stop",g),K=G("stop",v),X=G("stop",I),Y=G("stop",(e=>{B&&e.preventDefault(),S&&S(e)})),Q=G("start",T),J=G("stop",C),Z=G("stop",E),ee=G("stop",(e=>{P(e),!1===M.current&&U(!1),f&&f(e)}),!1),te=Bk((e=>{O.current||(O.current=e.currentTarget),L(e),!0===M.current&&(U(!0),b&&b(e)),y&&y(e)})),ne=()=>{const e=O.current;return l&&"button"!==l&&!("A"===e.tagName&&e.href)},re=a.useRef(!1),ie=Bk((e=>{d&&!re.current&&B&&D.current&&" "===e.key&&(re.current=!0,D.current.stop(e,(()=>{D.current.start(e)}))),e.target===e.currentTarget&&ne()&&" "===e.key&&e.preventDefault(),x&&x(e),e.target===e.currentTarget&&ne()&&"Enter"===e.key&&!u&&(e.preventDefault(),m&&m(e))})),se=Bk((e=>{d&&" "===e.key&&D.current&&B&&!e.defaultPrevented&&(re.current=!1,D.current.stop(e,(()=>{D.current.pulsate(e)}))),w&&w(e),m&&e.target===e.currentTarget&&ne()&&" "===e.key&&!e.defaultPrevented&&m(e)}));let oe=l;"button"===oe&&(_.href||_.to)&&(oe=p);const ae={};"button"===oe?(ae.type=void 0===$?"button":$,ae.disabled=u):(_.href||_.to||(ae.role="button"),u&&(ae["aria-disabled"]=u));const le=Lk(t,z,O);const ue=(0,Ie.A)({},n,{centerRipple:i,component:l,disabled:u,disableRipple:c,disableTouchRipple:h,focusRipple:d,tabIndex:N,focusVisible:B}),ce=(e=>{const{disabled:t,focusVisible:n,focusVisibleClassName:r,classes:i}=e,s=Tw({root:["root",t&&"disabled",n&&"focusVisible"]},CS,i);return n&&r&&(s.root+=` ${r}`),s})(ue);return(0,Me.jsxs)(NS,(0,Ie.A)({as:oe,className:Te(ce.root,o),ownerState:ue,onBlur:ee,onClick:m,onContextMenu:q,onFocus:te,onKeyDown:ie,onKeyUp:se,onMouseDown:H,onMouseLeave:Y,onMouseUp:X,onDragLeave:K,onTouchEnd:J,onTouchMove:Z,onTouchStart:Q,ref:le,tabIndex:u?-1:N,type:$},ae,_,{children:[s,j?(0,Me.jsx)(IS,(0,Ie.A)({ref:F,center:i},A)):null]}))}));function RS(e){return wt("MuiIconButton",e)}const $S=kt("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),_S=["edge","children","className","color","disabled","disableFocusRipple","size"],OS=Yw(AS,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"default"!==n.color&&t[`color${Gw(n.color)}`],n.edge&&t[`edge${Gw(n.edge)}`],t[`size${Gw(n.size)}`]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!n.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,Ve.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===n.edge&&{marginLeft:"small"===n.size?-3:-12},"end"===n.edge&&{marginRight:"small"===n.size?-3:-12})}),(e=>{let{theme:t,ownerState:n}=e;var r;const i=null==(r=(t.vars||t).palette)?void 0:r[n.color];return(0,Ie.A)({},"inherit"===n.color&&{color:"inherit"},"inherit"!==n.color&&"default"!==n.color&&(0,Ie.A)({color:null==i?void 0:i.main},!n.disableRipple&&{"&:hover":(0,Ie.A)({},i&&{backgroundColor:t.vars?`rgba(${i.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,Ve.X4)(i.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),"small"===n.size&&{padding:5,fontSize:t.typography.pxToRem(18)},"large"===n.size&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${$S.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})})),DS=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiIconButton"}),{edge:r=!1,children:i,className:s,color:o="default",disabled:a=!1,disableFocusRipple:l=!1,size:u="medium"}=n,c=(0,Ce.A)(n,_S),h=(0,Ie.A)({},n,{edge:r,color:o,disabled:a,disableFocusRipple:l,size:u}),d=(e=>{const{classes:t,disabled:n,color:r,edge:i,size:s}=e;return Tw({root:["root",n&&"disabled","default"!==r&&`color${Gw(r)}`,i&&`edge${Gw(i)}`,`size${Gw(s)}`]},RS,t)})(h);return(0,Me.jsx)(OS,(0,Ie.A)({className:Te(d.root,s),centerRipple:!0,focusRipple:!l,disabled:a,ref:t},c,{ownerState:h,children:i}))}));function FS(e){return wt("MuiSvgIcon",e)}kt("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const MS=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],LS=Yw("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"inherit"!==n.color&&t[`color${Gw(n.color)}`],t[`fontSize${Gw(n.fontSize)}`]]}})((e=>{let{theme:t,ownerState:n}=e;var r,i,s,o,a,l,u,c,h,d,p,f,m;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:n.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(r=t.transitions)||null==(i=r.create)?void 0:i.call(r,"fill",{duration:null==(s=t.transitions)||null==(s=s.duration)?void 0:s.shorter}),fontSize:{inherit:"inherit",small:(null==(o=t.typography)||null==(a=o.pxToRem)?void 0:a.call(o,20))||"1.25rem",medium:(null==(l=t.typography)||null==(u=l.pxToRem)?void 0:u.call(l,24))||"1.5rem",large:(null==(c=t.typography)||null==(h=c.pxToRem)?void 0:h.call(c,35))||"2.1875rem"}[n.fontSize],color:null!=(d=null==(p=(t.vars||t).palette)||null==(p=p[n.color])?void 0:p.main)?d:{action:null==(f=(t.vars||t).palette)||null==(f=f.action)?void 0:f.active,disabled:null==(m=(t.vars||t).palette)||null==(m=m.action)?void 0:m.disabled,inherit:void 0}[n.color]}})),PS=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiSvgIcon"}),{children:r,className:i,color:s="inherit",component:o="svg",fontSize:l="medium",htmlColor:u,inheritViewBox:c=!1,titleAccess:h,viewBox:d="0 0 24 24"}=n,p=(0,Ce.A)(n,MS),f=a.isValidElement(r)&&"svg"===r.type,m=(0,Ie.A)({},n,{color:s,component:o,fontSize:l,instanceFontSize:e.fontSize,inheritViewBox:c,viewBox:d,hasSvgAsChild:f}),g={};c||(g.viewBox=d);const v=(e=>{const{color:t,fontSize:n,classes:r}=e;return Tw({root:["root","inherit"!==t&&`color${Gw(t)}`,`fontSize${Gw(n)}`]},FS,r)})(m);return(0,Me.jsxs)(LS,(0,Ie.A)({as:o,className:Te(v.root,i),focusable:"false",color:u,"aria-hidden":!h||void 0,role:h?"img":void 0,ref:t},g,p,f&&r.props,{ownerState:m,children:[f?r.props.children:r,h?(0,Me.jsx)("title",{children:h}):null]}))}));PS.muiName="SvgIcon";const zS=PS;function BS(e,t){function n(n,r){return(0,Me.jsx)(zS,(0,Ie.A)({"data-testid":`${t}Icon`,ref:r},n,{children:e}))}return n.muiName=zS.muiName,a.memo(a.forwardRef(n))}const US=BS((0,Me.jsx)("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),WS=BS((0,Me.jsx)("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),VS=BS((0,Me.jsx)("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),jS=BS((0,Me.jsx)("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),GS=BS((0,Me.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),HS=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],qS=Yw(fk,{name:"MuiAlert",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${Gw(n.color||n.severity)}`]]}})((e=>{let{theme:t}=e;const n="light"===t.palette.mode?Ve.e$:Ve.a,r="light"===t.palette.mode?Ve.a:Ve.e$;return(0,Ie.A)({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.light})).map((e=>{let[i]=e;return{props:{colorSeverity:i,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${i}Color`]:n(t.palette[i].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${i}StandardBg`]:r(t.palette[i].light,.9),[`& .${Mk.icon}`]:t.vars?{color:t.vars.palette.Alert[`${i}IconColor`]}:{color:t.palette[i].main}}}})),...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.light})).map((e=>{let[r]=e;return{props:{colorSeverity:r,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${r}Color`]:n(t.palette[r].light,.6),border:`1px solid ${(t.vars||t).palette[r].light}`,[`& .${Mk.icon}`]:t.vars?{color:t.vars.palette.Alert[`${r}IconColor`]}:{color:t.palette[r].main}}}})),...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.dark})).map((e=>{let[n]=e;return{props:{colorSeverity:n,variant:"filled"},style:(0,Ie.A)({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${n}FilledColor`],backgroundColor:t.vars.palette.Alert[`${n}FilledBg`]}:{backgroundColor:"dark"===t.palette.mode?t.palette[n].dark:t.palette[n].main,color:t.palette.getContrastText(t.palette[n].main)})}}))]})})),KS=Yw("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,t)=>t.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),XS=Yw("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),YS=Yw("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),QS={success:(0,Me.jsx)(US,{fontSize:"inherit"}),warning:(0,Me.jsx)(WS,{fontSize:"inherit"}),error:(0,Me.jsx)(VS,{fontSize:"inherit"}),info:(0,Me.jsx)(jS,{fontSize:"inherit"})},JS=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiAlert"}),{action:r,children:i,className:s,closeText:o="Close",color:a,components:l={},componentsProps:u={},icon:c,iconMapping:h=QS,onClose:d,role:p="alert",severity:f="success",slotProps:m={},slots:g={},variant:v="standard"}=n,y=(0,Ce.A)(n,HS),b=(0,Ie.A)({},n,{color:a,severity:f,variant:v,colorSeverity:a||f}),x=(e=>{const{variant:t,color:n,severity:r,classes:i}=e;return Tw({root:["root",`color${Gw(n||r)}`,`${t}${Gw(n||r)}`,`${t}`],icon:["icon"],message:["message"],action:["action"]},Fk,i)})(b),w={slots:(0,Ie.A)({closeButton:l.CloseButton,closeIcon:l.CloseIcon},g),slotProps:(0,Ie.A)({},u,m)},[k,S]=Dk("closeButton",{elementType:DS,externalForwardedProps:w,ownerState:b}),[I,C]=Dk("closeIcon",{elementType:GS,externalForwardedProps:w,ownerState:b});return(0,Me.jsxs)(qS,(0,Ie.A)({role:p,elevation:0,ownerState:b,className:Te(x.root,s),ref:t},y,{children:[!1!==c?(0,Me.jsx)(KS,{ownerState:b,className:x.icon,children:c||h[f]||QS[f]}):null,(0,Me.jsx)(XS,{ownerState:b,className:x.message,children:i}),null!=r?(0,Me.jsx)(YS,{ownerState:b,className:x.action,children:r}):null,null==r&&d?(0,Me.jsx)(YS,{ownerState:b,className:x.action,children:(0,Me.jsx)(k,(0,Ie.A)({size:"small","aria-label":o,title:o,color:"inherit",onClick:d},S,{children:(0,Me.jsx)(I,(0,Ie.A)({fontSize:"small"},C))}))}):null]}))})),ZS=JS;let eI=0;const tI=l["useId".toString()];function nI(e){if(void 0!==tI){const t=tI();return null!=e?e:t}return function(e){const[t,n]=a.useState(e),r=e||t;return a.useEffect((()=>{null==t&&(eI+=1,n(`mui-${eI}`))}),[t]),r}(e)}function rI(e){return e&&e.ownerDocument||document}function iI(e){return rI(e).defaultView||window}function sI(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];clearTimeout(t),t=setTimeout((()=>{e.apply(this,i)}),n)}return r.clear=()=>{clearTimeout(t)},r}const oI=["onChange","maxRows","minRows","style","value"];function aI(e){return parseInt(e,10)||0}const lI={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};function uI(e){return function(e){for(const t in e)return!1;return!0}(e)||0===e.outerHeightStyle&&!e.overflowing}const cI=a.forwardRef((function(e,t){const{onChange:n,maxRows:r,minRows:i=1,style:s,value:o}=e,l=(0,Ce.A)(e,oI),{current:u}=a.useRef(null!=o),c=a.useRef(null),h=Ik(t,c),d=a.useRef(null),p=a.useRef(null),f=a.useCallback((()=>{const t=c.current,n=p.current;if(!t||!n)return;const s=iI(t).getComputedStyle(t);if("0px"===s.width)return{outerHeightStyle:0,overflowing:!1};n.style.width=s.width,n.value=t.value||e.placeholder||"x","\n"===n.value.slice(-1)&&(n.value+=" ");const o=s.boxSizing,a=aI(s.paddingBottom)+aI(s.paddingTop),l=aI(s.borderBottomWidth)+aI(s.borderTopWidth),u=n.scrollHeight;n.value="x";const h=n.scrollHeight;let d=u;i&&(d=Math.max(Number(i)*h,d)),r&&(d=Math.min(Number(r)*h,d)),d=Math.max(d,h);return{outerHeightStyle:d+("border-box"===o?a+l:0),overflowing:Math.abs(d-u)<=1}}),[r,i,e.placeholder]),m=zk((()=>{const e=c.current,t=f();if(!e||!t||uI(t))return!1;const n=t.outerHeightStyle;return null!=d.current&&d.current!==n})),g=a.useCallback((()=>{const e=c.current,t=f();if(!e||!t||uI(t))return;const n=t.outerHeightStyle;d.current!==n&&(d.current=n,e.style.height=`${n}px`),e.style.overflow=t.overflowing?"hidden":""}),[f]),v=a.useRef(-1);Pk((()=>{const e=sI(g),t=null==c?void 0:c.current;if(!t)return;const n=iI(t);let r;return n.addEventListener("resize",e),"undefined"!==typeof ResizeObserver&&(r=new ResizeObserver((()=>{m()&&(r.unobserve(t),cancelAnimationFrame(v.current),g(),v.current=requestAnimationFrame((()=>{r.observe(t)})))})),r.observe(t)),()=>{e.clear(),cancelAnimationFrame(v.current),n.removeEventListener("resize",e),r&&r.disconnect()}}),[f,g,m]),Pk((()=>{g()}));return(0,Me.jsxs)(a.Fragment,{children:[(0,Me.jsx)("textarea",(0,Ie.A)({value:o,onChange:e=>{u||g(),n&&n(e)},ref:h,rows:i,style:s},l)),(0,Me.jsx)("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:p,tabIndex:-1,style:(0,Ie.A)({},lI,s,{paddingTop:0,paddingBottom:0})})]})}));function hI(e){let{props:t,states:n,muiFormControl:r}=e;return n.reduce(((e,n)=>(e[n]=t[n],r&&"undefined"===typeof t[n]&&(e[n]=r[n]),e)),{})}const dI=a.createContext(void 0);function pI(){return a.useContext(dI)}const fI=Pk;var mI=n(869);const gI=function(e){let{styles:t,themeId:n,defaultTheme:r={}}=e;const i=Fe(r),s="function"===typeof t?t(n&&i[n]||i):t;return(0,Me.jsx)(mI.A,{styles:s})};const vI=function(e){return(0,Me.jsx)(gI,(0,Ie.A)({},e,{defaultTheme:qw,themeId:bt}))};function yI(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function bI(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(yI(e.value)&&""!==e.value||t&&yI(e.defaultValue)&&""!==e.defaultValue)}function xI(e){return wt("MuiInputBase",e)}const wI=kt("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),kI=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],SI=(e,t)=>{const{ownerState:n}=e;return[t.root,n.formControl&&t.formControl,n.startAdornment&&t.adornedStart,n.endAdornment&&t.adornedEnd,n.error&&t.error,"small"===n.size&&t.sizeSmall,n.multiline&&t.multiline,n.color&&t[`color${Gw(n.color)}`],n.fullWidth&&t.fullWidth,n.hiddenLabel&&t.hiddenLabel]},II=(e,t)=>{const{ownerState:n}=e;return[t.input,"small"===n.size&&t.inputSizeSmall,n.multiline&&t.inputMultiline,"search"===n.type&&t.inputTypeSearch,n.startAdornment&&t.inputAdornedStart,n.endAdornment&&t.inputAdornedEnd,n.hiddenLabel&&t.inputHiddenLabel]},CI=Yw("div",{name:"MuiInputBase",slot:"Root",overridesResolver:SI})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${wI.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},n.multiline&&(0,Ie.A)({padding:"4px 0 5px"},"small"===n.size&&{paddingTop:1}),n.fullWidth&&{width:"100%"})})),EI=Yw("input",{name:"MuiInputBase",slot:"Input",overridesResolver:II})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode,i=(0,Ie.A)({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),s={opacity:"0 !important"},o=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return(0,Ie.A)({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${wI.formControl} &`]:{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus:-ms-input-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${wI.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},"small"===n.size&&{paddingTop:1},n.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},"search"===n.type&&{MozAppearance:"textfield"})})),TI=(0,Me.jsx)(vI,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),NI=a.forwardRef((function(e,t){var n;const r=ek({props:e,name:"MuiInputBase"}),{"aria-describedby":i,autoComplete:s,autoFocus:o,className:l,components:u={},componentsProps:c={},defaultValue:h,disabled:d,disableInjectingGlobalStyles:p,endAdornment:f,fullWidth:m=!1,id:g,inputComponent:v="input",inputProps:y={},inputRef:b,maxRows:x,minRows:w,multiline:k=!1,name:S,onBlur:I,onChange:C,onClick:E,onFocus:T,onKeyDown:N,onKeyUp:A,placeholder:R,readOnly:$,renderSuffix:_,rows:O,slotProps:D={},slots:F={},startAdornment:M,type:L="text",value:P}=r,z=(0,Ce.A)(r,kI),B=null!=y.value?y.value:P,{current:U}=a.useRef(null!=B),W=a.useRef(),V=a.useCallback((e=>{0}),[]),j=Lk(W,b,y.ref,V),[G,H]=a.useState(!1),q=pI();const K=hI({props:r,muiFormControl:q,states:["color","disabled","error","hiddenLabel","size","required","filled"]});K.focused=q?q.focused:G,a.useEffect((()=>{!q&&d&&G&&(H(!1),I&&I())}),[q,d,G,I]);const X=q&&q.onFilled,Y=q&&q.onEmpty,Q=a.useCallback((e=>{bI(e)?X&&X():Y&&Y()}),[X,Y]);fI((()=>{U&&Q({value:B})}),[B,Q,U]);a.useEffect((()=>{Q(W.current)}),[]);let J=v,Z=y;k&&"input"===J&&(Z=O?(0,Ie.A)({type:void 0,minRows:O,maxRows:O},Z):(0,Ie.A)({type:void 0,maxRows:x,minRows:w},Z),J=cI);a.useEffect((()=>{q&&q.setAdornedStart(Boolean(M))}),[q,M]);const ee=(0,Ie.A)({},r,{color:K.color||"primary",disabled:K.disabled,endAdornment:f,error:K.error,focused:K.focused,formControl:q,fullWidth:m,hiddenLabel:K.hiddenLabel,multiline:k,size:K.size,startAdornment:M,type:L}),te=(e=>{const{classes:t,color:n,disabled:r,error:i,endAdornment:s,focused:o,formControl:a,fullWidth:l,hiddenLabel:u,multiline:c,readOnly:h,size:d,startAdornment:p,type:f}=e;return Tw({root:["root",`color${Gw(n)}`,r&&"disabled",i&&"error",l&&"fullWidth",o&&"focused",a&&"formControl",d&&"medium"!==d&&`size${Gw(d)}`,c&&"multiline",p&&"adornedStart",s&&"adornedEnd",u&&"hiddenLabel",h&&"readOnly"],input:["input",r&&"disabled","search"===f&&"inputTypeSearch",c&&"inputMultiline","small"===d&&"inputSizeSmall",u&&"inputHiddenLabel",p&&"inputAdornedStart",s&&"inputAdornedEnd",h&&"readOnly"]},xI,t)})(ee),ne=F.root||u.Root||CI,re=D.root||c.root||{},ie=F.input||u.Input||EI;return Z=(0,Ie.A)({},Z,null!=(n=D.input)?n:c.input),(0,Me.jsxs)(a.Fragment,{children:[!p&&TI,(0,Me.jsxs)(ne,(0,Ie.A)({},re,!Ck(ne)&&{ownerState:(0,Ie.A)({},ee,re.ownerState)},{ref:t,onClick:e=>{W.current&&e.currentTarget===e.target&&W.current.focus(),E&&E(e)}},z,{className:Te(te.root,re.className,l,$&&"MuiInputBase-readOnly"),children:[M,(0,Me.jsx)(dI.Provider,{value:null,children:(0,Me.jsx)(ie,(0,Ie.A)({ownerState:ee,"aria-invalid":K.error,"aria-describedby":i,autoComplete:s,autoFocus:o,defaultValue:h,disabled:K.disabled,id:g,onAnimationStart:e=>{Q("mui-auto-fill-cancel"===e.animationName?W.current:{value:"x"})},name:S,placeholder:R,readOnly:$,required:K.required,rows:O,value:B,onKeyDown:N,onKeyUp:A,type:L},Z,!Ck(ie)&&{as:J,ownerState:(0,Ie.A)({},ee,Z.ownerState)},{ref:j,className:Te(te.input,Z.className,$&&"MuiInputBase-readOnly"),onBlur:e=>{I&&I(e),y.onBlur&&y.onBlur(e),q&&q.onBlur?q.onBlur(e):H(!1)},onChange:function(e){if(!U){const t=e.target||W.current;if(null==t)throw new Error((0,Be.A)(1));Q({value:t.value})}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];y.onChange&&y.onChange(e,...n),C&&C(e,...n)},onFocus:e=>{K.disabled?e.stopPropagation():(T&&T(e),y.onFocus&&y.onFocus(e),q&&q.onFocus?q.onFocus(e):H(!0))}}))}),f,_?_((0,Ie.A)({},K,{startAdornment:M})):null]}))]})}));function AI(e){return wt("MuiInput",e)}const RI=(0,Ie.A)({},wI,kt("MuiInput",["root","underline","input"])),$I=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],_I=Yw(CI,{shouldForwardProp:e=>Xw(e)||"classes"===e,name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...SI(e,t),!n.disableUnderline&&t.underline]}})((e=>{let{theme:t,ownerState:n}=e;let r="light"===t.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),(0,Ie.A)({position:"relative"},n.formControl&&{"label + &":{marginTop:16}},!n.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[n.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${RI.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${RI.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${RI.disabled}, .${RI.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${RI.disabled}:before`]:{borderBottomStyle:"dotted"}})})),OI=Yw(EI,{name:"MuiInput",slot:"Input",overridesResolver:II})({}),DI=a.forwardRef((function(e,t){var n,r,i,s;const o=ek({props:e,name:"MuiInput"}),{disableUnderline:a,components:l={},componentsProps:u,fullWidth:c=!1,inputComponent:h="input",multiline:d=!1,slotProps:p,slots:f={},type:m="text"}=o,g=(0,Ce.A)(o,$I),v=(e=>{const{classes:t,disableUnderline:n}=e,r=Tw({root:["root",!n&&"underline"],input:["input"]},AI,t);return(0,Ie.A)({},t,r)})(o),y={root:{ownerState:{disableUnderline:a}}},b=(null!=p?p:u)?(0,Ue.A)(null!=p?p:u,y):y,x=null!=(n=null!=(r=f.root)?r:l.Root)?n:_I,w=null!=(i=null!=(s=f.input)?s:l.Input)?i:OI;return(0,Me.jsx)(NI,(0,Ie.A)({slots:{root:x,input:w},slotProps:b,fullWidth:c,inputComponent:h,multiline:d,ref:t,type:m},g,{classes:v}))}));DI.muiName="Input";const FI=DI;function MI(e){return wt("MuiFilledInput",e)}const LI=(0,Ie.A)({},wI,kt("MuiFilledInput",["root","underline","input"])),PI=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],zI=Yw(CI,{shouldForwardProp:e=>Xw(e)||"classes"===e,name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...SI(e,t),!n.disableUnderline&&t.underline]}})((e=>{let{theme:t,ownerState:n}=e;var r;const i="light"===t.palette.mode,s=i?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",o=i?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",a=i?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",l=i?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return(0,Ie.A)({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:a,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o}},[`&.${LI.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o},[`&.${LI.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:l}},!n.disableUnderline&&{"&::after":{borderBottom:`2px solid ${null==(r=(t.vars||t).palette[n.color||"primary"])?void 0:r.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${LI.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${LI.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${LI.disabled}, .${LI.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${LI.disabled}:before`]:{borderBottomStyle:"dotted"}},n.startAdornment&&{paddingLeft:12},n.endAdornment&&{paddingRight:12},n.multiline&&(0,Ie.A)({padding:"25px 12px 8px"},"small"===n.size&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.hiddenLabel&&"small"===n.size&&{paddingTop:8,paddingBottom:9}))})),BI=Yw(EI,{name:"MuiFilledInput",slot:"Input",overridesResolver:II})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===n.size&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0},n.hiddenLabel&&"small"===n.size&&{paddingTop:8,paddingBottom:9},n.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})})),UI=a.forwardRef((function(e,t){var n,r,i,s;const o=ek({props:e,name:"MuiFilledInput"}),{components:a={},componentsProps:l,fullWidth:u=!1,inputComponent:c="input",multiline:h=!1,slotProps:d,slots:p={},type:f="text"}=o,m=(0,Ce.A)(o,PI),g=(0,Ie.A)({},o,{fullWidth:u,inputComponent:c,multiline:h,type:f}),v=(e=>{const{classes:t,disableUnderline:n}=e,r=Tw({root:["root",!n&&"underline"],input:["input"]},MI,t);return(0,Ie.A)({},t,r)})(o),y={root:{ownerState:g},input:{ownerState:g}},b=(null!=d?d:l)?(0,Ue.A)(y,null!=d?d:l):y,x=null!=(n=null!=(r=p.root)?r:a.Root)?n:zI,w=null!=(i=null!=(s=p.input)?s:a.Input)?i:BI;return(0,Me.jsx)(NI,(0,Ie.A)({slots:{root:x,input:w},componentsProps:b,fullWidth:u,inputComponent:c,multiline:h,ref:t,type:f},m,{classes:v}))}));UI.muiName="Input";const WI=UI;var VI;const jI=["children","classes","className","label","notched"],GI=Yw("fieldset",{shouldForwardProp:Xw})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),HI=Yw("legend",{shouldForwardProp:Xw})((e=>{let{ownerState:t,theme:n}=e;return(0,Ie.A)({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:n.transitions.create("width",{duration:150,easing:n.transitions.easing.easeOut})},t.withLabel&&(0,Ie.A)({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:n.transitions.create("max-width",{duration:50,easing:n.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:n.transitions.create("max-width",{duration:100,easing:n.transitions.easing.easeOut,delay:50})}))}));function qI(e){return wt("MuiOutlinedInput",e)}const KI=(0,Ie.A)({},wI,kt("MuiOutlinedInput",["root","notchedOutline","input"])),XI=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],YI=Yw(CI,{shouldForwardProp:e=>Xw(e)||"classes"===e,name:"MuiOutlinedInput",slot:"Root",overridesResolver:SI})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return(0,Ie.A)({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${KI.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${KI.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${KI.focused} .${KI.notchedOutline}`]:{borderColor:(t.vars||t).palette[n.color].main,borderWidth:2},[`&.${KI.error} .${KI.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${KI.disabled} .${KI.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},n.startAdornment&&{paddingLeft:14},n.endAdornment&&{paddingRight:14},n.multiline&&(0,Ie.A)({padding:"16.5px 14px"},"small"===n.size&&{padding:"8.5px 14px"}))})),QI=Yw((function(e){const{className:t,label:n,notched:r}=e,i=(0,Ce.A)(e,jI),s=null!=n&&""!==n,o=(0,Ie.A)({},e,{notched:r,withLabel:s});return(0,Me.jsx)(GI,(0,Ie.A)({"aria-hidden":!0,className:t,ownerState:o},i,{children:(0,Me.jsx)(HI,{ownerState:o,children:s?(0,Me.jsx)("span",{children:n}):VI||(VI=(0,Me.jsx)("span",{className:"notranslate",children:"\u200b"}))})}))}),{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})((e=>{let{theme:t}=e;const n="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}})),JI=Yw(EI,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:II})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===n.size&&{padding:"8.5px 14px"},n.multiline&&{padding:0},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0})})),ZI=a.forwardRef((function(e,t){var n,r,i,s,o;const l=ek({props:e,name:"MuiOutlinedInput"}),{components:u={},fullWidth:c=!1,inputComponent:h="input",label:d,multiline:p=!1,notched:f,slots:m={},type:g="text"}=l,v=(0,Ce.A)(l,XI),y=(e=>{const{classes:t}=e,n=Tw({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},qI,t);return(0,Ie.A)({},t,n)})(l),b=pI(),x=hI({props:l,muiFormControl:b,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),w=(0,Ie.A)({},l,{color:x.color||"primary",disabled:x.disabled,error:x.error,focused:x.focused,formControl:b,fullWidth:c,hiddenLabel:x.hiddenLabel,multiline:p,size:x.size,type:g}),k=null!=(n=null!=(r=m.root)?r:u.Root)?n:YI,S=null!=(i=null!=(s=m.input)?s:u.Input)?i:JI;return(0,Me.jsx)(NI,(0,Ie.A)({slots:{root:k,input:S},renderSuffix:e=>(0,Me.jsx)(QI,{ownerState:w,className:y.notchedOutline,label:null!=d&&""!==d&&x.required?o||(o=(0,Me.jsxs)(a.Fragment,{children:[d,"\u2009","*"]})):d,notched:"undefined"!==typeof f?f:Boolean(e.startAdornment||e.filled||e.focused)}),fullWidth:c,inputComponent:h,multiline:p,ref:t,type:g},v,{classes:(0,Ie.A)({},y,{notchedOutline:null})}))}));ZI.muiName="Input";const eC=ZI;function tC(e){return wt("MuiFormLabel",e)}const nC=kt("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),rC=["children","className","color","component","disabled","error","filled","focused","required"],iC=Yw("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return(0,Ie.A)({},t.root,"secondary"===n.color&&t.colorSecondary,n.filled&&t.filled)}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${nC.focused}`]:{color:(t.vars||t).palette[n.color].main},[`&.${nC.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${nC.error}`]:{color:(t.vars||t).palette.error.main}})})),sC=Yw("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((e=>{let{theme:t}=e;return{[`&.${nC.error}`]:{color:(t.vars||t).palette.error.main}}})),oC=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiFormLabel"}),{children:r,className:i,component:s="label"}=n,o=(0,Ce.A)(n,rC),a=hI({props:n,muiFormControl:pI(),states:["color","required","focused","disabled","error","filled"]}),l=(0,Ie.A)({},n,{color:a.color||"primary",component:s,disabled:a.disabled,error:a.error,filled:a.filled,focused:a.focused,required:a.required}),u=(e=>{const{classes:t,color:n,focused:r,disabled:i,error:s,filled:o,required:a}=e;return Tw({root:["root",`color${Gw(n)}`,i&&"disabled",s&&"error",o&&"filled",r&&"focused",a&&"required"],asterisk:["asterisk",s&&"error"]},tC,t)})(l);return(0,Me.jsxs)(iC,(0,Ie.A)({as:s,ownerState:l,className:Te(u.root,i),ref:t},o,{children:[r,a.required&&(0,Me.jsxs)(sC,{ownerState:l,"aria-hidden":!0,className:u.asterisk,children:["\u2009","*"]})]}))}));function aC(e){return wt("MuiInputLabel",e)}kt("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const lC=["disableAnimation","margin","shrink","variant","className"],uC=Yw(oC,{shouldForwardProp:e=>Xw(e)||"classes"===e,name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${nC.asterisk}`]:t.asterisk},t.root,n.formControl&&t.formControl,"small"===n.size&&t.sizeSmall,n.shrink&&t.shrink,!n.disableAnimation&&t.animated,n.focused&&t.focused,t[n.variant]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},n.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},"small"===n.size&&{transform:"translate(0, 17px) scale(1)"},n.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!n.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},"filled"===n.variant&&(0,Ie.A)({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(12px, 13px) scale(1)"},n.shrink&&(0,Ie.A)({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},"small"===n.size&&{transform:"translate(12px, 4px) scale(0.75)"})),"outlined"===n.variant&&(0,Ie.A)({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(14px, 9px) scale(1)"},n.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))})),cC=a.forwardRef((function(e,t){const n=ek({name:"MuiInputLabel",props:e}),{disableAnimation:r=!1,shrink:i,className:s}=n,o=(0,Ce.A)(n,lC),a=pI();let l=i;"undefined"===typeof l&&a&&(l=a.filled||a.focused||a.adornedStart);const u=hI({props:n,muiFormControl:a,states:["size","variant","required","focused"]}),c=(0,Ie.A)({},n,{disableAnimation:r,formControl:a,shrink:l,size:u.size,variant:u.variant,required:u.required,focused:u.focused}),h=(e=>{const{classes:t,formControl:n,size:r,shrink:i,disableAnimation:s,variant:o,required:a}=e,l=Tw({root:["root",n&&"formControl",!s&&"animated",i&&"shrink",r&&"normal"!==r&&`size${Gw(r)}`,o],asterisk:[a&&"asterisk"]},aC,t);return(0,Ie.A)({},t,l)})(c);return(0,Me.jsx)(uC,(0,Ie.A)({"data-shrink":l,ownerState:c,ref:t,className:Te(h.root,s)},o,{classes:h}))})),hC=cC;const dC=function(e,t){var n,r;return a.isValidElement(e)&&-1!==t.indexOf(null!=(n=e.type.muiName)?n:null==(r=e.type)||null==(r=r._payload)||null==(r=r.value)?void 0:r.muiName)};function pC(e){return wt("MuiFormControl",e)}kt("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const fC=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],mC=Yw("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return(0,Ie.A)({},t.root,t[`margin${Gw(n.margin)}`],n.fullWidth&&t.fullWidth)}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},"normal"===t.margin&&{marginTop:16,marginBottom:8},"dense"===t.margin&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})})),gC=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiFormControl"}),{children:r,className:i,color:s="primary",component:o="div",disabled:l=!1,error:u=!1,focused:c,fullWidth:h=!1,hiddenLabel:d=!1,margin:p="none",required:f=!1,size:m="medium",variant:g="outlined"}=n,v=(0,Ce.A)(n,fC),y=(0,Ie.A)({},n,{color:s,component:o,disabled:l,error:u,fullWidth:h,hiddenLabel:d,margin:p,required:f,size:m,variant:g}),b=(e=>{const{classes:t,margin:n,fullWidth:r}=e;return Tw({root:["root","none"!==n&&`margin${Gw(n)}`,r&&"fullWidth"]},pC,t)})(y),[x,w]=a.useState((()=>{let e=!1;return r&&a.Children.forEach(r,(t=>{if(!dC(t,["Input","Select"]))return;const n=dC(t,["Select"])?t.props.input:t;n&&n.props.startAdornment&&(e=!0)})),e})),[k,S]=a.useState((()=>{let e=!1;return r&&a.Children.forEach(r,(t=>{dC(t,["Input","Select"])&&(bI(t.props,!0)||bI(t.props.inputProps,!0))&&(e=!0)})),e})),[I,C]=a.useState(!1);l&&I&&C(!1);const E=void 0===c||l?I:c;let T;const N=a.useMemo((()=>({adornedStart:x,setAdornedStart:w,color:s,disabled:l,error:u,filled:k,focused:E,fullWidth:h,hiddenLabel:d,size:m,onBlur:()=>{C(!1)},onEmpty:()=>{S(!1)},onFilled:()=>{S(!0)},onFocus:()=>{C(!0)},registerEffect:T,required:f,variant:g})),[x,s,l,u,k,E,h,d,T,f,m,g]);return(0,Me.jsx)(dI.Provider,{value:N,children:(0,Me.jsx)(mC,(0,Ie.A)({as:o,ownerState:y,className:Te(b.root,i),ref:t},v,{children:r}))})})),vC=gC;function yC(e){return wt("MuiFormHelperText",e)}const bC=kt("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var xC;const wC=["children","className","component","disabled","error","filled","focused","margin","required","variant"],kC=Yw("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.size&&t[`size${Gw(n.size)}`],n.contained&&t.contained,n.filled&&t.filled]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${bC.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${bC.error}`]:{color:(t.vars||t).palette.error.main}},"small"===n.size&&{marginTop:4},n.contained&&{marginLeft:14,marginRight:14})})),SC=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiFormHelperText"}),{children:r,className:i,component:s="p"}=n,o=(0,Ce.A)(n,wC),a=hI({props:n,muiFormControl:pI(),states:["variant","size","disabled","error","filled","focused","required"]}),l=(0,Ie.A)({},n,{component:s,contained:"filled"===a.variant||"outlined"===a.variant,variant:a.variant,size:a.size,disabled:a.disabled,error:a.error,filled:a.filled,focused:a.focused,required:a.required}),u=(e=>{const{classes:t,contained:n,size:r,disabled:i,error:s,filled:o,focused:a,required:l}=e;return Tw({root:["root",i&&"disabled",s&&"error",r&&`size${Gw(r)}`,n&&"contained",a&&"focused",o&&"filled",l&&"required"]},yC,t)})(l);return(0,Me.jsx)(kC,(0,Ie.A)({as:s,ownerState:l,className:Te(u.root,i),ref:t},o,{children:" "===r?xC||(xC=(0,Me.jsx)("span",{className:"notranslate",children:"\u200b"})):r}))}));function IC(e){var t;return parseInt(a.version,10)>=19?(null==e||null==(t=e.props)?void 0:t.ref)||null:(null==e?void 0:e.ref)||null}const CC=rI,EC=["value"],TC=a.createContext();const NC=()=>{const e=a.useContext(TC);return null!=e&&e},AC=function(e){let{value:t}=e,n=(0,Ce.A)(e,EC);return(0,Me.jsx)(TC.Provider,(0,Ie.A)({value:null==t||t},n))},RC=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];const $C=function(e){var t;const{elementType:n,externalSlotProps:r,ownerState:i,skipResolvingSlotProps:s=!1}=e,o=(0,Ce.A)(e,RC),a=s?{}:Tk(r,i),{props:l,internalRef:u}=Rk((0,Ie.A)({},o,{externalSlotProps:a})),c=Ik(u,null==a?void 0:a.ref,null==(t=e.additionalProps)?void 0:t.ref);return Ek(n,(0,Ie.A)({},l,{ref:c}),i)};const _C=a.createContext({});function OC(e){return wt("MuiList",e)}kt("MuiList",["root","padding","dense","subheader"]);const DC=["children","className","component","dense","disablePadding","subheader"],FC=Yw("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disablePadding&&t.padding,n.dense&&t.dense,n.subheader&&t.subheader]}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})})),MC=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiList"}),{children:r,className:i,component:s="ul",dense:o=!1,disablePadding:l=!1,subheader:u}=n,c=(0,Ce.A)(n,DC),h=a.useMemo((()=>({dense:o})),[o]),d=(0,Ie.A)({},n,{component:s,dense:o,disablePadding:l}),p=(e=>{const{classes:t,disablePadding:n,dense:r,subheader:i}=e;return Tw({root:["root",!n&&"padding",r&&"dense",i&&"subheader"]},OC,t)})(d);return(0,Me.jsx)(_C.Provider,{value:h,children:(0,Me.jsxs)(FC,(0,Ie.A)({as:s,className:Te(p.root,i),ref:t,ownerState:d},c,{children:[u,r]}))})}));function LC(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}const PC=LC,zC=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function BC(e,t,n){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:n?null:e.firstChild}function UC(e,t,n){return e===t?n?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:n?null:e.lastChild}function WC(e,t){if(void 0===t)return!0;let n=e.innerText;return void 0===n&&(n=e.textContent),n=n.trim().toLowerCase(),0!==n.length&&(t.repeating?n[0]===t.keys[0]:0===n.indexOf(t.keys.join("")))}function VC(e,t,n,r,i,s){let o=!1,a=i(e,t,!!t&&n);for(;a;){if(a===e.firstChild){if(o)return!1;o=!0}const t=!r&&(a.disabled||"true"===a.getAttribute("aria-disabled"));if(a.hasAttribute("tabindex")&&WC(a,s)&&!t)return a.focus(),!0;a=i(e,a,n)}return!1}const jC=a.forwardRef((function(e,t){const{actions:n,autoFocus:r=!1,autoFocusItem:i=!1,children:s,className:o,disabledItemsFocusable:l=!1,disableListWrap:u=!1,onKeyDown:c,variant:h="selectedMenu"}=e,d=(0,Ce.A)(e,zC),p=a.useRef(null),f=a.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});fI((()=>{r&&p.current.focus()}),[r]),a.useImperativeHandle(n,(()=>({adjustStyleForScrollbar:(e,t)=>{let{direction:n}=t;const r=!p.current.style.width;if(e.clientHeight<p.current.clientHeight&&r){const t=`${PC(CC(e))}px`;p.current.style["rtl"===n?"paddingLeft":"paddingRight"]=t,p.current.style.width=`calc(100% + ${t})`}return p.current}})),[]);const m=Lk(p,t);let g=-1;a.Children.forEach(s,((e,t)=>{a.isValidElement(e)?(e.props.disabled||("selectedMenu"===h&&e.props.selected||-1===g)&&(g=t),g===t&&(e.props.disabled||e.props.muiSkipListHighlight||e.type.muiSkipListHighlight)&&(g+=1,g>=s.length&&(g=-1))):g===t&&(g+=1,g>=s.length&&(g=-1))}));const v=a.Children.map(s,((e,t)=>{if(t===g){const t={};return i&&(t.autoFocus=!0),void 0===e.props.tabIndex&&"selectedMenu"===h&&(t.tabIndex=0),a.cloneElement(e,t)}return e}));return(0,Me.jsx)(MC,(0,Ie.A)({role:"menu",ref:m,className:o,onKeyDown:e=>{const t=p.current,n=e.key,r=CC(t).activeElement;if("ArrowDown"===n)e.preventDefault(),VC(t,r,u,l,BC);else if("ArrowUp"===n)e.preventDefault(),VC(t,r,u,l,UC);else if("Home"===n)e.preventDefault(),VC(t,null,u,l,BC);else if("End"===n)e.preventDefault(),VC(t,null,u,l,UC);else if(1===n.length){const i=f.current,s=n.toLowerCase(),o=performance.now();i.keys.length>0&&(o-i.lastTime>500?(i.keys=[],i.repeating=!0,i.previousKeyMatched=!0):i.repeating&&s!==i.keys[0]&&(i.repeating=!1)),i.lastTime=o,i.keys.push(s);const a=r&&!i.repeating&&WC(r,i);i.previousKeyMatched&&(a||VC(t,r,!1,l,BC,i))?e.preventDefault():i.previousKeyMatched=!1}c&&c(e)},tabIndex:r?0:-1},d,{children:v}))})),GC=jC,HC=sI,qC=iI,KC=!1;var XC="unmounted",YC="exited",QC="entering",JC="entered",ZC="exiting",eE=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var i,s=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?s?(i=YC,r.appearStatus=QC):i=JC:i=t.unmountOnExit||t.mountOnEnter?XC:YC,r.state={status:i},r.nextCallback=null,r}nS(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===XC?{status:YC}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==QC&&n!==JC&&(t=QC):n!==QC&&n!==JC||(t=ZC)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===QC){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:pw.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===YC&&this.setState({status:XC})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,i=this.props.nodeRef?[r]:[pw.findDOMNode(this),r],s=i[0],o=i[1],a=this.getTimeouts(),l=r?a.appear:a.enter;!e&&!n||KC?this.safeSetState({status:JC},(function(){t.props.onEntered(s)})):(this.props.onEnter(s,o),this.safeSetState({status:QC},(function(){t.props.onEntering(s,o),t.onTransitionEnd(l,(function(){t.safeSetState({status:JC},(function(){t.props.onEntered(s,o)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:pw.findDOMNode(this);t&&!KC?(this.props.onExit(r),this.safeSetState({status:ZC},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:YC},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:YC},(function(){e.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:pw.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],s=i[0],o=i[1];this.props.addEndListener(s,o)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===XC)return null;var t=this.props,n=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,Ce.A)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return a.createElement(rS.Provider,{value:null},"function"===typeof n?n(e,r):a.cloneElement(a.Children.only(n),r))},t}(a.Component);function tE(){}eE.contextType=rS,eE.propTypes={},eE.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:tE,onEntering:tE,onEntered:tE,onExit:tE,onExiting:tE,onExited:tE},eE.UNMOUNTED=XC,eE.EXITED=YC,eE.ENTERING=QC,eE.ENTERED=JC,eE.EXITING=ZC;const nE=eE;function rE(){const e=Fe(qw);return e[bt]||e}const iE=e=>e.scrollTop;function sE(e,t){var n,r;const{timeout:i,easing:s,style:o={}}=e;return{duration:null!=(n=o.transitionDuration)?n:"number"===typeof i?i:i[t.mode]||0,easing:null!=(r=o.transitionTimingFunction)?r:"object"===typeof s?s[t.mode]:s,delay:o.transitionDelay}}const oE=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function aE(e){return`scale(${e}, ${e**2})`}const lE={entering:{opacity:1,transform:aE(1)},entered:{opacity:1,transform:"none"}},uE="undefined"!==typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),cE=a.forwardRef((function(e,t){const{addEndListener:n,appear:r=!0,children:i,easing:s,in:o,onEnter:l,onEntered:u,onEntering:c,onExit:h,onExited:d,onExiting:p,style:f,timeout:m="auto",TransitionComponent:g=nE}=e,v=(0,Ce.A)(e,oE),y=jk(),b=a.useRef(),x=rE(),w=a.useRef(null),k=Lk(w,IC(i),t),S=e=>t=>{if(e){const n=w.current;void 0===t?e(n):e(n,t)}},I=S(c),C=S(((e,t)=>{iE(e);const{duration:n,delay:r,easing:i}=sE({style:f,timeout:m,easing:s},{mode:"enter"});let o;"auto"===m?(o=x.transitions.getAutoHeightDuration(e.clientHeight),b.current=o):o=n,e.style.transition=[x.transitions.create("opacity",{duration:o,delay:r}),x.transitions.create("transform",{duration:uE?o:.666*o,delay:r,easing:i})].join(","),l&&l(e,t)})),E=S(u),T=S(p),N=S((e=>{const{duration:t,delay:n,easing:r}=sE({style:f,timeout:m,easing:s},{mode:"exit"});let i;"auto"===m?(i=x.transitions.getAutoHeightDuration(e.clientHeight),b.current=i):i=t,e.style.transition=[x.transitions.create("opacity",{duration:i,delay:n}),x.transitions.create("transform",{duration:uE?i:.666*i,delay:uE?n:n||.333*i,easing:r})].join(","),e.style.opacity=0,e.style.transform=aE(.75),h&&h(e)})),A=S(d);return(0,Me.jsx)(g,(0,Ie.A)({appear:r,in:o,nodeRef:w,onEnter:C,onEntered:E,onEntering:I,onExit:N,onExited:A,onExiting:T,addEndListener:e=>{"auto"===m&&y.start(b.current||0,e),n&&n(w.current,e)},timeout:"auto"===m?null:m},v,{children:(e,t)=>a.cloneElement(i,(0,Ie.A)({style:(0,Ie.A)({opacity:0,transform:aE(.75),visibility:"exited"!==e||o?void 0:"hidden"},lE[e],f,i.props.style),ref:k},t))}))}));cE.muiSupportAuto=!0;const hE=cE,dE=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function pE(e){const t=[],n=[];return Array.from(e.querySelectorAll(dE)).forEach(((e,r)=>{const i=function(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?"true"===e.contentEditable||("AUDIO"===e.nodeName||"VIDEO"===e.nodeName||"DETAILS"===e.nodeName)&&null===e.getAttribute("tabindex")?0:e.tabIndex:t}(e);-1!==i&&function(e){return!(e.disabled||"INPUT"===e.tagName&&"hidden"===e.type||function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return!1;if(!e.name)return!1;const t=t=>e.ownerDocument.querySelector(`input[type="radio"]${t}`);let n=t(`[name="${e.name}"]:checked`);return n||(n=t(`[name="${e.name}"]`)),n!==e}(e))}(e)&&(0===i?t.push(e):n.push({documentOrder:r,tabIndex:i,node:e}))})),n.sort(((e,t)=>e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex)).map((e=>e.node)).concat(t)}function fE(){return!0}const mE=function(e){const{children:t,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:i=!1,getTabbable:s=pE,isEnabled:o=fE,open:l}=e,u=a.useRef(!1),c=a.useRef(null),h=a.useRef(null),d=a.useRef(null),p=a.useRef(null),f=a.useRef(!1),m=a.useRef(null),g=Ik(IC(t),m),v=a.useRef(null);a.useEffect((()=>{l&&m.current&&(f.current=!n)}),[n,l]),a.useEffect((()=>{if(!l||!m.current)return;const e=rI(m.current);return m.current.contains(e.activeElement)||(m.current.hasAttribute("tabIndex")||m.current.setAttribute("tabIndex","-1"),f.current&&m.current.focus()),()=>{i||(d.current&&d.current.focus&&(u.current=!0,d.current.focus()),d.current=null)}}),[l]),a.useEffect((()=>{if(!l||!m.current)return;const e=rI(m.current),t=t=>{v.current=t,!r&&o()&&"Tab"===t.key&&e.activeElement===m.current&&t.shiftKey&&(u.current=!0,h.current&&h.current.focus())},n=()=>{const t=m.current;if(null===t)return;if(!e.hasFocus()||!o()||u.current)return void(u.current=!1);if(t.contains(e.activeElement))return;if(r&&e.activeElement!==c.current&&e.activeElement!==h.current)return;if(e.activeElement!==p.current)p.current=null;else if(null!==p.current)return;if(!f.current)return;let n=[];if(e.activeElement!==c.current&&e.activeElement!==h.current||(n=s(m.current)),n.length>0){var i,a;const e=Boolean((null==(i=v.current)?void 0:i.shiftKey)&&"Tab"===(null==(a=v.current)?void 0:a.key)),t=n[0],r=n[n.length-1];"string"!==typeof t&&"string"!==typeof r&&(e?r.focus():t.focus())}else t.focus()};e.addEventListener("focusin",n),e.addEventListener("keydown",t,!0);const i=setInterval((()=>{e.activeElement&&"BODY"===e.activeElement.tagName&&n()}),50);return()=>{clearInterval(i),e.removeEventListener("focusin",n),e.removeEventListener("keydown",t,!0)}}),[n,r,i,o,l,s]);const y=e=>{null===d.current&&(d.current=e.relatedTarget),f.current=!0};return(0,Me.jsxs)(a.Fragment,{children:[(0,Me.jsx)("div",{tabIndex:l?0:-1,onFocus:y,ref:c,"data-testid":"sentinelStart"}),a.cloneElement(t,{ref:g,onFocus:e=>{null===d.current&&(d.current=e.relatedTarget),f.current=!0,p.current=e.target;const n=t.props.onFocus;n&&n(e)}}),(0,Me.jsx)("div",{tabIndex:l?0:-1,onFocus:y,ref:h,"data-testid":"sentinelEnd"})]})};const gE=a.forwardRef((function(e,t){const{children:n,container:r,disablePortal:i=!1}=e,[s,o]=a.useState(null),l=Ik(a.isValidElement(n)?IC(n):null,t);if(Pk((()=>{i||o(function(e){return"function"===typeof e?e():e}(r)||document.body)}),[r,i]),Pk((()=>{if(s&&!i)return Sk(t,s),()=>{Sk(t,null)}}),[t,s,i]),i){if(a.isValidElement(n)){const e={ref:l};return a.cloneElement(n,e)}return(0,Me.jsx)(a.Fragment,{children:n})}return(0,Me.jsx)(a.Fragment,{children:s?pw.createPortal(n,s):s})})),vE=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],yE={entering:{opacity:1},entered:{opacity:1}},bE=a.forwardRef((function(e,t){const n=rE(),r={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:i,appear:s=!0,children:o,easing:l,in:u,onEnter:c,onEntered:h,onEntering:d,onExit:p,onExited:f,onExiting:m,style:g,timeout:v=r,TransitionComponent:y=nE}=e,b=(0,Ce.A)(e,vE),x=a.useRef(null),w=Lk(x,IC(o),t),k=e=>t=>{if(e){const n=x.current;void 0===t?e(n):e(n,t)}},S=k(d),I=k(((e,t)=>{iE(e);const r=sE({style:g,timeout:v,easing:l},{mode:"enter"});e.style.webkitTransition=n.transitions.create("opacity",r),e.style.transition=n.transitions.create("opacity",r),c&&c(e,t)})),C=k(h),E=k(m),T=k((e=>{const t=sE({style:g,timeout:v,easing:l},{mode:"exit"});e.style.webkitTransition=n.transitions.create("opacity",t),e.style.transition=n.transitions.create("opacity",t),p&&p(e)})),N=k(f);return(0,Me.jsx)(y,(0,Ie.A)({appear:s,in:u,nodeRef:x,onEnter:I,onEntered:C,onEntering:S,onExit:T,onExited:N,onExiting:E,addEndListener:e=>{i&&i(x.current,e)},timeout:v},b,{children:(e,t)=>a.cloneElement(o,(0,Ie.A)({style:(0,Ie.A)({opacity:0,visibility:"exited"!==e||u?void 0:"hidden"},yE[e],g,o.props.style),ref:w},t))}))})),xE=bE;function wE(e){return wt("MuiBackdrop",e)}kt("MuiBackdrop",["root","invisible"]);const kE=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],SE=Yw("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.invisible&&t.invisible]}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})})),IE=a.forwardRef((function(e,t){var n,r,i;const s=ek({props:e,name:"MuiBackdrop"}),{children:o,className:a,component:l="div",components:u={},componentsProps:c={},invisible:h=!1,open:d,slotProps:p={},slots:f={},TransitionComponent:m=xE,transitionDuration:g}=s,v=(0,Ce.A)(s,kE),y=(0,Ie.A)({},s,{component:l,invisible:h}),b=(e=>{const{classes:t,invisible:n}=e;return Tw({root:["root",n&&"invisible"]},wE,t)})(y),x=null!=(n=p.root)?n:c.root;return(0,Me.jsx)(m,(0,Ie.A)({in:d,timeout:g},v,{children:(0,Me.jsx)(SE,(0,Ie.A)({"aria-hidden":!0},x,{as:null!=(r=null!=(i=f.root)?i:u.Root)?r:l,className:Te(b.root,a,null==x?void 0:x.className),ownerState:(0,Ie.A)({},y,null==x?void 0:x.ownerState),classes:b,ref:t,children:o}))}))}));function CE(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>null==t?e:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r),t.apply(this,r)}),(()=>{}))}function EE(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function TE(e){return parseInt(iI(e).getComputedStyle(e).paddingRight,10)||0}function NE(e,t,n,r,i){const s=[t,n,...r];[].forEach.call(e.children,(e=>{const t=-1===s.indexOf(e),n=!function(e){const t=-1!==["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName),n="INPUT"===e.tagName&&"hidden"===e.getAttribute("type");return t||n}(e);t&&n&&EE(e,i)}))}function AE(e,t){let n=-1;return e.some(((e,r)=>!!t(e)&&(n=r,!0))),n}function RE(e,t){const n=[],r=e.container;if(!t.disableScrollLock){if(function(e){const t=rI(e);return t.body===e?iI(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(r)){const e=LC(rI(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${TE(r)+e}px`;const t=rI(r).querySelectorAll(".mui-fixed");[].forEach.call(t,(t=>{n.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight=`${TE(t)+e}px`}))}let e;if(r.parentNode instanceof DocumentFragment)e=rI(r).body;else{const t=r.parentElement,n=iI(r);e="HTML"===(null==t?void 0:t.nodeName)&&"scroll"===n.getComputedStyle(t).overflowY?t:r}n.push({value:e.style.overflow,property:"overflow",el:e},{value:e.style.overflowX,property:"overflow-x",el:e},{value:e.style.overflowY,property:"overflow-y",el:e}),e.style.overflow="hidden"}return()=>{n.forEach((e=>{let{value:t,el:n,property:r}=e;t?n.style.setProperty(r,t):n.style.removeProperty(r)}))}}const $E=new class{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,t){let n=this.modals.indexOf(e);if(-1!==n)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&EE(e.modalRef,!1);const r=function(e){const t=[];return[].forEach.call(e.children,(e=>{"true"===e.getAttribute("aria-hidden")&&t.push(e)})),t}(t);NE(t,e.mount,e.modalRef,r,!0);const i=AE(this.containers,(e=>e.container===t));return-1!==i?(this.containers[i].modals.push(e),n):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblings:r}),n)}mount(e,t){const n=AE(this.containers,(t=>-1!==t.modals.indexOf(e))),r=this.containers[n];r.restore||(r.restore=RE(r,t))}remove(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.modals.indexOf(e);if(-1===n)return n;const r=AE(this.containers,(t=>-1!==t.modals.indexOf(e))),i=this.containers[r];if(i.modals.splice(i.modals.indexOf(e),1),this.modals.splice(n,1),0===i.modals.length)i.restore&&i.restore(),e.modalRef&&EE(e.modalRef,t),NE(i.container,e.mount,e.modalRef,i.hiddenSiblings,!1),this.containers.splice(r,1);else{const e=i.modals[i.modals.length-1];e.modalRef&&EE(e.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}};const _E=function(e){const{container:t,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:i=$E,closeAfterTransition:s=!1,onTransitionEnter:o,onTransitionExited:l,children:u,onClose:c,open:h,rootRef:d}=e,p=a.useRef({}),f=a.useRef(null),m=a.useRef(null),g=Ik(m,d),[v,y]=a.useState(!h),b=function(e){return!!e&&e.props.hasOwnProperty("in")}(u);let x=!0;"false"!==e["aria-hidden"]&&!1!==e["aria-hidden"]||(x=!1);const w=()=>(p.current.modalRef=m.current,p.current.mount=f.current,p.current),k=()=>{i.mount(w(),{disableScrollLock:r}),m.current&&(m.current.scrollTop=0)},S=zk((()=>{const e=function(e){return"function"===typeof e?e():e}(t)||rI(f.current).body;i.add(w(),e),m.current&&k()})),I=a.useCallback((()=>i.isTopModal(w())),[i]),C=zk((e=>{f.current=e,e&&(h&&I()?k():m.current&&EE(m.current,x))})),E=a.useCallback((()=>{i.remove(w(),x)}),[x,i]);a.useEffect((()=>()=>{E()}),[E]),a.useEffect((()=>{h?S():b&&s||E()}),[h,E,b,s,S]);const T=e=>t=>{var r;null==(r=e.onKeyDown)||r.call(e,t),"Escape"===t.key&&229!==t.which&&I()&&(n||(t.stopPropagation(),c&&c(t,"escapeKeyDown")))},N=e=>t=>{var n;null==(n=e.onClick)||n.call(e,t),t.target===t.currentTarget&&c&&c(t,"backdropClick")};return{getRootProps:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=Nk(e);delete n.onTransitionEnter,delete n.onTransitionExited;const r=(0,Ie.A)({},n,t);return(0,Ie.A)({role:"presentation"},r,{onKeyDown:T(r),ref:g})},getBackdropProps:function(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,Ie.A)({"aria-hidden":!0},e,{onClick:N(e),open:h})},getTransitionProps:()=>({onEnter:CE((()=>{y(!1),o&&o()}),null==u?void 0:u.props.onEnter),onExited:CE((()=>{y(!0),l&&l(),s&&E()}),null==u?void 0:u.props.onExited)}),rootRef:g,portalRef:C,isTopModal:I,exited:v,hasTransition:b}};function OE(e){return wt("MuiModal",e)}kt("MuiModal",["root","hidden","backdrop"]);const DE=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],FE=Yw("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.open&&n.exited&&t.hidden]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!n.open&&n.exited&&{visibility:"hidden"})})),ME=Yw(IE,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),LE=a.forwardRef((function(e,t){var n,r,i,s,o,l;const u=ek({name:"MuiModal",props:e}),{BackdropComponent:c=ME,BackdropProps:h,className:d,closeAfterTransition:p=!1,children:f,container:m,component:g,components:v={},componentsProps:y={},disableAutoFocus:b=!1,disableEnforceFocus:x=!1,disableEscapeKeyDown:w=!1,disablePortal:k=!1,disableRestoreFocus:S=!1,disableScrollLock:I=!1,hideBackdrop:C=!1,keepMounted:E=!1,onBackdropClick:T,open:N,slotProps:A,slots:R}=u,$=(0,Ce.A)(u,DE),_=(0,Ie.A)({},u,{closeAfterTransition:p,disableAutoFocus:b,disableEnforceFocus:x,disableEscapeKeyDown:w,disablePortal:k,disableRestoreFocus:S,disableScrollLock:I,hideBackdrop:C,keepMounted:E}),{getRootProps:O,getBackdropProps:D,getTransitionProps:F,portalRef:M,isTopModal:L,exited:P,hasTransition:z}=_E((0,Ie.A)({},_,{rootRef:t})),B=(0,Ie.A)({},_,{exited:P}),U=(e=>{const{open:t,exited:n,classes:r}=e;return Tw({root:["root",!t&&n&&"hidden"],backdrop:["backdrop"]},OE,r)})(B),W={};if(void 0===f.props.tabIndex&&(W.tabIndex="-1"),z){const{onEnter:e,onExited:t}=F();W.onEnter=e,W.onExited=t}const V=null!=(n=null!=(r=null==R?void 0:R.root)?r:v.Root)?n:FE,j=null!=(i=null!=(s=null==R?void 0:R.backdrop)?s:v.Backdrop)?i:c,G=null!=(o=null==A?void 0:A.root)?o:y.root,H=null!=(l=null==A?void 0:A.backdrop)?l:y.backdrop,q=$C({elementType:V,externalSlotProps:G,externalForwardedProps:$,getSlotProps:O,additionalProps:{ref:t,as:g},ownerState:B,className:Te(d,null==G?void 0:G.className,null==U?void 0:U.root,!B.open&&B.exited&&(null==U?void 0:U.hidden))}),K=$C({elementType:j,externalSlotProps:H,additionalProps:h,getSlotProps:e=>D((0,Ie.A)({},e,{onClick:t=>{T&&T(t),null!=e&&e.onClick&&e.onClick(t)}})),className:Te(null==H?void 0:H.className,null==h?void 0:h.className,null==U?void 0:U.backdrop),ownerState:B});return E||N||z&&!P?(0,Me.jsx)(gE,{ref:M,container:m,disablePortal:k,children:(0,Me.jsxs)(V,(0,Ie.A)({},q,{children:[!C&&c?(0,Me.jsx)(j,(0,Ie.A)({},K)):null,(0,Me.jsx)(mE,{disableEnforceFocus:x,disableAutoFocus:b,disableRestoreFocus:S,isEnabled:L,open:N,children:a.cloneElement(f,W)})]}))}):null}));function PE(e){return wt("MuiPopover",e)}kt("MuiPopover",["root","paper"]);const zE=["onEntering"],BE=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],UE=["slotProps"];function WE(e,t){let n=0;return"number"===typeof t?n=t:"center"===t?n=e.height/2:"bottom"===t&&(n=e.height),n}function VE(e,t){let n=0;return"number"===typeof t?n=t:"center"===t?n=e.width/2:"right"===t&&(n=e.width),n}function jE(e){return[e.horizontal,e.vertical].map((e=>"number"===typeof e?`${e}px`:e)).join(" ")}function GE(e){return"function"===typeof e?e():e}const HE=Yw(LE,{name:"MuiPopover",slot:"Root",overridesResolver:(e,t)=>t.root})({}),qE=Yw(fk,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,t)=>t.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),KE=a.forwardRef((function(e,t){var n,r,i;const s=ek({props:e,name:"MuiPopover"}),{action:o,anchorEl:l,anchorOrigin:u={vertical:"top",horizontal:"left"},anchorPosition:c,anchorReference:h="anchorEl",children:d,className:p,container:f,elevation:m=8,marginThreshold:g=16,open:v,PaperProps:y={},slots:b,slotProps:x,transformOrigin:w={vertical:"top",horizontal:"left"},TransitionComponent:k=hE,transitionDuration:S="auto",TransitionProps:{onEntering:I}={},disableScrollLock:C=!1}=s,E=(0,Ce.A)(s.TransitionProps,zE),T=(0,Ce.A)(s,BE),N=null!=(n=null==x?void 0:x.paper)?n:y,A=a.useRef(),R=Lk(A,N.ref),$=(0,Ie.A)({},s,{anchorOrigin:u,anchorReference:h,elevation:m,marginThreshold:g,externalPaperSlotProps:N,transformOrigin:w,TransitionComponent:k,transitionDuration:S,TransitionProps:E}),_=(e=>{const{classes:t}=e;return Tw({root:["root"],paper:["paper"]},PE,t)})($),O=a.useCallback((()=>{if("anchorPosition"===h)return c;const e=GE(l),t=(e&&1===e.nodeType?e:CC(A.current).body).getBoundingClientRect();return{top:t.top+WE(t,u.vertical),left:t.left+VE(t,u.horizontal)}}),[l,u.horizontal,u.vertical,c,h]),D=a.useCallback((e=>({vertical:WE(e,w.vertical),horizontal:VE(e,w.horizontal)})),[w.horizontal,w.vertical]),F=a.useCallback((e=>{const t={width:e.offsetWidth,height:e.offsetHeight},n=D(t);if("none"===h)return{top:null,left:null,transformOrigin:jE(n)};const r=O();let i=r.top-n.vertical,s=r.left-n.horizontal;const o=i+t.height,a=s+t.width,u=qC(GE(l)),c=u.innerHeight-g,d=u.innerWidth-g;if(null!==g&&i<g){const e=i-g;i-=e,n.vertical+=e}else if(null!==g&&o>c){const e=o-c;i-=e,n.vertical+=e}if(null!==g&&s<g){const e=s-g;s-=e,n.horizontal+=e}else if(a>d){const e=a-d;s-=e,n.horizontal+=e}return{top:`${Math.round(i)}px`,left:`${Math.round(s)}px`,transformOrigin:jE(n)}}),[l,h,O,D,g]),[M,L]=a.useState(v),P=a.useCallback((()=>{const e=A.current;if(!e)return;const t=F(e);null!==t.top&&(e.style.top=t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin,L(!0)}),[F]);a.useEffect((()=>(C&&window.addEventListener("scroll",P),()=>window.removeEventListener("scroll",P))),[l,C,P]);a.useEffect((()=>{v&&P()})),a.useImperativeHandle(o,(()=>v?{updatePosition:()=>{P()}}:null),[v,P]),a.useEffect((()=>{if(!v)return;const e=HC((()=>{P()})),t=qC(l);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}}),[l,v,P]);let z=S;"auto"!==S||k.muiSupportAuto||(z=void 0);const B=f||(l?CC(GE(l)).body:void 0),U=null!=(r=null==b?void 0:b.root)?r:HE,W=null!=(i=null==b?void 0:b.paper)?i:qE,V=$C({elementType:W,externalSlotProps:(0,Ie.A)({},N,{style:M?N.style:(0,Ie.A)({},N.style,{opacity:0})}),additionalProps:{elevation:m,ref:R},ownerState:$,className:Te(_.paper,null==N?void 0:N.className)}),j=$C({elementType:U,externalSlotProps:(null==x?void 0:x.root)||{},externalForwardedProps:T,additionalProps:{ref:t,slotProps:{backdrop:{invisible:!0}},container:B,open:v},ownerState:$,className:Te(_.root,p)}),{slotProps:G}=j,H=(0,Ce.A)(j,UE);return(0,Me.jsx)(U,(0,Ie.A)({},H,!Ck(U)&&{slotProps:G,disableScrollLock:C},{children:(0,Me.jsx)(k,(0,Ie.A)({appear:!0,in:v,onEntering:(e,t)=>{I&&I(e,t),P()},onExited:()=>{L(!1)},timeout:z},E,{children:(0,Me.jsx)(W,(0,Ie.A)({},V,{children:d}))}))}))}));function XE(e){return wt("MuiMenu",e)}kt("MuiMenu",["root","paper","list"]);const YE=["onEntering"],QE=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],JE={vertical:"top",horizontal:"right"},ZE={vertical:"top",horizontal:"left"},eT=Yw(KE,{shouldForwardProp:e=>Xw(e)||"classes"===e,name:"MuiMenu",slot:"Root",overridesResolver:(e,t)=>t.root})({}),tT=Yw(qE,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,t)=>t.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),nT=Yw(GC,{name:"MuiMenu",slot:"List",overridesResolver:(e,t)=>t.list})({outline:0}),rT=a.forwardRef((function(e,t){var n,r;const i=ek({props:e,name:"MuiMenu"}),{autoFocus:s=!0,children:o,className:l,disableAutoFocusItem:u=!1,MenuListProps:c={},onClose:h,open:d,PaperProps:p={},PopoverClasses:f,transitionDuration:m="auto",TransitionProps:{onEntering:g}={},variant:v="selectedMenu",slots:y={},slotProps:b={}}=i,x=(0,Ce.A)(i.TransitionProps,YE),w=(0,Ce.A)(i,QE),k=NC(),S=(0,Ie.A)({},i,{autoFocus:s,disableAutoFocusItem:u,MenuListProps:c,onEntering:g,PaperProps:p,transitionDuration:m,TransitionProps:x,variant:v}),I=(e=>{const{classes:t}=e;return Tw({root:["root"],paper:["paper"],list:["list"]},XE,t)})(S),C=s&&!u&&d,E=a.useRef(null);let T=-1;a.Children.map(o,((e,t)=>{a.isValidElement(e)&&(e.props.disabled||("selectedMenu"===v&&e.props.selected||-1===T)&&(T=t))}));const N=null!=(n=y.paper)?n:tT,A=null!=(r=b.paper)?r:p,R=$C({elementType:y.root,externalSlotProps:b.root,ownerState:S,className:[I.root,l]}),$=$C({elementType:N,externalSlotProps:A,ownerState:S,className:I.paper});return(0,Me.jsx)(eT,(0,Ie.A)({onClose:h,anchorOrigin:{vertical:"bottom",horizontal:k?"right":"left"},transformOrigin:k?JE:ZE,slots:{paper:N,root:y.root},slotProps:{root:R,paper:$},open:d,ref:t,transitionDuration:m,TransitionProps:(0,Ie.A)({onEntering:(e,t)=>{E.current&&E.current.adjustStyleForScrollbar(e,{direction:k?"rtl":"ltr"}),g&&g(e,t)}},x),ownerState:S},w,{classes:f,children:(0,Me.jsx)(nT,(0,Ie.A)({onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),h&&h(e,"tabKeyDown"))},actions:E,autoFocus:s&&(-1===T||u),autoFocusItem:C,variant:v},c,{className:Te(I.list,c.className),children:o}))}))})),iT=rT;function sT(e){return wt("MuiNativeSelect",e)}const oT=kt("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),aT=["className","disabled","error","IconComponent","inputRef","variant"],lT=e=>{let{ownerState:t,theme:n}=e;return(0,Ie.A)({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":(0,Ie.A)({},n.vars?{backgroundColor:`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:"light"===n.palette.mode?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${oT.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(n.vars||n).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},"filled"===t.variant&&{"&&&":{paddingRight:32}},"outlined"===t.variant&&{borderRadius:(n.vars||n).shape.borderRadius,"&:focus":{borderRadius:(n.vars||n).shape.borderRadius},"&&&":{paddingRight:32}})},uT=Yw("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Xw,overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.select,t[n.variant],n.error&&t.error,{[`&.${oT.multiple}`]:t.multiple}]}})(lT),cT=e=>{let{ownerState:t,theme:n}=e;return(0,Ie.A)({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(n.vars||n).palette.action.active,[`&.${oT.disabled}`]:{color:(n.vars||n).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},"filled"===t.variant&&{right:7},"outlined"===t.variant&&{right:7})},hT=Yw("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t[`icon${Gw(n.variant)}`],n.open&&t.iconOpen]}})(cT),dT=a.forwardRef((function(e,t){const{className:n,disabled:r,error:i,IconComponent:s,inputRef:o,variant:l="standard"}=e,u=(0,Ce.A)(e,aT),c=(0,Ie.A)({},e,{disabled:r,variant:l,error:i}),h=(e=>{const{classes:t,variant:n,disabled:r,multiple:i,open:s,error:o}=e;return Tw({select:["select",n,r&&"disabled",i&&"multiple",o&&"error"],icon:["icon",`icon${Gw(n)}`,s&&"iconOpen",r&&"disabled"]},sT,t)})(c);return(0,Me.jsxs)(a.Fragment,{children:[(0,Me.jsx)(uT,(0,Ie.A)({ownerState:c,className:Te(h.select,n),disabled:r,ref:o||t},u)),e.multiple?null:(0,Me.jsx)(hT,{as:s,ownerState:c,className:h.icon})]})})),pT=dT;function fT(e){let{controlled:t,default:n,name:r,state:i="value"}=e;const{current:s}=a.useRef(void 0!==t),[o,l]=a.useState(n);return[s?t:o,a.useCallback((e=>{s||l(e)}),[])]}const mT=fT;function gT(e){return wt("MuiSelect",e)}const vT=kt("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var yT;const bT=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],xT=Yw("div",{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`&.${vT.select}`]:t.select},{[`&.${vT.select}`]:t[n.variant]},{[`&.${vT.error}`]:t.error},{[`&.${vT.multiple}`]:t.multiple}]}})(lT,{[`&.${vT.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),wT=Yw("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t[`icon${Gw(n.variant)}`],n.open&&t.iconOpen]}})(cT),kT=Yw("input",{shouldForwardProp:e=>Kw(e)&&"classes"!==e,name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,t)=>t.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function ST(e,t){return"object"===typeof t&&null!==t?e===t:String(e)===String(t)}function IT(e){return null==e||"string"===typeof e&&!e.trim()}const CT=a.forwardRef((function(e,t){var n;const{"aria-describedby":r,"aria-label":i,autoFocus:s,autoWidth:o,children:l,className:u,defaultOpen:c,defaultValue:h,disabled:d,displayEmpty:p,error:f=!1,IconComponent:m,inputRef:g,labelId:v,MenuProps:y={},multiple:b,name:x,onBlur:w,onChange:k,onClose:S,onFocus:I,onOpen:C,open:E,readOnly:T,renderValue:N,SelectDisplayProps:A={},tabIndex:R,value:$,variant:_="standard"}=e,O=(0,Ce.A)(e,bT),[D,F]=mT({controlled:$,default:h,name:"Select"}),[M,L]=mT({controlled:E,default:c,name:"Select"}),P=a.useRef(null),z=a.useRef(null),[B,U]=a.useState(null),{current:W}=a.useRef(null!=E),[V,j]=a.useState(),G=Lk(t,g),H=a.useCallback((e=>{z.current=e,e&&U(e)}),[]),q=null==B?void 0:B.parentNode;a.useImperativeHandle(G,(()=>({focus:()=>{z.current.focus()},node:P.current,value:D})),[D]),a.useEffect((()=>{c&&M&&B&&!W&&(j(o?null:q.clientWidth),z.current.focus())}),[B,o]),a.useEffect((()=>{s&&z.current.focus()}),[s]),a.useEffect((()=>{if(!v)return;const e=CC(z.current).getElementById(v);if(e){const t=()=>{getSelection().isCollapsed&&z.current.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}}),[v]);const K=(e,t)=>{e?C&&C(t):S&&S(t),W||(j(o?null:q.clientWidth),L(e))},X=a.Children.toArray(l),Y=e=>t=>{let n;if(t.currentTarget.hasAttribute("tabindex")){if(b){n=Array.isArray(D)?D.slice():[];const t=D.indexOf(e.props.value);-1===t?n.push(e.props.value):n.splice(t,1)}else n=e.props.value;if(e.props.onClick&&e.props.onClick(t),D!==n&&(F(n),k)){const r=t.nativeEvent||t,i=new r.constructor(r.type,r);Object.defineProperty(i,"target",{writable:!0,value:{value:n,name:x}}),k(i,e)}b||K(!1,t)}},Q=null!==B&&M;let J,Z;delete O["aria-invalid"];const ee=[];let te=!1,ne=!1;(bI({value:D})||p)&&(N?J=N(D):te=!0);const re=X.map((e=>{if(!a.isValidElement(e))return null;let t;if(b){if(!Array.isArray(D))throw new Error((0,Be.A)(2));t=D.some((t=>ST(t,e.props.value))),t&&te&&ee.push(e.props.children)}else t=ST(D,e.props.value),t&&te&&(Z=e.props.children);return t&&(ne=!0),a.cloneElement(e,{"aria-selected":t?"true":"false",onClick:Y(e),onKeyUp:t=>{" "===t.key&&t.preventDefault(),e.props.onKeyUp&&e.props.onKeyUp(t)},role:"option",selected:t,value:void 0,"data-value":e.props.value})}));te&&(J=b?0===ee.length?null:ee.reduce(((e,t,n)=>(e.push(t),n<ee.length-1&&e.push(", "),e)),[]):Z);let ie,se=V;!o&&W&&B&&(se=q.clientWidth),ie="undefined"!==typeof R?R:d?null:0;const oe=A.id||(x?`mui-component-select-${x}`:void 0),ae=(0,Ie.A)({},e,{variant:_,value:D,open:Q,error:f}),le=(e=>{const{classes:t,variant:n,disabled:r,multiple:i,open:s,error:o}=e;return Tw({select:["select",n,r&&"disabled",i&&"multiple",o&&"error"],icon:["icon",`icon${Gw(n)}`,s&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]},gT,t)})(ae),ue=(0,Ie.A)({},y.PaperProps,null==(n=y.slotProps)?void 0:n.paper),ce=nI();return(0,Me.jsxs)(a.Fragment,{children:[(0,Me.jsx)(xT,(0,Ie.A)({ref:H,tabIndex:ie,role:"combobox","aria-controls":ce,"aria-disabled":d?"true":void 0,"aria-expanded":Q?"true":"false","aria-haspopup":"listbox","aria-label":i,"aria-labelledby":[v,oe].filter(Boolean).join(" ")||void 0,"aria-describedby":r,onKeyDown:e=>{if(!T){-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),K(!0,e))}},onMouseDown:d||T?null:e=>{0===e.button&&(e.preventDefault(),z.current.focus(),K(!0,e))},onBlur:e=>{!Q&&w&&(Object.defineProperty(e,"target",{writable:!0,value:{value:D,name:x}}),w(e))},onFocus:I},A,{ownerState:ae,className:Te(A.className,le.select,u),id:oe,children:IT(J)?yT||(yT=(0,Me.jsx)("span",{className:"notranslate",children:"\u200b"})):J})),(0,Me.jsx)(kT,(0,Ie.A)({"aria-invalid":f,value:Array.isArray(D)?D.join(","):D,name:x,ref:P,"aria-hidden":!0,onChange:e=>{const t=X.find((t=>t.props.value===e.target.value));void 0!==t&&(F(t.props.value),k&&k(e,t))},tabIndex:-1,disabled:d,className:le.nativeInput,autoFocus:s,ownerState:ae},O)),(0,Me.jsx)(wT,{as:m,className:le.icon,ownerState:ae}),(0,Me.jsx)(iT,(0,Ie.A)({id:`menu-${x||""}`,anchorEl:q,open:Q,onClose:e=>{K(!1,e)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},y,{MenuListProps:(0,Ie.A)({"aria-labelledby":v,role:"listbox","aria-multiselectable":b?"true":void 0,disableListWrap:!0,id:ce},y.MenuListProps),slotProps:(0,Ie.A)({},y.slotProps,{paper:(0,Ie.A)({},ue,{style:(0,Ie.A)({minWidth:se},null!=ue?ue.style:null)})}),children:re}))]})})),ET=CT,TT=BS((0,Me.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),NT=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],AT=["root"],RT={name:"MuiSelect",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>Xw(e)&&"variant"!==e,slot:"Root"},$T=Yw(FI,RT)(""),_T=Yw(eC,RT)(""),OT=Yw(WI,RT)(""),DT=a.forwardRef((function(e,t){const n=ek({name:"MuiSelect",props:e}),{autoWidth:r=!1,children:i,classes:s={},className:o,defaultOpen:l=!1,displayEmpty:u=!1,IconComponent:c=TT,id:h,input:d,inputProps:p,label:f,labelId:m,MenuProps:g,multiple:v=!1,native:y=!1,onClose:b,onOpen:x,open:w,renderValue:k,SelectDisplayProps:S,variant:I="outlined"}=n,C=(0,Ce.A)(n,NT),E=y?pT:ET,T=hI({props:n,muiFormControl:pI(),states:["variant","error"]}),N=T.variant||I,A=(0,Ie.A)({},n,{variant:N,classes:s}),R=(e=>{const{classes:t}=e;return t})(A),$=(0,Ce.A)(R,AT),_=d||{standard:(0,Me.jsx)($T,{ownerState:A}),outlined:(0,Me.jsx)(_T,{label:f,ownerState:A}),filled:(0,Me.jsx)(OT,{ownerState:A})}[N],O=Lk(t,IC(_));return(0,Me.jsx)(a.Fragment,{children:a.cloneElement(_,(0,Ie.A)({inputComponent:E,inputProps:(0,Ie.A)({children:i,error:T.error,IconComponent:c,variant:N,type:void 0,multiple:v},y?{id:h}:{autoWidth:r,defaultOpen:l,displayEmpty:u,labelId:m,MenuProps:g,onClose:b,onOpen:x,open:w,renderValue:k,SelectDisplayProps:(0,Ie.A)({id:h},S)},p,{classes:p?(0,Ue.A)($,p.classes):$},d?d.props.inputProps:{})},(v&&y||u)&&"outlined"===N?{notched:!0}:{},{ref:O,className:Te(_.props.className,o,R.root)},!d&&{variant:N},C))})}));DT.muiName="Select";const FT=DT;function MT(e){return wt("MuiTextField",e)}kt("MuiTextField",["root"]);const LT=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],PT={standard:FI,filled:WI,outlined:eC},zT=Yw(vC,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),BT=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiTextField"}),{autoComplete:r,autoFocus:i=!1,children:s,className:o,color:a="primary",defaultValue:l,disabled:u=!1,error:c=!1,FormHelperTextProps:h,fullWidth:d=!1,helperText:p,id:f,InputLabelProps:m,inputProps:g,InputProps:v,inputRef:y,label:b,maxRows:x,minRows:w,multiline:k=!1,name:S,onBlur:I,onChange:C,onFocus:E,placeholder:T,required:N=!1,rows:A,select:R=!1,SelectProps:$,type:_,value:O,variant:D="outlined"}=n,F=(0,Ce.A)(n,LT),M=(0,Ie.A)({},n,{autoFocus:i,color:a,disabled:u,error:c,fullWidth:d,multiline:k,required:N,select:R,variant:D}),L=(e=>{const{classes:t}=e;return Tw({root:["root"]},MT,t)})(M);const P={};"outlined"===D&&(m&&"undefined"!==typeof m.shrink&&(P.notched=m.shrink),P.label=b),R&&($&&$.native||(P.id=void 0),P["aria-describedby"]=void 0);const z=nI(f),B=p&&z?`${z}-helper-text`:void 0,U=b&&z?`${z}-label`:void 0,W=PT[D],V=(0,Me.jsx)(W,(0,Ie.A)({"aria-describedby":B,autoComplete:r,autoFocus:i,defaultValue:l,fullWidth:d,multiline:k,name:S,rows:A,maxRows:x,minRows:w,type:_,value:O,id:z,inputRef:y,onBlur:I,onChange:C,onFocus:E,placeholder:T,inputProps:g},P,v));return(0,Me.jsxs)(zT,(0,Ie.A)({className:Te(L.root,o),disabled:u,error:c,fullWidth:d,ref:t,required:N,color:a,variant:D,ownerState:M},F,{children:[null!=b&&""!==b&&(0,Me.jsx)(hC,(0,Ie.A)({htmlFor:z,id:U},m,{children:b})),R?(0,Me.jsx)(FT,(0,Ie.A)({"aria-describedby":B,id:z,labelId:U,value:O,input:V},$,{children:s})):V,p&&(0,Me.jsx)(SC,(0,Ie.A)({id:B},h,{children:p}))]}))})),UT=BT;var WT=n(9751),VT=n(8604);const jT=["component","direction","spacing","divider","children","className","useFlexGap"],GT=(0,$e.A)(),HT=Bw("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root});function qT(e){return Rw({props:e,name:"MuiStack",defaultTheme:GT})}function KT(e,t){const n=a.Children.toArray(e).filter(Boolean);return n.reduce(((e,r,i)=>(e.push(r),i<n.length-1&&e.push(a.cloneElement(t,{key:`separator-${i}`})),e)),[])}const XT=e=>{let{ownerState:t,theme:n}=e,r=(0,Ie.A)({display:"flex",flexDirection:"column"},(0,WT.NI)({theme:n},(0,WT.kW)({values:t.direction,breakpoints:n.breakpoints.values}),(e=>({flexDirection:e}))));if(t.spacing){const e=(0,VT.LX)(n),i=Object.keys(n.breakpoints.values).reduce(((e,n)=>(("object"===typeof t.spacing&&null!=t.spacing[n]||"object"===typeof t.direction&&null!=t.direction[n])&&(e[n]=!0),e)),{}),s=(0,WT.kW)({values:t.direction,base:i}),o=(0,WT.kW)({values:t.spacing,base:i});"object"===typeof s&&Object.keys(s).forEach(((e,t,n)=>{if(!s[e]){const r=t>0?s[n[t-1]]:"column";s[e]=r}}));const a=(n,r)=>{return t.useFlexGap?{gap:(0,VT._W)(e,n)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${i=r?s[r]:t.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[i]}`]:(0,VT._W)(e,n)}};var i};r=(0,Ue.A)(r,(0,WT.NI)({theme:n},o,a))}return r=(0,WT.iZ)(n.breakpoints,r),r};const YT=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:t=HT,useThemeProps:n=qT,componentName:r="MuiStack"}=e,i=t(XT);return a.forwardRef((function(e,t){const s=n(e),o=(0,Re.A)(s),{component:a="div",direction:l="column",spacing:u=0,divider:c,children:h,className:d,useFlexGap:p=!1}=o,f=(0,Ce.A)(o,jT),m={direction:l,spacing:u,useFlexGap:p},g=Tw({root:["root"]},(e=>wt(r,e)),{});return(0,Me.jsx)(i,(0,Ie.A)({as:a,ownerState:m,ref:t,className:Te(g.root,d)},f,{children:c?KT(h,c):h}))}))}({createStyledComponent:Yw("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root}),useThemeProps:e=>ek({props:e,name:"MuiStack"})});function QT(e){return wt("MuiFormControlLabel",e)}const JT=kt("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),ZT=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],eN=Yw("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${JT.label}`]:t.label},t.root,t[`labelPlacement${Gw(n.labelPlacement)}`]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${JT.disabled}`]:{cursor:"default"}},"start"===n.labelPlacement&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},"top"===n.labelPlacement&&{flexDirection:"column-reverse",marginLeft:16},"bottom"===n.labelPlacement&&{flexDirection:"column",marginLeft:16},{[`& .${JT.label}`]:{[`&.${JT.disabled}`]:{color:(t.vars||t).palette.text.disabled}}})})),tN=Yw("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((e=>{let{theme:t}=e;return{[`&.${JT.error}`]:{color:(t.vars||t).palette.error.main}}})),nN=a.forwardRef((function(e,t){var n,r;const i=ek({props:e,name:"MuiFormControlLabel"}),{className:s,componentsProps:o={},control:l,disabled:u,disableTypography:c,label:h,labelPlacement:d="end",required:p,slotProps:f={}}=i,m=(0,Ce.A)(i,ZT),g=pI(),v=null!=(n=null!=u?u:l.props.disabled)?n:null==g?void 0:g.disabled,y=null!=p?p:l.props.required,b={disabled:v,required:y};["checked","name","onChange","value","inputRef"].forEach((e=>{"undefined"===typeof l.props[e]&&"undefined"!==typeof i[e]&&(b[e]=i[e])}));const x=hI({props:i,muiFormControl:g,states:["error"]}),w=(0,Ie.A)({},i,{disabled:v,labelPlacement:d,required:y,error:x.error}),k=(e=>{const{classes:t,disabled:n,labelPlacement:r,error:i,required:s}=e;return Tw({root:["root",n&&"disabled",`labelPlacement${Gw(r)}`,i&&"error",s&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",i&&"error"]},QT,t)})(w),S=null!=(r=f.typography)?r:o.typography;let I=h;return null==I||I.type===lk||c||(I=(0,Me.jsx)(lk,(0,Ie.A)({component:"span"},S,{className:Te(k.label,null==S?void 0:S.className),children:I}))),(0,Me.jsxs)(eN,(0,Ie.A)({className:Te(k.root,s),ownerState:w,ref:t},m,{children:[a.cloneElement(l,b),y?(0,Me.jsxs)(YT,{display:"block",children:[I,(0,Me.jsxs)(tN,{ownerState:w,"aria-hidden":!0,className:k.asterisk,children:["\u2009","*"]})]}):I]}))}));function rN(e){return wt("PrivateSwitchBase",e)}kt("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const iN=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],sN=Yw(AS)((e=>{let{ownerState:t}=e;return(0,Ie.A)({padding:9,borderRadius:"50%"},"start"===t.edge&&{marginLeft:"small"===t.size?-3:-12},"end"===t.edge&&{marginRight:"small"===t.size?-3:-12})})),oN=Yw("input",{shouldForwardProp:Xw})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),aN=a.forwardRef((function(e,t){const{autoFocus:n,checked:r,checkedIcon:i,className:s,defaultChecked:o,disabled:a,disableFocusRipple:l=!1,edge:u=!1,icon:c,id:h,inputProps:d,inputRef:p,name:f,onBlur:m,onChange:g,onFocus:v,readOnly:y,required:b=!1,tabIndex:x,type:w,value:k}=e,S=(0,Ce.A)(e,iN),[I,C]=mT({controlled:r,default:Boolean(o),name:"SwitchBase",state:"checked"}),E=pI();let T=a;E&&"undefined"===typeof T&&(T=E.disabled);const N="checkbox"===w||"radio"===w,A=(0,Ie.A)({},e,{checked:I,disabled:T,disableFocusRipple:l,edge:u}),R=(e=>{const{classes:t,checked:n,disabled:r,edge:i}=e;return Tw({root:["root",n&&"checked",r&&"disabled",i&&`edge${Gw(i)}`],input:["input"]},rN,t)})(A);return(0,Me.jsxs)(sN,(0,Ie.A)({component:"span",className:Te(R.root,s),centerRipple:!0,focusRipple:!l,disabled:T,tabIndex:null,role:void 0,onFocus:e=>{v&&v(e),E&&E.onFocus&&E.onFocus(e)},onBlur:e=>{m&&m(e),E&&E.onBlur&&E.onBlur(e)},ownerState:A,ref:t},S,{children:[(0,Me.jsx)(oN,(0,Ie.A)({autoFocus:n,checked:r,defaultChecked:o,className:R.input,disabled:T,id:N?h:void 0,name:f,onChange:e=>{if(e.nativeEvent.defaultPrevented)return;const t=e.target.checked;C(t),g&&g(e,t)},readOnly:y,ref:p,required:b,ownerState:A,tabIndex:x,type:w},"checkbox"===w&&void 0===k?{}:{value:k},d)),I?i:c]}))})),lN=BS((0,Me.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),uN=BS((0,Me.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),cN=BS((0,Me.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function hN(e){return wt("MuiCheckbox",e)}const dN=kt("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),pN=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],fN=Yw(aN,{shouldForwardProp:e=>Xw(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.indeterminate&&t.indeterminate,t[`size${Gw(n.size)}`],"default"!==n.color&&t[`color${Gw(n.color)}`]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({color:(t.vars||t).palette.text.secondary},!n.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${"default"===n.color?t.vars.palette.action.activeChannel:t.vars.palette[n.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,Ve.X4)("default"===n.color?t.palette.action.active:t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==n.color&&{[`&.${dN.checked}, &.${dN.indeterminate}`]:{color:(t.vars||t).palette[n.color].main},[`&.${dN.disabled}`]:{color:(t.vars||t).palette.action.disabled}})})),mN=(0,Me.jsx)(uN,{}),gN=(0,Me.jsx)(lN,{}),vN=(0,Me.jsx)(cN,{}),yN=a.forwardRef((function(e,t){var n,r;const i=ek({props:e,name:"MuiCheckbox"}),{checkedIcon:s=mN,color:o="primary",icon:l=gN,indeterminate:u=!1,indeterminateIcon:c=vN,inputProps:h,size:d="medium",className:p}=i,f=(0,Ce.A)(i,pN),m=u?c:l,g=u?c:s,v=(0,Ie.A)({},i,{color:o,indeterminate:u,size:d}),y=(e=>{const{classes:t,indeterminate:n,color:r,size:i}=e,s=Tw({root:["root",n&&"indeterminate",`color${Gw(r)}`,`size${Gw(i)}`]},hN,t);return(0,Ie.A)({},t,s)})(v);return(0,Me.jsx)(fN,(0,Ie.A)({type:"checkbox",inputProps:(0,Ie.A)({"data-indeterminate":u},h),icon:a.cloneElement(m,{fontSize:null!=(n=m.props.fontSize)?n:d}),checkedIcon:a.cloneElement(g,{fontSize:null!=(r=g.props.fontSize)?r:d}),ownerState:v,ref:t,className:Te(y.root,p)},f,{classes:y}))}));function bN(e){return wt("MuiButton",e)}const xN=kt("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);const wN=a.createContext({});const kN=a.createContext(void 0),SN=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],IN=e=>(0,Ie.A)({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}}),CN=Yw(AS,{shouldForwardProp:e=>Xw(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${Gw(n.color)}`],t[`size${Gw(n.size)}`],t[`${n.variant}Size${Gw(n.size)}`],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})((e=>{let{theme:t,ownerState:n}=e;var r,i;const s="light"===t.palette.mode?t.palette.grey[300]:t.palette.grey[800],o="light"===t.palette.mode?t.palette.grey.A100:t.palette.grey[700];return(0,Ie.A)({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":(0,Ie.A)({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,Ve.X4)(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===n.variant&&"inherit"!==n.color&&{backgroundColor:t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,Ve.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===n.variant&&"inherit"!==n.color&&{border:`1px solid ${(t.vars||t).palette[n.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,Ve.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===n.variant&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:o,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},"contained"===n.variant&&"inherit"!==n.color&&{backgroundColor:(t.vars||t).palette[n.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[n.color].main}}),"&:active":(0,Ie.A)({},"contained"===n.variant&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${xN.focusVisible}`]:(0,Ie.A)({},"contained"===n.variant&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${xN.disabled}`]:(0,Ie.A)({color:(t.vars||t).palette.action.disabled},"outlined"===n.variant&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"contained"===n.variant&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},"text"===n.variant&&{padding:"6px 8px"},"text"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].main},"outlined"===n.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[n.color].mainChannel} / 0.5)`:`1px solid ${(0,Ve.X4)(t.palette[n.color].main,.5)}`},"contained"===n.variant&&{color:t.vars?t.vars.palette.text.primary:null==(r=(i=t.palette).getContrastText)?void 0:r.call(i,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:s,boxShadow:(t.vars||t).shadows[2]},"contained"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].contrastText,backgroundColor:(t.vars||t).palette[n.color].main},"inherit"===n.color&&{color:"inherit",borderColor:"currentColor"},"small"===n.size&&"text"===n.variant&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"text"===n.variant&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},"small"===n.size&&"outlined"===n.variant&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"outlined"===n.variant&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},"small"===n.size&&"contained"===n.variant&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"contained"===n.variant&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},n.fullWidth&&{width:"100%"})}),(e=>{let{ownerState:t}=e;return t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${xN.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${xN.disabled}`]:{boxShadow:"none"}}})),EN=Yw("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,t[`iconSize${Gw(n.size)}`]]}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({display:"inherit",marginRight:8,marginLeft:-4},"small"===t.size&&{marginLeft:-2},IN(t))})),TN=Yw("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,t[`iconSize${Gw(n.size)}`]]}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({display:"inherit",marginRight:-4,marginLeft:8},"small"===t.size&&{marginRight:-2},IN(t))})),NN=a.forwardRef((function(e,t){const n=a.useContext(wN),r=a.useContext(kN),i=ek({props:Aw(n,e),name:"MuiButton"}),{children:s,color:o="primary",component:l="button",className:u,disabled:c=!1,disableElevation:h=!1,disableFocusRipple:d=!1,endIcon:p,focusVisibleClassName:f,fullWidth:m=!1,size:g="medium",startIcon:v,type:y,variant:b="text"}=i,x=(0,Ce.A)(i,SN),w=(0,Ie.A)({},i,{color:o,component:l,disabled:c,disableElevation:h,disableFocusRipple:d,fullWidth:m,size:g,type:y,variant:b}),k=(e=>{const{color:t,disableElevation:n,fullWidth:r,size:i,variant:s,classes:o}=e,a=Tw({root:["root",s,`${s}${Gw(t)}`,`size${Gw(i)}`,`${s}Size${Gw(i)}`,`color${Gw(t)}`,n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${Gw(i)}`],endIcon:["icon","endIcon",`iconSize${Gw(i)}`]},bN,o);return(0,Ie.A)({},o,a)})(w),S=v&&(0,Me.jsx)(EN,{className:k.startIcon,ownerState:w,children:v}),I=p&&(0,Me.jsx)(TN,{className:k.endIcon,ownerState:w,children:p}),C=r||"";return(0,Me.jsxs)(CN,(0,Ie.A)({ownerState:w,className:Te(n.className,k.root,u,C),component:l,disabled:c,focusRipple:!d,focusVisibleClassName:Te(k.focusVisible,f),ref:t,type:y},x,{classes:k,children:[S,s,I]}))})),AN=NN;function RN(){const[e,t]=(0,a.useState)(""),[n,r]=(0,a.useState)(""),[i,s]=(0,a.useState)(!1),[o,l]=(0,a.useState)(""),[u,c]=(0,a.useState)(!1),{login:h}=cw(),d=ie();return a.useEffect((()=>{const e=localStorage.getItem("rememberedEmail");e&&(t(e),s(!0))}),[]),(0,Me.jsx)(tk,{maxWidth:"sm",children:(0,Me.jsxs)(Ct,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80vh"},children:[(0,Me.jsx)(lk,{component:"h1",variant:"h4",gutterBottom:!0,children:"Remote Patient Monitoring - Baadi"}),(0,Me.jsx)(yk,{sx:{width:"100%",mt:3},children:(0,Me.jsxs)(kk,{children:[(0,Me.jsx)(lk,{component:"h2",variant:"h5",align:"center",gutterBottom:!0,children:"Login"}),o&&(0,Me.jsx)(ZS,{severity:"error",sx:{mb:2},children:o}),(0,Me.jsxs)(Ct,{component:"form",onSubmit:async function(t){t.preventDefault();try{l(""),c(!0),await h(e,n),i?localStorage.setItem("rememberedEmail",e):localStorage.removeItem("rememberedEmail"),d("/dashboard")}catch(o){console.error("Login error:",o),l("Failed to sign in. Please check your credentials.")}finally{c(!1)}},noValidate:!0,children:[(0,Me.jsx)(UT,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:e,onChange:e=>t(e.target.value)}),(0,Me.jsx)(UT,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:n,onChange:e=>r(e.target.value)}),(0,Me.jsx)(nN,{control:(0,Me.jsx)(yN,{value:"remember",color:"primary",checked:i,onChange:e=>s(e.target.checked)}),label:"Remember me"}),(0,Me.jsx)(AN,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",sx:{mt:3,mb:2},disabled:u,children:u?"Signing in...":"Sign In"}),(0,Me.jsxs)(Ct,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,Me.jsx)(kw,{to:"/forgot-password",style:{textDecoration:"none"},children:(0,Me.jsx)(lk,{variant:"body2",color:"primary",children:"Forgot password?"})}),(0,Me.jsx)(kw,{to:"/register",style:{textDecoration:"none"},children:(0,Me.jsx)(lk,{variant:"body2",color:"primary",children:"Don't have an account? Sign Up"})})]})]})]})})]})})}function $N(e){return wt("MuiStepper",e)}kt("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const _N=a.createContext({});const ON=_N,DN=a.createContext({});const FN=DN;function MN(e){return wt("MuiStepConnector",e)}kt("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const LN=["className"],PN=Yw("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({flex:"1 1 auto"},"vertical"===t.orientation&&{marginLeft:12},t.alternativeLabel&&{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})})),zN=Yw("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.line,t[`line${Gw(n.orientation)}`]]}})((e=>{let{ownerState:t,theme:n}=e;const r="light"===n.palette.mode?n.palette.grey[400]:n.palette.grey[600];return(0,Ie.A)({display:"block",borderColor:n.vars?n.vars.palette.StepConnector.border:r},"horizontal"===t.orientation&&{borderTopStyle:"solid",borderTopWidth:1},"vertical"===t.orientation&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})})),BN=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiStepConnector"}),{className:r}=n,i=(0,Ce.A)(n,LN),{alternativeLabel:s,orientation:o="horizontal"}=a.useContext(ON),{active:l,disabled:u,completed:c}=a.useContext(FN),h=(0,Ie.A)({},n,{alternativeLabel:s,orientation:o,active:l,completed:c,disabled:u}),d=(e=>{const{classes:t,orientation:n,alternativeLabel:r,active:i,completed:s,disabled:o}=e;return Tw({root:["root",n,r&&"alternativeLabel",i&&"active",s&&"completed",o&&"disabled"],line:["line",`line${Gw(n)}`]},MN,t)})(h);return(0,Me.jsx)(PN,(0,Ie.A)({className:Te(d.root,r),ref:t,ownerState:h},i,{children:(0,Me.jsx)(zN,{className:d.line,ownerState:h})}))})),UN=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],WN=Yw("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.nonLinear&&t.nonLinear]}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({display:"flex"},"horizontal"===t.orientation&&{flexDirection:"row",alignItems:"center"},"vertical"===t.orientation&&{flexDirection:"column"},t.alternativeLabel&&{alignItems:"flex-start"})})),VN=(0,Me.jsx)(BN,{}),jN=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiStepper"}),{activeStep:r=0,alternativeLabel:i=!1,children:s,className:o,component:l="div",connector:u=VN,nonLinear:c=!1,orientation:h="horizontal"}=n,d=(0,Ce.A)(n,UN),p=(0,Ie.A)({},n,{nonLinear:c,alternativeLabel:i,orientation:h,component:l}),f=(e=>{const{orientation:t,nonLinear:n,alternativeLabel:r,classes:i}=e;return Tw({root:["root",t,n&&"nonLinear",r&&"alternativeLabel"]},$N,i)})(p),m=a.Children.toArray(s).filter(Boolean),g=m.map(((e,t)=>a.cloneElement(e,(0,Ie.A)({index:t,last:t+1===m.length},e.props)))),v=a.useMemo((()=>({activeStep:r,alternativeLabel:i,connector:u,nonLinear:c,orientation:h})),[r,i,u,c,h]);return(0,Me.jsx)(ON.Provider,{value:v,children:(0,Me.jsx)(WN,(0,Ie.A)({as:l,ownerState:p,className:Te(f.root,o),ref:t},d,{children:g}))})}));function GN(e){return wt("MuiStep",e)}kt("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const HN=["active","children","className","component","completed","disabled","expanded","index","last"],qN=Yw("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({},"horizontal"===t.orientation&&{paddingLeft:8,paddingRight:8},t.alternativeLabel&&{flex:1,position:"relative"})})),KN=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiStep"}),{active:r,children:i,className:s,component:o="div",completed:l,disabled:u,expanded:c=!1,index:h,last:d}=n,p=(0,Ce.A)(n,HN),{activeStep:f,connector:m,alternativeLabel:g,orientation:v,nonLinear:y}=a.useContext(ON);let[b=!1,x=!1,w=!1]=[r,l,u];f===h?b=void 0===r||r:!y&&f>h?x=void 0===l||l:!y&&f<h&&(w=void 0===u||u);const k=a.useMemo((()=>({index:h,last:d,expanded:c,icon:h+1,active:b,completed:x,disabled:w})),[h,d,c,b,x,w]),S=(0,Ie.A)({},n,{active:b,orientation:v,alternativeLabel:g,completed:x,disabled:w,expanded:c,component:o}),I=(e=>{const{classes:t,orientation:n,alternativeLabel:r,completed:i}=e;return Tw({root:["root",n,r&&"alternativeLabel",i&&"completed"]},GN,t)})(S),C=(0,Me.jsxs)(qN,(0,Ie.A)({as:o,className:Te(I.root,s),ref:t,ownerState:S},p,{children:[m&&g&&0!==h?m:null,i]}));return(0,Me.jsx)(FN.Provider,{value:k,children:m&&!g&&0!==h?(0,Me.jsxs)(a.Fragment,{children:[m,C]}):C})})),XN=BS((0,Me.jsx)("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),YN=BS((0,Me.jsx)("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function QN(e){return wt("MuiStepIcon",e)}const JN=kt("MuiStepIcon",["root","active","completed","error","text"]);var ZN;const eA=["active","className","completed","error","icon"],tA=Yw(zS,{name:"MuiStepIcon",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),color:(t.vars||t).palette.text.disabled,[`&.${JN.completed}`]:{color:(t.vars||t).palette.primary.main},[`&.${JN.active}`]:{color:(t.vars||t).palette.primary.main},[`&.${JN.error}`]:{color:(t.vars||t).palette.error.main}}})),nA=Yw("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(e,t)=>t.text})((e=>{let{theme:t}=e;return{fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily}})),rA=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiStepIcon"}),{active:r=!1,className:i,completed:s=!1,error:o=!1,icon:a}=n,l=(0,Ce.A)(n,eA),u=(0,Ie.A)({},n,{active:r,completed:s,error:o}),c=(e=>{const{classes:t,active:n,completed:r,error:i}=e;return Tw({root:["root",n&&"active",r&&"completed",i&&"error"],text:["text"]},QN,t)})(u);if("number"===typeof a||"string"===typeof a){const e=Te(i,c.root);return o?(0,Me.jsx)(tA,(0,Ie.A)({as:YN,className:e,ref:t,ownerState:u},l)):s?(0,Me.jsx)(tA,(0,Ie.A)({as:XN,className:e,ref:t,ownerState:u},l)):(0,Me.jsxs)(tA,(0,Ie.A)({className:e,ref:t,ownerState:u},l,{children:[ZN||(ZN=(0,Me.jsx)("circle",{cx:"12",cy:"12",r:"12"})),(0,Me.jsx)(nA,{className:c.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:u,children:a})]}))}return a}));function iA(e){return wt("MuiStepLabel",e)}const sA=kt("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),oA=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],aA=Yw("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation]]}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({display:"flex",alignItems:"center",[`&.${sA.alternativeLabel}`]:{flexDirection:"column"},[`&.${sA.disabled}`]:{cursor:"default"}},"vertical"===t.orientation&&{textAlign:"left",padding:"8px 0"})})),lA=Yw("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(e,t)=>t.label})((e=>{let{theme:t}=e;return(0,Ie.A)({},t.typography.body2,{display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),[`&.${sA.active}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${sA.completed}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${sA.alternativeLabel}`]:{marginTop:16},[`&.${sA.error}`]:{color:(t.vars||t).palette.error.main}})})),uA=Yw("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(e,t)=>t.iconContainer})((()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${sA.alternativeLabel}`]:{paddingRight:0}}))),cA=Yw("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})((e=>{let{theme:t}=e;return{width:"100%",color:(t.vars||t).palette.text.secondary,[`&.${sA.alternativeLabel}`]:{textAlign:"center"}}})),hA=a.forwardRef((function(e,t){var n;const r=ek({props:e,name:"MuiStepLabel"}),{children:i,className:s,componentsProps:o={},error:l=!1,icon:u,optional:c,slotProps:h={},StepIconComponent:d,StepIconProps:p}=r,f=(0,Ce.A)(r,oA),{alternativeLabel:m,orientation:g}=a.useContext(ON),{active:v,disabled:y,completed:b,icon:x}=a.useContext(FN),w=u||x;let k=d;w&&!k&&(k=rA);const S=(0,Ie.A)({},r,{active:v,alternativeLabel:m,completed:b,disabled:y,error:l,orientation:g}),I=(e=>{const{classes:t,orientation:n,active:r,completed:i,error:s,disabled:o,alternativeLabel:a}=e;return Tw({root:["root",n,s&&"error",o&&"disabled",a&&"alternativeLabel"],label:["label",r&&"active",i&&"completed",s&&"error",o&&"disabled",a&&"alternativeLabel"],iconContainer:["iconContainer",r&&"active",i&&"completed",s&&"error",o&&"disabled",a&&"alternativeLabel"],labelContainer:["labelContainer",a&&"alternativeLabel"]},iA,t)})(S),C=null!=(n=h.label)?n:o.label;return(0,Me.jsxs)(aA,(0,Ie.A)({className:Te(I.root,s),ref:t,ownerState:S},f,{children:[w||k?(0,Me.jsx)(uA,{className:I.iconContainer,ownerState:S,children:(0,Me.jsx)(k,(0,Ie.A)({completed:b,active:v,error:l,icon:w},p))}):null,(0,Me.jsxs)(cA,{className:I.labelContainer,ownerState:S,children:[i?(0,Me.jsx)(lA,(0,Ie.A)({ownerState:S},C,{className:Te(I.label,null==C?void 0:C.className),children:i})):null,c]})]}))}));hA.muiName="StepLabel";const dA=hA;const pA=a.createContext();function fA(e){return wt("MuiGrid",e)}const mA=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],gA=kt("MuiGrid",["root","container","item","zeroMinWidth",...[0,1,2,3,4,5,6,7,8,9,10].map((e=>`spacing-xs-${e}`)),...["column-reverse","column","row-reverse","row"].map((e=>`direction-xs-${e}`)),...["nowrap","wrap-reverse","wrap"].map((e=>`wrap-xs-${e}`)),...mA.map((e=>`grid-xs-${e}`)),...mA.map((e=>`grid-sm-${e}`)),...mA.map((e=>`grid-md-${e}`)),...mA.map((e=>`grid-lg-${e}`)),...mA.map((e=>`grid-xl-${e}`))]),vA=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function yA(e){const t=parseFloat(e);return`${t}${String(e).replace(String(t),"")||"px"}`}function bA(e){let{breakpoints:t,values:n}=e,r="";Object.keys(n).forEach((e=>{""===r&&0!==n[e]&&(r=e)}));const i=Object.keys(t).sort(((e,n)=>t[e]-t[n]));return i.slice(0,i.indexOf(r))}const xA=Yw("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{container:r,direction:i,item:s,spacing:o,wrap:a,zeroMinWidth:l,breakpoints:u}=n;let c=[];r&&(c=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return[n[`spacing-xs-${String(e)}`]];const r=[];return t.forEach((t=>{const i=e[t];Number(i)>0&&r.push(n[`spacing-${t}-${String(i)}`])})),r}(o,u,t));const h=[];return u.forEach((e=>{const r=n[e];r&&h.push(t[`grid-${e}-${String(r)}`])})),[t.root,r&&t.container,s&&t.item,l&&t.zeroMinWidth,...c,"row"!==i&&t[`direction-xs-${String(i)}`],"wrap"!==a&&t[`wrap-xs-${String(a)}`],...h]}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({boxSizing:"border-box"},t.container&&{display:"flex",flexWrap:"wrap",width:"100%"},t.item&&{margin:0},t.zeroMinWidth&&{minWidth:0},"wrap"!==t.wrap&&{flexWrap:t.wrap})}),(function(e){let{theme:t,ownerState:n}=e;const r=(0,WT.kW)({values:n.direction,breakpoints:t.breakpoints.values});return(0,WT.NI)({theme:t},r,(e=>{const t={flexDirection:e};return 0===e.indexOf("column")&&(t[`& > .${gA.item}`]={maxWidth:"none"}),t}))}),(function(e){let{theme:t,ownerState:n}=e;const{container:r,rowSpacing:i}=n;let s={};if(r&&0!==i){const e=(0,WT.kW)({values:i,breakpoints:t.breakpoints.values});let n;"object"===typeof e&&(n=bA({breakpoints:t.breakpoints.values,values:e})),s=(0,WT.NI)({theme:t},e,((e,r)=>{var i;const s=t.spacing(e);return"0px"!==s?{marginTop:`-${yA(s)}`,[`& > .${gA.item}`]:{paddingTop:yA(s)}}:null!=(i=n)&&i.includes(r)?{}:{marginTop:0,[`& > .${gA.item}`]:{paddingTop:0}}}))}return s}),(function(e){let{theme:t,ownerState:n}=e;const{container:r,columnSpacing:i}=n;let s={};if(r&&0!==i){const e=(0,WT.kW)({values:i,breakpoints:t.breakpoints.values});let n;"object"===typeof e&&(n=bA({breakpoints:t.breakpoints.values,values:e})),s=(0,WT.NI)({theme:t},e,((e,r)=>{var i;const s=t.spacing(e);return"0px"!==s?{width:`calc(100% + ${yA(s)})`,marginLeft:`-${yA(s)}`,[`& > .${gA.item}`]:{paddingLeft:yA(s)}}:null!=(i=n)&&i.includes(r)?{}:{width:"100%",marginLeft:0,[`& > .${gA.item}`]:{paddingLeft:0}}}))}return s}),(function(e){let t,{theme:n,ownerState:r}=e;return n.breakpoints.keys.reduce(((e,i)=>{let s={};if(r[i]&&(t=r[i]),!t)return e;if(!0===t)s={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if("auto"===t)s={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const o=(0,WT.kW)({values:r.columns,breakpoints:n.breakpoints.values}),a="object"===typeof o?o[i]:o;if(void 0===a||null===a)return e;const l=Math.round(t/a*1e8)/1e6+"%";let u={};if(r.container&&r.item&&0!==r.columnSpacing){const e=n.spacing(r.columnSpacing);if("0px"!==e){const t=`calc(${l} + ${yA(e)})`;u={flexBasis:t,maxWidth:t}}}s=(0,Ie.A)({flexBasis:l,flexGrow:0,maxWidth:l},u)}return 0===n.breakpoints.values[i]?Object.assign(e,s):e[n.breakpoints.up(i)]=s,e}),{})}));const wA=e=>{const{classes:t,container:n,direction:r,item:i,spacing:s,wrap:o,zeroMinWidth:a,breakpoints:l}=e;let u=[];n&&(u=function(e,t){if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return[`spacing-xs-${String(e)}`];const n=[];return t.forEach((t=>{const r=e[t];if(Number(r)>0){const e=`spacing-${t}-${String(r)}`;n.push(e)}})),n}(s,l));const c=[];l.forEach((t=>{const n=e[t];n&&c.push(`grid-${t}-${String(n)}`)}));return Tw({root:["root",n&&"container",i&&"item",a&&"zeroMinWidth",...u,"row"!==r&&`direction-xs-${String(r)}`,"wrap"!==o&&`wrap-xs-${String(o)}`,...c]},fA,t)};const kA=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiGrid"}),{breakpoints:r}=rE(),i=(0,Re.A)(n),{className:s,columns:o,columnSpacing:l,component:u="div",container:c=!1,direction:h="row",item:d=!1,rowSpacing:p,spacing:f=0,wrap:m="wrap",zeroMinWidth:g=!1}=i,v=(0,Ce.A)(i,vA),y=p||f,b=l||f,x=a.useContext(pA),w=c?o||12:x,k={},S=(0,Ie.A)({},v);r.keys.forEach((e=>{null!=v[e]&&(k[e]=v[e],delete S[e])}));const I=(0,Ie.A)({},i,{columns:w,container:c,direction:h,item:d,rowSpacing:y,columnSpacing:b,wrap:m,zeroMinWidth:g,spacing:f},k,{breakpoints:r.keys}),C=wA(I);return(0,Me.jsx)(pA.Provider,{value:w,children:(0,Me.jsx)(xA,(0,Ie.A)({ownerState:I,className:Te(C.root,s),as:u,ref:t},S))})}));function SA(e){return wt("MuiDivider",e)}const IA=kt("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);function CA(e){return wt("MuiListItemIcon",e)}const EA=kt("MuiListItemIcon",["root","alignItemsFlexStart"]);const TA=kt("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function NA(e){return wt("MuiMenuItem",e)}const AA=kt("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),RA=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],$A=Yw(AS,{shouldForwardProp:e=>Xw(e)||"classes"===e,name:"MuiMenuItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.divider&&t.divider,!n.disableGutters&&t.gutters]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!n.disableGutters&&{paddingLeft:16,paddingRight:16},n.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${AA.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,Ve.X4)(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${AA.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,Ve.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${AA.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:(0,Ve.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,Ve.X4)(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${AA.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${AA.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${IA.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${IA.inset}`]:{marginLeft:52},[`& .${TA.root}`]:{marginTop:0,marginBottom:0},[`& .${TA.inset}`]:{paddingLeft:36},[`& .${EA.root}`]:{minWidth:36}},!n.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},n.dense&&(0,Ie.A)({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{[`& .${EA.root} svg`]:{fontSize:"1.25rem"}}))})),_A=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiMenuItem"}),{autoFocus:r=!1,component:i="li",dense:s=!1,divider:o=!1,disableGutters:l=!1,focusVisibleClassName:u,role:c="menuitem",tabIndex:h,className:d}=n,p=(0,Ce.A)(n,RA),f=a.useContext(_C),m=a.useMemo((()=>({dense:s||f.dense||!1,disableGutters:l})),[f.dense,s,l]),g=a.useRef(null);fI((()=>{r&&g.current&&g.current.focus()}),[r]);const v=(0,Ie.A)({},n,{dense:m.dense,divider:o,disableGutters:l}),y=(e=>{const{disabled:t,dense:n,divider:r,disableGutters:i,selected:s,classes:o}=e,a=Tw({root:["root",n&&"dense",t&&"disabled",!i&&"gutters",r&&"divider",s&&"selected"]},NA,o);return(0,Ie.A)({},o,a)})(n),b=Lk(g,t);let x;return n.disabled||(x=void 0!==h?h:-1),(0,Me.jsx)(_C.Provider,{value:m,children:(0,Me.jsx)($A,(0,Ie.A)({ref:b,role:c,tabIndex:x,component:i,focusVisibleClassName:Te(y.focusVisible,u),className:Te(y.root,d)},p,{ownerState:v,classes:y}))})})),OA=["Account Information","Personal Details","Role Selection"];function DA(){const[e,t]=(0,a.useState)(0),[n,r]=(0,a.useState)(""),[i,s]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[u,c]=(0,a.useState)(""),[h,d]=(0,a.useState)(""),[p,f]=(0,a.useState)("primary_caregiver"),[m,g]=(0,a.useState)(""),[v,y]=(0,a.useState)(!1),{signup:b}=cw(),x=ie();return(0,Me.jsx)(tk,{maxWidth:"sm",children:(0,Me.jsxs)(Ct,{sx:{marginTop:4,marginBottom:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,Me.jsx)(lk,{component:"h1",variant:"h4",gutterBottom:!0,children:"Remote Patient Monitoring - Baadi"}),(0,Me.jsx)(yk,{sx:{width:"100%",mt:3},children:(0,Me.jsxs)(kk,{children:[(0,Me.jsx)(lk,{component:"h2",variant:"h5",align:"center",gutterBottom:!0,children:"Create an Account"}),(0,Me.jsx)(jN,{activeStep:e,sx:{mt:3,mb:4},children:OA.map((e=>(0,Me.jsx)(KN,{children:(0,Me.jsx)(dA,{children:e})},e)))}),m&&(0,Me.jsx)(ZS,{severity:"error",sx:{mb:2},children:m}),(0,Me.jsxs)(Ct,{component:"form",onSubmit:2===e?async function(e){if(e.preventDefault(),i!==o)return g("Passwords do not match");try{g(""),y(!0),await b(n,i,u,h,p),x("/dashboard")}catch(m){console.error("Registration error:",m),"auth/email-already-in-use"===m.code?g("Email is already in use. Please try a different email or login."):g("Failed to create an account. Please try again.")}finally{y(!1)}}:void 0,noValidate:!0,children:[0===e&&(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(UT,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:n,onChange:e=>r(e.target.value)}),(0,Me.jsx)(UT,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"new-password",value:i,onChange:e=>s(e.target.value)}),(0,Me.jsx)(UT,{margin:"normal",required:!0,fullWidth:!0,name:"confirmPassword",label:"Confirm Password",type:"password",id:"confirmPassword",autoComplete:"new-password",value:o,onChange:e=>l(e.target.value)})]}),1===e&&(0,Me.jsx)(Me.Fragment,{children:(0,Me.jsxs)(kA,{container:!0,spacing:2,children:[(0,Me.jsx)(kA,{item:!0,xs:12,sm:6,children:(0,Me.jsx)(UT,{margin:"normal",required:!0,fullWidth:!0,id:"firstName",label:"First Name",name:"firstName",autoComplete:"given-name",value:u,onChange:e=>c(e.target.value)})}),(0,Me.jsx)(kA,{item:!0,xs:12,sm:6,children:(0,Me.jsx)(UT,{margin:"normal",required:!0,fullWidth:!0,id:"lastName",label:"Last Name",name:"lastName",autoComplete:"family-name",value:h,onChange:e=>d(e.target.value)})})]})}),2===e&&(0,Me.jsx)(Me.Fragment,{children:(0,Me.jsxs)(UT,{select:!0,margin:"normal",required:!0,fullWidth:!0,id:"role",label:"Your Role",name:"role",value:p,onChange:e=>f(e.target.value),helperText:"Please select your role in patient care",children:[(0,Me.jsx)(_A,{value:"primary_caregiver",children:"Primary Caregiver"}),(0,Me.jsx)(_A,{value:"secondary_caregiver",children:"Secondary Caregiver"}),(0,Me.jsx)(_A,{value:"family_member",children:"Family Member"}),(0,Me.jsx)(_A,{value:"healthcare_professional",children:"Healthcare Professional"})]})}),(0,Me.jsxs)(Ct,{sx:{display:"flex",justifyContent:"space-between",mt:3},children:[(0,Me.jsx)(AN,{disabled:0===e,onClick:()=>{t((e=>e-1))},variant:"outlined",children:"Back"}),e===OA.length-1?(0,Me.jsx)(AN,{type:"submit",variant:"contained",color:"primary",disabled:v,children:v?"Creating Account...":"Create Account"}):(0,Me.jsx)(AN,{variant:"contained",onClick:()=>{if(0===e){if(!n)return g("Email is required");if(!i)return g("Password is required");if(i!==o)return g("Passwords do not match");if(i.length<6)return g("Password must be at least 6 characters")}else if(1===e){if(!u)return g("First name is required");if(!h)return g("Last name is required")}g(""),t((e=>e+1))},children:"Next"})]}),(0,Me.jsx)(Ct,{sx:{mt:2,textAlign:"center"},children:(0,Me.jsx)(kw,{to:"/login",style:{textDecoration:"none"},children:(0,Me.jsx)(lk,{variant:"body2",color:"primary",children:"Already have an account? Sign In"})})})]})]})})]})})}function FA(){const[e,t]=(0,a.useState)(""),[n,r]=(0,a.useState)(""),[i,s]=(0,a.useState)(""),[o,l]=(0,a.useState)(!1),{resetPassword:u}=cw();return(0,Me.jsx)(tk,{maxWidth:"sm",children:(0,Me.jsxs)(Ct,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80vh"},children:[(0,Me.jsx)(lk,{component:"h1",variant:"h4",gutterBottom:!0,children:"Remote Patient Monitoring - Baadi"}),(0,Me.jsx)(yk,{sx:{width:"100%",mt:3},children:(0,Me.jsxs)(kk,{children:[(0,Me.jsx)(lk,{component:"h2",variant:"h5",align:"center",gutterBottom:!0,children:"Password Reset"}),(0,Me.jsx)(lk,{variant:"body1",align:"center",sx:{mb:3},children:"Enter your email address and we'll send you a link to reset your password."}),n&&(0,Me.jsx)(ZS,{severity:"error",sx:{mb:2},children:n}),i&&(0,Me.jsx)(ZS,{severity:"success",sx:{mb:2},children:i}),(0,Me.jsxs)(Ct,{component:"form",onSubmit:async function(t){t.preventDefault();try{s(""),r(""),l(!0),await u(e),s("Check your email for further instructions")}catch(n){console.error("Password reset error:",n),r("Failed to reset password. Please check if the email is correct.")}finally{l(!1)}},noValidate:!0,children:[(0,Me.jsx)(UT,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:e,onChange:e=>t(e.target.value)}),(0,Me.jsx)(AN,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",sx:{mt:3,mb:2},disabled:o,children:o?"Sending...":"Reset Password"}),(0,Me.jsx)(Ct,{sx:{display:"flex",justifyContent:"center"},children:(0,Me.jsx)(kw,{to:"/login",style:{textDecoration:"none"},children:(0,Me.jsx)(lk,{variant:"body2",color:"primary",children:"Return to Login"})})})]})]})})]})})}const MA=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],LA=Yw("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.absolute&&t.absolute,t[n.variant],n.light&&t.light,"vertical"===n.orientation&&t.vertical,n.flexItem&&t.flexItem,n.children&&t.withChildren,n.children&&"vertical"===n.orientation&&t.withChildrenVertical,"right"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignRight,"left"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignLeft]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin"},n.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},n.light&&{borderColor:t.vars?`rgba(${t.vars.palette.dividerChannel} / 0.08)`:(0,Ve.X4)(t.palette.divider,.08)},"inset"===n.variant&&{marginLeft:72},"middle"===n.variant&&"horizontal"===n.orientation&&{marginLeft:t.spacing(2),marginRight:t.spacing(2)},"middle"===n.variant&&"vertical"===n.orientation&&{marginTop:t.spacing(1),marginBottom:t.spacing(1)},"vertical"===n.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},n.flexItem&&{alignSelf:"stretch",height:"auto"})}),(e=>{let{ownerState:t}=e;return(0,Ie.A)({},t.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({},n.children&&"vertical"!==n.orientation&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({},n.children&&"vertical"===n.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}})}),(e=>{let{ownerState:t}=e;return(0,Ie.A)({},"right"===t.textAlign&&"vertical"!==t.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===t.textAlign&&"vertical"!==t.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})})),PA=Yw("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.wrapper,"vertical"===n.orientation&&t.wrapperVertical]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`},"vertical"===n.orientation&&{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`})})),zA=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiDivider"}),{absolute:r=!1,children:i,className:s,component:o=(i?"div":"hr"),flexItem:a=!1,light:l=!1,orientation:u="horizontal",role:c=("hr"!==o?"separator":void 0),textAlign:h="center",variant:d="fullWidth"}=n,p=(0,Ce.A)(n,MA),f=(0,Ie.A)({},n,{absolute:r,component:o,flexItem:a,light:l,orientation:u,role:c,textAlign:h,variant:d}),m=(e=>{const{absolute:t,children:n,classes:r,flexItem:i,light:s,orientation:o,textAlign:a,variant:l}=e;return Tw({root:["root",t&&"absolute",l,s&&"light","vertical"===o&&"vertical",i&&"flexItem",n&&"withChildren",n&&"vertical"===o&&"withChildrenVertical","right"===a&&"vertical"!==o&&"textAlignRight","left"===a&&"vertical"!==o&&"textAlignLeft"],wrapper:["wrapper","vertical"===o&&"wrapperVertical"]},SA,r)})(f);return(0,Me.jsx)(LA,(0,Ie.A)({as:o,className:Te(m.root,s),role:c,ref:t,ownerState:f},p,{children:i?(0,Me.jsx)(PA,{className:m.wrapper,ownerState:f,children:i}):null}))}));zA.muiSkipListHighlight=!0;const BA=zA,UA=BS((0,Me.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function WA(e){return wt("MuiChip",e)}const VA=kt("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),jA=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],GA=Yw("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{color:r,iconColor:i,clickable:s,onDelete:o,size:a,variant:l}=n;return[{[`& .${VA.avatar}`]:t.avatar},{[`& .${VA.avatar}`]:t[`avatar${Gw(a)}`]},{[`& .${VA.avatar}`]:t[`avatarColor${Gw(r)}`]},{[`& .${VA.icon}`]:t.icon},{[`& .${VA.icon}`]:t[`icon${Gw(a)}`]},{[`& .${VA.icon}`]:t[`iconColor${Gw(i)}`]},{[`& .${VA.deleteIcon}`]:t.deleteIcon},{[`& .${VA.deleteIcon}`]:t[`deleteIcon${Gw(a)}`]},{[`& .${VA.deleteIcon}`]:t[`deleteIconColor${Gw(r)}`]},{[`& .${VA.deleteIcon}`]:t[`deleteIcon${Gw(l)}Color${Gw(r)}`]},t.root,t[`size${Gw(a)}`],t[`color${Gw(r)}`],s&&t.clickable,s&&"default"!==r&&t[`clickableColor${Gw(r)})`],o&&t.deletable,o&&"default"!==r&&t[`deletableColor${Gw(r)}`],t[l],t[`${l}${Gw(r)}`]]}})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode?t.palette.grey[700]:t.palette.grey[300];return(0,Ie.A)({maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:16,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${VA.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${VA.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:r,fontSize:t.typography.pxToRem(12)},[`& .${VA.avatarColorPrimary}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},[`& .${VA.avatarColorSecondary}`]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},[`& .${VA.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},[`& .${VA.icon}`]:(0,Ie.A)({marginLeft:5,marginRight:-6},"small"===n.size&&{fontSize:18,marginLeft:4,marginRight:-4},n.iconColor===n.color&&(0,Ie.A)({color:t.vars?t.vars.palette.Chip.defaultIconColor:r},"default"!==n.color&&{color:"inherit"})),[`& .${VA.deleteIcon}`]:(0,Ie.A)({WebkitTapHighlightColor:"transparent",color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.26)`:(0,Ve.X4)(t.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.4)`:(0,Ve.X4)(t.palette.text.primary,.4)}},"small"===n.size&&{fontSize:16,marginRight:4,marginLeft:-4},"default"!==n.color&&{color:t.vars?`rgba(${t.vars.palette[n.color].contrastTextChannel} / 0.7)`:(0,Ve.X4)(t.palette[n.color].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[n.color].contrastText}})},"small"===n.size&&{height:24},"default"!==n.color&&{backgroundColor:(t.vars||t).palette[n.color].main,color:(t.vars||t).palette[n.color].contrastText},n.onDelete&&{[`&.${VA.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,Ve.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},n.onDelete&&"default"!==n.color&&{[`&.${VA.focusVisible}`]:{backgroundColor:(t.vars||t).palette[n.color].dark}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({},n.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:(0,Ve.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)},[`&.${VA.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,Ve.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},"&:active":{boxShadow:(t.vars||t).shadows[1]}},n.clickable&&"default"!==n.color&&{[`&:hover, &.${VA.focusVisible}`]:{backgroundColor:(t.vars||t).palette[n.color].dark}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({},"outlined"===n.variant&&{backgroundColor:"transparent",border:t.vars?`1px solid ${t.vars.palette.Chip.defaultBorder}`:`1px solid ${"light"===t.palette.mode?t.palette.grey[400]:t.palette.grey[700]}`,[`&.${VA.clickable}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${VA.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`& .${VA.avatar}`]:{marginLeft:4},[`& .${VA.avatarSmall}`]:{marginLeft:2},[`& .${VA.icon}`]:{marginLeft:4},[`& .${VA.iconSmall}`]:{marginLeft:2},[`& .${VA.deleteIcon}`]:{marginRight:5},[`& .${VA.deleteIconSmall}`]:{marginRight:3}},"outlined"===n.variant&&"default"!==n.color&&{color:(t.vars||t).palette[n.color].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / 0.7)`:(0,Ve.X4)(t.palette[n.color].main,.7)}`,[`&.${VA.clickable}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,Ve.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity)},[`&.${VA.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / ${t.vars.palette.action.focusOpacity})`:(0,Ve.X4)(t.palette[n.color].main,t.palette.action.focusOpacity)},[`& .${VA.deleteIcon}`]:{color:t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / 0.7)`:(0,Ve.X4)(t.palette[n.color].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[n.color].main}}})})),HA=Yw("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,t)=>{const{ownerState:n}=e,{size:r}=n;return[t.label,t[`label${Gw(r)}`]]}})((e=>{let{ownerState:t}=e;return(0,Ie.A)({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},"outlined"===t.variant&&{paddingLeft:11,paddingRight:11},"small"===t.size&&{paddingLeft:8,paddingRight:8},"small"===t.size&&"outlined"===t.variant&&{paddingLeft:7,paddingRight:7})}));function qA(e){return"Backspace"===e.key||"Delete"===e.key}const KA=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiChip"}),{avatar:r,className:i,clickable:s,color:o="default",component:l,deleteIcon:u,disabled:c=!1,icon:h,label:d,onClick:p,onDelete:f,onKeyDown:m,onKeyUp:g,size:v="medium",variant:y="filled",tabIndex:b,skipFocusWhenDisabled:x=!1}=n,w=(0,Ce.A)(n,jA),k=a.useRef(null),S=Lk(k,t),I=e=>{e.stopPropagation(),f&&f(e)},C=!(!1===s||!p)||s,E=C||f?AS:l||"div",T=(0,Ie.A)({},n,{component:E,disabled:c,size:v,color:o,iconColor:a.isValidElement(h)&&h.props.color||o,onDelete:!!f,clickable:C,variant:y}),N=(e=>{const{classes:t,disabled:n,size:r,color:i,iconColor:s,onDelete:o,clickable:a,variant:l}=e;return Tw({root:["root",l,n&&"disabled",`size${Gw(r)}`,`color${Gw(i)}`,a&&"clickable",a&&`clickableColor${Gw(i)}`,o&&"deletable",o&&`deletableColor${Gw(i)}`,`${l}${Gw(i)}`],label:["label",`label${Gw(r)}`],avatar:["avatar",`avatar${Gw(r)}`,`avatarColor${Gw(i)}`],icon:["icon",`icon${Gw(r)}`,`iconColor${Gw(s)}`],deleteIcon:["deleteIcon",`deleteIcon${Gw(r)}`,`deleteIconColor${Gw(i)}`,`deleteIcon${Gw(l)}Color${Gw(i)}`]},WA,t)})(T),A=E===AS?(0,Ie.A)({component:l||"div",focusVisibleClassName:N.focusVisible},f&&{disableRipple:!0}):{};let R=null;f&&(R=u&&a.isValidElement(u)?a.cloneElement(u,{className:Te(u.props.className,N.deleteIcon),onClick:I}):(0,Me.jsx)(UA,{className:Te(N.deleteIcon),onClick:I}));let $=null;r&&a.isValidElement(r)&&($=a.cloneElement(r,{className:Te(N.avatar,r.props.className)}));let _=null;return h&&a.isValidElement(h)&&(_=a.cloneElement(h,{className:Te(N.icon,h.props.className)})),(0,Me.jsxs)(GA,(0,Ie.A)({as:E,className:Te(N.root,i),disabled:!(!C||!c)||void 0,onClick:p,onKeyDown:e=>{e.currentTarget===e.target&&qA(e)&&e.preventDefault(),m&&m(e)},onKeyUp:e=>{e.currentTarget===e.target&&(f&&qA(e)?f(e):"Escape"===e.key&&k.current&&k.current.blur()),g&&g(e)},ref:S,tabIndex:x&&c?-1:b,ownerState:T},A,w,{children:[$||_,(0,Me.jsx)(HA,{className:Te(N.label),ownerState:T,children:d}),R]}))})),XA=KA;var YA=n(1188);const QA={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};const JA=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))};function ZA(e,t){return e-t}function eR(e,t){var n;const{index:r}=null!=(n=e.reduce(((e,n,r)=>{const i=Math.abs(t-n);return null===e||i<e.distance||i===e.distance?{distance:i,index:r}:e}),null))?n:{};return r}function tR(e,t){if(void 0!==t.current&&e.changedTouches){const n=e;for(let e=0;e<n.changedTouches.length;e+=1){const r=n.changedTouches[e];if(r.identifier===t.current)return{x:r.clientX,y:r.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function nR(e,t,n){return 100*(e-t)/(n-t)}function rR(e,t,n){const r=Math.round((e-n)/t)*t+n;return Number(r.toFixed(function(e){if(Math.abs(e)<1){const t=e.toExponential().split("e-"),n=t[0].split(".")[1];return(n?n.length:0)+parseInt(t[1],10)}const t=e.toString().split(".")[1];return t?t.length:0}(t)))}function iR(e){let{values:t,newValue:n,index:r}=e;const i=t.slice();return i[r]=n,i.sort(ZA)}function sR(e){let{sliderRef:t,activeIndex:n,setActive:r}=e;var i,s;const o=rI(t.current);var a;null!=(i=t.current)&&i.contains(o.activeElement)&&Number(null==o||null==(s=o.activeElement)?void 0:s.getAttribute("data-index"))===n||(null==(a=t.current)||a.querySelector(`[type="range"][data-index="${n}"]`).focus());r&&r(n)}function oR(e,t){return"number"===typeof e&&"number"===typeof t?e===t:"object"===typeof e&&"object"===typeof t&&JA(e,t)}const aR={horizontal:{offset:e=>({left:`${e}%`}),leap:e=>({width:`${e}%`})},"horizontal-reverse":{offset:e=>({right:`${e}%`}),leap:e=>({width:`${e}%`})},vertical:{offset:e=>({bottom:`${e}%`}),leap:e=>({height:`${e}%`})}},lR=e=>e;let uR;function cR(){return void 0===uR&&(uR="undefined"===typeof CSS||"function"!==typeof CSS.supports||CSS.supports("touch-action","none")),uR}const hR=e=>!e||!Ck(e);function dR(e){return wt("MuiSlider",e)}const pR=kt("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]);const fR=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","shiftStep","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"];function mR(e){return e}const gR=Yw("span",{name:"MuiSlider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`color${Gw(n.color)}`],"medium"!==n.size&&t[`size${Gw(n.size)}`],n.marked&&t.marked,"vertical"===n.orientation&&t.vertical,"inverted"===n.track&&t.trackInverted,!1===n.track&&t.trackFalse]}})((e=>{let{theme:t}=e;var n;return{borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${pR.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${pR.dragging}`]:{[`& .${pR.thumb}, & .${pR.track}`]:{transition:"none"}},variants:[...Object.keys((null!=(n=t.vars)?n:t).palette).filter((e=>{var n;return(null!=(n=t.vars)?n:t).palette[e].main})).map((e=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}})),vR=Yw("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(e,t)=>t.rail})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),yR=Yw("span",{name:"MuiSlider",slot:"Track",overridesResolver:(e,t)=>t.track})((e=>{let{theme:t}=e;var n;return{display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.keys((null!=(n=t.vars)?n:t).palette).filter((e=>{var n;return(null!=(n=t.vars)?n:t).palette[e].main})).map((e=>({props:{color:e,track:"inverted"},style:(0,Ie.A)({},t.vars?{backgroundColor:t.vars.palette.Slider[`${e}Track`],borderColor:t.vars.palette.Slider[`${e}Track`]}:(0,Ie.A)({backgroundColor:(0,Ve.a)(t.palette[e].main,.62),borderColor:(0,Ve.a)(t.palette[e].main,.62)},t.applyStyles("dark",{backgroundColor:(0,Ve.e$)(t.palette[e].main,.5)}),t.applyStyles("dark",{borderColor:(0,Ve.e$)(t.palette[e].main,.5)})))})))]}})),bR=Yw("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.thumb,t[`thumbColor${Gw(n.color)}`],"medium"!==n.size&&t[`thumbSize${Gw(n.size)}`]]}})((e=>{let{theme:t}=e;var n;return{position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${pR.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.keys((null!=(n=t.vars)?n:t).palette).filter((e=>{var n;return(null!=(n=t.vars)?n:t).palette[e].main})).map((e=>({props:{color:e},style:{[`&:hover, &.${pR.focusVisible}`]:(0,Ie.A)({},t.vars?{boxShadow:`0px 0px 0px 8px rgba(${t.vars.palette[e].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 8px ${(0,Ve.X4)(t.palette[e].main,.16)}`},{"@media (hover: none)":{boxShadow:"none"}}),[`&.${pR.active}`]:(0,Ie.A)({},t.vars?{boxShadow:`0px 0px 0px 14px rgba(${t.vars.palette[e].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 14px ${(0,Ve.X4)(t.palette[e].main,.16)}`})}})))]}})),xR=Yw((function(e){const{children:t,className:n,value:r}=e,i=(e=>{const{open:t}=e;return{offset:Te(t&&pR.valueLabelOpen),circle:pR.valueLabelCircle,label:pR.valueLabelLabel}})(e);return t?a.cloneElement(t,{className:Te(t.props.className)},(0,Me.jsxs)(a.Fragment,{children:[t.props.children,(0,Me.jsx)("span",{className:Te(i.offset,n),"aria-hidden":!0,children:(0,Me.jsx)("span",{className:i.circle,children:(0,Me.jsx)("span",{className:i.label,children:r})})})]})):null}),{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(e,t)=>t.valueLabel})((e=>{let{theme:t}=e;return(0,Ie.A)({zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${pR.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${pR.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]})})),wR=Yw("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:e=>Kw(e)&&"markActive"!==e,overridesResolver:(e,t)=>{const{markActive:n}=e;return[t.mark,n&&t.markActive]}})((e=>{let{theme:t}=e;return{position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}})),kR=Yw("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:e=>Kw(e)&&"markLabelActive"!==e,overridesResolver:(e,t)=>t.markLabel})((e=>{let{theme:t}=e;return(0,Ie.A)({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]})})),SR=e=>{let{children:t}=e;return t},IR=a.forwardRef((function(e,t){var n,r,i,s,o,l,u,c,h,d,p,f,m,g,v,y,b,x,w,k,S,I,C,E;const T=ek({props:e,name:"MuiSlider"}),N=NC(),{"aria-label":A,"aria-valuetext":R,"aria-labelledby":$,component:_="span",components:O={},componentsProps:D={},color:F="primary",classes:M,className:L,disableSwap:P=!1,disabled:z=!1,getAriaLabel:B,getAriaValueText:U,marks:W=!1,max:V=100,min:j=0,orientation:G="horizontal",shiftStep:H=10,size:q="medium",step:K=1,scale:X=mR,slotProps:Y,slots:Q,track:J="normal",valueLabelDisplay:Z="off",valueLabelFormat:ee=mR}=T,te=(0,Ce.A)(T,fR),ne=(0,Ie.A)({},T,{isRtl:N,max:V,min:j,classes:M,disabled:z,disableSwap:P,orientation:G,marks:W,color:F,size:q,step:K,shiftStep:H,scale:X,track:J,valueLabelDisplay:Z,valueLabelFormat:ee}),{axisProps:re,getRootProps:ie,getHiddenInputProps:se,getThumbProps:oe,open:ae,active:le,axis:ue,focusedThumbIndex:ce,range:he,dragging:de,marks:pe,values:fe,trackOffset:me,trackLeap:ge,getThumbStyle:ve}=function(e){const{"aria-labelledby":t,defaultValue:n,disabled:r=!1,disableSwap:i=!1,isRtl:s=!1,marks:o=!1,max:l=100,min:u=0,name:c,onChange:h,onChangeCommitted:d,orientation:p="horizontal",rootRef:f,scale:m=lR,step:g=1,shiftStep:v=10,tabIndex:y,value:b}=e,x=a.useRef(void 0),[w,k]=a.useState(-1),[S,I]=a.useState(-1),[C,E]=a.useState(!1),T=a.useRef(0),[N,A]=fT({controlled:b,default:null!=n?n:u,name:"Slider"}),R=h&&((e,t,n)=>{const r=e.nativeEvent||e,i=new r.constructor(r.type,r);Object.defineProperty(i,"target",{writable:!0,value:{value:t,name:c}}),h(i,t,n)}),$=Array.isArray(N);let _=$?N.slice().sort(ZA):[N];_=_.map((e=>null==e?u:(0,YA.A)(e,u,l)));const O=!0===o&&null!==g?[...Array(Math.floor((l-u)/g)+1)].map(((e,t)=>({value:u+g*t}))):o||[],D=O.map((e=>e.value)),{isFocusVisibleRef:F,onBlur:M,onFocus:L,ref:P}=Zk(),[z,B]=a.useState(-1),U=a.useRef(null),W=Ik(P,U),V=Ik(f,W),j=e=>t=>{var n;const r=Number(t.currentTarget.getAttribute("data-index"));L(t),!0===F.current&&B(r),I(r),null==e||null==(n=e.onFocus)||n.call(e,t)},G=e=>t=>{var n;M(t),!1===F.current&&B(-1),I(-1),null==e||null==(n=e.onBlur)||n.call(e,t)},H=(e,t)=>{const n=Number(e.currentTarget.getAttribute("data-index")),r=_[n],s=D.indexOf(r);let o=t;if(O&&null==g){const e=D[D.length-1];o=o>e?e:o<D[0]?D[0]:o<r?D[s-1]:D[s+1]}if(o=(0,YA.A)(o,u,l),$){i&&(o=(0,YA.A)(o,_[n-1]||-1/0,_[n+1]||1/0));const e=o;o=iR({values:_,newValue:o,index:n});let t=n;i||(t=o.indexOf(e)),sR({sliderRef:U,activeIndex:t})}A(o),B(n),R&&!oR(o,N)&&R(e,o,n),d&&d(e,o)},q=e=>t=>{var n;if(null!==g){const e=Number(t.currentTarget.getAttribute("data-index")),n=_[e];let r=null;("ArrowLeft"===t.key||"ArrowDown"===t.key)&&t.shiftKey||"PageDown"===t.key?r=Math.max(n-v,u):(("ArrowRight"===t.key||"ArrowUp"===t.key)&&t.shiftKey||"PageUp"===t.key)&&(r=Math.min(n+v,l)),null!==r&&(H(t,r),t.preventDefault())}null==e||null==(n=e.onKeyDown)||n.call(e,t)};Pk((()=>{var e;r&&U.current.contains(document.activeElement)&&(null==(e=document.activeElement)||e.blur())}),[r]),r&&-1!==w&&k(-1),r&&-1!==z&&B(-1);const K=a.useRef(void 0);let X=p;s&&"horizontal"===p&&(X+="-reverse");const Y=e=>{let{finger:t,move:n=!1}=e;const{current:r}=U,{width:s,height:o,bottom:a,left:c}=r.getBoundingClientRect();let h,d;if(h=0===X.indexOf("vertical")?(a-t.y)/o:(t.x-c)/s,-1!==X.indexOf("-reverse")&&(h=1-h),d=function(e,t,n){return(n-t)*e+t}(h,u,l),g)d=rR(d,g,u);else{const e=eR(D,d);d=D[e]}d=(0,YA.A)(d,u,l);let p=0;if($){p=n?K.current:eR(_,d),i&&(d=(0,YA.A)(d,_[p-1]||-1/0,_[p+1]||1/0));const e=d;d=iR({values:_,newValue:d,index:p}),i&&n||(p=d.indexOf(e),K.current=p)}return{newValue:d,activeIndex:p}},Q=zk((e=>{const t=tR(e,x);if(!t)return;if(T.current+=1,"mousemove"===e.type&&0===e.buttons)return void J(e);const{newValue:n,activeIndex:r}=Y({finger:t,move:!0});sR({sliderRef:U,activeIndex:r,setActive:k}),A(n),!C&&T.current>2&&E(!0),R&&!oR(n,N)&&R(e,n,r)})),J=zk((e=>{const t=tR(e,x);if(E(!1),!t)return;const{newValue:n}=Y({finger:t,move:!0});k(-1),"touchend"===e.type&&I(-1),d&&d(e,n),x.current=void 0,ee()})),Z=zk((e=>{if(r)return;cR()||e.preventDefault();const t=e.changedTouches[0];null!=t&&(x.current=t.identifier);const n=tR(e,x);if(!1!==n){const{newValue:t,activeIndex:r}=Y({finger:n});sR({sliderRef:U,activeIndex:r,setActive:k}),A(t),R&&!oR(t,N)&&R(e,t,r)}T.current=0;const i=rI(U.current);i.addEventListener("touchmove",Q,{passive:!0}),i.addEventListener("touchend",J,{passive:!0})})),ee=a.useCallback((()=>{const e=rI(U.current);e.removeEventListener("mousemove",Q),e.removeEventListener("mouseup",J),e.removeEventListener("touchmove",Q),e.removeEventListener("touchend",J)}),[J,Q]);a.useEffect((()=>{const{current:e}=U;return e.addEventListener("touchstart",Z,{passive:cR()}),()=>{e.removeEventListener("touchstart",Z),ee()}}),[ee,Z]),a.useEffect((()=>{r&&ee()}),[r,ee]);const te=nR($?_[0]:u,u,l),ne=nR(_[_.length-1],u,l)-te,re=e=>t=>{var n;null==(n=e.onMouseLeave)||n.call(e,t),I(-1)};return{active:w,axis:X,axisProps:aR,dragging:C,focusedThumbIndex:z,getHiddenInputProps:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var i;const o=Nk(n),a={onChange:(h=o||{},e=>{var t;null==(t=h.onChange)||t.call(h,e),H(e,e.target.valueAsNumber)}),onFocus:j(o||{}),onBlur:G(o||{}),onKeyDown:q(o||{})};var h;const d=(0,Ie.A)({},o,a);return(0,Ie.A)({tabIndex:y,"aria-labelledby":t,"aria-orientation":p,"aria-valuemax":m(l),"aria-valuemin":m(u),name:c,type:"range",min:e.min,max:e.max,step:null===e.step&&e.marks?"any":null!=(i=e.step)?i:void 0,disabled:r},n,d,{style:(0,Ie.A)({},QA,{direction:s?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Nk(e),n={onMouseDown:(i=t||{},e=>{var t;if(null==(t=i.onMouseDown)||t.call(i,e),r)return;if(e.defaultPrevented)return;if(0!==e.button)return;e.preventDefault();const n=tR(e,x);if(!1!==n){const{newValue:t,activeIndex:r}=Y({finger:n});sR({sliderRef:U,activeIndex:r,setActive:k}),A(t),R&&!oR(t,N)&&R(e,t,r)}T.current=0;const s=rI(U.current);s.addEventListener("mousemove",Q,{passive:!0}),s.addEventListener("mouseup",J)})};var i;const s=(0,Ie.A)({},t,n);return(0,Ie.A)({},e,{ref:V},s)},getThumbProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Nk(e),n={onMouseOver:(r=t||{},e=>{var t;null==(t=r.onMouseOver)||t.call(r,e);const n=Number(e.currentTarget.getAttribute("data-index"));I(n)}),onMouseLeave:re(t||{})};var r;return(0,Ie.A)({},e,t,n)},marks:O,open:S,range:$,rootRef:V,trackLeap:ne,trackOffset:te,values:_,getThumbStyle:e=>({pointerEvents:-1!==w&&w!==e?"none":void 0})}}((0,Ie.A)({},ne,{rootRef:t}));ne.marked=pe.length>0&&pe.some((e=>e.label)),ne.dragging=de,ne.focusedThumbIndex=ce;const ye=(e=>{const{disabled:t,dragging:n,marked:r,orientation:i,track:s,classes:o,color:a,size:l}=e;return Tw({root:["root",t&&"disabled",n&&"dragging",r&&"marked","vertical"===i&&"vertical","inverted"===s&&"trackInverted",!1===s&&"trackFalse",a&&`color${Gw(a)}`,l&&`size${Gw(l)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",t&&"disabled",l&&`thumbSize${Gw(l)}`,a&&`thumbColor${Gw(a)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]},dR,o)})(ne),be=null!=(n=null!=(r=null==Q?void 0:Q.root)?r:O.Root)?n:gR,xe=null!=(i=null!=(s=null==Q?void 0:Q.rail)?s:O.Rail)?i:vR,we=null!=(o=null!=(l=null==Q?void 0:Q.track)?l:O.Track)?o:yR,ke=null!=(u=null!=(c=null==Q?void 0:Q.thumb)?c:O.Thumb)?u:bR,Se=null!=(h=null!=(d=null==Q?void 0:Q.valueLabel)?d:O.ValueLabel)?h:xR,Ee=null!=(p=null!=(f=null==Q?void 0:Q.mark)?f:O.Mark)?p:wR,Ne=null!=(m=null!=(g=null==Q?void 0:Q.markLabel)?g:O.MarkLabel)?m:kR,Ae=null!=(v=null!=(y=null==Q?void 0:Q.input)?y:O.Input)?v:"input",Re=null!=(b=null==Y?void 0:Y.root)?b:D.root,$e=null!=(x=null==Y?void 0:Y.rail)?x:D.rail,_e=null!=(w=null==Y?void 0:Y.track)?w:D.track,Oe=null!=(k=null==Y?void 0:Y.thumb)?k:D.thumb,De=null!=(S=null==Y?void 0:Y.valueLabel)?S:D.valueLabel,Fe=null!=(I=null==Y?void 0:Y.mark)?I:D.mark,Le=null!=(C=null==Y?void 0:Y.markLabel)?C:D.markLabel,Pe=null!=(E=null==Y?void 0:Y.input)?E:D.input,ze=$C({elementType:be,getSlotProps:ie,externalSlotProps:Re,externalForwardedProps:te,additionalProps:(0,Ie.A)({},hR(be)&&{as:_}),ownerState:(0,Ie.A)({},ne,null==Re?void 0:Re.ownerState),className:[ye.root,L]}),Be=$C({elementType:xe,externalSlotProps:$e,ownerState:ne,className:ye.rail}),Ue=$C({elementType:we,externalSlotProps:_e,additionalProps:{style:(0,Ie.A)({},re[ue].offset(me),re[ue].leap(ge))},ownerState:(0,Ie.A)({},ne,null==_e?void 0:_e.ownerState),className:ye.track}),We=$C({elementType:ke,getSlotProps:oe,externalSlotProps:Oe,ownerState:(0,Ie.A)({},ne,null==Oe?void 0:Oe.ownerState),className:ye.thumb}),Ve=$C({elementType:Se,externalSlotProps:De,ownerState:(0,Ie.A)({},ne,null==De?void 0:De.ownerState),className:ye.valueLabel}),je=$C({elementType:Ee,externalSlotProps:Fe,ownerState:ne,className:ye.mark}),Ge=$C({elementType:Ne,externalSlotProps:Le,ownerState:ne,className:ye.markLabel}),He=$C({elementType:Ae,getSlotProps:se,externalSlotProps:Pe,ownerState:ne});return(0,Me.jsxs)(be,(0,Ie.A)({},ze,{children:[(0,Me.jsx)(xe,(0,Ie.A)({},Be)),(0,Me.jsx)(we,(0,Ie.A)({},Ue)),pe.filter((e=>e.value>=j&&e.value<=V)).map(((e,t)=>{const n=nR(e.value,j,V),r=re[ue].offset(n);let i;return i=!1===J?-1!==fe.indexOf(e.value):"normal"===J&&(he?e.value>=fe[0]&&e.value<=fe[fe.length-1]:e.value<=fe[0])||"inverted"===J&&(he?e.value<=fe[0]||e.value>=fe[fe.length-1]:e.value>=fe[0]),(0,Me.jsxs)(a.Fragment,{children:[(0,Me.jsx)(Ee,(0,Ie.A)({"data-index":t},je,!Ck(Ee)&&{markActive:i},{style:(0,Ie.A)({},r,je.style),className:Te(je.className,i&&ye.markActive)})),null!=e.label?(0,Me.jsx)(Ne,(0,Ie.A)({"aria-hidden":!0,"data-index":t},Ge,!Ck(Ne)&&{markLabelActive:i},{style:(0,Ie.A)({},r,Ge.style),className:Te(ye.markLabel,Ge.className,i&&ye.markLabelActive),children:e.label})):null]},t)})),fe.map(((e,t)=>{const n=nR(e,j,V),r=re[ue].offset(n),i="off"===Z?SR:Se;return(0,Me.jsx)(i,(0,Ie.A)({},!Ck(i)&&{valueLabelFormat:ee,valueLabelDisplay:Z,value:"function"===typeof ee?ee(X(e),t):ee,index:t,open:ae===t||le===t||"on"===Z,disabled:z},Ve,{children:(0,Me.jsx)(ke,(0,Ie.A)({"data-index":t},We,{className:Te(ye.thumb,We.className,le===t&&ye.active,ce===t&&ye.focusVisible),style:(0,Ie.A)({},r,ve(t),We.style),children:(0,Me.jsx)(Ae,(0,Ie.A)({"data-index":t,"aria-label":B?B(t):A,"aria-valuenow":X(e),"aria-labelledby":$,"aria-valuetext":U?U(X(e),t):R,value:fe[t]},He))}))}),t)}))]}))}));function CR(e){return wt("MuiSwitch",e)}const ER=kt("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),TR=["className","color","edge","size","sx"],NR=Yw("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.edge&&t[`edge${Gw(n.edge)}`],t[`size${Gw(n.size)}`]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${ER.thumb}`]:{width:16,height:16},[`& .${ER.switchBase}`]:{padding:4,[`&.${ER.checked}`]:{transform:"translateX(16px)"}}}}]}),AR=Yw(aN,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.switchBase,{[`& .${ER.input}`]:t.input},"default"!==n.color&&t[`color${Gw(n.color)}`]]}})((e=>{let{theme:t}=e;return{position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${"light"===t.palette.mode?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${ER.checked}`]:{transform:"translateX(20px)"},[`&.${ER.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${"light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${ER.checked} + .${ER.track}`]:{opacity:.5},[`&.${ER.disabled} + .${ER.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:""+("light"===t.palette.mode?.12:.2)},[`& .${ER.input}`]:{left:"-100%",width:"300%"}}}),(e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,Ve.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.light})).map((e=>{let[n]=e;return{props:{color:n},style:{[`&.${ER.checked}`]:{color:(t.vars||t).palette[n].main,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,Ve.X4)(t.palette[n].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${ER.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${n}DisabledColor`]:`${"light"===t.palette.mode?(0,Ve.a)(t.palette[n].main,.62):(0,Ve.e$)(t.palette[n].main,.55)}`}},[`&.${ER.checked} + .${ER.track}`]:{backgroundColor:(t.vars||t).palette[n].main}}}}))]}})),RR=Yw("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})((e=>{let{theme:t}=e;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${"light"===t.palette.mode?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:""+("light"===t.palette.mode?.38:.3)}})),$R=Yw("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})((e=>{let{theme:t}=e;return{boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}})),_R=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiSwitch"}),{className:r,color:i="primary",edge:s=!1,size:o="medium",sx:a}=n,l=(0,Ce.A)(n,TR),u=(0,Ie.A)({},n,{color:i,edge:s,size:o}),c=(e=>{const{classes:t,edge:n,size:r,color:i,checked:s,disabled:o}=e,a=Tw({root:["root",n&&`edge${Gw(n)}`,`size${Gw(r)}`],switchBase:["switchBase",`color${Gw(i)}`,s&&"checked",o&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},CR,t);return(0,Ie.A)({},t,a)})(u),h=(0,Me.jsx)($R,{className:c.thumb,ownerState:u});return(0,Me.jsxs)(NR,{className:Te(c.root,r),sx:a,ownerState:u,children:[(0,Me.jsx)(AR,(0,Ie.A)({type:"checkbox",icon:h,checkedIcon:h,ref:t,ownerState:u},l,{classes:(0,Ie.A)({},c,{root:c.switchBase})})),(0,Me.jsx)(RR,{className:c.track,ownerState:u})]})})),OR=BS((0,Me.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),DR=BS((0,Me.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning"),FR=BS((0,Me.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings");var MR=n(7029),LR=n.n(MR);class PR{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class zR{refCount(e){return BR("refCount")}incRef(e){return BR("incRef")}timerAvailable(){return!0}time(e){return BR("time")}read(e){return BR("read")}readSync(e){return BR("readSync")}readToGPU(e,t){return BR("readToGPU")}numDataIds(){return BR("numDataIds")}disposeData(e,t){return BR("disposeData")}write(e,t,n){return BR("write")}move(e,t,n,r,i){return BR("move")}createTensorFromGPUData(e,t,n){return BR("createTensorFromGPUData")}memory(){return BR("memory")}floatPrecision(){return BR("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return BR("dispose")}}function BR(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function UR(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,jR(e,t,n)}function WR(e,t,n){return Math.max(e,Math.min(t,n))}function VR(e){return e%2===0?e:e+1}function jR(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function GR(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function HR(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";GR(XR(e,t),(()=>n+` Shapes ${e} and ${t} must match`))}function qR(e){GR(null!=e,(()=>"The input to the tensor constructor must be a non-null value."))}function KR(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function XR(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function YR(e){return e%1===0}function QR(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function JR(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function ZR(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise(((i,s)=>{let o=0;const a=()=>{if(e())return void i();o++;const l=t(o);null!=n&&o>=n?s():null!=r?r(a,l):setTimeout(a,l)};a()}))}function e$(e,t){let n=1,r=-1;for(let s=0;s<e.length;++s)if(e[s]>=0)n*=e[s];else if(-1===e[s]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(e[s]<0)throw Error(`Shapes can not be < 0. Found ${e[s]} at dim ${s}`);if(-1===r){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(0===n)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const i=e.slice();return i[r]=t/n,i}function t$(e,t){const n=t.length;return GR((e=null==e?t.map(((e,t)=>t)):[].concat(e)).every((e=>e>=-n&&e<n)),(()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`)),GR(e.every((e=>YR(e))),(()=>`All values in axis param must be integers but got axis ${e}`)),e.map((e=>e<0?n+e:e))}function n$(e,t){const n=[],r=[],i=null!=t&&Array.isArray(t)&&0===t.length,s=null==t||i?null:t$(t,e).sort();let o=0;for(let a=0;a<e.length;++a){if(null!=s){if(s[o]===a&&1!==e[a])throw new Error(`Can't squeeze axis ${a} since its dim '${e[a]}' is not 1`);(null==s[o]||s[o]>a)&&1===e[a]&&(n.push(e[a]),r.push(a)),s[o]<=a&&o++}1!==e[a]&&(n.push(e[a]),r.push(a))}return{newShape:n,keptDims:r}}function r$(e,t){return i$(e,t)}function i$(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error(`Unknown data type ${e}`);n=new Array(t)}return n}function s$(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function o$(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error(`Unknown dtype ${e}`)}function a$(e){return"string"===typeof e||e instanceof String}function l$(e){return"number"===typeof e}function u$(e){return Array.isArray(e)?u$(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":l$(e)?"float32":a$(e)?"string":"boolean"===typeof e?"bool":"float32"}function c$(e){return!!(e&&e.constructor&&e.call&&e.apply)}function h$(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function d$(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function p$(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new Array;if(1===t.length){const s=t[0]*(r?2:1);for(let t=0;t<s;t++)i[t]=n[e+t]}else{const s=t[0],o=t.slice(1),a=o.reduce(((e,t)=>e*t))*(r?2:1);for(let t=0;t<s;t++)i[t]=p$(e+t*a,o,n,r)}return i}function f$(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];const r=e.reduce(((e,t)=>e*t))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return p$(0,e,t,n)}function m$(e,t){const n=g$(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function g$(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function v$(e,t){const n=e.reduce(((e,t)=>e*t),1);if(null==t||"float32"===t)return f$(e,new Float32Array(n));if("int32"===t)return f$(e,new Int32Array(n));if("bool"===t)return f$(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function y$(e){e.forEach((t=>{GR(Number.isInteger(t)&&t>=0,(()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`))}))}function b$(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function x$(e,t,n){if(0===t)return[];if(1===t)return[e];const r=new Array(t);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}function w$(e){return e&&e.then&&"function"===typeof e.then}const k$="tfjsflags";class S${constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=I$,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(C$().getBool("IS_TEST")||C$().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){const t=this.urlFlags[e];C$().getBool("IS_TEST")||C$().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${t}.`),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(w$(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);if(k$ in e){e[k$].split(",").forEach((e=>{const[t,n]=e.split(":");this.urlFlags[t]=function(e,t){const n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:""+ +n===n?+n:t}(0,n)}))}}}function I$(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,r[0],r[1]),r.join("=")})),t}function C$(){return T$}let E$,T$=null;function N$(){if(null==E$){let e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}E$=e}return E$}function A$(e,t){const n=function(){const e=N$();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const R$="Abs",$$="Acos",_$="Acosh",O$="Add",D$="AddN",F$="All",M$="Any",L$="ArgMax",P$="ArgMin",z$="Asin",B$="Asinh",U$="Atan",W$="Atanh",V$="Atan2",j$="AvgPool",G$="AvgPoolGrad",H$="AvgPool3D",q$="AvgPool3DGrad",K$="BatchMatMul",X$="BatchToSpaceND",Y$="Bincount",Q$="BitwiseAnd",J$="BroadcastArgs",Z$="Cast",e_="Ceil",t_="ClipByValue",n_="Complex",r_="ComplexAbs",i_="Concat",s_="Conv2D",o_="Conv2DBackpropFilter",a_="Conv2DBackpropInput",l_="Conv3D",u_="Conv3DBackpropFilterV2",c_="Conv3DBackpropInputV2",h_="Cos",d_="Cosh",p_="Cumprod",f_="Cumsum",m_="CropAndResize",g_="DenseBincount",v_="DepthToSpace",y_="DepthwiseConv2dNative",b_="DepthwiseConv2dNativeBackpropFilter",x_="DepthwiseConv2dNativeBackpropInput",w_="Diag",k_="Dilation2D",S_="Dilation2DBackpropInput",I_="Dilation2DBackpropFilter",C_="Draw",E_="RealDiv",T_="Einsum",N_="Elu",A_="EluGrad",R_="Erf",$_="Equal",__="Exp",O_="ExpandDims",D_="Expm1",F_="FFT",M_="Fill",L_="FlipLeftRight",P_="Floor",z_="FloorDiv",B_="FusedBatchNorm",U_="GatherV2",W_="GatherNd",V_="Greater",j_="GreaterEqual",G_="Identity",H_="IFFT",q_="Imag",K_="IsFinite",X_="IsInf",Y_="IsNan",Q_="LeakyRelu",J_="Less",Z_="LessEqual",eO="LinSpace",tO="Log",nO="Log1p",rO="LogicalAnd",iO="LogicalNot",sO="LogicalOr",oO="LRN",aO="LRNGrad",lO="Max",uO="Maximum",cO="MaxPool",hO="MaxPoolGrad",dO="MaxPool3D",pO="MaxPool3DGrad",fO="MaxPoolWithArgmax",mO="Mean",gO="Min",vO="Minimum",yO="MirrorPad",bO="Mod",xO="Multinomial",wO="Multiply",kO="Neg",SO="NotEqual",IO="NonMaxSuppressionV3",CO="NonMaxSuppressionV4",EO="NonMaxSuppressionV5",TO="OnesLike",NO="OneHot",AO="Pack",RO="PadV2",$O="Pow",_O="Prelu",OO="Prod",DO="RaggedGather",FO="RaggedRange",MO="RaggedTensorToTensor",LO="Range",PO="Real",zO="Reciprocal",BO="Relu",UO="Reshape",WO="ResizeNearestNeighbor",VO="ResizeNearestNeighborGrad",jO="ResizeBilinear",GO="ResizeBilinearGrad",HO="Relu6",qO="Reverse",KO="Round",XO="Rsqrt",YO="ScatterNd",QO="TensorScatterUpdate",JO="SearchSorted",ZO="Select",eD="Selu",tD="Slice",nD="Sin",rD="Sinh",iD="Sign",sD="Sigmoid",oD="Softplus",aD="Sqrt",lD="Sum",uD="SpaceToBatchND",cD="SplitV",hD="Softmax",dD="SparseFillEmptyRows",pD="SparseReshape",fD="SparseSegmentMean",mD="SparseSegmentSum",gD="SparseToDense",vD="SquaredDifference",yD="Square",bD="StaticRegexReplace",xD="StridedSlice",wD="StringNGrams",kD="StringSplit",SD="StringToHashBucketFast",ID="Sub",CD="Tan",ED="Tanh",TD="Tile",ND="TopK",AD="Transform",RD="Transpose",$D="Unique",_D="Unpack",OD="UnsortedSegmentSum",DD="ZerosLike",FD="Step",MD="FromPixels",LD="RotateWithOffset",PD="_FusedMatMul",zD="FusedConv2D",BD="FusedDepthwiseConv2D";function UD(){C$().getBool("IS_TEST")||C$().getBool("PROD")||console.warn(...arguments)}function WD(){C$().getBool("IS_TEST")||C$().getBool("PROD")||console.log(...arguments)}const VD=A$("kernelRegistry",(()=>new Map)),jD=A$("gradRegistry",(()=>new Map));function GD(e,t){const n=YD(e,t);return VD.get(n)}function HD(e){return jD.get(e)}function qD(e){const t=VD.entries(),n=[];for(;;){const{done:r,value:i}=t.next();if(r)break;const[s,o]=i,[a]=s.split("_");a===e&&n.push(o)}return n}function KD(e){const{kernelName:t,backendName:n}=e,r=YD(t,n);VD.has(r)&&UD(`The kernel '${t}' for backend '${n}' is already registered`),VD.set(r,e)}function XD(e){const{kernelName:t}=e;jD.has(t)&&C$().getBool("DEBUG")&&UD(`Overriding the gradient for '${t}'`),jD.set(t,e)}function YD(e,t){return`${t}_${e}`}function QD(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var JD=n(7353);const ZD=n.n(JD)()||JD;function eF(e){return ZD.fromString(e,!0,16)}const tF=eF("c3a5c85c97cb3127"),nF=eF("b492b66fbe98f273"),rF=eF("9ae16a3b2f90404f");function iF(e){return e.xor(e.shru(47))}function sF(e,t,n){const r=e.slice(t,t+n);return ZD.fromBytes(Array.from(r),!0,!0)}function oF(e,t){return sF(e,t,8)}function aF(e,t){return sF(e,t,4)}function lF(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function uF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:eF("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function cF(e,t,n,r){return function(e,t,n,r,i,s){i=i.add(e),s=lF(s.add(i).add(r),21);const o=i;return i=(i=i.add(t)).add(n),s=s.add(lF(i,44)),[i.add(r),s.add(o)]}(oF(e,t),oF(e,t+8),oF(e,t+16),oF(e,t+24),n,r)}function hF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=ZD.fromNumber(81,!0);if(t<=32)return t<=16?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){const n=rF.add(2*t),r=oF(e,0).add(rF),i=oF(e,t-8);return uF(lF(i,37).mul(n).add(r),lF(r,25).add(i).mul(n),n)}if(t>=4){const n=rF.add(2*t);return uF(aF(e,0).shl(3).add(t),aF(e,t-4),n)}if(t>0){const n=e[0]+(e[t>>1]<<8),r=t+(e[t-1]<<2);return iF(rF.mul(n).xor(tF.mul(r))).mul(rF)}return rF}(e,t):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=rF.add(2*t),r=oF(e,0).mul(nF),i=oF(e,8),s=oF(e,t-8).mul(n),o=oF(e,t-16).mul(rF);return uF(lF(r.add(i),43).add(lF(s,30)).add(o),r.add(lF(i.add(rF),18)).add(s),n)}(e,t);if(t<=64)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=rF.add(2*t),r=oF(e,0).mul(rF),i=oF(e,8),s=oF(e,t-8).mul(n),o=oF(e,t-16).mul(rF),a=lF(r.add(i),43).add(lF(s,30)).add(o),l=uF(a,r.add(lF(i.add(rF),18)).add(s),n),u=oF(e,16).mul(n),c=oF(e,24),h=a.add(oF(e,t-32)).mul(n),d=l.add(oF(e,t-24)).mul(n);return uF(lF(u.add(c),43).add(lF(h,30)).add(d),u.add(lF(c.add(r),18)).add(h),n)}(e,t);let r=n,i=n.mul(nF).add(113),s=iF(i.mul(rF).add(113)).mul(rF),o=[ZD.UZERO,ZD.UZERO],a=[ZD.UZERO,ZD.UZERO];r=r.mul(rF).add(oF(e,0));let l=0;const u=64*(t-1>>6),c=u+(t-1&63)-63;do{r=lF(r.add(i).add(o[0]).add(oF(e,l+8)),37).mul(nF),i=lF(i.add(o[1]).add(oF(e,l+48)),42).mul(nF),r=r.xor(a[1]),i=i.add(o[0]).add(oF(e,l+40)),s=lF(s.add(a[0]),33).mul(nF),o=cF(e,l,o[1].mul(nF),r.add(a[0])),a=cF(e,l+32,s.add(a[1]),i.add(oF(e,l+16))),[s,r]=[r,s],l+=64}while(l!==u);const h=nF.add(s.and(255).shl(1));return l=c,a[0]=a[0].add(t-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=lF(r.add(i).add(o[0]).add(oF(e,l+8)),37).mul(h),i=lF(i.add(o[1]).add(oF(e,l+48)),42).mul(h),r=r.xor(a[1].mul(9)),i=i.add(o[0].mul(9).add(oF(e,l+40))),s=lF(s.add(a[0]),33).mul(h),o=cF(e,l,o[1].mul(h),r.add(a[0])),a=cF(e,l+32,s.add(a[1]),i.add(oF(e,l+16))),[s,r]=[r,s],uF(uF(o[0],a[0],h).add(iF(i).mul(tF)).add(s),uF(o[1],a[1],h).add(r),h)}function dF(e,t){return"string"===t?mF(e):pF([e],t)}function pF(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=yF(e)),C$().getBool("DEBUG")&&function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error(`Unknown data type ${t}`)}function fF(){return C$().platform.now()}function mF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",C$().platform.encode(e,t)}function gF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",C$().platform.decode(e,t)}function vF(e){return null!=C$().platform.isTypedArray?C$().platform.isTypedArray(e):QD(e)}function yF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||w$(e)||null==e||vF(e)&&n)t.push(e);else if(Array.isArray(e)||vF(e))for(let r=0;r<e.length;++r)yF(e[r],t,n);else{let r=-1;for(const t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(r=Math.max(r,Number(t)));for(let i=0;i<=r;i++)yF(e[i],t,n)}return t}class bF{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new wF)}profileKernel(e,t,n){let r;const i=()=>{r=n()};let s;const o=fF();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(i);else{i();for(const e of r)e.dataSync();s=Promise.resolve({kernelMs:fF()-o})}if(C$().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let a=0;a<r.length;a++){const t=r[a];t.data().then((n=>{xF(n,t.dtype,e)}))}return{kernelName:e,outputs:r,inputs:t,timeMs:s.then((e=>e.kernelMs)),extraInfo:s.then((e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""))}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:r,inputs:i,extraInfo:s}=e;n.forEach((e=>{Promise.all([e.data(),r,s]).then((n=>{this.logger.logKernelProfile(t,e,n[0],n[1],i,n[2])}))}))}}function xF(e,t,n){if("float32"!==t)return!1;for(let r=0;r<e.length;r++){const t=e[r];if(isNaN(t)||!isFinite(t))return console.warn(`Found ${t} in the result of '${n}'`),!0}return!1}class wF{logKernelProfile(e,t,n,r,i,s){const o="number"===typeof r?JR(`${r}ms`,9):r.error,a=JR(e,25),l=t.rank,u=t.size,c=JR(t.shape.toString(),14);let h="";for(const d in i){const e=i[d];if(null!=e){const n=e.shape||t.shape,r=n.length;h+=`${d}: ${r}D ${r>0?n:""} `}}console.log(`%c${a}\t%c${o}\t%c${l}D ${c}\t%c${u}\t%c${h}\t%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function kF(e,t,n,r){const i=d$(t),s=function(e,t,n,r){const i=KR(t),s=r[r.length-1],o=new Array(s).fill(0),a=t.length,l="complex64"===n?EF(e):e;if(a>1)for(let u=0;u<i/s;u++){const e=u*s;for(let t=0;t<s;t++)o[t]=Math.max(o[t],SF(l[e+t],0,n).length)}return o}(e,t,n,i),o=t.length,a=CF(e,t,n,i,s),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(a.map((e=>"    "+e)).join("\n")),l.join("\n")}function SF(e,t,n){let r;return r=Array.isArray(e)?`${parseFloat(e[0].toFixed(7))} + ${parseFloat(e[1].toFixed(7))}j`:a$(e)?`'${e}'`:"bool"===n?IF(e):parseFloat(e.toFixed(7)).toString(),JR(r,t)}function IF(e){return 0===e?"false":"true"}function CF(e,t,n,r,i){let s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const o="complex64"===n?2:1,a=t[0],l=t.length;if(0===l){if("complex64"===n){return[SF(EF(e)[0],0,n)]}return"bool"===n?[IF(e[0])]:[e[0].toString()]}if(1===l){if(a>20){const t=3*o;let r=Array.from(e.slice(0,t)),s=Array.from(e.slice((a-3)*o,a*o));return"complex64"===n&&(r=EF(r),s=EF(s)),["["+r.map(((e,t)=>SF(e,i[t],n))).join(", ")+", ..., "+s.map(((e,t)=>SF(e,i[a-3+t],n))).join(", ")+"]"]}return["["+("complex64"===n?EF(e):Array.from(e)).map(((e,t)=>SF(e,i[t],n))).join(", ")+"]"]}const u=t.slice(1),c=r.slice(1),h=r[0]*o,d=[];if(a>20){for(let t=0;t<3;t++){const r=t*h,s=r+h;d.push(...CF(e.slice(r,s),u,n,c,i,!1))}d.push("...");for(let t=a-3;t<a;t++){const r=t*h,s=r+h;d.push(...CF(e.slice(r,s),u,n,c,i,t===a-1))}}else for(let m=0;m<a;m++){const t=m*h,r=t+h;d.push(...CF(e.slice(t,r),u,n,c,i,m===a-1))}const p=2===l?",":"";d[0]="["+(a>0?d[0]+p:"");for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+p;let f=",\n";for(let m=2;m<l;m++)f+="\n";return d[d.length-1]=" "+d[d.length-1]+"]"+(s?"":f),d}function EF(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}class TF{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=KR(e),null!=n){const e=n.length;GR(e===this.size,(()=>`Length of values '${e}' does not match the size inferred by the shape '${this.size}'.`))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||i$(t,this.size),this.strides=d$(e)}set(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),GR(n.length===this.rank,(()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`));const i=this.locToIndex(n);this.values[i]=e}get(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);let r=0;for(const s of t){if(s<0||s>=this.shape[r]){const e=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(e)}r++}let i=t[t.length-1];for(let s=0;s<t.length-1;++s)i+=this.strides[s]*t[s];return this.values[i]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return NF().makeTensor(this.values,this.shape,this.dtype)}}let NF=null,AF=null,RF=null;class $F{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=KR(e),this.strides=d$(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return AF.buffer(this.shape,this.dtype,e)}bufferSync(){return AF.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return f$(this.shape,e,"complex64"===this.dtype)}arraySync(){return f$(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=NF().read(this.dataId);if("string"===this.dtype){const n=await e;try{return n.map((e=>gF(e)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),NF().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=NF().readSync(this.dataId);if("string"===this.dtype)try{return e.map((e=>gF(e)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await NF().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),NF().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return AF.print(this,e)}clone(){return this.throwIfDisposed(),AF.clone(this)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return kF(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),AF.cast(this,e)}variable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),NF().makeVariable(this,e,t,n)}}function _F(){return A$("Tensor",(()=>$F))}Object.defineProperty($F,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),_F();class OF extends $F{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!XR(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);NF().disposeTensor(this),this.dataId=e.dataId,NF().incRef(this,null)}dispose(){NF().disposeVariable(this),this.isDisposedInternal=!0}}var DF,FF,MF,LF,PF,zF,BF,UF,WF,VF;Object.defineProperty(OF,Symbol.hasInstance,{value:e=>e instanceof $F&&null!=e.assign&&e.assign instanceof Function}),(FF=DF||(DF={})).R0="R0",FF.R1="R1",FF.R2="R2",FF.R3="R3",FF.R4="R4",FF.R5="R5",FF.R6="R6",(LF=MF||(MF={})).float32="float32",LF.int32="int32",LF.bool="int32",LF.complex64="complex64",(zF=PF||(PF={})).float32="float32",zF.int32="int32",zF.bool="bool",zF.complex64="complex64",(UF=BF||(BF={})).float32="float32",UF.int32="float32",UF.bool="float32",UF.complex64="complex64",(VF=WF||(WF={})).float32="complex64",VF.int32="complex64",VF.bool="complex64",VF.complex64="complex64";const jF={float32:BF,int32:MF,bool:PF,complex64:WF};function GF(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return jF[e][t]}function HF(e){return GF(e,"int32")}function qF(e){return null!=e&&"object"===typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function KF(e){return"undefined"!==typeof GPUBuffer&&null!=e&&"object"===typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function XF(e,t){if(e.dtype===t.dtype)return[e,t];const n=GF(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function YF(e,t){return t.some((t=>t.id===e.id))}function QF(e){const t=[];return JF(e,t,new Set),t}function JF(e,t,n){if(null==e)return;if(e instanceof $F)return void t.push(e);if(r=e,!Array.isArray(r)&&"object"!==typeof r)return;var r;const i=e;for(const s in i){const e=i[s];n.has(e)||(n.add(e),JF(e,t,n))}}function ZF(e){return null!=e.kernelName}class eM{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((e=>e.name))))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class tM{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new eM}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(UD(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new bF(this.backendInstance),!0}setupRegisteredKernels(){qD(this.backendName).forEach((e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(e){qD(e).forEach((t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])}))}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const n=t.factory();if(!n||n instanceof zR||"function"!==typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,r=n.then((n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0))).catch((n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,UD(`Initialization of backend ${e} failed`),UD(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return UD(`Initialization of backend ${e} failed`),UD(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority))}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),r=n.backend,i=this.readSync(t),s=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,i,n.shape,n.dtype,s),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(e,t,n){e();try{const e=n();return t(),e}catch(r){throw t(),r}}nextTensorId(){return tM.nextTensorId++}nextVariableId(){return tM.nextVariableId++}clone(e){const t=rM.runKernel(G_,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(e=>({x:()=>{const t={x:e},n={dtype:"float32"};return rM.runKernel(Z$,t,n)}})),[],{}),t}runKernel(e,t,n){null==this.backendName&&this.backend;if(!(null!=GD(e,this.backendName)))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const r=this.backend.numDataIds();let i=0;n.forEach((e=>{i+="complex64"===e.dtype?3:1}));const s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-i-s;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,n=[];const r=this.isTapeOn(),i=this.state.numBytes,s=this.state.numTensors;let o,a;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const l=ZF(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(ZF(e)){const{kernelName:t,inputs:i,attrs:s}=e;null==this.backendName&&this.backend;const l=GD(t,this.backendName);GR(null!=l,(()=>`Cannot find registered kernel '${t}' for backend '${this.backendName}'`)),o=()=>{const e=this.backend.numDataIds();a=l.kernelFunc({inputs:i,attrs:s,backend:this.backend});const o=Array.isArray(a)?a:[a];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,o);const u=o.map((e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e)));if(r){const e=this.getTensorsForGradient(t,i,u);n=this.saveTensorsForBackwardMode(e)}return u}}else{const{forwardFunc:t}=e,i=e=>{r&&(n=e.map((e=>this.keep(this.clone(e)))))};o=()=>{const e=this.backend.numDataIds();a=this.tidy((()=>t(this.backend,i)));const n=Array.isArray(a)?a:[a];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,e,n),n}}const{inputs:u,attrs:c}=e,h=ZF(e)?null:e.backwardsFunc;let d;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(d=this.profiler.profileKernel(l,u,(()=>o())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),t=d.outputs):t=o()})),r&&this.addTapeNode(l,u,t,h,n,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map((e=>null!=u[e]?u[e].shape:null)),outputShapes:t.map((e=>e.shape)),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(a)?t:t[0]}saveTensorsForBackwardMode(e){return e.map((e=>this.keep(this.clone(e))))}getTensorsForGradient(e,t,n){const r=HD(e);if(null!=r){const e=r.inputsToSave||[],i=r.outputsToSave||[];let s;r.saveAllInputs?(GR(Array.isArray(t),(()=>"saveAllInputs is true, expected inputs to be an array.")),s=Object.keys(t).map((e=>t[e]))):s=e.map((e=>t[e]));const o=n.filter(((e,t)=>i[t]));return s.concat(o)}return[]}makeTensor(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=e;"string"===n&&a$(e[0])&&(i=e.map((e=>mF(e))));const s=r.write(i,t,n),o=new $F(t,n,s,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){const e=this.state.tensorInfo.get(s),t=function(e){if(null==e)return 0;let t=0;return e.forEach((e=>t+=e.length)),t}(i);this.state.numBytes+=t-e.bytes,e.bytes=t}return o}makeTensorFromDataId(e,t,n,r){const i={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:r,dtype:i}=e,s=new $F(r,i,n,this.nextTensorId());return this.trackTensor(s,t),s}makeVariable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));const i=new OF(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*o$(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof OF||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*o$(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((e=>e.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,i,s){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:i},a=HD(e);null!=a&&(r=a.gradFunc),null!=r&&(o.gradient=e=>(e=e.map(((e,t)=>{if(null==e){const e=n[t],r=g$(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e})),r(e.length>1?e:e[0],i,s))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=QF(e),n=new Set(t.map((e=>e.id)));for(let i=0;i<this.state.activeScope.track.length;i++){const e=this.state.activeScope.track[i];e.kept||n.has(e.id)||e.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach((e=>{e.kept||e.scopeId!==r.id||this.track(e)}))}gradients(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(GR(t.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const i=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",e)));GR(i instanceof $F,(()=>"The result y returned by f() must be a tensor."));const s=function(e,t,n){const r={},i={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){const n=e[l],s=n.inputs;for(const e in s){const o=s[e];let a=!1;for(let e=0;e<t.length;e++)if(r[o.id]){n.outputs.forEach((e=>r[e.id]=!0)),a=!0,i[n.id]=!0;break}if(a)break}}const s={};s[n.id]=!0;const o={};for(let l=e.length-1;l>=0;l--){const t=e[l],n=t.inputs;for(let e=0;e<t.outputs.length;e++)if(s[t.outputs[e].id]){for(const e in n)s[n[e].id]=!0,o[t.id]=!0;break}}const a=[];for(let l=0;l<e.length;l++){const t=e[l];if(i[t.id]&&o[t.id]){const e={};for(const i in t.inputs){const n=t.inputs[i];r[n.id]&&(e[i]=n)}const n=Object.assign({},t);n.inputs=e,n.outputs=t.outputs,a.push(n)}}return a}(this.state.activeTape,t,i);if(!r&&0===s.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const e={};e[i.id]=null==n?function(e){const t=m$(KR(e),"float32");return rM.makeTensor(t,e,"float32")}(i.shape):n,function(e,t,n,r){for(let i=t.length-1;i>=0;i--){const s=t[i],o=[];if(s.outputs.forEach((t=>{const n=e[t.id];null!=n?o.push(n):o.push(null)})),null==s.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const a=s.gradient(o);for(const t in s.inputs){if(!(t in a))throw new Error(`Cannot backprop through input ${t}. Available gradients found: ${Object.keys(a)}.`);const i=n((()=>a[t]()));if("float32"!==i.dtype)throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${t} must have 'float32' dtype, but has '${i.dtype}'`);const o=s.inputs[t];if(!XR(i.shape,o.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${t}' has shape '${i.shape}', which does not match the shape of the input '${o.shape}'`);if(null==e[o.id])e[o.id]=i;else{const t=e[o.id];e[o.id]=r(t,i),t.dispose()}}}}(e,s,(e=>this.tidy(e)),iM);const r=t.map((t=>e[t.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((e=>{for(const t of e.saved)t.dispose()})),this.state.activeTape=null),{value:i,grads:r}}))}customGrad(e){var t=this;return GR(c$(e),(()=>"The f passed in customGrad(f) must be a function.")),function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];let s;GR(r.every((e=>e instanceof $F)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const o={};r.forEach(((e,t)=>{o[t]=e}));return t.runKernelFunc({forwardFunc:(t,n)=>(s=e(...r,n),GR(s.value instanceof $F,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),GR(c$(s.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),s.value),backwardsFunc:(e,t)=>{const n=s.gradFunc(e,t),i=Array.isArray(n)?n:[n];GR(i.length===r.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),GR(i.every((e=>e instanceof $F)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const o={};return i.forEach(((e,t)=>{o[t]=()=>e})),o},inputs:o})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=fF(),n=await this.backend.time(e);return n.wallMs=fF()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new eM;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function nM(){const e=N$();if(null==e._tfengine){const t=new S$(e);e._tfengine=new tM(t)}var t;return t=e._tfengine.ENV,T$=t,NF=()=>e._tfengine,e._tfengine}tM.nextTensorId=0,tM.nextVariableId=0;const rM=nM();function iM(e,t){const n={a:e,b:t};return rM.runKernel(O$,n)}let sM;function oM(e){if(void 0!==sM)return sM;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;const t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){const t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function aM(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}const lM=C$();function uM(e,t){let n=e;if(vF(e))return"string"===t?[]:[e.length];if(qF(e)){const t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(KF(e))return[e.buffer.size/(null==t?4:o$(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||vF(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&C$().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&cM(e,r,[]),r}function cM(e,t,n){if(n=n||[],!Array.isArray(e)&&!vF(e))return void GR(0===t.length,(()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`));GR(t.length>0,(()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`)),GR(e.length===t[0],(()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`));const r=t.slice(1);for(let i=0;i<e.length;++i)cM(e[i],r,n.concat(i))}function hM(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function dM(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof _F())return hM(r,e.dtype,t,n),e;let i=u$(e);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),hM(r,i,t,n),null==e||!vF(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){const r=null==e?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const s=uM(e,i);vF(e)||Array.isArray(e)||(e=[e]);const o="string"!==i?pF(e,i):yF(e,[],!0);return rM.makeTensor(o,s,i)}function pM(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map(((e,i)=>dM(e,`${t}[${i}]`,n,r)))}lM.registerFlag("DEBUG",(()=>!1),(e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),lM.registerFlag("IS_BROWSER",(()=>aM())),lM.registerFlag("IS_NODE",(()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node)),lM.registerFlag("IS_CHROME",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),lM.registerFlag("IS_SAFARI",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),lM.registerFlag("PROD",(()=>!1)),lM.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>lM.getBool("DEBUG"))),lM.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),lM.registerFlag("IS_TEST",(()=>!1)),lM.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>lM.getBool("DEBUG"))),lM.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),lM.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),lM.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1));function fM(e){const t=Object.keys(e);if(1!==t.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";const i=function(){rM.startScope(n);try{const e=r(...arguments);return w$(e)&&console.error("Cannot return a Promise inside of tidy."),rM.endScope(e),e}catch(e){throw rM.endScope(null),e}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}const mM=fM({complex_:function(e,t){const n=dM(e,"real","complex"),r=dM(t,"imag","complex");HR(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:n,imag:r};return rM.runKernel(n_,i)}});function gM(e,t,n,r){if(null==r)r=u$(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(KF(e)||qF(e)){if("float32"!==r&&"int32"!==r)throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return rM.backend.createTensorFromGPUData(e,t||n,r)}if(!vF(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){y$(t);const e=KR(t),r=KR(n);GR(e===r,(()=>`Based on the provided shape, [${t}], the tensor should have ${e} values but has ${r}`));for(let i=0;i<n.length;++i){const e=n[i],r=i!==n.length-1||e!==KR(t.slice(i));GR(n[i]===t[i]||!r,(()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `))}}return vF(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?pF(e,r):yF(e,[],!0),rM.makeTensor(e,t,r)}function vM(e,t,n){return gM(e,t,uM(e,n),n)}class yM{static join(e){return new yM(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e)return;if(e instanceof Array||(e=[e]),0===(e=e.map((e=>vF(e)?e.buffer:e))).length)return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){const r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=t+r.byteLength;this.shards.push({buffer:r,start:t,end:i}),t=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const n=this.findShardForByte(e);if(-1===n)throw new Error(`Could not find start shard for byte ${e}`);const r=new ArrayBuffer(t-e),i=new Uint8Array(r);let s=0;for(let o=n;o<this.shards.length;o++){const n=this.shards[o],r=e+s-n.start,a=s,l=Math.min(t,n.end)-n.start,u=new Uint8Array(n.buffer,r,l-r);if(i.set(u,a),s+=u.length,t<n.end)break}return r}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(e,t){let n=0,r=e.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,s=t(e[i]);if(0===s)return i;s<0?r=i:n=i+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function bM(){return rM}function xM(){return rM.memory()}function wM(e,t){return rM.tidy(e,t)}function kM(e){QF(e).forEach((e=>e.dispose()))}function SM(e){return rM.keep(e)}function IM(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return rM.registerBackend(e,t,n)}function CM(){return rM.backend}RF=function(e){C$().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")};async function EM(e,t){const n=[],r=[],i=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);for(let s=0;s<i.length;++s){const o=i[s],a=Array.isArray(e)?e[s].tensor:e[o];if("float32"!==a.dtype&&"int32"!==a.dtype&&"bool"!==a.dtype&&"string"!==a.dtype&&"complex64"!==a.dtype)throw new Error(`Unsupported dtype in weight '${o}': ${a.dtype}`);const l={name:o,shape:a.shape,dtype:a.dtype};if("string"===a.dtype){const e=new Promise((async e=>{const t=await a.bytes(),n=t.reduce(((e,t)=>e+t.length),0)+4*t.length,r=new Uint8Array(n);let i=0;for(let s=0;s<t.length;s++){const e=t[s],n=new Uint8Array(new Uint32Array([e.length]).buffer);r.set(n,i),i+=4,r.set(e,i),i+=e.length}e(r)}));r.push(e)}else r.push(a.data());null!=t&&(l.group=t),n.push(l)}return{data:TM(await Promise.all(r)),specs:n}}function TM(e){if(null===e)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach((e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${e.constructor.name}`)}));const r=new Uint8Array(t);let i=0;return n.forEach((e=>{r.set(new Uint8Array(e.buffer),i),i+=e.byteLength})),r.buffer}const NM="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function AM(e){return NM?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function RM(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}async function $M(e,t){let n,r;return null!=e.weightsManifest&&([n,r]=await t(e.weightsManifest)),function(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}(e,n,r)}function _M(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:AM(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:AM(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new yM(e.weightData).byteLength}}function OM(e){const t=[];for(const n of e)t.push(...n.weights);return t}class DM{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==DM.instance&&(DM.instance=new DM),DM.instance}static registerSaveRouter(e){DM.getInstance().saveRouters.push(e)}static registerLoadRouter(e){DM.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return DM.getHandlers(e,"save")}static getLoadHandlers(e,t){return DM.getHandlers(e,"load",t)}static getHandlers(e,t,n){const r=[];return("load"===t?DM.getInstance().loadRouters:DM.getInstance().saveRouters).forEach((t=>{const i=t(e,n);null!==i&&r.push(i)})),r}}const FM="tensorflowjs",MM="models_store",LM="model_info_store";function PM(){if(!C$().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function zM(e){const t=e.result;t.createObjectStore(MM,{keyPath:"modelPath"}),t.createObjectStore(LM,{keyPath:"modelPath"})}class BM{constructor(e){if(this.indexedDB=PM(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise(((e,n)=>{const r=this.indexedDB.open(FM,1);r.onupgradeneeded=()=>zM(r),r.onsuccess=()=>{const i=r.result;if(null==t){const t=i.transaction(MM,"readonly"),r=t.objectStore(MM).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return i.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));e(r.result.modelArtifacts)},r.onerror=e=>(i.close(),n(r.error)),t.oncomplete=()=>i.close()}else{t.weightData=yM.join(t.weightData);const r=_M(t),o=i.transaction(LM,"readwrite");let a,l,u=o.objectStore(LM);try{a=u.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(s){return n(s)}a.onsuccess=()=>{l=i.transaction(MM,"readwrite");const a=l.objectStore(MM);let c;try{c=a.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:r})}catch(s){return n(s)}c.onsuccess=()=>e({modelArtifactsInfo:r}),c.onerror=e=>{u=o.objectStore(LM);const t=u.delete(this.modelPath);t.onsuccess=()=>(i.close(),n(c.error)),t.onerror=e=>(i.close(),n(c.error))}},a.onerror=e=>(i.close(),n(a.error)),o.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}}},r.onerror=e=>n(r.error)}))}}BM.URL_SCHEME="indexeddb://";const UM=e=>{return C$().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(BM.URL_SCHEME)?(t=e.slice(BM.URL_SCHEME.length),new BM(t)):null;var t};DM.registerSaveRouter(UM),DM.registerLoadRouter(UM);class WM{constructor(){this.indexedDB=PM()}async listModels(){return new Promise(((e,t)=>{const n=this.indexedDB.open(FM,1);n.onupgradeneeded=()=>zM(n),n.onsuccess=()=>{const r=n.result,i=r.transaction(LM,"readonly"),s=i.objectStore(LM).getAll();s.onsuccess=()=>{const t={};for(const e of s.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},s.onerror=e=>(r.close(),t(s.error)),i.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)}))}async removeModel(e){var t;return e=(t=e).startsWith(BM.URL_SCHEME)?t.slice(BM.URL_SCHEME.length):t,new Promise(((t,n)=>{const r=this.indexedDB.open(FM,1);r.onupgradeneeded=()=>zM(r),r.onsuccess=()=>{const i=r.result,s=i.transaction(LM,"readwrite"),o=s.objectStore(LM),a=o.get(e);let l;a.onsuccess=()=>{if(null==a.result)return i.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const r=o.delete(e),s=()=>{l=i.transaction(MM,"readwrite");const r=l.objectStore(MM).delete(e);r.onsuccess=()=>t(a.result.modelArtifactsInfo),r.onerror=e=>n(a.error)};r.onsuccess=s,r.onerror=e=>(s(),i.close(),n(a.error))}},a.onerror=e=>(i.close(),n(a.error)),s.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}},r.onerror=e=>n(r.error)}))}}const VM="/",jM="tensorflowjs_models",GM="info",HM="model_topology",qM="weight_specs",KM="weight_data",XM="model_metadata";function YM(e){return{info:[jM,e,GM].join(VM),topology:[jM,e,HM].join(VM),weightSpecs:[jM,e,qM].join(VM),weightData:[jM,e,KM].join(VM),modelMetadata:[jM,e,XM].join(VM)}}function QM(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function JM(e){const t=e.split(VM);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(VM)}class ZM{constructor(e){if(!C$().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=YM(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),i=_M(e),s=yM.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(e){if(NM)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,i=t.length;r<i;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(s));const t={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(t)),{modelArtifactsInfo:i}}catch(t){throw QM(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const e=JSON.parse(i);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const s=this.LS.getItem(this.keys.weightData);if(null==s)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=function(e){if(NM){const t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}(s),t}}ZM.URL_SCHEME="localstorage://";const eL=e=>{return C$().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ZM.URL_SCHEME)?(t=e.slice(ZM.URL_SCHEME.length),new ZM(t)):null;var t};DM.registerSaveRouter(eL),DM.registerLoadRouter(eL);class tL{constructor(){GR(C$().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),GR("undefined"===typeof window||"undefined"!==typeof window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const e={},t=jM+VM,n=VM+GM;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(t)&&i.endsWith(n)){e[JM(i)]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){var t;const n=YM(e=(t=e).startsWith(ZM.URL_SCHEME)?t.slice(ZM.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return QM(n),r}}const nL="://";class rL{constructor(){this.managers={}}static getInstance(){return null==rL.instance&&(rL.instance=new rL),rL.instance}static registerManager(e,t){GR(null!=e,(()=>"scheme must not be undefined or null.")),e.endsWith(nL)&&(e=e.slice(0,e.indexOf(nL))),GR(e.length>0,(()=>"scheme must not be an empty string."));const n=rL.getInstance();GR(null==n.managers[e],(()=>`A model store manager is already registered for scheme '${e}'.`)),n.managers[e]=t}static getManager(e){const t=rL.getInstance().managers[e];if(null==t)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(rL.getInstance().managers)}}class iL{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!==typeof window&&C$().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(e=>{if(e.source===window&&e.data.name===this.messageName){e.stopPropagation();(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}}),!0))):setTimeout(e,t)}isTypedArray(e){return QD(e)}}if(C$().get("IS_BROWSER")){C$().setPlatform("browser",new iL);try{rL.registerManager(ZM.URL_SCHEME,new tL)}catch(pae){}try{rL.registerManager(BM.URL_SCHEME,new WM)}catch(pae){}}const sL=()=>n(5817);let oL;class aL{constructor(){this.util=n(8590),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=C$().global.fetch?C$().global.fetch(e,t):(null==oL&&(oL=sL()),oL(e,t))}now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}function lL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",y$(e),new TF(e,t,n)}C$().get("IS_NODE")&&!C$().get("IS_BROWSER")&&C$().setPlatform("node",new aL);const uL=fM({cast_:function(e,t){const n=dM(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:t};return rM.runKernel(Z$,r,i)}});const cL=fM({clone_:function(e){const t={x:dM(e,"x","clone","string_or_numeric")};return rM.runKernel(G_,t)}});nM();AF={buffer:lL,cast:uL,clone:cL,print:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}};const hL=fM({add_:function(e,t){let n=dM(e,"a","add"),r=dM(t,"b","add");[n,r]=XF(n,r);const i={a:n,b:r};return rM.runKernel(O$,i)}});const dL=fM({floorDiv_:function(e,t){let n=dM(e,"a","floorDiv"),r=dM(t,"b","floorDiv");[n,r]=XF(n,r);const i={a:n,b:r};return rM.runKernel(z_,i)}});const pL=fM({div_:function(e,t){let n=dM(e,"a","div"),r=dM(t,"b","div");if([n,r]=XF(n,r),"int32"===n.dtype&&"int32"===r.dtype)return dL(n,r);const i={a:n,b:r};return rM.runKernel(E_,i,{})}});const fL=fM({mul_:function(e,t){let n=dM(e,"a","mul"),r=dM(t,"b","mul");[n,r]=XF(n,r);const i={a:n,b:r};return rM.runKernel(wO,i)}});const mL=fM({sqrt_:function(e){const t={x:dM(e,"x","sqrt","float32")};return rM.runKernel(aD,t)}});const gL=fM({square_:function(e){const t=dM(e,"x","square");return rM.runKernel("Square",{x:t},{})}});const vL=fM({zerosLike_:function(e){const t={x:dM(e,"x","zerosLike")};return rM.runKernel(DD,t)}});function yL(e){return rM.customGrad(e)}function bL(e,t){if((vF(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&vF(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return gM(e,[],[],t)}const xL=new Map,wL=new Map;class kL{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class SL{constructor(){this.classNameMap={}}static getMap(){return null==SL.instance&&(SL.instance=new SL),SL.instance}static register(e){SL.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function IL(e,t,n){GR(null!=e.className,(()=>"Class being registered does not have the static className property defined.")),GR("string"===typeof e.className,(()=>"className is required to be a string, but got type "+typeof e.className)),GR(e.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),"undefined"===typeof t&&(t="Custom"),"undefined"===typeof n&&(n=e.className);const r=t+">"+n;return SL.register(e),xL.set(r,e),wL.set(e,r),e}class CL extends kL{minimize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:r,grads:i}=this.computeGradients(e,n);if(null!=n){const e=n.map((e=>({name:e.name,tensor:i[e.name]})));this.applyGradients(e)}else this.applyGradients(i);return kM(i),t?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return function(e,t){GR(c$(e),(()=>"The f passed in variableGrads(f) must be a function")),GR(null==t||Array.isArray(t)&&t.every((e=>e instanceof OF)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=t;if(!n){t=[];for(const e in rM.registeredVariables)t.push(rM.registeredVariables[e])}const r=n?t.filter((e=>!e.trainable)):null,i=t.length;GR((t=t.filter((e=>e.trainable))).length>0,(()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`));const{value:s,grads:o}=rM.gradients(e,t,null,!0);GR(o.some((e=>null!=e)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),GR(0===s.rank,(()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${s.rank} tensor`));const a={};return t.forEach(((e,t)=>{null!=o[t]&&(a[e.name]=o[t])})),null!=r&&r.forEach((e=>a[e.name]=null)),{value:s,grads:a}}(e,t)}dispose(){null!=this.iterations_&&kM(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:bL(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(CL,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});class EL extends CL{static get className(){return"Adadelta"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=rM.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=rM.registeredVariables[t],i=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${t}/accum_grad`,variable:wM((()=>vL(r).variable(i)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:`${t}/accum_var`,variable:wM((()=>vL(r).variable(i)))});const s=Array.isArray(e)?e[n].tensor:e[t];if(null==s)return;const o=this.accumulatedGrads[n].variable,a=this.accumulatedUpdates[n].variable;wM((()=>{const e=hL(fL(o,this.rho),fL(gL(s),1-this.rho)),t=fL(pL(mL(hL(a,this.epsilon)),mL(hL(o,this.epsilon))),s),n=hL(fL(a,this.rho),fL(gL(t),1-this.rho));o.assign(e),a.assign(n);const i=hL(fL(t,-this.learningRate),r);r.assign(i)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(kM(this.accumulatedGrads.map((e=>e.variable))),kM(this.accumulatedUpdates.map((e=>e.variable))))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){const t=(e=await this.extractIterations(e)).length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedUpdates=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}function TL(e,t,n){y$(e);const r={shape:e,value:t,dtype:n=n||u$(t)};return rM.runKernel(M_,{},r)}class NL extends CL{static get className(){return"Adagrad"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=rM.registeredVariables[t];if(null==this.accumulatedGrads[n]){const e=!1;this.accumulatedGrads[n]={originalName:`${t}/accumulator`,variable:wM((()=>TL(r.shape,this.initialAccumulatorValue).variable(e)))}}const i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;const s=this.accumulatedGrads[n].variable;wM((()=>{const e=hL(s,gL(i));s.assign(e);const t=hL(fL(pL(i,mL(hL(e,rM.backend.epsilon()))),-this.learningRate),r);r.assign(t)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&kM(this.accumulatedGrads.map((e=>e.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);this.accumulatedGrads=e.map((e=>({originalName:e.name,variable:e.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}const AL=fM({pow_:function(e,t){let n=dM(e,"base","pow"),r=dM(t,"exp","pow");[n,r]=XF(n,r);const i={a:n,b:r};return rM.runKernel($O,i)}});const RL=fM({sub_:function(e,t){let n=dM(e,"a","sub"),r=dM(t,"b","sub");[n,r]=XF(n,r);const i={a:n,b:r};return rM.runKernel(ID,i)}});class $L extends CL{static get className(){return"Adam"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],wM((()=>{this.accBeta1=bL(t).variable(),this.accBeta2=bL(n).variable()})),null==r&&(this.epsilon=rM.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);wM((()=>{const n=RL(1,this.accBeta1),r=RL(1,this.accBeta2);t.forEach(((t,i)=>{const s=rM.registeredVariables[t],o=!1;null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${t}/m`,variable:wM((()=>vL(s).variable(o)))}),null==this.accumulatedSecondMoment[i]&&(this.accumulatedSecondMoment[i]={originalName:`${t}/v`,variable:wM((()=>vL(s).variable(o)))});const a=Array.isArray(e)?e[i].tensor:e[t];if(null==a)return;const l=this.accumulatedFirstMoment[i].variable,u=this.accumulatedSecondMoment[i].variable,c=hL(fL(l,this.beta1),fL(a,1-this.beta1)),h=hL(fL(u,this.beta2),fL(gL(a),1-this.beta2)),d=pL(c,n),p=pL(h,r);l.assign(c),u.assign(h);const f=hL(fL(pL(d,hL(mL(p),this.epsilon)),-this.learningRate),s);s.assign(f)})),this.accBeta1.assign(fL(this.accBeta1,this.beta1)),this.accBeta2.assign(fL(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&kM(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedSecondMoment&&kM(this.accumulatedSecondMoment.map((e=>e.variable)))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e),wM((()=>{this.accBeta1.assign(AL(this.beta1,this.iterations_+1)),this.accBeta2.assign(AL(this.beta2,this.iterations_+1))}));const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedSecondMoment=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}const _L=fM({abs_:function(e){const t=dM(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return rM.runKernel(r_,e)}{const e={x:t};return rM.runKernel(R$,e)}}});function OL(e,t){const n=e.length,r=[];for(let i=0;i<n;i++){const s=n-1-i,o=e[s]||1;(t[t.length-1-i]||1)>1&&1===o&&r.unshift(s)}return r}function DL(e,t){const n=[];for(let r=0;r<t.length;r++){const i=e[e.length-r-1],s=t.length-r-1,o=t[s];(null==i||1===i&&o>1)&&n.unshift(s)}return n}function FL(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let i=0;i<n;i++){let s=e[e.length-i-1];null==s&&(s=1);let o=t[t.length-i-1];if(null==o&&(o=1),1===s)r[n-i-1]=o;else if(1===o)r[n-i-1]=s;else{if(s!==o){throw Error(`Operands could not be broadcast together with shapes ${e} and ${t}.`)}r[n-i-1]=s}}return r}const ML=fM({maximum_:function(e,t){let n=dM(e,"a","maximum"),r=dM(t,"b","maximum");[n,r]=XF(n,r),"bool"===n.dtype&&(n=uL(n,"int32"),r=uL(r,"int32")),FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel(uO,i)}});class LL extends CL{static get className(){return"Adamax"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],wM((()=>{this.iteration=bL(0).variable(),this.accBeta1=bL(t).variable()})),null==r&&(this.epsilon=rM.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);wM((()=>{const n=RL(1,this.accBeta1),r=pL(-this.learningRate,hL(fL(this.iteration,this.decay),1));t.forEach(((t,i)=>{const s=rM.registeredVariables[t],o=!1;null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${t}/m`,variable:vL(s).variable(o)}),null==this.accumulatedWeightedInfNorm[i]&&(this.accumulatedWeightedInfNorm[i]={originalName:`${t}/v`,variable:vL(s).variable(o)});const a=Array.isArray(e)?e[i].tensor:e[t];if(null==a)return;const l=this.accumulatedFirstMoment[i].variable,u=this.accumulatedWeightedInfNorm[i].variable,c=hL(fL(l,this.beta1),fL(a,1-this.beta1)),h=fL(u,this.beta2),d=_L(a),p=ML(h,d);l.assign(c),u.assign(p);const f=hL(fL(pL(r,n),pL(c,hL(p,this.epsilon))),s);s.assign(f)})),this.iteration.assign(hL(this.iteration,1)),this.accBeta1.assign(fL(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&kM(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedWeightedInfNorm&&kM(this.accumulatedWeightedInfNorm.map((e=>e.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}class PL extends CL{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;const i=rM.registeredVariables[t];wM((()=>{const e=hL(fL(this.c,r),i);i.assign(e)}))})),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=SM(bL(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}class zL extends PL{static get className(){return"Momentum"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=bL(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=rM.registeredVariables[t];if(null==this.accumulations[n]){const e=!1;this.accumulations[n]={originalName:`${t}/momentum`,variable:wM((()=>vL(r).variable(e)))}}const i=this.accumulations[n].variable,s=Array.isArray(e)?e[n].tensor:e[t];null!=s&&wM((()=>{let e;const t=hL(fL(this.m,i),s);e=this.useNesterov?hL(fL(this.c,hL(s,fL(t,this.m))),r):hL(fL(this.c,t),r),i.assign(t),r.assign(e)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&kM(this.accumulations.map((e=>e.variable)))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);this.accumulations=e.map((e=>({originalName:e.name,variable:e.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}class BL extends CL{static get className(){return"RMSProp"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,null==r&&(this.epsilon=rM.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=rM.registeredVariables[t],i=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:`${t}/rms`,variable:wM((()=>vL(r).variable(i)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:`${t}/momentum`,variable:wM((()=>vL(r).variable(i)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${t}/mg`,variable:wM((()=>vL(r).variable(i)))});const s=Array.isArray(e)?e[n].tensor:e[t];if(null==s)return;const o=this.accumulatedMeanSquares[n].variable,a=this.accumulatedMoments[n].variable;wM((()=>{const e=hL(fL(o,this.decay),fL(gL(s),1-this.decay));if(this.centered){const t=this.accumulatedMeanGrads[n].variable,i=hL(fL(t,this.decay),fL(s,1-this.decay)),l=pL(fL(s,this.learningRate),mL(RL(e,hL(gL(i),this.epsilon)))),u=hL(fL(a,this.momentum),l);o.assign(e),t.assign(i),a.assign(u);const c=RL(r,u);r.assign(c)}else{const e=hL(fL(o,this.decay),fL(gL(s),1-this.decay)),t=hL(fL(a,this.momentum),pL(fL(s,this.learningRate),mL(hL(e,this.epsilon))));o.assign(e),a.assign(t);const n=RL(r,t);r.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&kM(this.accumulatedMeanSquares.map((e=>e.variable))),null!=this.accumulatedMeanGrads&&this.centered&&kM(this.accumulatedMeanGrads.map((e=>e.variable))),null!=this.accumulatedMoments&&kM(this.accumulatedMoments.map((e=>e.variable)))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedMoments=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}const UL=[EL,NL,$L,LL,zL,BL,PL];function WL(e){return new Promise((e=>setTimeout(e))).then(e)}class VL{constructor(e){if(!C$().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(VL.URL_SCHEME)&&(e=e.slice(VL.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=yM.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const t=RM(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),i=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=r,await WL((()=>i.dispatchEvent(new MouseEvent("click")))),null!=e.weightData){const e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await WL((()=>e.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:_M(e)}}}}VL.URL_SCHEME="downloads://";function jL(e,t,n,r){!function(e){GR(null!=e&&Array.isArray(e)&&e.length>0,(()=>"promises must be a none empty array"))}(e),function(e,t){GR(e>=0&&e<=1,(()=>`Progress fraction must be in range [0, 1], but got startFraction ${e}`)),GR(t>=0&&t<=1,(()=>`Progress fraction must be in range [0, 1], but got endFraction ${t}`)),GR(t>=e,(()=>`startFraction must be no more than endFraction, but got startFraction ${e} and endFraction ${t}`))}(n=null==n?0:n,r=null==r?1:r);let i=0;return Promise.all(e.map((s=>(s.then((s=>{const o=n+ ++i/e.length*(r-n);return t(o),s})),s))))}async function GL(e,t){null==t&&(t={});const n=null==t.fetchFunc?C$().platform.fetch:t.fetchFunc,r=e.map((e=>n(e,t.requestInit,{isBinary:!0}))),i=(null==t.onProgress?await Promise.all(r):await jL(r,t.onProgress,0,.5)).map((e=>e.arrayBuffer()));return null==t.onProgress?await Promise.all(i):await jL(i,t.onProgress,.5,1)}DM.registerSaveRouter((e=>C$().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(VL.URL_SCHEME)?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new VL(e)}(e.slice(VL.URL_SCHEME.length)):null));class HL{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(GR("function"===typeof t.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=t.fetchFunc):this.fetch=C$().platform.fetch,GR(null!=e&&e.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(e)&&GR(2===e.length,(()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`)),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=RM(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){const n=yM.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:_M(e),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch(dae){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=t.modelTopology,r=t.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();return $M(await this.loadModelJSON(),(e=>this.loadWeights(e)))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=OM(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>function(e,t){var n;const r=null==t.fetchFunc?C$().platform.fetch:t.fetchFunc;let i,s=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:async n=>{for(var o;s<e.length;){if(!i){const n=(await r(e[s],t.requestInit,{isBinary:!0})).body;i=n.getReader()}const{done:a,value:l}=await i.read();if(!a)return void n.enqueue(l);s++,i=void 0,null===(o=t.onProgress)||void 0===o||o.call(t,s/e.length)}n.close()}})}(t,this.loadOptions)})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),i=n>t?e.substring(n):"";return[r+"/",i]}(t),i=this.weightPathPrefix||n,s=[],o=[];for(const a of e)for(const e of a.paths)null!=this.weightUrlConverter?o.push(this.weightUrlConverter(e)):s.push(i+e+r);return this.weightUrlConverter&&s.push(...await Promise.all(o)),s}async loadWeights(e){const t=await this.getWeightUrls(e);return[OM(e),await GL(t,this.loadOptions)]}}function qL(e){return null!=e.match(HL.URL_SCHEME_REGEX)}HL.URL_SCHEME_REGEX=/^https?:\/\//;const KL=(e,t)=>{if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every((e=>qL(e))):qL(e),n)return XL(e,t)}return null};function XL(e,t){return new HL(e,t)}DM.registerSaveRouter(KL),DM.registerLoadRouter(KL);const YL=-2,QL=-1;function JL(e,t,n){const r=e.shape.length;GR(r===t.length,(()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`)),GR(r===n.length,(()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`));for(let i=0;i<r;++i)GR(t[i]+n[i]<=e.shape[i],(()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`))}function ZL(e){const t=[];let n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function eP(e,t,n){const r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function tP(e,t,n,r){const i=[...e];for(let s=i.length;s<r.length;s++)i.push(1);for(let s=0;s<n;s++)0===s?i[t]=1:(i.splice(t,0,1),i.pop());return i}function nP(e,t,n){return n<=e?n:n-(t-1)}function rP(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function iP(e,t,n,r,i,s,o,a,l){const u=e.length;let c=new Array(u),h=new Array(u),d=new Array(u);if(t.length&&n>0){const l=t[0],u=n+1;c=sP(o,l,u,r,e),h=oP(a,l,u,i,e),d=tP(s,l,u,e)}else for(let p=0;p<u;p++)c[p]=lP(o,r,s,e,p,l),h[p]=uP(a,i,s,e,p,l),d[p]=aP(s,p,l);return{begin:c,end:h,strides:d}}function sP(e,t,n,r,i){const s=[...i],o=rP(n,t);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=0;else{const i=nP(t,n,a);let o=r[i];e&1<<i&&(o=0),s[a]=o}return s}function oP(e,t,n,r,i){const s=[...i],o=rP(n,t);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{const i=nP(t,n,a);let o=r[i];e&1<<i&&(o=Number.MAX_SAFE_INTEGER),s[a]=o}for(let a=0;a<s.length;a++){const e=i[a];s[a]<0&&(s[a]+=e),s[a]=WR(0,s[a],i[a])}return s}function aP(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function lP(e,t,n,r,i,s){let o=t[i];const a=n[i]||1;(e&1<<i||s&1<<i||null==o)&&(o=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const l=r[i];return o<0&&(o+=l),o=WR(0,o,l-1),o}function uP(e,t,n,r,i,s){let o=t[i];const a=n[i]||1;(e&1<<i||s&1<<i||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const l=r[i];return o<0&&(o+=l),o=a>0?WR(0,o,l):WR(-1,o,l-1),o}function cP(e,t,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function hP(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function dP(e,t,n){let r;const i=e.shape.length;let s;return r="number"===typeof t?[t,...new Array(i-1).fill(0)]:t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice(),r.forEach((e=>{GR(-1!==e,(()=>"slice() does not support negative begin indexing."))})),s=null==n?new Array(i).fill(-1):"number"===typeof n?[n,...new Array(i-1).fill(-1)]:n.length<i?n.concat(new Array(i-n.length).fill(-1)):n,s=s.map(((t,n)=>t>=0?t:(GR(-1===t,(()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${n}.`)),e.shape[n]-r[n]))),[r,s]}function pP(e,t,n,r,i,s,o,a,l){let u;if(null==r?(u=new Array(t.length),u.fill(1)):u=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const h={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:u.slice(),beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let y=0;y<h.dims;y++)c&&0!==(1<<y&a)&&h.numAddAxisAfterEllipsis++,1<<y&o&&(c=!0);c||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(YL),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(QL),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(h,d);let p=!0,f=!0,m=!0;const g=[],v=[];for(let y=0;y<e.length;++y){if(0===d.strides[y])throw Error(`strides[${y}] must be non-zero`);const t=!!(d.shrinkAxisMask&1<<y),n=e[y];if(-1===n){g.push(t?1:-1);continue}const r=[d.beginMask&1<<y,d.endMask&1<<y],i=[d.strides[y]>0?0:-1,d.strides[y]>0?n:n-1];if(t&&d.strides[y]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===d.strides[y];const s=!!(d.beginMask&1<<y&&d.endMask&1<<y);if(d.beginValid&&d.endValid){if(t){const e=d.begin[y]<0?n+d.begin[y]:d.begin[y];if(d.begin[y]=e,d.end[y]=d.begin[y]+1,e<0||e>=n)throw Error(`slice index ${d.begin[y]} of dimension ${y} out of bounds.`)}else d.begin[y]=fP(d.begin[y],0,d.strides[y],n,r,i),d.end[y]=fP(d.end[y],1,d.strides[y],n,r,i);const e=1===d.strides[y]&&0===d.begin[y]&&d.end[y]===n;p=p&&e,f=f&&(0===y&&1===d.strides[y]||e)}else p=p&&1===d.strides[y]&&s,f=f&&(0===y&&1===d.strides[y]||s);let o,a=!1;if(d.beginValid&&d.endValid?(o=d.end[y]-d.begin[y],a=!0):t?(o=1,a=!0):s&&n>=0&&(o=d.strides[y]<0?-n:n,a=!0),a){let e;e=0===o||o<0!==d.strides[y]<0?0:Math.trunc(o/d.strides[y])+(o%d.strides[y]!==0?1:0),g.push(e)}else g.push(-1)}for(let y=0;y<d.finalShapeGatherIndices.length;++y){const e=d.finalShapeGatherIndices[y];e>=0?v.push(g[e]):e===YL&&v.push(1)}return{finalShapeSparse:v.filter(((e,t)=>d.finalShapeGatherIndices[t]!==YL)),finalShape:v,isIdentity:p,sliceDim0:f,isSimpleSlice:m,begin:d.begin,end:d.end,strides:d.strides}}function fP(e,t,n,r,i,s){if(i[t])return n>0?s[t]:s[t+1&1];{const t=e<0?r+e:e;return t<s[0]?s[0]:t>s[1]?s[1]:t}}const mP=fM({all_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:dM(e,"x","all","bool")},i={axis:t,keepDims:n};return rM.runKernel(F$,r,i)}});const gP=fM({any_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:dM(e,"x","any","bool")},i={axis:t,keepDims:n};return rM.runKernel(M$,r,i)}});const vP=fM({argMax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:dM(e,"x","argMax")},r={axis:t};return rM.runKernel(L$,n,r)}});function yP(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5?arguments[5]:void 0;return wP(e,[...t,e[3]],n,s,r,null,null,$P(i))}function bP(e,t,n,r,i,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[a,l]=IP(t);let u;if("channelsLast"===o)u=[a,l,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);u=[a,l,e[1],e[1]]}return wP(e,u,n,r,i,s,!1,o)}function xP(e,t,n,r,i,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[a,l,u]=CP(t);let c,h;if("NDHWC"===o)h="channelsLast",c=[a,l,u,e[4],e[4]];else{if("NCDHW"!==o)throw new Error(`Unknown dataFormat ${o}`);h="channelsFirst",c=[a,l,u,e[1],e[1]]}return kP(e,c,n,r,i,!1,h,s)}function wP(e,t,n,r,i,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[l,u,c,h]=[-1,-1,-1,-1];if("channelsLast"===a)[l,u,c,h]=e;else{if("channelsFirst"!==a)throw new Error(`Unknown dataFormat ${a}`);[l,h,u,c]=e}const[d,p,,f]=t,[m,g]=IP(n),[v,y]=IP(r),b=EP(d,v),x=EP(p,y),{padInfo:w,outHeight:k,outWidth:S}=function(e,t,n,r,i,s,o,a,l){let u,c,h;if("number"===typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const i=function(e,t,n,r,i){null==r&&(r=SP(e,t,n));const s=e[0],o=e[1],a=TP((s-t+2*r)/n+1,i),l=TP((o-t+2*r)/n+1,i);return[a,l]}([t,n],s,r,e,a);c=i[0],h=i[1]}else if("same"===e){c=Math.ceil(t/r),h=Math.ceil(n/i);const e=Math.max(0,(c-1)*r+s-t),a=Math.max(0,(h-1)*i+o-n),l=Math.floor(e/2),d=e-l,p=Math.floor(a/2);u={top:l,bottom:d,left:p,right:a-p,type:"SAME"}}else if("valid"===e)u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-s+1)/r),h=Math.ceil((n-o+1)/i);else{if("object"!==typeof e)throw Error(`Unknown padding parameter: ${e}`);{const d="channelsLast"===l?e[1][0]:e[2][0],p="channelsLast"===l?e[1][1]:e[2][1],f="channelsLast"===l?e[2][0]:e[3][0],m="channelsLast"===l?e[2][1]:e[3][1];u={top:d,bottom:p,left:f,right:m,type:0===d&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},c=TP((t-s+d+p)/r+1,a),h=TP((n-o+f+m)/i+1,a)}}return{padInfo:u,outHeight:c,outWidth:h}}(i,u,c,m,g,b,x,s,a),I=o?f*h:f;let C;return"channelsFirst"===a?C=[l,I,k,S]:"channelsLast"===a&&(C=[l,k,S,I]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:h,outHeight:k,outWidth:S,outChannels:I,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:p,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:v,dilationWidth:y,inShape:e,outShape:C,filterShape:t}}function kP(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",a=arguments.length>7?arguments[7]:void 0,[l,u,c,h,d]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[l,u,c,h,d]=e;else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);[l,d,u,c,h]=e}const[p,f,m,,g]=t,[v,y,b]=CP(n),[x,w,k]=CP(r),S=EP(p,x),I=EP(f,w),C=EP(m,k),{padInfo:E,outDepth:T,outHeight:N,outWidth:A}=function(e,t,n,r,i,s,o,a,l,u,c){let h,d,p,f;"valid"===e&&(e=0);if("number"===typeof e){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};const m=function(e,t,n,r,i,s){null==i&&(i=SP(e,t[0],r[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)e[a]+2*i>=t[a]&&(o[a]=TP((e[a]-t[a]+2*i)/r[a]+1,s));return o}([t,n,r,1],[a,l,u],1,[i,s,o],e,c);d=m[0],p=m[1],f=m[2]}else{if("same"!==e)throw Error(`Unknown padding parameter: ${e}`);{d=Math.ceil(t/i),p=Math.ceil(n/s),f=Math.ceil(r/o);const e=(d-1)*i+a-t,c=(p-1)*s+l-n,m=(f-1)*o+u-r,g=Math.floor(e/2),v=e-g,y=Math.floor(c/2),b=c-y,x=Math.floor(m/2);h={top:y,bottom:b,left:x,right:m-x,front:g,back:v,type:"SAME"}}}return{padInfo:h,outDepth:d,outHeight:p,outWidth:f}}(i,u,c,h,v,y,b,S,I,C,a),R=s?g*d:g;let $;return"channelsFirst"===o?$=[l,R,T,N,A]:"channelsLast"===o&&($=[l,T,N,A,R]),{batchSize:l,dataFormat:o,inDepth:u,inHeight:c,inWidth:h,inChannels:d,outDepth:T,outHeight:N,outWidth:A,outChannels:R,padInfo:E,strideDepth:v,strideHeight:y,strideWidth:b,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:I,effectiveFilterWidth:C,dilationDepth:x,dilationHeight:w,dilationWidth:k,inShape:e,outShape:$,filterShape:t}}function SP(e,t,n){const r=EP(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)}function IP(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function CP(e){return"number"===typeof e?[e,e,e]:e}function EP(e,t){return t<=1?e:e+(e-1)*(t-1)}function TP(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function NP(e){const[t,n,r]=IP(e);return 1===t&&1===n&&1===r}function AP(e,t){return NP(e)||NP(t)}function RP(e){return IP(e).every((e=>e>0))}function $P(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function _P(e,t,n){if(null!=n){if("string"===typeof t)throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if("number"===typeof t)GR(YR(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`));else{if("object"!==typeof t)throw Error(`Error in ${e}: Unknown padding parameter: ${t}`);t.forEach((t=>{t.forEach((t=>{GR(YR(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`))}))}))}}}const OP=fM({reshape_:function(e,t){const n={x:dM(e,"x","reshape","string_or_numeric")},r={shape:t};return rM.runKernel(UO,n,r)}});const DP=fM({avgPool_:function(e,t,n,r,i){const s=dM(e,"x","avgPool","float32");GR(AP(n,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`));let o=s,a=!1;3===s.rank&&(a=!0,o=OP(s,[1,s.shape[0],s.shape[1],s.shape[2]])),GR(4===o.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`)),_P("avgPool",r,i);const l={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:i};let c=rM.runKernel(j$,l,u);return c=uL(c,s.dtype),a?OP(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const FP=fM({avgPool3d_:function(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=dM(e,"x","avgPool3d","float32");let a=o,l=!1;4===o.rank&&(l=!0,a=OP(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),GR(5===a.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`)),GR("NDHWC"===s,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`)),GR("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`)),_P("avgPool3d",r,i);const u={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:s};let h=rM.runKernel(H$,u,c);return h=uL(h,a.dtype),l?OP(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const MP=fM({batchNorm_:function(e,t,n,r,i,s){null==s&&(s=.001);const o=dM(e,"x","batchNorm"),a=dM(t,"mean","batchNorm"),l=dM(n,"variance","batchNorm");let u,c;null!=i&&(u=dM(i,"scale","batchNorm")),null!=r&&(c=dM(r,"offset","batchNorm")),GR(a.rank===l.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),GR(null==c||a.rank===c.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),GR(null==u||a.rank===u.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const h={x:function(e){let t;return t=0===e.rank||1===e.rank?OP(e,[1,1,1,e.size]):2===e.rank?OP(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?OP(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(o),scale:u,offset:c,mean:a,variance:l},d={varianceEpsilon:s},p=rM.runKernel(B_,h,d);return OP(p,o.shape)}});const LP=fM({batchNorm2d_:function(e,t,n,r,i,s){const o=dM(e,"x","batchNorm"),a=dM(t,"mean","batchNorm"),l=dM(n,"variance","batchNorm");let u,c;return null!=i&&(u=dM(i,"scale","batchNorm")),null!=r&&(c=dM(r,"offset","batchNorm")),GR(2===o.rank,(()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`)),GR(2===a.rank||1===a.rank,(()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`)),GR(2===l.rank||1===l.rank,(()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`)),null!=u&&GR(2===u.rank||1===u.rank,(()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`)),null!=c&&GR(2===c.rank||1===c.rank,(()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`)),MP(o,a,l,c,u,s)}});const PP=fM({batchNorm3d_:function(e,t,n,r,i,s){const o=dM(e,"x","batchNorm"),a=dM(t,"mean","batchNorm"),l=dM(n,"variance","batchNorm");let u,c;return null!=i&&(u=dM(i,"scale","batchNorm")),null!=r&&(c=dM(r,"offset","batchNorm")),GR(3===o.rank,(()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`)),GR(3===a.rank||1===a.rank,(()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`)),GR(3===l.rank||1===l.rank,(()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`)),null!=u&&GR(3===u.rank||1===u.rank,(()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`)),null!=c&&GR(3===c.rank||1===c.rank,(()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`)),MP(o,a,l,c,u,s)}});const zP=fM({batchNorm4d_:function(e,t,n,r,i,s){const o=dM(e,"x","batchNorm"),a=dM(t,"mean","batchNorm"),l=dM(n,"variance","batchNorm");let u,c;return null!=i&&(u=dM(i,"scale","batchNorm")),null!=r&&(c=dM(r,"offset","batchNorm")),GR(4===o.rank,(()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`)),GR(4===a.rank||1===a.rank,(()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`)),GR(4===l.rank||1===l.rank,(()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`)),null!=u&&GR(4===u.rank||1===u.rank,(()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`)),null!=c&&GR(4===c.rank||1===c.rank,(()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`)),MP(o,a,l,c,u,s)}});const BP=fM({broadcastTo_:function(e,t){let n=dM(e,"broadcastTo","x");const r=n.shape;if(y$(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=OP(n,e)}const i=n.shape,s=Array.from(t);for(let l=t.length-1;l>=0;l--)if(i[l]===t[l])s[l]=1;else if(1!==n.shape[l])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(0===s.map(((e,t)=>e>1?t:-1)).filter((e=>e>=0)).length)return cL(n);const o={x:n},a={reps:s};return rM.runKernel(TD,o,a)}});const UP=fM({clipByValue_:function(e,t,n){const r=dM(e,"x","clipByValue");if(GR(t<=n,(()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`)),t===n)return TL(r.shape,t,r.dtype);const i={x:r},s={clipValueMin:t,clipValueMax:n};return rM.runKernel(t_,i,s)}});const WP=fM({concat_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;GR(e.length>=1,(()=>"Pass at least one tensor to concat"));const n=pM(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((e=>{if("complex64"!==e.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${e.dtype}. `)})),1===n.length)return cL(n[0]);const r=n,i={axis:t};return rM.runKernel(i_,r,i)}});const VP=fM({concat1d_:function(e){return WP(e,0)}});const jP=fM({concat2d_:function(e,t){return WP(e,t)}});const GP=fM({concat3d_:function(e,t){return WP(e,t)}});const HP=fM({concat4d_:function(e,t){return WP(e,t)}});const qP=fM({conv2d_:function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const a=dM(e,"x","conv2d","float32"),l=dM(t,"filter","conv2d","float32");let u=a,c=!1;3===a.rank&&(c=!0,u=OP(a,[1,a.shape[0],a.shape[1],a.shape[2]])),GR(4===u.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`)),GR(4===l.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`)),_P("conv2d",r,o);const h="NHWC"===i?u.shape[3]:u.shape[1];GR(h===l.shape[2],(()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`)),GR(AP(n,s),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`)),GR(RP(s),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),GR(RP(n),(()=>"Error in conv2D: Strides should be larger than 0."));const d={x:u,filter:l},p={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o},f=rM.runKernel(s_,d,p);return c?OP(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const KP=fM({conv1d_:function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0;const a=dM(e,"x","conv1d"),l=dM(t,"filter","conv1d");let u=a,c=!1;2===a.rank&&(c=!0,u=OP(a,[1,a.shape[0],a.shape[1]])),GR(3===u.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`)),GR(3===l.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`)),_P("conv1d",r,o),GR(u.shape[2]===l.shape[1],(()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`)),GR(AP(n,s),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`)),GR(RP(s),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),GR(RP(n),(()=>"Error in conv1D: Stride should be larger than 0.")),GR("NWC"===i,(()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`));const h=OP(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=OP(u,[u.shape[0],1,u.shape[1],u.shape[2]]),p=qP(d,h,[1,n],r,"NHWC",[1,s],o);return OP(p,c?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}});const XP=fM({conv2DBackpropInput_:function(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;GR(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let a=e,l=t,u=!1;3===t.rank&&(u=!0,l=OP(t,[1,t.shape[0],t.shape[1],t.shape[2]]),a=[1,e[0],e[1],e[2]]),GR(4===a.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`)),GR(4===l.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`)),GR(4===n.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`));const c="NHWC"===s?a[3]:a[1],h="NHWC"===s?l.shape[3]:l.shape[1];GR(c===n.shape[2],(()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`)),GR(h===n.shape[3],(()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`)),_P("conv2dDerInput",i,o);const d={dy:l,filter:n},p={strides:r,pad:i,dataFormat:s,dimRoundingMode:o,inputShape:a},f=rM.runKernel(a_,d,p);return u?OP(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const YP=fM({conv2dTranspose_:function(e,t,n,r,i,s){const o=dM(e,"x","conv2dTranspose"),a=dM(t,"filter","conv2dTranspose");return XP(n,o,a,r,i,"NHWC",s)}});const QP=fM({conv3d_:function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const o=dM(e,"x","conv3d"),a=dM(t,"filter","conv3d");let l=o,u=!1;4===o.rank&&(u=!0,l=OP(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),GR(5===l.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`)),GR(5===a.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`)),GR(l.shape[4]===a.shape[3],(()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`)),GR(AP(n,s),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`)),GR("NDHWC"===i,(()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`)),GR(RP(s),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),GR(RP(n),(()=>"Error in conv3D: Strides should be larger than 0."));const c={x:l,filter:a},h={strides:n,pad:r,dataFormat:i,dilations:s},d=rM.runKernel(l_,c,h);return u?OP(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const JP=fM({conv3DBackpropInput_:function(e,t,n,r,i){GR(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let s=e,o=t,a=!1;4===t.rank&&(a=!0,o=OP(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,e[0],e[1],e[2],e[3]]);const l=s[4],u=o.shape[4];GR(5===s.length,(()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`)),GR(5===o.rank,(()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`)),GR(5===n.rank,(()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`)),GR(l===n.shape[3],(()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`)),GR(u===n.shape[4],(()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`));const c={dy:o,filter:n},h={pad:i,strides:r,inputShape:s},d=rM.runKernel(c_,c,h);return a?OP(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const ZP=fM({conv3dTranspose_:function(e,t,n,r,i){const s=dM(e,"x","conv3dTranspose"),o=dM(t,"filter","conv3dTranspose");return JP(n,s,o,r,i)}});const ez=fM({denseBincount_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=dM(e,"x","denseBincount"),s=dM(t,"weights","denseBincount");GR("int32"===i.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`)),GR(i.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`)),GR(n>=0,(()=>`size must be non-negative, but got ${n}.`)),GR(s.size===i.size||0===s.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${s.shape}.`));const o={x:i,weights:s},a={size:n,binaryOutput:r};return rM.runKernel(g_,o,a)}});const tz=fM({depthwiseConv2d_:function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const a=dM(e,"x","depthwiseConv2d","float32"),l=dM(t,"filter","depthwiseConv2d","float32");let u=a,c=!1;3===a.rank&&(c=!0,u=OP(a,[1,a.shape[0],a.shape[1],a.shape[2]])),GR(4===u.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`)),GR(4===l.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`));const h="NHWC"===i?u.shape[3]:u.shape[1];GR(h===l.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`)),_P("depthwiseConv2d",r,o);const d={x:u,filter:l},p={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o},f=rM.runKernel(y_,d,p);return c?OP(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const nz=fM({elu_:function(e){const t={x:dM(e,"x","elu","float32")};return rM.runKernel(N_,t)}});const rz=fM({equal_:function(e,t){let n=dM(e,"a","equal","string_or_numeric"),r=dM(t,"b","equal","string_or_numeric");[n,r]=XF(n,r),FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel($_,i)}});const iz=fM({erf_:function(e){let t=dM(e,"x","erf");GR("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=uL(t,"float32"));const n={x:t};return rM.runKernel(R_,n)}});const sz=fM({exp_:function(e){const t={x:dM(e,"x","exp")};return rM.runKernel(__,t)}});const oz=fM({expandDims_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=dM(e,"x","expandDims","string_or_numeric");GR(t<=n.rank,(()=>"Axis must be <= rank of the tensor"));const r={input:n},i={dim:t};return rM.runKernel(O_,r,i)}});const az=fM({tile_:function(e,t){const n=dM(e,"x","tile","string_or_numeric");GR(n.rank===t.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`));const r={x:n},i={reps:t};return rM.runKernel(TD,r,i)}});const lz=fM({eye_:function(e,t,n){null==t&&(t=e);const r=lL([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),i=e<=t?e:t;for(let o=0;o<i;++o)r.set(1,o,o);const s=OP(r.toTensor(),[e,t]);if(null==n)return s;if(1===n.length)return az(oz(s,0),[n[0],1,1]);if(2===n.length)return az(oz(oz(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return az(oz(oz(oz(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}});const uz=fM({floor_:function(e){const t={x:dM(e,"x","floor","float32")};return rM.runKernel(P_,t)}});const cz=fM({gather_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i={x:dM(e,"x","gather"),indices:dM(t,"indices","gather","int32")},s={axis:n,batchDims:r};return rM.runKernel(U_,i,s)}});const hz=fM({greater_:function(e,t){let n=dM(e,"a","greater","string_or_numeric"),r=dM(t,"b","greater","string_or_numeric");[n,r]=XF(n,r),FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel(V_,i)}});const dz=fM({greaterEqual_:function(e,t){let n=dM(e,"a","greaterEqual","string_or_numeric"),r=dM(t,"b","greaterEqual","string_or_numeric");[n,r]=XF(n,r),FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel(j_,i)}});const pz=fM({leakyRelu_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:dM(e,"x","leakyRelu")},r={alpha:t};return rM.runKernel(Q_,n,r)}});const fz=fM({log_:function(e){const t={x:dM(e,"x","log","float32")};return rM.runKernel(tO,t)}});const mz=fM({log1p_:function(e){const t={x:dM(e,"x","log1p")};return rM.runKernel(nO,t)}});const gz=fM({max_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:dM(e,"x","max")},i={reductionIndices:t,keepDims:n};return rM.runKernel(lO,r,i)}});const vz=fM({sum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=dM(e,"x","sum");"bool"===r.dtype&&(r=uL(r,"int32"));const i={x:r},s={axis:t,keepDims:n};return rM.runKernel(lD,i,s)}});const yz=fM({logSoftmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=dM(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return yL(((e,n)=>{const r=gz(e,t,!0),i=RL(e,r),s=RL(uL(i,"float32"),fz(vz(sz(i),t,!0)));n([s]);return{value:s,gradFunc:(e,n)=>{const[r]=n,i=sz(r);return RL(e,fL(vz(e,t,!0),i))}}}))(n)}});function bz(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function xz(e,t,n){const r=e.length+t.length,i=[];let s=0,o=0;for(let a=0;a<r;a++)-1===n.indexOf(a)?i.push(e[s++]):i.push(t[o++]);return i}function wz(e,t){const n=[],r=e.length;for(let i=0;i<r;i++)-1===t.indexOf(i)&&n.push(e[i]);return[n,t.map((t=>e[t]))]}function kz(e,t){return xz(e,t.map((e=>1)),t)}function Sz(e,t,n){GR(bz(t,n),(()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`))}function Iz(e,t){if(bz(e,t))return null;const n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((e=>n.push(e))),n}function Cz(e){return e.map(((e,t)=>[t,e])).sort(((e,t)=>e[1]-t[1])).map((e=>e[0]))}function Ez(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}const Tz=fM({logSumExp_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=dM(e,"x","logSumExp"),i=t$(t,r.shape),s=gz(r,i,!0),o=RL(r,s),a=sz(o),l=vz(a,i),u=fz(l),c=hL(OP(s,u.shape),u);if(n){const e=kz(c.shape,i);return OP(c,e)}return c}});const Nz=fM({logicalAnd_:function(e,t){const n=dM(e,"a","logicalAnd","bool"),r=dM(t,"b","logicalAnd","bool");FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel(rO,i)}});const Az=fM({matMul_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=dM(e,"a","matMul"),s=dM(t,"b","matMul");[i,s]=XF(i,s);const o={a:i,b:s},a={transposeA:n,transposeB:r};return rM.runKernel(K$,o,a)}});const Rz=fM({maxPool_:function(e,t,n,r,i){const s=dM(e,"x","maxPool");let o=s,a=!1;3===s.rank&&(a=!0,o=OP(s,[1,s.shape[0],s.shape[1],s.shape[2]])),GR(4===o.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`)),GR(AP(n,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`)),_P("maxPool",r,i);const l={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:i},c=rM.runKernel(cO,l,u);return a?OP(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const $z=fM({maxPool3d_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=dM(e,"x","maxPool3d");let a=o,l=!1;4===o.rank&&(l=!0,a=OP(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),GR(5===a.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`)),GR("NDHWC"===s,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`)),_P("maxPool3d",r,i);const u={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:s},h=rM.runKernel(dO,u,c);return l?OP(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const _z=fM({mean_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:dM(e,"x","mean")},i={axis:t,keepDims:n};return rM.runKernel(mO,r,i)}});const Oz=fM({min_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:dM(e,"x","min")},i={axis:t,keepDims:n};return rM.runKernel(gO,r,i)}});const Dz=fM({minimum_:function(e,t){let n=dM(e,"a","minimum"),r=dM(t,"b","minimum");[n,r]=XF(n,r),"bool"===n.dtype&&(n=uL(n,"int32"),r=uL(r,"int32")),FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel(vO,i)}});const Fz=fM({moments_:function(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t$(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=dM(e,"x","moments")).shape),r=_z(e,n,t);let i=r.shape;t||(i=kz(r.shape,n));const s=gL(RL(uL(e,"float32"),OP(r,i)));return{mean:r,variance:_z(s,n,t)}}});const Mz=fM({neg_:function(e){const t={x:dM(e,"x","neg")};return rM.runKernel(kO,t)}});const Lz=fM({notEqual_:function(e,t){let n=dM(e,"a","notEqual","string_or_numeric"),r=dM(t,"b","notEqual","string_or_numeric");[n,r]=XF(n,r),FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel(SO,i)}});const Pz=fM({oneHot_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const s={indices:dM(e,"indices","oneHot","int32")},o={dtype:i,depth:t,onValue:n,offValue:r};return rM.runKernel(NO,s,o)}});function zz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(y$(e),"complex64"===t){const t=zz(e,"float32"),n=zz(e,"float32");return mM(t,n)}const n=g$(KR(e),t);return rM.makeTensor(n,e,t)}function Bz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(y$(e),"complex64"===t){const t=Bz(e,"float32"),n=zz(e,"float32");return mM(t,n)}const n=m$(KR(e),t);return rM.makeTensor(n,e,t)}const Uz=fM({onesLike_:function(e){const t={x:dM(e,"x","onesLike")};return rM.runKernel(TO,t)}});const Wz=fM({pad_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=dM(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:t,constantValue:n},s={x:r};return rM.runKernel(RO,s,i)}});const Vz=fM({prelu_:function(e,t){const n={x:dM(e,"x","prelu"),alpha:dM(t,"alpha","prelu")};return rM.runKernel(_O,n)}});var jz=n(4334);class Gz{constructor(e,t,n,r,i){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const s=i||Math.random();this.random=jz.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,i,s;do{r=2*this.random()-1,i=2*this.random()-1,s=r*r+i*i}while(s>=1||0===s);const o=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*i*o,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Hz{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=jz.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const qz=fM({randomNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(y$(e),null!=r&&"bool"===r)throw new Error(`Unsupported data type ${r}`);const s=new Gz(t,n,r,!1,i),o=lL(e,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}});const Kz=fM({randomUniform_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",i=arguments.length>4?arguments[4]:void 0;y$(e);const s=lL(e,r),o=new Hz(t,n,null,i);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}});function Xz(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const i={start:e,stop:t,step:n,dtype:r};return rM.runKernel(LO,{},i)}const Yz=fM({relu_:function(e){const t={x:dM(e,"x","relu")};return rM.runKernel(BO,t)}});const Qz=fM({reverse_:function(e,t){const n={x:dM(e,"x","reverse")},r={dims:t};return rM.runKernel(qO,n,r)}});const Jz=fM({selu_:function(e){const t={x:dM(e,"x","selu")};return rM.runKernel(eD,t)}});const Zz=fM({separableConv2d_:function(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const a=dM(e,"x","separableConv2d"),l=dM(t,"depthwiseFilter","separableConv2d"),u=dM(n,"pointwiseFilter","separableConv2d");let c=a,h=!1;if(3===a.rank&&(h=!0,c=OP(a,[1,a.shape[0],a.shape[1],a.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");GR(4===c.rank,(()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`)),GR(4===l.rank,(()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`)),GR(4===u.rank,(()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`)),GR(1===u.shape[0],(()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`)),GR(1===u.shape[1],(()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`));const d=l.shape[2],p=l.shape[3];GR(u.shape[2]===d*p,(()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*p}, but got ${u.shape[2]}.`));const f=tz(c,l,r,i,o,s),m=qP(f,u,1,"valid",o);return h?OP(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const eB=fM({sigmoid_:function(e){const t={x:dM(e,"x","sigmoid","float32")};return rM.runKernel(sD,t)}});const tB=fM({slice_:function(e,t,n){const r=dM(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const i={x:r},s={begin:t,size:n};return rM.runKernel(tD,i,s)}});const nB=fM({slice1d_:function(e,t,n){const r=dM(e,"x","slice1d");return GR(1===r.rank,(()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`)),tB(r,[t],[n])}});const rB=fM({slice2d_:function(e,t,n){const r=dM(e,"x","slice2d");return GR(2===r.rank,(()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`)),tB(r,t,n)}});const iB=fM({slice3d_:function(e,t,n){const r=dM(e,"x","slice3d");return GR(3===r.rank,(()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`)),tB(r,t,n)}});const sB=fM({slice4d_:function(e,t,n){const r=dM(e,"x","slice4d");return GR(4===r.rank,(()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`)),tB(r,t,n)}});const oB=fM({softmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=dM(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const r={logits:n},i={dim:t};return rM.runKernel(hD,r,i)}});const aB=fM({softplus_:function(e){const t={x:dM(e,"x","softplus")};return rM.runKernel(oD,t)}});const lB=fM({split_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={x:dM(e,"x","split")},i={numOrSizeSplits:t,axis:n};return rM.runKernel(cD,r,i)}});const uB=fM({squeeze_:function(e,t){const n=dM(e,"x","squeeze","string_or_numeric");return OP(n,n$(n.shape,t).newShape)}});const cB=fM({stack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=pM(e,"tensors","stack","string_or_numeric");GR(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&GR(t<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const r=n,i={axis:t};return rM.runKernel(AO,r,i)}});const hB=fM({tanh_:function(e){const t={x:dM(e,"x","tanh","float32")};return rM.runKernel(ED,t)}});function dB(e,t){qR(e);const n=uM(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return gM(e,null,n,t)}function pB(e,t,n){if(qR(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=uM(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return gM(e,t,r,n)}const fB=fM({truncatedNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(y$(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const s=new Gz(t,n,r,!0,i),o=lL(e,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}});const mB=fM({unstack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=dM(e,"x","unstack","string_or_numeric");GR(t>=-n.shape.length&&t<n.shape.length,(()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`));const r={value:n},i={axis:t};return rM.runKernel(_D,r,i)}});const gB=fM({where_:function(e,t,n){const r=dM(t,"a","where"),i=dM(n,"b","where"),s=dM(e,"condition","where","bool"),o=FL(FL(s.shape,r.shape),i.shape),a={condition:BP(s,o),t:BP(r,o),e:BP(i,o)};return rM.runKernel(ZO,a)}});const vB=fM({imag_:function(e){const t={input:dM(e,"input","imag")};return rM.runKernel(q_,t)}});const yB=fM({real_:function(e){const t={input:dM(e,"input","real")};return rM.runKernel(PO,t)}});const bB=fM({transpose_:function(e,t,n){const r=dM(e,"x","transpose");if(null==t&&(t=r.shape.map(((e,t)=>t)).reverse()),GR(r.rank===t.length,(()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`)),t.forEach((e=>{GR(e>=0&&e<r.rank,(()=>"All entries in 'perm' must be between 0 and "+(r.rank-1)+` but got ${t}`))})),r.rank<=1)return r.clone();const i={x:r},s={perm:t};return"complex64"===r.dtype?wM((()=>{let e=yB(r),t=vB(r);return e=rM.runKernel(RD,{x:e},s),t=rM.runKernel(RD,{x:t},s),n&&(t=Mz(t)),mM(e,t)})):rM.runKernel(RD,i,s)}});const xB=fM({dropout_:function(e,t,n,r){const i=dM(e,"x","dropout");if(GR("float32"===i.dtype,(()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`)),GR(t>=0&&t<1,(()=>`rate must be a float in the range [0, 1), but got ${t}.`)),0===t)return e instanceof $F?i.clone():i;const s=function(e,t){if(null==t)return e.shape.slice();if(XR(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(i,n),o=1-t,a=pL(uz(hL(Kz(s,0,1,"float32",r),o)),o);return fL(i,a)}});const wB=fM({fft_:function(e){GR("complex64"===e.dtype,(()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`));const t={input:e};return rM.runKernel(F_,t)}});const kB=fM({rfft_:function(e,t){GR("float32"===e.dtype,(()=>`The dtype for rfft() must be real value but got ${e.dtype}`));let n=e.shape[e.shape.length-1];const r=e.size/n;let i;if(null!=t&&t<n){const r=e.shape.map((e=>0)),s=e.shape.map((e=>e));s[e.shape.length-1]=t,i=tB(e,r,s),n=t}else if(null!=t&&t>n){const r=e.shape.map((e=>e));r[e.shape.length-1]=t-n,i=WP([e,zz(r)],e.shape.length-1),n=t}else i=e;const s=vL(i),o=OP(mM(i,s),[r,n]),a=wB(o),l=Math.floor(n/2)+1,u=yB(a),c=vB(a),h=lB(u,[l,n-l],u.shape.length-1),d=lB(c,[l,n-l],c.shape.length-1),p=i.shape.slice();return p[i.shape.length-1]=l,OP(mM(h[0],d[0]),p)}});const SB=fM({ifft_:function(e){GR("complex64"===e.dtype,(()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`));const t={input:e};return rM.runKernel(H_,t)}});const IB=fM({irfft_:function(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const i=OP(e,[n,t]);r=SB(i)}else{const i=[n,2*(t-1)],s=OP(yB(e),[n,t]),o=OP(vB(e),[n,t]),a=Qz(tB(s,[0,1],[n,t-2]),1),l=fL(Qz(tB(o,[0,1],[n,t-2]),1),bL(-1)),u=WP([s,a],1),c=WP([o,l],1),h=OP(mM(u,c),[i[0],i[1]]);r=SB(h)}if(r=yB(r),3===e.rank&&0!==e.shape[0]){const t=r,n=e.shape[0];r=OP(r,[n,r.shape[0]/n,r.shape[1]]),t.dispose()}return r}});const CB=fM({conv2DBackpropFilter_:function(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,a=e;3===e.rank&&(a=OP(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=OP(t,[1,t.shape[0],t.shape[1],t.shape[2]])),GR(4===a.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`)),GR(4===l.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`)),GR(4===n.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`));const u="NHWC"===s?a.shape[3]:a.shape[1],c="NHWC"===s?l.shape[3]:l.shape[1];GR(u===n[2],(()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`)),GR(c===n[3],(()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`)),_P("conv2dDerFilter",i,o);const h={x:a,dy:l},d={strides:r,pad:i,dataFormat:s,dimRoundingMode:o,filterShape:n};return rM.runKernel(o_,h,d)}});const EB=fM({relu6_:function(e){const t={x:dM(e,"x","relu6")};return rM.runKernel(HO,t)}});const TB=fM({step_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:dM(e,"x","step")},r={alpha:t};return rM.runKernel(FD,n,r)}});function NB(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return fL(e,TB(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function AB(e,t){let n=t;const r=DL(e.shape,t.shape);return r.length>0&&(n=vz(n,r)),OP(n,e.shape)}function RB(e,t,n,r){if("linear"===t)return e;if("relu"===t)return Yz(e);if("elu"===t)return nz(e);if("relu6"===t)return EB(e);if("prelu"===t)return Vz(e,n);if("leakyrelu"===t)return pz(e,r);if("sigmoid"===t)return eB(e);throw new Error(`Unknown fused activation ${t}.`)}const $B=(e,t)=>!(e>0)||"linear"===t;const _B=fM({fusedConv2d_:function(e){let{x:t,filter:n,strides:r,pad:i,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:l,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:h}=e;if(u=u||"linear",!1===$B(rM.state.gradientDepth,u)){GR("NHWC"===s,(()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`));let e=qP(t,n,r,i,s,o,a);return null!=l&&(e=hL(e,l)),RB(e,u,c,h)}const d=dM(t,"x","conv2d","float32"),p=dM(n,"filter","conv2d","float32");let f=d,m=!1;3===d.rank&&(m=!0,f=OP(d,[1,d.shape[0],d.shape[1],d.shape[2]])),GR(4===f.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`)),GR(4===p.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`)),_P("fused conv2d",i,a);const g="NHWC"===s?f.shape[3]:f.shape[1];GR(p.shape[2]===g,(()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${p.shape[2]}.`)),GR(AP(r,o),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${r} and dilations '${o}'`));const v=wP(f.shape,p.shape,r,o,i,a);let y,b;if(null!=l&&(y=dM(l,"bias","fused conv2d"),[y]=XF(y,d),"NHWC"===s?FL(v.outShape,y.shape):(GR(y.shape.length<=1,(()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`)),GR(0===y.shape.length||y.shape[0]===v.outChannels||1===y.shape[0],(()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${v.outChannels})`)))),null!=c){const e=c.shape;if(GR(e.length<=1||3===e.length,(()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${e.length}.`)),1===e.length)GR(1===e[0]||e[0]===v.outChannels,(()=>`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the number of output channels (${v.outChannels}).`));else if(3===e.length)try{FL(e,v.outShape)}catch(dae){const n=`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(n)}b=dM(c,"prelu weights","fused conv2d")}const x=(e,t)=>{GR("NHWC"===s,(()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`));const[n,a,l,c]=t,h=NB(e,l,u);GR(NP(o),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`));const d=[XP(a.shape,h,n,r,i),CB(a,h,n.shape,r,i)];if(null!=c){const e=AB(c,h);d.push(e)}return d},w={x:f,filter:p,bias:y,preluActivationWeights:b},k={strides:r,pad:i,dataFormat:s,dilations:o,dimRoundingMode:a,activation:u,leakyreluAlpha:h};if(null==l){const e=yL(((e,t,n)=>{let r=rM.runKernel(zD,w,k);return n([t,e,r]),m&&(r=OP(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}}));return e(f,p)}{const e=yL(((e,t,n,r)=>{let i=rM.runKernel(zD,w,k);return r([t,e,i,n]),m&&(i=OP(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:x}}));return e(f,p,y)}}});const OB=fM({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,a=e;3===e.rank&&(a=OP(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=OP(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:i,dimRoundingMode:o,dilations:s,filterShape:n};return rM.runKernel(b_,u,c)}});const DB=fM({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,a=t,l=!1;3===t.rank&&(l=!0,a=OP(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={dy:a,filter:n},c={strides:r,pad:i,dimRoundingMode:o,dilations:s,inputShape:e},h=rM.runKernel(x_,u,c);return l?OP(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});const FB=fM({fusedMatMul_:function(e){let{a:t,b:n,transposeA:r=!1,transposeB:i=!1,bias:s,activation:o="linear",preluActivationWeights:a,leakyreluAlpha:l=.2}=e;if(!1===$B(rM.state.gradientDepth,o)){let e=Az(t,n,r,i);return null!=s&&(e=hL(e,s)),RB(e,o,a,l)}let u=dM(t,"a","fused matMul"),c=dM(n,"b","fused matMul");[u,c]=XF(u,c);const h=r?u.shape[u.rank-2]:u.shape[u.rank-1],d=i?c.shape[c.rank-1]:c.shape[c.rank-2],p=r?u.shape[u.rank-1]:u.shape[u.rank-2],f=i?c.shape[c.rank-2]:c.shape[c.rank-1],m=u.shape.slice(0,-2),g=c.shape.slice(0,-2),v=KR(m),y=KR(g);GR(h===d,(()=>`Error in fused matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${u.shape} and ${c.shape} and transposeA=${r} and transposeB=${i} must match.`));const b=FL(u.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,f]),x=OP(u,r?[v,h,p]:[v,p,h]),w=OP(c,i?[y,f,d]:[y,d,f]);let k,S;null!=s&&(k=dM(s,"bias","fused matMul"),[k]=XF(k,u),FL(b,k.shape)),null!=a&&(S=dM(a,"prelu weights","fused matMul"));const I=(e,t)=>{const[n,a,l,u]=t,c=NB(OP(e,l.shape),l,o);let h,d;if(r||i?!r&&i?(h=Az(c,a,!1,!1),d=Az(c,n,!0,!1)):r&&!i?(h=Az(a,c,!1,!0),d=Az(n,c,!1,!1)):(h=Az(a,c,!0,!0),d=Az(c,n,!0,!0)):(h=Az(c,a,!1,!0),d=Az(n,c,!0,!1)),null!=s){return[h,d,AB(u,c)]}return[h,d]},C={a:x,b:w,bias:k,preluActivationWeights:S},E={transposeA:r,transposeB:i,activation:o,leakyreluAlpha:l};if(null==s){const e=yL(((e,t,n)=>{const r=rM.runKernel(PD,C,E);return n([e,t,r]),{value:OP(r,b),gradFunc:I}}));return e(x,w)}{const e=yL(((e,t,n,r)=>{const i=rM.runKernel(PD,C,E);return r([e,t,i,n]),{value:OP(i,b),gradFunc:I}}));return e(x,w,k)}}});const MB=fM({cropAndResize_:function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=dM(e,"image","cropAndResize"),a=dM(t,"boxes","cropAndResize","float32"),l=dM(n,"boxInd","cropAndResize","int32"),u=a.shape[0];GR(4===o.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`)),GR(2===a.rank&&4===a.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`)),GR(1===l.rank&&l.shape[0]===u,(()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`)),GR(2===r.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`)),GR(r[0]>=1&&r[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${r}`)),GR("bilinear"===i||"nearest"===i,(()=>`method must be bilinear or nearest, but was ${i}`));const c={image:o,boxes:a,boxInd:l},h={method:i,extrapolationValue:s,cropSize:r};return rM.runKernel(m_,c,h)}});const LB=fM({flipLeftRight_:function(e){const t=dM(e,"image","flipLeftRight","float32");GR(4===t.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`));const n={image:t};return rM.runKernel(L_,n,{})}});const PB=fM({grayscaleToRGB_:function(e){const t=dM(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];GR(t.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`)),GR(1===r,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`));const i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,az(t,i)}});const zB=fM({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(((e,t)=>dM(e,`tensors${t}`,"einsum"))),s={equation:e};return rM.runKernel(T_,i,s)}});const BB=fM({rgbToGrayscale_:function(e){const t=dM(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];GR(t.rank>=2,(()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`)),GR(3===r,(()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`));const i=t.dtype,s=uL(t,"float32"),o=dB([.2989,.587,.114]);let a;switch(t.rank){case 2:a=zB("ij,j->i",s,o);break;case 3:a=zB("ijk,k->ij",s,o);break;case 4:a=zB("ijkl,l->ijk",s,o);break;case 5:a=zB("ijklm,m->ijkl",s,o);break;case 6:a=zB("ijklmn,n->ijklm",s,o);break;default:throw new Error("Not a valid tensor rank.")}return a=oz(a,-1),uL(a,i)}});const UB=fM({rotateWithOffset_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const i=dM(e,"image","rotateWithOffset","float32");GR(4===i.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`));const s={image:i},o={radians:t,fillValue:n,center:r};return rM.runKernel(LD,s,o)}});function WB(e,t,n,r,i,s){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==s&&(s=0);const o=e.shape[0];return n=Math.min(n,o),GR(0<=r&&r<=1,(()=>`iouThreshold must be in [0, 1], but was '${r}'`)),GR(2===e.rank,(()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`)),GR(4===e.shape[1],(()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`)),GR(1===t.rank,(()=>"scores must be a 1D tensor")),GR(t.shape[0]===o,(()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`)),GR(0<=s&&s<=1,(()=>`softNmsSigma must be in [0, 1], but was '${s}'`)),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s}}const VB=fM({nonMaxSuppression_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const s=dM(e,"boxes","nonMaxSuppression","float32"),o=dM(t,"scores","nonMaxSuppression","float32"),a=WB(s,o,n,r,i);n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return rM.runKernel(IO,{boxes:s,scores:o},l)}});function jB(e,t,n){const r=function(e,t,n){return function(e,t,n){let r=0,i=e.length,s=0,o=!1;for(;r<i;){s=r+(i-r>>>1);const a=n(t,e[s]);a>0?r=s+1:(i=s,o=!a)}return o?r:-r-1}(e,t,n||GB)}(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function GB(e,t){return e>t?1:e<t?-1:0}function HB(e,t,n,r,i){return XB(e,t,n,r,i,0)}function qB(e,t,n,r,i,s){return XB(e,t,n,r,i,0,!1,s,!0)}function KB(e,t,n,r,i,s){return XB(e,t,n,r,i,s,!0)}function XB(e,t,n,r,i,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const u=[];for(let g=0;g<t.length;g++)t[g]>i&&u.push({score:t[g],boxIndex:g,suppressBeginIndex:0});u.sort(JB);const c=s>0?-.5/s:0,h=[],d=[];for(;h.length<n&&u.length>0;){const t=u.pop(),{score:n,boxIndex:s,suppressBeginIndex:o}=t;if(n<i)break;let a=!1;for(let l=h.length-1;l>=o;--l){const n=YB(e,s,h[l]);if(n>=r){a=!0;break}if(t.score=t.score*QB(r,c,n),t.score<=i)break}t.suppressBeginIndex=h.length,a||(t.score===n?(h.push(s),d.push(t.score)):t.score>i&&jB(u,t,JB))}const p=h.length,f=n-p;a&&f>0&&(h.push(...new Array(f).fill(0)),d.push(...new Array(f).fill(0)));const m={selectedIndices:h};return o&&(m.selectedScores=d),l&&(m.validOutputs=p),m}function YB(e,t,n){const r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),p=(a-s)*(l-o),f=(h-u)*(d-c);if(p<=0||f<=0)return 0;const m=Math.max(s,u),g=Math.max(o,c),v=Math.min(a,h),y=Math.min(l,d),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(p+f-b)}function QB(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function JB(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}const ZB=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const s=dM(e,"boxes","nonMaxSuppressionAsync"),o=dM(t,"scores","nonMaxSuppressionAsync"),a=WB(s,o,n,r,i);n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const l=await Promise.all([s.data(),o.data()]),u=l[0],c=l[1],{selectedIndices:h}=HB(u,c,n,r,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),dB(h,"int32")};const eU=fM({nonMaxSuppressionWithScore_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=dM(e,"boxes","nonMaxSuppression"),a=dM(t,"scores","nonMaxSuppression"),l=WB(o,a,n,r,i,s);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma;const u={boxes:o,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s},h=rM.runKernel(EO,u,c);return{selectedIndices:h[0],selectedScores:h[1]}}});const tU=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=dM(e,"boxes","nonMaxSuppressionAsync"),a=dM(t,"scores","nonMaxSuppressionAsync"),l=WB(o,a,n,r,i,s);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma;const u=await Promise.all([o.data(),a.data()]),c=u[0],h=u[1],{selectedIndices:d,selectedScores:p}=KB(c,h,n,r,i,s);return o!==e&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:dB(d,"int32"),selectedScores:dB(p)}};const nU=fM({nonMaxSuppressionPadded_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=dM(e,"boxes","nonMaxSuppression"),a=dM(t,"scores","nonMaxSuppression"),l=WB(o,a,n,r,i,null),u={boxes:o,scores:a},c={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:s},h=rM.runKernel(CO,u,c);return{selectedIndices:h[0],validOutputs:h[1]}}});const rU=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=dM(e,"boxes","nonMaxSuppressionAsync"),a=dM(t,"scores","nonMaxSuppressionAsync"),l=WB(o,a,n,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,h=l.scoreThreshold,[d,p]=await Promise.all([o.data(),a.data()]),{selectedIndices:f,validOutputs:m}=qB(d,p,u,c,h,s);return o!==e&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:dB(f,"int32"),validOutputs:bL(m,"int32")}};const iU=fM({resizeBilinear_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=dM(e,"images","resizeBilinear");GR(3===i.rank||4===i.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`)),GR(2===t.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`)),GR(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let s=i,o=!1;3===i.rank&&(o=!0,s=OP(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=t,a={images:s},l={alignCorners:n,halfPixelCenters:r,size:t},u=rM.runKernel(jO,a,l);return o?OP(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const sU=fM({resizeNearestNeighbor_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=dM(e,"images","resizeNearestNeighbor");GR(3===i.rank||4===i.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`)),GR(2===t.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`)),GR("float32"===i.dtype||"int32"===i.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),GR(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let s=i,o=!1;3===i.rank&&(o=!0,s=OP(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=t,a={images:s},l={alignCorners:n,halfPixelCenters:r,size:t},u=rM.runKernel(WO,a,l);return o?OP(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const oU=fM({bincount_:function(e,t,n){const r=dM(e,"x","bincount"),i=dM(t,"weights","bincount");GR("int32"===r.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`)),GR(n>=0,(()=>`size must be non-negative, but got ${n}.`)),GR(i.size===r.size||0===i.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`));const s={x:r,weights:i},o={size:n};return rM.runKernel(Y$,s,o)}});const aU=fM({lessEqual_:function(e,t){let n=dM(e,"a","lessEqual","string_or_numeric"),r=dM(t,"b","lessEqual","string_or_numeric");[n,r]=XF(n,r),FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel(Z_,i)}});const lU=fM({round_:function(e){const t={x:dM(e,"x","round")};return rM.runKernel(KO,t)}});const uU=fM({threshold_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const i=dM(e,"image","threshold"),s=i.shape[0]*i.shape[1];let o,a,l,u,c=fL(dB([r]),255);if(GR(3===i.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`)),GR(3===i.shape[2]||1===i.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`)),GR("int32"===i.dtype||"float32"===i.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`)),GR("otsu"===t||"binary"===t,(()=>`Method must be binary or otsu, but was ${t}`)),3===i.shape[2]){[o,a,l]=lB(i,[1,1,1],-1);const e=fL(o,.2989),t=fL(a,.587),n=fL(l,.114);u=hL(hL(e,t),n)}else u=e;if("otsu"===t){c=function(e,t){let n,r,i,s,o,a,l=dB([-1]),u=dB([0]),c=dB([0]);for(let h=0;h<e.size-1;h++){n=tB(e,0,h+1),r=tB(e,h+1),o=pL(vz(n),t),a=pL(vz(r),t);const d=vz(fL(n,Xz(0,n.size)));i=pL(d,vz(n));const p=TL(r.shape,n.size),f=hL(Xz(0,r.size),p),m=fL(r,f);s=pL(vz(m),vz(r));const g=RL(i,s),v=RL(i,s),y=fL(o,a);c=fL(fL(y,g),v);const b=hz(c,u);u=gB(b,c,u),l=gB(b,dB([h]),l)}return l}(oU(uL(lU(u),"int32"),vM([]),256),s)}const h=n?aU(u,c):hz(u,c);return uL(fL(h,255),"int32")}});const cU=fM({transform_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0;const o=dM(e,"image","transform","float32"),a=dM(t,"transforms","transform","float32");GR(4===o.rank,(()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`)),GR(2===a.rank&&(a.shape[0]===o.shape[0]||1===a.shape[0])&&8===a.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),GR(null==s||2===s.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`));const l={image:o,transforms:a},u={interpolation:n,fillMode:r,fillValue:i,outputShape:s};return rM.runKernel(AD,l,u)}});const hU=fM({less_:function(e,t){let n=dM(e,"a","less","string_or_numeric"),r=dM(t,"b","less","string_or_numeric");[n,r]=XF(n,r),FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel(J_,i)}});const dU=fM({bandPart_:function(e,t,n){const r=dM(e,"a","bandPart");GR(r.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`));const i=r.shape,[s,o]=r.shape.slice(-2);let a,l;"number"===typeof t?(GR(t%1===0,(()=>`bandPart(): numLower must be an integer, got ${t}.`)),GR(t<=s,(()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`)),a=dM(t<0?s:t,"numLower","bandPart")):(GR("int32"===t.dtype,(()=>"bandPart(): numLower's dtype must be an int32.")),a=gB(hU(t,0),s,Dz(t,s))),"number"===typeof n?(GR(n%1===0,(()=>`bandPart(): numUpper must be an integer, got ${n}.`)),GR(n<=o,(()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`)),l=dM(n<0?o:n,"numUpper","bandPart")):(GR("int32"===n.dtype,(()=>"bandPart(): numUpper's dtype must be an int32.")),l=gB(hU(n,0),o,Dz(n,o)));const u=OP(Xz(0,s,1,"int32"),[-1,1]),c=Xz(0,o,1,"int32"),h=RL(u,c),d=Nz(aU(h,a),dz(h,Mz(l))),p=zz([s,o],r.dtype);return OP(cB(mB(OP(r,[-1,s,o])).map((e=>gB(d,e,p)))),i)}});function pU(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return _L(e);if(1!==e.rank&&null===n)return pU(OP(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return vz(_L(e),n);if(t===1/0)return gz(_L(e),n);if(t===-1/0)return Oz(_L(e),n);if("euclidean"===t||2===t)return mL(vz(AL(_L(e),bL(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&2===n.length){if(1===t)return gz(vz(_L(e),n[0]),n[1]-1);if(t===1/0)return gz(vz(_L(e),n[1]),n[0]);if(t===-1/0)return Oz(vz(_L(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return mL(vz(gL(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const fU=fM({norm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=pU(e=dM(e,"x","norm"),t,n);let s=i.shape;if(r){const t=t$(n,e.shape);s=kz(i.shape,t)}return OP(i,s)}});const mU=fM({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,GR(null!=e&&e.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=e[0].shape[0];for(let t=1;t<e.length;++t)GR(e[t].shape[0]===n,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[t].shape[0]} vs. ${n})`))}else t=!0,e=lB(e,e.shape[0],0).map((e=>uB(e,[0])));GR(e.length<=e[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`));const n=[],r=e;for(let i=0;i<e.length;++i)n.push(rM.tidy((()=>{let e=r[i];if(i>0)for(let t=0;t<i;++t){const r=fL(vz(fL(n[t],e)),n[t]);e=RL(e,r)}return pL(e,fU(e,"euclidean"))})));return t?cB(n,0):n}});function gU(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return rM.tidy((()=>{GR(2===e.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`));const n=e.shape[0],r=e.shape[1];let i=lz(n),s=cL(e);const o=pB([[1]],[1,1]);let a=cL(o);const l=n>=r?r:n;for(let e=0;e<l;++e){const t=s,l=a,u=i;[a,s,i]=rM.tidy((()=>{const t=tB(s,[e,e],[n-e,1]),l=fU(t),u=tB(s,[e,e],[1,1]),c=gB(hz(u,0),pB([[-1]]),pB([[1]])),h=RL(u,fL(c,l)),d=pL(t,h);a=1===d.shape[0]?cL(o):WP([o,tB(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const p=Mz(pL(Az(c,h),l)),f=tB(s,[e,0],[n-e,r]),m=fL(p,a),g=bB(a);if(0===e)s=RL(f,Az(m,Az(g,f)));else{const t=RL(f,Az(m,Az(g,f)));s=WP([tB(s,[0,0],[e,r]),t],0)}const v=bB(m),y=tB(i,[0,e],[n,i.shape[1]-e]);if(0===e)i=RL(y,Az(Az(y,a),v));else{const t=RL(y,Az(Az(y,a),v));i=WP([tB(i,[0,0],[n,e]),t],1)}return[a,s,i]})),kM([t,l,u])}return!t&&n>r&&(i=tB(i,[0,0],[n,r]),s=tB(s,[0,0],[r,r])),[i,s]}))}const vU=fM({qr_:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(GR(e.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`)),2===e.rank)return gU(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce(((e,t)=>e*t)),r=mB(OP(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],s=[];r.forEach((e=>{const[n,r]=gU(e,t);i.push(n),s.push(r)}));return[OP(cB(i,0),e.shape),OP(cB(s,0),e.shape)]}}});var yU,bU;(bU=yU||(yU={}))[bU.NONE=0]="NONE",bU[bU.MEAN=1]="MEAN",bU[bU.SUM=2]="SUM",bU[bU.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS";const xU=fM({squaredDifference_:function(e,t){let n=dM(e,"a","squaredDifference"),r=dM(t,"b","squaredDifference");[n,r]=XF(n,r),FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel(vD,i,{})}});const wU={flipLeftRight:LB,grayscaleToRGB:PB,resizeNearestNeighbor:sU,resizeBilinear:iU,rgbToGrayscale:BB,rotateWithOffset:UB,cropAndResize:MB,nonMaxSuppression:VB,nonMaxSuppressionAsync:ZB,nonMaxSuppressionWithScore:eU,nonMaxSuppressionWithScoreAsync:tU,nonMaxSuppressionPadded:nU,nonMaxSuppressionPaddedAsync:rU,threshold:uU,transform:cU},kU={bandPart:dU,gramSchmidt:mU,qr:vU};const SU=class{static sgd(e){return new PL(e)}static momentum(e,t){return new zL(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}static rmsprop(e){return new BL(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}static adam(){return new $L(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}static adadelta(){return new EL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}static adamax(){return new LL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}static adagrad(e){return new NL(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}},IU="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:e=>e();function CU(){return new Promise((e=>IU((()=>e()))))}function EU(e,t){const n=e[0].length;e.forEach(((e,t)=>{GR(e.length===n,(()=>`Error in concat${n}D: rank of tensors[${t}] must be the same as the rank of the rest (${n})`))})),GR(t>=0&&t<n,(()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`));const r=e[0];e.forEach(((e,i)=>{for(let s=0;s<n;s++)GR(s===t||e[s]===r[s],(()=>`Error in concat${n}D: Shape of tensors[${i}] (${e}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`))}))}function TU(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var NU,AU;function RU(e,t,n){let r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){const s=n[i],o=r[r.length-n.length+i],a=r[o];if(s>=0)if(a>=0){if(a!==s)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${s} but shape[${i+e}] = ${a}`)}else r[o]=s}return r}function $U(e){const t={FIRST_DIM_SIZE:NU.FIRST_DIM_SIZE,VALUE_ROWIDS:NU.VALUE_ROWIDS,ROW_LENGTHS:NU.ROW_LENGTHS,ROW_SPLITS:NU.ROW_SPLITS,ROW_LIMITS:NU.ROW_LIMITS,ROW_STARTS:NU.ROW_STARTS},n=[];for(const r of e){if(!(r in t))break;n.push(t[r])}return n}function _U(e){return 0===e.length?0:e[0]===NU.FIRST_DIM_SIZE?e.length-1:e.length}function OU(e,t){if(null==e||null==t)return;const n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){const n=e[i],r=t[i+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${n} but ragged tensor input.flatValues.shape[${i-e.length}] = ${r}`)}}(AU=NU||(NU={}))[AU.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",AU[AU.VALUE_ROWIDS=1]="VALUE_ROWIDS",AU[AU.ROW_LENGTHS=2]="ROW_LENGTHS",AU[AU.ROW_SPLITS=3]="ROW_SPLITS",AU[AU.ROW_LIMITS=4]="ROW_LIMITS",AU[AU.ROW_STARTS=5]="ROW_STARTS";const DU=30;function FU(e){return e<=DU?e:h$(e,Math.floor(Math.sqrt(e)))}function MU(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function LU(e,t,n){let r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])r=r.concat(t.slice(0)),r.push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);const n=t.length;for(let i=0;i<n;++i)r=r.concat([e[i+1]/t[i],t[i]]);r=r.concat(e.slice(n+1))}return r}function PU(e,t){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(let r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{const r=[],i=[];for(let n=1;n<e;++n)n>=2*t+1||n%2===1?i.push(n):r.push(n);n.push(...r),n.push(0),n.push(...i)}return n}function zU(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let s=1;s<e.length;++s)s<=t.length?r?i.push(t[s-1]*e[s]):i.push(e[s]/t[s-1]):i.push(e[s]);return i}function BU(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function UU(e,t,n){const r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}function WU(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(0===KR(e.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const i=t.shape,s=i[i.length-1];let o=1;for(let h=0;h<i.length-1;++h)o*=i[h];const a=e.shape,l=i.slice();l.pop();let u=1;for(let h=s;h<n;++h)u*=a[h],l.push(a[h]);const c=[...d$(e.shape).map((e=>e/u)),1].slice(0,s);return[l,o,u,c]}function VU(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(s+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw new Error(s+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw new Error(s+" update.rank != "+(i+e.length-r));for(let o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(s+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${t.shape[o]}).`);for(let o=0;o<n.rank-i;++o)if(n.shape[o+i]!==e[o+r])throw new Error(s+` updates.shape[${o+i}] (${n.shape[o+i]}) != shape[${o+i}] (${e[o+i]})`)}function jU(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if("int32"!==t.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===t.size)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===e.size)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}VU(n,t,e)}function GU(e,t,n){const r=t.shape.length,i=r>1?t.shape[r-1]:1,s=n.length;let o=1;for(let l=i;l<s;++l)o*=n[l];const a=i<1?1:i;return{sliceRank:i,numUpdates:KR(t.shape)/a,sliceSize:o,strides:[...d$(n.slice(0,i)),1],outputSize:KR(n)}}const HU=1.7580993408473768,qU=1.0507009873554805,KU=.3275911,XU=.254829592,YU=-.284496736,QU=1.421413741,JU=-1.453152027,ZU=1.061405429;function eW(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function tW(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function nW(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=0;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function rW(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=2;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function iW(e,t){return{real:e[2*t],imag:e[2*t+1]}}function sW(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function oW(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){const s=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(s),r[i]=Math.sin(s)}return{real:n,imag:r}}function aW(e,t,n){const r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}const lW="->",uW=/->/g,cW=",",hW="...";function dW(e,t){const n=((e=e.replace(/\s/g,"")).length-e.replace(uW,"").length)/lW.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${lW}").`);const[r,i]=e.split(lW);GR(-1===r.indexOf(hW),(()=>`The ellipsis notation ("${hW}") is not supported yet.`));const s=r.split(cW),o=s.length;if(t!==o)throw new Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<i.length;++h){const e=i[h];if(!s.some((t=>-1!==t.indexOf(e))))throw new Error(`Output subscripts contain the label ${e} not present in the input subscripts.`);-1===a.indexOf(e)&&a.push(e)}for(let h=0;h<r.length;++h){const e=r[h];-1===a.indexOf(e)&&e!==cW&&a.push(e)}const l=new Array(s.length);for(let h=0;h<o;++h){if(new Set(s[h].split("")).size!==s[h].length)throw new Error(`Found duplicate axes in input component ${s[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let e=0;e<s[h].length;++e)l[h].push(a.indexOf(s[h][e]))}const u=a.length,c=[];for(let h=i.length;h<u;++h)c.push(h);return{allDims:a,summedDims:c,idDims:l}}function pW(e,t){let n=new Array(e);n.fill(-1);for(let i=0;i<t.length;++i)n[t[i]]=i;const r=[];for(let i=0;i<e;++i)-1===n[i]&&r.push(i);return n=n.filter((e=>-1!==e)),{permutationIndices:n,expandDims:r}}function fW(e,t,n){const r=new Array(e);for(let i=0;i<n.length;++i){const e=n[i].shape;for(let n=0;n<t[i].length;++n)void 0===r[t[i][n]]?r[t[i][n]]=e[n]:GR(r[t[i][n]]===e[n],(()=>`Expected dimension ${r[t[i][n]]} at axis ${n} of input shaped ${JSON.stringify(e)}, but got dimension ${e[n]}`))}}function mW(e,t){const n=e,r=[];let i=0;0===e.length&&n.push(-1),i=e.length+1;for(let o=0;o<i;++o)r.push([]);const s=[];for(let o=0;o<n.length;++o){const e=vW(t,n[o]);for(const t of e)-1===s.indexOf(t)&&(r[o].push(t),s.push(t))}return{path:n,steps:r}}function gW(e){return e.every(((e,t)=>e===t))}function vW(e,t){const n=[];for(let r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function yW(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)GR(e.shape[n]%t===0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(t).fill(e.shape[n]/t);else{GR(t.reduce(((e,t)=>(-1===t&&(e+=1),e)),0)<=1,(()=>"There should be only one negative value in split array."));const i=t.indexOf(-1);if(-1!==i){const r=t.reduce(((e,t)=>t>0?e+t:e));t[i]=e.shape[n]-r}GR(e.shape[n]===t.reduce(((e,t)=>e+t)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=t}return r}function bW(e){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${e}`}function xW(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function wW(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}function kW(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function SW(e,t){return`size ${e} must be non-negative, not ${t}`}function IW(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function CW(e,t){return`Input to reshape is a SparseTensor with ${KR(e)}\n  dense values, but the requested shape requires a multiple of ${KR(t)}. inputShape=${e} outputShape= ${t}`}function EW(e,t){return`Input to reshape is a tensor with ${KR(e)} dense values, but the requested shape has ${KR(t)}. inputShape=${e} outputShape=${t}`}function TW(){return"segment ids must be >= 0"}function NW(){return"segment ids are not increasing"}function AW(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function RW(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}function $W(e,t){let n,r=!1;for(e<=DU?(n=e,r=!0):n=h$(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=h$(e,n+1);return n}function _W(e,t,n){const r=[],i=e.length;for(let s=0;s<i;s++)s!==t?r.push(e[s]):r.push(n);return r}function OW(e,t,n,r){const i=t.shape.length,s=e.shape.length;if(0!==r&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${s}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let h=0;h<r;++h)if(e.shape[h]!==t.shape[h])throw new Error(`x.shape[${h}]: ${e.shape[h]} should be equal to indices.shape[${h}]: ${t.shape[h]}.`);const o=e.shape[n],a=[];let l=1,u=1,c=1;for(let h=0;h<r;++h)a.push(e.shape[h]),l*=e.shape[h];for(let h=r;h<n;h++)a.push(e.shape[h]),u*=e.shape[h];for(let h=r;h<i;h++)a.push(t.shape[h]);for(let h=n+1;h<s;h++)a.push(e.shape[h]),c*=e.shape[h];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:o,outputShape:a}}function DW(e){try{return e.map((e=>gF(e)))}catch(pae){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${pae}`)}}function FW(e){return e.map((e=>mF(e)))}function MW(e,t){const n=[];for(let s=0;s<t.length;s++)t[s]&&n.push(s);const r=lL(e,"int32"),i=lL([n.length,e.length],"int32");for(let s=0;s<n.length;s++){const t=r.indexToLoc(n[s]),o=s*e.length;i.values.set(t,o)}return i.toTensor()}!function(){for(const e of UL)IL(e)}();const LW={kernelName:R$,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(e,TB(uL(n,"float32"),-1))}}},PW={kernelName:$$,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=gL(uL(n,"float32")),r=mL(RL(bL(1),t));return Mz(pL(e,r))}}}},zW={kernelName:_$,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=mL(RL(gL(uL(n,"float32")),1));return pL(e,t)}}}},BW={kernelName:O$,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=FL(n.shape,r.shape);return{a:()=>{let t=e;const r=DL(n.shape,i);return r.length>0&&(t=vz(t,r)),OP(t,n.shape)},b:()=>{let t=e;const n=DL(r.shape,i);return n.length>0&&(t=vz(t,n)),OP(t,r.shape)}}}},UW={kernelName:D$,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach(((t,r)=>{n[r]=()=>e.clone()})),n}},WW={kernelName:L$,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>vL(n)}}},VW={kernelName:P$,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>vL(n)}}},jW={kernelName:z$,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>pL(e,mL(RL(bL(1),gL(uL(n,"float32")))))}}},GW={kernelName:B$,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=mL(hL(bL(1),gL(uL(n,"float32"))));return pL(e,t)}}}},HW={kernelName:V$,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=FL(n.shape,r.shape);return{a:()=>{const t=hL(gL(n),gL(r));let s=fL(e,pL(r,t));const o=DL(n.shape,i);return o.length>0&&(s=vz(s,o)),OP(s,n.shape)},b:()=>{const t=hL(gL(n),gL(r));let s=Mz(fL(e,pL(n,t)));const o=DL(r.shape,i);return o.length>0&&(s=vz(s,o)),OP(s,r.shape)}}}},qW={kernelName:U$,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>pL(e,hL(gL(uL(n,"float32")),1))}}},KW={kernelName:W$,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>pL(e,RL(bL(1),gL(uL(n,"float32"))))}}};const XW=fM({avgPool3dGrad_:function(e,t,n,r,i,s){const o=dM(e,"dy","avgPool3dGrad"),a=dM(t,"input","avgPool3dGrad");let l=o,u=a,c=!1;4===a.rank&&(c=!0,l=OP(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),u=OP(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),GR(5===l.rank,(()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`)),GR(5===u.rank,(()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`)),_P("avgPool3dGrad",i,s);const h={dy:l,input:u},d={filterSize:n,strides:r,pad:i,dimRoundingMode:s},p=rM.runKernel(q$,h,d);return c?OP(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),YW={kernelName:H$,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:a}=n;return{x:()=>XW(e,r,i,s,o,a)}}};const QW=fM({avgPoolGrad_:function(e,t,n,r,i){const s=dM(e,"dy","avgPoolGrad"),o=dM(t,"input","avgPoolGrad");GR(o.rank===s.rank,(()=>`Rank of input (${o.rank}) does not match rank of dy (${s.rank})`));let a=o,l=s,u=!1;3===o.rank&&(u=!0,a=OP(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=OP(s,[1,s.shape[0],s.shape[1],s.shape[2]])),GR(4===l.rank,(()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`)),GR(4===a.rank,(()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`));const c={dy:l,input:a},h={filterSize:n,strides:r,pad:i},d=rM.runKernel(G$,c,h);return u?OP(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),JW={kernelName:j$,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:s,pad:o}=n;return{x:()=>QW(e,r,i,s,o)}}},ZW={kernelName:K$,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,i]=t,{transposeA:s,transposeB:o}=n;return s||o?!s&&o?{a:()=>Az(e,i,!1,!1),b:()=>Az(e,r,!0,!1)}:s&&!o?{a:()=>Az(i,e,!1,!0),b:()=>Az(r,e,!1,!1)}:{a:()=>Az(i,e,!0,!0),b:()=>Az(e,r,!0,!0)}:{a:()=>Az(e,i,!1,!0),b:()=>Az(r,e,!0,!1)}}};const eV=fM({spaceToBatchND_:function(e,t,n){const r=dM(e,"x","spaceToBatchND");GR(r.rank>=1+t.length,(()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`)),GR(n.length===t.length,(()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`)),GR(r.shape.reduce(((e,r,i)=>i>0&&i<=t.length?e&&(r+n[i-1][0]+n[i-1][1])%t[i-1]===0:e),!0),(()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`));const i={x:r},s={blockShape:t,paddings:n};return rM.runKernel(uD,i,s)}}),tV={kernelName:X$,gradFunc:(e,t,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>eV(e,r,i)}}},nV={kernelName:"BroadcastTo",gradFunc:(e,t,n)=>{const r=n,i=r.inputShape,s=r.shape,o=Array.from(s);for(let l=i.length-1;l>=0;l--)if(i[l]===s[l])o[l]=1;else if(1!==i[l])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${s}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>vz(e,a,!0)}}},rV={kernelName:Z$,gradFunc:e=>({x:()=>e.clone()})},iV={kernelName:e_,gradFunc:e=>({x:()=>vL(e)})},sV={kernelName:t_,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:i,clipValueMax:s}=n;return{x:()=>gB(Nz(dz(r,i),aU(r,s)),e,vL(e))}}},oV={kernelName:r_,inputsToSave:["x"],gradFunc:LW.gradFunc},aV={kernelName:i_,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map((e=>e.shape)),{axis:i}=n,s=t$(i,t[0].shape)[0],o=r.map((e=>e[s]));return lB(e,o,s).map((e=>()=>e))}},lV={kernelName:s_,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{dilations:s,strides:o,pad:a,dataFormat:l}=n;return GR(NP(s),(()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`)),{x:()=>XP(r.shape,e,i,o,a,l),filter:()=>CB(r,e,i.shape,o,a,l)}}},uV={kernelName:a_,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{strides:s,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>qP(e,i,s,o,a,1,l),filter:()=>CB(e,r,i.shape,s,o,a,l)}}};const cV=fM({conv3DBackpropFilter_:function(e,t,n,r,i){let s=e;4===e.rank&&(s=OP(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let o=t;4===o.rank&&(o=OP(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),GR(5===s.rank,(()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`)),GR(5===o.rank,(()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`)),GR(5===n.length,(()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`)),GR(s.shape[4]===n[3],(()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${n[3]}.`)),GR(o.shape[4]===n[4],(()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`));const a={x:s,dy:o},l={strides:r,pad:i,filterShape:n};return rM.runKernel(u_,a,l)}}),hV={kernelName:l_,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:s}=n;GR(NP(r),(()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`));const[o,a]=t;return{x:()=>JP(o.shape,e,a,i,s),filter:()=>cV(o,e,a.shape,i,s)}}};const dV=fM({sin_:function(e){const t={x:dM(e,"x","sin","float32")};return rM.runKernel(nD,t)}}),pV={kernelName:h_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(Mz(dV(uL(n,"float32"))),e)}}};const fV=fM({sinh_:function(e){const t={x:dM(e,"x","sinh")};return rM.runKernel(rD,t)}}),mV={kernelName:d_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(fV(uL(n,"float32")),e)}}};const gV=fM({cumsum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i={x:dM(e,"x","cumsum")},s={axis:t,exclusive:n,reverse:r};return rM.runKernel(f_,i,s)}}),vV={kernelName:f_,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i,exclusive:s,reverse:o}=n;return{x:()=>{const t=Iz([i],r.rank);let n=gV(e,i,s,!o);return null!=t&&(n=bB(n,t)),n}}}},yV={kernelName:y_,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:s,dimRoundingMode:o}=n,a=null==r?[1,1]:r;GR(NP(a),(()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`));const[l,u]=t;return GR(4===l.rank,(()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`)),GR(4===u.rank,(()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`)),GR(l.shape[3]===u.shape[2],(()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`)),GR(AP(i,a),(()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${a}'.`)),_P("depthwiseConv2d",s,o),{x:()=>DB(l.shape,e,u,i,s,a,o),filter:()=>OB(l,e,u.shape,i,s,a,o)}}},bV={kernelName:k_,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,s={x:r,filter:i,dy:e},o={x:r,filter:i,dy:e};return{x:()=>rM.runKernel(S_,s,n),filter:()=>rM.runKernel(I_,o,n)}}},xV={kernelName:N_,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>rM.runKernel(A_,r)}}},wV={kernelName:R_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=fL(sz(Mz(gL(n))),2/Math.sqrt(Math.PI));return{x:()=>fL(e,r)}}},kV={kernelName:__,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(e,n)}}},SV={kernelName:O_,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>OP(e,n.shape)}}},IV={kernelName:D_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(e,sz(n))}}},CV={kernelName:P_,gradFunc:e=>({x:()=>vL(e)})},EV={kernelName:z_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=FL(n.shape,r.shape);return{a:()=>{const t=pL(e,uL(r,"float32")),s=DL(n.shape,i);return s.length>0?OP(vz(t,s),n.shape):t},b:()=>{let t=fL(e,uL(n,"float32"));const s=DL(r.shape,i);s.length>0&&(t=OP(vz(t,s),r.shape));const o=gL(r);return Mz(pL(t,uL(o,"float32")))}}}};const TV=fM({rsqrt_:function(e){const t={x:dM(e,"x","rsqrt","float32")};return rM.runKernel(XO,t)}}),NV={kernelName:B_,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[i,s,o,a]=t,l=null==a?bL(1):a,u=DL(s.shape,i.shape),c=[];if(1===s.rank){for(let e=0;e<i.shape.length-1;++e)c.push(i.shape[e]);c.push(1)}const h=RL(i,s),d=fL(e,l),p=TV(hL(o,bL(r))),f=fL(fL(fL(p,p),p),bL(-.5));return{x:()=>1===s.rank?OP(fL(fL(e,az(OP(p,[1,1,1,s.shape[0]]),c)),l),i.shape):OP(fL(fL(e,p),l),i.shape),mean:()=>{let e=fL(fL(p,bL(-1)),d);return 1===s.rank&&(e=vz(e,u)),OP(e,s.shape)},variance:()=>{let e=fL(fL(f,h),d);return 1===s.rank&&(e=vz(e,u)),OP(e,s.shape)},scale:()=>{const t=fL(h,p);let n=fL(e,t);return 1===s.rank&&(n=vz(n,u)),OP(n,s.shape)},offset:()=>{let t=e;return 1===s.rank&&(t=vz(t,u)),OP(t,s.shape)}}}};const AV=fM({unsortedSegmentSum_:function(e,t,n){const r=dM(e,"x","unsortedSegmentSum"),i=dM(t,"segmentIds","unsortedSegmentSum","int32");GR(YR(n),(()=>"numSegments must be of dtype int"));const s={x:r,segmentIds:i},o={numSegments:n};return rM.runKernel(OD,s,o)}}),RV={kernelName:U_,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,i]=t,{axis:s,batchDims:o}=n,a=t$(s,r.shape)[0],l=(e,t,n)=>()=>{const r=e.shape,i=t.size,o=r.slice(0,a),l=o.length,u=r.slice(s,r.length).slice(1),c=u.length,h=$V(0,l),d=$V(l+1,l+1+c),p=_V([o,[i],u]),f=OP(n,p),m=OP(t,[i]),g=_V([[l],h,d]),v=bB(f,g);let y=AV(v,m,e.shape[a]);const b=Cz(g);return y=bB(y,b),y};if(1===o){const t=r.shape[0],n=r.split(t,0);return{x:()=>{const t=cB(n.map(((t,n)=>l(t,i.slice(n,1),e.slice(n,1))())));return t.reshape(r.shape)},indices:()=>i}}return{x:l(r,i,e),indices:()=>i}}};function $V(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function _V(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}const OV={kernelName:j_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>vL(n),b:()=>vL(r)}}},DV={kernelName:G_,gradFunc:e=>({x:()=>uL(e,"float32")})},FV={kernelName:K_,gradFunc:e=>({x:()=>vL(e)})},MV={kernelName:X_,gradFunc:e=>({x:()=>vL(e)})},LV={kernelName:Y_,gradFunc:e=>({x:()=>vL(e)})},PV={kernelName:Q_,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:i}=n,s=hz(r,0);return{x:()=>gB(s,e,fL(e,i))}}},zV={kernelName:nO,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>pL(e,hL(n,1))}}},BV={kernelName:tO,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>pL(e,uL(n,"float32"))}}},UV={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;return{logits:()=>{const t=sz(r);return RL(e,fL(vz(e,i,!0),t))}}}};const WV=fM({localResponseNormalizationBackprop_:function(e,t,n){const r={x:e,y:t,dy:n},i={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return rM.runKernel(aO,r,i)}}),VV={kernelName:oO,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{depthRadius:s,bias:o,alpha:a,beta:l}=n;return{x:()=>WV(r,i,e,s,o,a,l)}}};function jV(e,t,n,r){return t.rank<n.rank&&(t=OP(t,kz(t.shape,r))),e.rank<n.rank&&(e=OP(e,kz(e.shape,r))),{x:()=>fL(e,uL(rz(n,t),e.dtype))}}const GV={kernelName:lO,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:i}=r,s=t[0],o=jV(e,t[1],s,t$(i,s.shape));return{x:()=>o.x()}}},HV={kernelName:uO,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>fL(e,uL(dz(n,r),"float32")),b:()=>fL(e,uL(hU(n,r),"float32"))}}};const qV=fM({maxPool3dGrad_:function(e,t,n,r,i,s,o){const a=dM(e,"dy","maxPool3dGrad"),l=dM(t,"input","maxPool3dGrad"),u=dM(n,"output","maxPool3dGrad");let c=a,h=l,d=u,p=!1;4===l.rank&&(p=!0,c=OP(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=OP(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=OP(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),GR(5===c.rank,(()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`)),GR(5===h.rank,(()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`)),GR(5===d.rank,(()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`)),_P("maxPool3dGrad",s,o);const f={dy:c,input:h,output:d},m={filterSize:r,strides:i,pad:s,dimRoundingMode:o},g=rM.runKernel(pO,f,m);return p?OP(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),KV={kernelName:dO,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>qV(e,r,i,s,o,a,l)}}};const XV=fM({maxPoolGrad_:function(e,t,n,r,i,s,o){const a=dM(e,"dy","maxPoolGrad"),l=dM(t,"input","maxPoolGrad"),u=dM(n,"output","maxPoolGrad");GR(l.rank===a.rank,(()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`)),GR(4===a.rank,(()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`)),GR(4===l.rank,(()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`)),_P("maxPoolGrad",s,o);const c={dy:a,input:l,output:u},h={filterSize:r,strides:i,pad:s,dimRoundingMode:o};return rM.runKernel(hO,c,h)}}),YV={kernelName:cO,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:s,strides:o,pad:a}=n;return{x:()=>XV(e,r,i,s,o,a)}}},QV={kernelName:mO,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n,s=t$(i,r.shape),o=KR(wz(r.shape,s)[1]);return{x:()=>{const t=r.shape.slice();s.forEach((e=>{t[e]=1}));const n=OP(e,t);return pL(fL(n,Bz(r.shape,"float32")),o)}}}},JV={kernelName:gO,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:i}=r,[s,o]=t,a=jV(e,o,s,t$(i,s.shape));return{x:()=>a.x()}}},ZV={kernelName:vO,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>fL(e,uL(aU(n,r),"float32")),b:()=>fL(e,uL(hz(n,r),"float32"))}}},ej={kernelName:yO,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,s=i.map((e=>e[0]));return{x:()=>tB(e,s,r.shape)}}},tj={kernelName:bO,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=FL(n.shape,r.shape);return{a:()=>{const t=DL(n.shape,i);return t.length>0?OP(vz(e,t),n.shape):e},b:()=>{const t=fL(e,Mz(uz(pL(n,r)))),s=DL(r.shape,i);return s.length>0?OP(vz(t,s),r.shape):t}}}},nj={kernelName:wO,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=FL(n.shape,r.shape);return{a:()=>{const t=fL(e,uL(r,"float32")),s=DL(n.shape,i);return s.length>0?OP(vz(t,s),n.shape):t},b:()=>{const t=fL(e,uL(n,"float32")),s=DL(r.shape,i);return s.length>0?OP(vz(t,s),r.shape):t}}}},rj={kernelName:kO,gradFunc:e=>({x:()=>Mz(e)})},ij={kernelName:NO,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>zz(n.shape,"float32")}}},sj={kernelName:TO,gradFunc:e=>({x:()=>vL(e)})},oj={kernelName:AO,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return mB(e,r).map((e=>()=>e))}},aj={kernelName:RO,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,s=i.map((e=>e[0]));return{x:()=>tB(e,s,r.shape)}}},lj={kernelName:$O,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,i]=t,s=n,o=r,a=FL(s.shape,o.shape);return{a:()=>{const t=uL(o,"float32");let n=fL(e,fL(t,AL(s,RL(t,bL(1)))));const r=DL(s.shape,a);return r.length>0&&(n=vz(n,r)),OP(n,s.shape)},b:()=>{const t=hz(s,0),n=gB(t,fz(s),vL(s));let r=fL(e,fL(i,n));const l=DL(o.shape,a);return l.length>0&&(r=vz(r,l)),OP(r,o.shape)}}}},uj={kernelName:_O,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,i=hz(n,0);return{x:()=>gB(i,e,fL(e,r)),alpha:()=>{let t=gB(i,vL(e),fL(e,n));const s=DL(r.shape,e.shape);return s.length>0&&(t=vz(t,s)),OP(t,r.shape)}}}};const cj=fM({cumprod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i={x:dM(e,"x","cumprod")},s={axis:t,exclusive:n,reverse:r};return rM.runKernel(p_,i,s)}});function hj(e,t,n){const r=e.shape.length,i=r-n.length,s=Iz(n,r);let o=e;null!=s&&(o=bB(e,s));const a=o.shape.slice(),l=a.splice(r-n.length,n.length).reduce(((e,t)=>e*t),1);a.push(l);let u=function(e,t,n){const r=e.shape.slice();r[n]=1;const i=OP(t,r),s=cj(e,n,!0,!1),o=cj(e,n,!0,!0),a=fL(s,o);return fL(i,a)}(o.reshape(a),t,i);if(u=u.reshape(o.shape),null!=s){const e=Cz(s);u=bB(u,e)}return u}const dj={kernelName:OO,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;let s=[];return s=void 0===i||null===i?r.shape.map(((e,t)=>t)):"number"===typeof i?[i]:i,{x:()=>hj(r,e,s)}}},pj={kernelName:E_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=FL(n.shape,r.shape);return{a:()=>{const t=pL(e,uL(r,"float32")),s=DL(n.shape,i);return s.length>0?OP(vz(t,s),n.shape):t},b:()=>{let t=fL(e,uL(n,"float32"));const s=DL(r.shape,i);s.length>0&&(t=OP(vz(t,s),r.shape));const o=gL(r);return Mz(pL(t,uL(o,"float32")))}}}},fj={kernelName:zO,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>pL(e,Mz(gL(n)))}}},mj={kernelName:HO,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=fL(aU(n,6),TB(n));return{x:()=>fL(e,uL(r,"float32"))}}},gj={kernelName:BO,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(e,uL(TB(n),"float32"))}}},vj={kernelName:UO,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>OP(e,n.shape)}}},yj={kernelName:jO,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>rM.runKernel(GO,i,n)}}},bj={kernelName:WO,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>rM.runKernel(VO,i,n)}}},xj={kernelName:qO,gradFunc:(e,t,n)=>{const{dims:r}=n,i=t$(r,e.shape);return{x:()=>Qz(e,i)}}},wj={kernelName:KO,gradFunc:e=>({x:()=>vL(e)})},kj={kernelName:XO,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Mz(pL(e,fL(AL(n,1.5),2)))}}};const Sj=fM({logicalNot_:function(e){const t={x:dM(e,"x","logicalNot","bool")};return rM.runKernel(iO,t)}}),Ij={kernelName:ZO,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>uL(vL(n),"float32"),t:()=>fL(e,uL(n,e.dtype)),e:()=>fL(e,uL(Sj(n),e.dtype))}}},Cj={kernelName:eD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=hz(n,bL(0)),r=bL(HU),i=bL(qU),s=fL(e,i),o=fL(fL(e,r),sz(uL(n,"float32")));return gB(t,s,o)}}}},Ej={kernelName:sD,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(e,fL(n,RL(bL(1),n)))}}},Tj={kernelName:iD,gradFunc:e=>({x:()=>vL(e)})};const Nj=fM({cos_:function(e){const t={x:dM(e,"x","cos","float32")};return rM.runKernel(h_,t)}}),Aj={kernelName:nD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(Nj(uL(n,"float32")),e)}}};const Rj=fM({cosh_:function(e){const t={x:dM(e,"x","cosh","float32")};return rM.runKernel(d_,t)}}),$j={kernelName:rD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(Rj(uL(n,"float32")),e)}}},_j={kernelName:tD,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:i,size:s}=n,o=r.shape,[a,l]=dP(r,i,s),u=[];for(let c=0;c<e.rank;c++)u.push([a[c],o[c]-a[c]-l[c]]);return{x:()=>Wz(e,u)}}},Oj={kernelName:hD,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:i}=n,s=fL(e,r);return{logits:()=>RL(s,fL(vz(s,[i],true),r))}}},Dj={kernelName:oD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(e,eB(n))}}};const Fj=fM({batchToSpaceND_:function(e,t,n){const r=dM(e,"x","batchToSpaceND"),i=t.reduce(((e,t)=>e*t));GR(r.rank>=1+t.length,(()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`)),GR(n.length===t.length,(()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`)),GR(r.shape[0]%i===0,(()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`));const s={x:r},o={blockShape:t,crops:n};return rM.runKernel(X$,s,o)}}),Mj={kernelName:uD,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>Fj(e,r,i)}}},Lj={kernelName:cD,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>WP(e,r)}}},Pj={kernelName:vD,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=bL(2);return{a:()=>fL(e,fL(i,RL(n,r))),b:()=>fL(e,fL(i,RL(r,n)))}}},zj={kernelName:ID,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=FL(n.shape,r.shape);return{a:()=>{let t=e;const r=DL(n.shape,i);return r.length>0&&(t=vz(t,r)),OP(t,n.shape)},b:()=>{let t=e;const n=DL(r.shape,i);return n.length>0&&(t=vz(t,n)),OP(Mz(t),r.shape)}}}};const Bj=[LW,PW,zW,BW,UW,WW,VW,jW,GW,HW,qW,KW,YW,JW,ZW,tV,nV,rV,iV,sV,oV,aV,uV,lV,hV,pV,mV,vV,yV,bV,pj,xV,wV,kV,SV,IV,EV,CV,NV,RV,OV,DV,FV,MV,LV,PV,zV,BV,UV,VV,GV,GV,HV,KV,YV,QV,JV,ZV,ej,tj,nj,rj,ij,sj,oj,aj,aj,lj,uj,dj,fj,mj,gj,vj,yj,bj,xj,wj,kj,Ij,Cj,Ej,Tj,Aj,$j,_j,Oj,Dj,Mj,Mj,Lj,Lj,{kernelName:aD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>pL(e,fL(mL(uL(n,"float32")),2))}}},Pj,{kernelName:yD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(e,fL(uL(n,"float32"),2))}}},{kernelName:FD,gradFunc:e=>({x:()=>vL(e)})},zj,{kernelName:lD,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,i=r.shape.slice(),{axis:s}=n;t$(s,r.shape).forEach((e=>{i[e]=1}));const o=OP(e,i),a=fL(o,Bz(r.shape,"float32"));return{x:()=>a}}},{kernelName:CD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>pL(e,gL(Nj(n)))}}},{kernelName:ED,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>fL(RL(bL(1),gL(n)),e)}}},{kernelName:TD,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:i}=n;return{x:()=>{let t=vL(r);if(1===r.rank)for(let n=0;n<i[0];++n)t=hL(t,tB(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<i[0];++n)for(let s=0;s<i[1];++s)t=hL(t,tB(e,[n*r.shape[0],s*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<i[0];++n)for(let s=0;s<i[1];++s)for(let o=0;o<i[2];++o)t=hL(t,tB(e,[n*r.shape[0],s*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);for(let n=0;n<i[0];++n)for(let s=0;s<i[1];++s)for(let o=0;o<i[2];++o)for(let a=0;a<i[3];++a)t=hL(t,tB(e,[n*r.shape[0],s*r.shape[1],o*r.shape[2],a*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},{kernelName:RD,gradFunc:(e,t,n)=>{const r=n,{perm:i}=r,s=Cz(i);return{x:()=>bB(e,s)}}},{kernelName:_D,gradFunc:(e,t,n)=>{const r=n,{axis:i}=r;return{value:()=>cB(e,i)}}},{kernelName:OD,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>function(e,t){const n=ML(t,vL(t)),r=cz(e,n);let i=dz(t,bL(0,"int32"));const s=r.rank-i.rank;for(let a=0;a<s;++a)i=oz(i,a+1);i=Nz(i,Bz(r.shape,"bool"));const o=vL(r);return gB(i,r,o)}(e,n)}}},{kernelName:DD,gradFunc:e=>({x:()=>vL(e)})}];for(const n of Bj)XD(n);_F().prototype.abs=function(){return this.throwIfDisposed(),_L(this)};const Uj=fM({acos_:function(e){const t={x:dM(e,"x","acos")};return rM.runKernel($$,t)}});_F().prototype.acos=function(){return this.throwIfDisposed(),Uj(this)};const Wj=fM({acosh_:function(e){const t={x:dM(e,"x","acosh")};return rM.runKernel(_$,t)}});_F().prototype.acosh=function(){return this.throwIfDisposed(),Wj(this)},_F().prototype.add=function(e){return this.throwIfDisposed(),hL(this,e)},_F().prototype.all=function(e,t){return this.throwIfDisposed(),mP(this,e,t)},_F().prototype.any=function(e,t){return this.throwIfDisposed(),gP(this,e,t)},_F().prototype.argMax=function(e){return this.throwIfDisposed(),vP(this,e)};const Vj=fM({argMin_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:dM(e,"x","argMin")},r={axis:t};return rM.runKernel(P$,n,r)}});_F().prototype.argMin=function(e){return this.throwIfDisposed(),Vj(this,e)},_F().prototype.asScalar=function(){return this.throwIfDisposed(),GR(1===this.size,(()=>"The array must have only 1 element.")),OP(this,[])},_F().prototype.asType=function(e){return this.throwIfDisposed(),uL(this,e)},_F().prototype.as1D=function(){return this.throwIfDisposed(),OP(this,[this.size])},_F().prototype.as2D=function(e,t){return this.throwIfDisposed(),OP(this,[e,t])},_F().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),OP(this,[e,t,n])},_F().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),OP(this,[e,t,n,r])},_F().prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),OP(this,[e,t,n,r,i])};const jj=fM({asin_:function(e){const t={x:dM(e,"x","asin")};return rM.runKernel(z$,t)}});_F().prototype.asin=function(){return this.throwIfDisposed(),jj(this)};const Gj=fM({asinh_:function(e){const t={x:dM(e,"x","asinh")};return rM.runKernel(B$,t)}});_F().prototype.asinh=function(){return this.throwIfDisposed(),Gj(this)};const Hj=fM({atan_:function(e){const t={x:dM(e,"x","atan")};return rM.runKernel(U$,t)}});_F().prototype.atan=function(){return this.throwIfDisposed(),Hj(this)};const qj=fM({atan2_:function(e,t){let n=dM(e,"a","atan2"),r=dM(t,"b","atan2");[n,r]=XF(n,r);const i={a:n,b:r};return rM.runKernel(V$,i)}});_F().prototype.atan2=function(e){return this.throwIfDisposed(),qj(this,e)};const Kj=fM({atanh_:function(e){const t={x:dM(e,"x","atanh")};return rM.runKernel(W$,t)}});_F().prototype.atanh=function(){return this.throwIfDisposed(),Kj(this)},_F().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),DP(this,e,t,n,r)},_F().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Fj(this,e,t)},_F().prototype.batchNorm=function(e,t,n,r,i){return this.throwIfDisposed(),MP(this,e,t,n,r,i)},_F().prototype.broadcastTo=function(e){return this.throwIfDisposed(),BP(this,e)},_F().prototype.cast=function(e){return this.throwIfDisposed(),uL(this,e)};const Xj=fM({ceil_:function(e){const t={x:dM(e,"x","ceil","float32")};return rM.runKernel(e_,t)}});_F().prototype.ceil=function(){return this.throwIfDisposed(),Xj(this)},_F().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),UP(this,e,t)},_F().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof $F&&(e=[e]),WP([this,...e],t)},_F().prototype.conv1d=function(e,t,n,r,i,s){return this.throwIfDisposed(),KP(this,e,t,n,r,i,s)},_F().prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),YP(this,e,t,n,r,i)},_F().prototype.conv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),qP(this,e,t,n,r,i,s)},_F().prototype.cos=function(){return this.throwIfDisposed(),Nj(this)},_F().prototype.cosh=function(){return this.throwIfDisposed(),Rj(this)},_F().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),cj(this,e,t,n)},_F().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),gV(this,e,t,n)};const Yj=fM({depthToSpace_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const r=dM(e,"x","depthToSpace","float32"),i="NHWC"===n?r.shape[1]:r.shape[2],s="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];GR(t>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`)),GR(i*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${t}  for depthToSpace with input shape\n    ${r.shape}`)),GR(s*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${s} and ${t} for depthToSpace with input shape\n        ${r.shape}`)),GR(o%(t*t)===0,(()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${r.shape}`));const a={x:r},l={blockSize:t,dataFormat:n};return rM.runKernel(v_,a,l)}});_F().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Yj(this,e,t)},_F().prototype.depthwiseConv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),tz(this,e,t,n,r,i,s)};const Qj=fM({dilation2d_:function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const o=dM(e,"x","dilation2d"),a=dM(t,"filter","dilation2d");GR(3===o.rank||4===o.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`)),GR(3===a.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`)),GR("NHWC"===s,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`));let l=o,u=!1;3===o.rank&&(l=OP(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0),GR(l.shape[3]===a.shape[2],(()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`));const c={x:l,filter:a},h={strides:n,pad:r,dilations:i},d=rM.runKernel(k_,c,h);return u?OP(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});_F().prototype.dilation2d=function(e,t,n,r,i){return this.throwIfDisposed(),Qj(this,e,t,n,r,i)};const Jj=fM({divNoNan_:function(e,t){let n=dM(e,"a","div"),r=dM(t,"b","div");[n,r]=XF(n,r);const i=pL(n,r),s=vL(i),o=rz(r,s);return gB(o,s,i)}});_F().prototype.divNoNan=function(e){return this.throwIfDisposed(),Jj(this,e)},_F().prototype.div=function(e){return this.throwIfDisposed(),pL(this,e)};const Zj=fM({dot_:function(e,t){const n=dM(e,"t1","dot"),r=dM(t,"t2","dot");GR((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`));const i=1===n.rank?n.size:n.shape[1],s=1===r.rank?r.size:r.shape[0];if(GR(i===s,(()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${s}.`)),1===n.rank&&1===r.rank){const e=OP(n,[1,-1]),t=OP(r,[-1,1]),i=Az(e,t);return OP(i,[])}if(1===n.rank&&2===r.rank){const e=OP(n,[1,-1]),t=OP(r,[r.shape[0],r.shape[1]]),i=Az(e,t);return OP(i,[i.size])}if(2===n.rank&&1===r.rank){const e=OP(r,[-1,1]),t=Az(n,e);return OP(t,[t.size])}{const e=OP(r,[r.shape[0],r.shape[1]]);return Az(n,e)}}});_F().prototype.dot=function(e){return this.throwIfDisposed(),Zj(this,e)},_F().prototype.elu=function(){return this.throwIfDisposed(),nz(this)},_F().prototype.equal=function(e){return this.throwIfDisposed(),rz(this,e)},_F().prototype.erf=function(){return this.throwIfDisposed(),iz(this)};const eG=fM({euclideanNorm_:function(e){return fU(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});_F().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),eG(this,e,t)},_F().prototype.exp=function(){return this.throwIfDisposed(),sz(this)},_F().prototype.expandDims=function(e){return this.throwIfDisposed(),oz(this,e)};const tG=fM({expm1_:function(e){const t={x:dM(e,"x","expm1")};return rM.runKernel(D_,t)}});_F().prototype.expm1=function(){return this.throwIfDisposed(),tG(this)},_F().prototype.fft=function(){return this.throwIfDisposed(),wB(this)},_F().prototype.flatten=function(){return this.throwIfDisposed(),OP(this,[this.size])},_F().prototype.floor=function(){return this.throwIfDisposed(),uz(this)},_F().prototype.floorDiv=function(e){return this.throwIfDisposed(),dL(this,e)},_F().prototype.gather=function(e,t,n){return this.throwIfDisposed(),cz(this,e,t,n)},_F().prototype.greaterEqual=function(e){return this.throwIfDisposed(),dz(this,e)},_F().prototype.greater=function(e){return this.throwIfDisposed(),hz(this,e)},_F().prototype.ifft=function(){return this.throwIfDisposed(),SB(this)},_F().prototype.irfft=function(){return this.throwIfDisposed(),IB(this)};const nG=fM({isFinite_:function(e){const t={x:dM(e,"x","isFinite")};return rM.runKernel(K_,t)}});_F().prototype.isFinite=function(){return this.throwIfDisposed(),nG(this)};const rG=fM({isInf_:function(e){const t={x:dM(e,"x","isInf")};return rM.runKernel(X_,t)}});_F().prototype.isInf=function(){return this.throwIfDisposed(),rG(this)};const iG=fM({isNaN_:function(e){const t={x:dM(e,"x","isNaN")};return rM.runKernel(Y_,t)}});_F().prototype.isNaN=function(){return this.throwIfDisposed(),iG(this)},_F().prototype.leakyRelu=function(e){return this.throwIfDisposed(),pz(this,e)},_F().prototype.lessEqual=function(e){return this.throwIfDisposed(),aU(this,e)},_F().prototype.less=function(e){return this.throwIfDisposed(),hU(this,e)};const sG=fM({localResponseNormalization_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const s=dM(e,"x","localResponseNormalization");GR(4===s.rank||3===s.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${s.rank}.`)),GR(YR(t),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`));let o=s,a=!1;3===s.rank&&(a=!0,o=OP(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const l={x:o},u={depthRadius:t,bias:n,alpha:r,beta:i},c=rM.runKernel(oO,l,u);return a?OP(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});_F().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),sG(this,e,t,n,r)};const oG=fM({logSigmoid_:function(e){const t=dM(e,"x","logSigmoid");return yL((e=>({value:Mz(aB(Mz(e))),gradFunc:t=>fL(t,eB(Mz(e)))})))(t)}});_F().prototype.logSigmoid=function(){return this.throwIfDisposed(),oG(this)},_F().prototype.logSoftmax=function(e){return this.throwIfDisposed(),yz(this,e)},_F().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),Tz(this,e,t)},_F().prototype.log=function(){return this.throwIfDisposed(),fz(this)},_F().prototype.log1p=function(){return this.throwIfDisposed(),mz(this)},_F().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Nz(this,e)},_F().prototype.logicalNot=function(){return this.throwIfDisposed(),Sj(this)};const aG=fM({logicalOr_:function(e,t){const n=dM(e,"a","logicalOr","bool"),r=dM(t,"b","logicalOr","bool");FL(n.shape,r.shape);const i={a:n,b:r};return rM.runKernel(sO,i)}});_F().prototype.logicalOr=function(e){return this.throwIfDisposed(),aG(this,e)};const lG=fM({logicalXor_:function(e,t){const n=dM(e,"a","logicalXor","bool"),r=dM(t,"b","logicalXor","bool");return FL(n.shape,r.shape),Nz(aG(e,t),Sj(Nz(e,t)))}});_F().prototype.logicalXor=function(e){return this.throwIfDisposed(),lG(this,e)},_F().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Az(this,e,t,n)},_F().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Rz(this,e,t,n,r)},_F().prototype.max=function(e,t){return this.throwIfDisposed(),gz(this,e,t)},_F().prototype.maximum=function(e){return this.throwIfDisposed(),ML(this,e)},_F().prototype.mean=function(e,t){return this.throwIfDisposed(),_z(this,e,t)},_F().prototype.min=function(e,t){return this.throwIfDisposed(),Oz(this,e,t)},_F().prototype.minimum=function(e){return this.throwIfDisposed(),Dz(this,e)};const uG=fM({mirrorPad_:function(e,t,n){GR("reflect"===n||"symmetric"===n,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`));const r=dM(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");GR(t.length===r.rank,(()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`));const i="reflect"===n?1:0;for(let a=0;a<r.rank;a++)GR(2===t[a].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),GR(t[a][0]>=0&&t[a][0]<=r.shape[a]-i&&t[a][1]>=0&&t[a][1]<=r.shape[a]-i,(()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-i} or less than 0 for input of shape ${r.shape}`));const s={paddings:t,mode:n},o={x:r};return rM.runKernel(yO,o,s)}});_F().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),uG(this,e,t)};const cG=fM({mod_:function(e,t){let n=dM(e,"a","mod"),r=dM(t,"b","mod");[n,r]=XF(n,r);const i={a:n,b:r};return rM.runKernel(bO,i)}});_F().prototype.mod=function(e){return this.throwIfDisposed(),cG(this,e)},_F().prototype.mul=function(e){return this.throwIfDisposed(),fL(this,e)},_F().prototype.neg=function(){return this.throwIfDisposed(),Mz(this)},_F().prototype.norm=function(e,t,n){return this.throwIfDisposed(),fU(this,e,t,n)},_F().prototype.notEqual=function(e){return this.throwIfDisposed(),Lz(this,e)},_F().prototype.oneHot=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),Pz(this,e,t,n)},_F().prototype.onesLike=function(){return this.throwIfDisposed(),Uz(this)},_F().prototype.pad=function(e,t){return this.throwIfDisposed(),Wz(this,e,t)};const hG=fM({pool_:function(e,t,n,r,i,s,o){null==i&&(i=[1,1]),null==s&&(s=1),0===r&&(r="valid");const a=dM(e,"x","maxPool");let l=a,u=!1;3===a.rank&&(u=!0,l=OP(a,[1,a.shape[0],a.shape[1],a.shape[2]])),GR(AP(s,i),(()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`));const c=bP(l.shape,t,s,i,r),h=[c.dilationHeight,c.dilationWidth];let d;d="same"===r?function(e,t){const n=e.map(((e,n)=>e+(e-1)*(t[n]-1))),r=n.map((e=>e-1)),i=r.map((e=>Math.floor(e/2))),s=r.map(((e,t)=>e-i[t]));return r.map(((e,t)=>[i[t],s[t]]))}([c.filterHeight,c.filterWidth],h):[[0,0],[0,0]];const p=1===h[0]&&1===h[1],[f,m]=function(e,t,n){const r=n.map((e=>e[0])),i=n.map((e=>e[1])),s=e.concat(r,i),o=t.map(((e,t)=>(e-s[t]%e)%e)),a=i.map(((e,t)=>e+o[t])),l=t.map(((e,t)=>[r[t],a[t]])),u=t.map(((e,t)=>[0,o[t]]));return[l,u]}([c.inHeight,c.inWidth],h,d),g=p?r:"valid",v=p?l:eV(l,h,f),y=("avg"===n?()=>DP(v,t,s,g,o):()=>Rz(v,t,s,g,o))(),b=p?y:Fj(y,h,m);return u?OP(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});_F().prototype.pool=function(e,t,n,r,i,s){return this.throwIfDisposed(),hG(this,e,t,n,r,i,s)},_F().prototype.pow=function(e){return this.throwIfDisposed(),AL(this,e)},_F().prototype.prelu=function(e){return this.throwIfDisposed(),Vz(this,e)};const dG=fM({prod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=dM(e,"x","prod");"bool"===r.dtype&&(r=uL(r,"int32"));const i={x:r},s={axis:t,keepDims:n};return rM.runKernel(OO,i,s)}});_F().prototype.prod=function(e,t){return this.throwIfDisposed(),dG(this,e,t)};const pG=fM({reciprocal_:function(e){const t={x:dM(e,"x","reciprocal")};return rM.runKernel(zO,t)}});_F().prototype.reciprocal=function(){return this.throwIfDisposed(),pG(this)},_F().prototype.relu=function(){return this.throwIfDisposed(),Yz(this)},_F().prototype.relu6=function(){return this.throwIfDisposed(),EB(this)},_F().prototype.reshapeAs=function(e){return this.throwIfDisposed(),OP(this,e.shape)},_F().prototype.reshape=function(e){return this.throwIfDisposed(),OP(this,e)},_F().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),iU(this,e,t,n)},_F().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),sU(this,e,t,n)},_F().prototype.reverse=function(e){return this.throwIfDisposed(),Qz(this,e)},_F().prototype.rfft=function(){return this.throwIfDisposed(),kB(this)},_F().prototype.round=function(){return this.throwIfDisposed(),lU(this)},_F().prototype.rsqrt=function(){return this.throwIfDisposed(),TV(this)},_F().prototype.selu=function(){return this.throwIfDisposed(),Jz(this)},_F().prototype.separableConv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),Zz(this,e,t,n,r,i,s)},_F().prototype.sigmoid=function(){return this.throwIfDisposed(),eB(this)};const fG=fM({sign_:function(e){const t={x:dM(e,"x","sign")};return rM.runKernel(iD,t)}});_F().prototype.sign=function(){return this.throwIfDisposed(),fG(this)},_F().prototype.sin=function(){return this.throwIfDisposed(),dV(this)},_F().prototype.sinh=function(){return this.throwIfDisposed(),fV(this)},_F().prototype.slice=function(e,t){return this.throwIfDisposed(),tB(this,e,t)},_F().prototype.softmax=function(e){return this.throwIfDisposed(),oB(this,e)},_F().prototype.softplus=function(){return this.throwIfDisposed(),aB(this)},_F().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),eV(this,e,t)},_F().prototype.split=function(e,t){return this.throwIfDisposed(),lB(this,e,t)},_F().prototype.sqrt=function(){return this.throwIfDisposed(),mL(this)},_F().prototype.square=function(){return this.throwIfDisposed(),gL(this)},_F().prototype.squaredDifference=function(e){return this.throwIfDisposed(),xU(this,e)},_F().prototype.squeeze=function(e){return this.throwIfDisposed(),uB(this,e)},_F().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof $F?[this,e]:[this,...e];return cB(n,t)},_F().prototype.step=function(e){return this.throwIfDisposed(),TB(this,e)};const mG=fM({stridedSlice_:function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const u={x:dM(e,"x","stridedSlice","string_or_numeric")},c={begin:t,end:n,strides:r,beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return rM.runKernel(xD,u,c)}});_F().prototype.stridedSlice=function(e,t,n,r,i,s,o,a){return this.throwIfDisposed(),mG(this,e,t,n,r,i,s,o,a)},_F().prototype.sub=function(e){return this.throwIfDisposed(),RL(this,e)},_F().prototype.sum=function(e,t){return this.throwIfDisposed(),vz(this,e,t)};const gG=fM({tan_:function(e){const t={x:dM(e,"x","tan","float32")};return rM.runKernel(CD,t)}});_F().prototype.tan=function(){return this.throwIfDisposed(),gG(this)},_F().prototype.tanh=function(){return this.throwIfDisposed(),hB(this)},_F().prototype.tile=function(e){return this.throwIfDisposed(),az(this,e)},_F().prototype.toBool=function(){return this.throwIfDisposed(),uL(this,"bool")},_F().prototype.toFloat=function(){return this.throwIfDisposed(),uL(this,"float32")},_F().prototype.toInt=function(){return this.throwIfDisposed(),uL(this,"int32")};const vG=fM({topk_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=dM(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const s={x:r},o={k:t,sorted:n},[a,l]=rM.runKernel(ND,s,o);return{values:a,indices:l}}});_F().prototype.topk=function(e,t){return this.throwIfDisposed(),vG(this,e,t)},_F().prototype.transpose=function(e){return this.throwIfDisposed(),bB(this,e)};const yG=fM({unique_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=dM(e,"x","unique","string_or_numeric");GR(n.rank>0,(()=>"The input tensor must be at least 1D"));const r={x:n},i={axis:t},[s,o]=rM.runKernel($D,r,i);return{values:s,indices:o}}});_F().prototype.unique=function(e){return this.throwIfDisposed(),yG(this,e)},_F().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),AV(this,e,t)},_F().prototype.unstack=function(e){return this.throwIfDisposed(),mB(this,e)},_F().prototype.where=function(e,t){return this.throwIfDisposed(),gB(e,this,t)},_F().prototype.zerosLike=function(){return this.throwIfDisposed(),vL(this)};class bG extends Error{constructor(e){super(e),Object.setPrototypeOf(this,bG.prototype)}}class xG extends Error{constructor(e){super(e),Object.setPrototypeOf(this,xG.prototype)}}class wG extends Error{constructor(e){super(e),Object.setPrototypeOf(this,wG.prototype)}}class kG extends Error{constructor(e){super(e),Object.setPrototypeOf(this,kG.prototype)}}class SG extends Error{constructor(e){super(e),Object.setPrototypeOf(this,SG.prototype)}}Error;class IG{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}}function CG(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}{const n=new Array(t);return n.fill(e),n}}function EG(e,t){if(!e)throw new SG(t)}function TG(e,t){let n=0;for(const r of e)r===t&&n++;return n}function NG(e){return 1===e.length?e[0]:e}function AG(e){return Array.isArray(e)?e:[e]}function RG(e){const t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function $G(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,((e,t)=>t.toUpperCase()))}let _G={};function OG(e){if(null===e||void 0===e)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function DG(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((e=>DG(e)));else{const t=Object.keys(e);for(const n of t){const t=e[n];null!=t&&"object"===typeof t&&(Array.isArray(t)||"ndarray"!==t.type||"number"!==typeof t.value?DG(t):e[n]=t.value)}}}function FG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){const i=e;let s;if(i in n)s=n[i];else if(i in _G)s=_G[i];else if(s=t[i],null==s)throw new wG(`Unknown ${r}: ${e}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return s}{const s=e;if(null==s.className||null==s.config)throw new wG(`${r}: Improper config format: ${JSON.stringify(s)}.\n'className' and 'config' must set.`);const o=s.className;let a,l;if(o in n?[a,l]=n[o]:o in _G?[a,l]=_G.className:o in t&&([a,l]=t[o]),null==a)throw new wG(`Unknown ${r}: ${o}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=l){const e={};for(const n of Object.keys(_G))e[n]=_G[n];for(const i of Object.keys(n))e[i]=n[i];s.config.customObjects=e;const t=Object.assign({},_G);for(const i of Object.keys(n))_G[i]=n[i];DG(s.config);const r=l(a,s.config,n,i);return _G=Object.assign({},t),r}{const e=Object.assign({},_G);for(const r of Object.keys(n))_G[r]=n[r];const t=new a(s.config);return _G=Object.assign({},e),t}}}function MG(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function LG(e){if(null==e)return e;const t=[];for(const n of e)-1===t.indexOf(n)&&t.push(n);return t}function PG(e){if(null==e)throw new wG(`Invalid value in obj: ${JSON.stringify(e)}`);for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function zG(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new wG(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function BG(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return EG(n>=0),EG(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((e=>typeof e===t))}function UG(e,t){Array.isArray(e)?(GR(e.length>0,(()=>`${t} is unexpectedly an empty array.`)),e.forEach(((e,n)=>UG(e,`element ${n+1} of ${t}`)))):GR(Number.isInteger(e)&&e>0,(()=>`Expected ${t} to be a positive integer, but got ${WG(e)}.`))}function WG(e){return null===e?"null":Array.isArray(e)?"["+e.map((e=>WG(e))).join(",")+"]":"string"===typeof e?`"${e}"`:`${e}`}function VG(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}let jG=0;function GG(){return jG++}const HG={};function qG(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in HG||(HG[e]=0),HG[e]+=1,e+HG[e].toString()}const KG=["channelsFirst","channelsLast"],XG=["nearest","bilinear"],YG=["valid","same","causal"],QG=["max","avg"],JG=["sum","mul","concat","ave"],ZG=new Map;function eH(e){zG(KG,"DataFormat",e)}function tH(e){zG(YG,"PaddingMode",e)}function nH(e){zG(QG,"PoolMode",e)}const rH=[];function iH(e,t){rH.push(e);try{const e=t();return rH.pop(),e}catch(dae){throw rH.pop(),dae}}function sH(e){if(!lH(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===rH.length?"":rH.join("/")+"/")+e}function oH(e){if(!lH(e))throw new Error("Not a valid tensor name: '"+e+"'");ZG.has(e)||ZG.set(e,0);const t=ZG.get(e);if(ZG.set(e,ZG.get(e)+1),t>0){const n=`${e}_${t}`;return ZG.set(n,1),n}return e}const aH=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function lH(e){return!!e.match(aH)}function uH(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let r=1;for(let i=t;i<n;++i)r*=e[i];return r}function cH(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function hH(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function dH(e,t){if(t<e)throw new wG(`end (${t}) < begin (${e}) is forbidden.`);const n=[];for(let r=e;r<t;++r)n.push(r);return n}let pH;function fH(){return null==pH&&(pH=CM().epsilon()),pH}function mH(e,t){return uL(e,t)}function gH(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),OP(e,n)}function vH(e,t,n){return wM((()=>{switch(e.rank){case 1:return nB(e,t,n);case 2:return rB(e,[t,0],[n,e.shape[1]]);case 3:return iB(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return sB(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return tB(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return tB(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new wG(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function yH(e,t,n){return wM((()=>{switch(e.rank){case 1:return nB(e,t,n);case 2:return rB(e,[0,t],[e.shape[0],n]);case 3:return iB(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return sB(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new wG(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function bH(e,t,n,r){return wM((()=>{switch(e.rank){case 1:return nB(e,t,n);case 2:switch(r){case 1:return vH(e,t,n);case 2:return yH(e,t,n);default:throw new wG(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return vH(e,t,n);case 2:return iB(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return yH(e,t,n);default:throw new wG(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return vH(e,t,n);case 2:return sB(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return sB(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return yH(e,t,n);default:throw new wG(`The axis is not within the rank of the tensor ${r}`)}default:throw new wG(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function xH(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(t=e[0].rank,n=0!==t?t:0),n===e[0].rank&&(n=-1),WP(e,n)}function wH(e,t){switch(e.rank){case 1:return VP([e,t]);case 2:return jP([e,t],0);case 3:return GP([e,t],0);case 4:return HP([e,t],0);default:throw new wG(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function kH(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new wG(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return az(e,t)}function SH(e){return qz(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function IH(e,t,n,r){if(e.rank<2||t.rank<2)throw new kG(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){if(e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new kG(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(2===e.rank&&2===t.rank){return FB({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?TH(e.rank,r,"channelsLast"):null,activation:n})}{const i=e.shape.slice(),s=i.pop();e=OP(e,[-1,s]);const o=t.shape.slice(),a=o.pop(),l=o.pop(),u=[...o,a],c=Array.from({length:t.rank},((e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n));t=OP(bB(t,c),[l,-1]);const h=[...i,...u];return OP(FB({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?TH(e.rank,r,"channelsLast"):null,activation:n}),h)}}function CH(e,t,n){return wM((()=>(t=Array.isArray(t)?dB(t,"int32"):uL(t,"int32"),cz(e,t,n))))}function EH(e){return fL(e,e)}function TH(e,t,n){const r=t.shape;if(1!==t.rank&&t.rank!==e)throw new wG(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(5===e){if("channelsFirst"===n)return 1===r.length?OP(t,[1,r[0],1,1,1]):OP(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?OP(t,[1,1,1,1,r[0]]):OP(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?OP(t,[1,r[0],1,1]):OP(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?OP(t,[1,1,1,r[0]]):OP(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?OP(t,[1,r[0],1]):OP(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?OP(t,[1,1,r[0]]):OP(t,[1].concat(r))}else if(e<3)return t;throw new wG(`Unsupported input rank by biasAdd: ${t.rank}`)}function NH(e,t,n){return wM((()=>(null==n&&(n="channelsLast"),eH(n),hL(e,TH(e.rank,t,n)))))}function AH(e,t,n,r){return wM((()=>xB(e,t,n,r)))}function RH(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}const $H=["fanIn","fanOut","fanAvg"],_H=["normal","uniform","truncatedNormal"];class OH extends kL{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class DH extends OH{apply(e,t){return zz(e,t)}}DH.className="Zeros",IL(DH);class FH extends OH{apply(e,t){return Bz(e,t)}}FH.className="Ones",IL(FH);class MH extends OH{constructor(e){if(super(),"object"!==typeof e)throw new wG(`Expected argument of type ConstantConfig but got ${e}`);if(void 0===e.value)throw new wG(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return wM((()=>fL(bL(this.value),Bz(e,t))))}getConfig(){return{value:this.value}}}MH.className="Constant",IL(MH);class LH extends OH{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Kz(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}LH.className="RandomUniform",IL(LH);class PH extends OH{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new kG(`randomNormal does not support dType ${t}.`);return SH(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}PH.className="RandomNormal",IL(PH);class zH extends OH{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new kG(`truncatedNormal does not support dType ${t}.`);return fB(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}zH.className="TruncatedNormal",IL(zH);class BH extends OH{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return wM((()=>{if(2!==e.length||e[0]!==e[1])throw new wG("Identity matrix initializer can only be used for 2D square matrices.");return fL(this.gain,lz(e[0]))}))}getConfig(){return{gain:this.gain}}}BH.className="Identity",IL(BH);class UH extends OH{constructor(e){if(super(),e.scale<0)throw new wG(`scale must be a positive float. Got: ${e.scale}`);var t;this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,t=this.mode,zG($H,"FanMode",t),this.distribution=null==e.distribution?"normal":e.distribution,function(e){zG(_H,"Distribution",e)}(this.distribution),this.seed=e.seed}apply(e,t){const n=function(e){let t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(eH(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){const r=uH(e,2);t=e[1]*r,n=e[0]*r}else if("channelsLast"===r){const r=uH(e,0,e.length-2);t=e[e.length-2]*r,n=e[e.length-1]*r}}else{const r=uH(e);t=Math.sqrt(r),n=Math.sqrt(r)}return[t,n]}(e),r=n[0],i=n[1];let s=this.scale;if("fanIn"===this.mode?s/=Math.max(1,r):"fanOut"===this.mode?s/=Math.max(1,i):s/=Math.max(1,(r+i)/2),"normal"===this.distribution){const n=Math.sqrt(s);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new kG(`${this.getClassName()} does not support dType ${t}.`);return fB(e,0,n,t,this.seed)}{const n=Math.sqrt(3*s);return Kz(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}UH.className="VarianceScaling",IL(UH);class WH extends UH{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return UH.className}}WH.className="GlorotUniform",IL(WH);class VH extends UH{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return UH.className}}VH.className="GlorotNormal",IL(VH);class jH extends UH{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return UH.className}}jH.className="HeNormal",IL(jH);class GH extends UH{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return UH.className}}GH.className="HeUniform",IL(GH);class HH extends UH{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return UH.className}}HH.className="LeCunNormal",IL(HH);class qH extends UH{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return UH.className}}qH.className="LeCunUniform",IL(qH);class KH extends OH{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return wM((()=>{if(e.length<2)throw new kG("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError(`Unsupported data type ${t}.`);const n=KR(e.slice(0,-1)),r=e[e.length-1],i=n*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const s=SH([Math.max(r,n),Math.min(r,n)],0,1,t,this.seed),o=kU.qr(s,!1);let a=o[0];const l=o[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return a=fL(a,l.sign()),n<r&&(a=a.transpose()),fL(bL(this.gain),a.reshape(e))}))}getConfig(){return{gain:this.gain,seed:this.seed}}}KH.className="Orthogonal",IL(KH);const XH={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function YH(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return FG(e,SL.getMap().classNameMap,t,"initializer")}function QH(e){return OG(e)}function JH(e){if("string"===typeof e){const t=e in XH?XH[e]:e;if("GlorotNormal"===t)return new VH;if("GlorotUniform"===t)return new WH;if("HeNormal"===t)return new jH;if("HeUniform"===t)return new GH;if("LeCunNormal"===t)return new HH;if("LeCunUniform"===t)return new qH;{const e={};return e.className=t,e.config={},YH(e)}}return e instanceof OH?e:YH(e)}function ZH(e){return Array.isArray(e)&&Array.isArray(e[0])}function eq(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function tq(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new wG(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function nq(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new wG(`Expected exactly 1 Shape; got ${e.length}`)}return e}function rq(e){let t=0;for(const n of e)0===n.shape.length?t+=1:t+=n.shape.reduce(((e,t)=>e*t));return t}const iq="Variable";class sq{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:iq,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=GG(),n=null==n?iq:n,this.originalName=sH(n),this.name=oH(this.originalName),this.trainable_=r,this.constraint=i,this.val=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return rM.makeVariable(e,t,n,r)}(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function oq(e){return e.map((e=>e.read()))}function aq(e){e.forEach((e=>{e[0].write(e[1])}))}class lq{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class uq{constructor(e,t,n,r,i,s,o){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=GG(),null!=s&&(this.originalName=sH(s),this.name=oH(this.originalName)),this.rank=t.length}}let cq=0;class hq{constructor(e,t){this.callArgs=t,this.id=cq++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const n of e.inboundLayers)null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let dq=0;class pq extends kL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=dq++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const e=this.getClassName();t=RG(e)+"_"+qG(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new xG(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new wG(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return NG(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return NG(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new bG(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(0===this.inboundNodes.length)throw new bG(`Layer ${this.name} is not connected, no input to return.`);return NG(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new bG(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new bG(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return NG(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((e=>e()))}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach((t=>t.trainable=e)),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((e=>e.trainable)):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((e=>!e.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=AG(e);if(null==this.inputSpec||0===this.inputSpec.length)return;const n=AG(this.inputSpec);if(t.length!==n.length)throw new wG(`Layer ${this.name} expects ${n.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let r=0;r<t.length;r++){const e=t[r],i=n[r];if(null==i)continue;const s=e.rank;if(null!=i.ndim&&s!==i.ndim)throw new wG(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${s}`);if(null!=i.maxNDim&&s>i.maxNDim)throw new wG(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${s}`);if(null!=i.minNDim&&s<i.minNDim)throw new wG(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${s}.`);if(null!=i.dtype&&e.dtype!==i.dtype)throw new wG(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${e.dtype}.`);if(i.axes){const t=e.shape;for(const e in i.axes){const n=Number(e),s=i.axes[e],o=n>=0?t[n]:t[t.length+n];if(null!=s&&-1===[s,null].indexOf(o))throw new wG(`Input ${r} is incompatible with layer ${this.name}: expected axis ${n} of input shape to have value ${s} but got shape ${t}.`)}}if(null!=i.shape)for(let t=0;t<i.shape.length;++t){const n=i.shape[t],s=e.shape[t];if(null!=n&&null!=s&&n!==s)throw new wG(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${e.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const n=AG(e),r=function(e){let t=!0;for(const n of AG(e))if(!(n instanceof uq)){t=!1;break}return t}(e),i=function(e){let t=!0;for(const n of AG(e))if(n instanceof uq){t=!1;break}return t}(e);if(r===i)throw new wG("Arguments to apply() must be all SymbolicTensors or all Tensors");return iH(this.name,(()=>{if(!this.built){this.assertInputCompatibility(e);const t=[];for(const n of AG(e))t.push(n.shape);this.build(NG(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let r=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,r);const i=AG(r),s=[];for(let e of i)-1!==n.indexOf(e)&&(e=e.clone()),s.push(e);if(r=NG(s),null!=this.activityRegularizer)throw new kG("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(e){e=AG(e);const t=[];for(const n of e)t.push(n.shape);return NG(t)}(e),r=this.computeOutputShape(n);let i;const s="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?n[0]:n),i=null!=r&&r.length>0&&Array.isArray(r[0])?r.map(((n,r)=>new uq(s,n,this,AG(e),t,this.name,r))):new uq(s,r,this,AG(e),t,this.name),this.addInboundNode(e,i,null,null,n,r,t),this._refCount++,null!=this.activityRegularizer)throw new kG("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}}))}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach(((n,r)=>{null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new bG(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new bG(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new xG(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return rq(this.weights)}build(e){this.built=!0}getWeights(){return oq(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(e){wM((()=>{const t=this.weights;if(t.length!==e.length)throw new wG(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(0===t.length)return;const n=[],r=oq(t);for(let i=0;i<r.length;++i){const s=r[i],o=t[i],a=e[i];if(!XR(s.shape,a.shape))throw new wG(`Layer weight shape ${s.shape} not compatible with provided weight shape ${a.shape}`);n.push([o,a])}aq(n)}))}addWeight(e,t,n,r,i,s,o,a){if(-1!==this._addedWeightNames.indexOf(e))throw new wG(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=a?a():JH("zeros"));const l=r.apply(t,n),u=new sq(l,n,e,s,o);return l.dispose(),null!=i&&this.addLoss((()=>i.apply(u.read()))),null==s&&(s=!0),s?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=AG(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);t.forEach((e=>{if(null!=e)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)}))}return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;const r=this.computeMask(e,n),i=AG(t),s=AG(r);if(i.length!==s.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let o=0;o<i.length;o++)i[o].kerasMask=s[o]}addInboundNode(e,t,n,r,i,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const a=AG(e);t=AG(t),n=AG(n),r=AG(r),i=eq(i),s=eq(s);const l=[],u=[],c=[];for(const h of a)l.push(h.sourceLayer),u.push(h.nodeIndex),c.push(h.tensorIndex);new hq({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:c,inputTensors:a,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:s},o);for(let h=0;h<t.length;h++)t[h].sourceLayer=this,t[h].nodeIndex=this.inboundNodes.length-1,t[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach((e=>e.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function fq(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];{const e=t.inboundNodes[n];if(0===e.inboundLayers.length)return e.inputTensors;{const t=[];for(let n=0;n<e.inboundLayers.length;n++){const r=fq(e.inputTensors[n],e.inboundLayers[n],e.nodeIndices[n]);for(const e of r)-1===t.indexOf(e)&&t.push(e)}return t}}}class mq extends pq{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:qG("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new wG("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new wG("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new wG("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];const r=new uq(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new hq({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new wG(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}mq.className="InputLayer",IL(mq);class gq{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof gq)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(null==e)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,n){if(null!=this.id2Value[e.id])throw new wG(`Duplicate key: name=${e.name}, id=${e.id}`);return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return uL(t,e.dtype)}catch(pae){throw new wG(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof uq){if(null==this.id2Value[e.id])throw new wG(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}{const t=this.name2Id[e];if(null==t)throw new wG(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof uq){if(null==this.id2Value[e.id])throw new wG(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}{const t=this.name2Id[e];if(null==t)throw new wG(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&kM(this.id2Mask)}}const vq=new IG,yq=new IG;function bq(e,t,n,r){const i=null!=n&&n.training,s=Array.isArray(e),o=s?e:[e],a=o.map((e=>e.name)),l=[],u=t.names();for(const f of a)-1!==u.indexOf(f)?l.push(t.getValue(f)):l.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const c=a.join(",")+"|"+t.names().sort().join(",");let h,d=vq.get(c);if(null==d){const e=function(e,t){GR(null!=e&&e.length>0,(()=>"Expected at least one fetch, got none"));let n=[],r={};if(1===e.length){const i=wq(e[0],t);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const s of e){const{sorted:e,recipientMap:o}=wq(s,t);for(const t of e)i.has(t.name)||(n.push(t),i.add(t.name));for(const t in o)null==r[t]&&(r[t]=new Set),o[t].forEach((e=>r[t].add(e)))}}return{sorted:n,recipientCounts:xq(r)}}(o,t);d=e.sorted,h=e.recipientCounts,vq.put(c,d),yq.put(c,h)}h={},i||Object.assign(h,yq.get(c));const p=new gq(t);for(let f=0;f<d.length;++f){if(null!=r){const e=xM().numTensors;e>r.maxNumTensors&&(r.maxNumTensors=e),e<r.minNumTensors&&(r.minNumTensors=e)}const e=d[f],s=e.sourceLayer;if(s instanceof mq)continue;const o=[],u=[],c=[];let m=!1;for(const n of e.inputs){const e=p.getValue(n),r=p.getMask(n);o.push(e),u.push(r),null!=r&&(m=!0),i||(h[n.name]--,0!==h[n.name]||t.hasKey(n)||-1!==a.indexOf(n.name)||e.isDisposed||!0===n.sourceLayer.stateful||c.push(e))}m&&((n=n||{}).mask=u[0]);const g=AG(s.apply(o,n));let v=null;s.supportsMasking&&(v=s.computeMask(o,u));const y=kq(e),b=Array.isArray(y)?y:[y];for(let t=0;t<b.length;++t){p.hasKey(b[t])||p.add(b[t],g[t],Array.isArray(v)?v[0]:v);const e=a.indexOf(b[t].name);-1!==e&&(l[e]=g[t])}i||kM(c)}return p.disposeMasks(),s?l:l[0]}function xq(e){const t={};for(const n in e)t[n]=e[n].size;return t}function wq(e,t){const n=new Set,r=[],i={};for(const a of t.names())n.add(a);const s=[],o=[];for(s.push(e);s.length>0;){const e=s[s.length-1];if(n.has(e.name)){s.pop();continue}const t=o[o.length-1]===s.length-1;if(0===e.inputs.length||t)s.pop(),r.push(e),n.add(e.name),t&&o.pop();else{o.push(s.length-1);for(const t of e.inputs)null==i[t.name]&&(i[t.name]=new Set),i[t.name].add(e.name),n.has(t.name)||s.push(t)}}return{sorted:r,recipientMap:i}}function kq(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(const r of e.sourceLayer.inboundNodes[t].outputTensors)if(r.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}function Sq(e,t){return wM((()=>mL(vz(fL(e,e),t,!0))))}C$().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(()=>100),(function(e){null!=vq&&vq.setMaxEntries(e),null!=yq&&yq.setMaxEntries(e)}));class Iq extends kL{getConfig(){return{}}}class Cq extends Iq{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return wM((()=>{const t=Sq(e,this.axis),n=UP(t,0,this.maxValue);return fL(e,pL(n,hL(fH(),t)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}Cq.className="MaxNorm",IL(Cq);class Eq extends Iq{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return wM((()=>pL(e,hL(fH(),Sq(e,this.axis)))))}getConfig(){return{axis:this.axis}}}Eq.className="UnitNorm",IL(Eq);class Tq extends Iq{apply(e){return Yz(e)}}Tq.className="NonNeg",IL(Tq);class Nq extends Iq{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return wM((()=>{const t=Sq(e,this.axis),n=hL(fL(this.rate,UP(t,this.minValue,this.maxValue)),fL(1-this.rate,t));return fL(e,pL(n,hL(fH(),t)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Nq.className="MinMaxNorm",IL(Nq);const Aq={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Rq(e){return OG(e)}function $q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return FG(e,SL.getMap().classNameMap,t,"constraint")}function _q(e){if(null==e)return null;if("string"===typeof e){return $q({className:e in Aq?Aq[e]:e,config:{}})}return e instanceof Iq?e:$q(e)}async function Oq(e){if(null==e)return;const t=[],n=[],r=[];for(const i in e){const s=e[i];if("number"!==typeof s){const e=s;t.push(e.data()),n.push(i),r.push(e)}}if(t.length>0){const i=await Promise.all(t);for(let t=0;t<i.length;++t)e[n[t]]=i[t][0];kM(r)}}function Dq(e){if(null!=e)for(const t in e){const n=e[t];"number"!==typeof n&&n.dispose()}}var Fq,Mq;(Mq=Fq||(Fq={}))[Mq.SILENT=0]="SILENT",Mq[Mq.VERBOSE=1]="VERBOSE";class Lq{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Pq{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class zq extends Lq{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});const n=null==t.size?0:t.size;this.seen+=n;for(const r in t){const e=t[r];if("number"===typeof e)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+e*n;else{let t;r in this.totals?t=this.totals[r]:this.totals[r]=0;const i=wM((()=>hL(this.totals[r],fL(e,n))));this.totals[r]=i,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(const n of this.params.metrics)null!=this.totals[n]&&("number"===typeof this.totals[n]?t[n]=this.totals[n]/this.seen:wM((()=>{const e=fL(pL(1,this.seen),this.totals[n]);t[n]=e,this.totals[n].dispose(),SM(t[n])})))}}class Bq extends Lq{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){null==t&&(t={}),this.epoch.push(e);for(const n in t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){const e=[],t=[],n=[];for(const i in this.history){const r=this.history[i];for(let s=0;s<r.length;++s)if("number"!==typeof r[s]){const o=r[s];e.push(o.data()),t.push(i),n.push(s)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i){this.history[t[i]][n[i]].dispose(),this.history[t[i]][n[i]]=r[i][0]}}}class Uq extends Lq{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||CU,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");l$(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let r,i=null!=n?n():fF();return function(){const s=null!=n?n():fF();return s-i<t||(i=s,r=e(...arguments)),r}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){const r=[];null!=this.yield&&(await Oq(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await Oq(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const n=[];null!=this.epochEnd&&(await Oq(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await Oq(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const n=[];null!=this.batchEnd&&(await Oq(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):l$(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await Oq(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await Oq(e),await this.trainEnd(e))}}function Wq(e,t){if(null==e&&(e={}),e instanceof Lq)return[e];if(Array.isArray(e)&&e[0]instanceof Lq)return e;return AG(e).map((e=>new Uq(e,t)))}class Vq{constructor(){}static registerCallbackConstructor(e,t){GR(e>=0&&Number.isInteger(e),(()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`)),Vq.checkForDuplicate(t),null==Vq.constructors[e]&&(Vq.constructors[e]=[]),Vq.constructors[e].push(t)}static checkForDuplicate(e){for(const t in Vq.constructors){Vq.constructors[+t].forEach((t=>{if(t===e)throw new wG("Duplicate callback constructor.")}))}}static clear(){Vq.constructors={}}static createCallbacks(e){const t=[];for(const n in Vq.constructors){const r=+n;e>=r&&t.push(...Vq.constructors[r])}return t.map((e=>new e))}}function jq(e,t,n,r,i,s,o,a,l){const u=new Bq,c=[new zq,...Vq.createCallbacks(t)];null!=e&&c.push(...e),c.push(u);const h=new Pq(c);return h.setParams({epochs:n,initialEpoch:r,samples:i,steps:s,batchSize:o,verbose:t,doValidation:a,metrics:l}),{callbackList:h,history:u}}function Gq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return FG(e,SL.getMap().classNameMap,t,"layer",n)}function Hq(e,t){return wM((()=>{"float32"!==e.dtype&&(e=uL(e,"float32"));const n=vz(EH(e),t,!0),r=TL(n.shape,fH()),i=mL(ML(n,r));return pL(e,i)}))}function qq(e,t){return wM((()=>_z(EH(RL(t,e)),-1)))}function Kq(e,t){return wM((()=>_z(_L(RL(t,e)),-1)))}function Xq(e,t){return wM((()=>{const n=RL(e,t),r=UP(_L(e),fH(),Number.MAX_VALUE),i=_L(pL(n,r));return fL(100,_z(i,-1))}))}function Yq(e,t){return wM((()=>{const n=UP(t,fH(),Number.MAX_VALUE),r=fz(hL(1,n)),i=UP(e,fH(),Number.MAX_VALUE),s=fz(hL(1,i));return _z(EH(RL(r,s)),-1)}))}function Qq(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return wM((()=>{if(n)t=oB(t);else{const e=vz(t,t.shape.length-1,!0);t=pL(t,e)}return t=UP(t,fH(),1-fH()),Mz(vz(fL(uL(e,"float32"),fz(t)),t.shape.length-1))}))}function Jq(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return wM((()=>{const r=uL(uz(function(e){const t=[uH(e.shape)];return OP(e,t)}(e)),"int32"),i=(t=UP(t,fH(),1-fH())).shape;return Qq(OP(Pz(r,i[i.length-1]),i),t,n)}))}function Zq(e,t){return wM((()=>{let n;return n=UP(t,fH(),1-fH()),n=fz(pL(n,RL(1,n))),_z(function(e,t){if(!XR(e.shape,t.shape))throw new wG(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return wM((()=>{const n=Yz(t),r=Mz(_L(t));return hL(RL(n,fL(t,e)),mz(sz(r)))}))}(e,n),-1)}))}function eK(e,t){return wM((()=>{const n=UP(e,fH(),1),r=UP(t,fH(),1);return vz(fL(e,fz(pL(n,r))),-1)}))}function tK(e,t){return wM((()=>{const n=Hq(e,-1),r=Hq(t,-1),i=fL(n,r);return Mz(vz(i,-1))}))}Vq.constructors={};const nK={meanSquaredError:qq,meanAbsoluteError:Kq,meanAbsolutePercentageError:Xq,meanSquaredLogarithmicError:Yq,squaredHinge:function(e,t){return wM((()=>{const n=ML(0,RL(1,fL(e,t)));return _z(EH(n),-1)}))},hinge:function(e,t){return wM((()=>{const n=ML(0,RL(1,fL(e,t)));return _z(n,-1)}))},categoricalHinge:function(e,t){return wM((()=>{const n=vz(fL(e,t),-1),r=gz(fL(RL(1,e),t),-1);return ML(0,hL(1,RL(r,n)))}))},logcosh:function(e,t){return wM((()=>{const n=Math.log(2),r=RL(t,e),i=RL(hL(r,aB(fL(-2,r))),n);return _z(i,-1)}))},categoricalCrossentropy:Qq,sparseCategoricalCrossentropy:Jq,binaryCrossentropy:Zq,kullbackLeiblerDivergence:eK,poisson:function(e,t){return wM((()=>{const n=fz(hL(fH(),t));return _z(RL(t,fL(e,n)),-1)}))},cosineProximity:tK};function rK(e){if("string"===typeof e){if(e in nK)return nK[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new wG(t)}return e}function iK(e,t){return wM((()=>{const n=fL(.5,Uz(t)),r=mH(hz(t,n),e.dtype);return _z(rz(e,r),-1)}))}function sK(e,t){return wM((()=>mH(rz(vP(e,-1),vP(t,-1)),"float32")))}function oK(e,t){return wM((()=>uL(vz(Nz(rz(e,1),rz(t,1))),"float32")))}function aK(e,t){return Zq(e,t)}function lK(e,t){return e.rank===t.rank&&(e=uB(e,[e.rank-1])),(t=vP(t,-1)).dtype!==e.dtype&&(t=uL(t,e.dtype)),uL(rz(e,t),"float32")}const uK=Qq,cK=Jq,hK={binaryAccuracy:iK,categoricalAccuracy:sK,precision:function(e,t){return wM((()=>{const n=oK(e,t),r=function(e,t){return wM((()=>uL(vz(Nz(rz(e,0),rz(t,1))),"float32")))}(e,t),i=hL(n,r);return uL(gB(hz(i,0),pL(n,i),0),"float32")}))},categoricalCrossentropy:uK,sparseCategoricalCrossentropy:cK,mse:qq,MSE:qq,mae:Kq,MAE:Kq,mape:Xq,MAPE:Xq,cosine:tK};function dK(e){if("string"===typeof e&&e in hK)return hK[e];if("string"!==typeof e&&null!=e)return e;throw new wG(`Unknown metric ${e}`)}function pK(e){if(EG(null!==e,`Unknown LossOrMetricFn ${e}`),"string"===typeof e)return e;{let t;for(const n of Object.keys(nK))if(nK[n]===e){t=n;break}if(void 0!==t)return t;for(const n of Object.keys(hK))if(hK[n]===e){t=n;break}return void 0!==t?t:e.name}}const fK=1048576;function mK(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!gK(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(e);n.length>fK&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function gK(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t){if("string"!==typeof n)return!1;if(!gK(e[n]))return!1}return!0}if(Array.isArray(e)){for(const t of e)if(!gK(t))return!1;return!0}return!1}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function vK(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log;const i=function(e){let t=!0;const n=[],r=[];for(const i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(const i of n){if(i.length>1||1===i.length&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(const i of e.layers){let e=!1;for(const n of i.inboundNodes)if(-1!==r.indexOf(n)){if(e){t=!1;break}e=!0}if(!t)break}return t}(e),s=["Layer (type)","Input Shape","Output shape","Param #"];let o;if(i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((e=>Math.floor(t*e)))),!i){s.push("Receives inputs"),o=[];for(const t in e.nodesByDepth)o.push(...e.nodesByDepth[t])}r("_".repeat(t)),yK(s,n,r),r("=".repeat(t));const a=e.layers;for(let c=0;c<a.length;++c)i?bK(a[c],n,r):xK(a[c],n,o,r),r((c===a.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const l=function(e){let t;t=null!=e.collectedTrainableWeights?rq(e.collectedTrainableWeights):rq(e.trainableWeights);return t}(e),u=rq(e.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(t))}function yK(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="";for(let i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=e[i],r=r.slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function bK(e,t,n){let r,i;try{i=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(pae){i="multiple"}try{r=JSON.stringify(e.outputShape)}catch(pae){r="multiple"}yK([`${e.name} (${e.getClassName()})`,i,r,e.countParams().toString()],t,n)}function xK(e,t,n,r){let i,s;try{s=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(pae){s="multiple"}try{i=JSON.stringify(e.outputShape)}catch(pae){i="multiple"}const o=[];for(const c of e.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(c)))for(let e=0;e<c.inboundLayers.length;++e){const t=c.inboundLayers[e].name,n=c.nodeIndices[e],r=c.tensorIndices[e];o.push(`${t}[${n}][${r}]`)}const a=e.name,l=e.getClassName(),u=0===o.length?"":o[0];yK([`${a} (${l})`,s,i,e.countParams().toString(),u],t,r);for(let c=1;c<o.length;++c)yK(["","","","",o[c]],t,r)}function wK(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function kK(e,t){if(null===e)return null;if("string"===typeof e)return $G(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const r=e[i];wK(t,i,r)?n.push(r):n.push(kK(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n];if("name"===n&&"string"===typeof r)t[n]=r;else{const e=$G(n);t[e]=kK(r,e)}}return t}}function SK(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return RG(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const r=e[i];wK(t,i,r)?n.push(r):n.push(SK(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n],i=RG(n);t[i]="name"!==n&&"className"!==n||"string"!==typeof r?SK(r,n):r}return t}}const IK="4.22.0";class CK extends pq{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,null==this.name){const e=this.getClassName().toLowerCase();this.name=qG(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],LG(this.inputs).length!==this.inputs.length)throw new wG(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map((e=>e.name))}`);LG(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map((e=>e.name))}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const e=v.sourceLayer,t=v.nodeIndex,n=v.tensorIndex;this.outputLayers.push(e),this.outputLayersNodeIndices.push(t),this.outputLayersTensorIndices.push(n)}for(const v of this.inputs){const e=v.sourceLayer,t=v.nodeIndex,n=v.tensorIndex;EG(0===t,"input layer has >1 nodes"),EG(0===n,"input layer has >1 tensors"),this.inputLayers.push(e),this.inputLayersNodeIndices.push(t),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const t=this.inputLayers[v];if(!(t instanceof mq))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${v} (0-based) originates from layer type ${t.getClassName()}.`);this.inputNames.push(t.name),this.feedInputShapes.push(t.batchInputShape),this.feedInputNames.push(t.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map((e=>e.shape)),this.internalOutputShapes=this.outputs.map((e=>e.shape));const t={},n={},r={},i={},s={},o=[],a=(e,t,n,r,i,l)=>{null!=r&&null!=i&&null!=l||(r=e.sourceLayer,i=e.nodeIndex,l=e.tensorIndex);const u=r.inboundNodes[i];if(-1!==n.indexOf(u))throw new xG(`The tensor ${e.name} at layer "${r.name}" is part of a cycle.`);if(-1!==t.indexOf(u))return;this.containerNodes.add(CK.nodeKey(r,i)),r.id in s||(s[r.id]=Object.keys(s).length),-1===n.indexOf(u)&&n.push(u);const c=u.inboundLayers.length;for(let s=0;s<c;s++){const e=u.inputTensors[s],r=u.inboundLayers[s],i=u.nodeIndices[s],o=u.tensorIndices[s];a(e,t,n,r,i,o)}for(t.push(u);n.indexOf(u)>=0;)n.splice(n.indexOf(u),1);o.push(u)},l=[],u=[];for(const v of this.outputs)a(v,l,u);const c=o.slice().reverse();for(const v of c){n[v.id]=v,v.id in t||(t[v.id]=0);let e=t[v.id];const s=null==r[v.outboundLayer.id]?0:r[v.outboundLayer.id];e=Math.max(e,s),r[v.outboundLayer.id]=e,i[v.outboundLayer.id]=v.outboundLayer,t[v.id]=e;for(let r=0;r<v.inboundLayers.length;r++){const i=v.inboundLayers[r],s=v.nodeIndices[r],o=i.inboundNodes[s],a=null==t[o.id]?0:t[o.id];t[o.id]=Math.max(e+1,a),n[o.id]=o}}const h={};for(const v in t){const e=t[v];e in h||(h[e]=[]),h[e].push(n[v])}const d={};for(const v in r){const e=r[v];e in d||(d[e]=[]),d[e].push(i[v])}let p=Object.keys(d).map((e=>parseInt(e,10))).sort(MG);this.layers=[];for(const v of p){const e=d[v];e.sort(((e,t)=>{const n=s[e.id],r=s[t.id];return n<r?-1:n>r?1:0}));for(const t of e)t instanceof CK&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=d,p=Object.keys(h).map((e=>parseInt(e,10))).sort(MG);const f=this.inputs.slice(),m=[];for(const v of p)for(const e of h[v]){const t=e.outboundLayer;if(null!=t){for(const n of e.inputTensors)if(-1===f.indexOf(n))throw new xG(`Graph disconnected: cannot obtain value for tensor ${n} at layer "${t.name}". The following previous layers were accessed without issue: ${m}`);for(const t of e.outputTensors)f.push(t);m.push(t.name)}}this.nodesByDepth=h;const g=this.layers.map((e=>e.name));for(const v of g){const e=g.filter((e=>e===v)).length;if(1!==e)throw new xG(`The name "${v}" is used ${e} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new hq({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((e=>null)),outputMasks:this.outputs.map((e=>null)),inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs.map((e=>e.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach((t=>{t._trainableWeights.forEach((t=>t.trainable=e))})),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new wG("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={};let r=0;const i=(e=>{const t=Object.keys(e);if(0===t.length)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(e);i&&this.parseWeights(e);for(const o of this.layers)for(const[e,t]of o.weights.entries()){const s=i?`${t.name.split("/").slice(0,-1).join("/")+"/"}${e}`:t.originalName;if(null!=n[s])throw new wG(`Duplicate weight name: ${s}`);n[s]=t,r++}const s=[];for(const o in e){let r=o;if(null==n[o]){const e=o.split("/");r=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[r])s.push([n[r],e[o]]);else if(t)throw new wG(`Provided weight data has no target variable: ${o}`);delete n[r]}if(t){const e=[];for(const t in n)e.push(t);if(e.length>0)throw new wG(`${e.length} of ${r} weights are not set: ${e}`)}aq(s)}parseWeights(e){for(const t in Object.keys(e)){const n=t.split("/"),r=["vars","layer_checkpoint_dependencies"],i=n.map((e=>e.startsWith("_")?e.slice(1):e)).filter((e=>!r.includes(e))).join("/");i!==t&&(e[i]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${IK}`,t.backend="TensorFlow.js",t}toJSON(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=SK(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return wM((()=>{e=AG(e);const n=new gq;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return bq(this.outputs,n,t)}))}computeMask(e,t){return wM((()=>{let n;return e=AG(e),n=null==t?CG(null,e.length):AG(t),this.runInternalGraph(e,n)[1]}))}computeOutputShape(e){const t=eq(e);if(t.length!==this.inputLayers.length)throw new wG(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let o=0;o<t.length;o++){const e=this.inputLayers[o],r=t[o];n[e.name+"_0_0"]=r}const r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(MG);if(r.length>1)for(const o of r){const e=this.nodesByDepth[o];for(const t of e){const e=t.outboundLayer;if(-1!==this.inputLayers.map((e=>e.id)).indexOf(e.id))continue;const r=[];for(let o=0;o<t.inboundLayers.length;o++){const e=t.inboundLayers[o],i=t.nodeIndices[o],s=t.tensorIndices[o],a=n[`${e.name}_${i}_${s}`];r.push(a)}const i=eq(e.computeOutputShape(NG(r))),s=e.inboundNodes.indexOf(t);for(let t=0;t<i.length;t++){n[`${e.name}_${s}_${t}`]=i[t]}}}const i=[],s=[];for(let o=0;o<this.outputLayers.length;o++){const e=this.outputLayers[o],t=this.outputLayersNodeIndices[o],n=this.outputLayersTensorIndices[o],r=`${e.name}_${t}_${n}`;s.push(r)}for(let o=0;o<s.length;o++){const e=s[o];EG(e in n),i.push(n[e])}return NG(i)}runInternalGraph(e,t){null==t&&(t=CG(null,e.length));const n={};for(let a=0;a<this.inputs.length;++a){const r=this.inputs[a],i=e[a],s=t[a];n[r.id]=[i,s]}const r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(MG);for(const a of r){const e=this.nodesByDepth[a];for(const t of e){const e=t.outboundLayer,r=t.inputTensors,i=t.outputTensors,s=new Array;for(const t of r)t.id in n&&s.push(n[t.id]);if(s.length===r.length){let r,o,a,l,u={};if(null!=t.callArgs&&(u=t.callArgs),1===s.length){const[t,n]=s[0];null==u.mask&&(u.mask=n),a=AG(e.call(t,u)),l=AG(e.computeMask(t,n)),r=[t],o=[n]}else r=s.map((e=>e[0])),o=s.map((e=>e[1])),null==u.mask&&(u.mask=o),a=AG(e.call(r,u)),l=AG(e.computeMask(r,o));if(e.activityRegularizer)throw new kG("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<i.length;++e){const t=i[e],r=a[e],s=l[e];n[t.id]=[r,s]}}}}const i=[],s=[],o=[];for(const a of this.outputs){EG(a.id in n,`Could not compute output ${a.name} : ${a.id}`);const[e,t]=n[a.id];o.push(e.shape),i.push(e),s.push(t)}return[i,s,o]}buildNodeConversionMap(e){const t={};let n;for(const r of this.layers){n=r instanceof CK?1:0;for(let e=0;e<r.inboundNodes.length;e++){const i=CK.nodeKey(r,e);this.containerNodes.has(i)&&(t[i]=n,n+=1)}}return t}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new wG("Provide either a layer name or layer index");if("number"===typeof e)return this.findLayer(e);for(const n of this.layers)if(n.name===e)return n;throw new wG(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new wG(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return wM((()=>{const e=[];for(const t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){const r=CK.nodeKey(t,n);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e}))}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(const s of this.layers){const e=s.getClassName(),r=s.getConfig(),i=[];for(let n=0;n<s.inboundNodes.length;n++){const e=s.inboundNodes[n],r=CK.nodeKey(s,n);let o={};if(this.containerNodes.has(r)){if(e.callArgs)try{JSON.stringify(e.callArgs),o=e.callArgs}catch(pae){console.warn(`Layer ${s.name} was passed non-serializable keyword arguments: ${e.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),o={}}if(e.inboundLayers.length>0){const n=[];for(let r=0;r<e.inboundLayers.length;r++){const i=e.inboundLayers[r],s=e.nodeIndices[r],a=e.tensorIndices[r];let l=t[CK.nodeKey(i,s)];null==l&&(l=0),n.push([i.name,l,a,o])}i.push(n)}}}const o={};o.name=s.name,o.className=e,o.config=r,o.inboundNodes=i,n.push(o)}e.layers=n;const r=[];for(let s=0;s<this.inputLayers.length;s++){const e=this.inputLayers[s],n=this.inputLayersNodeIndices[s],i=CK.nodeKey(e,n);if(!this.containerNodes.has(i))continue;let o=t[i];null!==o&&void 0!==o||(o=0);const a=this.inputLayersTensorIndices[s];r.push([e.name,o,a])}e.inputLayers=r;const i=[];for(let s=0;s<this.outputLayers.length;s++){const e=this.outputLayers[s],n=this.outputLayersNodeIndices[s],r=CK.nodeKey(e,n);if(!this.containerNodes.has(r))continue;let o=t[r];null!==o&&void 0!==o||(o=0);const a=this.outputLayersTensorIndices[s];i.push([e.name,o,a])}return e.outputLayers=i,e}static fromConfig(e,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={},i={};function s(e,t){e.name in i?i[e.name].push(t):i[e.name]=[t]}function o(e,t){const n=[];let i;for(const o of t){const a=o[0],l=o[1],u=o[2];if(i=null==o[3]?{}:o[3],!(a in r))return void s(e,t);const c=r[a];if(c.inboundNodes.length<=l)return void s(e,t);const h=c.inboundNodes[l];n.push(h.outputTensors[u])}n.length>0&&e.apply(NG(n),i)}function a(e){const i=e.name,o=Gq(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[i]=o;e.inboundNodes.forEach((e=>{if(!(e instanceof Array))throw new wG(`Corrupted configuration, expected array for nodeData: ${e}`);s(o,e)}))}const l=t.name,u=t.layers;for(const f of u)a(f);for(;!PG(i);)for(const e of u){const t=r[e.name];if(t.name in i){const e=i[t.name];delete i[t.name];for(const n of e)o(t,n)}}const c=[],h=[],d=t.inputLayers;for(const f of d){const e=f[0],t=f[1],n=f[2];EG(e in r);const i=r[e].inboundNodes[t].outputTensors;c.push(i[n])}const p=t.outputLayers;for(const f of p){const e=f[0],t=f[1],n=f[2];EG(e in r);const i=r[e].inboundNodes[t].outputTensors;h.push(i[n])}return new e({inputs:c,outputs:h,name:l})}get stateful(){if(this._stateful)throw new wG("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){wM((()=>{this.layers.forEach((e=>{e.stateful&&e.resetStates()}))}))}}function EK(e,t,n){const r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>null));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){const n=[];return t.forEach((t=>{t in e?n.push(e[t]):n.push(null)})),n}throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function TK(e,t){return EK(e,t,"classWeight")}async function NK(e,t,n,r){if(null!=t||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const t=wM((()=>{if(1===e.shape.length)return cL(e);if(2===e.shape.length){if(e.shape[1]>1){return vP(e,1)}if(1===e.shape[1])return OP(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)})),r=Array.from(await t.data());kM(t);const i=[];return r.forEach((e=>{if(null==n[e])throw new Error(`classWeight must contain all classes in the training data. The class ${e} exists in the data but not in classWeight`);i.push(n[e])})),dB(i,"float32")}return null}function AK(e,t){return fL(e,t)}function RK(e,t){let n,r;const i=t;n=i.xs,r=i.ys,GR(null!=n&&null!=r,(()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`));const s=$K("input",e.inputNames,n),o=$K("output",e.outputNames,r),a=s[0].shape[0];GR(s.length===e.inputs.length,(()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`)),GR(o.length===e.outputs.length,(()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`));for(let l=0;l<s.length;l++)GR(s[l].shape[0]===a,(()=>`Batch size mismatch: input ${e.inputNames[l]} has ${s[l].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`));for(let l=0;l<o.length;l++)GR(o[l].shape[0]===a,(()=>`Batch size mismatch: output ${e.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`));return{xs:s,ys:o}}function $K(e,t,n){if(n instanceof $F)return[n];if(Array.isArray(n))return GR(n.length===t.length,(()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`)),n;{const r=[];for(const i of t){if(null==n[i])throw new wG(`The feature data generated by the dataset lacks the required ${e} key '${i}'.`);r.push(n[i])}return r}}async function _K(e,t,n){const r=null!=n.batchesPerEpoch;if(GR(null!=e.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),GR(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),GR(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`)),GR(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`)),GR(null==n.validationSplit,(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const i=null!=n.validationData;let s,o;if(i)if(OK(n.validationData))GR(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`));else{const e=function(e){if(3===e.length)throw new kG("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);s=e.xs,o=e.ys}const a=e.makeTrainFunction(),l=e.getDedupedMetricsNames();let u;u=i?l.slice().concat(l.map((e=>"val_"+e))):l.slice();const c=Wq(n.callbacks,n.yieldEvery),h=null==n.verbose?1:n.verbose,{callbackList:d,history:p}=jq(c,h,n.epochs,null,null,function(e,t){let n=null;null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size);return n}(t,n),null,i,u);d.setModel(e),e.history=p,await d.onTrainBegin(),e.stopTraining_=!1;let f=null==n.initialEpoch?0:n.initialEpoch,m=await t.iterator();for(;f<n.epochs;){const u={};await d.onEpochBegin(f);let c=0,h=0;for(r||(m=await t.iterator());!r||c<n.batchesPerEpoch;){const t=await m.next();if(r&&t.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${c} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, `+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset.");break}if(null!=t.value){const{xs:r,ys:i}=RK(e,t.value),s={};s.batch=h,s.size=r[0].shape[0],await d.onBatchBegin(h,s);const o=[];if(null!=n.classWeight){const t=TK(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)o.push(await NK(i[e],null,t[e]))}const u=r.concat(i).concat(o),p=a(u);kM(u);for(let e=0;e<l.length;++e){const t=l[e],n=p[e];s[t]=n,SM(n)}await d.onBatchEnd(h,s),Dq(s),h++,c++}if(r?c>=n.batchesPerEpoch:t.done){if(i){let t;t=OK(n.validationData)?AG(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):AG(e.evaluate(s,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)u[`val_${e.metricsNames[n]}`]=t[n]}break}if(e.stopTraining_)break}if(await d.onEpochEnd(f,u),f++,e.stopTraining_)break}return await d.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function OK(e){return"function"===typeof e.iterator}function DK(e){GR(e>0&&Number.isInteger(e),(()=>`batchSize is required to be a positive integer, but got ${e}`))}function FK(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((e=>vH(e,t,n-t))):vH(e,t,n-t)}function MK(e,t){return wM((()=>null==e?null:Array.isArray(e)?e.map((e=>MK(e,t))):CH(e,"int32"===t.dtype?t:uL(t,"int32"))))}function LK(e,t){const n=[];let r=0,i=null;for(;r<e;)i=r+t,i>=e&&(i=e),n.push([r,i]),r=i;return n}function PK(e){const t=[];e instanceof $F&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(1===r.rank)t.push(gH(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function zK(e,t){if(null==e)return;const n=[];if(t instanceof $F)n.push(t.id);else if(Array.isArray(t))t.forEach((e=>n.push(e.id)));else if(null!=t)for(const i in t){const e=t[i];n.push(e.id)}const r=[];if(e instanceof $F)-1===n.indexOf(e.id)&&r.push(e);else if(Array.isArray(e))e.forEach((e=>{-1===n.indexOf(e.id)&&r.push(e)}));else if(null!=e)for(const i in e){const t=e[i];-1===n.indexOf(t.id)&&r.push(t)}r.forEach((e=>{e.isDisposed||e.dispose()}))}function BK(e){return Array.isArray(e)}function UK(e){return!function(e){return e instanceof $F}(e)&&!BK(e)}function WK(e,t,n){let r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){let t=!1;if(BK(e)&&e.length>0)t=!0;else if(UK(e)){for(const n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new wG(`Error when checking model ${s} expected no data, but got ${e}`)}return[]}if(null==e)return t.map((e=>null));if(UK(e)){r=[];for(const n of t){if(null==e[n])throw new wG(`No data provided for "${n}". Need data for each key in: ${t}`);r.push(e[n])}}else if(BK(e)){if(e.length!==t.length)throw new wG(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);r=e}else{if(t.length>1)throw new wG(`The model ${s} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);r=[e]}if(r=PK(r),null!=n)for(let o=0;o<t.length;++o){if(null==n[o])continue;const e=r[o];if(e.shape.length!==n[o].length)throw new wG(`Error when checking ${s}: expected ${t[o]} to have ${n[o].length} dimension(s). but got array with shape ${e.shape}`);for(let t=0;t<n[o].length;++t){if(0===t&&!i)continue;const r=e.shape[t],a=n[o][t];if(null!=a&&a>=0&&r!==a)throw new wG(`${s} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${s} received an input with ${e.shape[0]} examples, each with shape [${e.shape.slice(1,e.shape.length)}] (tensor shape [${e.shape}])`)}}return r}function VK(e,t,n){let r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new wG(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);r=e}else{if(t.length>1)throw new wG(`The model expects ${t.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);r=[e]}if(null!=n)for(let o=0;o<t.length;++o){if(null==n[o])continue;const e=r[o];if(e.shape.length!==n[o].length)throw new wG(`Error when checking ${s}: expected ${t[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(e.shape)}`);for(let r=0;r<n[o].length;++r){if(0===r&&!i)continue;const a=e.shape[r],l=n[o][r];if(null!=l&&l!==a)throw new wG(`Error when checking ${s}: expected ${t[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(e.shape)}.`)}}}class jK extends CK{constructor(e){super(e),this.isTraining=!1}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new wG("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");vK(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){const t={Adagrad:()=>SU.adagrad(.01),Adadelta:()=>SU.adadelta(1,.95,fH()),Adam:()=>SU.adam(.001,.9,.999,fH()),Adamax:()=>SU.adamax(.002,.9,.999,fH(),0),RMSProp:()=>SU.rmsprop(.001,.9,0,fH()),SGD:()=>SU.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new wG(`Unknown Optimizer ${e}`)}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof CL))throw new wG("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new wG(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);const n=e.loss;t=n.map((e=>rK(e)))}else{const n=rK(e.loss);this.outputs.forEach((e=>{t.push(n)}))}else{e.loss=e.loss;for(const t in e.loss)if(-1===this.outputNames.indexOf(t))throw new wG(`Unknown entry in loss dictionary: "${t}". Only expected the following keys: ${this.outputNames}`);for(const n of this.outputNames)null==e.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),t.push(rK(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let s=0;s<this.outputs.length;++s){const e=this.internalOutputShapes[s],t=this.outputNames[s];this.feedOutputNames.push(t),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[s])}const n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],iH("loss",(()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;const t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}}));const r=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>[]));let n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);n=e}if(Array.isArray(n))return t.map((e=>n));{const e=[];for(const r of t){let t=n.hasOwnProperty(r)?n[r]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),i=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};iH("metric",(()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;(t=>{let n,r,s;for(const o of t){if("string"===typeof o&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(o)){const t=this.internalOutputShapes[e];let i;1===t[t.length-1]||this.lossFunctions[e]===Zq?-1!==["accuracy","acc"].indexOf(o)?r=iK:-1!==["crossentropy","ce"].indexOf(o)&&(r=aK):this.lossFunctions[e]===Jq?-1!==["accuracy","acc"].indexOf(o)?r=lK:-1!==["crossentropy","ce"].indexOf(o)&&(r=cK):-1!==["accuracy","acc"].indexOf(o)?r=sK:-1!==["crossentropy","ce"].indexOf(o)&&(r=uK),-1!==["accuracy","acc"].indexOf(o)?i="acc":-1!==["crossentropy","ce"].indexOf(o)&&(i="ce"),s=r,n=""+i}else{const e=dK(o);s=e,n=""+pK(o)}let t;iH(n,(()=>{t=s})),i(e,n,t)}})(r[e])}})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=null==n.batchSize?32:n.batchSize;DK(r);const i=this.standardizeUserDataXY(e,t,!0,r);try{const e=i[0].concat(i[1]);this.makeTestFunction();const t=this.testFunction;return NG(this.testLoop(t,e,r,n.verbose,n.steps))}finally{zK(i[0],e),zK(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),async function(e,t,n){const r=null!=(n=n||{}).batches,i=e.testFunction;let s=[];if(n.verbose>0)throw new kG("Verbose mode is not implemented yet.");GR(!r||n.batches>0&&Number.isInteger(n.batches),(()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`));const o="function"===typeof t.next?t:await t.iterator();let a=0,l=0;for(;!r||l<n.batches;){const t=await o.next();if(s=wM((()=>{if(t.value){const{xs:n,ys:r}=RK(e,t.value),o=n.concat(r),u=wM((()=>i(o)));if(kM(o),0===l)for(let e=0;e<u.length;++e)s.push(bL(0));const c=o[0].shape[0];for(let e=0;e<u.length;++e){const t=u[e],n=s[e];s[e]=wM((()=>hL(s[e],fL(c,t)))),l>0&&kM(n)}kM(u),a+=c,++l}return s})),t.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<s.length;++u){const e=s[u];s[u]=pL(s[u],a),kM(e)}return NG(s)}(this,e,t)}checkNumSamples(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new wG(`If ${i} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else{if(null==e)throw new wG(`Either the input data should have a defined shape, or ${i} shoud be specified.`);r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new wG("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(t),r=n?t:[t],i=this.retrieveSymbolicTensors(r),s=new gq;if(e instanceof $F&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new wG(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let t=0;t<this.inputs.length;++t)s.add(this.inputs[t],e[t])}else for(const a of this.inputs){const t=e[a.name];if(null==t)throw new wG(`No value is provided for the model's input ${a.name}`);s.add(a,t)}const o=bq(i,s);return n?o:o[0]}retrieveSymbolicTensors(e){const t=CG(null,e.length);let n=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],s=i.map((e=>e.name));for(let r=0;r<e.length;++r){const o=s.indexOf(e[r]);if(-1!==o&&(t[r]=i[o],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw t.forEach(((t,r)=>{null==t&&n.push(e[r])})),new wG(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(n)}`)}return t}predictLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return wM((()=>{const r=this.checkNumSamples(e);if(n)throw new kG("Verbose predictLoop() is not implemented yet.");const i=LK(r,t),s=this.outputs.map((e=>[]));for(let t=0;t<i.length;++t){wM((()=>{const n=i[t][0],r=i[t][1],s=FK(e,n,r),o=[];if(Array.isArray(s))for(let e=0;e<s.length;++e)o.push({key:this.inputs[e],value:s[e]});else o.push({key:this.inputs[0],value:s});const a=new gq(o);return bq(this.outputs,a)})).forEach(((e,t)=>s[t].push(e)))}return NG(s.map((e=>WP(e,0))))}))}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=PK(e);VK(n,this.inputNames,this.feedInputShapes,!1);try{const e=null==t.batchSize?32:t.batchSize;return DK(e),this.predictLoop(n,e)}finally{zK(n,e)}}predictOnBatch(e){VK(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new xG("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let i=0;i<this.feedOutputShapes.length;++i){const e=this.feedOutputShapes[i];this.feedLossFns[i]===Jq?r.push(e.slice(0,e.length-1).concat([1])):r.push(e)}if(function(e,t){const n=LG(e.map((e=>e.shape[0])));n.sort();const r=LG(t.map((e=>e.shape[0])));if(r.sort(),n.length>1)throw new wG(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map((e=>e.shape)))}`);if(r.length>1)throw new wG(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map((e=>e.shape)))}`);if(n.length>0&&r.length>0&&!XR(n,r))throw new wG(`Input Tensors should have the same number of samples as target Tensors. Found ${n[0]} input sample(s) and ${r[0]} target sample(s).`)}(e=WK(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=WK(t,this.feedOutputNames,r,!1,"target")),function(e,t,n){const r=[qq,Zq,Qq];for(let i=0;i<e.length;++i){const s=e[i],o=t[i],a=n[i];if(null!=o){if(o===Qq&&1===s.shape[s.shape.length-1])throw new wG(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(o)){const e=s.shape.slice(1),t=a.slice(1);for(let n=0;n<e.length;++n){const r=e[n],i=t[n];if(null!=i&&r!==i)throw new wG(`A target Tensor with shape ${s.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new wG(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${n}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5?arguments[5]:void 0;const[o,a]=this.standardizeUserDataXY(e,t,i,s);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=r){const e=TK(r,this.outputNames);l=[];for(let t=0;t<e.length;++t)l.push(await NK(a[t],null,e[t]))}return[o,a,l]}testLoop(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return wM((()=>{const s=this.checkNumSamples(t,n,i,"steps"),o=[];if(r>0)throw new kG("Verbose mode is not implemented yet.");if(null!=i)throw new kG("steps mode in testLoop() is not implemented yet");{const r=LK(s,n),i=dB(dH(0,s));for(let n=0;n<r.length;++n){const s=r[n][0],a=r[n][1],l=vH(i,s,a-s),u=MK(t,l),c=e(u);if(0===n)for(let e=0;e<c.length;++e)o.push(bL(0));for(let e=0;e<c.length;++e){const t=c[e];o[e]=hL(o[e],fL(a-s,t))}}for(let e=0;e<o.length;++e)o[e]=pL(o[e],s)}return o}))}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){const r=e[n];let i=r;if(TG(e,r)>1){i+=`_${TG(e.slice(0,n),r)}`}t.push(i)}return t}makeTrainFunction(){return e=>{const t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),s=[],o=this.collectedTrainableWeights.map((e=>e.read()));return[this.optimizer_.minimize((()=>{const e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});const o=new gq(e),a=bq(this.outputs,o,{training:!0});let l;for(let n=0;n<this.lossFunctions.length;++n){let e=(0,this.lossFunctions[n])(r[n],a[n]);null!=i[n]&&(e=AK(e,i[n]));const s=_z(e);t.push(s),l=0===n?e:hL(l,e)}for(let n=0;n<this.metricsTensors.length;++n){let e;if(this.outputs.length>1&&n<this.outputs.length)e=t[n];else{const t=this.metricsTensors[n][0],i=this.metricsTensors[n][1];e=_z(t(r[i],a[i]))}SM(e),s.push(e)}return l=_z(l),this.calculateLosses().forEach((e=>{l=hL(l,e)})),l}),!0,o)].concat(s)}}makeTestFunction(){this.testFunction=e=>wM((()=>{const t=[];let n;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=[];for(let e=0;e<this.inputs.length;++e)s.push({key:this.inputs[e],value:r[e]});const o=new gq(s),a=bq(this.outputs,o);for(let e=0;e<this.lossFunctions.length;++e){const r=this.lossFunctions[e],s=_z(r(i[e],a[e]));n=0===e?s:hL(n,s),t.push(n)}for(let e=0;e<this.metricsTensors.length;++e){const n=this.metricsTensors[e][0],r=this.metricsTensors[e][1],s=_z(n(i[r],a[r]));t.push(s)}return t}))}async fit(e,t){let n,r,i,s,o,a,l,u,c,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{const d=null==h.batchSize?32:h.batchSize;DK(d);const p=!1,f=await this.standardizeUserData(e,t,h.sampleWeight,h.classWeight,p,d);n=f[0],r=f[1],c=f[2];let m,g=!1;if(null!=h.validationData&&h.validationData.length>0){if(g=!0,2!==h.validationData.length)throw 3===h.validationData.length?new kG("validationData including sample weights is not supported yet."):new wG(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${h.validationData} is invalid.`);o=h.validationData[0],a=h.validationData[1];const e=!0,t=await this.standardizeUserData(o,a,null,null,e,d);l=t[0],u=t[1],m=l.concat(u)}else if(null!=h.validationSplit&&h.validationSplit>0&&h.validationSplit<1){g=!0;const e=Math.floor(n[0].shape[0]*(1-h.validationSplit)),t=n[0].shape[0];l=FK(n,e,t),i=n,n=FK(n,0,e),u=FK(r,e,t),s=r,r=FK(r,0,e),m=l.concat(u)}else null!=h.validationSteps&&(g=!0);const v=n.concat(r).concat(c);this.checkTrainableWeightsConsistency();const y=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let x,w;g?(this.makeTestFunction(),x=this.testFunction,w=b.slice().concat(b.map((e=>"val_"+e)))):(x=null,m=[],w=b.slice());const k=Wq(h.callbacks,h.yieldEvery);return await this.fitLoop(y,v,b,d,h.epochs,h.verbose,k,x,m,h.shuffle,w,h.initialEpoch,null,null)}finally{this.isTraining=!1,zK(n,e),zK(r,t),zK(i,e),zK(s,t),zK(l,o),zK(u,a),null!=c&&kM(c)}}async fitLoop(e,t,n,r,i,s,o,a,l,u,c,h,d,p){null==r&&(r=32),null==i&&(i=1),null==u&&(u=!0),null==h&&(h=0);let f=!1;if(null!=a&&null!=l&&(f=!0),null!=p&&(f=!0,null==d))throw new wG("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(t,r,d,"steps_per_epoch");let g;null!=m&&(g=dH(0,m)),null==s&&(s=1);const{callbackList:v,history:y}=jq(o,s,i,h,m,d,r,f,c);v.setModel(this),this.history=y,await v.onTrainBegin(),this.stopTraining_=!1;for(let b=h;b<i;++b){await v.onEpochBegin(b);const i={};if(null!=d)throw new kG("stepsPerEpoch mode is not implemented yet.");{if("batch"===u)throw new kG("batch shuffling is not implemneted yet");u&&UR(g);const s=dB(g),o=LK(m,r);for(let u=0;u<o.length;++u){const c={};if(await v.onBatchBegin(u,c),wM((()=>{const h=o[u][0],d=o[u][1],p=vH(s,h,d-h);c.batch=u,c.size=d-h;const m=MK(t,p),g=e(m);for(let e=0;e<n.length;++e){const t=n[e],r=g[e];c[t]=r,SM(r)}if(u===o.length-1&&f){const e=this.testLoop(a,l,r);for(let t=0;t<n.length;++t){const r=n[t],s=e[t];SM(s),i["val_"+r]=s}}})),await v.onBatchEnd(u,c),Dq(c),this.stopTraining_)break}s.dispose()}if(await v.onEpochEnd(b,i),this.stopTraining_)break}return await v.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return _K(this,e,t)}async trainOnBatch(e,t){const n=await this.standardizeUserData(e,t),r=n[0],i=n[1],s=this.makeTrainFunction()(r.concat(i)),o=[];for(const a of s){const e=await a.data();o.push(e[0])}return kM(s),zK(n[0],e),zK(n[1],t),NG(o)}getNamedWeights(e){const t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n);for(let s=0;s<r.length;++s)n&&!r[s].trainable||t.push({name:r[s].originalName,tensor:i[s]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const t=xM().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-xM().numTensors}return e}getLossIdentifiers(){let e;if("string"===typeof this.loss)e=RG(this.loss);else if(Array.isArray(this.loss)){for(const e of this.loss)if("string"!==typeof e)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map((e=>RG(e)))}else{const t=Object.keys(this.loss);e={};const n=this.loss;for(const r of t){if("string"!==typeof n[r])throw new Error("Serialization of non-string loss is not supported.");e[r]=RG(n[r])}}return e}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[RG(pK(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((e=>RG(pK(e))));{const e={};for(const t in this.metrics)e[t]=RG(pK(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const t=Gq(kK(e.optimizer_config));let n,r;if("string"===typeof e.loss)n=$G(e.loss);else if(Array.isArray(e.loss))n=e.loss.map((e=>$G(e)));else if(null!=e.loss){n={};for(const t in e.loss)n[t]=$G(e.loss[t])}if(Array.isArray(e.metrics))r=e.metrics.map((e=>$G(e)));else if(null!=e.metrics){r={};for(const t in e.metrics)r[t]=$G(e.metrics[t])}this.compile({loss:n,metrics:r,optimizer:t})}async save(e,t){if("string"===typeof e){const t=(n=e,DM.getSaveHandlers(n));if(0===t.length)throw new wG(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new wG(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}var n;if(null==e.save)throw new wG("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await EM(this.getNamedWeights(t)),i={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:`TensorFlow.js tfjs-layers v${IK}`,convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){i.trainingConfig=this.getTrainingConfig();const e="optimizer",{data:t,specs:n}=await EM(await this.optimizer.getWeights(),e);r.specs.push(...n),r.data=(s=[r.data,t],yM.join(s))}var s;if(null!=this.userDefinedMetadata){const e=!0;mK(this.userDefinedMetadata,this.name,e),i.userDefinedMetadata=this.userDefinedMetadata}return i.weightData=r.data,i.weightSpecs=r.specs,e.save(i)}setUserDefinedMetadata(e){mK(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}jK.className="Model",IL(jK);class GK extends jK{}GK.className="Functional",IL(GK);class HK extends jK{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:qG("sequential_"),null!=e.layers)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some((e=>e<0)))throw new wG(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof HK||e instanceof jK;let n;if(t){if(n=e,1!==n.outputs.length)throw new wG("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new wG("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new wG("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const t=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new wG("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new mq({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(t)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==e.inboundNodes.length)throw new wG(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(1!==e.inboundNodes[0].outputTensors.length)throw new wG("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=fq(this.outputs[0])}this.inboundNodes=[],new hq({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:CG(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs[0].shape})}else{const t=e.apply(this.outputs[0]);if(Array.isArray(t))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[t],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(nq(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new jK({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new xG("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new xG("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new xG("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new xG("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t){let n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new wG("Legacy serialization format not supported yet.");n=t}else GR(null!=t.layers,(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),n=t.layers,delete t.layers,i=t;const s=new e(i);if(!(s instanceof HK))throw new kG(`Sequential.fromConfig called on non-Sequential input: ${s}`);for(const o of n){const e=Gq(o,void 0,r);r&&e.setFastWeightInitDuringBuild(!0),s.add(e)}return s}set stopTraining(e){if(null==this.model)throw new wG("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new wG("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}HK.className="Sequential",IL(HK);class qK extends kL{getConfig(){return{}}}class KK extends qK{apply(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new kG(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return nz(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}KK.className="elu",IL(KK);class XK extends qK{apply(e){return Jz(e)}}XK.className="selu",IL(XK);class YK extends qK{apply(e){return Yz(e)}}YK.className="relu",IL(YK);class QK extends qK{apply(e){return wM((()=>Dz(6,Yz(e))))}}QK.className="relu6",IL(QK);class JK extends qK{apply(e){return e}}JK.className="linear",IL(JK);class ZK extends qK{apply(e){return eB(e)}}ZK.className="sigmoid",IL(ZK);class eX extends qK{apply(e){return function(e){return wM((()=>{const t=hL(.5,fL(.2,e));return UP(t,0,1)}))}(e)}}eX.className="hardSigmoid",IL(eX);class tX extends qK{apply(e){return aB(e)}}tX.className="softplus",IL(tX);class nX extends qK{apply(e){return function(e){return wM((()=>pL(e,hL(_L(e),1))))}(e)}}nX.className="softsign",IL(nX);class rX extends qK{apply(e){return hB(e)}}rX.className="tanh",IL(rX);class iX extends qK{apply(e){return oB(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}iX.className="softmax",IL(iX);class sX extends qK{apply(e){return yz(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}sX.className="logSoftmax",IL(sX);class oX extends qK{apply(e){return wM((()=>wM((()=>{const t=Math.sqrt(2),n=fL(.5,hL(1,iz(pL(e,t))));return fL(e,n)}))))}}oX.className="gelu",IL(oX);class aX extends qK{apply(e){return wM((()=>fL(.5,fL(e,hL(1,hB(fL(mL(pL(2,Math.PI)),hL(e,fL(.044715,AL(e,3))))))))))}}aX.className="gelu_new",IL(aX);class lX extends qK{apply(e){return wM((()=>fL(e,hB(aB(e)))))}}lX.className="mish",IL(lX);class uX extends qK{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return wM((()=>fL(eB(fL(e,t)),e)))}}function cX(e){return e.getClassName()}function hX(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return FG(e,SL.getMap().classNameMap,t,"activation")}function dX(e){if(null==e){const e={className:"linear",config:{}};return hX(e)}if("string"===typeof e){const t={};return t.className=e,t.config={},hX(t)}return e instanceof qK?e:hX(e)}function pX(e){if(null!=e&&"object"!==typeof e)throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}uX.className="swish",IL(uX);class fX extends kL{}class mX extends fX{constructor(e){super(),pX(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return wM((()=>{let t=zz([1]);return this.hasL1&&(t=hL(t,vz(fL(this.l1,_L(e))))),this.hasL2&&(t=hL(t,vz(fL(this.l2,EH(e))))),OP(t,[])}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}mX.className="L1L2",IL(mX);const gX={l1l2:"L1L2"};function vX(e){return OG(e)}function yX(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return FG(e,SL.getMap().classNameMap,t,"regularizer")}function bX(e){if(null==e)return null;if("string"===typeof e){return yX({className:e in gX?gX[e]:e,config:{}})}return e instanceof fX?e:yX(e)}class xX extends pq{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=tq(e);let n=Yz(e);return null!=this.maxValue&&(n=UP(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}xX.className="ReLU",IL(xX);class wX extends pq{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=tq(e);return pz(n,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}wX.className="LeakyReLU",IL(wX);class kX extends pq{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=JH(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=bX(e.alphaRegularizer),this.alphaConstraint=_q(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new wG(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`);this.sharedAxes=[e.sharedAxes]}}build(e){const t=(e=nq(e)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<e.length;++r)n[r]=e[r];this.inputSpec=[new lq({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=tq(e),Vz(e,this.alpha.read())}getConfig(){const e={alphaInitializer:QH(this.alphaInitializer),alphaRegularizer:vX(this.alphaRegularizer),alphaConstraint:Rq(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}kX.className="PReLU",IL(kX);class SX extends pq{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new kG(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=tq(e);return nz(n)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}SX.className="ELU",IL(SX);class IX extends pq{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){const n=tq(e);return fL(n,uL(hz(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}IX.className="ThresholdedReLU",IL(IX);class CX extends pq{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new iX).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){return wM((()=>{let n=tq(e);const r=t.mask;if(null!=r){const e=fL(RL(Bz(n.shape),uL(r,n.dtype)),bL(-1e9));n=hL(n,e)}return this.axis instanceof Array?this.axis.length>1?sz(RL(n,Tz(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)}))}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function EX(e,t,n){if("number"===typeof e)return CG(e,t);if(e.length!==t)throw new wG(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let i=0;i<t;++i){const s=e[i];if((r=s)!==parseInt(r.toString(),10))throw new wG(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${s}`)}return e;var r}function TX(e,t,n,r){if(null==e)return e;let i;return i="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((i+r-1)/r)}function NX(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+hH([n-t,0]);else{if("same"!==r)throw new wG(`Unsupport padding mode: ${r}.`);e*=t}return e}function AX(e,t){return wM((()=>(eH(t),"channelsFirst"===t?bB(e,[0,2,3,1]):e)))}function RX(e,t){return wM((()=>(eH(t),"channelsFirst"===t?bB(e,[0,2,3,4,1]):e)))}function $X(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return wM((()=>{if(null==s&&(s="channelsLast"),eH(s),3!==e.shape.length)throw new wG(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(3!==t.shape.length)throw new wG(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(null!=n&&1!==n.shape.length)throw new wG(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if("channelsFirst"===s&&(e=bB(e,[0,2,1])),"causal"===i)throw new kG("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=KP(e,t,r,"same"===i?"same":"valid","NWC",o);return null!=n&&(a=NH(a,n)),a}))}function _X(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return wM((()=>{if(null==s&&(s="channelsLast"),eH(s),3!==e.rank&&4!==e.rank)throw new wG(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(3!==t.rank&&4!==t.rank)throw new wG(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=AX(e,s);if("causal"===i)throw new kG("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=_B({x:l,filter:t,strides:r,pad:"same"===i?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),"channelsFirst"===s&&(l=bB(l,[0,3,1,2])),l}))}function OX(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return wM((()=>{if(null==s&&(s="channelsLast"),eH(s),4!==e.rank&&5!==e.rank)throw new wG(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(4!==t.rank&&5!==t.rank)throw new wG(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let a=RX(e,s);if("causal"===i)throw new kG("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=QP(a,t,r,"same"===i?"same":"valid","NDHWC",o),null!=n&&(a=NH(a,n)),"channelsFirst"===s&&(a=bB(a,[0,4,1,2,3])),a}))}CX.className="Softmax",IL(CX);class DX extends pq{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",DX.verifyArgs(t),this.rank=e,UG(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new kG(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=EX(t.kernelSize,e,"kernelSize"),this.strides=EX(null==t.strides?1:t.strides,e,"strides"),this.padding=null==t.padding?"valid":t.padding,tH(this.padding),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,eH(this.dataFormat),this.activation=dX(t.activation),this.useBias=null==t.useBias||t.useBias,this.biasInitializer=JH(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=_q(t.biasConstraint),this.biasRegularizer=bX(t.biasRegularizer),this.activityRegularizer=bX(t.activityRegularizer),this.dilationRate=EX(null==t.dilationRate?1:t.dilationRate,e,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new wG(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new wG(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new wG(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(e){if(EG("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!BG(e.kernelSize,"number",1,3))throw new wG(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:cX(this.activation),useBias:this.useBias,biasInitializer:QH(this.biasInitializer),biasRegularizer:vX(this.biasRegularizer),activityRegularizer:vX(this.activityRegularizer),biasConstraint:Rq(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class FX extends DX{constructor(e,t){super(e,t),this.kernel=null,FX.verifyArgs(t),this.filters=t.filters,UG(this.filters,"filters"),this.kernelInitializer=JH(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=_q(t.kernelConstraint),this.kernelRegularizer=bX(t.kernelRegularizer)}build(e){e=nq(e);const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new wG(`The channel dimension of the input should be defined. Found ${e[t]}`);const n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return wM((()=>{let t;e=tq(e);const n=null==this.bias?null:this.bias.read(),r=VG(this.activation.getClassName());if(null!=r&&2===this.rank)t=_X(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)t=$X(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=_X(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new kG("convolutions greater than 3D are not implemented yet.");t=OX(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(t=this.activation.apply(t))}return t}))}computeOutputShape(e){e=nq(e);const t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<n.length;++i){const e=TX(n[i],this.kernelSize[i],this.padding,this.strides[i],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[i]);t.push(e)}let r=[e[0]];return"channelsLast"===this.dataFormat?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:QH(this.kernelInitializer),kernelRegularizer:vX(this.kernelRegularizer),kernelConstraint:Rq(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new wG(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class MX extends FX{constructor(e){super(2,e),MX.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!BG(e.kernelSize,"number",1,2))throw new wG(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}MX.className="Conv2D",IL(MX);class LX extends FX{constructor(e){super(3,e),LX.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new wG(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}LX.className="Conv3D",IL(LX);class PX extends MX{constructor(e){if(super(e),this.inputSpec=[new lq({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new wG(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(4!==(e=nq(e)).length)throw new wG("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new wG("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new lq({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return wM((()=>{let t=tq(e);if(4!==t.shape.length)throw new wG(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${t.shape.length}`);const n=t.shape,r=n[0];let i,s;"channelsFirst"===this.dataFormat?(i=2,s=3):(i=1,s=2);const o=n[i],a=n[s],l=this.kernelSize[0],u=this.kernelSize[1],c=this.strides[0],h=this.strides[1],d=[r,NX(o,c,l,this.padding),NX(a,h,u,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=bB(t,[0,2,3,1]));let p=YP(t,this.kernel.read(),d,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=bB(p,[0,3,1,2])),null!=this.bias&&(p=NH(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p}))}computeOutputShape(e){const t=(e=nq(e)).slice();let n,r,i;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3):(n=3,r=1,i=2);const s=this.kernelSize[0],o=this.kernelSize[1],a=this.strides[0],l=this.strides[1];return t[n]=this.filters,t[r]=NX(t[r],a,s,this.padding),t[i]=NX(t[i],l,o,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}PX.className="Conv2DTranspose",IL(PX);class zX extends LX{constructor(e){if(super(e),this.inputSpec=[new lq({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new wG(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(5!==(e=nq(e)).length)throw new wG("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new wG("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new lq({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return wM((()=>{let t=tq(e);if(5!==t.shape.length)throw new wG(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${t.shape.length}`);const n=t.shape,r=n[0];let i,s,o;"channelsFirst"===this.dataFormat?(o=2,i=3,s=4):(o=1,i=2,s=3);const a=n[o],l=n[i],u=n[s],c=this.kernelSize[0],h=this.kernelSize[1],d=this.kernelSize[2],p=this.strides[0],f=this.strides[1],m=this.strides[2],g=[r,NX(a,p,c,this.padding),NX(l,f,h,this.padding),NX(u,m,d,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=bB(t,[0,2,3,4,1]));let v=ZP(t,this.kernel.read(),g,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(v=bB(v,[0,4,1,2,3])),null!==this.bias&&(v=NH(v,this.bias.read(),this.dataFormat)),null!==this.activation&&(v=this.activation.apply(v)),v}))}computeOutputShape(e){const t=(e=nq(e)).slice();let n,r,i,s;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3,s=4):(n=4,r=1,i=2,s=3);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.kernelSize[2],u=this.strides[0],c=this.strides[1],h=this.strides[2];return t[n]=this.filters,t[r]=NX(t[r],u,o,this.padding),t[i]=NX(t[i],c,a,this.padding),t[s]=NX(t[s],h,l,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}zX.className="Conv3DTranspose",IL(zX);class BX extends FX{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new wG("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new wG("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new wG(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=JH(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=bX(t.depthwiseRegularizer),this.depthwiseConstraint=_q(t.depthwiseConstraint),this.pointwiseInitializer=JH(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=bX(t.pointwiseRegularizer),this.pointwiseConstraint=_q(t.pointwiseConstraint)}build(e){if((e=nq(e)).length<this.rank+2)throw new wG(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new wG(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[];for(let o=0;o<this.rank;++o)i.push(1);i.push(n*this.depthMultiplier,this.filters);const s=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,s,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,s,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,s,this.biasConstraint):this.bias=null,this.inputSpec=[new lq({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return wM((()=>{let t;if(e=tq(e),1===this.rank)throw new kG("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=bB(e,[0,2,3,1])),t=Zz(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=NH(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=bB(t,[0,3,1,2])),t}))}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=QH(this.depthwiseInitializer),e.pointwiseInitializer=QH(this.pointwiseInitializer),e.depthwiseRegularizer=vX(this.depthwiseRegularizer),e.pointwiseRegularizer=vX(this.pointwiseRegularizer),e.depthwiseConstraint=Rq(this.depthwiseConstraint),e.pointwiseConstraint=Rq(this.pointwiseConstraint),e}}BX.className="SeparableConv";class UX extends BX{constructor(e){super(2,e)}}UX.className="SeparableConv2D",IL(UX);class WX extends FX{constructor(e){super(1,e),WX.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!BG(e.kernelSize,"number",1,1))throw new wG(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}WX.className="Conv1D",IL(WX);class VX extends pq{constructor(e){super(e),"number"===typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return wM((()=>{if(e=tq(e),"channelsLast"===this.dataFormat){const t=bH(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return bH(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const t=bH(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return bH(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}VX.className="Cropping2D",IL(VX);class jX extends pq{constructor(e){var t;super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,eH(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,t=this.interpolation,zG(XG,"InterpolationFormat",t)}computeOutputShape(e){if("channelsFirst"===this.dataFormat){const t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{const t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return wM((()=>{let t=tq(e);const n=t.shape;if("channelsFirst"===this.dataFormat){t=bB(t,[0,2,3,1]);const e=this.size[0]*n[2],r=this.size[1]*n[3],i="nearest"===this.interpolation?wU.resizeNearestNeighbor(t,[e,r]):wU.resizeBilinear(t,[e,r]);return bB(i,[0,3,1,2])}{const e=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?wU.resizeNearestNeighbor(t,[e,r]):wU.resizeBilinear(t,[e,r])}}))}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}jX.className="UpSampling2D",IL(jX);class GX extends DX{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=JH(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=_q(e.depthwiseConstraint),this.depthwiseRegularizer=bX(e.depthwiseRegularizer)}build(e){if((e=nq(e)).length<4)throw new wG(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new wG(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return wM((()=>{let t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;return wM((()=>{null==i&&(i="channelsLast"),eH(i);let o=AX(e,i);if(4!==e.rank)throw new wG(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(4!==t.rank)throw new wG(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return o=tz(o,t,n,"same"===r?"same":"valid","NHWC",s),"channelsFirst"===i&&(o=bB(o,[0,3,1,2])),o}))}(e=tq(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=NH(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t}))}computeOutputShape(e){e=nq(e);const t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=TX(t,this.kernelSize[0],this.padding,this.strides[0]),s=TX(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,i,s]:[e[0],i,s,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=QH(this.depthwiseInitializer),e.depthwiseRegularizer=vX(this.depthwiseRegularizer),e.depthwiseConstraint=Rq(this.depthwiseRegularizer),e}}function HX(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new wG("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=i(t),constants:n=i(n)}}function qX(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return wM((()=>{const l=t.shape.length;if(l<3)throw new wG(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(dH(2,l));if(t=bB(t,u),null!=s)throw new kG("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&(i=uL(uL(i,"bool"),"float32"),i.rank===l-1&&(i=oz(i,-1)),i=bB(i,u)),r&&(t=Qz(t,0),null!=i&&(i=Qz(i,0)));const c=[];let h,d=n;const p=t.shape[0],f=mB(t);let m,g;null!=i&&(m=mB(i));for(let t=0;t<p;++t){const n=f[t],r=wM((()=>e(n,d)));if(null==i)h=r[0],d=r[1];else{const e=wM((()=>{const e=m[t],n=RL(Uz(e),e);return{output:hL(fL(r[0],e),fL(d[0],n)),newStates:d.map(((t,i)=>hL(fL(r[1][i],e),fL(t,n))))}}));h=e.output,d=e.newStates}a&&c.push(h)}if(a){g=cB(c,1)}return[h,g,d]}))}GX.className="DepthwiseConv2D",IL(GX);class KX extends pq{constructor(e){let t;if(super(e),null==e.cell)throw new wG("cell property is missing for the constructor of RNN.");if(t=Array.isArray(e.cell)?new nY({cells:e.cell}):e.cell,null==t.stateSize)throw new wG("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new lq({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return dH(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((e=>null))}return this.states_}setStates(e){this.states_=e}computeOutputShape(e){ZH(e)&&(e=e[0]);let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const n=t[0];let r;if(r=this.returnSequences?[e[0],e[1],n]:[e[0],n],this.returnState){const n=[];for(const r of t)n.push([e[0],r]);return[r].concat(n)}return r}computeMask(e,t){return wM((()=>{Array.isArray(t)&&(t=t[0]);const e=this.returnSequences?t:null;if(this.returnState){const t=this.states.map((e=>null));return[e].concat(t)}return e}))}get states(){if(null==this.states_){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new kG("Constants support is not implemented in RNN yet.");ZH(e)&&(e=e[0]);const t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new lq({shape:[t,null,...n]});const r=[e[0]].concat(e.slice(2));let i;if(this.cell.build(r),i=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!XR(this.stateSpec.map((e=>e.shape[e.shape.length-1])),i))throw new wG(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map((e=>new lq({shape:[null,e]})));this.stateful&&this.resetStates()}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];wM((()=>{if(!this.stateful)throw new bG("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new wG("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>zz([n,e]))):this.states_=[zz([n,this.cell.stateSize])];else if(null==e)kM(this.states_),null!=this.keptStates&&(kM(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>zz([n,e]))):this.states_[0]=zz([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new wG(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);!0===t?this.keptStates.push(this.states_.slice()):kM(this.states_);for(let t=0;t<this.states_.length;++t){const r=e[t],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,s=[n,i];if(!XR(r.shape,s))throw new wG(`State ${t} is incompatible with layer ${this.name}: expected shape=${s}, received shape=${r.shape}`);this.states_[t]=r}}this.states_=this.states_.map((e=>SM(e.clone())))}))}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const i=HX(e,n,r,this.numConstants);e=i.inputs,n=i.initialState,r=i.constants;let s=[],o=[];if(null!=n){t.initialState=n,s=s.concat(n),this.stateSpec=[];for(const e of n)this.stateSpec.push(new lq({shape:e.shape}));o=o.concat(this.stateSpec)}null!=r&&(t.constants=r,s=s.concat(r),this.numConstants=r.length);if(s[0]instanceof uq){const n=[e].concat(s),r=this.inputSpec.concat(o),i=this.inputSpec;this.inputSpec=r;const a=super.apply(n,t);return this.inputSpec=i,a}return super.apply(e,t)}call(e,t){return wM((()=>{const n=null==t?null:t.mask,r=null==t?null:t.training;let i=null==t?null:t.initialState;e=tq(e),null==i&&(i=this.stateful?this.states_:this.getInitialState(e));const s=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==s)throw new wG(`RNN Layer has ${s} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},a=qX(((e,t)=>{const n=this.cell.call([e].concat(t),o);return[n[0],n.slice(1)]}),e,i,this.goBackwards,n,null,this.unroll,this.returnSequences),l=a[0],u=a[1],c=a[2];this.stateful&&this.resetStates(c,r);const h=this.returnSequences?u:l;return this.returnState?[h].concat(c):h}))}getInitialState(e){return wM((()=>{let t=zz(e.shape);return t=vz(t,[1,2]),t=gH(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((e=>e>1?kH(t,[1,e]):t)):this.cell.stateSize>1?[kH(t,[1,this.cell.stateSize])]:[t]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===KX.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Gq(t.cell,n);return new e(Object.assign(t,{cell:r}))}}KX.className="RNN",IL(KX);class XX extends pq{}class YX extends XX{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,UG(this.units,"units"),this.activation=dX(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=JH(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=JH(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=JH(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=bX(e.kernelRegularizer),this.recurrentRegularizer=bX(e.recurrentRegularizer),this.biasRegularizer=bX(e.biasRegularizer),this.kernelConstraint=_q(e.kernelConstraint),this.recurrentConstraint=_q(e.recurrentConstraint),this.biasConstraint=_q(e.biasConstraint),this.dropout=cH([1,hH([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=cH([1,hH([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=nq(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return wM((()=>{if(2!==e.length)throw new wG(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let n=e[1];e=e[0];const r=null!=t.training&&t.training;let i;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=rY({ones:()=>Uz(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=rY({ones:()=>Uz(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,o=this.recurrentDropoutMask;i=IH(null!=s?fL(e,s):e,this.kernel.read()),null!=this.bias&&(i=NH(i,this.bias.read())),null!=o&&(n=fL(n,o));let a=hL(i,IH(n,this.recurrentKernel.read()));return null!=this.activation&&(a=this.activation.apply(a)),[a,a]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:cX(this.activation),useBias:this.useBias,kernelInitializer:QH(this.kernelInitializer),recurrentInitializer:QH(this.recurrentInitializer),biasInitializer:QH(this.biasInitializer),kernelRegularizer:vX(this.kernelRegularizer),recurrentRegularizer:vX(this.recurrentRegularizer),biasRegularizer:vX(this.biasRegularizer),activityRegularizer:vX(this.activityRegularizer),kernelConstraint:Rq(this.kernelConstraint),recurrentConstraint:Rq(this.recurrentConstraint),biasConstraint:Rq(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}YX.className="SimpleRNNCell",IL(YX);class QX extends KX{constructor(e){e.cell=new YX(e),super(e)}call(e,t){return wM((()=>{null!=this.cell.dropoutMask&&(kM(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(kM(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,i=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})}))}static fromConfig(e,t){return new e(t)}}QX.className="SimpleRNN",IL(QX);class JX extends XX{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new wG("GRUCell does not support reset_after parameter set to true.");this.units=e.units,UG(this.units,"units"),this.activation=dX(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=dX(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=JH(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=JH(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=JH(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=bX(e.kernelRegularizer),this.recurrentRegularizer=bX(e.recurrentRegularizer),this.biasRegularizer=bX(e.biasRegularizer),this.kernelConstraint=_q(e.kernelConstraint),this.recurrentConstraint=_q(e.recurrentConstraint),this.biasConstraint=_q(e.biasConstraint),this.dropout=cH([1,hH([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=cH([1,hH([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){const t=(e=nq(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return wM((()=>{if(2!==e.length)throw new wG(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const n=null!=t.training&&t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=rY({ones:()=>Uz(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=rY({ones:()=>Uz(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,s=this.recurrentDropoutMask;let o,a,l;0<this.dropout&&this.dropout<1&&(e=fL(e,i[0]));let u=IH(e,this.kernel.read());this.useBias&&(u=NH(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=fL(r,s[0]));const c=this.recurrentKernel.read(),[h,d]=lB(c,[2*this.units,this.units],c.rank-1),p=IH(r,h),[f,m,g]=lB(u,3,u.rank-1),[v,y]=lB(p,2,p.rank-1);o=this.recurrentActivation.apply(hL(f,v)),a=this.recurrentActivation.apply(hL(m,y));const b=IH(fL(a,r),d);l=this.activation.apply(hL(g,b));const x=hL(fL(o,r),fL(hL(1,Mz(o)),l));return[x,x]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:cX(this.activation),recurrentActivation:cX(this.recurrentActivation),useBias:this.useBias,kernelInitializer:QH(this.kernelInitializer),recurrentInitializer:QH(this.recurrentInitializer),biasInitializer:QH(this.biasInitializer),kernelRegularizer:vX(this.kernelRegularizer),recurrentRegularizer:vX(this.recurrentRegularizer),biasRegularizer:vX(this.biasRegularizer),activityRegularizer:vX(this.activityRegularizer),kernelConstraint:Rq(this.kernelConstraint),recurrentConstraint:Rq(this.recurrentConstraint),biasConstraint:Rq(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}JX.className="GRUCell",IL(JX);class ZX extends KX{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new JX(e),super(e)}call(e,t){return wM((()=>{null!=this.cell.dropoutMask&&(kM(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(kM(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,i=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}ZX.className="GRU",IL(ZX);class eY extends XX{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,UG(this.units,"units"),this.activation=dX(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=dX(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=JH(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=JH(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=JH(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=bX(e.kernelRegularizer),this.recurrentRegularizer=bX(e.recurrentRegularizer),this.biasRegularizer=bX(e.biasRegularizer),this.kernelConstraint=_q(e.kernelConstraint),this.recurrentConstraint=_q(e.recurrentConstraint),this.biasConstraint=_q(e.biasConstraint),this.dropout=cH([1,hH([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=cH([1,hH([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;const n=(e=nq(e))[e.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const e=this.biasInitializer,n=this.units;r=new((t=class extends OH{apply(t,r){const i=e.apply([n]),s=(new FH).apply([n]),o=e.apply([2*n]);return wH(wH(i,s),o)}}).className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return wM((()=>{const n=null!=t.training&&t.training;if(3!==e.length)throw new wG(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=rY({ones:()=>Uz(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=rY({ones:()=>Uz(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,u,c;0<this.dropout&&this.dropout<1&&(e=fL(e,s[0]));let h=IH(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=fL(r,o[0])),h=hL(h,IH(r,this.recurrentKernel.read())),this.useBias&&(h=NH(h,this.bias.read()));const[d,p,f,m]=lB(h,4,h.rank-1);a=this.recurrentActivation.apply(d),l=this.recurrentActivation.apply(p),u=hL(fL(l,i),fL(a,this.activation.apply(f))),c=this.recurrentActivation.apply(m);const g=fL(c,this.activation.apply(u));return[g,g,u]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:cX(this.activation),recurrentActivation:cX(this.recurrentActivation),useBias:this.useBias,kernelInitializer:QH(this.kernelInitializer),recurrentInitializer:QH(this.recurrentInitializer),biasInitializer:QH(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:vX(this.kernelRegularizer),recurrentRegularizer:vX(this.recurrentRegularizer),biasRegularizer:vX(this.biasRegularizer),activityRegularizer:vX(this.activityRegularizer),kernelConstraint:Rq(this.kernelConstraint),recurrentConstraint:Rq(this.recurrentConstraint),biasConstraint:Rq(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}eY.className="LSTMCell",IL(eY);class tY extends KX{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new eY(e),super(e)}call(e,t){return wM((()=>{null!=this.cell.dropoutMask&&(kM(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(kM(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,i=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}tY.className="LSTM",IL(tY);class nY extends XX{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return wM((()=>{let n=e.slice(1);const r=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?r.push(n.splice(0,e.stateSize.length)):r.push(n.splice(0,1));r.reverse();const i=[];let s;for(let o=0;o<this.cells.length;++o){const a=this.cells[o];n=r[o],s=0===o?[e[0]].concat(n):[s[0]].concat(n),s=a.call(s,t),i.push(s.slice(1))}n=[];for(const e of i.slice().reverse())n.push(...e);return[s[0]].concat(n)}))}build(e){let t;ZH(e)&&(e=e[0]),this.cells.forEach(((n,r)=>{iH(`RNNCell_${r}`,(()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}getConfig(){const e=super.getConfig(),t={cells:this.cells.map((e=>({className:e.getClassName(),config:e.getConfig()})))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];for(const i of t.cells)r.push(Gq(i,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return oq(e)}setWeights(e){const t=[];for(const n of this.cells){const r=n.weights.length,i=e.splice(r);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],i[e]])}aq(t)}}function rY(e){const{ones:t,rate:n,training:r=!1,count:i=1,dropoutFunc:s}=e,o=()=>null!=s?s(t(),n):AH(t(),n),a=()=>RH(o,t,r);if(!i||i<=1)return SM(a().clone());return Array(i).fill(void 0).map(a).map((e=>SM(e.clone())))}nY.className="StackedRNNCells",IL(nY);var iY=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class sY extends KX{constructor(e){if(e.unroll)throw new kG("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new kG("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new lq({ndim:5})]}call(e,t){return wM((()=>{if(null!=this.cell.dropoutMask&&(kM(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(kM(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new wG("ConvRNN2D cell does not support constants");const n=null==t?null:t.mask,r=null==t?null:t.training,i=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})}))}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return wM((()=>{const{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),i=zz([r[0],...r.slice(2)]);return Array.isArray(t)?Array(t.length).fill(i):[i]}))}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];wM((()=>{if(!this.stateful)throw new bG("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)];if(null==n[0])throw new wG("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>zz(i))):this.states_=[zz(i)];else if(null==e)kM(this.states_),null!=this.keptStates&&(kM(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>zz(i))):this.states_[0]=zz(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new wG(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):kM(this.states_);for(let t=0;t<this.states_.length;++t){const n=e[t],r=i;if(!XR(n.shape,r))throw new wG(`State ${t} is incompatible with layer ${this.name}: expected shape=${r}, received shape=${n.shape}`);this.states_[t]=n}}this.states_=this.states_.map((e=>SM(e.clone())))}))}computeSingleOutputShape(e){const{dataFormat:t,filters:n,kernelSize:r,padding:i,strides:s,dilationRate:o}=this.cell,a="channelsFirst"===t,l=e[a?3:2],u=e[a?4:3],c=TX(l,r[0],i,s[0],o[0]),h=TX(u,r[1],i,s[1],o[1]);return[...e.slice(0,2),...a?[n,c,h]:[c,h,n]]}}sY.className="ConvRNN2D";class oY extends eY{constructor(e){const{filters:t,kernelSize:n,strides:r,padding:i,dataFormat:s,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,UG(this.filters,"filters"),this.kernelSize=EX(n,2,"kernelSize"),this.kernelSize.forEach((e=>UG(e,"kernelSize"))),this.strides=EX(r||1,2,"strides"),this.strides.forEach((e=>UG(e,"strides"))),this.padding=i||"valid",tH(this.padding),this.dataFormat=s||"channelsLast",eH(this.dataFormat),this.dilationRate=EX(o||1,2,"dilationRate"),this.dilationRate.forEach((e=>UG(e,"dilationRate")))}build(e){var t;e=nq(e);const n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new wG(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],i=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const s=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",s,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;e=new((t=class extends OH{apply(e,t){return xH([n.apply([r]),Bz([r]),n.apply([2*r])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return wM((()=>{if(3!==e.length)throw new wG(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const n=t.training||!1,r=e[0],i=e[1],s=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=rY({ones:()=>Uz(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=(e,t,n)=>t&&t[n]?fL(t[n],e):e;let l=a(r,o,0),u=a(r,o,1),c=a(r,o,2),h=a(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=rY({ones:()=>Uz(i),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const d=this.recurrentDropoutMask;let p=a(i,d,0),f=a(i,d,1),m=a(i,d,2),g=a(i,d,3);const[v,y,b,x]=lB(this.kernel.read(),4,3),[w,k,S,I]=this.useBias?lB(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,v,w,this.padding),u=this.inputConv(u,y,k,this.padding),c=this.inputConv(c,b,S,this.padding),h=this.inputConv(h,x,I,this.padding);const[C,E,T,N]=lB(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,C),f=this.recurrentConv(f,E),m=this.recurrentConv(m,T),g=this.recurrentConv(g,N);const A=this.recurrentActivation.apply(hL(l,p)),R=this.recurrentActivation.apply(hL(u,f)),$=hL(fL(R,s),fL(A,this.activation.apply(hL(c,m)))),_=fL(this.recurrentActivation.apply(hL(h,g)),this.activation.apply($));return[_,_,$]}))}getConfig(){const e=super.getConfig(),{units:t}=e,n=iY(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,t,n,r){const i=qP(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?NH(i,n,this.dataFormat):i}recurrentConv(e,t){return qP(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}oY.className="ConvLSTM2DCell",IL(oY);class aY extends sY{constructor(e){const t=new oY(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}aY.className="ConvLSTM2D",IL(aY);class lY extends pq{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;const t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}call(e,t){return wM((()=>{this.invokeCallHook(e,t);const n=tq(e);if(0<this.rate&&this.rate<1){const e=null!=t.training&&t.training,r=this.getNoiseShape(n);return RH((()=>AH(n,this.rate,r,this.seed)),(()=>n),e)}return e}))}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}lY.className="Dropout",IL(lY);class uY extends lY{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}uY.className="SpatialDropout1D",IL(uY);class cY extends pq{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,UG(this.units,"units"),this.activation=dX(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=JH(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=JH(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=_q(e.kernelConstraint),this.biasConstraint=_q(e.biasConstraint),this.kernelRegularizer=bX(e.kernelRegularizer),this.biasRegularizer=bX(e.biasRegularizer),this.activityRegularizer=bX(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){const t=(e=nq(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){const t=(e=nq(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return wM((()=>{this.invokeCallHook(e,t);const n=tq(e),r=VG(this.activation.getClassName());let i;return null!=r?i=IH(n,this.kernel.read(),r,this.bias?this.bias.read():null):(i=IH(n,this.kernel.read()),null!=this.bias&&(i=NH(i,this.bias.read())),null!=this.activation&&(i=this.activation.apply(i))),i}))}getConfig(){const e={units:this.units,activation:cX(this.activation),useBias:this.useBias,kernelInitializer:QH(this.kernelInitializer),biasInitializer:QH(this.biasInitializer),kernelRegularizer:vX(this.kernelRegularizer),biasRegularizer:vX(this.biasRegularizer),activityRegularizer:vX(this.activityRegularizer),kernelConstraint:Rq(this.kernelConstraint),biasConstraint:Rq(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}cY.className="Dense",IL(cY);class hY extends pq{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=nq(e);for(const t of e.slice(1))if(null==t)throw new wG(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],uH(e,1)]}call(e,t){return wM((()=>{this.invokeCallHook(e,t);let n=tq(e);if("channelsFirst"===this.dataFormat&&n.rank>1){const e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=bB(n,e)}return function(e){if(e.rank<=1)throw new wG(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);const t=[e.shape[0],uH(e.shape,1)];return OP(e,t)}(n)}))}getConfig(){const e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}hY.className="Flatten",IL(hY);class dY extends pq{constructor(e){super(e),this.supportsMasking=!0,this.activation=dX(e.activation)}call(e,t){return wM((()=>{this.invokeCallHook(e,t);const n=tq(e);return this.activation.apply(n)}))}getConfig(){const e={activation:cX(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}dY.className="Activation",IL(dY);class pY extends pq{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return wM((()=>{return e=tq(e),t=e,n=this.n,wM((()=>{if(2!==t.shape.length)throw new wG(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);return kH(gH(t,1),[1,n,1])}));var t,n}))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}pY.className="RepeatVector",IL(pY);class fY extends pq{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){const n="Total size of new array must be unchanged.",r=t.slice();let i=1,s=null;for(let a=0;a<r.length;++a){const e=r[a];if(this.isUnknown(e)){if(null!==s)throw new wG("Can only specifiy one unknown dimension.");s=a}else i*=e}const o=uH(e);if(null!==s){if(0===i||o%i!==0)throw new wG(n);r[s]=o/i}else if(o!==i)throw new wG(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return wM((()=>{this.invokeCallHook(e,t);const n=tq(e),r=n.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return OP(n,i)}))}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}fY.className="Reshape",IL(fY);class mY extends pq{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=dH(1,e.dims.length+1);if(!XR(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new lq({ndim:this.dims.length+1})]}computeOutputShape(e){const t=(e=nq(e)).slice();return this.dims.forEach(((n,r)=>{t[r+1]=e[n]})),t}call(e,t){return bB(tq(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}mY.className="Permute",IL(mY);class gY extends pq{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const n=tq(e);return gP(Lz(n,this.maskValue),-1)}call(e,t){return wM((()=>{this.invokeCallHook(e,t);const n=tq(e),r=gP(Lz(n,this.maskValue),-1,!0);return fL(n,uL(r,n.dtype))}))}}gY.className="Masking",IL(gY);class vY extends pq{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(AG(e.inputLength))}this.inputDim=e.inputDim,UG(this.inputDim,"inputDim"),this.outputDim=e.outputDim,UG(this.outputDim,"outputDim"),this.embeddingsInitializer=JH(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=bX(e.embeddingsRegularizer),this.activityRegularizer=bX(e.activityRegularizer),this.embeddingsConstraint=_q(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return wM((()=>this.maskZero?(e=tq(e),Lz(e,vL(e))):null))}computeOutputShape(e){if(e=nq(e),null==this.inputLength)return[...e,this.outputDim];const t=AG(this.inputLength);if(t.length!==e.length-1)throw new wG(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let n=0;for(let r=0;r<t.length;++r){const i=t[r],s=e[r+1];if(null!=i&&null!=s&&i!==s)throw new wG(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);null==i&&(t[n]=s),n++}}return[e[0],...t,this.outputDim]}call(e,t){return wM((()=>{this.invokeCallHook(e,t);let n=tq(e);"int32"!==n.dtype&&(n=mH(n,"int32"));const r=CH(this.embeddings.read(),OP(n,[n.size]));return OP(r,nq(this.computeOutputShape(n.shape)))}))}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:QH(this.embeddingsInitializer),embeddingsRegularizer:vX(this.embeddingsRegularizer),activityRegularizer:vX(this.activityRegularizer),embeddingsConstraint:Rq(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}vY.className="Embedding",IL(vY);class yY extends pq{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new kG}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;const n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const i=e[e.length-t.length+r],s=t[r];if(null==i||null==s||i<0||s<0)n.push(null);else if(1===i)n.push(s);else if(1===s)n.push(i);else{if(i!==s)throw new wG("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(i)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[nq(e)]),e.length<2)throw new wG(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const i of e)null!=i&&null!==i[0]&&t.push(i[0]);if(t=LG(t),t.length>1)throw new wG(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let n=null==e[0]?null:e[0].slice(1);for(let i=1;i<e.length;++i){const t=null==e[i]?null:e[i].slice(1);n=this.computeElementwiseOpOutputShape(n,t)}const r=e.map((e=>e.length));-1===e.indexOf(null)&&1===LG(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return wM((()=>{if(this.reshapeRequired){const t=[],n=e.map((e=>e.rank));if(-1===n.indexOf(null)){const r=hH(n);for(let n of e){const e=n.rank;for(let t=0;t<r-e;++t)n=gH(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(const s of e){const e=s.rank;if(null==e){const e=s.shape,r=e[0],i=e.slice(1).concat([r]);let o=OP(s,[r].concat(uH(e.slice(1))));o=bB(o,[1,0]),o=OP(o,i),t.push(o),n=!0}else if(e>1){const r=dH(1,e).concat([0]);t.push(bB(s,r)),n=!0}else t.push(s)}let r=this.mergeFunction(t);const i=r.rank;if(n)if(null==i){const e=r.shape,t=e[e.length-1],n=[t].concat(e.slice(0,e.length-1));r=OP(bB(OP(r,[-1,t]),[1,0]),n)}else if(i>1){const e=[i-1].concat(dH(0,i-1));r=bB(r,e)}return r}}return this.mergeFunction(e)}))}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let r=1;r<e.length;++r){const n=null==e[r]?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}let n=[];for(const r of e)null!=r&&null!==r[0]&&n.push(r[0]);return n=LG(n),t=1===n.length?n.concat(t):[null].concat(t),t}computeMask(e,t){return wM((()=>{if(null==t)return null;if(!Array.isArray(t))throw new wG("`mask` should be an Array");if(!Array.isArray(e))throw new wG("`inputs` should be an Array");if(t.length!==e.length)throw new wG(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every((e=>null==e)))return null;let n=(t=t.map((e=>null==e?e:oz(e,0))))[0];for(let e=1;e<t.length-1;++e)n=Nz(n,t[e]);return n}))}}class bY extends yY{constructor(e){super(e)}mergeFunction(e){return wM((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=hL(t,e[n]);return t}))}}bY.className="Add",IL(bY);class xY extends yY{constructor(e){super(e)}mergeFunction(e){return wM((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=fL(t,e[n]);return t}))}}xY.className="Multiply",IL(xY);class wY extends yY{constructor(e){super(e)}mergeFunction(e){return wM((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=hL(t,e[n]);return fL(1/e.length,t)}))}}wY.className="Average",IL(wY);class kY extends yY{constructor(e){super(e)}mergeFunction(e){return wM((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=ML(t,e[n]);return t}))}}kY.className="Maximum",IL(kY);class SY extends yY{constructor(e){super(e)}mergeFunction(e){return wM((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Dz(t,e[n]);return t}))}}SY.className="Minimum",IL(SY);class IY extends yY{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new wG("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(const r of e)if(null!=r){t=!1;break}if(t)return;const n=[];for(let r=0;r<e.length;++r){const t=e[r].slice();t.splice(this.axis,1);let i=!1;for(const e of n)if(XR(e,t)){i=!0;break}i||n.push(t)}if(n.length>1)throw new wG("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return wM((()=>xH(e,this.axis)))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new wG("A `Concatenate` layer should be called on a list of inputs.");const t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const i of t.slice(1)){if(null==n[r]||null==i[r]){n[r]=null;break}n[r]+=i[r]}return n}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new wG("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new wG("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new wG(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return wM((()=>{let n=!0;if(t.forEach((e=>{null==e||(n=!1)})),n)return null;const r=[];for(let s=0;s<e.length;++s)null==t[s]?r.push(uL(Uz(e[s]),"bool")):t[s].rank<e[s].rank?r.push(oz(t[s],-1)):r.push(t[s]);const i=WP(r,this.axis);return mP(i,-1,!1)}))}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function CY(e,t){for(;e<0;)e+=t;return e}IY.className="Concatenate",IL(IY);class EY extends yY{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){GR(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const t=e[0],n=e[1];if(t.length>3||n.length>3)throw new kG("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new wG(`Dimension incompatibility: ${t[r[0]]} !== ${n[r[1]]}`)}mergeFunction(e){if(2!==e.length)throw new wG(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map(((t,n)=>CY(t,e[n].shape.length))):[CY(this.axes,n.shape.length),CY(this.axes,r.shape.length)],this.normalize&&(n=Hq(n,t[0]),r=Hq(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new kG("batchDot is not implemented for tensors of 4D or higher rank yet");if(GR(e.shape.length>=2,(()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`)),GR(e.shape.length>=2,(()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`)),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new kG("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,i=t.shape.length;null==n&&(n=[r-1,i-2]);const s=n;return wM((()=>{let n,o;if(r>i){n=r-i;const e=[];for(let t=0;t<n;++t)e.push(1);t=OP(t,t.shape.concat(e))}else if(i>r){n=i-r;const t=[];for(let e=0;e<n;++e)t.push(1);e=OP(e,e.shape.concat(t))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=s[0]===s[1]?vz(fL(e,t),s[0]):vz(fL(bB(e,[1,0]),t),s[1]);else{const n=s[0]!==e.shape.length-1,r=s[1]===t.shape.length-1;o=Az(e,t,n,r)}if(n>0){let e;e=r>i?r+i-3:r-1;const t=[];for(let r=e;r<e+n;++r)t.push(r);o=uB(o,t)}return 1===o.shape.length&&(o=oz(o,1)),o}))}(n,r,t)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[CY(this.axes,e.length),CY(this.axes,t.length)],n}computeOutputShape(e){GR(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new kG("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const i=t.concat(n);return 1===i.length&&i.push(1),i}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}EY.className="Dot",IL(EY);class TY extends pq{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return wM((()=>{this.invokeCallHook(e,t);const n=tq(e);return RH((()=>hL(SH(n.shape,0,this.stddev),n)),(()=>n),t.training||!1)}))}}TY.className="GaussianNoise",IL(TY);class NY extends pq{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return wM((()=>{this.invokeCallHook(e,t);const n=tq(e);if(this.rate>0&&this.rate<1){return RH((()=>{const e=Math.sqrt(this.rate/(1-this.rate));return fL(n,SH(n.shape,1,e))}),(()=>n),t.training||!1)}return n}))}}NY.className="GaussianDropout",IL(NY);class AY extends pq{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||tq(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return wM((()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(e),r=()=>{const t=tq(e),r=-1.7580993408473766;let i=dz(Kz(n),this.rate);i=mH(i,"float32");const s=((1-this.rate)*(1+this.rate*r**2))**-.5,o=-s*r*this.rate,a=hL(fL(t,i),fL(hL(i,-1),r));return hL(fL(a,s),o)};return RH(r,(()=>tq(e)),t.training||!1)}return e}))}}function RY(e,t,n,r,i){let s,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)s=LP(e,t,n,r,i,o);else if(3===e.rank)s=PP(e,t,n,r,i,o);else{if(4!==e.rank)throw new kG(`batchNormalization is not implemented for array of rank ${e.rank} yet`);s=zP(e,t,n,r,i,o)}return s}function $Y(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return XR(r.slice().sort(),dH(0,e.rank-1))?function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return wM((()=>{const s=Fz(e,r),o=s.mean,a=s.variance;return[RY(e,o,a,n,t,i),o,a]}))}(e,t,n,r,i):function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return wM((()=>{const s=Fz(e,r),o=s.mean,a=s.variance,l=[];for(const t of dH(0,e.rank))-1!==r.indexOf(t)?l.push(1):l.push(e.shape[t]);const u=OP(o,l),c=OP(a,l),h=null==t?null:OP(t,l),d=null==n?null:OP(n,l);return[RY(e,u,c,d,h,i),o,a]}))}(e,t,n,r,i)}AY.className="AlphaDropout",IL(AY);class _Y extends pq{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=JH(e.betaInitializer||"zeros"),this.gammaInitializer=JH(e.gammaInitializer||"ones"),this.movingMeanInitializer=JH(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=JH(e.movingVarianceInitializer||"ones"),this.betaConstraint=_q(e.betaConstraint),this.gammaConstraint=_q(e.gammaConstraint),this.betaRegularizer=bX(e.betaRegularizer),this.gammaRegularizer=bX(e.gammaRegularizer)}build(e){e=nq(e);const t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new wG(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new lq({ndim:e.length,axes:{[t]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return wM((()=>{const n=null!=t.training&&t.training,r=tq(e),i=r.shape,s=i.length,o=dH(0,s),a=this.axis>=0?this.axis:this.axis+s;o.splice(a,1);const l=CG(1,s);l[a]=i[a];const u=o.slice();u.sort();const c=!XR(u,dH(0,s).slice(0,s-1));if(!n)return(()=>{if(c){const e=OP(this.movingMean.read(),l),t=OP(this.movingVariance.read(),l),n=this.center?OP(this.beta.read(),l):null,i=this.scale?OP(this.gamma.read(),l):null;return RY(r,e,t,n,i,this.epsilon)}return RY(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[h,d,p]=$Y(r,this.gamma.read(),this.beta.read(),o,this.epsilon),f=(e,t,n)=>{wM((()=>{const r=1-n,i=e.read(),s=fL(RL(i,t),r);e.write(RL(i,s))}))};return(()=>{f(this.movingMean,d,this.momentum),f(this.movingVariance,p,this.momentum)})(),h}))}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:QH(this.betaInitializer),gammaInitializer:QH(this.gammaInitializer),movingMeanInitializer:QH(this.movingMeanInitializer),movingVarianceInitializer:QH(this.movingVarianceInitializer),betaRegularizer:vX(this.betaRegularizer),gammaRegularizer:vX(this.gammaRegularizer),betaConstraint:Rq(this.betaConstraint),gammaConstraint:Rq(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}_Y.className="BatchNormalization",IL(_Y);class OY extends pq{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);for(const e of this.axis)if(!Number.isInteger(e))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=JH(e.betaInitializer||"zeros"),this.gammaInitializer=JH(e.gammaInitializer||"ones"),this.betaRegularizer=bX(e.betaRegularizer),this.gammaRegularizer=bX(e.gammaRegularizer),this.supportsMasking=!0}build(e){const t=(e=nq(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=t);for(const i of this.axis)if(i<0||i>=t)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==LG(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const n=this.axis.map((t=>e[t])),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const n=tq(e),r=n.shape,i=r.length;return wM((()=>{let{mean:e,variance:t}=Fz(n,this.axis,!0);const s=CG(1,i);for(const n of this.axis)s[n]=r[n];const o=e=>null!=e&&e.shape.length!==i?OP(e,s):e;let a=this.scale?o(this.gamma.read()):null,l=this.center?o(this.beta.read()):null;const u=[],c=[];for(let n=0;n<i;++n)-1!==this.axis.indexOf(n)?(u.push(r[n]),c.push(1)):(u.push(1),c.push(r[n]));return e=az(e,u),t=az(t,u),null!=a&&(a=az(a,c)),null!=l&&(l=az(l,c)),RY(n,e,t,l,a,this.epsilon)}))}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:QH(this.betaInitializer),gammaInitializer:QH(this.gammaInitializer),betaRegularizer:vX(this.betaRegularizer),gammaRegularizer:vX(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}OY.className="LayerNormalization",IL(OY);class DY extends pq{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new wG(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,n;if("number"===typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new wG(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],2!==e.padding[1].length)throw new wG(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new lq({ndim:4})]}computeOutputShape(e){let t,n;return e=nq(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return wM((()=>{return t=tq(e),n=this.padding,r=this.dataFormat,wM((()=>{if(4!==t.rank)throw new wG(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new wG("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==r&&(r="channelsLast"),"channelsLast"!==r&&"channelsFirst"!==r)throw new wG(`Unknown data format: ${r}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let e;return e="channelsFirst"===r?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],Wz(t,e)}));var t,n,r}))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}function FY(e,t,n,r,i,s){return wM((()=>{let o;eH(i),nH(s),tH(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==s&&(s="max"),e=AX(e,i);const a="same"===r?"same":"valid";return o="max"===s?Rz(e,t,n,a):DP(e,t,n,a),"channelsFirst"===i&&(o=bB(o,[0,3,1,2])),o}))}function MY(e,t,n,r,i,s){return wM((()=>{let o;eH(i),nH(s),tH(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==s&&(s="max"),e=RX(e,i);const a="same"===r?"same":"valid";return o="max"===s?$z(e,t,n,a):FP(e,t,n,a),"channelsFirst"===i&&(o=bB(o,[0,4,1,2,3])),o}))}DY.className="ZeroPadding2D",IL(DY);class LY extends pq{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"===typeof e.poolSize)this.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new wG(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);this.poolSize=e.poolSize}if(UG(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"===typeof e.strides)this.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new wG(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);this.strides=e.strides}UG(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,tH(this.padding),this.inputSpec=[new lq({ndim:3})]}computeOutputShape(e){const t=TX((e=nq(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return wM((()=>{this.invokeCallHook(e,t),e=gH(tq(e),2);const n=this.poolingFunction(tq(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return uB(n,[2])}))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class PY extends LY{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return eH(i),tH(r),FY(e,t,n,r,i,"max")}}PY.className="MaxPooling1D",IL(PY);class zY extends LY{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return eH(i),tH(r),FY(e,t,n,r,i,"avg")}}zY.className="AveragePooling1D",IL(zY);class BY extends pq{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new wG(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];UG(this.poolSize,"poolSize"),UG(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,eH(this.dataFormat),tH(this.padding),this.inputSpec=[new lq({ndim:4})]}computeOutputShape(e){e=nq(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=TX(t,this.poolSize[0],this.padding,this.strides[0]),n=TX(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return wM((()=>(this.invokeCallHook(e,t),this.poolingFunction(tq(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class UY extends BY{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return eH(i),tH(r),FY(e,t,n,r,i,"max")}}UY.className="MaxPooling2D",IL(UY);class WY extends BY{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return eH(i),tH(r),FY(e,t,n,r,i,"avg")}}WY.className="AveragePooling2D",IL(WY);class VY extends pq{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new wG(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];UG(this.poolSize,"poolSize"),UG(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,eH(this.dataFormat),tH(this.padding),this.inputSpec=[new lq({ndim:5})]}computeOutputShape(e){e=nq(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=TX(t,this.poolSize[0],this.padding,this.strides[0]),n=TX(n,this.poolSize[1],this.padding,this.strides[1]),r=TX(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return wM((()=>(this.invokeCallHook(e,t),this.poolingFunction(tq(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class jY extends VY{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return eH(i),tH(r),MY(e,t,n,r,i,"max")}}jY.className="MaxPooling3D",IL(jY);class GY extends VY{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return eH(i),tH(r),MY(e,t,n,r,i,"avg")}}GY.className="AveragePooling3D",IL(GY);class HY extends pq{constructor(e){super(e),this.inputSpec=[new lq({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new kG}}class qY extends HY{constructor(e){super(e||{})}call(e,t){return wM((()=>{const t=tq(e);return _z(t,1)}))}}qY.className="GlobalAveragePooling1D",IL(qY);class KY extends HY{constructor(e){super(e||{})}call(e,t){return wM((()=>{const t=tq(e);return gz(t,1)}))}}KY.className="GlobalMaxPooling1D",IL(KY);class XY extends pq{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,eH(this.dataFormat),this.inputSpec=[new lq({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new kG}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class YY extends XY{call(e,t){return wM((()=>{const t=tq(e);return"channelsLast"===this.dataFormat?_z(t,[1,2]):_z(t,[2,3])}))}}YY.className="GlobalAveragePooling2D",IL(YY);class QY extends XY{call(e,t){return wM((()=>{const t=tq(e);return"channelsLast"===this.dataFormat?gz(t,[1,2]):gz(t,[2,3])}))}}QY.className="GlobalMaxPooling2D",IL(QY);class JY extends pq{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Gq(t.layer,n);delete t.layer;const i={layer:r};return Object.assign(i,t),new e(i)}}class ZY extends JY{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=nq(e)).length<3)throw new wG(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){const t=[(e=nq(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return wM((()=>qX(((e,n)=>[tq(this.layer.call(e,t)),[]]),e=tq(e),[],!1,null,null,!1,!0)[1]))}}ZY.className="TimeDistributed",IL(ZY);class eQ extends JY{constructor(e){super(e);const t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=Gq(n),t.goBackwards=!0!==t.goBackwards;const r={};var i;if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=Gq(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,i=this.mergeMode,zG(JG,"BidirectionalMergeMode",i),e.weights)throw new kG("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,r,i=this.forwardLayer.computeOutputShape(e);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),this.returnState?(r=i.slice(1),t=i[0]):t=i[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):NG(n)}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const i=HX(e,n,r,this.numConstants);if(e=i.inputs,n=i.initialState,r=i.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==r)return super.apply(e,t);const s=[],o=[];if(null!=n){const e=n.length;if(e%2>0)throw new wG("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,s.push(...n);const r=n.map((e=>new lq({shape:e.shape})));this.forwardLayer.stateSpec=r.slice(0,e/2),this.backwardLayer.stateSpec=r.slice(e/2),o.push(...r)}if(null!=r)throw new kG("Support for constants in Bidirectional layers is not implemented yet.");const a=s[0]instanceof uq;for(const l of s)if(l instanceof uq!==a)throw new wG("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(a){const n=[e].concat(s),r=this.inputSpec.concat(o),i=this.inputSpec;this.inputSpec=r;const a=super.apply(n,t);return this.inputSpec=i,a}return super.apply(e,t)}call(e,t){return wM((()=>{const n=t.initialState;let r,i,s,o;if(null==n)r=this.forwardLayer.call(e,t),i=this.backwardLayer.call(e,t);else{const s=n.slice(0,n.length/2),o=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:s})),i=this.backwardLayer.call(e,Object.assign(t,{initialState:o}))}return this.returnState&&(Array.isArray(r)&&(s=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=Qz(i,1)),"concat"===this.mergeMode?o=xH([r,i]):"sum"===this.mergeMode?o=hL(r,i):"ave"===this.mergeMode?o=fL(.5,hL(r,i)):"mul"===this.mergeMode?o=fL(r,i):null==this.mergeMode&&(o=[r,i]),this.returnState?null==this.mergeMode?o.concat(s):[o].concat(s):o}))}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){iH(this.forwardLayer.name,(()=>{this.forwardLayer.build(e)})),iH(this.backwardLayer.name,(()=>{this.backwardLayer.build(e)})),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){const e=this.forwardLayer.states.map((e=>null));return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const n=Gq(t.layer);if(delete t.layer,null!=t.numConstants)throw new kG("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=n,new e(r)}}eQ.className="Bidirectional",IL(eQ);class tQ extends pq{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return wM((()=>("float32"!==(e=tq(e)).dtype&&(e=mH(e,"float32")),hL(fL(e,this.scale),this.offset))))}}tQ.className="Rescaling",IL(tQ);const{resizeBilinear:nQ,cropAndResize:rQ}=wU;class iQ extends pq{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,i,s,o,a){return wM((()=>{let l,u=!1;const c=[t/s,n/o,(r+t)/s,(i+n)/o],h=[];3===e.rank?(u=!0,l=cB([e])):l=e;for(let e=0;e<l.shape[0];e++)h.push(c);const d=vM(h,[h.length,4]),p=Xz(0,h.length,1,"int32"),f=rQ(l,d,p,[r,i],"nearest");return mH(u?tq(mB(f)):f,a)}))}upsize(e,t,n,r){return wM((()=>mH(nQ(e,[t,n]),r)))}call(e,t){return wM((()=>{const t=tq(e),n=t.dtype,r=t.shape,i=r[r.length-3],s=r[r.length-2];let o=0;i!==this.height&&(o=Math.floor((i-this.height)/2));let a=0;return s!==this.width&&(a=Math.floor((s-this.width)/2),0===a&&(a=1)),o>=0&&a>=0?this.centerCrop(t,o,a,this.height,this.width,i,s,n):this.upsize(e,this.height,this.width,n)}))}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=nq(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}iQ.className="CenterCrop",IL(iQ);class sQ extends pq{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return null==(e=nq(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return wM((()=>{let n;if("int32"!==(e=tq(e)).dtype&&(e=mH(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==this.outputMode)throw new wG(`countWeights is not used when outputMode !== count.\n              Received countWeights=${t.countWeights}`);n=tq(t.countWeights)}const r=gz(e),i=Oz(e),s=hz(this.numTokens,r).bufferSync().get(0),o=dz(i,0).bufferSync().get(0);if(!s||!o)throw new wG(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return function(e,t,n,r){let i=tq(e);if("int32"!==i.dtype&&(i=mH(i,"int32")),"int"===t)return i;const s=i.shape;if(0===i.rank&&(i=oz(i,-1)),"oneHot"===t&&1!==i.shape[i.shape.length-1]&&(i=oz(i,-1)),i.rank>2)throw new wG(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${s} which would result in output rank ${i.rank}.`);const o=["multiHot","oneHot"].includes(t);let a;if(a=ez(i,"undefined"!==typeof r&&"count"===t?r:[],n,o),"tfIdf"!==t)return a;if(r)return fL(a,r);throw new wG("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)}))}}sQ.className="CategoryEncoding",IL(sQ);const oQ=new Set(["bilinear","nearest"]);class aQ extends pq{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!oQ.has(e.interpolation))throw new wG(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){const t=(e=nq(e))[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return wM((()=>{const t=[this.height,this.width];if("bilinear"===this.interpolation)return wU.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return wU.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...oQ]} are supported`)}))}}aQ.className="Resizing",IL(aQ);class lQ{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}}lQ.className="RandomSeed";class uQ extends pq{constructor(e){super(e),this.randomGenerator=new lQ(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}uQ.className="BaseRandomLayer";const cQ=new Set(["bilinear","nearest"]);class hQ extends uQ{constructor(e){super(e);const{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new wG(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new wG(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new wG(`factor cannot have upper bound less than lower bound.\n        Got upper bound: ${this.widthUpper}.\n        Got lower bound: ${this.widthLower}\n      `);if(n){if(!cQ.has(n))throw new wG(`Invalid interpolation parameter: ${n} is not implemented`);this.interpolation=n}}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=nq(e))[2];return[this.imgHeight,-1,t]}call(e,t){return wM((()=>{const t=tq(e);this.imgHeight=t.shape[t.shape.length-3];const n=t.shape[t.shape.length-2];this.widthFactor=Kz([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*n;r=Math.round(r);const i=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return wU.resizeBilinear(e,i);case"nearest":return wU.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}\n          but only ${[...cQ]} are supported`)}}))}}hQ.className="RandomWidth",IL(hQ);var dQ,pQ,fQ;C$().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),(pQ=dQ||(dQ={}))[pQ.DT_INVALID=0]="DT_INVALID",pQ[pQ.DT_FLOAT=1]="DT_FLOAT",pQ[pQ.DT_DOUBLE=2]="DT_DOUBLE",pQ[pQ.DT_INT32=3]="DT_INT32",pQ[pQ.DT_UINT8=4]="DT_UINT8",pQ[pQ.DT_INT16=5]="DT_INT16",pQ[pQ.DT_INT8=6]="DT_INT8",pQ[pQ.DT_STRING=7]="DT_STRING",pQ[pQ.DT_COMPLEX64=8]="DT_COMPLEX64",pQ[pQ.DT_INT64=9]="DT_INT64",pQ[pQ.DT_BOOL=10]="DT_BOOL",pQ[pQ.DT_QINT8=11]="DT_QINT8",pQ[pQ.DT_QUINT8=12]="DT_QUINT8",pQ[pQ.DT_QINT32=13]="DT_QINT32",pQ[pQ.DT_BFLOAT16=14]="DT_BFLOAT16",pQ[pQ.DT_QINT16=15]="DT_QINT16",pQ[pQ.DT_QUINT16=16]="DT_QUINT16",pQ[pQ.DT_UINT16=17]="DT_UINT16",pQ[pQ.DT_COMPLEX128=18]="DT_COMPLEX128",pQ[pQ.DT_HALF=19]="DT_HALF",pQ[pQ.DT_RESOURCE=20]="DT_RESOURCE",pQ[pQ.DT_VARIANT=21]="DT_VARIANT",pQ[pQ.DT_UINT32=22]="DT_UINT32",pQ[pQ.DT_UINT64=23]="DT_UINT64",pQ[pQ.DT_FLOAT_REF=101]="DT_FLOAT_REF",pQ[pQ.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",pQ[pQ.DT_INT32_REF=103]="DT_INT32_REF",pQ[pQ.DT_UINT8_REF=104]="DT_UINT8_REF",pQ[pQ.DT_INT16_REF=105]="DT_INT16_REF",pQ[pQ.DT_INT8_REF=106]="DT_INT8_REF",pQ[pQ.DT_STRING_REF=107]="DT_STRING_REF",pQ[pQ.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",pQ[pQ.DT_INT64_REF=109]="DT_INT64_REF",pQ[pQ.DT_BOOL_REF=110]="DT_BOOL_REF",pQ[pQ.DT_QINT8_REF=111]="DT_QINT8_REF",pQ[pQ.DT_QUINT8_REF=112]="DT_QUINT8_REF",pQ[pQ.DT_QINT32_REF=113]="DT_QINT32_REF",pQ[pQ.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",pQ[pQ.DT_QINT16_REF=115]="DT_QINT16_REF",pQ[pQ.DT_QUINT16_REF=116]="DT_QUINT16_REF",pQ[pQ.DT_UINT16_REF=117]="DT_UINT16_REF",pQ[pQ.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",pQ[pQ.DT_HALF_REF=119]="DT_HALF_REF",pQ[pQ.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",pQ[pQ.DT_VARIANT_REF=121]="DT_VARIANT_REF",pQ[pQ.DT_UINT32_REF=122]="DT_UINT32_REF",pQ[pQ.DT_UINT64_REF=123]="DT_UINT64_REF",function(e){let t;!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(fQ||(fQ={}));Error;new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function mQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);const i=t(e);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(bQ(e)){const i=Array.isArray(e)?[]:{};r.add(e);for(const s in e){const o=mQ(e[s],t,n,r);i[s]=o}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}throw new Error(`Can't recurse into non-iterable type: ${e}`)}return n.set(e,i.value),i.value}function gQ(e){return vQ(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:yQ)}function vQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");const i=t(e);if(i.recurse&&null!==i.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(bQ(r)){const i=Array.isArray(r)?[]:{};n.add(r);for(const s in r){const r=vQ(e.map((e=>e[s])),t,n);i[s]=r}return n.delete(r),i}throw new Error(`Can't recurse into non-iterable type: ${r}`)}return i.value}function yQ(e){return null===e?null:bQ(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function bQ(e){let t=!1;if(C$().get("IS_BROWSER"))t=e instanceof TextDecoder;else{const{StringDecoder:r}=n(551);t=e instanceof r}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof $F)&&!(e instanceof Promise)&&!t)}function xQ(e){return mQ(e,wQ)}function wQ(e){return e instanceof $F?{value:e.clone(),recurse:!1}:bQ(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}class kQ{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}class SQ extends kQ{constructor(){super(SQ.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=2*this.capacity,t=new Array(e),n=this.length();for(let r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function IQ(e){return new NQ(e)}function CQ(e,t){return new zQ(e,t)}SQ.INITIAL_CAPACITY=32;class EQ{async toArray(){const e=[];let t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),t=[];let n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new FQ(this,e)}filter(e){return new OQ(this,e)}map(e){return new DQ(this,e)}mapAsync(e){return new MQ(this,e)}serialMapAsync(e){return new MQ(this,e).serial()}flatmap(e){return new PQ(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile((e=>!0===e))}rowMajorBatch(e){return new _Q(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yQ;return this.rowMajorBatch(e,t).map((e=>gQ(e,n)))}concatenate(e,t){return new zQ(new TQ([this,e]),t)}take(e){return e<0||null==e?this:new $Q(this,e)}skip(e){return e<0||null==e?this:new RQ(this,e)}prefetch(e){return new UQ(this,e)}shuffle(e,t){return new WQ(this,e,t)}serial(){return new AQ(this)}}class TQ extends EQ{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:xQ(e),done:!1}}}class NQ extends EQ{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(dae){throw dae.message=`Error thrown while iterating through a dataset: ${dae.message}`,dae}}}class AQ extends EQ{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){return this.upstream.next()}}class RQ extends EQ{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;kM(e.value)}return this.upstream.next()}}class $Q extends EQ{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class _Q extends EQ{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}}class OQ extends EQ{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;kM(e.value)}}}class DQ extends EQ{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=QF(e.value),n=this.transform(e.value),r=QF(n);for(const i of t)YF(i,r)||i.dispose();return{value:n,done:!1}}}class FQ extends EQ{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(dae){if(!this.handler(dae))return{value:null,done:!0}}}}class MQ extends EQ{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=QF(e.value),n=await this.transform(e.value),r=QF(n);for(const i of t)YF(i,r)||i.dispose();return{value:n,done:!1}}}class LQ extends EQ{constructor(){super(),this.outputQueue=new SQ,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class PQ extends LQ{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const e=await this.upstream.next();if(e.done)return!1;const t=QF(e.value),n=this.transform(e.value),r=QF(n);this.outputQueue.pushAll(n);for(const i of t)YF(i,r)||i.dispose();return!0}}class zQ extends EQ{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){const e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}}var BQ;!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(BQ||(BQ={}));class UQ extends EQ{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new kQ(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class WQ extends UQ{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=jz.alea(n||fF().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}}class VQ{constructor(){this.size=null}batch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this;let r;return GR(e>0,(()=>`batchSize needs to be positive, but it is\n      ${e}`)),r=this.size===1/0||null==this.size?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e),jQ((async()=>(await n.iterator()).columnMajorBatch(e,t,GQ)),r)}concatenate(e){const t=this;let n;return n=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,jQ((async()=>(await t.iterator()).concatenate(await e.iterator())),n)}filter(e){const t=this;let n;return n=this.size===1/0?1/0:null,jQ((async()=>(await t.iterator()).filter((t=>wM((()=>e(t)))))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const t=this;return jQ((async()=>(await t.iterator()).map((t=>wM((()=>e(t)))))),this.size)}mapAsync(e){const t=this;return jQ((async()=>(await t.iterator()).mapAsync(e)),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const t=this;return jQ((async()=>(await t.iterator()).prefetch(e)),this.size)}repeat(e){const t=this;let n;return n=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,jQ((async()=>CQ(IQ((async()=>({value:await t.iterator(),done:!1}))).take(e))),n)}skip(e){const t=this;let n;return n=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,jQ((async()=>(await t.iterator()).skip(e)),n)}shuffle(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,i=jz.alea(t||fF().toString());return jQ((async()=>{let t=i.int32();return n&&(t+=i.int32()),(await r.iterator()).shuffle(e,t.toString())}),this.size)}take(e){const t=this;let n;return n=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,jQ((async()=>(await t.iterator()).take(e)),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function jQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends VQ{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function GQ(e){if(null===e)return null;if(function(e){return null==e||null===(t=e)||"object"!==typeof t&&"function"!==typeof t||Array.isArray(e)||"object"===typeof e&&e instanceof $F||vF(e);var t}(e[0])){return{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof $F?cB(e):vM(e)}(e),recurse:!1}}return{value:null,recurse:!0}}VQ.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function HQ(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&GR("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the CPU backend.`))}))}const qQ=MW;class KQ extends zR{nextDataId(){return KQ.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new PR(this,bM())}write(e,t,n){this.firstUse&&(this.firstUse=!1,C$().get("IS_NODE")&&UD("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&a$(n[0])){const i=n.map((e=>mF(e)));r=this.write(i,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){if(this.data.has(e)){return this.data.get(e).refCount}return 0}incRef(e){this.data.get(e).refCount++}decRef(e){if(this.data.has(e)){this.data.get(e).refCount--}}move(e,t,n,r,i){this.data.set(e,{values:t,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){return eW(this.readSync(n.real.dataId),this.readSync(n.imag.dataId))}return function(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>gF(e)));return lL(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return lL(e.shape,e.dtype,t)}makeOutput(e,t,n){return bM().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=fF();e();return{kernelMs:fF()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){HQ([e],"where");const t=this.readSync(e.dataId);return qQ(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}KQ.nextDataId=0;function XQ(e){return(t,n,r)=>{const i=i$(n,t.length);for(let s=0;s<t.length;++s)i[s]=e(t[s],r);return i}}function YQ(e,t,n){return QQ(e,XQ(t),n)}function QQ(e,t,n){return r=>{let{inputs:i,attrs:s,backend:o}=r;const{x:a}=i;HQ(a,e);const l=o,u=l.data.get(a.dataId).values;let c;if("string"===a.dtype){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");c=DW(u)}else c=u;const h=n||a.dtype,d=t(c,h,s);return l.makeTensorInfo(a.shape,h,d)}}IM("cpu",(()=>new KQ),1);const JQ=YQ(N_,(e=>e>=0?e:Math.exp(e)-1)),ZQ={kernelName:N_,backendName:"cpu",kernelFunc:JQ};function eJ(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const tJ={kernelName:G_,backendName:"cpu",kernelFunc:eJ};function nJ(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:s}=r;HQ([i],"leakyRelu");const o=KR(i.shape),a=n.data.get(i.dataId).values,l=r$("float32",o);for(let u=0;u<a.length;u++)l[u]=a[u]<0?s*a[u]:a[u];return n.makeTensorInfo(i.shape,"float32",l)}const rJ={kernelName:Q_,backendName:"cpu",kernelFunc:nJ};function iJ(e){return(t,n,r,i,s)=>{const o=FL(t,n),a=o.length,l=d$(o),u=r$(s,KR(o)),c=t.length,h=n.length,d=d$(t),p=d$(n),f=OL(t,o),m=OL(n,o);if(f.length+m.length===0)for(let g=0;g<u.length;++g)u[g]=e(r[g%r.length],i[g%i.length]);else for(let g=0;g<u.length;++g){const t=x$(g,a,l),n=t.slice(-c);f.forEach((e=>n[e]=0));const s=b$(n,c,d),o=t.slice(-h);m.forEach((e=>o[e]=0));const v=b$(o,h,p);u[g]=e(r[s],i[v])}return[u,o]}}const sJ=iJ(((e,t)=>e<0?t*e:e));function oJ(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t;HQ([r,i],"prelu");const s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,[a,l]=sJ(r.shape,i.shape,s,o,"float32");return n.makeTensorInfo(l,"float32",a)}const aJ={kernelName:_O,backendName:"cpu",kernelFunc:oJ},lJ=YQ(BO,(e=>Math.max(0,e))),uJ={kernelName:BO,backendName:"cpu",kernelFunc:lJ},cJ=YQ(HO,(e=>Math.min(Math.max(0,e),6))),hJ={kernelName:HO,backendName:"cpu",kernelFunc:cJ},dJ=XQ((e=>1/(1+Math.exp(-e)))),pJ=YQ(sD,(e=>1/(1+Math.exp(-e)))),fJ={kernelName:sD,backendName:"cpu",kernelFunc:pJ};function mJ(e,t,n,r,i){if("linear"===n)return eJ({inputs:{x:t},backend:e});if("relu"===n)return lJ({inputs:{x:t},backend:e});if("elu"===n)return JQ({inputs:{x:t},backend:e});if("relu6"===n)return cJ({inputs:{x:t},backend:e});if("prelu"===n)return oJ({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return nJ({inputs:{x:t},backend:e,attrs:{alpha:i}});if("sigmoid"===n)return pJ({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}function gJ(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,a=n.makeTensorInfo(r.shape,"complex64");return n.data.get(a.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",s),imag:n.makeTensorInfo(i.shape,"float32",o)},a}const vJ={kernelName:n_,backendName:"cpu",kernelFunc:gJ};function yJ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return gJ({inputs:{real:yJ(e,t,"float32"),imag:yJ(e,t,"float32")},backend:e})}const r=g$(KR(t),n);return e.makeTensorInfo(t,n,r)}function bJ(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const xJ={kernelName:PO,backendName:"cpu",kernelFunc:bJ};function wJ(e,t,n,r){if("int32"===r){return[t,"int32",Int32Array.from(e)]}if("bool"===r){const r=pF([0],n),[i,s]=iJ(((e,t)=>e!==t?1:0))(t,[],e,r,"bool");return[s,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function kJ(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:s}=r;if("complex64"===s){if("complex64"===i.dtype)return eJ({inputs:{x:i},backend:n});const e=yJ(n,i.shape,i.dtype),t=kJ({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),r=gJ({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if("complex64"===i.dtype){const e=bJ({inputs:{input:i},backend:n}),t=kJ({inputs:{x:e},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(e),t}if(!s$(i.dtype,s)){const e=eJ({inputs:{x:i},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:s}}const o=n.data.get(i.dataId).values,[a,l,u]=wJ(o,i.shape,i.dtype,s);return n.makeTensorInfo(a,l,u)}const SJ={kernelName:Z$,backendName:"cpu",kernelFunc:kJ};function IJ(e,t,n,r){return null==n?n=>{let{inputs:i,backend:s}=n;const{a:o,b:a}=i,l=s;HQ([o,a],e);const u=l.data.get(o.dataId).values,c=l.data.get(a.dataId).values,h="string"===o.dtype?DW(u):u,d="string"===o.dtype?DW(c):c,p=r||o.dtype,[f,m]=t(o.shape,a.shape,h,d,p);return l.makeTensorInfo(m,p,f)}:e=>{let{inputs:i,backend:s}=e;const{a:o,b:a}=i,l=s;if("complex64"===o.dtype||"complex64"===a.dtype){const e=kJ({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),t=l.data.get(e.dataId),r=t.complexTensorInfos.real,i=t.complexTensorInfos.imag,s=l.data.get(r.dataId).values,u=l.data.get(i.dataId).values,c=kJ({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),h=l.data.get(c.dataId),d=h.complexTensorInfos.real,p=h.complexTensorInfos.imag,f=l.data.get(d.dataId).values,m=l.data.get(p.dataId).values,[g,v,y]=n(o.shape,a.shape,s,u,f,m),b=l.makeTensorInfo(y,"float32",g),x=l.makeTensorInfo(y,"float32",v),w=gJ({inputs:{real:b,imag:x},backend:l});return l.disposeIntermediateTensorInfo(e),l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(b),l.disposeIntermediateTensorInfo(x),w}{const e=l.data.get(o.dataId).values,n=l.data.get(a.dataId).values,i=r||o.dtype,[s,u]=t(o.shape,a.shape,e,n,i);return l.makeTensorInfo(u,i,s)}}}function CJ(e){return(t,n,r,i,s,o)=>{const a=FL(t,n),l=KR(a),u=a.length,c=d$(a),h=r$("float32",l),d=r$("float32",l),p=OL(t,a),f=OL(n,a),m=eW(r,i),g=eW(s,o),v=t.length,y=d$(t),b=n.length,x=d$(n);if(p.length+f.length===0)for(let w=0;w<h.length;w++){const t=w%m.length,n=w%g.length,r=e(m[2*t],m[2*t+1],g[2*n],g[2*n+1]);h[w]=r.real,d[w]=r.imag}else for(let w=0;w<h.length;w++){const t=x$(w,u,c),n=t.slice(-v);p.forEach((e=>n[e]=0));const r=b$(n,v,y),i=t.slice(-b);f.forEach((e=>i[e]=0));const s=b$(i,b,x),o=e(m[2*r],m[2*r+1],g[2*s],g[2*s+1]);h[w]=o.real,d[w]=o.imag}return[h,d,a]}}const EJ=iJ(((e,t)=>e+t)),TJ=CJ(((e,t,n,r)=>({real:e+n,imag:t+r}))),NJ=IJ(O$,EJ,TJ),AJ={kernelName:O$,backendName:"cpu",kernelFunc:NJ};function RJ(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:s}=r,o=KR(i.shape),a=e$(s,o),l=KR(a);GR(o===l,(()=>`The new shape (${a}) has ${l} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`)),n.incRef(i.dataId);const u=n.data.get(i.dataId);if(null!=u.complexTensorInfos){const e=u.complexTensorInfos.real,t=u.complexTensorInfos.imag;e.shape=a,t.shape=a}return{dataId:i.dataId,shape:a,dtype:i.dtype}}const $J={kernelName:UO,backendName:"cpu",kernelFunc:RJ};function _J(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s}=t,{transposeA:o,transposeB:a}=r;HQ([i,s],"matMul");const l=i.shape.length,u=s.shape.length,c=o?i.shape[l-2]:i.shape[l-1],h=a?s.shape[u-1]:s.shape[u-2],d=o?i.shape[l-1]:i.shape[l-2],p=a?s.shape[u-2]:s.shape[u-1],f=i.shape.slice(0,-2),m=s.shape.slice(0,-2),g=KR(f),v=KR(m),y=FL(i.shape.slice(0,-2),s.shape.slice(0,-2)).concat([d,p]);GR(c===h,(()=>`Error in matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${i.shape} and ${s.shape} and transposeA=${o} and transposeB=${a} must match.`));const b=a?[v,p,h]:[v,h,p],x=RJ({inputs:{x:i},backend:n,attrs:{shape:o?[g,c,d]:[g,d,c]}}),w=RJ({inputs:{x:s},backend:n,attrs:{shape:b}}),k=o?x.shape[1]:x.shape[2],S=o?x.shape[2]:x.shape[1],I=a?w.shape[1]:w.shape[2],C=Math.max(g,v),E=n.data.get(x.dataId).values,T=n.data.get(w.dataId).values,N=d$(x.shape),A=d$(w.shape),[R,$,_]=o?[N[0],1,N[1]]:[N[0],N[1],1],[O,D,F]=a?[1,A[1],A[0]]:[A[1],1,A[0]],M=S*I,L=lL([C,S,I],x.dtype),P=L.values,z=n.blockSize;for(let B=0;B<C;B++){const e=B%g,t=B%v;for(let n=0;n<S;n+=z){const r=Math.min(n+z,S);for(let i=0;i<I;i+=z){const s=Math.min(i+z,I);for(let o=0;o<k;o+=z){const a=Math.min(o+z,k);for(let l=n;l<r;l++)for(let n=i;n<s;n++){let r=0;for(let i=o;i<a;i++){r+=E[e*R+l*$+i*_]*T[i*O+n*D+t*F]}P[B*M+(l*I+n)]+=r}}}}}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(y,L.dtype,L.values)}const OJ={kernelName:K$,backendName:"cpu",kernelFunc:_J};const DJ={kernelName:PD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s,bias:o,preluActivationWeights:a}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:h}=r;let d,p,f;const m=[];d=_J({inputs:{a:i,b:s},attrs:{transposeA:l,transposeB:u},backend:n}),o&&(p=NJ({inputs:{a:d,b:o},backend:n}),m.push(d),d=p),c&&(f=mJ(n,d,c,a,h),m.push(d),d=f);for(const g of m)n.disposeIntermediateTensorInfo(g);return d}};function FJ(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const MJ={kernelName:R$,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend;HQ(t,"abs");let r=new Float32Array(KR(t.shape));return r=FJ(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}},LJ=YQ($$,(e=>Math.acos(e))),PJ={kernelName:$$,backendName:"cpu",kernelFunc:LJ},zJ=YQ(_$,(e=>Math.acosh(e))),BJ={kernelName:_$,backendName:"cpu",kernelFunc:zJ};const UJ={kernelName:D$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,r=t;HQ(t,"addN");const i=r.map((e=>n.data.get(e.dataId).values)),s=lL(r[0].shape,r[0].dtype),o=s.values;for(let a=0;a<r.length;a++){const e=i[a];for(let t=0;t<o.length;t++)o[t]+=e[t]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}};function WJ(e,t,n,r,i){const s=t.length,o=KR(t),a=d$(t),l=d$(i),u=r$(n,KR(i));for(let c=0;c<o;++c){const t=x$(c,s,a),n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t[r[e]];u[b$(n,s,l)]=e[c]}return u}function VJ(e){const{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:s}=n;HQ(i,"transpose");const o=i.shape.length,a=new Array(o);for(let u=0;u<a.length;u++)a[u]=i.shape[s[u]];const l=WJ(r.data.get(i.dataId).values,i.shape,i.dtype,s,a);return{dataId:r.write(l,a,i.dtype),shape:a,dtype:i.dtype}}const jJ={kernelName:RD,backendName:"cpu",kernelFunc:VJ};const GJ={kernelName:F$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;HQ(i,"all");const a=t$(s,i.shape);let l=a;const u=Iz(l,i.shape.length);let c=i;null!=u&&(c=VJ({inputs:{x:i},backend:n,attrs:{perm:u}}),l=Ez(l.length,i.shape.length)),Sz("all",l,c.shape.length);const[h,d]=wz(c.shape,l),p=KR(d),f=g$(KR(h),c.dtype),m=n.data.get(c.dataId).values;for(let v=0;v<f.length;++v){const e=v*p;let t=m[e];for(let n=0;n<p;++n){const r=m[e+n];t=t&&r}f[v]=t}null!=u&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(h,c.dtype,f);if(o){const e=RJ({inputs:{x:g},backend:n,attrs:{shape:kz(h,a)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const HJ={kernelName:M$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;HQ(i,"any");const a=t$(s,i.shape);let l=a;const u=Iz(l,i.shape.length);let c=i;null!=u&&(c=VJ({inputs:{x:i},backend:n,attrs:{perm:u}}),l=Ez(l.length,i.shape.length)),Sz("any",l,c.shape.length);const[h,d]=wz(c.shape,l),p=KR(d),f=g$(KR(h),c.dtype),m=n.data.get(c.dataId).values;for(let v=0;v<f.length;++v){const e=v*p;let t=m[e];for(let n=0;n<p;++n){const r=m[e+n];t=t||r}f[v]=t}null!=u&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(h,c.dtype,f);if(o){const e=RJ({inputs:{x:g},backend:n,attrs:{shape:kz(h,a)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const qJ={kernelName:L$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;HQ(i,"argMax");let o=t$(s,i.shape);const a=Iz(o,i.shape.length);let l=i;const u=[];null!=a&&(l=VJ({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),o=Ez(o.length,l.shape.length)),o=[o[0]],Sz("argMax",o,l.shape.length);const[c,h]=wz(l.shape,o),d=g$(KR(c),"int32"),p=KR(h),f=n.data.get(l.dataId).values;for(let m=0;m<d.length;++m){const e=m*p;let t=f[e],n=0;for(let r=0;r<p;++r){const i=f[e+r];i>t&&(t=i,n=r)}d[m]=n}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(c,"int32",d)}};const KJ={kernelName:P$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;HQ(i,"argMin");let o=t$(s,i.shape);const a=Iz(o,i.shape.length);let l=i;const u=[];null!=a&&(l=VJ({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),o=Ez(o.length,l.shape.length)),o=[o[0]],Sz("argMin",o,l.shape.length);const[c,h]=wz(l.shape,o),d=g$(KR(c),"int32"),p=KR(h),f=n.data.get(l.dataId).values;for(let m=0;m<d.length;++m){const e=m*p;let t=f[e],n=0;for(let r=0;r<p;++r){const i=f[e+r];i<t&&(t=i,n=r)}d[m]=n}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(c,"int32",d)}},XJ=YQ(z$,(e=>Math.asin(e))),YJ={kernelName:z$,backendName:"cpu",kernelFunc:XJ},QJ=YQ(B$,(e=>Math.asinh(e))),JJ={kernelName:B$,backendName:"cpu",kernelFunc:QJ},ZJ=YQ(U$,(e=>Math.atan(e))),eZ={kernelName:U$,backendName:"cpu",kernelFunc:ZJ},tZ=iJ(((e,t)=>Math.atan2(e,t))),nZ=IJ(V$,tZ),rZ={kernelName:V$,backendName:"cpu",kernelFunc:nZ},iZ=YQ(W$,(e=>Math.atanh(e))),sZ={kernelName:W$,backendName:"cpu",kernelFunc:iZ};function oZ(e,t,n,r,i,s){const o=i.strideHeight,a=i.strideWidth,l=i.dilationHeight,u=i.dilationWidth,c=i.effectiveFilterHeight,h=i.effectiveFilterWidth,d=i.padInfo.top,p=i.padInfo.left,f="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=lL(i.outShape,n),g=m.values,v=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],b=i.outShape[3];for(let x=0;x<i.batchSize;++x){const t=x*v,n=x*r[0];for(let m=0;m<i.inChannels;++m)for(let v=0;v<i.outHeight;++v){const x=v*o-d,w=Math.max(0,x),k=Math.min(i.inHeight,c+x),S=t+v*y;for(let t=0;t<i.outWidth;++t){const o=t*a-p,c=Math.max(0,o),d=Math.min(i.inWidth,h+o);let v=f,y=0,x=0;for(let t=w;t<k;t+=l){const i=n+t*r[1];for(let t=c;t<d;t+=u){const n=e[i+t*r[2]+m];"max"===s&&n>v?v=n:"avg"===s&&(y+=n,x++)}if(isNaN(v))break}g[S+t*b+m]="avg"===s?y/x:v}}}return m}function aZ(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=lL(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.top,f=r.padInfo.left,m=lL(t,n,e);for(let g=0;g<r.batchSize;++g)for(let e=0;e<r.inChannels;++e)for(let t=0;t<r.outHeight;++t){const n=t*a-p;let v=n;for(;v<0;)v+=u;const y=Math.min(r.inHeight,h+n);for(let a=0;a<r.outWidth;++a){const h=a*l-f;let p=h;for(;p<0;)p+=c;const b=Math.min(r.inWidth,d+h);let x=Number.NEGATIVE_INFINITY,w=-1;for(let t=v;t<y;t+=u){const o=t-n;for(let n=p;n<b;n+=c){const a=n-h,l=m.get(g,t,n,e);l>x&&(x=l,w=i?s?((g*r.inHeight+t)*r.inWidth+n)*r.inChannels+e:(t*r.inWidth+n)*r.inChannels+e:o*d+a)}}o.set(w,g,t,a,e)}}return o}function lZ(e,t,n,r,i,s){const o=i.strideDepth,a=i.strideHeight,l=i.strideWidth,u=i.dilationDepth,c=i.dilationHeight,h=i.dilationWidth,d=i.effectiveFilterDepth,p=i.effectiveFilterHeight,f=i.effectiveFilterWidth,m=i.padInfo.front,g=i.padInfo.top,v=i.padInfo.left,y="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=lL(i.outShape,n),x=b.values,w=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],k=i.outShape[2]*i.outShape[3]*i.outShape[4],S=i.outShape[3]*i.outShape[4],I=i.outShape[4];for(let C=0;C<i.batchSize;++C){const t=C*w,n=C*r[0];for(let b=0;b<i.inChannels;++b)for(let w=0;w<i.outDepth;++w){const C=w*o-m;let E=C;for(;E<0;)E+=u;const T=Math.min(i.inDepth,d+C),N=t+w*k;for(let t=0;t<i.outHeight;++t){const o=t*a-g;let d=o;for(;d<0;)d+=c;const m=Math.min(i.inHeight,p+o),w=N+t*S;for(let t=0;t<i.outWidth;++t){const o=t*l-v;let a=o;for(;a<0;)a+=h;const p=Math.min(i.inWidth,f+o),g=w+t*I;let k=y,S=0,C=0;for(let t=E;t<T;t+=u){const i=n+t*r[1];for(let t=d;t<m;t+=c){const n=i+t*r[2];for(let t=a;t<p;t+=h){const i=e[n+t*r[3]+b];if("max"===s&&i>k?k=i:"avg"===s&&(S+=i,C++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}x[g+b]="avg"===s?S/Math.max(C,1):k}}}}return b}const uZ={kernelName:j$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;HQ(i,"avgPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:l}=r;GR(AP(o,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`));const u=bP(i.shape,s,o,1,a,l);let c;if(1===u.filterWidth&&1===u.filterHeight&&XR(u.inShape,u.outShape))c=eJ({inputs:{x:i},backend:n});else{const e=n.data.get(i.dataId).values,t=d$(i.shape),r=oZ(e,i.shape,i.dtype,t,u,"avg");c=n.makeTensorInfo(u.outShape,i.dtype,r.values)}return c}};const cZ={kernelName:H$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;HQ(i,"avgPool3d");const c=xP(i.shape,s,o,1,a,l,u),h=lZ(n.data.get(i.dataId).values,i.shape,i.dtype,d$(i.shape),c,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}};const hZ={kernelName:q$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;HQ([i,s],"avgPool3DGrad");const c=xP(s.shape,o,a,1,l,u),h=c.strideDepth,d=c.strideHeight,p=c.strideWidth,f=c.filterDepth,m=c.filterHeight,g=c.filterWidth,v=c.dilationDepth,y=c.dilationHeight,b=c.dilationWidth,x=c.effectiveFilterDepth,w=c.effectiveFilterHeight,k=c.effectiveFilterWidth,S=x-1-c.padInfo.front,I=k-1-c.padInfo.left,C=w-1-c.padInfo.top,E=lL(s.shape,"float32"),T=1/(f*m*g),N=n.bufferSync(i);for(let A=0;A<c.batchSize;++A)for(let e=0;e<c.inChannels;++e)for(let t=0;t<c.inDepth;++t)for(let n=0;n<c.inHeight;++n)for(let r=0;r<c.inWidth;++r){const i=t-S,s=n-C,o=r-I;let a=0;for(let t=0;t<x;t+=v){const n=(i+t)/h;if(!(n<0||n>=c.outDepth||Math.floor(n)!==n))for(let t=0;t<w;t+=y){const r=(s+t)/d;if(!(r<0||r>=c.outHeight||Math.floor(r)!==r))for(let t=0;t<k;t+=b){const i=(o+t)/p;if(i<0||i>=c.outWidth||Math.floor(i)!==i)continue;a+=N.get(A,n,r,i,e)}}}E.set(a*T,A,t,n,r,e)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}};const dZ={kernelName:G$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s;HQ([i,s],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=bP(o.shape,a,l,1,u),h=c.strideHeight,d=c.strideWidth,p=c.filterHeight,f=c.filterWidth,m=c.dilationHeight,g=c.dilationWidth,v=c.effectiveFilterHeight,y=c.effectiveFilterWidth,b=y-1-c.padInfo.left,x=v-1-c.padInfo.top,w=lL(o.shape,"float32"),k=1/(p*f),S=n.data.get(i.dataId).values,I=lL(i.shape,"float32",S);for(let C=0;C<c.batchSize;++C)for(let e=0;e<c.inChannels;++e)for(let t=0;t<c.inHeight;++t)for(let n=0;n<c.inWidth;++n){const r=t-x,i=n-b;let s=0;for(let t=0;t<v;t+=m){const n=(r+t)/h;if(!(n<0||n>=c.outHeight||Math.floor(n)!==n))for(let t=0;t<y;t+=g){const r=(i+t)/d;if(r<0||r>=c.outWidth||Math.floor(r)!==r)continue;s+=I.get(C,n,r,e)}}w.set(s*k,C,t,n,e)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};const pZ={kernelName:B_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,scale:s,offset:o,mean:a,variance:l}=t;GR(a.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),GR(null==o||a.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),GR(null==s||a.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),HQ([i,a,l,s,o],"batchNorm");let{varianceEpsilon:u}=r;null==u&&(u=.001);const c=n.data.get(i.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(l.dataId).values,p=s?n.data.get(s.dataId).values:new Float32Array([1]),f=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(c.length),g=f.length,v=p.length,y=d.length,b=h.length;let x=0,w=0,k=0,S=0;for(let I=0;I<c.length;++I)m[I]=f[x++]+(c[I]-h[w++])*p[k++]/Math.sqrt(d[S++]+u),x>=g&&(x=0),w>=b&&(w=0),k>=v&&(k=0),S>=y&&(S=0);return n.makeTensorInfo(i.shape,i.dtype,m)}};function fZ(e,t,n,r,i){const s=cP(r,t,n),o=KR(n),a=d$(r);if(s){const n=hP(t,a);return"string"===i?e.slice(n,n+o):e.subarray(n,n+o)}const l=lL(r,i,"string"===i?DW(e):e),u=lL(n,i);for(let c=0;c<u.size;++c){const e=u.indexToLoc(c),n=e.map(((e,n)=>e+t[n]));u.set(l.get(...n),...e)}return"string"===i?FW(u.values):u.values}function mZ(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,size:o}=r;HQ(i,"slice");const[a,l]=dP(i,s,o);JL(i,a,l);const u=fZ(n.data.get(i.dataId).values,a,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,u)}const gZ={kernelName:tD,backendName:"cpu",kernelFunc:mZ};const vZ={kernelName:X$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,crops:o}=r;HQ([i],"batchToSpaceND");const a=s.reduce(((e,t)=>e*t)),l=LU(i.shape,s,a),u=PU(l.length,s.length),c=zU(i.shape,s,a),h=BU(o,s.length),d=UU(c,o,s.length),p=RJ({inputs:{x:i},backend:n,attrs:{shape:l}}),f=VJ({inputs:{x:p},backend:n,attrs:{perm:u}}),m=RJ({inputs:{x:f},backend:n,attrs:{shape:c}}),g=mZ({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}};function yZ(e,t,n,r,i){const s=KR(r),o=g$(i,n);for(let a=0;a<e.length;a++){const n=e[a];if(n<0)throw new Error("Input x must be non-negative!");n>=i||(o[n]+=s>0?t[a]:1)}return o}function bZ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=e.shape[0],s=e.shape[1],o=lL([i,n],t.dtype);for(let a=0;a<i;a++)for(let i=0;i<s;i++){const s=e.get(a,i);if(s<0)throw new Error("Input x must be non-negative!");s>=n||(r?o.set(1,a,s):t.size>0?o.set(o.get(a,s)+t.get(a,i),a,s):o.set(o.get(a,s)+1,a,s))}return o}const xZ={kernelName:Y$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o}=r,a=yZ(n.data.get(i.dataId).values,n.data.get(s.dataId).values,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,a)}},wZ=iJ(((e,t)=>e&t)),kZ={kernelName:Q$,backendName:"cpu",kernelFunc:IJ(Q$,wZ)};const SZ={kernelName:J$,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,a=FL(Array.from(s),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}},IZ=XQ((e=>Math.ceil(e))),CZ=QQ(e_,IZ),EZ={kernelName:e_,backendName:"cpu",kernelFunc:CZ},TZ=YQ(t_,((e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),NZ={kernelName:t_,backendName:"cpu",kernelFunc:TZ},AZ={kernelName:r_,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array(KR(t.shape)),i=n.data.get(t.dataId),s=i.complexTensorInfos.real,o=i.complexTensorInfos.imag,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values;for(let u=0;u<a.length;u++){const e=a[u],t=l[u];r[u]=Math.hypot(e,t)}return n.makeOutput(r,t.shape,"float32")}};function RZ(e,t,n,r){const i=i$(n,KR(t));if(r&&"string"!==n){let t=0;e.forEach((e=>{const n=KR(e.shape);i.set(e.vals,t),t+=n}))}else{let r=0;e.forEach((e=>{const s="string"===n?DW(e.vals):e.vals;let o=0;for(let n=0;n<e.shape[0];++n){const a=n*t[1]+r;for(let t=0;t<e.shape[1];++t)i[a+t]=s[o++]}r+=e.shape[1]}))}return i}function $Z(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const _Z={kernelName:q_,backendName:"cpu",kernelFunc:$Z};function OZ(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,s=t$(i,t[0].shape)[0];EU(t.map((e=>e.shape)),s);let o=TU(t.map((e=>e.shape)),s);if(0===KR(o))return n.makeTensorInfo(o,t[0].dtype,[]);const a=t.filter((e=>KR(e.shape)>0));if(1===a.length)return eJ({inputs:{x:a[0]},backend:n});if("complex64"===a[0].dtype){const e=a.map((e=>bJ({inputs:{input:e},backend:n}))),t=a.map((e=>$Z({inputs:{input:e},backend:n}))),r=OZ({inputs:e,backend:n,attrs:{axis:s}}),i=OZ({inputs:t,backend:n,attrs:{axis:s}}),o=gJ({inputs:{real:r,imag:i},backend:n});return e.forEach((e=>n.disposeIntermediateTensorInfo(e))),t.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),o}const l=a.map((e=>{const t=KR(e.shape.slice(s));return RJ({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),u=l.map((e=>({vals:n.data.get(e.dataId).values,shape:e.shape})));o=TU(l.map((e=>e.shape)),1);const c=1===l[0].shape[0],h=RZ(u,o,t[0].dtype,c),d=TU(a.map((e=>e.shape)),s),p=n.makeTensorInfo(d,t[0].dtype,h);return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),p}const DZ={kernelName:i_,backendName:"cpu",kernelFunc:OZ};function FZ(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r;HQ([i,s],"conv2d");const h=$P(l),d=wP(i.shape,s.shape,o,u,a,c,!1,h),p=d.filterHeight,f=d.filterWidth,m=d.dilationHeight,g=d.dilationWidth,v=d.padInfo.left,y=d.padInfo.top,b="channelsLast"===d.dataFormat,x=new TF(d.outShape,i.dtype),w=d$(i.shape),k=d$(s.shape),S=w[0],I=b?w[1]:w[2],C=b?w[2]:1,E=b?1:w[1],T=x.strides[0],N=b?x.strides[1]:x.strides[2],A=b?x.strides[2]:1,R=b?1:x.strides[1],$=n.data.get(i.dataId).values,_=n.data.get(s.dataId).values,O=x.values;for(let D=0;D<d.batchSize;++D){const e=D*S,t=D*T;for(let n=0;n<d.outHeight;++n){const r=t+n*N,i=n*d.strideHeight-y;for(let t=0;t<p;++t){const n=i+t*m;if(n<0||n>=d.inHeight)continue;const s=t*k[0],o=e+n*I;for(let e=0;e<d.outWidth;++e){const t=r+e*A,n=e*d.strideWidth-v;for(let e=0;e<f;++e){const r=n+e*g;if(r<0||r>=d.inWidth)continue;const i=o+r*C;let a=s+e*k[1];for(let e=0;e<d.inChannels;++e){const n=$[i+e*E];for(let e=0;e<d.outChannels;++e)O[t+e*R]+=n*_[a+e];a+=d.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,O)}const MZ={kernelName:s_,backendName:"cpu",kernelFunc:FZ};const LZ={kernelName:o_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;HQ([i,s],"conv2dBackpropFilter");const h=$P(l),d=wP(i.shape,c,o,1,a,u,!1,h),{strideHeight:p,strideWidth:f,filterHeight:m,filterWidth:g}=d,v="channelsLast"===d.dataFormat,y=new TF(d.filterShape,"float32"),b=d.padInfo.left,x=d.padInfo.top,w=n.data.get(i.dataId).values,k=n.data.get(s.dataId).values,S=new TF(i.shape,i.dtype,w),I=new TF(s.shape,s.dtype,k);for(let C=0;C<m;++C){const e=Math.max(0,Math.ceil((x-C)/p)),t=Math.min(d.outHeight,(d.inHeight+x-C)/p);for(let n=0;n<g;++n){const r=Math.max(0,Math.ceil((b-n)/f)),i=Math.min(d.outWidth,(d.inWidth+b-n)/f);for(let s=0;s<d.inChannels;++s)for(let o=0;o<d.outChannels;++o){let a=0;for(let l=0;l<d.batchSize;++l)for(let u=e;u<t;++u){const e=C+u*p-x;for(let t=r;t<i;++t){const r=n+t*f-b;a+=v?S.get(l,e,r,s)*I.get(l,u,t,o):S.get(l,s,e,r)*I.get(l,o,u,t)}}y.set(a,C,n,s,o)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const PZ={kernelName:a_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r;HQ([i,s],"conv2dBackpropInput");const h=d$(s.shape),d=d$(i.shape);let p=$P(u);const f=wP(o,s.shape,a,1,l,c,!1,p),m=new TF(f.inShape,"float32"),g=m.values,v=n.data.get(i.dataId).values,y=n.data.get(s.dataId).values,[b,x,w]=h,{batchSize:k,filterHeight:S,filterWidth:I,inChannels:C,inHeight:E,inWidth:T,outChannels:N,outHeight:A,outWidth:R,strideHeight:$,strideWidth:_}=f;p=f.dataFormat;const O=S-1-f.padInfo.top,D=I-1-f.padInfo.left,F="channelsLast"===p,M=m.strides[0],L=F?m.strides[1]:m.strides[2],P=F?m.strides[2]:1,z=F?1:m.strides[1],B=d[0],U=F?d[1]:d[2],W=F?d[2]:1,V=F?1:d[1];for(let j=0;j<k;++j)for(let e=0;e<C;++e)for(let t=0;t<E;++t){const n=t-O,r=Math.max(0,Math.ceil(n/$)),i=Math.min(A,(S+n)/$);for(let s=0;s<T;++s){const o=s-D,a=Math.max(0,Math.ceil(o/_)),l=Math.min(R,(I+o)/_);let u=0;for(let t=r;t<i;++t){const r=t*$-n;for(let n=a;n<l;++n){const i=B*j+U*t+W*n,s=b*(S-1-r)+x*(I-1-(n*_-o))+w*e;for(let e=0;e<N;++e){u+=v[i+V*e]*y[s+e]}}}g[M*j+L*t+P*s+z*e]=u}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};const zZ={kernelName:l_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:l}=r;HQ([i,s],"conv3d");const u=kP(i.shape,s.shape,o,l,a),{filterDepth:c,filterHeight:h,filterWidth:d,dilationDepth:p,dilationHeight:f,dilationWidth:m,padInfo:g}=u,v=g.front,y=g.left,b=g.top,x=new TF(u.outShape,i.dtype),w=n.data.get(i.dataId).values,k=n.data.get(s.dataId).values,S=x.values,I=d$(i.shape),C=d$(s.shape);for(let E=0;E<u.batchSize;++E){const e=E*I[0],t=E*x.strides[0];for(let n=0;n<u.outDepth;++n){const r=t+n*x.strides[1],i=n*u.strideDepth-v;for(let t=0;t<c;++t){const n=i+t*p;if(n<0||n>=u.inDepth)continue;const s=t*C[0],o=e+n*I[1];for(let e=0;e<u.outHeight;++e){const t=r+e*x.strides[2],n=e*u.strideHeight-b;for(let e=0;e<h;++e){const r=n+e*f;if(r<0||r>=u.inHeight)continue;const i=s+e*C[1],a=o+r*I[2];for(let e=0;e<u.outWidth;++e){const n=t+e*u.outChannels,r=e*u.strideWidth-y;for(let e=0;e<d;++e){const t=r+e*m;if(t<0||t>=u.inWidth)continue;const s=i+e*C[2],o=a+t*u.inChannels;let l=s;for(let e=0;e<u.inChannels;++e){const t=w[o+e];for(let e=0;e<u.outChannels;++e)S[n+e]+=t*k[l+e];l+=u.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};const BZ={kernelName:u_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,filterShape:l}=r;HQ([i,s],"conv3dBackpropFilterV2");const u=d$(i.shape),c=d$(s.shape),h=kP(i.shape,l,o,1,a),d=h.strideDepth,p=h.strideHeight,f=h.strideWidth,m=h.filterDepth,g=h.filterHeight,v=h.filterWidth,y=new TF(h.filterShape,"float32"),b=y.values,[x,w,k,S]=y.strides,I=n.data.get(s.dataId).values,[C,E,T,N]=c,A=n.data.get(i.dataId).values,[R,$,_,O]=u,D=h.padInfo.front,F=h.padInfo.left,M=h.padInfo.top;for(let L=0;L<m;++L){const e=Math.max(0,Math.ceil((D-L)/d)),t=Math.min(h.outDepth,(h.inDepth+D-L)/d),n=L*x;for(let r=0;r<g;++r){const i=Math.max(0,Math.ceil((M-r)/p)),s=Math.min(h.outHeight,(h.inHeight+M-r)/p),o=r*w+n;for(let n=0;n<v;++n){const a=Math.max(0,Math.ceil((F-n)/f)),l=Math.min(h.outWidth,(h.inWidth+F-n)/f),u=n*k+o;for(let o=0;o<h.inChannels;++o){const c=o*S+u;for(let u=0;u<h.outChannels;++u){let m=0;for(let c=0;c<h.batchSize;++c){const h=c*R,g=c*C;for(let c=e;c<t;++c){const e=(L+c*d-D)*$+h,t=c*E+g;for(let c=i;c<s;++c){const i=(r+c*p-M)*_+e,s=c*T+t;for(let e=a;e<l;++e){const t=e*N+s;m+=A[(n+e*f-F)*O+i+o]*I[t+u]}}}}b[c+u]=m}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const UZ={kernelName:c_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{pad:o,strides:a,inputShape:l}=r;HQ([i],"conv3dBackpropInputV2");const u=d$(i.shape),c=d$(s.shape),h=kP(l,s.shape,a,1,o),d=new TF(h.inShape,"float32"),p=d.values,[f,m,g,v]=d.strides,y=n.data.get(i.dataId).values,[b,x,w,k]=u,S=n.data.get(s.dataId).values,[I,C,E,T]=c,{batchSize:N,filterDepth:A,filterHeight:R,filterWidth:$,inChannels:_,inDepth:O,inHeight:D,inWidth:F,outChannels:M,outDepth:L,outHeight:P,outWidth:z,strideDepth:B,strideHeight:U,strideWidth:W}=h,V=A-1-h.padInfo.front,j=R-1-h.padInfo.top,G=$-1-h.padInfo.left;for(let H=0;H<N;++H)for(let e=0;e<_;++e)for(let t=0;t<O;++t){const n=t-V,r=Math.max(0,Math.ceil(n/B)),i=Math.min(L,(A+n)/B);for(let s=0;s<D;++s){const o=s-j,a=Math.max(0,Math.ceil(o/U)),l=Math.min(P,(R+o)/U);for(let u=0;u<F;++u){const c=u-G,h=Math.max(0,Math.ceil(c/W)),d=Math.min(z,($+c)/W);let N=0;for(let t=r;t<i;++t){const r=t*B-n;for(let n=a;n<l;++n){const i=n*U-o;for(let s=h;s<d;++s){const o=b*H+x*t+w*n+k*s,a=I*(A-1-r)+C*(R-1-i)+E*($-1-(s*W-c))+T*e;for(let e=0;e<M;++e){N+=y[o+e]*S[a+e]}}}}p[f*H+m*t+g*s+v*u+e]=N}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}},WZ=YQ(h_,(e=>Math.cos(e))),VZ={kernelName:h_,backendName:"cpu",kernelFunc:WZ},jZ=YQ(d_,(e=>Math.cosh(e))),GZ={kernelName:d_,backendName:"cpu",kernelFunc:jZ};const HZ={kernelName:m_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:s,boxInd:o}=t,{cropSize:a,method:l,extrapolationValue:u}=r,[c,h,d,p]=i.shape,f=s.shape[0],[m,g]=a,v=lL([f,m,g,p],"float32"),y=n.data.get(s.dataId).values,b=n.data.get(o.dataId).values,x=n.data.get(i.dataId).values,w=d$(i.shape),k=d$(v.shape);for(let S=0;S<f;S++){const e=4*S,t=y[e],n=y[e+1],r=y[e+2],i=y[e+3],s=b[S];if(s>=c)continue;const o=m>1?(r-t)*(h-1)/(m-1):0,a=g>1?(i-n)*(d-1)/(g-1):0;for(let c=0;c<m;c++){const e=m>1?t*(h-1)+c*o:.5*(t+r)*(h-1);if(e<0||e>h-1)for(let t=0;t<g;t++)for(let e=0;e<p;e++){const n=e+t*k[2]+c*k[1]+S*k[0];v.values[n]=u}else if("bilinear"===l){const t=Math.floor(e),r=Math.ceil(e),o=e-t;for(let e=0;e<g;e++){const l=g>1?n*(d-1)+e*a:.5*(n+i)*(d-1);if(l<0||l>d-1){for(let t=0;t<p;t++){const n=t+e*k[2]+c*k[1]+S*k[0];v.values[n]=u}continue}const h=Math.floor(l),f=Math.ceil(l),m=l-h;for(let n=0;n<p;n++){let i=n+h*w[2]+t*w[1]+s*w[0];const a=x[i];i=n+f*w[2]+t*w[1]+s*w[0];const l=x[i];i=n+h*w[2]+r*w[1]+s*w[0];const u=x[i];i=n+f*w[2]+r*w[1]+s*w[0];const d=a+(l-a)*m,p=u+(x[i]-u)*m;i=n+e*k[2]+c*k[1]+S*k[0],v.values[i]=d+(p-d)*o}}}else for(let t=0;t<g;++t){const r=g>1?n*(d-1)+t*a:.5*(n+i)*(d-1);if(r<0||r>d-1){for(let e=0;e<p;e++){const n=e+t*k[2]+c*k[1]+S*k[0];v.values[n]=u}continue}const o=Math.round(r),l=Math.round(e);for(let e=0;e<p;e++){const n=e+o*w[2]+l*w[1]+s*w[0],r=e+t*k[2]+c*k[1]+S*k[0];v.values[r]=x[n]}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const qZ={kernelName:p_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;HQ(i,"cumprod");const l=Iz([s],i.shape.length);let u=i;null!=l&&(u=VJ({inputs:{x:i},backend:n,attrs:{perm:l}}));const c=Ez(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const h=GF(u.dtype,"int32"),d=m$(KR(u.shape),h),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=a?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let v=0;v<p.length;v+=f)for(let e=0;e<f;e++){const t=m(v,e);if(0===e)d[t]=o?1:p[t];else{const n=m(v,e-1);d[t]=o?p[n]*d[n]:p[t]*d[n]}}const g=n.makeTensorInfo(u.shape,h,d);if(null!=l){const e=VJ({inputs:{x:g},backend:n,attrs:{perm:Cz(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),e}return g}};const KZ={kernelName:f_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;HQ(i,"cumsum");const l=Iz([s],i.shape.length);let u=i;null!=l&&(u=VJ({inputs:{x:i},backend:n,attrs:{perm:l}}));const c=Ez(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const h=GF(u.dtype,"int32"),d=g$(KR(u.shape),h),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=a?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let v=0;v<p.length;v+=f)for(let e=0;e<f;e++){const t=m(v,e);if(0===e)d[t]=o?0:p[t];else{const n=m(v,e-1);d[t]=o?p[n]+d[n]:p[t]+d[n]}}const g=n.makeTensorInfo(u.shape,h,d);if(null!=l){const e=VJ({inputs:{x:g},backend:n,attrs:{perm:Cz(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),e}return g}};const XZ={kernelName:g_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o,binaryOutput:a}=r;if(1===i.shape.length){const e=yZ(n.data.get(i.dataId).values,n.data.get(s.dataId).values,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,e)}if(2===i.shape.length){const e=bZ(n.bufferSync(i),n.bufferSync(s),o,a);return n.makeTensorInfo(e.shape,s.dtype,e.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}};const YZ={kernelName:v_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:s,dataFormat:o}=r;GR("NHWC"===o,(()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`));const a=i.shape[0],l=i.shape[1],u=i.shape[2],c=i.shape[3],h=l*s,d=u*s,p=c/(s*s),f=n.data.get(i.dataId).values,m=new Float32Array(a*h*d*p);let g=0;for(let v=0;v<a;++v)for(let e=0;e<h;++e){const t=Math.floor(e/s),n=e%s;for(let e=0;e<d;++e){const r=Math.floor(e/s),i=(n*s+e%s)*p;for(let e=0;e<p;++e){const n=e+i+c*(r+u*(t+l*v));m[g++]=f[n]}}}return n.makeTensorInfo([a,h,d,p],i.dtype,m)}};function QZ(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;HQ([i,s],"depthwiseConv2DNative");const c=d$(i.shape),h=d$(s.shape);let d=l;null==d&&(d=[1,1]),GR(AP(o,d),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`));const p=wP(i.shape,s.shape,o,d,a,u,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:v,padInfo:y}=p,b=y.left,x=y.top,w=p.outChannels/p.inChannels,k=new TF(p.outShape,i.dtype),S=n.data.get(i.dataId).values,I=n.data.get(s.dataId).values,C=k.values;for(let E=0;E<p.batchSize;++E){const e=E*c[0],t=E*k.strides[0];for(let n=0;n<p.outHeight;++n){const r=t+n*k.strides[1],i=n*p.strideHeight-x;for(let t=0;t<f;++t){const n=i+t*g;if(n<0||n>=p.inHeight)continue;const s=t*h[0],o=e+n*c[1];for(let e=0;e<p.outWidth;++e){const t=r+e*k.strides[2],n=e*p.strideWidth-b;for(let e=0;e<m;++e){const r=n+e*v;if(r<0||r>=p.inWidth)continue;const i=s+e*h[1],a=o+r*p.inChannels;let l=t,u=i;for(let e=0;e<p.inChannels;++e){const t=S[a+e];for(let e=0;e<w;++e)C[l+e]+=t*I[u+e];l+=w,u+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const JZ={kernelName:y_,backendName:"cpu",kernelFunc:QZ};const ZZ={kernelName:b_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r;HQ([i,s],"depthwiseConv2dNativeBackpropFilter");const h=wP(i.shape,c,o,a,l,u,!0),{strideHeight:d,strideWidth:p,filterHeight:f,filterWidth:m}=h,g=new TF(h.filterShape,"float32"),v=h.padInfo.left,y=h.padInfo.top,b=h.outChannels/h.inChannels,x=n.data.get(i.dataId).values,w=new TF(i.shape,i.dtype,x),k=n.data.get(s.dataId).values,S=new TF(s.shape,s.dtype,k);for(let I=0;I<f;++I){const e=Math.max(0,Math.ceil((y-I)/d)),t=Math.min(h.outHeight,(h.inHeight+y-I)/d);for(let n=0;n<m;++n){const r=Math.max(0,Math.ceil((v-n)/p)),i=Math.min(h.outWidth,(h.inWidth+v-n)/p);for(let s=0;s<h.outChannels;++s){const o=Math.trunc(s/b),a=s%b;let l=0;for(let u=0;u<h.batchSize;++u)for(let a=e;a<t;++a){const e=I+a*d-y;for(let t=r;t<i;++t){const r=n+t*p-v;l+=w.get(u,e,r,o)*S.get(u,a,t,s)}}g.set(l,I,n,o,a)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};const e0={kernelName:x_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r;HQ([i,s],"depthwiseConv2DNativeBackpropInput");const h=d$(i.shape),d=d$(s.shape),p=wP(c,s.shape,o,a,l,u,!0),f=new TF(p.inShape,"float32"),m=f.values,[g,v,y]=f.strides,b=n.data.get(i.dataId).values,[x,w,k]=h,S=n.data.get(s.dataId).values,[I,C,E]=d,{batchSize:T,filterHeight:N,filterWidth:A,inChannels:R,inHeight:$,inWidth:_,outChannels:O,outHeight:D,outWidth:F,strideHeight:M,strideWidth:L}=p,P=N-1-p.padInfo.top,z=A-1-p.padInfo.left,B=O/R;for(let U=0;U<T;++U)for(let e=0;e<R;++e)for(let t=0;t<$;++t){const n=t-P,r=Math.max(0,Math.ceil(n/M)),i=Math.min(D,(N+n)/M);for(let s=0;s<_;++s){const o=s-z,a=Math.max(0,Math.ceil(o/L)),l=Math.min(F,(A+o)/L);let u=0;for(let t=r;t<i;++t){const r=t*M-n;for(let n=a;n<l;++n){const i=x*U+w*t+k*n,s=I*(N-1-r)+C*(A-1-(n*L-o))+E*e;for(let t=0;t<B;++t){u+=b[i+(e*B+t)]*S[s+t]}}}m[g*U+v*t+y*s+e]=u}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}};const t0={kernelName:w_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,i=KR(r.shape),s=n.data.get(r.dataId).values,o=lL([i,i],r.dtype),a=o.values;for(let u=0;u<s.length;u++)a[u*i+u]=s[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,o.dtype,o.values)}},n0={kernelName:k_,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:i,filter:s}=t,{strides:o,pad:a,dilations:l}=r,u=n,c=u.data.get(i.dataId).values,h=i.shape.length,d=u.data.get(s.dataId).values,p=s.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:v,outHeight:y,outWidth:b,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:S,filterWidth:I,dilationHeight:C,dilationWidth:E,outShape:T}=yP(i.shape,s.shape,o,a,"NHWC",l),N=KR(T),A=T.length,R=i$(i.dtype,N);for(let $=0;$<f;++$)for(let e=0;e<y;++e){const t=e*w-x.top;for(let n=0;n<b;++n){const r=n*k-x.left;for(let o=0;o<v;++o){let a=Number.MIN_SAFE_INTEGER;for(let e=0;e<S;++e){const n=t+e*C;if(n>=0&&n<m)for(let t=0;t<I;++t){const l=r+t*E;if(l>=0&&l<g){const r=b$([$,n,l,o],h,d$(i.shape)),u=b$([e,t,o],p,d$(s.shape)),f=c[r]+d[u];f>a&&(a=f)}}}R[b$([$,e,n,o],A,d$(T))]=a}}}return{dataId:u.write(pF(R,i.dtype),T,i.dtype),shape:T,dtype:i.dtype}}},r0={kernelName:I_,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:i,filter:s,dy:o}=t,{strides:a,pad:l,dilations:u}=r,c=n,h=f$(i.shape,c.data.get(i.dataId).values),d=f$(s.shape,c.data.get(s.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:v,outWidth:y,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:I,dilationWidth:C,outShape:E}=yP(i.shape,s.shape,a,l,"NHWC",u);GR(o.rank===E.length,(()=>`Error in ${I_}, dy must have the same rank as output ${E.length}, but got ${o.rank}`));const T=f$(E,c.data.get(o.dataId).values),N=v$(s.shape,s.dtype);for(let A=0;A<p;++A)for(let e=0;e<v;++e){const t=e*x-b.top;for(let n=0;n<y;++n){const r=n*w-b.left;for(let i=0;i<g;++i){let s=Number.MIN_SAFE_INTEGER,o=0,a=0;for(let e=0;e<k;++e){const n=t+e*I;if(n>=0&&n<f)for(let t=0;t<S;++t){const l=r+t*C;if(l>=0&&l<m){const r=h[A][n][l][i]+d[e][t][i];r>s&&(s=r,o=e,a=t)}}}N[o][a][i]+=T[A][e][n][i]}}}return{dataId:c.write(pF(N,i.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}},i0={kernelName:S_,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:i,filter:s,dy:o}=t,{strides:a,pad:l,dilations:u}=r,c=n,h=f$(i.shape,c.data.get(i.dataId).values),d=f$(s.shape,c.data.get(s.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:v,outWidth:y,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:I,dilationWidth:C,outShape:E}=yP(i.shape,s.shape,a,l,"NHWC",u);GR(o.rank===E.length,(()=>`Error in ${S_}, dy must have the same rank as output ${E.length}, but got ${o.rank}`));const T=f$(E,c.data.get(o.dataId).values),N=v$(i.shape,i.dtype);for(let A=0;A<p;++A)for(let e=0;e<v;++e){const t=e*x-b.top;for(let n=0;n<y;++n){const r=n*w-b.left;for(let i=0;i<g;++i){let s=Number.MIN_SAFE_INTEGER,o=t<0?0:t,a=r<0?0:r;for(let e=0;e<k;++e){const n=t+e*I;if(n>=0&&n<f)for(let t=0;t<S;++t){const l=r+t*C;if(l>=0&&l<m){const r=h[A][n][l][i]+d[e][t][i];r>s&&(s=r,o=n,a=l)}}}N[A][o][a][i]+=T[A][e][n][i]}}}return{dataId:c.write(pF(N,i.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};const s0={kernelName:C_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{canvas:s,options:o}=r,{contextOptions:a,imageOptions:l}=o||{},u=(null===l||void 0===l?void 0:l.alpha)||1,c=(null===a||void 0===a?void 0:a.contextType)||"2d";if("2d"!==c)throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const h=s.getContext(c,(null===a||void 0===a?void 0:a.contextAttributes)||{});if(null==h)throw new Error(`Could not get the context with ${c} type.`);const[d,p]=i.shape.slice(0,2),f=2===i.shape.length?1:i.shape[2],m=n.data.get(i.dataId).values,g="float32"===i.dtype?255:1,v=new Uint8ClampedArray(p*d*4);for(let b=0;b<d*p;++b){const e=[0,0,0,255*u];for(let n=0;n<f;n++){const t=m[b*f+n];if("float32"===i.dtype){if(t<0||t>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${t}.`)}else if("int32"===i.dtype&&(t<0||t>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${t}.`);1===f?(e[0]=t*g,e[1]=t*g,e[2]=t*g):e[n]=t*g}const t=4*b;v[t+0]=Math.round(e[0]),v[t+1]=Math.round(e[1]),v[t+2]=Math.round(e[2]),v[t+3]=Math.round(e[3])}s.width=p,s.height=d;const y=new ImageData(v,p,d);return h.putImageData(y,0,0),i}},o0=iJ(((e,t)=>e*t)),a0=CJ(((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n}))),l0=IJ(wO,o0,a0),u0={kernelName:wO,backendName:"cpu",kernelFunc:l0};function c0(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;let a;HQ(i,"sum"),a="bool"===i.dtype?kJ({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):eJ({inputs:{x:i},backend:n});const l=a.shape.length,u=t$(s,a.shape),c=Iz(u,l);let h=u,d=a;null!=c&&(d=VJ({inputs:{x:a},backend:n,attrs:{perm:c}}),h=Ez(h.length,l)),Sz("sum",h,d.shape.length);const[p,f]=wz(d.shape,h);let m=yJ(n,p,GF(d.dtype,"int32"));const g=KR(f),v=n.data.get(m.dataId).values,y=n.data.get(d.dataId).values;for(let b=0;b<v.length;++b){const e=b*g;let t=0;for(let n=0;n<g;++n)t+=y[e+n];v[b]=t}if(o){const e=m;m=RJ({inputs:{x:m},backend:n,attrs:{shape:kz(m.shape,u)}}),n.disposeIntermediateTensorInfo(e)}return n.disposeIntermediateTensorInfo(a),null!=c&&n.disposeIntermediateTensorInfo(d),m}const h0={kernelName:lD,backendName:"cpu",kernelFunc:c0};const d0={kernelName:T_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,s=t,{allDims:o,summedDims:a,idDims:l}=dW(i,s.length);fW(o.length,l,s);const{path:u,steps:c}=mW(a,l),h=c.length;let d=null,p=o.length;const f=[];for(let m=0;m<h;++m){for(const e of c[m]){const{permutationIndices:t,expandDims:r}=pW(p,l[e]);let i;gW(t)?i=s[e]:(i=VJ({inputs:{x:s[e]},backend:n,attrs:{perm:t}}),f.push(i));const o=i.shape.slice();for(let e=0;e<r.length;++e)o.splice(r[e],0,1);XR(i.shape,o)||(i=RJ({inputs:{x:i},backend:n,attrs:{shape:o}}),f.push(i)),null===d?d=i:(d=l0({inputs:{a:i,b:d},backend:n}),f.push(d))}m<h-1&&(u[m]>=0&&(d=c0({inputs:{x:d},backend:n,attrs:{axis:u[m]-(o.length-p),keepDims:!1}}),f.push(d)),p--)}for(const m of f)m!==d&&n.disposeIntermediateTensorInfo(m);return d}};const p0={kernelName:A_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{dy:r,y:i}=t;HQ([r,i],"eluGrad");const s=new Float32Array(KR(i.shape)),o=n.data.get(i.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<o.length;++l){const e=o[l];s[l]=e>=0?a[l]:a[l]*(e+1)}return n.makeTensorInfo(i.shape,"float32",s)}},f0=iJ(((e,t)=>e===t?1:0)),m0=IJ($_,f0,null,"bool"),g0={kernelName:$_,backendName:"cpu",kernelFunc:m0},v0=KU,y0=XU,b0=YU,x0=QU,w0=JU,k0=ZU,S0=YQ(R_,(e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+v0*n);return t*(1-((((k0*r+w0)*r+x0)*r+b0)*r+y0)*r*Math.exp(-n*n))})),I0={kernelName:R_,backendName:"cpu",kernelFunc:S0},C0=XQ((e=>Math.exp(e))),E0=QQ(__,C0,"float32"),T0={kernelName:__,backendName:"cpu",kernelFunc:E0};function N0(e){const{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:s}=r,o=i.shape.length,a=i.shape.slice();let l=s;return s<0&&(GR(-(o+1)<=s,(()=>`Axis must be in the interval [${-(o+1)}, ${o}]`)),l=o+s+1),a.splice(l,0,1),RJ({inputs:{x:i},backend:n,attrs:{shape:a}})}const A0={kernelName:O_,backendName:"cpu",kernelFunc:N0},R0=XQ((e=>Math.expm1(e))),$0=QQ(D_,R0),_0={kernelName:D_,backendName:"cpu",kernelFunc:$0},O0=iJ(((e,t)=>e/t)),D0=IJ(E_,O0),F0={kernelName:E_,backendName:"cpu",kernelFunc:D0},M0=iJ(((e,t)=>e-t)),L0=CJ(((e,t,n,r)=>({real:e-n,imag:t-r}))),P0=IJ(ID,M0,L0),z0={kernelName:ID,backendName:"cpu",kernelFunc:P0};function B0(e,t,n){const r=e.shape,i=r[0],s=r[1],o=n.data.get(e.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,u=[i,s],c=KR(u),h=r$("float32",c),d=r$("float32",c);for(let g=0;g<i;g++){const e=mZ({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,s]}}),r=mZ({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,s]}}),i=gJ({inputs:{real:e,imag:r},backend:n}),{real:o,imag:u}=U0(i,t,n),c=eW(o,u);for(let t=0;t<s;t++){const e=iW(c,t);h[g*s+t]=e.real,d[g*s+t]=e.imag}n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i)}const p=n.makeTensorInfo(u,"float32",h),f=n.makeTensorInfo(u,"float32",d),m=gJ({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}function U0(e,t,n){const r=KR(e.shape),i=n.data.get(e.dataId),s=n.data.get(i.complexTensorInfos.real.dataId).values,o=n.data.get(i.complexTensorInfos.imag.dataId).values;if(0===((a=r)&a-1)){const i=W0(s,o,r,t,n),a=[e.shape[0],e.shape[1]];if(t){const e=n.makeTensorInfo(a,"float32",i.real),t=n.makeTensorInfo(a,"float32",i.imag),s=n.makeTensorInfo([],"float32",dF(r,"float32")),o=eJ({inputs:{x:s},backend:n}),l=F0.kernelFunc({inputs:{a:e,b:s},backend:n}),u=F0.kernelFunc({inputs:{a:t,b:o},backend:n}),c=n.data.get(l.dataId).values,h=n.data.get(u.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),{real:c,imag:h}}return i}{const e=function(e,t,n){const r=new Float32Array(2*t);for(let i=0;i<t;i++){let s=0,o=0;for(let r=0;r<t;r++){const a=aW(i*r,t,n),l=iW(e,r);s+=l.real*a.real-l.imag*a.imag,o+=l.real*a.imag+l.imag*a.real}n&&(s/=t,o/=t),sW(r,s,o,i)}return r}(eW(s,o),r,t);return tW(e)}var a}function W0(e,t,n,r,i){if(1===n)return{real:e,imag:t};const s=eW(e,t),o=n/2,a=nW(s),l=a.real,u=a.imag,c=[l.length],h=i.makeTensorInfo(c,"float32",l),d=i.makeTensorInfo(c,"float32",u),p=gJ({inputs:{real:h,imag:d},backend:i}),f=rW(s),m=f.real,g=f.imag,v=[m.length],y=i.makeTensorInfo(v,"float32",m),b=i.makeTensorInfo(v,"float32",g),x=gJ({inputs:{real:y,imag:b},backend:i}),w=W0(l,u,o,r,i),k=w.real,S=w.imag,I=[k.length],C=i.makeTensorInfo(I,"float32",k),E=i.makeTensorInfo(I,"float32",S),T=gJ({inputs:{real:C,imag:E},backend:i}),N=W0(m,g,o,r,i),A=N.real,R=N.imag,$=[A.length],_=i.makeTensorInfo($,"float32",A),O=i.makeTensorInfo($,"float32",R),D=gJ({inputs:{real:_,imag:O},backend:i}),F=oW(n,r),M=[F.real.length],L=i.makeTensorInfo(M,"float32",F.real),P=i.makeTensorInfo(M,"float32",F.imag),z=gJ({inputs:{real:L,imag:P},backend:i}),B=l0({inputs:{a:z,b:D},backend:i}),U=NJ({inputs:{a:T,b:B},backend:i}),W=P0({inputs:{a:T,b:B},backend:i}),V=bJ({inputs:{input:U},backend:i}),j=bJ({inputs:{input:W},backend:i}),G=$Z({inputs:{input:U},backend:i}),H=$Z({inputs:{input:W},backend:i}),q=OZ({inputs:[V,j],backend:i,attrs:{axis:0}}),K=OZ({inputs:[G,H],backend:i,attrs:{axis:0}}),X=i.data.get(q.dataId).values,Y=i.data.get(K.dataId).values;return i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(y),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(x),i.disposeIntermediateTensorInfo(C),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(O),i.disposeIntermediateTensorInfo(D),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(P),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(B),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(j),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(K),{real:X,imag:Y}}const V0={kernelName:F_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,i=KR(r.shape),s=r.shape[r.shape.length-1],o=RJ({inputs:{x:r},backend:n,attrs:{shape:[i/s,s]}}),a=B0(o,!1,n),l=RJ({inputs:{x:a},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}};function j0(e){const{backend:t,attrs:n}=e,{shape:r,value:i,dtype:s}=n,o=s||u$(i),a=i$(o,KR(r));return function(e,t){e.fill(t)}(a,i),t.makeTensorInfo(r,o,a)}const G0={kernelName:M_,backendName:"cpu",kernelFunc:j0};const H0={kernelName:L_,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:i}=t,s=r,o=r$(i.dtype,KR(i.shape)),[a,l,u,c]=i.shape,h=s.data.get(i.dataId).values;for(let d=0;d<a;d++){const e=d*u*l*c;for(let t=0;t<l;t++){const n=t*(u*c);for(let t=0;t<u;t++){const r=t*c;for(let i=0;i<c;i++){const s=Math.round(u-t-1),a=e+n+r+i;let l=h[a];if(s>=0&&s<u){l=h[e+n+s*c+i]}o[a]=l}}}}return{dataId:s.write(o,i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},q0=XQ((e=>Math.floor(e))),K0=QQ(P_,q0),X0={kernelName:P_,backendName:"cpu",kernelFunc:K0},Y0=iJ(((e,t)=>Math.floor(e/t))),Q0=IJ(z_,Y0,null,"int32"),J0={kernelName:z_,backendName:"cpu",kernelFunc:Q0};const Z0={kernelName:zD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r;let m=FZ({inputs:{x:i,filter:s},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d}});if(o){const e=m;if("NCHW"===c&&1===o.shape.length&&1!==o.shape[0]){const e=RJ({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=NJ({inputs:{a:m,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else m=NJ({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(e)}if(p){const e=m;if("NCHW"===c&&"prelu"===p&&1===a.shape.length&&1!==a.shape[0]){const e=RJ({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=mJ(n,m,p,e,f),n.disposeIntermediateTensorInfo(e)}else m=mJ(n,m,p,a,f);n.disposeIntermediateTensorInfo(e)}return m}};const e1={kernelName:BD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r;let m=QZ({inputs:{x:i,filter:s},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d}});if(o){const e=m;m=NJ({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(e)}if(p){const e=m;m=mJ(n,m,p,a,f),n.disposeIntermediateTensorInfo(e)}return m}};function t1(e,t,n,r,i,s,o,a,l){const u=lL([r,s],n);for(let c=0;c<r;c++){const n=[];let r=0;for(let t=0;t<i;t++){const s=e[c*i+t];r+=s*o[t],n.push(s)}if(r<0||r>=l/s)throw new Error(`Invalid indices: ${n} does not index into ${a}`);for(let e=0;e<s;e++)u.values[c*s+e]=t.get(...t.indexToLoc(r*s+e))}return u}const n1={kernelName:W_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,s=KR(r.shape),o=i.shape,a=o[o.length-1],[l,u,c,h]=WU(r,i);if(0===u)return n.makeTensorInfo(l,r.dtype,[]);const d=t1(n.data.get(i.dataId).values,n.bufferSync(r),r.dtype,u,a,c,h,r.shape,s);return n.makeTensorInfo(l,r.dtype,d.values)}};function r1(e,t,n){const r=lL(n,e.dtype);for(let i=0;i<r.size;++i){const n=r.indexToLoc(i).slice(),s=n[0],o=n[2],a=t.locToIndex([s,o]);n[2]=t.values[a];const l=e.locToIndex(n);0<=l&&l<e.values.length&&(r.values[i]=e.values[l])}return r}const i1={kernelName:U_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:s}=t,{axis:o,batchDims:a}=r;HQ([i,s],"gatherV2");const l=t$(o,i.shape)[0],u=n.data.get(s.dataId).values,c=i.shape[l];for(let b=0;b<u.length;++b){const e=u[b];GR(e<=c-1&&e>=0,(()=>`GatherV2: the index value ${e} is not in [0, ${c-1}]`))}let h=a;null==a&&(h=0);const d=KR(s.shape),p=OW(i,s,l,h),f=RJ({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),m=RJ({inputs:{x:s},backend:n,attrs:{shape:[p.batchSize,d/p.batchSize]}}),g=[p.batchSize,p.outerSize,d/p.batchSize,p.sliceSize],v=n.bufferSync(m),y=r1(n.bufferSync(f),v,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(p.outputShape,y.dtype,y.values)}},s1=iJ(((e,t)=>e>t?1:0)),o1=IJ(V_,s1,null,"bool"),a1={kernelName:V_,backendName:"cpu",kernelFunc:o1},l1=iJ(((e,t)=>e>=t?1:0)),u1=IJ(j_,l1,null,"bool"),c1={kernelName:j_,backendName:"cpu",kernelFunc:u1};const h1={kernelName:H_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,i=KR(r.shape),s=r.shape[r.shape.length-1],o=RJ({inputs:{x:r},backend:n,attrs:{shape:[i/s,s]}}),a=B0(o,!0,n),l=RJ({inputs:{x:a},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}},d1=YQ(K_,(e=>Number.isFinite(e)?1:0),"bool"),p1={kernelName:K_,backendName:"cpu",kernelFunc:d1},f1=YQ(X_,(e=>Math.abs(e)===1/0?1:0),"bool"),m1={kernelName:X_,backendName:"cpu",kernelFunc:f1},g1=YQ(Y_,(e=>Number.isNaN(e)?1:0),"bool"),v1={kernelName:Y_,backendName:"cpu",kernelFunc:g1},y1=iJ(((e,t)=>e<t?1:0)),b1=IJ(J_,y1,null,"bool"),x1={kernelName:J_,backendName:"cpu",kernelFunc:b1},w1=iJ(((e,t)=>e<=t?1:0)),k1=IJ(Z_,w1,null,"bool"),S1={kernelName:Z_,backendName:"cpu",kernelFunc:k1};function I1(e,t,n){const r=(t-e)/(n-1),i=g$(n,"float32");i[0]=e;for(let s=1;s<i.length;s++)i[s]=i[s-1]+r;return i}const C1={kernelName:eO,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:s}=n,o=I1(r,i,s);return t.makeTensorInfo([o.length],"float32",o)}},E1=XQ((e=>Math.log(e))),T1=QQ(tO,E1),N1={kernelName:tO,backendName:"cpu",kernelFunc:T1},A1=YQ(nO,(e=>Math.log1p(e))),R1={kernelName:nO,backendName:"cpu",kernelFunc:A1},$1=iJ(((e,t)=>e&&t)),_1=IJ(rO,$1,null,"bool"),O1={kernelName:rO,backendName:"cpu",kernelFunc:_1},D1=YQ(iO,(e=>e?0:1),"bool"),F1={kernelName:iO,backendName:"cpu",kernelFunc:D1},M1=iJ(((e,t)=>e||t)),L1=IJ(sO,M1,null,"bool"),P1={kernelName:sO,backendName:"cpu",kernelFunc:L1};const z1={kernelName:oO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:s,bias:o,alpha:a,beta:l}=r;HQ(i,"LRN");const u=i.shape[3],c=u-1,h=n.data.get(i.dataId).values,d=KR(i.shape),p=new Float32Array(d);function f(e){const t=e%u;let n=e-t+Math.max(0,t-s);const r=e-t+Math.min(t+s,c);let i=0;for(;n<=r;n++){const e=h[n];i+=e*e}return i}for(let m=0;m<d;m++){const e=f(m),t=h[m]*Math.pow(o+a*e,-l);p[m]=t}return n.makeTensorInfo(i.shape,i.dtype,p)}};const B1={kernelName:aO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,y:s,dy:o}=t,{depthRadius:a,bias:l,alpha:u,beta:c}=r;HQ(o,"LRNGrad");const h=KR(o.shape),d=o.shape[3],p=n.data.get(o.dataId).values,f=n.data.get(i.dataId).values,m=n.data.get(s.dataId).values,g=new Float32Array(h),v=h;for(let y=0;y<v;y++){const e=y%d,t=y-e+Math.max(0,e-a),n=y-e+Math.min(d,e+a+1);let r=0;for(let i=t;i<n;i++)r+=Math.pow(f[i],2);r=u*r+l;for(let i=t;i<n;i++){let e=-2*u*c*f[i]*m[y]/r;y===i&&(e+=Math.pow(r,-c)),e*=p[y],g[i]+=e}}return n.makeTensorInfo(o.shape,i.dtype,g)}};function U1(e,t,n,r){const i=r$(r,KR(n));for(let s=0;s<i.length;++s){const n=s*t;let r=e[n];for(let i=0;i<t;++i){const t=e[n+i];(Number.isNaN(t)||t>r)&&(r=t)}i[s]=r}return i}function W1(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:s,keepDims:o}=r,a=n;let l=i.shape;const u=l.length,c=t$(s,l);let h=c;const d=Iz(h,u);let p=a.data.get(i.dataId).values;if(null!=d){const e=new Array(u);for(let t=0;t<e.length;t++)e[t]=l[d[t]];p=WJ(p,l,i.dtype,d,e),h=Ez(h.length,u),l=e}HQ(i,"max"),Sz("max",h,u);const[f,m]=wz(l,h),g=U1(p,KR(m),f,i.dtype),v=a.write(g,f,i.dtype);let y=f;if(o){y=kz(f,c)}return{dataId:v,shape:y,dtype:i.dtype}}const V1={kernelName:lO,backendName:"cpu",kernelFunc:W1},j1=iJ(((e,t)=>Math.max(e,t))),G1=IJ(uO,j1),H1={kernelName:uO,backendName:"cpu",kernelFunc:G1};const q1={kernelName:cO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;HQ(i,"maxPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:l}=r;GR(AP(o,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`));const u=bP(i.shape,s,o,1,a,l);let c;if(1===u.filterWidth&&1===u.filterHeight&&XR(u.inShape,u.outShape))c=eJ({inputs:{x:i},backend:n});else{const e=n.data.get(i.dataId).values,t=d$(i.shape),r=oZ(e,i.shape,i.dtype,t,u,"max");c=n.makeTensorInfo(u.outShape,i.dtype,r.values)}return c}};const K1={kernelName:dO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;HQ(i,"maxPool3d");const c=xP(i.shape,s,o,1,a,l,u),h=lZ(n.data.get(i.dataId).values,i.shape,i.dtype,d$(i.shape),c,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}};const X1={kernelName:pO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;HQ([i,s],"maxPool3DGrad");const c=xP(s.shape,o,a,1,l,u),h=function(e,t){const n=lL(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,s=t.strideWidth,o=t.dilationDepth,a=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let v=0;v<t.outDepth;++v){const y=v*r-d;let b=y;for(;b<0;)b+=o;const x=Math.min(t.inDepth,u+y);for(let r=0;r<t.outHeight;++r){const u=r*i-p;let d=u;for(;d<0;)d+=a;const w=Math.min(t.inHeight,c+u);for(let i=0;i<t.outWidth;++i){const p=i*s-f;let k=p;for(;k<0;)k+=l;const S=Math.min(t.inWidth,h+p);let I=Number.NEGATIVE_INFINITY,C=-1;for(let t=b;t<x;t+=o){const n=t-y;for(let r=d;r<w;r+=a){const i=r-u;for(let s=k;s<S;s+=l){const o=s-p,a=e.get(m,t,r,s,g);a>=I&&(I=a,C=n*c*h+i*c+o)}}}n.set(C,m,v,r,i,g)}}}return n}(n.bufferSync(s),c),d=c.strideDepth,p=c.strideHeight,f=c.strideWidth,m=c.dilationDepth,g=c.dilationHeight,v=c.dilationWidth,y=c.effectiveFilterDepth,b=c.effectiveFilterHeight,x=c.effectiveFilterWidth,w=y-1-c.padInfo.front,k=x-1-c.padInfo.left,S=b-1-c.padInfo.top,I=lL(s.shape,"float32"),C=n.bufferSync(i);for(let E=0;E<c.batchSize;++E)for(let e=0;e<c.inChannels;++e)for(let t=0;t<c.inDepth;++t)for(let n=0;n<c.inHeight;++n)for(let r=0;r<c.inWidth;++r){const i=t-w,s=n-S,o=r-k;let a=0;for(let t=0;t<y;t+=m){const n=(i+t)/d;if(!(n<0||n>=c.outDepth||Math.floor(n)!==n))for(let r=0;r<b;r+=g){const i=(s+r)/p;if(!(i<0||i>=c.outHeight||Math.floor(i)!==i))for(let s=0;s<x;s+=v){const l=(o+s)/f;if(l<0||l>=c.outWidth||Math.floor(l)!==l)continue;const u=y*b*x-1-h.get(E,n,i,l,e)===t*b*x+r*x+s?1:0;if(0===u)continue;a+=C.get(E,n,i,l,e)*u}}}I.set(a,E,t,n,r,e)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}};const Y1={kernelName:hO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s,output:o}=t,a=s;HQ([s,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:h}=r,d=bP(a.shape,l,u,1,c,h),p=n.data.get(a.dataId).values,f=lL(d.outShape,a.dtype,aZ(p,a.shape,a.dtype,d).values),m=d.strideHeight,g=d.strideWidth,v=d.dilationHeight,y=d.dilationWidth,b=d.effectiveFilterHeight,x=d.effectiveFilterWidth,w=x-1-d.padInfo.left,k=b-1-d.padInfo.top,S=lL(a.shape,"float32"),I=n.data.get(i.dataId).values,C=lL(i.shape,"float32",I);for(let E=0;E<d.batchSize;++E)for(let e=0;e<d.inChannels;++e)for(let t=0;t<d.inHeight;++t)for(let n=0;n<d.inWidth;++n){const r=t-k,i=n-w;let s=0;for(let t=0;t<b;t+=v){const n=(r+t)/m;if(!(n<0||n>=d.outHeight||Math.floor(n)!==n))for(let r=0;r<x;r+=y){const o=(i+r)/g;if(o<0||o>=d.outWidth||Math.floor(o)!==o)continue;const a=b*x-1-f.get(E,n,o,e)===t*x+r?1:0;if(0===a)continue;s+=C.get(E,n,o,e)*a}}S.set(s,E,t,n,e)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};const Q1={kernelName:fO,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:i}=t,{filterSize:s,strides:o,pad:a,includeBatchInIndex:l}=n,u=r;HQ(i,"MaxPoolWithArgmax");const c=u.data.get(i.dataId).values,h=bP(i.shape,s,o,[1,1],a),[d,p]=function(e,t,n,r,i){const s=oZ(e,0,n,d$(t),i,"max"),o=aZ(e,t,n,i,!0,r);return[s.values,o.values]}(c,i.shape,i.dtype,l,h),f=u.write(d,h.outShape,i.dtype),m=u.write(p,h.outShape,i.dtype);return[{dataId:f,shape:h.outShape,dtype:i.dtype},{dataId:m,shape:h.outShape,dtype:"int32"}]}};const J1={kernelName:mO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=t$(s,i.shape),l=KR(wz(i.shape,a)[1]),u=[],c=n.makeTensorInfo([],"float32",new Float32Array([l]));u.push(c);const h=kJ({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});u.push(h);const d=D0({inputs:{a:h,b:c},backend:n});u.push(d);const p=c0({inputs:{x:d},backend:n,attrs:{axis:s,keepDims:o}});return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),p}};const Z1={kernelName:gO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;HQ(i,"min");const a=t$(s,i.shape);let l=a;const u=Iz(l,i.shape.length);let c=i;null!=u&&(c=VJ({inputs:{x:i},backend:n,attrs:{perm:u}}),l=Ez(l.length,i.shape.length)),Sz("min",l,c.shape.length);const[h,d]=wz(c.shape,l),p=KR(d),f=g$(KR(h),c.dtype),m=n.data.get(c.dataId).values;for(let v=0;v<f.length;++v){const e=v*p;let t=m[e];for(let n=0;n<p;++n){const r=m[e+n];(Number.isNaN(r)||r<t)&&(t=r)}f[v]=t}null!=u&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(h,c.dtype,f);if(o){const e=RJ({inputs:{x:g},backend:n,attrs:{shape:kz(h,a)}});return n.disposeIntermediateTensorInfo(g),e}return g}},e2=iJ(((e,t)=>Math.min(e,t))),t2=IJ(vO,e2),n2={kernelName:vO,backendName:"cpu",kernelFunc:t2};const r2={kernelName:yO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,mode:o}=r;HQ(i,"mirrorPad");const a=s.map(((e,t)=>e[0]+i.shape[t]+e[1])),l=s.map((e=>e[0])),u=s.map(((e,t)=>e[0]+i.shape[t])),c="reflect"===o?0:1,h=n.data.get(i.dataId).values,d=i.shape.length,p=d$(i.shape),f=KR(a),m=a.length,g=d$(a),v=r$(i.dtype,f);for(let y=0;y<f;y++){let e=x$(y,m,g);for(let n=0;n<m;n++)e[n]<l[n]?e[n]=2*l[n]-e[n]-c:e[n]>=u[n]&&(e[n]=2*(u[n]-1)-e[n]+c);e=e.map(((e,t)=>e-l[t]));const t=b$(e,d,p);v[y]=h[t]}return{dataId:n.write(v,a,i.dtype),shape:a,dtype:i.dtype}}},i2=iJ(((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),s2=IJ(bO,i2),o2={kernelName:bO,backendName:"cpu",kernelFunc:s2};function a2(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:s}=r,o=i.shape.length;let a=s;if(-1===a&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=t$([a],i.shape),u=W1({inputs:{x:i},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=kz(u.shape,l),h=RJ({inputs:{x:u},backend:n,attrs:{shape:c}}),d=P0({inputs:{a:i,b:h},backend:n}),p=E0({inputs:{x:d},backend:n}),f=c0({inputs:{x:p},backend:n,attrs:{axis:l,keepDims:!1}}),m=RJ({inputs:{x:f},backend:n,attrs:{shape:c}}),g=D0({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const l2={kernelName:hD,backendName:"cpu",kernelFunc:a2};const u2={kernelName:xO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:s,seed:o,normalized:a}=r;HQ(i,"multinomial");const l=a?i:a2({inputs:{logits:i},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],h=n.data.get(l.dataId).values,d=[u,s],p=g$(KR(d),"int32");for(let f=0;f<u;++f){const e=f*c,t=new Float32Array(c-1);t[0]=h[e];for(let i=1;i<t.length;++i)t[i]=t[i-1]+h[e+i];const n=jz.alea(o.toString()),r=f*s;for(let i=0;i<s;++i){const e=n();p[r+i]=t.length;for(let n=0;n<t.length;n++)if(e<t[n]){p[r+i]=n;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",p)}};function c2(e,t,n){const r=dF(-1,n);return o0([],t,r,e,n)}const h2={kernelName:kO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;HQ(r,"neg");const i=n.data.get(r.dataId).values,[s,o]=c2(i,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,s)}},d2=HB;const p2={kernelName:IO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r;HQ(i,"NonMaxSuppression");const u=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,{selectedIndices:h}=d2(u,c,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},f2=qB;const m2={kernelName:CO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r;HQ(i,"NonMaxSuppressionPadded");const c=n.data.get(i.dataId).values,h=n.data.get(s.dataId).values,{selectedIndices:d,validOutputs:p}=f2(c,h,o,a,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},g2=KB;const v2={kernelName:EO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r;HQ(i,"NonMaxSuppressionWithScore");const c=n.data.get(i.dataId).values,h=n.data.get(s.dataId).values,d=o,p=a,f=l,m=u,{selectedIndices:g,selectedScores:v}=g2(c,h,d,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}},y2=iJ(((e,t)=>e!==t?1:0)),b2=IJ(SO,y2,null,"bool"),x2={kernelName:SO,backendName:"cpu",kernelFunc:b2};const w2={kernelName:NO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:s,depth:o,onValue:a,offValue:l}=r;HQ(i,"oneHot");const u=KR(i.shape),c=new Float32Array(u*o);c.fill(l);const h=n.data.get(i.dataId).values;for(let d=0;d<u;++d)h[d]>=0&&h[d]<o&&(c[d*o+h[d]]=a);return n.makeTensorInfo([...i.shape,o],s,c)}};function k2(e){const{inputs:t,backend:n}=e,{x:r}=t;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const e=bJ({inputs:{input:r},backend:n}),t=k2({inputs:{x:e},backend:n}),i=$Z({inputs:{input:r},backend:n}),s=k2({inputs:{x:i},backend:n}),o=gJ({inputs:{real:t,imag:s},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),o}return j0({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const S2={kernelName:DD,backendName:"cpu",kernelFunc:k2};const I2={kernelName:TO,backendName:"cpu",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:i}=n;if("string"===i.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===i.dtype){const t=bJ({inputs:{input:i},backend:r}),n=e({inputs:{x:t},backend:r}),s=$Z({inputs:{input:i},backend:r}),o=k2({inputs:{x:s},backend:r}),a=gJ({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),a}return j0({backend:r,attrs:{shape:i.shape,value:1,dtype:i.dtype}})}};function C2(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(1===t.length)return N0({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const s=t[0].shape,o=t[0].dtype;t.forEach((e=>{HR(s,e.shape,"All tensors passed to stack must have matching shapes"),GR(o===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const a=[],l=OZ({inputs:t.map((e=>{const t=N0({inputs:{input:e},backend:n,attrs:{dim:i}});return a.push(t),t})),backend:n,attrs:{axis:i}});return a.forEach((e=>n.disposeIntermediateTensorInfo(e))),l}const E2={kernelName:AO,backendName:"cpu",kernelFunc:C2};const T2={kernelName:RO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,constantValue:o}=r;HQ(i,"pad");const a=s.map(((e,t)=>e[0]+i.shape[t]+e[1])),l=s.map((e=>e[0])),u=n.data.get(i.dataId).values,c=KR(i.shape),h=i.shape.length,d=d$(i.shape),p=KR(a),f=a.length,m=d$(a),g=r$(i.dtype,p);0!==o&&g.fill(o);for(let v=0;v<c;v++){g[b$(x$(v,h,d).map(((e,t)=>e+l[t])),f,m)]=u[v]}return{dataId:n.write(g,a,i.dtype),shape:a,dtype:i.dtype}}},N2=iJ(((e,t)=>Math.pow(e,t))),A2=IJ($O,N2),R2={kernelName:$O,backendName:"cpu",kernelFunc:A2};function $2(e,t,n,r){const[i,s]=wz(e,r),o=GF(t,"int32"),a=g$(KR(i),o),l=KR(s);for(let u=0;u<a.length;++u){const e=u*l;let t=1;for(let r=0;r<l;++r)t*=n[e+r];a[u]=t}return{outVals:a,outShape:i,outDtype:o}}const _2={kernelName:OO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;HQ(i,"prod");const a=i.shape.length,l=t$(s,i.shape),u=Iz(l,a);let c=l,h=i;const d=[];null!=u&&(h=VJ({inputs:{x:i},backend:n,attrs:{perm:u}}),d.push(h),c=Ez(c.length,a));const p=n.data.get(h.dataId).values,{outVals:f,outShape:m,outDtype:g}=$2(h.shape,h.dtype,p,c);let v=m;return o&&(v=kz(m,l)),d.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(v,g,f)}};function O2(e,t,n,r){const i=[];let s=0;const o=t.length-1+n.length,a=new Array(o).fill(null).map((()=>[0]));!function(e,t){for(let n=0;n<e.length;++n){const r=e[n],i=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let e=1;e<r.length;++e)if(r[e-1]>r[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let l=1;for(let u=0;u<t.length-1;++u){l*=t[u];const e=t[u+1];for(let t=1;t<l+1;++t)a[u].push(t*e)}for(let u=0;u<e.length;++u){let r=e[u],o=e[u]+1;for(let e=0;e<n.length;++e){const i=n[e],s=e+t.length-1;if(s>=0){const e=a[s],t=e[e.length-1]-i[r];for(let n=r;n<o;++n)a[s].push(i[n+1]+t)}r=i[r],o=i[o]}o!==r&&(i.push([r,o]),s+=o-r)}return{outSplits:a,valueSlices:i,numValues:s}}function D2(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function F2(e,t,n,r,i){const s=t.slice();s[0]=i;const o=i$(n,KR(s)),a=e.length;return function(e,t,n,r,i,s){const o=D2(t,2)[1],a=D2(s,2)[1];let l=0;for(const u of n)for(let t=u[0];t<u[1];++t){for(let n=0;n<r;++n)i[l*a+n]=e[t*o+n];++l}}(e,t,r,0===a?0:a/t[0],o,s),[o,s]}function M2(e,t,n,r,i,s,o,a){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach(((e,r)=>{if(e<0||e>=n){const i=x$(r,t.length,d$(t)).join(",");throw new Error(`indices[${i}] = ${e} is not in [0, ${n})`)}}))}(s,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const l=r[0],{outSplits:u,valueSlices:c,numValues:h}=O2(s,o,e,l),d=function(e){const t=[];for(let n=0;n<e.length;++n){const r=i$("int32",e[n].length);t.push(r),e[n].forEach(((e,t)=>r[t]=e))}return t}(u),p=F2(n,r,i,c,h);return[d,p[0],p[1]]}const L2={kernelName:DO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:s,indices:o}=t,{outputRaggedRank:a}=r,l=i.map((e=>n.data.get(e.dataId).values)),u=i.map((e=>e.shape)),c=n.data.get(s.dataId).values,h=n.data.get(o.dataId).values,[d,p,f]=M2(l,u,c,s.shape,s.dtype,h,o.shape),m=d.map((e=>n.makeTensorInfo([e.length],"int32",e))),g=n.makeTensorInfo(f,s.dtype,p);return m.concat([g])}},P2=2147483647;function z2(e,t,n,r,i,s,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=0===t.length,l=0===i.length,u=0===o.length,c=[];a||c.push(t[0]),l||c.push(i[0]),u||c.push(o[0]);for(let m=1;m<c.length;++m)if(c[m]!==c[m-1])throw new Error("starts, limits, and deltas must have the same shape");const h=0===c.length?1:c[0],d=i$("int32",h+1);d[0]=0;for(let m=0;m<h;++m){const t=a?e[0]:e[m],n=l?r[0]:r[m],i=u?s[0]:s[m];if(0===i)throw new Error("Requires delta != 0");let o;if(i>0&&n<t||i<0&&n>t)o=0;else if(o=Math.ceil(Math.abs((n-t)/i)),o>P2)throw new Error(`Requires ((limit - start) / delta) <= ${P2}`);d[m+1]=d[m]+o}const p=i$(n,d[h]);let f=0;for(let m=0;m<h;++m){const t=d[m+1]-d[m];let n=a?e[0]:e[m];const r=u?s[0]:s[m];for(let e=0;e<t;++e)p[f++]=n,n+=r}return[d,p]}const B2={kernelName:FO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:s}=t,o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[u,c]=z2(o,r.shape,r.dtype,a,i.shape,l,s.shape);return[n.makeTensorInfo([u.length],"int32",u),n.makeTensorInfo([c.length],r.dtype,c)]}};var U2=NU;class W2{constructor(e,t,n,r,i,s,o,a,l,u){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=i,this.defaultValue=s,this.defaultValueShape=o,this.rowPartitionValues=a,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=$U(u),this.raggedRank=_U(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===U2.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===U2.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case U2.VALUE_ROWIDS:return W2.getMaxWidthValueRowID(t);case U2.ROW_SPLITS:return W2.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${U2[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(0===t||1===t)return 0;let n=0;for(let r=0;r<t-1;++r){const t=e[r+1]-e[r];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(0===t)return 0;let n=0,r=e[0],i=0;for(let s=1;s<t;++s){const t=e[s];t!==r&&(r=t,i=Math.max(s-n,i),n=s)}return Math.max(t-n,i)}tensorShapeFromTensor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return j2(e,n)}calculateOutputSize(e){const t=this.valuesShape;OU(this.defaultValueShape,t);const n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=RU(this.raggedRank,n,t);r[0]<0&&(r[0]=e);for(let i=1;i<=this.raggedRank;++i)r[i]<0&&(r[i]=this.getMaxWidth(i));return r}calculateFirstParentOutputIndex(e,t,n){const r=Math.min(e,n),i=[];let s=0;for(let o=0;o<r;++o,s+=t)i.push(s);for(let o=r;o<e;++o)i.push(-1);return GR(i.length===e,(()=>"Final length of result must be equal to firstDimension.")),i}calculateOutputIndexRowSplit(e,t,n,r){const i=e.length,s=[];for(let o=0;o<i-1;++o){const i=e[o+1]-e[o];let a=Math.min(r,i),l=t[o];-1===l&&(a=0);for(let e=0;e<a;++e)s.push(l),l+=n;for(let e=0;e<i-a;++e)s.push(-1)}if(i>0&&s.length!==e[i-1])throw new Error("Invalid row split size.");return s}calculateOutputIndexValueRowID(e,t,n,r){const i=e.length,s=[];if(0===i)return[];let o=0,a=e[0];if(a>=t.length)throw new Error(`Got currentValueRowId=${a}, which is not less than ${t.length}`);let l=t[a];s.push(l);for(let u=1;u<i;++u){const i=e[u];if(i===a)l>=0&&(++o,o<r?l+=n:l=-1);else{if(o=0,a=i,i>=t.length)throw new Error(`Got nextValueRowId=${i} which is not less than ${t.length}`);l=t[i]}s.push(l)}if(s.length!==e.length)throw new Error("Invalid row ids.");return s}calculateOutputIndex(e,t,n,r){const i=this.getRowPartitionTensor(e),s=this.getRowPartitionTypeByDimension(e);switch(s){case U2.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,t,n,r);case U2.ROW_SPLITS:if(i.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(i,t,n,r);default:throw new Error(`Unsupported partition type: ${U2[s]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case U2.FIRST_DIM_SIZE:return e[0];case U2.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case U2.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${U2[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let s=n.length-2;s>=0;--s)n[s]=n[s+1]*t[s+1];const r=j2(t,!1),i=i$(this.valuesDType,KR(r));if(n[0]*t[0]>0){let s=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e){s=this.calculateOutputIndex(e-1,s,n[e],t[e])}this.setOutput(this.raggedRank,s,i,r)}return[r,i]}setOutput(e,t,n,r){if(0===n.length)return;const i=this.values,s=n;let o=r.slice();o=o.slice(e+1);const a=KR(o),l=t.length;let u=this.defaultValue;if(u.length!==a&&1!==u.length){const e=this.defaultValueShape;wM((()=>{const t=OP(u,e),n=BP(t,o);u=n.dataSync()}))}let c=0,h=0,d=0;for(let p=0;p<=l;++p){let e=p<l?t[p]:-1;if(e!==d){if(h<d){const e=i.subarray(c*a);V2(s.subarray(h*a),e,(d-h)*a)}if(p>=l){const t=n.length;e=Math.floor(t/a)}if(e>d)if(1===this.defaultValue.length)s.subarray(d*a,e*a).fill(this.defaultValue[0]),d=e;else for(;e>d;){V2(s.slice(d*a),u,a),++d}e<0?(c=p+1,h=d):(c=p,h=d,d=h+1)}else++d}}}function V2(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function j2(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function G2(e,t,n,r,i,s,o,a,l,u){return new W2(e,t,n,r,i,s,o,a,l,u).compute()}const H2={kernelName:MO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:s,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:l}=r,u=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,h=n.data.get(o.dataId).values,d=a.map((e=>n.data.get(e.dataId).values)),p=a.map((e=>e.shape)),[f,m]=G2(u,i.shape,c,s.shape,s.dtype,h,o.shape,d,p,l);return n.makeTensorInfo(f,s.dtype,m)}};function q2(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return g$(0,r);const i=g$(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),i[0]=e;for(let s=1;s<i.length;s++)i[s]=i[s-1]+n;return i}const K2={kernelName:LO,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:i,dtype:s,step:o}=n,a=q2(r,i,o,s);return t.makeTensorInfo([a.length],s,a)}},X2=YQ(zO,(e=>1/e)),Y2={kernelName:zO,backendName:"cpu",kernelFunc:X2};const Q2={kernelName:jO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r;HQ(i,"resizeBilinear");const l=d$(i.shape),[u,c]=a,[h,d,p,f]=i.shape,m=n.data.get(i.dataId).values,g=new Float32Array(KR([h,u,c,f])),v=[s&&u>1?d-1:d,s&&c>1?p-1:p],y=[s&&u>1?u-1:u,s&&c>1?c-1:c];let b=0;const x=v[0]/y[0],w=v[1]/y[1];for(let k=0;k<h;k++)for(let e=0;e<u;e++){let t;t=o?x*(e+.5)-.5:x*e;const n=Math.max(0,Math.floor(t)),r=t-n,i=Math.min(d-1,Math.ceil(t)),s=k*l[0]+n*l[1],a=k*l[0]+i*l[1];for(let e=0;e<c;e++){let t;t=o?w*(e+.5)-.5:w*e;const n=Math.max(0,Math.floor(t)),i=t-n,u=Math.min(p-1,Math.ceil(t)),c=s+n*l[2],h=a+n*l[2],d=s+u*l[2],v=a+u*l[2];for(let e=0;e<f;e++){const t=m[c+e],n=m[h+e],s=t+(m[d+e]-t)*i,o=s+(n+(m[v+e]-n)*i-s)*r;g[b++]=o}}}return n.makeTensorInfo([h,u,c,f],"float32",g)}};const J2={kernelName:GO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r;HQ([s,i],"resizeBilinearGrad");const a=d$(i.shape),[l,u,c,h]=i.shape,[,d,p]=s.shape,f=new Float32Array(l*u*c*h),m=[o&&d>1?u-1:u,o&&p>1?c-1:c],g=[o&&d>1?d-1:d,o&&p>1?p-1:p],v=m[0]/g[0],y=m[1]/g[1],b=n.data.get(s.dataId).values;let x=0;for(let w=0;w<l;w++){const e=w*a[0];for(let t=0;t<d;t++){const n=t*v,r=Math.floor(n),i=Math.min(Math.ceil(n),u-1),s=e+r*a[1],o=e+i*a[1],l=n-r,d=1-l;for(let e=0;e<p;e++){const t=e*y,n=Math.floor(t),r=Math.min(Math.ceil(t),c-1),i=t-n,u=1-i,p=s+n*a[2],m=s+r*a[2],g=o+n*a[2],v=o+r*a[2],w=d*u,k=d*i,S=l*u,I=l*i;for(let e=0;e<h;e++){const t=b[x++];f[p+e]+=t*w,f[m+e]+=t*k,f[g+e]+=t*S,f[v+e]+=t*I}}}}return n.makeTensorInfo([l,c,u,h],"float32",f)}};const Z2={kernelName:WO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r;HQ(i,"resizeNearestNeighbor");const l=d$(i.shape),[u,c]=a,[h,d,p,f]=i.shape,m=n.data.get(i.dataId).values,g=new Float32Array(h*u*c*f),v=[s&&u>1?d-1:d,s&&c>1?p-1:p],y=[s&&u>1?u-1:u,s&&c>1?c-1:c],b=v[0]/y[0],x=v[1]/y[1];let w=0;for(let k=0;k<h;k++){const e=k*l[0];for(let t=0;t<u;t++){const n=o?b*(t+.5):b*t;let r=Math.min(d-1,s?Math.round(n):Math.floor(n));o&&(r=Math.max(0,r));const i=e+r*l[1];for(let e=0;e<c;e++){const t=o?x*(e+.5):x*e;let n=Math.min(p-1,s?Math.round(t):Math.floor(t));o&&(n=Math.max(0,n));const r=i+n*l[2];for(let e=0;e<f;e++){const t=m[r+e];g[w++]=t}}}}return n.makeTensorInfo([h,u,c,f],i.dtype,g)}};const e3={kernelName:VO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r;HQ([s,i],"resizeNearestNeighborGrad");const a=d$(i.shape),l=d$(s.shape),[u,c,h,d]=i.shape,[,p,f]=s.shape,m=new Float32Array(u*c*h*d),g=n.data.get(s.dataId).values,v=[o&&p>1?c-1:c,o&&f>1?h-1:h],y=[o&&p>1?p-1:p,o&&f>1?f-1:f],b=v[0]/y[0],x=v[1]/y[1],w=1/b,k=1/x,S=2*Math.ceil(w)+2,I=2*Math.ceil(k)+2;for(let C=0;C<u;C++){const e=C*a[0];for(let t=0;t<c;t++){const n=e+t*a[1],r=Math.floor(t*w),i=Math.floor(r-S/2);for(let s=0;s<h;s++){const r=n+s*a[2],u=Math.floor(s*k),v=Math.floor(u-I/2);for(let n=0;n<d;n++){let a=0;for(let r=0;r<S;r++){const u=r+i;if(u<0||u>=p)continue;const d=e+u*l[1],m=u*b;if(t===Math.min(c-1,o?Math.round(m):Math.floor(m)))for(let e=0;e<I;e++){const t=e+v;if(t<0||t>=f)continue;const r=d+t*l[2],i=t*x;s===Math.min(h-1,o?Math.round(i):Math.floor(i))&&(a+=g[r+n])}}m[r+n]=a}}}}return n.makeTensorInfo(i.shape,i.dtype,m)}};const t3={kernelName:qO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:s}=r;HQ(i,"reverse");const o=i.shape.length,a=t$(s,i.shape);if(0===o)return eJ({inputs:{x:i},backend:n});const l=new TF(i.shape,i.dtype),u=n.bufferSync(i);for(let c=0;c<l.size;c++){const e=l.indexToLoc(c),t=e.slice();a.forEach((e=>t[e]=i.shape[e]-1-t[e])),l.set(u.get(...t),...e)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}},n3={kernelName:LD,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:i}=t,{radians:s,fillValue:o,center:a}=n,l=r,u=r$(i.dtype,KR(i.shape)),[c,h,d,p]=i.shape,[f,m]=MU(a,h,d),g=Math.sin(s),v=Math.cos(s),y=l.data.get(i.dataId).values;for(let b=0;b<c;b++){const e=b*d*h*p;for(let t=0;t<h;t++){const n=t*(d*p);for(let r=0;r<d;r++){const i=r*p;for(let s=0;s<p;s++){const a=[c,t,r,s],l=a[2],b=a[1];let x=(l-f)*v-(b-m)*g,w=(l-f)*g+(b-m)*v;x=Math.round(x+f),w=Math.round(w+m);let k=o;if("number"!==typeof o&&(k=3===s?255:o[s]),x>=0&&x<d&&w>=0&&w<h){k=y[e+w*(d*p)+x*p+s]}u[e+n+i+s]=k}}}}return{dataId:l.write(u,i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},r3=YQ(KO,(e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),i3={kernelName:KO,backendName:"cpu",kernelFunc:r3},s3=XQ((e=>1/Math.sqrt(e))),o3=QQ(XO,s3),a3={kernelName:XO,backendName:"cpu",kernelFunc:o3};function l3(e,t,n,r,i,s,o,a,l,u){const c=[r/i,i],h=e.values,d=t.values;if(0===r)return lL(n,t.dtype);const p=l instanceof TF?l:lL(c,t.dtype);"string"===typeof l||"number"===typeof l?p.values.fill(l):"boolean"===typeof l&&p.values.fill(+l);for(let f=0;f<s;f++){const e=[];let s=0;for(let t=0;t<o;t++){const n=h[f*o+t];e.push(n),s+=n*a[t]}if(s<0||s>=r/i)throw new Error(`Invalid indices: ${e} does not index into ${n}`);for(let n=0;n<i;n++)u?p.values[s*i+n]+=d[f*i+n]:p.values[s*i+n]=0===t.rank?d[0]:d[f*i+n]}return p}const u3={kernelName:YO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:s}=t,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=GU(0,i,o),d=l3(n.bufferSync(i),n.bufferSync(s),o,h,u,l,a,c,0,!0);return n.makeTensorInfo(o,d.dtype,d.values)}};function c3(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<t?n=i+1:r=i;return r}function h3(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<=t?n=i+1:r=i;return r}const d3={kernelName:JO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:s}=t,{side:o}=r,a=function(e,t,n,r,i,s){const o=i$("int32",n*i);for(let a=0;a<n;++a){const n=e.slice(a*r,(a+1)*r),l=a*i;for(let e=0;e<i;++e)o[l+e]="left"===s?c3(n,t[e+l]):h3(n,t[e+l])}return o}(n.data.get(i.dataId).values,n.data.get(s.dataId).values,i.shape[0],i.shape[1],s.shape[1],o);return n.makeTensorInfo(s.shape,"int32",a)}};const p3={kernelName:ZO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:s}=t;HQ([r,i,s],"select");const o=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,c=GF(i.dtype,s.dtype),h=g$(KR(i.shape),c);let d=0;const p=0===o||o>1||1===i.shape.length?1:KR(i.shape.slice(1));for(let f=0;f<a.length;f++)for(let e=0;e<p;e++)1===a[f]?h[d++]=l[f]:h[d++]=u[f];return n.makeTensorInfo(i.shape,c,h)}},f3=HU,m3=qU,g3=YQ(eD,(e=>e>=0?m3*e:f3*(Math.exp(e)-1))),v3={kernelName:eD,backendName:"cpu",kernelFunc:g3},y3=YQ(iD,(e=>e<0?-1:e>0?1:0)),b3={kernelName:iD,backendName:"cpu",kernelFunc:y3},x3=YQ(nD,(e=>Math.sin(e))),w3={kernelName:nD,backendName:"cpu",kernelFunc:x3},k3=YQ(rD,(e=>Math.sinh(e))),S3={kernelName:rD,backendName:"cpu",kernelFunc:k3},I3=Math.log(1.1920928955078125e-7)+2,C3=YQ(oD,(e=>{const t=e>-I3,n=e<I3,r=Math.exp(e);let i;return i=n?r:t?e:Math.log(1+r),i})),E3={kernelName:oD,backendName:"cpu",kernelFunc:C3};const T3={kernelName:uD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,paddings:o}=r;HQ([i],"spaceToBatchND");const a=KR(s),l=[[0,0]];l.push(...o);for(let g=1+s.length;g<i.shape.length;++g)l.push([0,0]);const u=T2.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),c=LU(u.shape,s,a,!1),h=PU(c.length,s.length,!1),d=zU(u.shape,s,a,!1),p=RJ({inputs:{x:u},backend:n,attrs:{shape:c}}),f=VJ({inputs:{x:p},backend:n,attrs:{perm:h}}),m=RJ({inputs:{x:f},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}};function N3(e,t,n,r,i,s,o){const a=t[0],l=s[0],u=new Array(l),c=new Array(a),h=t[1];if(0===l){if(0!==a)throw new Error(bW(a));return[i$(n,0),[0,h],i$(i,0),u,c]}let d=!0,p=0;const f=new Array(l).fill(0);for(let g=0;g<a;++g){const t=e[g*h];if(t<0)throw new Error(xW(g,t));if(t>=l)throw new Error(wW(g,t,l));++f[t],d=d&&t>=p,p=t}let m=!0;for(let g=0;g<l;++g){const e=0===f[g];u[g]=e,m=m&&!e,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&d){const t=e,n=r;for(let e=0;e<a;++e)c[e]=e;return[t,[a,h],n,u,c]}{const t=f[l-1],s=i$(n,t*h),d=i$(i,t),p=new Array(l).fill(0);for(let n=0;n<a;++n){const t=e[n*h],i=p[t],o=(0===t?0:f[t-1])+i;p[t]++;for(let r=0;r<h;++r)s[o*h+r]=e[n*h+r];d[o]=r[n],c[n]=o}for(let e=0;e<l;++e){if(0===p[e]){const t=0===e?0:f[e-1];s[t*h+0]=e;for(let e=1;e<h;++e)s[t*h+e]=0;d[t]=o}}return[s,[t,h],d,u,c]}}const A3={kernelName:dD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:s,defaultValue:o}=t;if(1!==s.shape.length)throw new Error(`Dense shape must be a vector, saw:\n        ${s.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n        ${i.shape}`);if(0!==o.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${o.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values[0],[h,d,p,f,m]=N3(a,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],i.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};function R3(e,t,n,r,i){const s=KR(r),o=t[0],a=i.length,l=[];let u=1,c=-1;for(let m=0;m<a;++m){const e=i[m];if(-1===e){if(-1!==c)throw new Error(kW(c,m));c=m,l.push(1)}else{if(e<0)throw new Error(SW(m,e));u*=e,l.push(e)}}if(-1!==c){if(u<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const e=Math.trunc(s/u);if(u*e!==s)throw new Error(CW(r,l));l[c]=e}if(KR(l)!==s)throw new Error(EW(r,l));const h=r.length,d=[];if(h>0){d[h-1]=1;for(let e=h-2;e>=0;--e)d[e]=d[e+1]*r[e+1]}const p=[];if(a>0){p[a-1]=1;for(let e=a-2;e>=0;--e)p[e]=p[e+1]*l[e+1]}const f=i$(n,o*a);for(let m=0;m<o;++m){let t=0;for(let n=0;n<h;++n)t+=e[m*h+n]*d[n];for(let e=0;e<a;++e)f[m*a+e]=Math.trunc(t/p[e]),t%=p[e]}return[f,[o,a],l]}const $3={kernelName:pD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:s}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${i.shape}`);if(1!==s.shape.length)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(n.data.get(i.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(s.dataId).values),[u,c,h]=R3(a,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([h.length],s.dtype,new Int32Array(h))]}};function _3(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const a=r.length,l=[t[0],e.length/t[0]],u=l[1],c=a>0?i[a-1]+1:0;if(c<0)throw new Error("segment ids must be >= 0");const h=t.slice();h[0]=c;const d=i$(n,h.reduce(((e,t)=>e*t),1));if(0===a)return c>0&&d.fill(o),[d,h];if(c<=0)throw new Error("segment ids must be >= 0");let p=0,f=1,m=0,g=i[p];for(;;){let t=0;if(f<a){if(t=i[f],g===t){++f;continue}if(g>=t)throw new Error("segment ids are not increasing")}if(g<0||g>=c)throw new Error(AW(g,c));g>m&&d.fill(o,m*u,g*u);for(let n=p;n<f;++n){const t=r[n];if(t<0||t>=l[0])throw new Error(RW(n,r[n],l[0]));for(let n=0;n<u;n++)d[g*u+n]+=e[t*u+n]}if(s)for(let e=0;e<u;e++)d[g*u+e]/=f-p;if(p=f,++f,m=g+1,g=t,f>a)break}return m<c&&d.fill(o,m*u,c*u),[d,h]}const O3={kernelName:fD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n          ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n          ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[u,c]=_3(o,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}};const D3={kernelName:mD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n         ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n         ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[u,c]=_3(o,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}};const F3={kernelName:gD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:o}=t,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:h,outputSize:d}=GU(0,i,a),p=!1,f=n.bufferSync(i);let m;switch(s.dtype){case"bool":m=l3(f,n.bufferSync(s),a,d,c,u,l,h,Boolean(n.data.get(o.dataId).values[0]),p);break;case"float32":m=l3(f,n.bufferSync(s),a,d,c,u,l,h,n.data.get(o.dataId).values[0],p);break;case"int32":m=l3(f,n.bufferSync(s),a,d,c,u,l,h,n.data.get(o.dataId).values[0],p);break;case"string":m=l3(f,n.bufferSync(s),a,d,c,u,l,h,gF(n.data.get(o.dataId).values[0]),p);break;default:throw new Error(`Unsupported type ${s.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}};const M3={kernelName:cD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:s,axis:o}=r,a=t$(o,i.shape)[0],l=yW(i,s,a),u=new Array(i.shape.length).fill(0),c=i.shape.slice();return l.map((e=>{const t=[...c];t[a]=e;const r=mZ({inputs:{x:i},backend:n,attrs:{begin:u,size:t}});return u[a]+=e,r}))}},L3=XQ((e=>Math.sqrt(e))),P3=YQ(aD,(e=>Math.sqrt(e))),z3={kernelName:aD,backendName:"cpu",kernelFunc:P3},B3={kernelName:yD,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{x:r}=t,i=n;HQ(r,"square");const s=i.data.get(r.dataId).values,o=new Float32Array(s.length);for(let a=0;a<s.length;++a){const e=s[a];o[a]=e*e}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},U3=iJ(((e,t)=>{const n=e-t;return n*n})),W3=IJ(vD,U3),V3={kernelName:vD,backendName:"cpu",kernelFunc:W3},j3=XQ(((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?"g":""),i)})),G3=QQ(bD,j3),H3={kernelName:bD,backendName:"cpu",kernelFunc:G3},q3=YQ(FD,((e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),K3={kernelName:FD,backendName:"cpu",kernelFunc:q3};function X3(e,t,n,r){const i=lL(e,t.dtype);for(let s=0;s<i.size;s++){const e=i.indexToLoc(s),o=new Array(e.length);for(let t=0;t<o.length;t++)o[t]=e[t]*n[t]+r[t];i.set(t.get(...o),...e)}return i}const Y3={kernelName:xD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:d}=r;HQ(i,"stridedSlice");const{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:v,begin:y,end:b,strides:x}=pP(i.shape,s,o,a,l,u,c,h,d);let w;if(m)w=RJ({inputs:{x:i},backend:n,attrs:{shape:f}});else if(g||v){GR(i.shape.length>=1,(()=>`Input must have rank at least 1, got: ${i.shape.length}`));const e=eP(y,b,x),t=mZ({inputs:{x:i},backend:n,attrs:{begin:y,size:e}});w=RJ({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{const e=X3(p,n.bufferSync(i),x,y);w=n.makeTensorInfo(f,e.dtype,e.values)}return w}};class Q3{constructor(e,t,n,r,i,s){this.separator=mF(e),this.nGramWidths=t,this.leftPad=mF(n),this.rightPad=mF(r),this.padWidth=i,this.preserveShort=s}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,i,s){for(let o=0;o<i;++o){const a=this.getPadWidth(s),l=Math.max(0,a-o),u=Math.max(0,a-(i-(o+1))),c=s-(l+u),h=t+(l>0?0:o-a);let d=0;d+=l*this.leftPad.length;for(let t=0;t<c;++t)d+=e[h+t].length;d+=u*this.rightPad.length;d+=(l+u+c-1)*this.separator.length,n[r+o]=new Uint8Array(d);const p=n[r+o];let f=0;const m=e=>e.forEach((e=>p[f++]=e));for(let e=0;e<l;++e)m(this.leftPad),m(this.separator);for(let t=0;t<c-1;++t)m(e[h+t]),m(this.separator);if(c>0){m(e[h+c-1]);for(let e=0;e<u;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<u-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){const n=e.length,r=t.length;if(r>0){let e=t[0];if(0!==e)throw new Error(`First split value must be 0, got ${e}`);for(let i=1;i<r;++i){let r=t[i]>=e;if(r=r&&t[i]<=n,!r)throw new Error(`Invalid split value ${t[i]}, must be in [${e}, ${n}]`);e=t[i]}if(e!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${e}`)}const i=r-1,s=i$("int32",r);if(0===n||0===r){const e=new Array(n);for(let t=0;t<=i;++t)s[t]=0;return[e,s]}s[0]=0;for(let a=1;a<=i;++a){const e=t[a]-t[a-1];let n=0;this.nGramWidths.forEach((t=>{n+=this.getNumNGrams(e,t)})),this.preserveShort&&e>0&&0===n&&(n=1),s[a]=s[a-1]+n}const o=new Array(s[i]);for(let a=0;a<i;++a){const n=t[a];let r=s[a];if(this.nGramWidths.forEach((i=>{const s=t[a+1]-t[a],l=this.getNumNGrams(s,i);this.createNGrams(e,n,o,r,l,i),r+=l})),this.preserveShort&&r===s[a]){const i=t[a+1]-t[a];if(0===i)continue;const s=i+2*this.padWidth,l=1;this.createNGrams(e,n,o,r,l,s)}}return[o,s]}}function J3(e,t,n,r,i,s,o,a){return new Q3(n,r,i,s,o,a).compute(e,t)}const Z3={kernelName:wD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:s,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:h}=t,d=n.data.get(c.dataId).values,p=n.data.get(h.dataId).values,[f,m]=J3(d,p,i,s,o,a,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(h.shape,"int32",m)]}};function e4(e,t,n,r){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(1===t.length){const i=t[0];let s=e.indexOf(i);for(;-1!==s;){const t=e.subarray(0,s);n&&0===t.length||r.push(t),s=(e=e.subarray(s+1)).indexOf(i)}return void(n&&0===e.length||r.push(e))}let i=0;for(let s=0;s<e.length+1;s++)if(s===e.length||-1!==t.indexOf(e[s])){const t=e.subarray(i,s);n&&0===t.length||r.push(t),i=s+1}}function t4(e,t,n){const r=e.length,i=[];let s=0,o=0;const a=new Array(r);for(let d=0;d<r;++d){const r=i.length;e4(e[d],t,n,i);const l=i.length-r;a[d]=l,s+=l,o=Math.max(o,l)}const l=i$("int32",2*s),u=new Array(s),c=[r,o];let h=0;for(let d=0;d<r;++d)for(let e=0;e<a[d];++e)l[2*h]=d,l[2*h+1]=e,u[h]=i[h],++h;return[l,u,c]}const n4={kernelName:kD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:s,delimiter:o}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(1!==s.shape.length)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(0!==o.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values[0],[u,c,h]=t4(a,l,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};function r4(e,t){const n=i$("int32",e.length);for(let r=0;r<e.length;++r)n[r]=hF(e[r]).modulo(t).getLowBitsUnsigned();return n}const i4={kernelName:SD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=r4(n.data.get(s.dataId).values,i);return n.makeTensorInfo(s.shape,"int32",o)}},s4=YQ(CD,(e=>Math.tan(e))),o4={kernelName:CD,backendName:"cpu",kernelFunc:s4},a4=YQ(ED,(e=>Math.tanh(e)));function l4(e,t){const n=new Array(e.rank);for(let i=0;i<n.length;i++)n[i]=e.shape[i]*t[i];const r=lL(n,e.dtype);for(let i=0;i<r.values.length;++i){const t=r.indexToLoc(i),n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=t[r]%e.shape[r];const s=e.locToIndex(n);r.values[i]=e.values[s]}return r}const u4=(e,t)=>{const n=t.value-e.value;return 0===n?e.index-t.index:n};function c4(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;for(;r>n;){if(r-n>600){const i=r-n+1,s=t-n+1,o=Math.log(i),a=.5*Math.exp(2*o/3),l=.5*Math.sqrt(o*a*(i-a)/i)*Math.sign(s-i/2);c4(e,t,Math.max(n,Math.floor(t-s*a/i+l)),Math.min(r,Math.floor(t+(i-s)*a/i+l)))}const i=e[t];let s=n,o=r;for(jR(e,n,t),u4(e[r],i)>0&&jR(e,n,r);s<o;){for(jR(e,s,o),s++,o--;u4(e[s],i)<0;)s+=1;for(;u4(e[o],i)>0;)o-=1}0===u4(e[n],i)?jR(e,n,o):(o+=1,jR(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}}function h4(e,t,n,r,i){const s=t[t.length-1],[o,a]=[e.length/s,s],l=r$(n,o*r),u=r$("int32",o*r);for(let h=0;h<o;h++){const t=h*a,n=e.subarray(t,t+a);let s=new Array(n.length);n.forEach(((e,t)=>s[t]={value:e,index:t})),r<s.length&&(c4(s,r),s=s.slice(0,r)),i&&s.sort(u4);const o=h*r,c=l.subarray(o,o+r),d=u.subarray(o,o+r);for(let e=0;e<r;e++)c[e]=s[e].value,d[e]=s[e].index}const c=t.slice();return c[c.length-1]=r,[lL(c,n,l),lL(c,"int32",u)]}function d4(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{const e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return WR(0,n,t-1)}(e,t);case"wrap":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{const e=t-1;n-=t*Math.trunc(n/e)}return WR(0,n,t-1)}(e,t);case"nearest":return function(e,t){return WR(0,e,t-1)}(e,t);default:return function(e){return e}(e)}}function p4(e,t,n,r,i,s,o,a,l,u,c){return 0<=a&&a<t&&0<=l&&l<n?e[o*r+a*i+l*s+u]:c}function f4(e,t,n,r,i,s,o,a,l,u,c){return p4(e,t,n,r,i,s,o,Math.round(a),Math.round(l),u,c)}function m4(e,t,n,r,i,s,o,a,l,u,c){const h=Math.floor(a),d=Math.floor(l),p=h+1,f=d+1;return(p-a)*((f-l)*p4(e,t,n,r,i,s,o,h,d,u,c)+(l-d)*p4(e,t,n,r,i,s,o,h,f,u,c))+(a-h)*((f-l)*p4(e,t,n,r,i,s,o,p,d,u,c)+(l-d)*p4(e,t,n,r,i,s,o,p,f,u,c))}function g4(e,t,n,r){const i=t$(t,n)[0],s=[1,n[0],1];for(let f=0;f<i;f++)s[0]*=n[f];s[1]=n[i];for(let f=i+1;f<n.length;f++)s[2]*=n[f];const o=new Map,a=new Int32Array(n[i]),l=new TF(s,r,e),u=[],c=1===s[0]&&1===s[2];for(let f=0;f<n[i];f++){let t;if(c)t=e[f].toString();else{const e=[];for(let t=0;t<s[0];t++)for(let n=0;n<s[2];n++)e.push(l.get(t,f,n));t=e.join(",")}const n=o.get(t);if(null!=n)a[f]=n;else{const e=o.size;o.set(t,e),a[f]=e,u.push(f)}}const h=s.slice();h[1]=o.size;const d=new TF(h,r);u.forEach(((e,t)=>{for(let n=0;n<s[0];n++)for(let r=0;r<s[2];r++)d.set(l.get(n,e,r),n,t,r)}));const p=n.slice();return p[i]=h[1],{outputValues:d.values,outputShape:p,indices:a}}const v4=[DJ,MJ,PJ,BJ,AJ,UJ,GJ,HJ,qJ,KJ,YJ,JJ,eZ,rZ,sZ,uZ,cZ,hZ,dZ,OJ,pZ,vZ,xZ,kZ,SZ,SJ,EZ,NZ,vJ,AZ,DZ,MZ,LZ,PZ,zZ,BZ,UZ,VZ,GZ,HZ,qZ,KZ,XZ,YZ,JZ,ZZ,e0,t0,n0,r0,i0,s0,d0,ZQ,p0,g0,I0,T0,A0,_0,V0,G0,H0,X0,J0,Z0,e1,n1,i1,a1,c1,tJ,h1,_Z,p1,m1,v1,rJ,x1,S1,C1,N1,R1,O1,F1,P1,z1,B1,V1,H1,q1,K1,X1,Y1,Q1,J1,Z1,n2,r2,o2,u2,u0,h2,p2,m2,v2,x2,w2,I2,E2,T2,R2,aJ,_2,L2,B2,H2,K2,xJ,F0,Y2,uJ,hJ,$J,Q2,J2,Z2,e3,t3,n3,i3,a3,u3,d3,p3,v3,fJ,b3,w3,S3,gZ,l2,E3,T3,A3,$3,O3,D3,F3,M3,z3,B3,V3,H3,K3,Y3,Z3,n4,i4,z0,h0,o4,{kernelName:ED,backendName:"cpu",kernelFunc:a4},{kernelName:QO,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{tensor:r,indices:i,updates:s}=t,{sliceRank:o,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=GU(0,i,r.shape),h=n.bufferSync(i),d=n.bufferSync(s),p=n.bufferSync(r),f=l3(h,d,r.shape,c,l,a,o,u,p,!1);return n.makeTensorInfo(r.shape,f.dtype,f.values)}},{kernelName:TD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:s}=r;HQ(i,"tile");const o=l4(n.bufferSync(i),s);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},{kernelName:ND,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:s,sorted:o}=r;HQ(i,"topk");const a=n.data.get(i.dataId).values,[l,u]=h4(a,i.shape,i.dtype,s,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}},{kernelName:AD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{image:i,transforms:s}=t,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=n,[c,h,d,p]=i.shape,[f,m]=null!=u?u:[h,d],g=[c,f,m,p],v=d$(i.shape),y=v[0],b=v[1],x=v[2],w=d$(g),k=w[0],S=w[1],I=w[2],C=r$(i.dtype,KR(g));C.fill(l);const E=r.data.get(i.dataId).values,T=r.data.get(s.dataId).values;for(let N=0;N<c;++N){const e=1===s.shape[0]?T:T.subarray(8*N,8*N+8);for(let t=0;t<f;++t)for(let n=0;n<m;++n)for(let r=0;r<p;++r){let i;const s=e[6]*n+e[7]*t+1;if(0===s)continue;const u=(e[0]*n+e[1]*t+e[2])/s,c=(e[3]*n+e[4]*t+e[5])/s,p=d4(u,d,a),f=d4(c,h,a);switch(o){case"nearest":i=f4(E,h,d,y,b,x,N,f,p,r,l);break;case"bilinear":i=m4(E,h,d,y,b,x,N,f,p,r,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}C[N*k+t*S+n*I+r]=i}return r.makeTensorInfo(g,i.dtype,C)}return{dataId:r.write(C,g,i.dtype),shape:i.shape,dtype:i.dtype}}},jJ,{kernelName:$D,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:s}=t;HQ(s,"unique");const o=r.data.get(s.dataId).values,{outputValues:a,outputShape:l,indices:u}=g4(o,i,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}},{kernelName:_D,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i.shape.length,a=i.shape[s],l=new Array(o-1);let u=0;for(let p=0;p<o;p++)p!==s&&(l[u++]=i.shape[p]);const c=new Array(o).fill(0),h=i.shape.slice();h[s]=1;const d=new Array(a);for(let p=0;p<d.length;p++){c[s]=p;const e=mZ({inputs:{x:i},backend:n,attrs:{begin:c,size:h}});d[p]=RJ({inputs:{x:e},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(e)}return d}},{kernelName:OD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:s}=t,{numSegments:o}=r;HQ(i,"unsortedSegmentSum");const a=[],l=[],u=i.shape.length-s.shape.length;let c=s;for(let d=0;d<u;++d){const e=N0({inputs:{input:c},backend:n,attrs:{dim:d+1}});c=e,l.push(e)}for(let d=0;d<o;++d){const e=dF(d,"int32"),t=n.makeTensorInfo([],"int32",e),r=m0({inputs:{a:t,b:c},backend:n}),s=kJ({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),o=l0({inputs:{a:s,b:i},backend:n}),u=c0({inputs:{x:o},backend:n,attrs:{axis:0,keepDims:!1}});a.push(u),l.push(t),l.push(r),l.push(s),l.push(o),l.push(u)}const h=C2({inputs:a,backend:n,attrs:{axis:0}});return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),h}},S2];for(const n of v4)KD(n);const y4={},b4={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function x4(e,t){if(!(e in y4)||null!=t){const n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==t?function(e){if(C$().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==e){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;n.addEventListener("webglcontextlost",(t=>{t.preventDefault(),delete y4[e]}),!1),C$().getBool("SOFTWARE_WEBGL_ENABLED")&&(b4.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",b4)||n.getContext("experimental-webgl",b4);return n.getContext("webgl2",b4)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;y4[e]=n}const n=y4[e];return null==n||n.isContextLost()?(delete y4[e],x4(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),y4[e])}var w4,k4,S4,I4,C4,E4;function T4(e,t){return[t,e]}function N4(e){const t=KR(e);return QR(Math.ceil(t/4))}function A4(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function R4(e,t){const n=e;let r,i,s,o,a,l,u,c,h,d;return 2===C$().getNumber("WEBGL_VERSION")?(r=n.R32F,i=n.R16F,s=n.RGBA16F,o=n.RGBA32F,a=n.RED,u=4,c=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(r=e.RGBA,i=e.RGBA,s=e.RGBA,o=n.RGBA,a=e.RGBA,u=4,c=4,h=null!=t?t.HALF_FLOAT_OES:null,d=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:h,textureTypeFloat:d}}function $4(e,t){const n=t();return C$().getBool("DEBUG")&&function(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}(e,t))}(e),n}(k4=w4||(w4={}))[k4.DENSE=0]="DENSE",k4[k4.SHARED_BATCH=1]="SHARED_BATCH",(I4=S4||(S4={}))[I4.RENDER=0]="RENDER",I4[I4.UPLOAD=1]="UPLOAD",I4[I4.PIXELS=2]="PIXELS",I4[I4.DOWNLOAD=3]="DOWNLOAD",(E4=C4||(C4={}))[E4.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",E4[E4.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",E4[E4.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",E4[E4.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",E4[E4.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16";function _4(e){return!!(C$().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function O4(e,t){return W4(e,(()=>e.getExtension(t)),'Extension "'+t+'" not supported on this browser.')}const D4=/ERROR: [0-9]+:([0-9]+):/g;function F4(e,t){const n=D4.exec(t);if(null==n)return console.log(`Couldn't parse line number in error: ${t}`),void console.log(e);const r=+n[1],i=e.split("\n"),s=i.length.toString().length+2,o=i.map(((e,t)=>JR((t+1).toString(),s)+e));let a=0;for(let h=0;h<o.length;h++)a=Math.max(o[h].length,a);const l=o.slice(0,r-1),u=o.slice(r-1,r),c=o.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${JR(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join("\n"))}function M4(e,t){if($4(e,(()=>e.validateProgram(t))),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function L4(e,t,n,r,i,s,o){const a=e.getAttribLocation(t,n);return-1!==a&&($4(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,r))),$4(e,(()=>e.vertexAttribPointer(a,i,e.FLOAT,!1,s,o))),$4(e,(()=>e.enableVertexAttribArray(a))),!0)}function P4(e,t,n,r){$4(e,(()=>function(e,t,n){V4(e,n),$4(e,(()=>e.activeTexture(e.TEXTURE0+n))),$4(e,(()=>e.bindTexture(e.TEXTURE_2D,t)))}(e,t,r))),$4(e,(()=>e.uniform1i(n,r)))}function z4(e,t,n){$4(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,n))),$4(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)))}function B4(e,t){$4(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,t))),$4(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)))}function U4(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}(e,t))}function W4(e,t,n){const r=$4(e,(()=>t()));if(null==r)throw new Error(n);return r}function V4(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){throw new Error(`textureUnit must be in ${`[gl.TEXTURE0, gl.TEXTURE${n}]`}.`)}}function j4(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return KR(e.slice(0,e.length-t))}function G4(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function H4(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[j4(e),...G4(e)]),t}function q4(e){return e%2===0}function K4(e,t){if(XR(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r)return!0;if(q4(n)&&q4(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&q4(e[0])&&q4(t[0])}let X4,Y4;function Q4(e,t){return null!=e.getExtension(t)}function J4(e){try{if(null!=x4(e))return!0}catch(dae){return console.log("Error when getting WebGL context: ",dae),!1}return!1}function Z4(e){if(0===e)return!1;const t=x4(e);if(1!==e){if(Q4(t,"EXT_color_buffer_float"))return e5(t);const e="EXT_color_buffer_half_float";if(Q4(t,e)){const n=t.getExtension(e);return function(e,t){const n=R4(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const i=1,s=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,i,s,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),a}(t,n)}return!1}if(!Q4(t,"OES_texture_float"))return!1;if(!Q4(t,"WEBGL_color_buffer_float"))return!1;return e5(t)}function e5(e){const t=R4(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function t5(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&GR("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the WebGL backend.`))}))}const n5=C$();function r5(){let e,t,n,r,i,s,o,a,l,u;return 2===C$().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",i="texture",s="outputColor",o="out vec4 outputColor;",a=C$().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",i="texture2D",s="gl_FragColor",o="",a="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:s,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}function i5(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=d$(t);return r.map(((t,i)=>`${`int ${e[i]} = ${n} / ${t}`}; ${i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${t}`:`index -= ${e[i]} * ${t}`};`)).join("")}function s5(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=d$(t);return r.map(((t,i)=>`${`int ${e[i]} = ${n} / outShapeStrides[${i}]`}; ${i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * outShapeStrides[${i}]`:`index -= ${e[i]} * outShapeStrides[${i}]`};`)).join("")}function o5(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=function(e,t){const n=e.length,r=e.map((e=>`${t}[${e}]`)),i=new Array(n-1);i[n-2]=r[n-1];for(let s=n-3;s>=0;--s)i[s]=`(${i[s+1]} * ${r[s+1]})`;return i}(e.map(((e,t)=>t)),t);return r.map(((t,i)=>`${`int ${e[i]} = ${n} / ${r[i]}`}; ${i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${r[i]}`:`index -= ${e[i]} * ${r[i]}`};`)).join("")}function a5(e){const t=d$(e).map((e=>e.toString()));return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;\n  }\n`}n5.registerFlag("HAS_WEBGL",(()=>n5.getNumber("WEBGL_VERSION")>0)),n5.registerFlag("WEBGL_VERSION",(()=>J4(2)?2:J4(1)?1:0)),n5.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),n5.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===n5.get("WEBGL_VERSION"))),n5.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),n5.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),n5.registerFlag("WEBGL_PACK",(()=>n5.getBool("HAS_WEBGL"))),n5.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_PACK_CLIP",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_PACK_REDUCE",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_LAZILY_UNPACK",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_CONV_IM2COL",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",(()=>n5.getBool("WEBGL_PACK"))),n5.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>function(e){if(null==X4){const t=x4(e);X4=t.getParameter(t.MAX_TEXTURE_SIZE)}return X4}(n5.getNumber("WEBGL_VERSION")))),n5.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>function(e){if(null==Y4){const t=x4(e);Y4=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Y4)}(n5.getNumber("WEBGL_VERSION")))),n5.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const e=n5.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;let t;const n=x4(e);return t=Q4(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Q4(n,"EXT_disjoint_timer_query")?1:0,t}(e)})),n5.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>n5.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!oM())),n5.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>function(e){if(0===e)return!1;const t=x4(e);if(1===e){if(!Q4(t,"OES_texture_float"))return!1}else if(!Q4(t,"EXT_color_buffer_float"))return!1;return e5(t)}(n5.getNumber("WEBGL_VERSION")))),n5.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!n5.getBool("WEBGL_FORCE_F16_TEXTURES")&&n5.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),n5.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>Z4(n5.getNumber("WEBGL_VERSION")))),n5.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>{return 2===(e=n5.getNumber("WEBGL_VERSION"))&&null!=x4(e).fenceSync;var e})),n5.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>n5.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),n5.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(e=>{if("number"!==typeof e)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&-1!==e)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)})),n5.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>oM()?1:-1),(e=>{if("number"!==typeof e)throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&-1!==e)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)})),n5.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),n5.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),n5.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),n5.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),n5.registerFlag("WEBGL_EXP_CONV",(()=>!1)),n5.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>n5.getBool("IS_TEST"))),n5.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),n5.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),n5.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1)),n5.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1));const l5="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:u5}=r;function c5(e,t,n){const r=[];if(e.forEach((e=>{const t=KR(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push(`uniform float ${e.name}${t>1?`[${t}]`:""};`):(r.push(`uniform sampler2D ${e.name};`),r.push(`uniform int offset${e.name};`)),n.enableShapeUniforms){const{uniformShape:t}=w5(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:r.push(`uniform int ${e.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${e.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${e.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${e.name}Shape;`)}r.push(`uniform ivec2 ${e.name}TexShape;`)}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((e=>{r.push(`uniform ${e.type} ${e.name}${e.arrayIndex?`[${e.arrayIndex}]`:""};`)}));const i=r.join("\n"),s=e.map((e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i="";i+=n?d5(e,r):h5(e,r);const s=e.shapeInfo.logicalShape,o=t.logicalShape;s.length<=o.length&&(i+=n?function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,a=u5(e.shapeInfo.logicalShape,t.logicalShape),l=x5(o),u=o-s;let c;const h=["x","y","z","w","u","v"];c=0===s?"":o<2&&a.length>=1?"coords = 0;":a.map((e=>`coords.${h[e+u]} = 0;`)).join("\n");let d="";d=o<2&&s>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${h[t+u]}`)).join(", ");let p="return outputValue;";const f=1===KR(e.shapeInfo.logicalShape),m=KR(t.logicalShape),g=1===m;if(1!==s||f||g){if(f&&!g)p=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(a.length){const e=s-2,t=s-1;a.indexOf(e)>-1&&a.indexOf(t)>-1?p="return vec4(outputValue.x);":a.indexOf(e)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(t)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${i}() {\n      ${l} coords = getOutputCoords();\n      ${c}\n      vec4 outputValue = get${r}(${d});\n      ${p}\n    }\n  `}(e,t):function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=t.texShape,o=e.shapeInfo.texShape,a=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&a===l&&null==e.shapeInfo.flatOffset&&XR(o,s))return`\n      float ${i}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;const u=x5(l),c=u5(e.shapeInfo.logicalShape,t.logicalShape),h=l-a;let d;const p=["x","y","z","w","u","v"];d=0===a?"":l<2&&c.length>=1?"coords = 0;":c.map((e=>`coords.${p[e+h]} = 0;`)).join("\n");let f="";f=l<2&&a>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${p[t+h]}`)).join(", ");return`\n    float ${i}() {\n      ${u} coords = getOutputCoords();\n      ${d}\n      return get${r}(${f});\n    }\n  `}(e,t));return i}(e,t,n.packedInputs,n.enableShapeUniforms))).join("\n"),o=t.texShape,a=r5(),l=function(e){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${e.texture2D}(textureSampler, uv).r;\n    }\n  `}(a);let u,c,h=function(e){const t=`${e.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${e.varyingFs} vec2 resultUV;\n    ${e.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${e.defineSpecialNaN}\n    ${e.defineSpecialInf}\n    ${e.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${p5}\n    ${f5}\n    ${m5}\n  `;return t}(a);t.isPacked?(u=function(e,t,n){switch(e.length){case 0:return v5();case 1:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${r[1]}.0);\n      }\n    `;if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${r[0]}.0);\n      }\n    `;if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);\n    }\n  `}(0,t,n);case 2:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(XR(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));\n      }\n    `;const i=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),s=i*Math.ceil(e[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      int b = index / ${s};\n      index -= b * ${s};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),s=i*Math.ceil(e[e.length-2]/2);let o=s,a="",l="b, r, c";for(let u=2;u<e.length-1;u++)o*=e[e.length-u-1],a=`\n      int b${u} = index / ${o};\n      index -= b${u} * ${o};\n    `+a,l=`b${u}, `+l;return`\n    ivec${e.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      ${a}\n\n      int b = index / ${s};\n      index -= b * ${s};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec${e.length}(${l});\n    }\n  `}(e,t,n)}}(t.logicalShape,o,n.enableShapeUniforms),c=function(e){return`\n    void setOutput(vec4 val) {\n      ${e.output} = val;\n    }\n  `}(a)):(u=function(e,t,n){switch(e.length){case 0:return v5();case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${t[1]}.0);\n      }\n    `;if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${t[0]}.0);\n      }\n    `;if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      return resTexRC.x * ${t[1]} + resTexRC.y;\n    }\n  `}(0,t,n);case 2:return function(e,t,n){if(XR(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));\n      }\n    `;if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `;if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `;if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      int r = index / ${e[1]};\n      int c = index - r * ${e[1]};\n      return ivec2(r, c);\n    }\n  `}(e,t,n);case 3:return function(e,t,n){if(n){return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${s5(["r","c","d"],e)}\n    return ivec3(r, c, d);\n  }\n`}const r=i5(["r","c","d"],e);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec3(r, c, d);\n    }\n  `}(e,t,n);case 4:return function(e,t,n){if(n){return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${s5(["r","c","d","d2"],e)}\n      return ivec4(r, c, d, d2);\n    }\n  `}const r=i5(["r","c","d","d2"],e);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec4(r, c, d, d2);\n    }\n  `}(e,t,n);case 5:return function(e,t){const n=i5(["r","c","d","d2","d3"],e);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},\n                             ${t[1]}));\n\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(e,t);case 6:return function(e,t){const n=i5(["r","c","d","d2","d3","d4"],e);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}(t.logicalShape,o,n.enableShapeUniforms),c=function(e){return`\n    void setOutput(float val) {\n      ${e.output} = vec4(val, 0, 0, 0);\n    }\n  `}(a)),n.packedInputs&&(h+=g5);return[h,l,c,i,u,s,n.userCode].join("\n")}function h5(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[i,s]=e.shapeInfo.texShape;if(1===i&&1===s)return`\n      float ${r}() {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const o=y5(n);if(t)return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});\n      return sampleTexture(${n}, uv);\n    }\n  `;const[a,l]=e.shapeInfo.texShape;return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${a}, ${l}, ${o});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`\n      float ${r}(int index) {\n        ${b5(e)}\n      }\n    `;const i=e.shapeInfo.texShape,s=i[0],o=i[1];if(1===o&&1===s)return`\n      float ${r}(int index) {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const a=y5(n);if(1===o)return t?`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${s}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(1===s)return t?`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(t)return`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});\n      return sampleTexture(${n}, uv);\n    }\n  `;return`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${s}, ${o}, index + ${a});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape;if(null!=s&&XR(n,s)){if(t)return`\n      float ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `;const e=s[0];return`\n    float ${i}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${s[1]}.0, ${e}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `}const{newShape:o,keptDims:a}=n$(n),l=o;if(l.length<n.length){const n=["row","col"];return`\n      ${h5(k5(e,l),t)}\n      float ${i}(int row, int col) {\n        return ${i}(${S5(n,a)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${i}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));\n        ${b5(e)}\n      }\n    `;const u=s[0],c=s[1],h=y5(r);if(1===c)return t?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;if(1===u)return t?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);\n      return sampleTexture(${r}, uv);\n    }\n  `;if(t)return`\n      float ${i}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r}Shape[1] + col + ${h};\n        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n        return sampleTexture(${r}, uv);\n      }\n    `;return`\n  float ${i}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${n[1]} + col + ${h};\n    vec2 uv = uvFromFlat(${u}, ${c}, index);\n    return sampleTexture(${r}, uv);\n  }\n`}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=n$(n),u=a;if(u.length<n.length){const n=["row","col","depth"];return`\n        ${h5(k5(e,u),t)}\n        float ${i}(int row, int col, int depth) {\n          return ${i}(${S5(n,l)});\n        }\n      `}if(e.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${s}, ${o}, 1)));\n        ${b5(e)}\n      }\n    `;const c=e.shapeInfo.texShape,h=c[0],d=c[1],p=e.shapeInfo.flatOffset;if(d===s&&null==p)return t?`\n      float ${i}(int row, int col, int depth) {\n        int stride1 = ${r}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n        float ${i}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${o}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${d}.0, ${h}.0);\n          return sampleTexture(${r}, uv);\n        }\n      `;if(d===o&&null==p)return t?`\n      float ${i}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const f=y5(r);if(t)return`\n    float ${i}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${r}Shape[1] * ${r}Shape[2];\n      int stride1 = ${r}Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ${f};\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n      return sampleTexture(${r}, uv);\n    }\n    `;return`\n      float ${i}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${s} + col * ${o} + depth + ${f};\n        vec2 uv = uvFromFlat(${h}, ${d}, index);\n        return sampleTexture(${r}, uv);\n      }\n  `}(e,t);case 4:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[3],o=n[2]*s,a=n[1]*o,{newShape:l,keptDims:u}=n$(n);if(l.length<n.length){const n=["row","col","depth","depth2"];return`\n      ${h5(k5(e,l),t)}\n      float ${i}(int row, int col, int depth, int depth2) {\n        return ${i}(${S5(n,u)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${a}, ${o}, ${s}, 1)));\n        ${b5(e)}\n      }\n    `;const c=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],p=h[1],f=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(p===a&&null==c)return t?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        ${f}\n        ${m}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${o}, ${s}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${d}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(p===s&&null==c)return t?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${n[1]*n[2]}, ${n[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${d}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const v=y5(r);if(t)return`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${f}\n      ${m}\n      ${g}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${v});\n      return sampleTexture(${r}, uv);\n    }\n  `;return`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${o} +\n          depth * ${s} + depth2;\n      vec2 uv = uvFromFlat(${d}, ${p}, index + ${v});\n      return sampleTexture(${r}, uv);\n    }\n  `}(e,t);case 5:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],s=t[3]*i,o=t[2]*s,a=t[1]*o,{newShape:l,keptDims:u}=n$(t);if(l.length<t.length){const t=["row","col","depth","depth2","depth3"];return`\n      ${h5(k5(e,l))}\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        return ${r}(${S5(t,u)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${a}, ${o}, ${s}, ${i})) +\n          depth3;\n        ${b5(e)}\n      }\n    `;const c=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],p=h[1];if(p===a&&null==c)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${o}, ${s}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${d}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(p===i&&null==c)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]},\n               ${t[2]*t[3]}, ${t[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${d}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const f=y5(n);return`\n    float ${r}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${o} + depth * ${s} +\n          depth2 * ${i} + depth3 + ${f};\n      vec2 uv = uvFromFlat(${d}, ${p}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(e);case 6:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:s}=n$(t);if(i.length<t.length){const t=["row","col","depth","depth2","depth3","depth4"];return`\n      ${h5(k5(e,i))}\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${r}(${S5(t,s)});\n      }\n    `}const o=t[5],a=t[4]*o,l=t[3]*a,u=t[2]*l,c=t[1]*u;if(e.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${c}, ${u}, ${l}, ${a})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${o}, 1)));\n        ${b5(e)}\n      }\n    `;const h=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],f=d[1];if(f===c&&null==h)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${u}, ${l}, ${a}, ${o})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(f===o&&null==h)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]*t[4]},\n               ${t[2]*t[3]*t[4]},\n               ${t[3]*t[4]},\n               ${t[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const m=y5(n);return`\n    float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${c} + col * ${u} + depth * ${l} +\n          depth2 * ${a} + depth3 * ${o} + depth4 + ${m};\n      vec2 uv = uvFromFlat(${p}, ${f}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function d5(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=r5();return`\n    vec4 ${n}() {\n      return ${r.texture2D}(${t}, halfCR);\n    }\n  `}(e);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,s=r5();if(t)return`\n    vec4 ${r}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${s.texture2D}(${n}, uv);\n    }\n  `;const o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`\n    vec4 ${r}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${o[0]}, ${o[1]}, index);\n      return ${s.texture2D}(${n}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,o=s[0],a=s[1],l=r5();if(null!=s&&XR(n,s))return t?`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n\n        return ${l.texture2D}(${r}, uv);\n      }\n    `:`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);\n\n        return ${l.texture2D}(${r}, uv);\n      }\n    `;if(t)return`\n    vec4 ${i}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `;const u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=Math.ceil(n[1]/2);return`\n    vec4 ${i}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(1===n[0]){const r=[1,2],s=["b","row","col"];return`\n        ${d5(k5(e,n.slice(1)),t)}\n        vec4 ${i}(int b, int row, int col) {\n          return ${i}(${S5(s,r)});\n        }\n      `}const a=r5();if(t)return`\n    vec4 ${i}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${a.texture2D}(${r}, uv);\n    }\n  `;const l=o[0],u=o[1],c=Math.ceil(n[2]/2),h=c*Math.ceil(n[1]/2);return`\n    vec4 ${i}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${l}, ${u}, ${h}, ${c}, b, row, col);\n      return ${a.texture2D}(${r}, uv);\n    }\n  `}(e,t);default:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=r5();if(t)return`\n    vec4 ${r}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${n}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);\n    }\n  `;const s=e.shapeInfo.logicalShape,o=s.length,a=e.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],h=Math.ceil(s[o-1]/2);let d=h*Math.ceil(s[o-2]/2),p="int b, int row, int col",f=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let m=2;m<o-1;m++)p=`int b${m}, `+p,d*=s[o-m-1],f=`b${m} * ${d} + `+f;return`\n    vec4 ${r}(${p}) {\n      int index = ${f};\n      int texR = index / ${c};\n      int texC = index - texR * ${c};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});\n      return ${i.texture2D}(${n}, uv);\n    }\n  `}(e,t)}}const p5="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",f5="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",m5="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",g5="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function v5(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function y5(e){return`offset${e}`}function b5(e){const t=e.name,n=KR(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${t}[i];\n      }\n    }\n  `}function x5(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function w5(e,t,n){const{newShape:r,keptDims:i}=n$(t),s=t.length,o=e&&3===s&&1===t[0],a=o?t.slice(1):r,l=!e&&s>1&&!XR(t,n)&&r.length<s||o;return{useSqueezeShape:l,uniformShape:l?a:t,keptDims:i}}function k5(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function S5(e,t){return t.map((t=>e[t])).join(", ")}function I5(e,t,n,r){const i=n.map(((e,n)=>{const r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),s=i.map((e=>e.shapeInfo)),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=c5(i,o,t),l=function(e,t){const n=W4(e,(()=>e.createShader(e.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if($4(e,(()=>e.shaderSource(n,t))),$4(e,(()=>e.compileShader(n))),C$().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw F4(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,a),u=e.createProgram(l);return C$().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:s,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(u),Object.assign({program:t,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:s,outShapeInfo:o},C5(e,t,u)))}function C5(e,t,n){const r=[],i=[];let s,o,a,l=null,u=null;u=e.getUniformLocation(n,"NAN",!1),1===C$().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const h of t.variableNames){const i={name:h,uniform:e.getUniformLocation(n,h,c),offset:e.getUniformLocation(n,`offset${h}`,c)};t.enableShapeUniforms&&(i.shape=e.getUniformLocation(n,`${h}Shape`,c),i.texShape=e.getUniformLocation(n,`${h}TexShape`,c)),r.push(i)}if(t.enableShapeUniforms&&(s=e.getUniformLocation(n,"outShape",c),a=e.getUniformLocation(n,"outShapeStrides",c),o=e.getUniformLocation(n,"outTexShape",c)),t.customUniforms)for(const h of t.customUniforms)i.push(e.getUniformLocation(n,h.name,c));return{variablesLocations:r,customUniformLocations:i,infLoc:l,nanLoc:u,outShapeLocation:s,outShapeStridesLocation:a,outTexShapeLocation:o}}function E5(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach(((e,n)=>{const r=e.logicalShape,i=t[n],s=i.shape;if(!XR(r,s))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${s} must match`);if(e.isUniform&&i.isUniform)return;const o=e.texShape,a=i.isUniform?null:i.texData.texShape;if(!XR(o,a))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${a} must match`)}))}function T5(e){return C$().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class N5{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=w4.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=r5();this.outputShape=e,this.enableShapeUniforms=T5(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?s5(["r","c","d"],e):i5(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${t.output} = result;\n      }\n    `}}class A5{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=w4.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=r5();this.outputShape=e,this.enableShapeUniforms=T5(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?s5(["r","c","d"],e):i5(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${t.output} = result;\n      }\n    `}}class R5{constructor(e){this.variableNames=["A"],this.outTexUsage=S4.DOWNLOAD;const t=r5();this.outputShape=e,this.userCode=`\n      ${l5}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${t.output} = encode_float(x);\n      }\n    `}}class $5{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=S4.DOWNLOAD;const t=r5();this.outputShape=e,this.userCode=`\n      ${l5}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${t.output} = encode_float(x);\n      }\n    `}}const _5={R:0,G:1,B:2,A:3};class O5{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=r5();this.outputShape=e,this.enableShapeUniforms=T5(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)");let s="";for(let o=0;o<n.length;o++){const e=n[o];s+=`\n          if(offset == ${o}) {\n            result = values[${_5[e]}];\n          }`}this.userCode=`\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":a5(e)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ${n.length});\n\n        flatIndex = idiv(flatIndex, ${n.length}, 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ${r.texture2D}(A, uv);\n          ${s}\n        }\n        ${r.output} = vec4(${i}, 0., 0., 0.);\n      }\n    `}}class D5{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=r5();this.outputShape=e,this.enableShapeUniforms=T5(this.outputShape.length);let r="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let s=0;s<=1;s++)for(let t=0;t<=1;t++){const i=2*s+t;r+=`\n          localCoords = coords;\n          if(localCoords[2] + ${t} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {\n          localCoords[2] += ${t};\n          if (localCoords[1] + ${s} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {\n            localCoords[1] += ${s};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${n.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${i}] = values[0];\n            } else if (offset == 1) {\n              result[${i}] = values[1];\n            } else if (offset == 2) {\n              result[${i}] = values[2];\n            } else {\n              result[${i}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":a5(e)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${r}\n\n          ${n.output} = ${i};\n        }\n    `}}function F5(e){const t=r5();return function(e,t){const n=W4(e,(()=>e.createShader(e.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if($4(e,(()=>e.shaderSource(n,t))),$4(e,(()=>e.compileShader(n))),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,`${t.version}\n    precision highp float;\n    ${t.attribute} vec3 clipSpacePos;\n    ${t.attribute} vec2 uv;\n    ${t.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}function M5(e){return function(e,t){const n=W4(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return $4(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),$4(e,(()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW))),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function L5(e){return function(e,t){const n=W4(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return $4(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n))),$4(e,(()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW))),n}(e,new Uint16Array([0,1,2,2,1,3]))}function P5(e,t,n,r,i,s){!function(e,t){const n=C$().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0)throw new Error(`Requested texture size [${e}x${t}] is invalid.`);if(e>n||t>n)throw new Error(`Requested texture size [${e}x${t}] greater than WebGL maximum on this browser / GPU [${n}x${n}].`)}(t,n);const o=function(e){return W4(e,(()=>e.createTexture()),"Unable to create WebGLTexture.")}(e),a=e.TEXTURE_2D;return $4(e,(()=>e.bindTexture(a,o))),$4(e,(()=>e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE))),$4(e,(()=>e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE))),$4(e,(()=>e.texParameteri(a,e.TEXTURE_MIN_FILTER,e.NEAREST))),$4(e,(()=>e.texParameteri(a,e.TEXTURE_MAG_FILTER,e.NEAREST))),1===C$().getNumber("WEBGL_VERSION")?$4(e,(()=>e.texImage2D(a,0,r,t,n,0,i,s,null))):$4(e,(()=>e.texStorage2D(a,1,r,t,n))),$4(e,(()=>e.bindTexture(e.TEXTURE_2D,null))),{texture:o,texShape:[n,t]}}function z5(e){return e.internalFormatFloat}function B5(e){return e.internalFormatHalfFloat}function U5(e){return e.downloadTextureFormat}function W5(e){return e.internalFormatPackedFloat}function V5(e){return e.internalFormatPackedHalfFloat}function j5(e,t,n,r,i,s,o,a){const l=e,u=new Float32Array(function(e,t){const[n,r]=A4(e,t);return n*r*4}(s,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}class G5{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=C$().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,function(e,t){y4[e]=t}(t,e)):this.gl=x4(t),e=this.gl,2===C$().getNumber("WEBGL_VERSION")){const t=e;this.createVertexArray=()=>$4(t,(()=>t.createVertexArray())),this.bindVertexArray=e=>$4(t,(()=>t.bindVertexArray(e))),this.deleteVertexArray=e=>$4(t,(()=>t.deleteVertexArray(e))),this.getVertexArray=()=>$4(t,(()=>t.getParameter(t.VERTEX_ARRAY_BINDING)))}else if(null!=e){const t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>$4(e,(()=>t.createVertexArrayOES())),this.bindVertexArray=n=>$4(e,(()=>t.bindVertexArrayOES(n))),this.deleteVertexArray=n=>$4(e,(()=>t.deleteVertexArrayOES(n))),this.getVertexArray=()=>$4(e,(()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES)))}let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===C$().getNumber("WEBGL_VERSION")){const e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=O4(this.gl,e),Q4(this.gl,t))this.textureHalfFloatExtension=O4(this.gl,t);else if(C$().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Q4(this.gl,r))this.colorBufferHalfFloatExtension=O4(this.gl,r);else if(C$().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Q4(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Q4(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=M5(this.gl),this.indexBuffer=L5(this.gl),this.framebuffer=function(e){return W4(e,(()=>e.createFramebuffer()),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=R4(this.gl,this.textureHalfFloatExtension)}get debug(){return C$().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;$4(e,(()=>e.finish())),$4(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,null))),$4(e,(()=>e.deleteFramebuffer(this.framebuffer))),$4(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,null))),$4(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null))),$4(e,(()=>e.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[i,s]=T4(t,n);return P5(e,i,s,z5(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[i,s]=T4(t,n);return P5(e,i,s,B5(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[i,s]=T4(t,n);return P5(e,i,s,U5(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),function(e,t,n){$4(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),n.data instanceof Uint8Array?2===C$().getNumber("WEBGL_VERSION")?$4(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data))):$4(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data))):2===C$().getNumber("WEBGL_VERSION")?$4(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n))):$4(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n))),$4(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,i,s){let o,a,l;$4(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),i instanceof Uint8Array?(o=new Uint8Array(n*r*4),a=e.UNSIGNED_BYTE,l=e.RGBA):(o=new Float32Array(n*r*4),a=e.FLOAT,l=s.internalFormatPackedFloat),o.set(i),2===C$().getNumber("WEBGL_VERSION")?$4(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,a,o))):$4(e,(()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,a,o))),$4(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[i,s]=A4(t,n);return P5(e,i,s,V5(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[i,s]=A4(t,n);return P5(e,i,s,W5(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(B4(this.gl,this.framebuffer),this.outputTexture=null),$4(this.gl,(()=>this.gl.deleteTexture(e)))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>function(e,t,n,r){const[i,s]=T4(t,n),o=new Uint8Array(t*n*4);return $4(e,(()=>e.readPixels(0,0,i,s,r.downloadTextureFormat,e.UNSIGNED_BYTE,o))),new Float32Array(o.buffer)}(this.gl,t,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(e,t,n,r,i,s){return j5(this.gl,e,0,0,0,i,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return function(e,t,n){const r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const r=function(e,t,n){const r=e.createBuffer();$4(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r)));const i=16*t*n;return $4(e,(()=>e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ))),$4(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0))),$4(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null))),r}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(C$().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const e=r.clientWaitSync(i,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=i}else C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>function(e,t,n){const r=new Float32Array(t*n*4);return $4(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r))),r}(this.gl,t,n)))}createProgram(e){this.throwIfDisposed();const t=this.gl;null==this.vertexShader&&(this.vertexShader=F5(t));const n=function(e){return W4(e,(()=>e.createProgram()),"Unable to create WebGLProgram.")}(t);$4(t,(()=>t.attachShader(n,this.vertexShader))),$4(t,(()=>t.attachShader(n,e))),function(e,t){if($4(e,(()=>e.linkProgram(t))),!C$().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&M4(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;$4(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer))),function(e,t,n){$4(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),L4(e,t,"clipSpacePos",n,3,20,0)&&L4(e,t,"uv",n,2,20,12)}(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&($4(this.gl,(()=>this.gl.deleteProgram(e))),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&M4(this.gl,this.program),$4(this.gl,(()=>this.gl.useProgram(e)))}getUniformLocation(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return W4(e,(()=>e.getUniformLocation(t,n)),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),$4(this.gl,(()=>this.gl.getAttribLocation(e,t)))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),P4(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[r,i]=A4(t,n);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&M4(this.gl,this.program),U4(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}$4(e,(()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),$4(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=O4(this.gl,2===C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await ZR((()=>this.disposed||this.isQueryAvailable(e,C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(e,C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){const t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{const t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){const t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){const e=function(e){let t=0;for(;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in C$().platform&&(n=C$().platform.setTimeoutCustom.bind(C$().platform)),ZR((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),z4(this.gl,e,this.framebuffer),this.debug&&U4(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(z4(this.gl,this.outputTexture,this.framebuffer),this.debug&&U4(this.gl)):B4(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const r=this.gl;z4(r,e,this.framebuffer),this.debug&&U4(r),this.outputTexture=e,$4(r,(()=>r.viewport(0,0,t,n))),$4(r,(()=>r.scissor(0,0,t,n)))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),$4(this.gl,(()=>this.gl.scissor(e,t,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{mx:H5,XI:q5,Nk:K5,f6:X5,ct:Y5,YG:Q5,hH:J5,z3:Z5,sG:e6,uM:t6,vS:n6,qB:r6,GG:i6,rq:s6,lg:o6,WR:a6,cu:l6,GE:u6,px:c6,jC:h6,He:d6,hE:p6,BF:f6,Dk:m6,cl:g6,_B:v6,ub:y6,_f:b6,Ku:x6,qy:w6,Zy:k6,bu:S6,zv:I6,dH:C6,HS:E6,yH:T6,l3:N6,z9:A6,x6:R6,_m:$6,eW:_6,GK:O6,SP:D6,yr:F6,dl:M6,Dw:L6,xT:P6,_X:z6,wz:B6}=i;function U6(e,t){return["x","y","z","w","u","v"].slice(0,t).map((t=>`${e}.${t}`))}function W6(e,t){return 1===t?[e]:U6(e,t)}class V6{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=T5(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=W6("rc",this.rank),t=x5(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),i=this.getOutput(e);this.userCode=`\n        void main() {\n          ${t} rc = getOutputCoords();\n\n          if(${n}) {\n            setOutput(vec4(0));\n          } else {\n            ${r}\n\n            setOutput(vec4(${i}));\n          }\n        }\n      `}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let i=`${0===n?"r":"rp1"}, ${0===r?"c":"cp1"}`;for(let t=2;t<this.rank;t++)i=`${e[e.length-1-t]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";const t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`\n      int r = ${t[0]};\n      int c = ${t[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${n};\n      bool rEdge = rp1 >= ${r};\n    `}getOutput(e){const t=this.getSourceCoordsArr(e);if(1===this.rank){return`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`}return`getA(${t[0]}),\n            cEdge ? 0. : getA(${t[1]}),\n            rEdge ? 0. : getA(${t[2]}),\n            rEdge || cEdge ? 0. : getA(${t[3]})`}}class j6{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=T5(this.outputShape.length);let n="";for(let s=0;s<4;s++){let e="thisRC = rc;";s%2===1&&(e+="thisRC.z += 1;"),s>1&&(e+="thisRC.y += 1;"),n+=`\n        ${e}\n        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${s}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${s>0?"}":""}\n      `}var r,i;this.userCode=`\n      ${r=t,i=this.enableShapeUniforms,`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${i?o5(["r","c","d"],"inputShape"):i5(["r","c","d"],r)}\n      return ivec3(r, c, d);\n    }\n  `}\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":a5(e)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}}class G6{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){const r=q6(t,n),i=K6(e,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const s=H6(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();const e=this.freeTextures[i].pop();return this.usedTextures[i].push(e),e}let o;return r===C4.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===C4.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===C4.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===C4.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===C4.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(o),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),o}releaseTexture(e,t,n,r){if(null==this.freeTextures)return;const i=q6(n,r),s=K6(t,i,r);s in this.freeTextures||(this.freeTextures[s]=[]);const o=H6(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),a=C$().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==a&&this._numBytesAllocated>a?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[s].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const l=this.usedTextures[s],u=l&&l.indexOf(e);if(null==u||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[u]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const e in this.freeTextures)this.freeTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));for(const e in this.usedTextures)this.usedTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function H6(e,t,n,r,i){const s=function(e,t){switch(e){case C4.PACKED_2X2_FLOAT32:return W5(t);case C4.PACKED_2X2_FLOAT16:return V5(t);case C4.UNPACKED_FLOAT32:return z5(t);case C4.UNPACKED_FLOAT16:return B5(t);case C4.PACKED_4X1_UNSIGNED_BYTE:return U5(t);default:throw new Error(`Unknown physical texture type ${e}`)}}(t,r);let o;if(i){const[t,n]=A4(e[0],e[1]);o=t*n}else{const[t,n]=T4(e[0],e[1]);o=t*n}const a=function(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}(n,s);return o*a}function q6(e,t){if(e===S4.UPLOAD)return C4.PACKED_2X2_FLOAT32;if(e===S4.RENDER||null==e)return function(e){return C$().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?C4.PACKED_2X2_FLOAT32:C4.UNPACKED_FLOAT32:e?C4.PACKED_2X2_FLOAT16:C4.UNPACKED_FLOAT16}(t);if(e===S4.DOWNLOAD||e===S4.PIXELS)return C4.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function K6(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}class X6{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=T5(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${t}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const Y6="if (isnan(x)) return x;",Q6="return abs(x);";const J6=Y6+"\n  return (x < 0.0) ? 0.0 : x;\n",Z6=Y6+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",e9="return x;";class t9{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=T5(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${t}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class n9{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=T5(this.outputShape.length);const t=e.length,n=W6("rc",t),r=x5(t),i=function(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),s=n.slice(-2),o=t<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`\n      void main() {\n        ${r} rc = getOutputCoords();\n        vec4 packedInput = getA(${i});\n\n        setOutput(getChannel(packedInput, ${o}));\n      }\n    `}}const r9=MW,i9={};const s9=C$().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class o9 extends zR{nextDataId(){return o9.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!C$().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof G5)t=e;else{const n=x4(C$().getNumber("WEBGL_VERSION"),e);t=new G5(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const e=x4(C$().getNumber("WEBGL_VERSION"));t=new G5(e),this.binaryCache=((n=C$().getNumber("WEBGL_VERSION"))in i9||(i9[n]={}),i9[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new G6(this.gpgpu),this.numMBBeforeWarning=null==C$().global.screen?1024:C$().global.screen.height*C$().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new PR(this,bM())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,i,s){const o=this.makeTensorInfo(t,n),a=this.texData.get(o.dataId);a.isPacked=!1,a.texture={texture:e,texShape:[r,i]},a.texShape=[r,i];const l=H4(t),u=new O5(l,!1,s),c=this.runWebGLProgram(u,[o],n,[[r,i]]);return c.shape=t,a.texture=null,this.disposeIntermediateTensorInfo(o),c.dataId}write(e,t,n){if((C$().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||C$().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:S4.UPLOAD,refCount:1}),r}refCount(e){if(this.texData.has(e)){return this.texData.get(e).refCount}return 0}incRef(e){this.texData.get(e).refCount++}decRef(e){if(this.texData.has(e)){this.texData.get(e).refCount--}}move(e,t,n,r,i){if(C$().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:S4.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:i,slice:s,shape:o,isPacked:a}=t;if(null!=s){let t;t=a?new t9(o,e9):new X6(o,e9);const n=this.runWebGLProgram(t,[{dataId:e,shape:o,dtype:r}],r),i=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;const l=null!=this.activeTimers;let u,c;if(l&&(u=fF()),"complex64"===r){c=eW(this.readSync(i.real.dataId),this.readSync(i.imag.dataId))}else c=this.getValuesFromTexture(e);return l&&(this.downloadWaitMs+=fF()-u),this.convertAndCacheOnCPU(e,c)}async read(e){if(this.pendingRead.has(e)){const t=this.pendingRead.get(e);return new Promise((e=>t.push(e)))}const t=this.texData.get(e),{values:n,shape:r,slice:i,dtype:s,complexTensorInfos:o,isPacked:a}=t;if(null!=i){let t;t=a?new t9(r,e9):new X6(r,e9);const n=this.runWebGLProgram(t,[{dataId:e,shape:r,dtype:s}],s),i=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(e);if(C$().getBool("DEBUG")&&!C$().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===C$().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,u,c=null;if("complex64"!==s&&C$().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(e);const t=this.texData.get(l.dataId);c=this.gpgpu.createBufferFromTexture(t.texture.texture,...N4(r))}if(this.pendingRead.set(e,[]),"complex64"!==s&&await this.gpgpu.createAndWaitForFence(),"complex64"===s){const e=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]);u=eW(e[0],e[1])}else if(null==c)u=this.getValuesFromTexture(e);else{const e=KR(r);u=this.gpgpu.downloadFloat32MatrixFromBuffer(c,e)}if(null!=l&&this.disposeIntermediateTensorInfo(l),null!=c){const e=this.gpgpu.gl;$4(e,(()=>e.deleteBuffer(c)))}const h=this.convertAndCacheOnCPU(e,u),d=this.pendingRead.get(e);return this.pendingRead.delete(e),d.forEach((e=>e(h))),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&bM().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(e),{values:r,shape:i,slice:s,dtype:o,isPacked:a,texture:l}=n;if("complex64"===o)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=s){let n;n=a?new t9(i,e9):new X6(i,e9);const r=this.runWebGLProgram(n,[{dataId:e,shape:i,dtype:o}],o),s=this.readToGPU(r,t);return this.disposeIntermediateTensorInfo(r),s}if(null==l)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,t.customTexShape),c=bM().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:c},h.texture)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>gF(e)));return lL(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return lL(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){const n=e[t];if(!_4(n)){if(C$().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:r}=this.texData.get(e),i=KR(t);if(C$().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(e),r=this.texData.get(n.dataId),s=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...N4(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(n),s}const s=C$().getBool("WEBGL_PACK")&&!0===r,o=s?H4(t):t,a=s?new $5(o):new R5(o),l=this.runWebGLProgram(a,[{shape:o,dtype:n,dataId:e}],"float32"),u=this.texData.get(l.dataId),c=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(l),c}timerAvailable(){return C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();const i=yF(this.activeTimers.map((e=>e.query))).filter((e=>null!=e)),s=yF(this.activeTimers.map((e=>e.name))).filter((e=>null!=e));this.activeTimers=t,r&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const e=await Promise.all(i);o.kernelMs=function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}(e),o.getExtraProfileInfo=()=>e.map(((e,t)=>({name:s[t],ms:e}))).map((e=>`${e.name}: ${e.ms}`)).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:fF(),endMs:null}}endTimer(e){return C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=fF(),e)}async getQueryTime(e){if(C$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:r,usage:i,isPacked:s,slice:o}=this.texData.get(e),a=o&&o.origDataId||e,l=this.dataRefCount.get(a);l>1?this.dataRefCount.set(a,l-1):(this.dataRefCount.delete(a),null!=t&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,i,s)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s9;return C$().getBool("WEBGL_CPU_FORWARD")&&e.every((e=>null==this.texData.get(e.dataId).texture&&KR(e.shape)<t))}getGPGPUContext(){return this.gpgpu}where(e){UD("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return r9(e.shape,t)}packedUnaryOp(e,t,n){const r=new t9(e.shape,t),i=this.compileAndRun(r,[e],n);return bM().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const t=C6(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(C$().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Q6,e.dtype);const t=new X6(e.shape,Q6),n=this.compileAndRun(t,[e]);return bM().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&a$(n[0])){const i=n.map((e=>mF(e)));r=this.write(i,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return bM().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new n9(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new V6(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[j4(e.shape),...G4(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},i=[j4(t),...G4(t)],s=new j6(i,n),o=[n],a=this.runWebGLProgram(s,[r],e.dtype,o,!0);return{dataId:a.dataId,shape:t,dtype:a.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:r,shape:i,dtype:s}=n;if(null!=t){GR(KR(i)<=t[0]*t[1]*4,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."))}const o=H4(i);let a;a=r?new A5(o):new N5(o);const l=[null!=t?t:N4(o)];return{dtype:s,shape:i,dataId:this.runWebGLProgram(a,[{shape:o,dtype:s,dataId:e}],s,l,!0,t).dataId}}runWebGLProgram(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;const o=this.makeTensorInfo(e.outputShape,n),a=this.texData.get(o.dataId);if(e.packedOutput&&(a.isPacked=!0),e.outPackingScheme===w4.DENSE){const t=null!=s?s:N4(e.outputShape);a.texShape=t.map((e=>2*e))}if(null!=e.outTexUsage&&(a.usage=e.outTexUsage),0===KR(o.shape))return a.values=r$(o.dtype,0),o;const l=[],u=t.map((t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&KR(t.shape)<=C$().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),l.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!K4(n.shape,t.shape)){const e=t,r=t.shape;t.shape=n.shape,t=this.packedReshape(t,r),l.push(t),n=this.texData.get(t.dataId),e.shape=r}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);const c={shape:o.shape,texData:a,isUniform:!1},h=function(e,t,n){let r="";t.concat(n).forEach((t=>{const i=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){const s=t.texData.texShape,{useSqueezeShape:o,uniformShape:a,keptDims:l}=w5(e.packedInputs,t.shape,s);let u="",c="",h="";if(1===a.length&&e.packedInputs){const e=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];u=`${e[0]>1}_${e[1]>1}`}else if(2!==a.length||e.packedInputs){if(a.length>2&&!e.packedInputs){const e=d$(a);h=`${e[0]===s[1]}_${e[e.length-1]===s[1]}`}}else c=`${a[0]>1}_${a[1]>1}`;const d=t.shape.length,p=2===a.length&&XR(t.shape,s),f=1===KR(t.shape),m=OL(t.shape,n.shape),g=!e.packedInputs&&d===n.shape.length&&XR(s,n.texData.texShape),v=e.packedInputs||a.length>2?"":`${s[0]>1}_${s[1]>1}`;r+=`${d}_${g}_${o?l:""}_${a.length}_${f}_${m}_${p}_${u}_${c}_${h}_${v}_${i}`}else{const e=t.isUniform?"uniform":t.texData.texShape;r+=`${t.shape}_${e}_${i}`}}));const i=e.userCode;let s=e.constructor.name;return s+="_"+r+"_"+i+`${C$().getNumber("WEBGL_VERSION")}`,s}(e,u,c),d=this.getAndSaveBinary(h,(()=>I5(this.gpgpu,e,u,c))),p=null!=this.activeTimers;let f;p&&(f=this.startTimer()),C$().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,i){t.program.enableShapeUniforms||(E5(t.inShapeInfos,n),E5([t.outShapeInfo],[r]));const s=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(s.texture,o[0],o[1]):e.setOutputMatrixTexture(s.texture,o[0],o[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===C$().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){const r=n[l],{uniform:i,offset:s,shape:o,texShape:a}=t.variablesLocations[l];if(o){const{uniformShape:n}=w5(t.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(o,new Int32Array(n));break;case 2:e.gl.uniform2iv(o,new Int32Array(n));break;case 3:e.gl.uniform3iv(o,new Int32Array(n));break;case 4:e.gl.uniform4iv(o,new Int32Array(n))}}if(a&&e.gl.uniform2i(a,r.texData.texShape[0],r.texData.texShape[1]),null!=i)if(r.isUniform)if(KR(r.shape)<2)e.gl.uniform1f(i,r.uniformValues[0]);else{let t=r.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(i,t)}else null!=r.texData.slice&&null!=s&&e.gl.uniform1i(s,r.texData.slice.flatOffset),e.setInputMatrixTexture(r.texData.texture.texture,i,l)}const a=t.outShapeLocation;if(a)switch(r.shape.length){case 1:e.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(a,new Int32Array(r.shape))}if(t.outShapeStridesLocation){const n=d$(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let l=0;l<t.program.customUniforms.length;++l){const n=t.program.customUniforms[l],r=t.customUniformLocations[l],s=i[l];if("float"===n.type)e.gl.uniform1fv(r,s);else if("vec2"===n.type)e.gl.uniform2fv(r,s);else if("vec3"===n.type)e.gl.uniform3fv(r,s);else if("vec4"===n.type)e.gl.uniform4fv(r,s);else if("int"===n.type)e.gl.uniform1iv(r,s);else if("ivec2"===n.type)e.gl.uniform2iv(r,s);else if("ivec3"===n.type)e.gl.uniform3iv(r,s);else{if("ivec4"!==n.type)throw Error(`uniform type ${n.type} is not supported yet.`);e.gl.uniform4iv(r,s)}}e.executeProgram()}(this.gpgpu,d,u,c,r),l.forEach((e=>this.disposeIntermediateTensorInfo(e))),p&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));const m=C$().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const e=fF();e-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!C$().getBool("WEBGL_LAZILY_UNPACK")&&a.isPacked&&!1===i){const e=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),e}return o}compileAndRun(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;return this.runWebGLProgram(e,t,n,r,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!C$().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach((e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}))}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=wM((()=>{if(!C$().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=C$().getBool("DEBUG");C$().set("DEBUG",!1);const t=this.abs(bL(1e-8)).dataSync()[0];if(C$().set("DEBUG",e),t>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:r,values:i,texture:s,usage:o,isPacked:a}=t;if(null!=s)return;const l=null!=this.activeTimers;let u;l&&(u=fF());let c=t.texShape;if(null==c&&(c=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=C$().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=C$().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&C$().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map(((t,n)=>n>=e.length-2?VR(e[n]):e[n]))).length&&(e=[2,e[0]])),2!==e.length){const t=n$(e);e=t.newShape}let i=KR(e),s=null;e.length<=1&&i<=n?s=[1,i]:2===e.length&&e[0]<=n&&e[1]<=n?s=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?s=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?s=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?s=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(s=[e[0],e[1]*e[2]*e[3]]);const o=null!=s&&Math.max(...s)>r&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(null==s||o)if(t){const t=j4(e);let n=2,r=2;e.length&&([n,r]=G4(e)),i=t*(n/2)*(r/2),s=QR(i).map((e=>2*e))}else s=QR(i);return s}(n,a),t.texShape=c),null!=i){const e=H4(n);let s,o=c[1],h=c[0];const d=i instanceof Uint8Array||i instanceof Uint8ClampedArray;!a&&d||([o,h]=A4(c[0],c[1])),s=a?new D5(e,d):new O5(e,d);const p=d?[h,o]:c,f=this.makeTensorInfo(p,r),m=this.texData.get(f.dataId);m.usage=d?S4.PIXELS:S4.UPLOAD,m.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),o,h,i);const g=[[h,o]],v=!0,y=this.runWebGLProgram(s,[f],r,g,v),b=this.texData.get(y.dataId);t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,C$().get("ENGINE_COMPILE_ONLY")?this.disposeData(y.dataId):(t.texture=b.texture,t.values=null,this.texData.delete(y.dataId)),this.disposeIntermediateTensorInfo(f),l&&(this.uploadWaitMs+=fF()-u)}else{const e=this.acquireTexture(c,o,r,a);t.texture=e}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:r}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){const n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error(`Unknown dtype ${t}`)}(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${e} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*o$(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise((e=>{try{this.checkCompletion_(t),e(!0)}catch(n){throw n}}));e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await CU(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw F4(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:i,outShapeLocation:s,outShapeStridesLocation:o,outTexShapeLocation:a}=C5(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=s,e.outShapeStridesLocation=o,e.outTexShapeLocation=a}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:s,channels:o}=e,a=bM().backend;if(!a.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=a.writeTexture(r,t,n,i,s,o);return bM().makeTensorFromDataId(l,t,n,a)}}o9.nextDataId=0;aM()&&IM("webgl",(()=>new o9),2);const a9="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class l9{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=FL(t,n),this.enableShapeUniforms=T5(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${e}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}const u9="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class c9{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=FL(t,n);const i=this.outputShape.length;this.enableShapeUniforms=T5(i);let s="";if(r)if(0===i||1===KR(this.outputShape))s="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{if(s=`\n          ${x5(i)} coords = getOutputCoords();\n        `,1===i)this.enableShapeUniforms?s+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":s+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const e=W6("coords",i);this.enableShapeUniforms?s+=`\n            bool nextRowOutOfBounds =\n              (${e[i-2]} + 1) >= outShape[${i} - 2];\n            bool nextColOutOfBounds =\n              (${e[i-1]} + 1) >= outShape[${i} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:s+=`\n            bool nextRowOutOfBounds =\n              (${e[i-2]} + 1) >= ${this.outputShape[i-2]};\n            bool nextColOutOfBounds =\n              (${e[i-1]} + 1) >= ${this.outputShape[i-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${e}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${s}\n\n        setOutput(result);\n      }\n    `}}function h9(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const d9={kernelName:G_,backendName:"webgl",kernelFunc:h9};function p9(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,s=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(s.dataId),a=h9({inputs:{x:r},backend:n}),l=h9({inputs:{x:i},backend:n});return o.complexTensorInfos={real:a,imag:l},s}const f9={kernelName:n_,backendName:"webgl",kernelFunc:p9},m9="return (a < 0.) ? b * a : a;",g9="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const v9={kernelName:Q_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:s}=r,o=n.makeTensorInfo([],"float32",dF(s,"float32")),a=C$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new c9(g9,i.shape,o.shape):new l9(m9,i.shape,o.shape),l=n.runWebGLProgram(a,[i,o],"float32");return n.disposeIntermediateTensorInfo(o),l}},y9="return (a < 0.) ? b * a : a;",b9="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const x9={kernelName:_O,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t,s=C$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new c9(b9,r.shape,i.shape):new l9(y9,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],"float32")}},w9="if (isnan(x)) return x;";function k9(e){let{opSnippet:t,packedOpSnippet:n,cpuKernelImpl:r,dtype:i}=e;return e=>{let{inputs:s,backend:o}=e;const{x:a}=s,l=o,u=i||a.dtype;if(l.shouldExecuteOnCPU([a])&&null!=r){const e=l.texData.get(a.dataId),t=r(e.values,u);return l.makeTensorInfo(a.shape,u,t)}let c;return c=C$().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new t9(a.shape,n):new X6(a.shape,t),l.runWebGLProgram(c,[a],u)}}function S9(e){let{opSnippet:t,packedOpSnippet:n,checkOutOfBounds:r=!1,supportsComplex:i=!1,cpuKernelImpl:s,dtype:o}=e;return e=>{let{inputs:a,backend:l}=e;const{a:u,b:c}=a,h=l;if(i&&"complex64"===u.dtype){const e=h.texData.get(u.dataId),n=h.texData.get(c.dataId),[r,i]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((e=>{const[n,r]=e,i={dataId:n.dataId,dtype:n.dtype,shape:u.shape},s={dataId:r.dataId,dtype:r.dtype,shape:c.shape},o=new l9(t,u.shape,c.shape);return h.runWebGLProgram(o,[i,s],GF(n.dtype,r.dtype))})),s=p9({inputs:{real:r,imag:i},backend:h});return h.disposeIntermediateTensorInfo(r),h.disposeIntermediateTensorInfo(i),s}const d=o||GF(u.dtype,c.dtype);if(("string"===u.dtype||"string"===c.dtype||h.shouldExecuteOnCPU([u,c]))&&null!=s){const e=h.texData.get(u.dataId).values,t=h.texData.get(c.dataId).values,n="string"===u.dtype?DW(e):e,r="string"===u.dtype?DW(t):t,[i,o]=s(u.shape,c.shape,n,r,d),a=h.makeTensorInfo(o,d);return h.texData.get(a.dataId).values=i,a}let p;return p=C$().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new c9(n,u.shape,c.shape,r):new l9(t,u.shape,c.shape),h.runWebGLProgram(p,[u,c],d)}}function I9(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":J6;if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":Z6;if("prelu"===e)return t?b9:y9;if("leakyrelu"===e)return t?g9:m9;if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}class C9{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=T5(this.outputShape.length);const u=r?e[1]:e[2],c=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",d=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",g="";o&&(m=a?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${o}\n        }`:l?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${o}\n        }`:`vec4 activation(vec4 x) {\n          ${o}\n        }`,g="result = activation(result);");const v=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let y="rc.x",b="rc.x";e[0]<t[0]?y=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(b=`imod(rc.x, ${t[0]})`),this.userCode=`\n      ${m}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${c}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ${y};\n        int batchB = ${b};\n        for (int i = 0; i < ${c}; i++) {\n          vec4 a = getMatrixA(batchA, ${h});\n          vec4 b = getMatrixB(batchB, ${d});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${p[0]} * ${f[0]});\n          result += (${p[1]} * ${f[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${v}\n\n        ${g}\n\n        setOutput(result);\n      }\n    `}}const E9="return areal * breal - aimag * bimag;",T9="return areal * bimag + aimag * breal;";class N9{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=FL(t,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${e}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const A9="return a * b;";function R9(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,s=GF(r.dtype,i.dtype);if("complex64"===r.dtype){const e=n.texData.get(r.dataId),t=n.texData.get(i.dataId),s=new N9(E9,r.shape,i.shape),o=new N9(T9,r.shape,i.shape),a=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:i.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:i.shape}],l=n.runWebGLProgram(s,a,"float32"),u=n.runWebGLProgram(o,a,"float32"),c=p9({inputs:{real:l,imag:u},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),c}if(n.shouldExecuteOnCPU([r,i])){const e=n.texData.get(r.dataId),t=n.texData.get(i.dataId),[o,a]=f6(r.shape,i.shape,e.values,t.values,s),l=n.makeTensorInfo(a,s);return n.texData.get(l.dataId).values=o,l}let o;return o=C$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new c9(A9,r.shape,i.shape):new l9(A9,r.shape,i.shape),n.runWebGLProgram(o,[r,i],s)}const $9={kernelName:wO,backendName:"webgl",kernelFunc:R9};function _9(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:s}=r,o=n,a=KR(i.shape),l=e$(s,a),u=KR(l);GR(a===u,(()=>`The new shape (${l}) has ${u} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`));const c=o.texData.get(i.dataId);return!c.isPacked||K4(i.shape,l)||null!==c.texture&&K4(c.shape,l)?(o.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype}):function(e,t,n){const r=[j4(e.shape),...G4(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},s=[j4(t),...G4(t)],o=new j6(s,r),a=[r],l=n.runWebGLProgram(o,[i],e.dtype,a,!0);return{dataId:l.dataId,shape:t,dtype:l.dtype}}(i,l,o)}const O9={kernelName:UO,backendName:"webgl",kernelFunc:_9};class D9{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:s}=e;this.outputShape=[r,s];const o=4*Math.floor(n/4),a=n%4;let l="sumValue += dot(values, ones);";if(null!=t){const e=1/t;l=`sumValue += dot(values * ${YR(e)?e.toPrecision(2):e}, ones);`}let u="";i%n>0&&(u=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${u}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${o}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${l}\n        }\n\n        int inIdx = inOffset + ${o};\n        if (${1===a}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${l}\n        } else if (${2===a}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${l}\n        } else if (${3===a}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${l}\n        }\n        setOutput(sumValue);\n      }\n    `}}class F9{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:s}=e;this.outputShape=[r,s];let o="0.0",a="";"prod"===t?o="1.0":"min"===t?(o="1.0 / 1e-20",a="min"):"max"===t&&(o="-1.0 / 1e-20",a="max");let l=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");const u=4*Math.floor(n/4),c=n%4;let h=`\n      if (${"sum"===t}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===t}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${a}(values, minMaxValue);\n        if (${"min"===t} || ${"max"===t}) {\n          minMaxValue = ${a}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,d="vec4";"all"===t?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===t&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let p="";i%n>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${o};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${p}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${o});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${h}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${2===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${3===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${h}\n        }\n        setOutput(${l});\n      }\n    `}}function M9(e,t,n,r){const i=function(e){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const n=t.length?t[t.length-1].outSize:e[1],r=FU(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape);let s=e;for(let o=0;o<i.length;o++){const{inSize:a,windowSize:l,outSize:u}=i[o];let c,h;c="mean"===n?0===o?new D9({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:u},a):new D9({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:u}):new F9({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:u},n),h=s,s=r.runWebGLProgram(c,[s],t),h.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(h)}return s}class L9{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let s=0;s<n.length;s++)n[s]=e[t[s]];this.outputShape=n,this.rank=n.length;const r=x5(this.rank),i=function(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}(t);this.userCode=`\n    void main() {\n      ${r} resRC = getOutputCoords();\n      setOutput(getA(${i}));\n    }\n    `}}class P9{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let u=0;u<n.length;u++)n[u]=e[t[u]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=x5(this.rank),i=U6("rc",this.rank),s=new Array(this.rank);for(let u=0;u<t.length;u++)s[t[u]]=i[u];const o=`vec2(${s.slice(-2).join()})`,a=`++${i[this.rank-1]} < ${n[this.rank-1]}`,l=`getChannel(getA(${s.join()}), ${o})`;this.userCode=`\n    void main() {\n      ${r} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${l};\n      if(${a}) {\n        result[1] = ${l};\n      }\n      --${i[this.rank-1]};\n      if(++${i[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${l};\n        if(${a}) {\n          result[3] = ${l};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function z9(e,t,n){const r=C$().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new P9(e.shape,t):new L9(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function B9(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;return function(e,t,n,r){const i=t,s=e.shape.length,o=t$(i,e.shape);let a=o;const l=Iz(a,s),u=null!=l;let c=e;u&&(c=z9(e,l,r),a=Ez(a.length,s)),Sz("sum",a,s);const[h,d]=wz(c.shape,a);let p=h;n&&(p=kz(h,o));const f=KR(d),m=_9({inputs:{x:c},attrs:{shape:[KR(e.shape)/f,f]},backend:r}),g=M9(m,HF(e.dtype),"sum",r),v=_9({inputs:{x:g},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),u&&r.disposeIntermediateTensorInfo(c),v}(i,s,o,n)}const U9={kernelName:lD,backendName:"webgl",kernelFunc:B9};function W9(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:s}=r,o=n,a=i.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=i.shape[s[c]];let u;if(o.shouldExecuteOnCPU([i])){const e=o.texData.get(i.dataId).values,t=z6(e,i.shape,i.dtype,s,l);u=o.makeTensorInfo(l,i.dtype);o.texData.get(u.dataId).values=t}else u=z9(i,s,o);return u}const V9={kernelName:RD,backendName:"webgl",kernelFunc:W9};function j9(e){let{a:t,b:n,transposeA:r,transposeB:i,backend:s,bias:o=null,preluActivationWeights:a=null,leakyreluAlpha:l=0,activation:u=null}=e;const c=t.shape.length,h=n.shape.length,d=r?t.shape[c-2]:t.shape[c-1],p=i?n.shape[h-1]:n.shape[h-2],f=r?t.shape[c-1]:t.shape[c-2],m=i?n.shape[h-2]:n.shape[h-1],g=t.shape.slice(0,-2),v=n.shape.slice(0,-2),y=KR(g),b=KR(v),x=FL(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,m]);GR(d===p,(()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${t.shape} and ${n.shape} and transposeA=${r} and transposeB=${i} must match.`));const w=r?[y,d,f]:[y,f,d],k=i?[b,m,p]:[b,p,m],S=_9({inputs:{x:t},backend:s,attrs:{shape:w}}),I=_9({inputs:{x:n},backend:s,attrs:{shape:k}}),C=[S,I],E=Math.max(y,b),T=r?S.shape[1]:S.shape[2],N=null!=o,A=null!=a,R="leakyrelu"===u,$=null!=u?I9(u,!0):null;let _;if((1===f||1===m)&&T>1e3&&!1===(N||A||R||null!=$)){let e=S,t=I;r&&(e=W9({inputs:{x:S},backend:s,attrs:{perm:[0,2,1]}}),C.push(e)),i&&(t=W9({inputs:{x:I},backend:s,attrs:{perm:[0,2,1]}}),C.push(t));const n=1===m;let o=e;1!==m&&(o=_9({inputs:{x:e},backend:s,attrs:{shape:[E,T,1]}}),C.push(o));const a=1===m?2:1;let l=t;n&&(l=_9({inputs:{x:t},backend:s,attrs:{shape:[E,1,T]}}),C.push(l));const u=R9({inputs:{a:o,b:l},backend:s});_=B9({inputs:{x:u},backend:s,attrs:{axis:a,keepDims:!0}}),C.push(u)}else{const e=GF(t.dtype,n.dtype),u=new C9(w,k,[E,f,m],r,i,N,$,A,R),c=[S,I];if(null!=o&&c.push(o),A&&c.push(a),R){const e=s.makeTensorInfo([],"float32",dF(l,"float32"));c.push(e),C.push(e)}_=s.runWebGLProgram(u,c,e)}const O=_9({inputs:{x:_},backend:s,attrs:{shape:x}});C.push(_);for(const D of C)s.disposeIntermediateTensorInfo(D);return O}const G9={kernelName:PD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s,bias:o,preluActivationWeights:a}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:h}=r;return j9({a:i,b:s,transposeA:l,transposeB:u,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:h,activation:c})}},H9="return abs(x);";const q9={kernelName:R$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const e=n.texData.get(r.dataId),t=C6(e.values);return n.makeTensorInfo(r.shape,r.dtype,t)}let i;return i=C$().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new t9(r.shape,H9):new X6(r.shape,H9),n.runWebGLProgram(i,[r],r.dtype)}},K9=k9({opSnippet:Y6+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),X9={kernelName:$$,backendName:"webgl",kernelFunc:K9},Y9=k9({opSnippet:Y6+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),Q9={kernelName:_$,backendName:"webgl",kernelFunc:Y9},J9="return a + b;",Z9=S9({opSnippet:J9,packedOpSnippet:J9,supportsComplex:!0,cpuKernelImpl:H5}),e8={kernelName:O$,backendName:"webgl",kernelFunc:Z9};class t8{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(((e,t)=>`T${t}`));const n=[];this.variableNames.forEach((e=>{n.push(`float v${e} = get${e}AtOutCoords();`)}));const r=this.variableNames.map((e=>`v${e}`)).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        float result = ${r};\n        setOutput(result);\n      }\n    `}}class n8{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(((e,t)=>`T${t}`));const n=[];this.variableNames.forEach((e=>{n.push(`vec4 v${e} = get${e}AtOutCoords();`)}));const r=this.variableNames.map((e=>`v${e}`)).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        vec4 result = ${r};\n        setOutput(result);\n      }\n    `}}const r8={kernelName:D$,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,i=n;if(1===i.length)return h9({inputs:{x:i[0]},backend:r});if(i.length>C$().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(i.length/2),n=e({inputs:i.slice(0,t),backend:r}),s=e({inputs:i.slice(t),backend:r});return e({inputs:[n,s],backend:r})}const s=i.map((e=>e.dtype)).reduce(((e,t)=>GF(e,t))),o=i.map((e=>e.shape)),a=C$().getBool("WEBGL_PACK")?new n8(i[0].shape,o):new t8(i[0].shape,o);return r.runWebGLProgram(a,i,s)}};const i8={kernelName:F$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,l=t$(s,i.shape);let u=l;const c=Iz(u,a);let h=i;null!=c&&(h=W9({inputs:{x:i},backend:n,attrs:{perm:c}}),u=Ez(u.length,a)),Sz("all",u,a);const[d,p]=wz(h.shape,u),f=_9({inputs:{x:h},backend:n,attrs:{shape:[-1,KR(p)]}}),m=M9(f,f.dtype,"all",n);let g;if(o){g=_9({inputs:{x:m},backend:n,attrs:{shape:kz(d,l)}})}else g=_9({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(h),g}};const s8={kernelName:M$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,l=t$(s,i.shape);let u=l;const c=Iz(u,a);let h=i;null!=c&&(h=W9({inputs:{x:i},backend:n,attrs:{perm:c}}),u=Ez(u.length,a)),Sz("any",u,a);const[d,p]=wz(h.shape,u),f=_9({inputs:{x:h},backend:n,attrs:{shape:[-1,KR(p)]}}),m=M9(f,f.dtype,"any",n);let g;if(o){g=_9({inputs:{x:m},backend:n,attrs:{shape:kz(d,l)}})}else g=_9({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(h),g}};class o8{constructor(e,t,n){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:s}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,s];const o="max"===t?">":"<",a=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${r}; i++) {\n          int inIdx = ${a};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${o} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}class a8{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,GR(e.length>2,(()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`));const i=e[e.length-1],s=Math.ceil(i/t);this.outputShape=e.slice(0,-1),s>1&&this.outputShape.push(s),r||this.variableNames.push("bestIndicesA");const o=this.outputShape,a=o.length,l=x5(a),u=W6("coords",a);let c,h;if(1===s){h=a+1;const e=x5(h);c=`\n        ${e} sourceLocR = ${e}(${u.join()}, 0);\n        ++${u[a-1]};\n        ${e} sourceLocG = ${e}(${u.join()}, 0);\n        ++${u[a-2]};\n        ${e} sourceLocA = ${e}(${u.join()}, 0);\n        --${u[a-1]};\n        ${e} sourceLocB = ${e}(${u.join()}, 0);\n        --${u[a-2]};`}else h=a,c=`\n        ${l} sourceLocR = coords;\n        ++${u[a-1]};\n        ${l} sourceLocG = coords;\n        ++${u[a-2]};\n        ${l} sourceLocA = coords;\n        --${u[a-1]};\n        ${l} sourceLocB = coords;\n        --${u[a-2]};`;const d=["x","y","z","w","u","v"].slice(0,h),p="."+d[h-1],f=d.map((e=>"int "+e)),m=W6("sourceLocR",h-1).concat("inIdx.r"),g=W6("sourceLocG",h-1).concat("inIdx.g"),v=W6("sourceLocB",h-1).concat("inIdx.b"),y=W6("sourceLocA",h-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",x=r?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${v.join()}),\n                             getBestIndicesAChannel(${y.join()})));`,w=`vec4(\n            getAChannel(${m.join()}),\n            hasNextCol ? getAChannel(${g.join()}) : 0.,\n            hasNextRow ? getAChannel(${v.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${y.join()}) : 0.)`,k=r?"":`\n      float getBestIndicesAChannel(${f.join()}) {\n        return getChannel(getBestIndicesA(${d.join()}),\n                                          vec2(${d.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${f.join()}) {\n        return getChannel(getA(${d.join()}),\n                               vec2(${d.slice(-2).join()}));\n      }\n      ${k}\n      void main() {\n        ${l} coords = getOutputCoords();\n        bool hasNextCol = ${u[a-1]} < ${o[a-1]-1};\n        bool hasNextRow = ${u[a-2]} < ${o[a-2]-1};\n        ${c}\n        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},\n          sourceLocB${p}, sourceLocA${p}) * ${t};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${w};\n\n        for (int i = 0; i < ${t}; i++) {\n          inIdx = srcIdx;\n          ${x}\n          vec4 candidate = ${w};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}function l8(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.shape[0],s=t.shape[1];null!=r&&(i=r.shape[0],s=r.shape[1]);const o=FU(s),a={windowSize:o,inSize:s,batchSize:i,outSize:Math.ceil(s/o)},l=new o8(a,n,null==r),u=[t];null!=r&&u.push(r);const c=e.runWebGLProgram(l,u,"int32");if(1===c.shape[1])return c;const h=l8(e,t,n,c);return e.disposeIntermediateTensorInfo(c),h}function u8(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const i=null!=r?r.shape:t.shape,s=FU(i[i.length-1]),o=new a8(i,s,n,null==r),a=null==r?[t]:[t,r],l=e.runWebGLProgram(o,a,"int32");if(l.shape.length===t.shape.length){const r=u8(e,t,n,l);return e.disposeIntermediateTensorInfo(l),r}return l}function c8(e,t,n,r){const i=[n];if(Sz("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!C$().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const n=[],s=e.texData.get(t.dataId);let o=t;null!==s&&s.isPacked&&(o=e.unpackTensor(t),n.push(o));const[a,l]=wz(o.shape,i),u=KR(l),c=_9({inputs:{x:o},backend:e,attrs:{shape:[-1,u]}});n.push(c);const h=l8(e,c,r);n.push(h);const d=_9({inputs:{x:h},backend:e,attrs:{shape:a}});return n.forEach((t=>e.disposeIntermediateTensorInfo(t))),d}return u8(e,t,r)}const h8={kernelName:L$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;let o=t$(s,i.shape);const a=Iz(o,i.shape.length);let l=i;const u=[];null!=a&&(l=W9({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),o=Ez(o.length,l.shape.length)),Sz("argMax",[o[0]],l.shape.length);const c=c8(n,l,o[0],"max");return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}};const d8={kernelName:P$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;let o=t$(s,i.shape);const a=Iz(o,i.shape.length);let l=i;const u=[];null!=a&&(l=W9({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),o=Ez(o.length,l.shape.length)),Sz("argMin",[o[0]],l.shape.length);const c=c8(n,l,o[0],"min");return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}},p8=k9({opSnippet:Y6+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),f8={kernelName:z$,backendName:"webgl",kernelFunc:p8},m8=k9({opSnippet:Y6+"return log(x + sqrt(x * x + 1.0));"}),g8={kernelName:B$,backendName:"webgl",kernelFunc:m8},v8=k9({opSnippet:Y6+"\n  return atan(x);\n"}),y8={kernelName:U$,backendName:"webgl",kernelFunc:v8},b8=S9({opSnippet:a9+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+u9+"\n  return result;\n"}),x8={kernelName:V$,backendName:"webgl",kernelFunc:b8},w8=k9({opSnippet:Y6+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),k8={kernelName:W$,backendName:"webgl",kernelFunc:w8};class S8{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const s=e.filterWidth,o=e.strideHeight,a=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const f="avg"===t,m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(f||(v="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode=`\n        const ivec2 strides = ivec2(${o}, ${a});\n        const ivec2 pads = ivec2(${d}, ${p});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${c};\n              wR += ${l}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${h};\n                wC += ${u}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ${t} currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${r?i?m:g:`wR * ${h} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let y=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(y="avgValue / max(count, 1.0)");const b=4*Math.floor(s/4),x=s%4,w=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${o}, ${a});\n      const ivec2 pads = ivec2(${d}, ${p});\n      const float initializationValue = ${v};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${v});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${c};\n            wR += ${l}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${b}; wC += 4) {\n            int xC = xCCorner + wC * ${u};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              getValue(batch, xR, xC + 3 * ${u}, d)\n            );\n\n            ${w}\n          }\n\n          int xC = xCCorner + ${b};\n          if (${1===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${w}\n          } else if (${2===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${w}\n          } else if (${3===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              initializationValue\n            );\n\n            ${w}\n          }\n        }\n        setOutput(${y});\n      }\n    `}}class I8{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const s=e.filterWidth,o=e.strideDepth,a=e.strideHeight,l=e.strideWidth,u=e.dilationDepth,c=e.dilationHeight,h=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const y="avg"===t;let b="0.0";if(y||(b="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${o}, ${a}, ${l});\n        const ivec3 pads = ivec3(${m}, ${g}, ${v});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${d};\n              wD += ${u}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${e.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${p};\n                wR += ${c}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${e.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${f};\n                  wC += ${h}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${e.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ${t} currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${f} +\n                      wR * ${f} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let x=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(x="avgValue / max(count, 1.0)");const w=4*Math.floor(s/4),k=s%4,S=`\n      if (${y}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${o}, ${a}, ${l});\n      const ivec3 pads = ivec3(${m}, ${g}, ${v});\n      const float initializationValue = ${b};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${b});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${d};\n            wD += ${u}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${e.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${p};\n            wR += ${c}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${w}; wC += 4) {\n              int xC = xCCorner + wC * ${h};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${h}, ch)\n              );\n\n              ${S}\n            }\n\n            int xC = xCCorner + ${w};\n            if (${1===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${2===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${3===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                initializationValue\n              );\n\n              ${S}\n            }\n          }\n        }\n        setOutput(${x});\n      }\n    `}}const C8={kernelName:j$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;t5(i,"avgPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:l}=r;GR(AP(o,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`));const u=bP(i.shape,s,o,1,a,l);if(1===u.filterWidth&&1===u.filterHeight&&XR(u.inShape,u.outShape))return h9({inputs:{x:i},backend:n});const c=new S8(u,"avg",!1);return n.runWebGLProgram(c,[i],"float32")}};const E8={kernelName:H$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=xP(i.shape,s,o,[1,1,1],a,l,u),h=new I8(c,"avg",!1);return n.runWebGLProgram(h,[i],"float32")}};class T8{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,s=e.dilationHeight,o=e.dilationWidth,a=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=a-1-e.padInfo.top,c=l-1-e.padInfo.left,h=1/(t*n);this.userCode=`\n      const ivec2 pads = ivec2(${u}, ${c});\n      const float avgMultiplier = float(${h});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${a};\n            wR += ${s}) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${l};\n            wC+= ${o}) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class N8{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,s=e.strideHeight,o=e.strideWidth,a=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=c-1-e.padInfo.front,f=h-1-e.padInfo.top,m=d-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`\n      const ivec3 pads = ivec3(${p}, ${f}, ${m});\n      const float avgMultiplier = float(${g});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${c};\n            wD += ${a}) {\n          float dyD = float(dyDCorner + wD) / ${i}.0;\n\n          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${h};\n              wR += ${l}) {\n            float dyR = float(dyRCorner + wR) / ${s}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${d};\n                wC += ${u}) {\n              float dyC = float(dyCCorner + wC) / ${o}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const A8={kernelName:q$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,h=xP(o.shape,a,l,[1,1,1],u,c),d=new N8(h);return n.runWebGLProgram(d,[i],o.dtype)}};const R8={kernelName:G$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s;t5([i,s],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=bP(o.shape,a,l,1,u),h=new T8(c);return n.runWebGLProgram(h,[i],o.dtype)}};const $8={kernelName:K$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s}=t,{transposeA:o,transposeB:a}=r;return j9({a:i,b:s,transposeA:o,transposeB:a,backend:n})}};class _8{constructor(e,t,n,r,i,s){this.outputShape=[],this.variableNames=["x","mean","variance"],FL(e,t),FL(e,n);let o="0.0";null!=r&&(FL(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let a="1.0";null!=i&&(FL(e,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${o};\n        float scale = ${a};\n        float inv = scale * inversesqrt(variance + float(${s}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}class O8{constructor(e,t,n,r,i,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],FL(e,t),FL(e,n);let o="vec4(0.0)";null!=r&&(FL(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let a="vec4(1.0)";null!=i&&(FL(e,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`\n      void main() {\n        vec4 offset = ${o};\n        vec4 scale = ${a};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${s}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}const D8={kernelName:B_,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:i,mean:s,variance:o,offset:a,scale:l}=t;GR(s.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),GR(null==a||s.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),GR(null==l||s.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:u}=r;null==u&&(u=.001);const c=[i,s,o];let h=null;null!=a&&(h=a.shape,c.push(a));let d=null;null!=l&&(d=l.shape,c.push(l));const p=C$().getBool("WEBGL_PACK_NORMALIZATION")?new O8(i.shape,s.shape,o.shape,h,d,u):new _8(i.shape,s.shape,o.shape,h,d,u);return n.runWebGLProgram(p,c,c[0].dtype)}};class F8{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=x5(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(e){if(1===e)return"sourceLoc";if(e<=6)return M8.slice(0,e).map((e=>"sourceLoc."+e)).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}(this.rank);let r;r=`\n        ${t} sourceLoc;\n        ${t} coords = getOutputCoords();\n        ${e.map(((e,t)=>`sourceLoc.${M8[t]} = start[${t}] + coords.${M8[t]};`)).join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${r}\n        setOutput(getSource(${n}));\n      }\n    `}}const M8=["x","y","z","w","u","v"];class L8{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=x5(this.rank),n=W6("coords",this.rank),r=W6("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,s=`getChannel(getSource(${r.join()}), ${i})`,o=`\n      result.x = ${s};\n      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {\n        ++${r[this.rank-1]};\n        result.y = ${s};\n        --${r[this.rank-1]};\n      }\n    `,a=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {\n        ++${r[this.rank-2]};\n        result.z = ${s};\n        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {\n          ++${r[this.rank-1]};\n          result.w = ${s};\n        }\n      }\n    `,l=this.rank<=4?`sourceLoc = coords +\n            ${t}(${e.map(((e,t)=>`start[${t}]`)).join()});`:e.map(((e,t)=>`${r[t]} = ${n[t]} + start[${t}];`)).join("\n");this.userCode=`\n      void main() {\n        ${t} coords = getOutputCoords();\n        ${t} sourceLoc;\n        ${l}\n        vec4 result = vec4(0.);\n        ${o}\n        ${a}\n        setOutput(result);\n      }\n    `}}function P8(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,size:o}=r,[a,l]=dP(i,s,o);if(JL(i,a,l),0===KR(l))return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||"string"===i.dtype){const e=n.texData.get(i.dataId),t=E6(e.values,a,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,t)}const{isPacked:u}=n.texData.get(i.dataId),c=cP(i.shape,a,l);if(u||!c){const e=C$().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new L8(l):new F8(l),t=[a];return n.runWebGLProgram(e,[i],i.dtype,t)}return n.uploadToGPU(i.dataId),function(e,t,n,r){const i=r.texData.get(e.dataId),s=r.makeTensorInfo(n,e.dtype),o=r.texData.get(s.dataId);Object.assign(o,i),o.refCount=1,o.shape=n,o.dtype=e.dtype;let a=hP(t,d$(e.shape));i.slice&&(a+=i.slice.flatOffset),o.slice={flatOffset:a,origDataId:i.slice&&i.slice.origDataId||e.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),s}(i,a,l,n)}const z8={kernelName:tD,backendName:"webgl",kernelFunc:P8},B8={kernelName:X$,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,crops:o}=r;GR(i.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const a=s.reduce(((e,t)=>e*t)),l=LU(i.shape,s,a),u=PU(l.length,s.length),c=zU(i.shape,s,a),h=BU(o,s.length),d=UU(c,o,s.length),p=[],f=_9({inputs:{x:i},backend:n,attrs:{shape:l}}),m=W9({inputs:{x:f},backend:n,attrs:{perm:u}}),g=_9({inputs:{x:m},backend:n,attrs:{shape:c}}),v=P8({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return p.push(f),p.push(m),p.push(g),p.forEach((e=>n.disposeIntermediateTensorInfo(e))),v}};const U8={kernelName:Y$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o}=r,a=n.readSync(i.dataId),l=n.readSync(s.dataId),u=q5(a,l,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,u)}};const W8={kernelName:Q$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,s=C$().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=C$().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||1===o){const e=n.texData.get(r.dataId).values,t=n.texData.get(i.dataId).values,[s,o]=X5(r.shape,i.shape,e,t,r.dtype),a=n.makeTensorInfo(o,r.dtype);return n.texData.get(a.dataId).values=s,a}let a;return a=s?new c9("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,i.shape,!1):new l9("\n  return float(int(a.r) & int(b.r));\n",r.shape,i.shape),n.runWebGLProgram(a,[r,i],r.dtype)}};const V8={kernelName:J$,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,s=n.readSync(r.dataId),o=n.readSync(i.dataId),a=FL(Array.from(s),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}},j8=S9({opSnippet:"return float(a != b);",cpuKernelImpl:g6,dtype:"bool"}),G8={kernelName:SO,backendName:"webgl",kernelFunc:j8};function H8(e){const{inputs:t,backend:n}=e,{input:r}=t;return h9({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const q8={kernelName:PO,backendName:"webgl",kernelFunc:H8};const K8={kernelName:Z$,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r,attrs:i}=t,{x:s}=n,{dtype:o}=i;if("complex64"===o){if("complex64"===s.dtype)return h9({inputs:{x:s},backend:r});const t=zz(s.shape),n=e({inputs:{x:s},backend:r,attrs:{dtype:"float32"}}),i=p9({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeIntermediateTensorInfo(n),i}if("complex64"===s.dtype){const t=H8({inputs:{input:s},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(t),n}if(!s$(s.dtype,o)){const e=h9({inputs:{x:s},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:o}}if(r.shouldExecuteOnCPU([s])){const e=r.texData.get(s.dataId).values,[t,n,i]=Y5(e,s.shape,s.dtype,o);return r.makeTensorInfo(t,n,i)}if("int32"===o)return function(e,t){const n=new X6(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(s,r);if("bool"===o){const e=r.makeTensorInfo([],"bool",r$("bool",1)),t=j8({inputs:{a:s,b:e},backend:r});return r.disposeIntermediateTensorInfo(e),t}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}},X8="return ceil(x);",Y8=k9({opSnippet:X8,packedOpSnippet:X8,cpuKernelImpl:Q5}),Q8={kernelName:e_,backendName:"webgl",kernelFunc:Y8};class J8{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class Z8{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const e7={kernelName:t_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:s,clipValueMax:o}=r;let a;a=C$().getBool("WEBGL_PACK_CLIP")?new Z8(i.shape):new J8(i.shape);const l=[[s],[o]];return n.runWebGLProgram(a,[i],i.dtype,l)}};class t7{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function n7(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}const r7={kernelName:r_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),s=new t7(r.shape),o=[n7(r,i.complexTensorInfos.real),n7(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(s,o,o[0].dtype)}};class i7{constructor(e){this.outputShape=[],this.outputShape=TU(e,1),this.variableNames=e.map(((e,t)=>`T${t}`));const t=new Array(e.length-1);t[0]=e[0][1];for(let s=1;s<t.length;s++)t[s]=t[s-1]+e[s][1];const n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let s=1;s<t.length;s++){const e=t[s-1];n.push(`else if (yC < ${t[s]}) setOutput(getT${s}(yR, yC-${e}));`)}const r=t.length,i=t[t.length-1];n.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}}class s7{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=TU(e,t);const n=this.outputShape,r=n.length,i=x5(r),s=W6("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(((e,t)=>`T${t}`));const a=new Array(e.length-1);a[0]=e[0][t];for(let f=1;f<a.length;f++)a[f]=a[f-1]+e[f][t];const l=o[t],u=o.slice(-2),c=o.join();let h=`if (${l} < ${a[0]}) {\n        return getChannel(\n            getT0(${c}), vec2(${u.join()}));\n        }`;for(let f=1;f<a.length;f++){const e=a[f-1];h+=`\n        if (${l} < ${a[f]}  && ${l} >= ${a[f-1]}) {\n          return getChannel(\n            getT${f}(${o7(o,l,e)}),\n            vec2(${o7(u,l,e)}));\n        }`}const d=a.length,p=a[a.length-1];h+=`\n        return getChannel(\n          getT${d}(${o7(o,l,p)}),\n          vec2(${o7(u,l,p)}));`,this.userCode=`\n      float getValue(${o.map((e=>"int "+e))}) {\n        ${h}\n      }\n\n      void main() {\n        ${i} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${s}), 0., 0., 0.);\n\n        ${s[r-1]} = ${s[r-1]} + 1;\n        if (${s[r-1]} < ${n[r-1]}) {\n          result.g = getValue(${s});\n        }\n\n        ${s[r-2]} = ${s[r-2]} + 1;\n        if (${s[r-2]} < ${n[r-2]}) {\n          result.a = getValue(${s});\n        }\n\n        ${s[r-1]} = ${s[r-1]} - 1;\n        if (${s[r-2]} < ${n[r-2]} &&\n            ${s[r-1]} < ${n[r-1]}) {\n          result.b = getValue(${s});\n        }\n        setOutput(result);\n      }\n    `}}function o7(e,t,n){const r=e.indexOf(t);return e.map(((e,t)=>t===r?`${e} - ${n}`:e)).join()}function a7(e){const{inputs:t,backend:n}=e,{input:r}=t;return h9({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const l7={kernelName:q_,backendName:"webgl",kernelFunc:a7};function u7(e,t,n){const r=e[0].dtype;if("complex64"===r){const r=e.map((e=>H8({inputs:{input:e},backend:n}))),i=e.map((e=>a7({inputs:{input:e},backend:n}))),s=u7(r,t,n),o=u7(i,t,n),a=p9({inputs:{real:s,imag:o},backend:n});return r.forEach((e=>n.disposeIntermediateTensorInfo(e))),i.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),a}let i=n.shouldExecuteOnCPU(e);if("string"===r&&(i=!0),i){const i=e.map((e=>{const r=KR(e.shape.slice(t));return _9({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),s=i.map((e=>({vals:n.readSync(e.dataId),shape:e.shape}))),o=TU(i.map((e=>e.shape)),1),a=1===i[0].shape[0],l=J5(s,o,r,a),u=TU(e.map((e=>e.shape)),t),c=n.makeTensorInfo(u,r,l);return i.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}const s=e.filter((e=>KR(e.shape)>0)),o=C$().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(1===s.length){const t=o?new X6(e[0].shape,e9):new t9(e[0].shape,e9);return n.runWebGLProgram(t,e,r)}const a=C$().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>a){const e=[];for(let i=0;i<s.length;i+=a){const r=s.slice(i,i+a);e.push(u7(r,t,n))}const r=u7(e,t,n);for(const t of e)n.disposeIntermediateTensorInfo(t);return r}if(o){const e=new s7(s.map((e=>e.shape)),t);return n.runWebGLProgram(e,s,r)}const{tensors2D:l,outShape:u}=function(e,t,n){const r=TU(e.map((e=>e.shape)),t),i=e.map((e=>_9({inputs:{x:e},attrs:{shape:[-1,KR(e.shape.slice(t))]},backend:n})));return{tensors2D:i,outShape:r}}(s,t,n),c=new i7(l.map((e=>e.shape))),h=n.runWebGLProgram(c,l,r);l.forEach((e=>n.disposeIntermediateTensorInfo(e)));const d=_9({inputs:{x:h},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(h),d}function c7(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,s=t$(i,t[0].shape)[0];EU(t.map((e=>e.shape)),s);const o=TU(t.map((e=>e.shape)),s);if(0===KR(o))return n.makeTensorInfo(o,t[0].dtype,[]);const a=t.filter((e=>KR(e.shape)>0));return 1===a.length?h9({inputs:{x:a[0]},backend:n}):u7(a,s,n)}const h7={kernelName:i_,backendName:"webgl",kernelFunc:c7};class d7{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=e.outShape;const s=e.padInfo.top,o=e.padInfo.left,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,h=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,g=m?1:2,v=m?2:3,y=m?3:1;let b="",x="";n&&(b=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,x="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${b}\n\n      const ivec2 strides = ivec2(${a}, ${l});\n      const ivec2 pads = ivec2(${s}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${y}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${g}], coords[${v}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${h}; wR++) {\n          int xR = xRCorner + wR * ${u};\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${d}; wC++) {\n            int xC = xCCorner + wC * ${c};\n\n            if (xC < 0 || xC >= ${e.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${p}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${m}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===f}) {\n\n              if (${m}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${p}) *\n                    getW(wR, wC, ${p}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${p}, xR, xC) *\n                    getW(wR, wC, ${p}, d2);\n              }\n\n            } else if (${2===f}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2)\n              );\n\n              if (${m}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===f}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2),\n                getW(wR, wC, ${p} + 2, d2)\n              );\n\n              if (${m}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1),\n                  getX(batch, xR, xC, ${p} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC),\n                  getX(batch, ${p} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${w}\n        ${x}\n        setOutput(result);\n      }\n    `}}class p7{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,s=e.strideHeight,o=e.strideWidth,a=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.filterDepth,h=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${i}, ${s}, ${o});\n      const ivec3 pads = ivec3(${t}, ${n}, ${r});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${c}; wF++) {\n          int xF = xFCorner + wF * ${a};\n\n          if (xF < 0 || xF >= ${e.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${h}; wR++) {\n            int xR = xRCorner + wR * ${l};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d}; wC++) {\n              int xC = xCCorner + wC * ${u};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${p}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===f}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${p}) *\n                  getW(wF, wR, wC, ${p}, d2);\n              } else if (${2===f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1),\n                  getX(batch, xF, xR, xC, ${p} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2),\n                  getW(wF, wR, wC, ${p} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class f7{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=T5(this.outputShape.length);const s=e.padInfo.left,o=e.strideWidth,a=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,c=u;let h="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<u;m++)h+=`\n           vec4 xTexelC${2*m};\n           int xTexelC${2*m}Ready;\n           vec4 xTexelC${2*m+1};\n           int xTexelC${2*m+1}Ready;\n           vec4 xC${m};`;h+=`\n     for (int r = 0; r < ${l}; r++) {\n      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {\n       `;for(let m=0;m<u;m++)h+=`\n           xTexelC${2*m} = vec4(0.0);\n           xTexelC${2*m}Ready = 0;\n           xTexelC${2*m+1} = vec4(0.0);\n           xTexelC${2*m+1}Ready = 0;\n           xC${m} = vec4(0.0);`;h+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(c+1)/2;m++){const t=2*m;if(h+=`\n           xC = xCCorner + ${t*a};\n           `,1===o){if(t<u&&(s%2===1?(h+=`\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n               `,h+=1===a&&t>0?`\n                 xC${t} = vec4(xTexelC${t-2}.zw, xTexelC${t}.xy);\n                 `:`\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC${t} = vec4(previous.zw, xTexelC${t}.xy);\n                   } else {\n                     xC${t} = vec4(0.0, 0.0, xTexelC${t}.xy);\n                   }\n                   `):h+=`\n                 if (xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n\n                 xC${t} = xTexelC${t};\n                 `,t+1<u)){const e=s%2===0?VR(a):a;a%2===0&&s%2===1||a%2!==0&&s%2!==1?(h+=`\n                   xCOffset = xC + imod(pads[1], 2) + ${e};\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                     xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC${t+1}.zw = vec2(0.0);\n                     }\n                     xTexelC${t+1}Ready = 1;\n                   }\n                   `,h+=a>1?`\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC${t+1} = vec4(previous.zw, xTexelC${t+1}.xy);\n                     } else {\n                      xC${t+1} = vec4(0.0, 0.0, xTexelC${t+1}.xy);\n                     }\n                     `:`\n                     xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.xy);\n                     `):h+=1===e?`\n                     xC${t+1} = xTexelC${t};\n                     `:`\n                     xCOffset = xC + ${e};\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                       xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC${t+1}.zw = vec2(0.0);\n                       }\n                       xTexelC${t+1}Ready = 1;\n                     }\n\n                     xC${t+1} = xTexelC${t+1};\n                     `}}else t<u&&(s%2===1?(h+=`\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${t+1}Ready == 0) {\n                   xTexelC${t+1} = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC${t+1}.zw = vec2(0.0);\n                   }\n                   xTexelC${t+1}Ready = 1;\n                 }\n\n                 xC${t} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n               `,t+1<u&&(h+=`\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC${t+1} = vec4(xTexelC${t+1}.xy, final.xy);\n                 `)):(h+=`\n                 if(xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                   xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${t+1}.zw = vec2(0.);\n                   }\n                   xTexelC${t+1}Ready = 1;\n                 }\n\n                 xC${t} = vec4(\n                   xTexelC${t}.xy, xTexelC${t+1}.xy);\n               `,t+1<u&&(h+=`\n                   xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n                 `)));t<u&&(h+=`\n             wTexel = getW(r, ${t}, d1, d2);\n             dotProd += xC${t}.xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ${e.inChannels}) {\n               dotProd += xC${t}.yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           `,t+1<u&&(h+=`\n               wTexel = getW(r, ${t+1}, d1, d2);\n               dotProd += xC${t+1}.xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ${e.inChannels}) {\n                 dotProd += xC${t+1}.yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             `))}h+="\n     }\n   ",h+="\n     }\n   ",h+="\n     }\n   ";let d="",p="";n&&(d=r?`vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ${n}\n         }`:i?`vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ${n}\n         }`:`vec4 activation(vec4 x) {\n           ${n}\n         }`,p="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n       ${d}\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ${h}\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ${f}\n         ${p}\n         setOutput(result);\n       }\n     `}}class m7{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=T5(this.outputShape.length);const{dataFormat:n}=t,r=r5(),i="channelsLast"===n,s=i?1:2,o=i?2:3,a=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let l="";for(let u=0;u<=1;u++)for(let e=0;e<=1;e++)l+=`\n          blockIndex = rc.z + ${e};\n          pos = rc.y + ${u};\n\n          ${a}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${s}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${o}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${i}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*u+e}] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*u+e}] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${l}\n\n        ${r.output} = result;\n      }\n    `}}function g7(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function v7(e){let{x:t,filter:n,convInfo:r,backend:i,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}=e;const u=t.shape,c=i.texData.get(t.dataId),h=r.inChannels,d=u[0]*u[1]*u[2],p=r.outChannels,f="channelsLast"===r.dataFormat,m=!1;let g;const v=[];if(null!=o){const e=g7(o.shape,f);null!=e&&(o=_9({inputs:{x:o},backend:i,attrs:{shape:e}}),v.push(o))}if(null!=s){const e=g7(s.shape,f);null!=e&&(s=_9({inputs:{x:s},backend:i,attrs:{shape:e}}),v.push(s))}if(!((1===d||1===p)&&h>1e3)&&c.isPacked&&f&&null!=c.texture&&u[2]%2!==0&&XR(c.shape.slice(-3),u.slice(-3))){const e=u[0]*u[1]*(u[2]+1),h={dataId:t.dataId,shape:[1,e,r.inChannels],dtype:t.dtype},d=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,GR(K4(c.shape,h.shape),(()=>`packed reshape ${c.shape} to ${h.shape} isn't free`));const p=_9({inputs:{x:n},backend:i,attrs:{shape:[1,r.inChannels,r.outChannels]}});v.push(p);const f=j9({a:h,b:p,backend:i,transposeA:false,transposeB:m,bias:s,activation:l,preluActivationWeights:o,leakyreluAlpha:a}),y=i.texData.get(f.dataId);GR(y.isPacked,(()=>"batchMatMul result is expected to be packed")),c.shape=d,y.shape=r.outShape,g=h9({inputs:{x:f},backend:i}),g.shape=r.outShape,v.push(f)}else{const e=r.outHeight*r.outWidth,u=_9({inputs:{x:t},backend:i,attrs:{shape:f?[r.batchSize,e,r.inChannels]:[r.batchSize,r.inChannels,e]}}),c=_9({inputs:{x:n},backend:i,attrs:{shape:[1,r.inChannels,r.outChannels]}}),h=j9({a:f?u:c,b:f?c:u,transposeA:!f,transposeB:m,backend:i,bias:s,activation:l,preluActivationWeights:o,leakyreluAlpha:a});g=_9({inputs:{x:h},backend:i,attrs:{shape:r.outShape}}),v.push(u),v.push(c),v.push(h)}for(const y of v)i.disposeIntermediateTensorInfo(y);return g}function y7(e){let{x:t,filter:n,convInfo:r,backend:i,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}=e;const{filterWidth:u,filterHeight:c,inChannels:h,outWidth:d,outHeight:p,dataFormat:f}=r,m="channelsLast"===f,g=u*c*h,v=p*d,y=[r.batchSize,g,v],b=[];if(null!=o){const e=g7(o.shape,m);null!=e&&(o=_9({inputs:{x:o},backend:i,attrs:{shape:e}}),b.push(o))}if(null!=s){const e=g7(s.shape,m);null!=e&&(s=_9({inputs:{x:s},backend:i,attrs:{shape:e}}),b.push(s))}const x=_9({inputs:{x:n},backend:i,attrs:{shape:[1,g,KR(n.shape)/g]}});b.push(x);const w=new m7(y,r),k=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],S=i.runWebGLProgram(w,[t],"float32",k),I=_9({inputs:{x:S},backend:i,attrs:{shape:y}});b.push(S),b.push(I);const C=null!=s,E=null!=o,T="leakyrelu"===l,N=l?I9(l,!0):null,A=new C9(m?I.shape:x.shape,m?x.shape:I.shape,m?[r.batchSize,v,r.outChannels]:[r.batchSize,r.outChannels,v],!0,!1,C,N,E,T),R=m?[I,x]:[x,I];if(s&&R.push(s),E&&R.push(o),T){const e=i.makeTensorInfo([],"float32",dF(a,"float32"));R.push(e),b.push(e)}const $=i.runWebGLProgram(A,R,"float32"),_=_9({inputs:{x:$},backend:i,attrs:{shape:r.outShape}});b.push($);for(const O of b)i.disposeIntermediateTensorInfo(O);return _}const b7={kernelName:s_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,h=$P(l),d=wP(i.shape,s.shape,o,u,a,c,!1,h);let p;if(1!==d.filterHeight||1!==d.filterWidth||1!==d.dilationHeight||1!==d.dilationWidth||1!==d.strideHeight||1!==d.strideWidth||"SAME"!==d.padInfo.type&&"VALID"!==d.padInfo.type)if(d.strideWidth<=2&&"channelsLast"===h&&C$().getBool("WEBGL_EXP_CONV")){const e=new f7(d),t=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];p=n.runWebGLProgram(e,[i,s],"float32",t)}else if(C$().getBool("WEBGL_CONV_IM2COL"))p=y7({x:i,filter:s,convInfo:d,backend:n});else{const e=new d7(d);p=n.runWebGLProgram(e,[i,s],"float32")}else p=v7({x:i,filter:s,convInfo:d,backend:n});const f=_9({inputs:{x:p},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(p),f}};class x7{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,s="channelsLast"===e.dataFormat;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yR = 0; yR < ${e.outHeight}; yR++) {\n            int xR = wR + yR * ${t} - ${r};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${e.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${i};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              ${s?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);"}\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class w7{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,s="channelsLast"===e.dataFormat,o=t-1-e.padInfo.top,a=n-1-e.padInfo.left,l=s?1:2,u=s?2:3,c=s?3:1;this.userCode=`\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${c}];\n\n        ivec2 dyCorner = ivec2(coords[${l}], coords[${u}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n\n              if (${s}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class k7{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,s=e.padInfo.top,o=e.padInfo.left;this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yF = 0; yF < ${e.outDepth}; yF++) {\n            int xF = wF + yF * ${t} - ${i};\n\n            if (xF < 0 || xF >= ${e.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${e.outHeight}; yR++) {\n              int xR = wR + yR * ${n} - ${s};\n\n              if (xR < 0 || xR >= ${e.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${e.outWidth}; yC++) {\n                int xC = wC + yC * ${r} - ${o};\n\n                if (xC < 0 || xC >= ${e.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class S7{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,s=e.strideHeight,o=e.strideWidth,a=t-1-e.padInfo.front,l=n-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`\n      const ivec3 pads = ivec3(${a}, ${l}, ${u});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${t}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${i}.0;\n\n          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${t} - 1 - wF;\n\n          for (int wR = 0; wR < ${n}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${s}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${n} - 1 - wR;\n\n            for (int wC = 0; wC < ${r}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${o}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${r} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const I7={kernelName:o_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,h=$P(l),d=wP(i.shape,c,o,1,a,u,!1,h),p=new x7(d);return n.runWebGLProgram(p,[i,s],"float32")}};class C7{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=T5(this.outputShape.length);const t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,i=n-1-e.padInfo.left;this.userCode=`\n      const ivec2 pads = ivec2(${r}, ${i});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            int wCPerm = ${n} - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    `}}const E7={kernelName:a_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,h=$P(u),d=wP(o,s.shape,a,1,l,c,!1,h);if(C$().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===h){const e=[[d.strideHeight,d.strideWidth]],t=new C7(d);return n.runWebGLProgram(t,[i,s],"float32",e)}{const e=new w7(d);return n.runWebGLProgram(e,[i,s],"float32")}}};const T7={kernelName:l_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:l}=r,u=kP(i.shape,s.shape,o,l,a),c=new p7(u);return n.runWebGLProgram(c,[i,s],"float32")}};const N7={kernelName:u_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,filterShape:l}=r,u=kP(i.shape,l,o,1,a),c=new k7(u);return n.runWebGLProgram(c,[i,s],"float32")}};const A7={kernelName:c_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{pad:o,strides:a,inputShape:l}=r,u=kP(l,s.shape,a,1,o),c=new S7(u);return n.runWebGLProgram(c,[i,s],"float32")}},R7=k9({opSnippet:w9+"\n  return cos(x);\n",packedOpSnippet:`\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ${u9}\n  return result;\n`}),$7={kernelName:h_,backendName:"webgl",kernelFunc:R7},_7=k9({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),O7={kernelName:d_,backendName:"webgl",kernelFunc:_7};class D7{constructor(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[s,o,a,l]=e,[u]=t,[c,h]=n;this.outputShape=[u,c,h,l];const d="bilinear"===r?1:0,[p,f]=[o-1+".0",a-1+".0"],[m,g,v]=c>1?[""+(o-1)/(c-1),"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[y,b,x]=h>1?[""+(a-1)/(h-1),"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${y});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${s}) {\n          return;\n        }\n\n        float height_scale = ${g};\n        float width_scale = ${b};\n\n        float in_y = ${v};\n        if( in_y < 0.0 || in_y > ${p} ) {\n          setOutput(float(${i}));\n          return;\n        }\n        float in_x = ${x};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${i}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${d} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}const F7={kernelName:m_,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:s,boxInd:o}=t,{cropSize:a,method:l,extrapolationValue:u}=r,c=new D7(i.shape,s.shape,a,l,u);return n.runWebGLProgram(c,[i,s,o],"float32")}};var M7,L7;(L7=M7||(M7={})).Prod="*",L7.Sum="+";class P7{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,s=this.op===M7.Prod?"1.0":"0.0",o=n?s:`getX(${z7(i,"coords",this.op)})`,a=this.outputShape[this.outputShape.length-1];let l="",u="";n?(l=r?"end != "+(a-1):"end != 0",u=r?"end + 1":"end - 1"):(l=r?`end + pow2 < ${a}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`\n      void main() {\n        ${x5(i)} coords = getOutputCoords();\n        int end = ${B7(i,"coords",this.op)};\n        float val = ${o};\n        int pow2 = int(pow(2.0, index));\n        if (${l}) {\n          int idx = ${u};\n          ${B7(i,"coords",this.op)} = idx;\n          val ${this.op}= getX(${z7(i,"coords",this.op)});\n        }\n        setOutput(val);\n      }\n    `}}function z7(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.x, ${t}.y`;if(3===e)return`${t}.x, ${t}.y, ${t}.z`;if(4===e)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function B7(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.y`;if(3===e)return`${t}.z`;if(4===e)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function U7(e,t,n,r,i,s){const o=t.shape.length,a=Iz([r],o);let l=t;null!=a&&(l=W9({inputs:{x:t},backend:n,attrs:{perm:a}}));const u=Ez(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);const c=l.shape[u];let h=h9({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(c))-1;d++){const t=new P7(e,l.shape,!1,s),r=[[d]],i=h;h=n.runWebGLProgram(t,[h],h.dtype,r),n.disposeIntermediateTensorInfo(i)}if(i){const t=new P7(e,l.shape,i,s),r=h;h=n.runWebGLProgram(t,[h],h.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=a){const e=W9({inputs:{x:h},backend:n,attrs:{perm:Cz(a)}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),e}return h}const W7={kernelName:p_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;return U7(M7.Prod,i,n,s,o,a)}};const V7={kernelName:f_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;return U7(M7.Sum,i,n,s,o,a)}};const j7={kernelName:g_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o,binaryOutput:a}=r;if(1===i.shape.length){const e=n.readSync(i.dataId),t=n.readSync(s.dataId),r=q5(e,t,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,r)}if(2===i.shape.length){const e=n.bufferSync(i),t=n.bufferSync(s),r=K5(e,t,o,a);return n.makeTensorInfo(r.shape,s.dtype,r.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}};class G7{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${t};\n      int offset_h = imod(h, ${t});\n      int in_w = w / ${t};\n      int offset_w = imod(w, ${t});\n      int offset_d = (offset_h * ${t} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const H7={kernelName:v_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:s,dataFormat:o}=r,a=i.shape[0],l=("NHWC"===o?i.shape[1]:i.shape[2])*s,u=("NHWC"===o?i.shape[2]:i.shape[3])*s,c=("NHWC"===o?i.shape[3]:i.shape[1])/(s*s),h=new G7("NHWC"===o?[a,l,u,c]:[a,c,l,u],s,o);return n.runWebGLProgram(h,[i],i.dtype)}};class q7{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=T5(this.outputShape.length);const s=e.filterHeight,o=e.filterWidth,a=e.outChannels/e.inChannels;let l="",u="";n&&(l=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,u="result = activation(result);");const c=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${l}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${a};\n        int q = d2 - d1 * ${a};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${s}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${o}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${c}\n        ${u}\n        setOutput(result);\n      }\n    `}}class K7{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=T5(this.outputShape.length);const s=e.outChannels/e.inChannels,o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,h=c;let d="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<c;g++)d+=`\n          vec4 xTexelC${2*g};\n          int xTexelC${2*g}Ready;\n          vec4 xTexelC${2*g+1};\n          int xTexelC${2*g+1}Ready;\n          vec4 xC${g};`;d+=`\n    for (int r = 0; r < ${u}; r++) {\n      `;for(let g=0;g<c;g++)d+=`\n          xTexelC${2*g} = vec4(0.0);\n          xTexelC${2*g}Ready = 0;\n          xTexelC${2*g+1} = vec4(0.0);\n          xTexelC${2*g+1}Ready = 0;\n          xC${g} = vec4(0.0);`;d+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(h+1)/2;g++){const e=2*g;if(d+=`\n          xC = xCCorner + ${e*l};\n          `,1===a){if(e<c&&(o%2===1?(d+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n              `,d+=1===l&&e>0?`\n                xC${e} = vec4(xTexelC${e-2}.zw, xTexelC${e}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${e} = vec4(previous.zw, xTexelC${e}.xy);\n                  } else {\n                    xC${e} = vec4(0.0, 0.0, xTexelC${e}.xy);\n                  }\n                  `):d+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n\n                xC${e} = xTexelC${e};\n                `,e+1<c)){const t=o%2===0?VR(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(d+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${t};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                    xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${e+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${e+1}Ready = 1;\n                  }\n                  `,d+=l>1?`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC${e+1} = vec4(previous.zw, xTexelC${e+1}.xy);\n                    } else {\n                     xC${e+1} = vec4(0.0, 0.0, xTexelC${e+1}.xy);\n                    }\n                    `:`\n                    xC${e+1} = vec4(xTexelC${e}.zw, xTexelC${e+1}.xy);\n                    `):d+=1===t?`\n                    xC${e+1} = xTexelC${e};\n                    `:`\n                    xCOffset = xC + ${t};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                      xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${e+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${e+1}Ready = 1;\n                    }\n\n                    xC${e+1} = xTexelC${e+1};\n                    `}}else e<c&&(o%2===1?(d+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${e+1}Ready == 0) {\n                  xTexelC${e+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${e+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${e+1}Ready = 1;\n                }\n\n                xC${e} = vec4(xTexelC${e}.zw, xTexelC${e+1}.zw);\n              `,e+1<c&&(d+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${e+1} = vec4(xTexelC${e+1}.xy, final.xy);\n                `)):(d+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                  xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${e+1}.zw = vec2(0.);\n                  }\n                  xTexelC${e+1}Ready = 1;\n                }\n\n                xC${e} = vec4(\n                  xTexelC${e}.xy, xTexelC${e+1}.xy);\n              `,e+1<c&&(d+=`\n                  xC${e+1} = vec4(xTexelC${e}.zw, xTexelC${e+1}.zw);\n                `)));e<c&&(d+=`\n            wTexel = getW(r, ${e}, d1, q);\n            dotProd += xC${e} * vec4(wTexel.xz, wTexel.xz);\n          `,e+1<c&&(d+=`\n              wTexel = getW(r, ${e+1}, d1, q);\n              dotProd += xC${e+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}d+="\n    }\n  ",d+="\n      }\n    ";let p="",f="";n&&(p=r?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,f="result = activation(result);");const m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${p}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${s};\n        int q = d2 - d1 * ${s};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${d}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${m}\n        ${f}\n        setOutput(result);\n      }\n    `}}const X7={kernelName:y_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;null==c&&(c=[1,1]),GR(AP(o,c),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`));const h=wP(i.shape,s.shape,o,c,a,u,!0);let d;d=C$().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new K7(h):new q7(h);const p=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[i,s],"float32",p)}};class Y7{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${s} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yR = 0; yR < ${e.outHeight}; yR++) {\n            int xR = wR + yR * ${t} - ${r};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${e.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${i};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Q7{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,s=t-1-e.padInfo.top,o=n-1-e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${s}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${a}; dm++) {\n              int d2 = d1 * ${a} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const J7={kernelName:b_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,h=wP(i.shape,c,o,a,l,u,!0),d=new Y7(h);return n.runWebGLProgram(d,[i,s],"float32")}};const Z7={kernelName:x_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,h=wP(c,s.shape,o,a,l,u,!0),d=new Q7(h);return n.runWebGLProgram(d,[i,s],"float32")}};class eee{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const tee={kernelName:w_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],s=KR(r.shape),o=_9({inputs:{x:r},backend:n,attrs:{shape:[s]}}),a=new eee(s),l=n.runWebGLProgram(a,[o],o.dtype),u=_9({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}};class nee{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:r,strideHeight:i,strideWidth:s,filterHeight:o,filterWidth:a,dilationHeight:l,dilationWidth:u}=e,{top:c,left:h}=r;this.userCode=`\n      const ivec2 strides = ivec2(${i}, ${s});\n      const ivec2 pads = ivec2(${c}, ${h});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${o}; h++) {\n          int hIn = hBeg + h * ${l};\n\n          if (hIn >= 0 && hIn < ${t}) {\n            for (int w = 0; w < ${a}; w++) {\n              int wIn = wBeg + w * ${u};\n\n              if (wIn >= 0 && wIn < ${n}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}const ree={kernelName:k_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:l}=r,u=yP(i.shape,s.shape,o,a,"NHWC",l);let c;const h=new nee(u);c=n.runWebGLProgram(h,[i,s],"float32");const d=_9({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),d}};const iee={kernelName:T_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,s=t,{allDims:o,summedDims:a,idDims:l}=dW(i,s.length);fW(o.length,l,s);const{path:u,steps:c}=mW(a,l),h=c.length;let d=null,p=o.length;const f=[];for(let m=0;m<h;++m){for(const e of c[m]){const{permutationIndices:t,expandDims:r}=pW(p,l[e]);let i;gW(t)?i=s[e]:(i=W9({inputs:{x:s[e]},backend:n,attrs:{perm:t}}),f.push(i));const o=i.shape.slice();for(let e=0;e<r.length;++e)o.splice(r[e],0,1);XR(i.shape,o)||(i=_9({inputs:{x:i},backend:n,attrs:{shape:o}}),f.push(i)),null===d?d=i:(d=R9({inputs:{a:i,b:d},backend:n}),f.push(d))}m<h-1&&(u[m]>=0&&(d=B9({inputs:{x:d},backend:n,attrs:{axis:u[m]-(o.length-p),keepDims:!1}}),f.push(d)),p--)}for(const m of f)m!==d&&n.disposeIntermediateTensorInfo(m);return d}},see=k9({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),oee={kernelName:N_,backendName:"webgl",kernelFunc:see},aee={kernelName:A_,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n}=e,{dy:r,y:i}=t,s=C$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new c9("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,i.shape):new l9("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,i.shape);return n.runWebGLProgram(s,[r,i],r.dtype)}},lee=S9({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:Z5}),uee={kernelName:$_,backendName:"webgl",kernelFunc:lee},cee=k9({opSnippet:`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${KU};\n  float a1 = ${XU};\n  float a2 = ${YU};\n  float a3 = ${QU};\n  float a4 = ${JU};\n  float a5 = ${ZU};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`}),hee={kernelName:R_,backendName:"webgl",kernelFunc:cee},dee=k9({opSnippet:w9+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:e6,dtype:"float32"}),pee={kernelName:__,backendName:"webgl",kernelFunc:dee};function fee(e){const{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:s}=t,o=s.shape.length,a=s.shape.slice();let l=i;return i<0&&(GR(-(o+1)<=i,(()=>`Axis must be in the interval [${-(o+1)}, ${o}]`)),l=o+i+1),a.splice(l,0,1),_9({inputs:{x:s},backend:r,attrs:{shape:a}})}const mee={kernelName:O_,backendName:"webgl",kernelFunc:fee},gee="return exp(x) - 1.0;",vee=k9({opSnippet:gee,packedOpSnippet:gee,cpuKernelImpl:t6}),yee={kernelName:D_,backendName:"webgl",kernelFunc:vee};class bee{constructor(e,t,n){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const i=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=n?`${r}.0`:"1.0";let o;if("real"===e)o="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);o="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${i};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${o}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${r});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${r}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${s};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}function xee(e,t,n){const r=n.texData.get(e.dataId),i=KR(e.shape),s=e.shape[e.shape.length-1],o=_9({inputs:{x:e},backend:n,attrs:{shape:[i/s,s]}}),a=o.shape,l=new bee("real",a,t),u=new bee("imag",a,t),c=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:a},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:a}],h=n.runWebGLProgram(l,c,"float32"),d=n.runWebGLProgram(u,c,"float32"),p=p9({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);const f=_9({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(p),f}const wee={kernelName:F_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return xee(r,!1,n)}};class kee{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function See(e){const{backend:t,attrs:n}=e,{shape:r,value:i}=n;let{dtype:s}=n;if(s=s||u$(i),"string"===s){const e=i$(s,KR(r));return e.fill(i),t.makeTensorInfo(r,s,e)}{const e=new kee(r,i),n=[[i]];return t.runWebGLProgram(e,[],s,n)}}const Iee={kernelName:M_,backendName:"webgl",kernelFunc:See};class Cee{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${t} - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${t}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const Eee={kernelName:L_,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{image:r}=t,i=n,s=new Cee(r.shape);return i.runWebGLProgram(s,[r],r.dtype)}},Tee="return floor(x);",Nee=k9({opSnippet:Tee,packedOpSnippet:Tee,cpuKernelImpl:n6}),Aee={kernelName:P_,backendName:"webgl",kernelFunc:Nee},Ree=S9({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),$ee={kernelName:z_,backendName:"webgl",kernelFunc:Ree};class _ee{constructor(e){this.variableNames=["A"];const t=r5(),[n,r]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);\n\n        vec4 values = ${t.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class Oee{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=r5(),[n,r]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${r}.0, ${n}.0);\n            vec4 values = ${t.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${t.output} = result;\n      }\n    `}}const Dee={kernelName:MD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:i}=t;const{numChannels:s}=r,o="undefined"!==typeof HTMLVideoElement&&i instanceof HTMLVideoElement,a="undefined"!==typeof HTMLImageElement&&i instanceof HTMLImageElement,[l,u]=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[u,l],h=[u,l,s];if(a||o){const e=C$().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=Fee&&e===Mee||(Mee=e,Fee=document.createElement("canvas").getContext("2d",{willReadFrequently:Mee})),Fee.canvas.width=l,Fee.canvas.height=u,Fee.drawImage(i,0,0,l,u),i=Fee.canvas}const d=n.makeTensorInfo(c,"int32");n.texData.get(d.dataId).usage=S4.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);const p=C$().getBool("WEBGL_PACK")?new Oee(h):new _ee(h),f=n.runWebGLProgram(p,[d],"int32");return n.disposeData(d.dataId),f}};let Fee,Mee=C$().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const Lee={kernelName:zD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r,m=$P(c),g=wP(i.shape,s.shape,l,h,u,d,!1,m);let v;const y=[],b=null!=o,x=null!=a,w="leakyrelu"===p,k=()=>{const e=[i,s],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){const t=_9({inputs:{x:e},backend:n,attrs:{shape:[e.shape[0],1,1]}});return y.push(t),t}return e};if(b&&e.push(t(o,c)),x&&e.push(t(a,c)),w){const t=n.makeTensorInfo([],"float32",dF(f,"float32"));e.push(t),y.push(t)}return e};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===m&&C$().getBool("WEBGL_EXP_CONV")){const e=p?I9(p,!0):null,t=new f7(g,b,e,x,w),r=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],i=k();v=n.runWebGLProgram(t,i,"float32",r)}else if(C$().getBool("WEBGL_CONV_IM2COL"))v=y7({x:i,filter:s,convInfo:g,backend:n,bias:o,activation:p,preluActivationWeights:a,leakyreluAlpha:f});else{const e=p?I9(p,!1):null,t=new d7(g,b,e,x,w),r=k();v=n.runWebGLProgram(t,r,"float32")}else v=v7({x:i,filter:s,convInfo:g,backend:n,bias:o,activation:p,preluActivationWeights:a,leakyreluAlpha:f});const S=_9({inputs:{x:v},backend:n,attrs:{shape:g.outShape}});return y.push(v),y.forEach((e=>n.disposeIntermediateTensorInfo(e))),S}};const Pee={kernelName:BD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:l,pad:u,dilations:c,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r,f=[];let m=c;null==m&&(m=[1,1]),GR(AP(l,m),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`));const g=wP(i.shape,s.shape,l,m,u,h,!0),v=C$().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,y=d?I9(d,v):null,b=[i,s],x=null!=o,w=null!=a,k="leakyrelu"===d;if(x&&b.push(o),w&&b.push(a),k){const e=n.makeTensorInfo([],"float32",dF(p,"float32"));b.push(e),f.push(e)}let S;S=v?new K7(g,x,y,w,k):new q7(g,x,y,w,k);const I=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],C=n.runWebGLProgram(S,b,"float32",I);return f.forEach((e=>n.disposeIntermediateTensorInfo(e))),C}};class zee{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const i=x5(n.length);let s="\n    int index;";for(let o=0;o<this.sliceDim;o++)s+=`\n          index = round(getIndices(coords[0], ${o}));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};\n          flattenIndex += index * ${this.strides[o]};`;this.userCode=`\n         void main() {\n          ${i} coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ${s}\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      `}}const Bee={kernelName:W_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,s=i.shape,o=s[s.length-1],a=KR(r.shape),[l,u,c,h]=WU(r,i),d=_9({inputs:{x:i},backend:n,attrs:{shape:[u,o]}}),p=_9({inputs:{x:r},backend:n,attrs:{shape:[KR(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,i])||"string"===r.dtype){const e=n.readSync(i.dataId),t=n.bufferSync(r),s=r6(e,t,r.dtype,u,o,c,h,r.shape,a);return n.makeTensorInfo(l,r.dtype,s.values)}const f=new zee(o,h,[u,c],r.shape),m=n.runWebGLProgram(f,[p,d],p.dtype),g=_9({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}};class Uee{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=x5(this.rank),r=function(e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<e.length;r++)2===r?n.push("index"):n.push(`${t[r]}`);return n.join()}(e);this.userCode=`\n      void main() {\n        ${n} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${r}));\n      }\n    `}}function Wee(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:s}=t,{axis:o,batchDims:a}=r,l=t$(o,i.shape)[0];if(C$().get("DEBUG")){const e=n.readSync(s.dataId),t=i.shape[l];for(let n=0;n<e.length;++n){const r=e[n];GR(r<=t-1&&r>=0,(()=>`GatherV2: the index value ${r} is not in [0, ${t-1}]`))}}const u=OW(i,s,l,a),c=KR(s.shape),h=[],d=_9({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=_9({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});h.push(d),h.push(p);const f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([i,s])||"string"===i.dtype){const e=n.bufferSync(p),t=n.bufferSync(d),r=i6(t,e,f);return h.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(u.outputShape,r.dtype,r.values)}const m=new Uee(d.shape,f),g=n.runWebGLProgram(m,[d,p],d.dtype);h.push(g);const v=_9({inputs:{x:g},backend:n,attrs:{shape:u.outputShape}});return h.forEach((e=>n.disposeIntermediateTensorInfo(e))),v}const Vee={kernelName:U_,backendName:"webgl",kernelFunc:Wee},jee=S9({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:s6,dtype:"bool"}),Gee={kernelName:V_,backendName:"webgl",kernelFunc:jee},Hee=S9({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:o6}),qee={kernelName:j_,backendName:"webgl",kernelFunc:Hee};const Kee={kernelName:H_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return xee(r,!0,n)}},Xee=k9({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),Yee={kernelName:K_,backendName:"webgl",kernelFunc:Xee},Qee=k9({opSnippet:"return float(isinf(x));",dtype:"bool"}),Jee={kernelName:X_,backendName:"webgl",kernelFunc:Qee},Zee=k9({opSnippet:"return float(isnan(x));",dtype:"bool"}),ete={kernelName:Y_,backendName:"webgl",kernelFunc:Zee},tte=S9({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:a6,dtype:"bool"}),nte={kernelName:J_,backendName:"webgl",kernelFunc:tte},rte=S9({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:l6,dtype:"bool"}),ite={kernelName:Z_,backendName:"webgl",kernelFunc:rte};const ste={kernelName:eO,backendName:"webgl",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:s}=n,o=u6(r,i,s);return t.makeTensorInfo([o.length],"float32",o)}},ote=k9({opSnippet:w9+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:c6}),ate={kernelName:tO,backendName:"webgl",kernelFunc:ote},lte=k9({opSnippet:w9+"\n  return log(1.0 + x);\n"}),ute={kernelName:nO,backendName:"webgl",kernelFunc:lte},cte=S9({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),hte={kernelName:rO,backendName:"webgl",kernelFunc:cte},dte=k9({opSnippet:"return float(!(x >= 1.0));"}),pte={kernelName:iO,backendName:"webgl",kernelFunc:dte},fte=S9({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),mte={kernelName:sO,backendName:"webgl",kernelFunc:fte};class gte{constructor(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];const s=t,o=e[3]-1;let a;this.outputShape=e;const l=`float(${n}) + float(${r}) * sum`;a=.5===i?`inversesqrt(${l})`:1===i?`1.0/(${l})`:`exp(log(${l}) * float(-${i}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${s}; j <= ${s}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${o}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${a};\n        setOutput(val);\n      }\n    `}}class vte{constructor(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const s=t,o=e[3]-1;let a;this.outputShape=e;const l=`float(${n}) + float(${r}) * sum`;a=.5===i?`inversesqrt(${l})`:1===i?`1.0/(${l})`:`exp(log(${l}) * float(-${i}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${s};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${s}; j <= ${s}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${a};\n        setOutput(result);\n      }\n    `}}const yte={kernelName:oO,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:s,bias:o,alpha:a,beta:l}=r,u=C$().getBool("WEBGL_PACK_NORMALIZATION")?new vte(i.shape,s,o,a,l):new gte(i.shape,s,o,a,l);return n.runWebGLProgram(u,[i],i.dtype)}};class bte{constructor(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${t})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${t} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${r}) * norm + float(${n});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${r})\n                * float(${i})\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${i});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}const xte={kernelName:aO,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i,y:s,dy:o}=t,{depthRadius:a,bias:l,alpha:u,beta:c}=r,h=new bte(i.shape,a,l,u,c);return n.runWebGLProgram(h,[i,s,o],i.dtype)}};function wte(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:s,keepDims:o}=r,a=i.shape.length,l=t$(s,i.shape);let u=l;const c=Iz(u,a),h=null!=c,d=n.shouldExecuteOnCPU([i]);let p=i;if(h){if(d){const e=n.texData.get(p.dataId).values,t=new Array(a);for(let n=0;n<t.length;n++)t[n]=i.shape[c[n]];const r=z6(e,i.shape,i.dtype,c,t);p=n.makeTensorInfo(t,i.dtype);n.texData.get(p.dataId).values=r}else p=z9(i,c,n);u=Ez(u.length,a)}Sz("max",u,a);const[f,m]=wz(p.shape,u);let g,v=f;if(o&&(v=kz(f,l)),d){const e=n.texData.get(p.dataId).values,t=h6(e,KR(m),v,i.dtype);g=n.makeTensorInfo(v,i.dtype);n.texData.get(g.dataId).values=t}else g=function(e,t,n,r){const i=KR(t),s=_9({inputs:{x:e},attrs:{shape:[KR(e.shape)/i,i]},backend:r}),o=M9(s,e.dtype,"max",r),a=_9({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),a}(p,m,v,n);return h&&n.disposeIntermediateTensorInfo(p),g}const kte={kernelName:lO,backendName:"webgl",kernelFunc:wte},Ste=S9({opSnippet:a9+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+u9+"\n  return result;\n",cpuKernelImpl:d6}),Ite={kernelName:uO,backendName:"webgl",kernelFunc:Ste};const Cte={kernelName:cO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;t5(i,"maxPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:l}=r;GR(AP(o,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`));const u=bP(i.shape,s,o,1,a,l);if(1===u.filterWidth&&1===u.filterHeight&&XR(u.inShape,u.outShape))return h9({inputs:{x:i},backend:n});const c=new S8(u,"max",!1);return n.runWebGLProgram(c,[i],i.dtype)}};const Ete={kernelName:dO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=xP(i.shape,s,o,[1,1,1],a,u,l),h=new I8(c,"max",!1);return n.runWebGLProgram(h,[i],i.dtype)}};class Tte{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,s=e.effectiveFilterWidth,o=i-1-e.padInfo.top,a=s-1-e.padInfo.left,l=i*s-1;this.userCode=`\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${i};\n          wR += ${r}) {\n          float dyR = float(dyRCorner + wR) / ${t}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${s}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${n}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${s} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Nte{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,s=e.dilationHeight,o=e.dilationWidth,a=e.effectiveFilterDepth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=a-1-e.padInfo.front,h=l-1-e.padInfo.top,d=u-1-e.padInfo.left,p=a*l*u-1;this.userCode=`\n      const ivec3 pads = ivec3(${c}, ${h}, ${d});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${a};\n           wD += ${i}) {\n          float dyD = float(dyDCorner + wD) / ${t}.0;\n\n          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${l};\n              wR += ${s}) {\n            float dyR = float(dyRCorner + wR) / ${n}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${u};\n                wC += ${o}) {\n              float dyC = float(dyCCorner + wC) / ${r}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${p} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${l} * ${u} +\n                  wR * ${u} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const Ate={kernelName:pO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,h=xP(o.shape,a,l,[1,1,1],u,c),d=new I8(h,"max",!0),p=n.runWebGLProgram(d,[o],o.dtype),f=new Nte(h),m=n.runWebGLProgram(f,[i,p],o.dtype);return n.disposeIntermediateTensorInfo(p),m}};const Rte={kernelName:hO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s,output:o}=t,a=s;t5([s,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:h}=r,d=bP(a.shape,l,u,1,c,h),p=new S8(d,"max",!0),f=n.runWebGLProgram(p,[a],a.dtype),m=new Tte(d),g=n.runWebGLProgram(m,[i,f],a.dtype);return n.disposeIntermediateTensorInfo(f),g}};const $te={kernelName:fO,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:i}=t,{filterSize:s,strides:o,pad:a,includeBatchInIndex:l}=n,u=r;GR(4===i.shape.length,(()=>`Error in maxPool: input must be rank 4 but got rank ${i.shape.length}.`));const c=[1,1];GR(AP(o,c),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`));const h=bP(i.shape,s,o,c,a),[d,p]=function(e,t,n,r){let i=new S8(n,"max",!1);const s=r.runWebGLProgram(i,[e],"float32");return i=new S8(n,"max",!0,!0,t),[s,r.runWebGLProgram(i,[e],"float32")]}(i,l,h,u);return[d,p]}};const _te={kernelName:mO,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:i}=t,{keepDims:s,axis:o}=n,a=r,l=i.shape.length,u=t$(o,i.shape);let c=u;const h=Iz(c,l),d=null!=h,p=a.shouldExecuteOnCPU([i]),f=[];let m=i;if(d){if(p){const e=a.texData.get(m.dataId).values,t=new Array(l);for(let r=0;r<t.length;r++)t[r]=i.shape[h[r]];const n=z6(e,i.shape,i.dtype,h,t);m=a.makeTensorInfo(t,i.dtype);a.texData.get(m.dataId).values=n}else m=z9(i,h,a);f.push(m),c=Ez(c.length,l)}Sz("sum",c,l);const[g,v]=wz(m.shape,c);let y=g;s&&(y=kz(g,u));const b=function(e,t,n,r){const i=KR(t),s=_9({inputs:{x:e},attrs:{shape:[KR(e.shape)/i,i]},backend:r}),o=M9(s,"float32","mean",r),a=_9({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),a}(m,v,y,a);for(const x of f)a.disposeIntermediateTensorInfo(x);return b}};const Ote={kernelName:gO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,l=t$(s,i.shape);let u=l;const c=Iz(u,a);let h=i;null!=c&&(h=W9({inputs:{x:i},backend:n,attrs:{perm:c}}),u=Ez(u.length,i.shape.length)),Sz("min",u,a);const[d,p]=wz(h.shape,u),f=_9({inputs:{x:h},backend:n,attrs:{shape:[-1,KR(p)]}}),m=M9(f,f.dtype,"min",n);let g;if(o){g=_9({inputs:{x:m},backend:n,attrs:{shape:kz(d,l)}})}else g=_9({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(h),g}},Dte=S9({opSnippet:a9+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+u9+"\n  return result;\n",cpuKernelImpl:p6}),Fte={kernelName:vO,backendName:"webgl",kernelFunc:Dte};class Mte{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,i=x5(r),s=t.map((e=>e[0])).join(","),o=t.map(((t,n)=>t[0]+e[n])).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l="reflect"===n?0:1;this.userCode=1!==r?`\n      ${i} start = ${i}(${s});\n      ${i} end = ${i}(${o});\n\n      void main() {\n        ${i} outC = getOutputCoords();\n        for (int i = 0; i < ${r}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${l};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};\n          }\n        }\n        ${i} coords = outC - start;\n        setOutput(getX(${a}));\n      }\n    `:`\n        int start = ${s};\n        int end = ${o};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${l};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${l};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}class Lte{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,i=x5(r),s=t.map((e=>e[0])).join(","),o=t.map(((t,n)=>t[0]+e[n])).join(","),a=W6("rc",r),l=W6("source",r),u=`${a[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${l.slice(-2).join()})`,h="reflect"===n?0:1;let d="";if(1===r){const e=`\n        ${i} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${h};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${h};\n        }\n        source -= start;\n      `;d=`\n        ${i} rc = outputLoc;\n        ${e}\n        result[0] = getChannel(getX(${l.join()}), ${c});\n        ${a[r-1]} += 1;\n        if(${u}) {\n          ${e}\n          result[1] = getChannel(getX(${l.join()}), ${c});\n        }\n      `}else{const e=`\n        ${i} source = rc;\n        ${i} lt = ${i}(lessThan(source, start));\n        ${i} gte = ${i}(greaterThanEqual(source, end));\n        ${i} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${h}) +\n                gte * ((end - 1) * 2 - source + ${h});\n        source -= start;\n      `;d=`\n        ${i} rc = outputLoc;\n        ${e}\n        result[0] = getChannel(getX(${l.join()}), ${c});\n        ${a[r-1]} += 1;\n        if(${u}) {\n          ${e}\n          result[1] = getChannel(getX(${l.join()}), ${c});\n        }\n        rc = outputLoc;\n        ${a[r-2]} += 1;\n        if(${a[r-2]} < ${this.outputShape[r-2]}) {\n          ${e}\n          result[2] = getChannel(getX(${l.join()}), ${c});\n          ${a[r-1]} += 1;\n          if(${u}) {\n            ${e}\n            result[3] = getChannel(getX(${l.join()}), ${c});\n          }\n        }\n      `}this.userCode=`\n      const ${i} start = ${i}(${s});\n      const ${i} end = ${i}(${o});\n\n      void main() {\n        ${i} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${d}\n        setOutput(result);\n      }\n    `}}const Pte={kernelName:yO,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:i}=t,{paddings:s,mode:o}=r,a=C$().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Lte(i.shape,s,o):new Mte(i.shape,s,o);return n.runWebGLProgram(a,[i],i.dtype)}},zte=S9({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+u9+"\n  return result;\n"}),Bte={kernelName:bO,backendName:"webgl",kernelFunc:zte};class Ute{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${t-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${t-1}));\n      }\n    `}}const Wte=S9({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),Vte={kernelName:E_,backendName:"webgl",kernelFunc:Wte},jte="return a - b;",Gte=S9({opSnippet:jte,packedOpSnippet:jte,supportsComplex:!0,cpuKernelImpl:M6}),Hte={kernelName:ID,backendName:"webgl",kernelFunc:Gte};function qte(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:s}=r,o=t$([s],i.shape),a=wte({inputs:{x:i},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=kz(a.shape,o),u=_9({inputs:{x:a},backend:n,attrs:{shape:l}}),c=Gte({inputs:{a:i,b:u},backend:n}),h=dee({inputs:{x:c},backend:n}),d=B9({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:!1}}),p=_9({inputs:{x:d},backend:n,attrs:{shape:l}}),f=Wte({inputs:{a:h,b:p},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),f}const Kte={kernelName:hD,backendName:"webgl",kernelFunc:qte};const Xte={kernelName:xO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:s,seed:o,normalized:a}=r,l=a?i:qte({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),u=l.shape[0],c=l.shape[1],h=new Ute(u,c,s),d=[[o]],p=n.runWebGLProgram(h,[l],"int32",d);return a||n.disposeIntermediateTensorInfo(l),p}},Yte=Y6+"\n  return -x;\n";const Qte={kernelName:kO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const e=n.texData.get(r.dataId),[t,i]=m6(e.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,t)}let i;return i=C$().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new t9(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new X6(r.shape,Yte),n.runWebGLProgram(i,[r],r.dtype)}},Jte=HB;const Zte={kernelName:IO,backendName:"webgl",kernelFunc:function(e){UD("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(i.dataId),c=n.readSync(s.dataId),{selectedIndices:h}=Jte(u,c,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},ene=qB;const tne={kernelName:CO,backendName:"webgl",kernelFunc:function(e){UD("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(i.dataId),h=n.readSync(s.dataId),{selectedIndices:d,validOutputs:p}=ene(c,h,o,a,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},nne=KB;const rne={kernelName:EO,backendName:"webgl",kernelFunc:function(e){UD("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(i.dataId),h=n.readSync(s.dataId),d=o,p=a,f=l,m=u,{selectedIndices:g,selectedScores:v}=nne(c,h,d,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}};class ine{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${r}), float(${n}),\n                      float(index == coords.y)));\n      }\n    `}}const sne={kernelName:NO,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:s,depth:o,onValue:a,offValue:l}=r,u=KR(i.shape),c=new ine(u,o,a,l),h=_9({inputs:{x:i},backend:n,attrs:{shape:[u]}}),d=n.runWebGLProgram(c,[h],s);n.disposeIntermediateTensorInfo(h);const p=_9({inputs:{x:d},backend:n,attrs:{shape:[...i.shape,o]}});return n.disposeIntermediateTensorInfo(d),p}};function one(e){const{inputs:t,backend:n}=e,{x:r}=t;if("complex64"===r.dtype){const e=H8({inputs:{input:r},backend:n}),t=one({inputs:{x:e},backend:n}),i=a7({inputs:{input:r},backend:n}),s=one({inputs:{x:i},backend:n}),o=p9({inputs:{real:t,imag:s},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),o}return See({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const ane={kernelName:DD,backendName:"webgl",kernelFunc:one};const lne={kernelName:TO,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:i}=n;if("string"===i.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===i.dtype){const t=H8({inputs:{input:i},backend:r}),n=e({inputs:{x:t},backend:r}),s=a7({inputs:{input:i},backend:r}),o=one({inputs:{x:s},backend:r}),a=p9({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),a}return See({attrs:{shape:i.shape,dtype:i.dtype,value:1},backend:r})}};const une={kernelName:AO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(1===t.length)return fee({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const s=t[0].shape,o=t[0].dtype;t.forEach((e=>{HR(s,e.shape,"All tensors passed to stack must have matching shapes"),GR(o===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const a=[],l=c7({inputs:t.map((e=>{const t=fee({inputs:{input:e},backend:n,attrs:{dim:i}});return a.push(t),t})),backend:n,attrs:{axis:i}});return a.forEach((e=>n.disposeIntermediateTensorInfo(e))),l}};class cne{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,i=x5(r),s=t.map((e=>e[0])).join(","),o=t.map(((t,n)=>t[0]+e[n])).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?`\n      ${i} start = ${i}(${s});\n      ${i} end = ${i}(${o});\n\n      void main() {\n        ${i} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${i} coords = outC - start;\n          setOutput(getX(${a}));\n        }\n      }\n    `:`\n        int start = ${s};\n        int end = ${o};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class hne{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,i=x5(r),s=t.map((e=>e[0])).join(","),o=t.map(((t,n)=>t[0]+e[n])).join(","),a=W6("rc",r),l=W6("source",r),u=`${a[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${l.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${a[r-1]} += 1;\n       if(${u}) {\n      `,1===r?"":`}\n       rc = outputLoc;\n       ${a[r-2]} += 1;\n       if(${a[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${a[r-1]} += 1;\n         if(${u}) {`],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,m=1===r?2:4;f<m;f++)p+=`\n        ${h[f]}\n        if (${d}) {\n          result[${f}] = float(value);\n        } else {\n          ${i} source = rc - start;\n          result[${f}] = getChannel(getX(${l.join()}), ${c});\n        }\n      `;p+=1===r?"} ":"}}",this.userCode=`\n      const ${i} start = ${i}(${s});\n      const ${i} end = ${i}(${o});\n\n      void main() {\n        ${i} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}const dne=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,constantValue:o}=r;if(0===KR(i.shape)){return See({backend:n,attrs:{shape:s.map(((e,t)=>e[0]+i.shape[t]+e[1])),value:o,dtype:i.dtype}})}const a=C$().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new hne(i.shape,s,o):new cne(i.shape,s,o),l=[[o]];return n.runWebGLProgram(a,[i],i.dtype,l)},pne={kernelName:RO,backendName:"webgl",kernelFunc:dne},fne=S9({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+u9+"\n  return result;\n"}),mne={kernelName:$O,backendName:"webgl",kernelFunc:fne};const gne={kernelName:OO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,l=[],u=t$(s,i.shape);let c=u;const h=Iz(c,a);let d,p=i;if(null!=h&&(p=W9({inputs:{x:i},backend:n,attrs:{perm:h}}),c=Ez(c.length,a),l.push(p)),Sz("prod",c,a),n.shouldExecuteOnCPU([p])){const e=n.texData.get(p.dataId).values,{outVals:t,outShape:r,outDtype:i}=v6(p.shape,p.dtype,e,c);d=n.makeTensorInfo(r,i,t)}else{const[e,t]=wz(p.shape,c),r=KR(t),s=_9({inputs:{x:p},backend:n,attrs:{shape:[-1,r]}}),o=M9(s,HF(i.dtype),"prod",n);d=_9({inputs:{x:o},backend:n,attrs:{shape:e}}),l.push(s),l.push(o)}if(o){l.push(d);const e=kz(d.shape,u);d=_9({inputs:{x:d},backend:n,attrs:{shape:e}})}return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),d}};const vne={kernelName:DO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:s,indices:o}=t,{outputRaggedRank:a}=r,l=i.map((e=>n.readSync(e.dataId))),u=i.map((e=>e.shape)),c=n.readSync(s.dataId),h=n.readSync(o.dataId),[d,p,f]=y6(l,u,c,s.shape,s.dtype,h,o.shape,a),m=d.map((e=>n.makeTensorInfo([e.length],"int32",e))),g=n.makeTensorInfo(f,s.dtype,p);return m.concat([g])}};const yne={kernelName:FO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:s}=t,o=n.readSync(r.dataId),a=n.readSync(i.dataId),l=n.readSync(s.dataId),[u,c]=b6(o,r.shape,r.dtype,a,i.shape,l,s.shape);return[n.makeTensorInfo([u.length],"int32",u),n.makeTensorInfo([c.length],r.dtype,c)]}};const bne={kernelName:MO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:s,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:l}=r,u=n.readSync(i.dataId),c=n.readSync(s.dataId),h=n.readSync(o.dataId),d=a.map((e=>n.readSync(e.dataId))),p=a.map((e=>e.shape)),[f,m]=x6(u,i.shape,c,s.shape,s.dtype,h,o.shape,d,p,l);return n.makeTensorInfo(f,s.dtype,m)}},xne=e=>{const{backend:t,attrs:n}=e,{start:r,stop:i,step:s,dtype:o}=n,a=w6(r,i,s,o);return t.makeTensorInfo([a.length],o,a)},wne={kernelName:LO,backendName:"webgl",kernelFunc:xne},kne=k9({opSnippet:"return 1.0 / x;"}),Sne={kernelName:zO,backendName:"webgl",kernelFunc:kne},Ine=k9({opSnippet:Y6+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Cne={kernelName:BO,backendName:"webgl",kernelFunc:Ine},Ene=k9({opSnippet:Y6+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Tne={kernelName:HO,backendName:"webgl",kernelFunc:Ene};class Nne{constructor(e,t,n,r,i){this.variableNames=["A"],this.outputShape=[];const[s,o,a,l]=e;this.outputShape=[s,t,n,l];const u=[r&&t>1?o-1:o,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];let h;h=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${o}.0, ${a}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${h};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class Ane{constructor(e,t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,o,a,l]=e;this.outputShape=[s,t,n,l];const u=[r&&t>1?o-1:o,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];let h;h=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]},\n          ${u[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${o}.0, ${a}.0,\n                                     ${a}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${h};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}const Rne={kernelName:jO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r,[l,u]=a,c=C$().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Ane(i.shape,l,u,s,o):new Nne(i.shape,l,u,s,o);return n.runWebGLProgram(c,[i],"float32")}};class $ne{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,i]=t,[,s,o]=e,a=[n&&s>1?r-1:r,n&&o>1?i-1:i],l=[n&&s>1?s-1:s,n&&o>1?o-1:o],u=a[0]/l[0],c=a[1]/l[1],h=1/u,d=1/c,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${s}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${o}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const _ne={kernelName:GO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r,a=new $ne(s.shape,i.shape,o);return n.runWebGLProgram(a,[s],s.dtype)}};class One{constructor(e,t,n,r,i){this.variableNames=["A"],this.outputShape=[];const[s,o,a,l]=e;this.outputShape=[s,t,n,l];const u=[r&&t>1?o-1:o,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${o}.0, ${a}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${d};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}class Dne{constructor(e,t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,o,a,l]=e;this.outputShape=[s,t,n,l];const u=[r&&t>1?o-1:o,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]},\n          ${u[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${o}.0, ${a}.0,\n                                     ${a}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${d};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `}}const Fne={kernelName:WO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r,[l,u]=a,c=C$().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Dne(i.shape,l,u,s,o):new One(i.shape,l,u,s,o);return n.runWebGLProgram(c,[i],i.dtype)}};class Mne{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,i]=t,[,s,o]=e,a=[n&&s>1?r-1:r,n&&o>1?i-1:i],l=[n&&s>1?s-1:s,n&&o>1?o-1:o],u=a[0]/l[0],c=a[1]/l[1],h=1/u,d=1/c,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${s}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${o}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${a[0]}) *\n                (float(dyR) / float(${l[0]}));\n\n            float sourceFracCol =\n                float(${a[1]}) *\n                  (float(dyC) / float(${l[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${r}) - 1),\n                ${n} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${i}) - 1),\n                ${n} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const Lne={kernelName:VO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r,a=new Mne(s.shape,i.shape,o);return n.runWebGLProgram(a,[s],s.dtype)}};class Pne{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${e[0]} - coord - 1));\n        }\n      `);const r=e.map(((n,r)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - coords[${n}] - 1`:`coords[${n}]`)(r))).join(","),i=x5(n);this.userCode=`\n      void main() {\n        ${i} coords = getOutputCoords();\n        setOutput(getX(${r}));\n      }\n    `}}class zne{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;const r=W6("rc",n),i=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,s=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,o=x5(n);function a(n){const r=e.map(((r,i)=>function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - ${r[n]} - 1`:`${r[n]}`}(i,n)));return`getChannel(getX(${r.join(",")}), vec2(${r.slice(-2).join(",")}))`}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${e[0]} - rc - 1),\n            ${e[0]} - rc - 1);\n          if(${i}){\n              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),\n                ${e[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${o} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(e){return a(e)}(r.slice())};\n          if(${i}){\n            result.g = ${function(e){return e[n-1]="("+e[n-1]+" + 1)",a(e)}(r.slice())};\n          }\n          if(${s}) {\n            result.b = ${function(e){return e[n-2]="("+e[n-2]+" + 1)",a(e)}(r.slice())};\n            if(${i}) {\n              result.a = ${function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",a(e)}(r.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}const Bne={kernelName:qO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:s}=r,o=i.shape.length,a=t$(s,i.shape);if(0===o)return h9({inputs:{x:i},backend:n});const l=C$().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zne(i.shape,a):new Pne(i.shape,a);return n.runWebGLProgram(l,[i],i.dtype)}};class Une{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],r=e[2];this.outputShape=e;let i="";i="number"===typeof t?`float outputValue = ${t.toFixed(2)};`:`\n        vec3 fill = vec3(${t.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ${i}\n          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const Wne={kernelName:LD,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:i}=t,{radians:s,fillValue:o,center:a}=n,l=r,u=new Une(i.shape,o),[c,h]=MU(a,i.shape[1],i.shape[2]),d=[[c,h,Math.sin(s),Math.cos(s)]];return l.runWebGLProgram(u,[i],i.dtype,d)}},Vne=k9({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),jne={kernelName:KO,backendName:"webgl",kernelFunc:Vne},Gne=k9({opSnippet:"return inversesqrt(x);",cpuKernelImpl:k6}),Hne={kernelName:XO,backendName:"webgl",kernelFunc:Gne};class qne{constructor(e,t,n,r,i,s){let o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;const a=x5(i.length),l=x5(s.length);let u="";1===n?u="i":2===n&&(u="i, j");const c=`getIndices(${u})`;let h="";1===r?h="i":2===r&&(h="i, coords[1]");const d=`getUpdates(${h})`;let p="";o&&(p="coords[0], coords[1]");const f=`getDefaultValue(${p})`,m=t>1?"strides[j]":"strides";this.userCode=`\n        ${a} strides = ${a}(${i});\n\n        void main() {\n          ${l} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${e}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${t}; j++) {\n              int index = round(${c});\n              flattenedIndex += index * ${m};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ${d};\n              found = true;\n            }\n          }\n          setOutput(mix(${f}, sum, float(found)));\n        }\n      `}}class Kne{constructor(e,t,n,r,i,s){let o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s;const a=x5(i.length),l=x5(s.length);let u="";1===n?u="i":2===n&&(u="i, j");const c=`getIndices(${u})`;let h="";1===r?h="i":2===r&&(h="i, coords[1]");const d=`getUpdates(${h})`;let p="";o&&(p="coords[0], coords[1]");const f=`getDefaultValue(${p})`,m=t>1?"strides[j]":"strides",g=t>1?"strides[j + 1]":"strides";this.userCode=`\n        ${a} strides = ${a}(${i});\n\n        void main() {\n          ${l} coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ${e}; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ${t}; j+=2) {\n              ivec4 index = round(${c});\n              flattenedIndex += index.xz * ${m};\n              if (j + 1 < ${t}) {\n                flattenedIndex += index.yw * ${g};\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ${d};\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(${f}, sum, found));\n        }\n      `}}const Xne={kernelName:YO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:s}=t,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=GU(0,i,o),d=[h/u,u];if(0===h)return n.makeTensorInfo(o,i.dtype);const p=_9({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),f=_9({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;g=C$().getBool("WEBGL_PACK")?new Kne(l,a,p.shape.length,f.shape.length,c,d):new qne(l,a,p.shape.length,f.shape.length,c,d);const v=n.runWebGLProgram(g,[f,p,m],f.dtype),y=_9({inputs:{x:v},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),y}};class Yne{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const i=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,s=2===C$().getNumber("WEBGL_VERSION")?"while (left < right) {":i,o="left"===r?"<":"<=";this.userCode=`\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ${s}\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ${o} value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     `}}const Qne={kernelName:JO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:s}=t,{side:o}=r,a=new Yne(i.shape[0],i.shape[1],s.shape[1],o),l=[[i.shape[1]]];return n.runWebGLProgram(a,[i,s],"int32",l)}};class Jne{constructor(e,t,n){let r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)i="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],o=[];for(let r=0;r<t.length;r++)o.push(`${n[r]}`),r<e&&s.push(`${n[r]}`);r=s.join(),i=o.join()}const s=x5(n);this.userCode=`\n      void main() {\n        ${s} resRC = getOutputCoords();\n        float cVal = getC(${r});\n        if (cVal >= 1.0) {\n          setOutput(getA(${i}));\n        } else {\n          setOutput(getB(${i}));\n        }\n      }\n    `}}const Zne={kernelName:ZO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:s}=t,o=new Jne(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(o,[r,i,s],GF(i.dtype,s.dtype))}},ere=k9({opSnippet:`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${HU};\n  float scale = ${qU};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`}),tre={kernelName:eD,backendName:"webgl",kernelFunc:ere},nre=k9({opSnippet:w9+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:I6}),rre={kernelName:sD,backendName:"webgl",kernelFunc:nre},ire=k9({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),sre={kernelName:iD,backendName:"webgl",kernelFunc:ire},ore=k9({opSnippet:w9+"\n  return sin(x);\n",packedOpSnippet:`\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ${u9}\n  return result;\n`}),are={kernelName:nD,backendName:"webgl",kernelFunc:ore},lre=k9({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),ure={kernelName:rD,backendName:"webgl",kernelFunc:lre},cre=k9({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),hre={kernelName:oD,backendName:"webgl",kernelFunc:cre},dre={kernelName:uD,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,paddings:o}=r;GR(i.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const a=s.reduce(((e,t)=>e*t)),l=[[0,0]];l.push(...o);for(let v=1+s.length;v<i.shape.length;++v)l.push([0,0]);const u=[],c=dne({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),h=LU(c.shape,s,a,!1),d=PU(h.length,s.length,!1),p=zU(c.shape,s,a,!1),f=_9({inputs:{x:c},backend:n,attrs:{shape:h}}),m=W9({inputs:{x:f},backend:n,attrs:{perm:d}}),g=_9({inputs:{x:m},backend:n,attrs:{shape:p}});return u.push(c),u.push(f),u.push(m),u.forEach((e=>n.disposeIntermediateTensorInfo(e))),g}};const pre={kernelName:dD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:s,defaultValue:o}=t;if(1!==s.shape.length)throw new Error(`Dense shape must be a vector, saw:\n         ${s.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n         ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n         ${i.shape}`);if(0!==o.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${o.shape}`);const a=n.readSync(r.dataId),l=n.readSync(i.dataId),u=n.readSync(s.dataId),c=n.readSync(o.dataId)[0],[h,d,p,f,m]=T6(a,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],i.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};const fre={kernelName:pD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:s}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(1!==s.shape.length)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(n.readSync(i.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(s.dataId)),[u,c,h]=N6(a,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([h.length],s.dtype,new Int32Array(h))]}};const mre={kernelName:fD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n              ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n              ${s.shape}`);const o=n.readSync(r.dataId),a=n.readSync(i.dataId),l=n.readSync(s.dataId),[u,c]=A6(o,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}};const gre={kernelName:mD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n             ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n             ${s.shape}`);const o=n.readSync(r.dataId),a=n.readSync(i.dataId),l=n.readSync(s.dataId),[u,c]=A6(o,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}};const vre={kernelName:gD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:o}=t,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:h,outputSize:d}=GU(0,i,a),p=!1;if("string"===s.dtype){const e=n.bufferSync(i),t=n.bufferSync(s),r=gF(n.readSync(o.dataId)[0]),f=S6(e,t,a,d,c,u,l,h,r,p);return n.makeTensorInfo(a,f.dtype,f.values)}const f=new qne(u,l,i.shape.length,s.shape.length,h,[d,1],p),m=n.runWebGLProgram(f,[s,i,o],s.dtype),g=_9({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),g}};const yre={kernelName:cD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:s,axis:o}=r,a=t$(o,i.shape)[0],l=yW(i,s,a),u=i.shape.length,c=new Array(u).fill(0),h=i.shape.slice();return l.map((e=>{const t=[...h];t[a]=e;const r=P8({inputs:{x:i},backend:n,attrs:{begin:c,size:t}});return c[a]+=e,r}))}},bre="return sqrt(x);",xre=k9({opSnippet:bre,packedOpSnippet:bre,cpuKernelImpl:R6}),wre={kernelName:aD,backendName:"webgl",kernelFunc:xre},kre={kernelName:yD,backendName:"webgl",kernelFunc:k9({opSnippet:"return x * x;"})},Sre="return (a - b) * (a - b);",Ire=S9({opSnippet:Sre,packedOpSnippet:Sre}),Cre={kernelName:vD,backendName:"webgl",kernelFunc:Ire};const Ere={kernelName:bD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");const s=DW(n.readSync(i.dataId)),o=$6(s,"string",r);return n.makeTensorInfo(i.shape,"string",o)}};const Tre={kernelName:FD,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e;const{x:i}=t,s=Y6+`\n    return x > 0.0 ? 1.0 : float(${n.alpha});\n  `,o=new X6(i.shape,s);return r.runWebGLProgram(o,[i],i.dtype)}};class Nre{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,i=x5(n.length),s=x5(n.length);let o="";if(1===r)o="coords * strides + begin";else{let e=0;o=n.map(((t,r)=>(e++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${e-1}] * strides[${r}] + begin[${r}]`))).join(",")}this.userCode=`\n      ${i} begin = ${i}(${e});\n      ${i} strides = ${i}(${t});\n\n      void main() {\n        ${s} coords = getOutputCoords();\n        setOutput(getX(${o}));\n      }\n    `}}const Are={kernelName:xD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:d}=r,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:v,begin:y,end:b,strides:x}=pP(i.shape,s,o,a,l,u,c,h,d);let w;if(m)w=_9({inputs:{x:i},backend:n,attrs:{shape:f}});else if(g||v){GR(i.shape.length>=1,(()=>`Input must have rank at least 1, got: ${i.shape.length}`));const e=eP(y,b,x),t=P8({inputs:{x:i},backend:n,attrs:{begin:y,size:e}});w=_9({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{if(n.shouldExecuteOnCPU([i])){const e=n.readSync(i.dataId),t=lL(i.shape,i.dtype,e),r=_6(p,t,x,y);w=n.makeTensorInfo(f,i.dtype,r.values)}else{const e=new Nre(y,x,p);w=n.runWebGLProgram(e,[i],i.dtype)}}const k=_9({inputs:{x:w},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(w),k}};const Rre={kernelName:wD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:s,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:h}=t,d=n.readSync(c.dataId),p=n.readSync(h.dataId),[f,m]=O6(d,p,i,s,o,a,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(h.shape,"int32",m)]}};const $re={kernelName:kD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:s,delimiter:o}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(1!==s.shape.length)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(0!==o.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(s.dataId),l=n.readSync(o.dataId)[0],[u,c,h]=D6(a,l,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};const _re={kernelName:SD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(s.dataId),a=F6(o,i);return n.makeTensorInfo(s.shape,"int32",a)}},Ore=k9({opSnippet:"return tan(x);"}),Dre={kernelName:CD,backendName:"webgl",kernelFunc:Ore},Fre=k9({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),Mre={kernelName:ED,backendName:"webgl",kernelFunc:Fre};const Lre={kernelName:QO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:s,updates:o}=t,{}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=GU(0,s,i.shape),d=[h/u,u];if(0===h)return n.makeTensorInfo(i.shape,s.dtype);const p=_9({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),f=_9({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),m=_9({inputs:{x:i},backend:n,attrs:{shape:d}}),g=new qne(l,a,p.shape.length,f.shape.length,c,d,!1,!0),v=n.runWebGLProgram(g,[f,p,m],m.dtype),y=_9({inputs:{x:v},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),y}};class Pre{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let s=0;s<n.length;s++)n[s]=e[s]*t[s];this.outputShape=n,this.rank=n.length;const r=x5(this.rank),i=function(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(1===t)return`imod(resRC, ${e[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<e.length;i++)r.push(`imod(${n[i]}, ${e[i]})`);return r.join()}(e);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        setOutput(getA(${i}));\n      }\n    `}}function zre(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:s}=r;if("string"===i.dtype||i.shape.length>5){const e=n.readSync(i.dataId),t="string"===i.dtype?e.map((e=>gF(e))):e,r=lL(i.shape,i.dtype,t),o=L6(r,s);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const o=new Pre(i.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}const Bre={kernelName:TD,backendName:"webgl",kernelFunc:zre};class Ure{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class Wre{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function Vre(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function jre(e){let t=1;for(;t<e;)t*=2;return t}const Gre={kernelName:ND,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:s,sorted:o}=r,a=C$().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=C$().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=i.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([i])||c<a||s>l){const e=n.readSync(i.dataId),[t,r]=P6(e,u,i.dtype,s,o);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===s)return u[u.length-1]=0,[n.makeTensorInfo(u,i.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(1===c)return[i,See({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const h=n.texData.get(i.dataId),d=null!==h&&h.isPacked,p=d?n.unpackTensor(i):i,f=KR(u)/c,m=_9({inputs:{x:p},attrs:{shape:[f,c]},backend:n});d&&Vre(n,p);const g=jre(s),v=jre(c);let y=null;const b=()=>null===y?[m,m]:[m,y],x=(e,t,r)=>{const i=b(),s=new Ure(r),o=[[c],[null===y?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],a=y;y=n.runWebGLProgram(s,i,"int32",o),Vre(n,a)};for(let C=1;C<g;C*=2){const e=2*C;for(let t=C;t>=1;t/=2)x(e,t,[f,v])}for(let C=v;C>g;C/=2){const e=b(),t=new Wre([f,C/2]),r=[[c],[null===y?1:0],[g]],i=y;y=n.runWebGLProgram(t,e,"int32",r),Vre(n,i);const s=g/2,o=2*s;for(let n=s;n>=1;n/=2)x(o,n,y.shape)}let w=y;y=P8({inputs:{x:y},backend:n,attrs:{begin:0,size:[f,s]}}),Vre(n,w);let k=Wee({inputs:{x:m,indices:y},backend:n,attrs:{axis:1,batchDims:1}});Vre(n,m);const S=u.slice(0,-1);S.push(s),w=y,y=_9({inputs:{x:y},attrs:{shape:S},backend:n}),Vre(n,w);const I=k;return k=_9({inputs:{x:k},attrs:{shape:S},backend:n}),Vre(n,I),[k,y]}};class Hre{constructor(e,t,n,r,i,s){this.variableNames=["Image","Transforms"],this.outputShape=s;const o="nearest"===n?1:2;let a;switch(r){case"constant":default:a=1;break;case"reflect":a=2;break;case"wrap":a=3;break;case"nearest":a=4}this.userCode=`\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(${a} == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${a} == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${a} == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(${i});\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(${i});\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(${t}));\n                float mapY = mapCoord(inY, float(${e}));\n\n                if (${o} == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        `}}const qre={kernelName:AD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:s}=t,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=r,[c,h,d,p]=i.shape,[f,m]=null!=u?u:[h,d],g=new Hre(h,d,o,a,l,[c,f,m,p]);return n.runWebGLProgram(g,[i,s],"float32")}};const Kre={kernelName:$D,backendName:"webgl",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:s}=t;t5(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(s.dataId),{outputValues:a,outputShape:l,indices:u}=B6(o,i,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}};const Xre={kernelName:_D,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i,a=o.shape.length,l=i.shape[s],u=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==s&&(u[c++]=o.shape[m]);const h=[],d=new Array(a).fill(0),p=o.shape.slice();p[s]=1;const f=new Array(l);for(let m=0;m<f.length;m++){d[s]=m;const e=P8({inputs:{x:o},backend:n,attrs:{begin:d,size:p}}),t=_9({inputs:{x:e},backend:n,attrs:{shape:u}});f[m]=t,h.push(e)}return h.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}};class Yre{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,r=e.batchSize,i=e.inSize,s=e.numSegments,o=s*Math.ceil(i/n);this.outputShape=[r,o];const a=4*Math.floor(n/4),l=n%4,u="\n        sumValue += dot(values, segFilter);\n    ";let c="";i%n>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `);let h="";i%n>0&&(h=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${c}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${h}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${s})) * float(${n}));\n        int currentSeg = int(mod(float(outIdx), float(${s})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${a}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${a};\n        if (${1===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${u}\n        } else if (${2===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${u}\n        } else if (${3===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}const Qre=[G9,q9,X9,Q9,e8,r8,i8,s8,h8,d8,f8,g8,y8,x8,k8,C8,E8,A8,R8,$8,D8,B8,U8,W8,V8,K8,Q8,e7,f9,r7,h7,b7,I7,E7,T7,N7,A7,$7,O7,F7,W7,V7,j7,H7,X7,J7,Z7,tee,ree,iee,oee,aee,uee,hee,pee,mee,yee,wee,Iee,Eee,Aee,$ee,Dee,Lee,Pee,Bee,Vee,Gee,qee,d9,Kee,l7,Yee,Jee,ete,v9,nte,ite,ste,ate,ute,hte,pte,mte,yte,xte,kte,Ite,Cte,Ete,Ate,Rte,$te,_te,Ote,Fte,Pte,Bte,Xte,$9,Qte,Zte,tne,rne,G8,sne,lne,une,pne,mne,x9,gne,vne,yne,bne,wne,q8,Vte,Sne,Cne,Tne,O9,Rne,_ne,Fne,Lne,Bne,Wne,jne,Hne,Xne,Qne,Zne,tre,rre,sre,are,ure,z8,Kte,hre,dre,pre,fre,mre,gre,vre,yre,wre,kre,Cre,Ere,Tre,Are,Rre,$re,_re,Hte,U9,Dre,Mre,Lre,Bre,Gre,qre,V9,Kre,Xre,{kernelName:OD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:s}=t,{numSegments:o}=r,a=i.shape.length,l=[];let u=0;const c=Iz([u],a);let h=i;null!=c&&(h=W9({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(h),u=Ez(1,a)[0]);const d=_W(h.shape,u,o),p=KR([h.shape[u]]),f=_9({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}});l.push(f);const m=HF(i.dtype),g=(e,t,r,i,s)=>{const o=e.shape[0],a=e.shape[1],u=$W(a,s),c=new Yre({windowSize:u,inSize:a,batchSize:o,numSegments:s},t),h=n.compileAndRun(c,[e,r],i);if(l.push(h),h.shape[1]===s)return h;const d=xne({backend:n,attrs:{start:0,stop:s,step:1,dtype:"float32"}}),p=zre({inputs:{x:d},backend:n,attrs:{reps:[a/u]}});l.push(d),l.push(p);return g(h,t,p,i,s)},v=_9({inputs:{x:g(f,"unsortedSegmentSum",s,m,o)},backend:n,attrs:{shape:d}});let y=v;if(null!=c){l.push(v);const e=Cz(c);y=W9({inputs:{x:y},backend:n,attrs:{perm:e}})}return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),y}},ane];for(const n of Qre)KD(n);const Jre=(0,a.createContext)();function Zre(){return(0,a.useContext)(Jre)}function eie(e){let{children:t}=e;const[n,r]=(0,a.useState)([]),[i,s]=(0,a.useState)(!0),[o,l]=(0,a.useState)("default"),[u,c]=(0,a.useState)(null),{currentUser:h}=cw();async function d(e){if(!h)return null;try{const t={userId:h.uid,timestamp:Ih.now(),read:!1,...e};return{id:(await Zy(ny(aw,"alerts"),t)).id,...t}}catch(t){return console.error("Error creating alert:",t),null}}(0,a.useEffect)((()=>{h&&async function(){try{if("Notification"in window){const e=await Notification.requestPermission();if(l(e),"granted"===e&&h){const e=await lw();if(e){const t=await async function(e,t){return Jx(e=Yt(e),t)}(e,{vapidKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_VAPID_KEY});c(t),await Zy(ny(aw,"fcmTokens"),{token:t,userId:h.uid,createdAt:Ih.now()})}}}}catch(e){console.error("Error setting up notifications:",e)}}()}),[h]),(0,a.useEffect)((()=>{if(!h)return r([]),void s(!1);const e=function(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof Dy&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof Ly)).length,n=e.filter((e=>e instanceof My)).length;if(t>1||t>0&&n>0)throw new ch(uh.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}(ny(aw,"alerts"),function(e,t,n){const r=t,i=_y("where",e);return My._create(i,r,n)}("userId","==",h.uid),function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=_y("orderBy",e);return Py._create(n,t)}("timestamp","desc"),(Xv("limit",t=20),zy._create("limit",t,"F")));var t;const n=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,o;e=Yt(e);let a={includeMetadataChanges:!1},l=0;"object"!=typeof n[l]||sy(n[l])||(a=n[l],l++);const u={includeMetadataChanges:a.includeMetadataChanges};if(sy(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let c,h,d;if(e instanceof Zv)h=Kv(e.firestore,oy),d=lp(e._key.path),c={next:t=>{n[l]&&n[l](tb(h,e,t))},error:n[l+1],complete:n[l+2]};else{const t=Kv(e,ey);h=Kv(t.firestore,oy),d=t._query;const r=new Qy(h);c={next:e=>{n[l]&&n[l](new Xy(h,r,t,e))},error:n[l+1],complete:n[l+2]},Oy(e._query)}return function(e,t,n,r){const i=new _v(r),s=new rv(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Jg(await Bv(e),s))),()=>{i.Dc(),e.asyncQueue.enqueueAndForget((async()=>Zg(await Bv(e),s)))}}(ay(h),d,u,c)}(e,(e=>{const t=e.docs.map((e=>{var t;return{id:e.id,...e.data(),timestamp:null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate()}}));r(t),s(!1)}),(e=>{console.error("Error fetching notifications:",e),s(!1)}));return n}),[h]);const p={notifications:n,loading:i,permission:o,fcmToken:u,createAlert:d,markAlertAsRead:async function(e){if(!h)return!1;try{return await Zy(ny(aw,`alerts/${e}`),{read:!0}),!0}catch(t){return console.error("Error marking alert as read:",t),!1}},testNotification:async function(){return d({type:"test",severity:"info",title:"Test Notification",message:"This is a test notification to verify that alerts are working correctly."})}};return(0,Me.jsx)(Jre.Provider,{value:p,children:t})}function tie(e){return wt("MuiCircularProgress",e)}kt("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const nie=["className","color","disableShrink","size","style","thickness","value","variant"];let rie,iie,sie,oie,aie=e=>e;const lie=44,uie=(0,cS.i7)(rie||(rie=aie`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),cie=(0,cS.i7)(iie||(iie=aie`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),hie=Yw("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`color${Gw(n.color)}`]]}})((e=>{let{ownerState:t,theme:n}=e;return(0,Ie.A)({display:"inline-block"},"determinate"===t.variant&&{transition:n.transitions.create("transform")},"inherit"!==t.color&&{color:(n.vars||n).palette[t.color].main})}),(e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&(0,cS.AH)(sie||(sie=aie`
      animation: ${0} 1.4s linear infinite;
    `),uie)})),die=Yw("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),pie=Yw("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.circle,t[`circle${Gw(n.variant)}`],n.disableShrink&&t.circleDisableShrink]}})((e=>{let{ownerState:t,theme:n}=e;return(0,Ie.A)({stroke:"currentColor"},"determinate"===t.variant&&{transition:n.transitions.create("stroke-dashoffset")},"indeterminate"===t.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})}),(e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&!t.disableShrink&&(0,cS.AH)(oie||(oie=aie`
      animation: ${0} 1.4s ease-in-out infinite;
    `),cie)})),fie=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiCircularProgress"}),{className:r,color:i="primary",disableShrink:s=!1,size:o=40,style:a,thickness:l=3.6,value:u=0,variant:c="indeterminate"}=n,h=(0,Ce.A)(n,nie),d=(0,Ie.A)({},n,{color:i,disableShrink:s,size:o,thickness:l,value:u,variant:c}),p=(e=>{const{classes:t,variant:n,color:r,disableShrink:i}=e;return Tw({root:["root",n,`color${Gw(r)}`],svg:["svg"],circle:["circle",`circle${Gw(n)}`,i&&"circleDisableShrink"]},tie,t)})(d),f={},m={},g={};if("determinate"===c){const e=2*Math.PI*((lie-l)/2);f.strokeDasharray=e.toFixed(3),g["aria-valuenow"]=Math.round(u),f.strokeDashoffset=`${((100-u)/100*e).toFixed(3)}px`,m.transform="rotate(-90deg)"}return(0,Me.jsx)(hie,(0,Ie.A)({className:Te(p.root,r),style:(0,Ie.A)({width:o,height:o},m,a),ownerState:d,ref:t,role:"progressbar"},g,h,{children:(0,Me.jsx)(die,{className:p.svg,ownerState:d,viewBox:"22 22 44 44",children:(0,Me.jsx)(pie,{className:p.circle,style:f,ownerState:d,cx:lie,cy:lie,r:(lie-l)/2,fill:"none",strokeWidth:l})})}))})),mie=fie;var gie=n(2374);function vie(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function yie(e){return e instanceof vie(e).Element||e instanceof Element}function bie(e){return e instanceof vie(e).HTMLElement||e instanceof HTMLElement}function xie(e){return"undefined"!==typeof ShadowRoot&&(e instanceof vie(e).ShadowRoot||e instanceof ShadowRoot)}var wie=Math.max,kie=Math.min,Sie=Math.round;function Iie(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function Cie(){return!/^((?!chrome|android).)*safari/i.test(Iie())}function Eie(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),i=1,s=1;t&&bie(e)&&(i=e.offsetWidth>0&&Sie(r.width)/e.offsetWidth||1,s=e.offsetHeight>0&&Sie(r.height)/e.offsetHeight||1);var o=(yie(e)?vie(e):window).visualViewport,a=!Cie()&&n,l=(r.left+(a&&o?o.offsetLeft:0))/i,u=(r.top+(a&&o?o.offsetTop:0))/s,c=r.width/i,h=r.height/s;return{width:c,height:h,top:u,right:l+c,bottom:u+h,left:l,x:l,y:u}}function Tie(e){var t=vie(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Nie(e){return e?(e.nodeName||"").toLowerCase():null}function Aie(e){return((yie(e)?e.ownerDocument:e.document)||window.document).documentElement}function Rie(e){return Eie(Aie(e)).left+Tie(e).scrollLeft}function $ie(e){return vie(e).getComputedStyle(e)}function _ie(e){var t=$ie(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function Oie(e,t,n){void 0===n&&(n=!1);var r=bie(t),i=bie(t)&&function(e){var t=e.getBoundingClientRect(),n=Sie(t.width)/e.offsetWidth||1,r=Sie(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),s=Aie(t),o=Eie(e,i,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&(("body"!==Nie(t)||_ie(s))&&(a=function(e){return e!==vie(e)&&bie(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:Tie(e);var t}(t)),bie(t)?((l=Eie(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=Rie(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function Die(e){var t=Eie(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function Fie(e){return"html"===Nie(e)?e:e.assignedSlot||e.parentNode||(xie(e)?e.host:null)||Aie(e)}function Mie(e){return["html","body","#document"].indexOf(Nie(e))>=0?e.ownerDocument.body:bie(e)&&_ie(e)?e:Mie(Fie(e))}function Lie(e,t){var n;void 0===t&&(t=[]);var r=Mie(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),s=vie(r),o=i?[s].concat(s.visualViewport||[],_ie(r)?r:[]):r,a=t.concat(o);return i?a:a.concat(Lie(Fie(o)))}function Pie(e){return["table","td","th"].indexOf(Nie(e))>=0}function zie(e){return bie(e)&&"fixed"!==$ie(e).position?e.offsetParent:null}function Bie(e){for(var t=vie(e),n=zie(e);n&&Pie(n)&&"static"===$ie(n).position;)n=zie(n);return n&&("html"===Nie(n)||"body"===Nie(n)&&"static"===$ie(n).position)?t:n||function(e){var t=/firefox/i.test(Iie());if(/Trident/i.test(Iie())&&bie(e)&&"fixed"===$ie(e).position)return null;var n=Fie(e);for(xie(n)&&(n=n.host);bie(n)&&["html","body"].indexOf(Nie(n))<0;){var r=$ie(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var Uie="top",Wie="bottom",Vie="right",jie="left",Gie="auto",Hie=[Uie,Wie,Vie,jie],qie="start",Kie="end",Xie="viewport",Yie="popper",Qie=Hie.reduce((function(e,t){return e.concat([t+"-"+qie,t+"-"+Kie])}),[]),Jie=[].concat(Hie,[Gie]).reduce((function(e,t){return e.concat([t,t+"-"+qie,t+"-"+Kie])}),[]),Zie=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function ese(e){var t=new Map,n=new Set,r=[];function i(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&i(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||i(e)})),r}function tse(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}var nse={placement:"bottom",modifiers:[],strategy:"absolute"};function rse(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"===typeof e.getBoundingClientRect)}))}function ise(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,i=t.defaultOptions,s=void 0===i?nse:i;return function(e,t,n){void 0===n&&(n=s);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},nse,s),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},o=[],a=!1,l={state:i,setOptions:function(n){var a="function"===typeof n?n(i.options):n;u(),i.options=Object.assign({},s,i.options,a),i.scrollParents={reference:yie(e)?Lie(e):e.contextElement?Lie(e.contextElement):[],popper:Lie(t)};var c=function(e){var t=ese(e);return Zie.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,i.options.modifiers)));return i.orderedModifiers=c.filter((function(e){return e.enabled})),i.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,s=e.effect;if("function"===typeof s){var a=s({state:i,name:t,instance:l,options:r}),u=function(){};o.push(a||u)}})),l.update()},forceUpdate:function(){if(!a){var e=i.elements,t=e.reference,n=e.popper;if(rse(t,n)){i.rects={reference:Oie(t,Bie(n),"fixed"===i.options.strategy),popper:Die(n)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach((function(e){return i.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<i.orderedModifiers.length;r++)if(!0!==i.reset){var s=i.orderedModifiers[r],o=s.fn,u=s.options,c=void 0===u?{}:u,h=s.name;"function"===typeof o&&(i=o({state:i,options:c,name:h,instance:l})||i)}else i.reset=!1,r=-1}}},update:tse((function(){return new Promise((function(e){l.forceUpdate(),e(i)}))})),destroy:function(){u(),a=!0}};if(!rse(e,t))return l;function u(){o.forEach((function(e){return e()})),o=[]}return l.setOptions(n).then((function(e){!a&&n.onFirstUpdate&&n.onFirstUpdate(e)})),l}}var sse={passive:!0};function ose(e){return e.split("-")[0]}function ase(e){return e.split("-")[1]}function lse(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function use(e){var t,n=e.reference,r=e.element,i=e.placement,s=i?ose(i):null,o=i?ase(i):null,a=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2;switch(s){case Uie:t={x:a,y:n.y-r.height};break;case Wie:t={x:a,y:n.y+n.height};break;case Vie:t={x:n.x+n.width,y:l};break;case jie:t={x:n.x-r.width,y:l};break;default:t={x:n.x,y:n.y}}var u=s?lse(s):null;if(null!=u){var c="y"===u?"height":"width";switch(o){case qie:t[u]=t[u]-(n[c]/2-r[c]/2);break;case Kie:t[u]=t[u]+(n[c]/2-r[c]/2)}}return t}var cse={top:"auto",right:"auto",bottom:"auto",left:"auto"};function hse(e){var t,n=e.popper,r=e.popperRect,i=e.placement,s=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,u=e.adaptive,c=e.roundOffsets,h=e.isFixed,d=o.x,p=void 0===d?0:d,f=o.y,m=void 0===f?0:f,g="function"===typeof c?c({x:p,y:m}):{x:p,y:m};p=g.x,m=g.y;var v=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),b=jie,x=Uie,w=window;if(u){var k=Bie(n),S="clientHeight",I="clientWidth";if(k===vie(n)&&"static"!==$ie(k=Aie(n)).position&&"absolute"===a&&(S="scrollHeight",I="scrollWidth"),i===Uie||(i===jie||i===Vie)&&s===Kie)x=Wie,m-=(h&&k===w&&w.visualViewport?w.visualViewport.height:k[S])-r.height,m*=l?1:-1;if(i===jie||(i===Uie||i===Wie)&&s===Kie)b=Vie,p-=(h&&k===w&&w.visualViewport?w.visualViewport.width:k[I])-r.width,p*=l?1:-1}var C,E=Object.assign({position:a},u&&cse),T=!0===c?function(e,t){var n=e.x,r=e.y,i=t.devicePixelRatio||1;return{x:Sie(n*i)/i||0,y:Sie(r*i)/i||0}}({x:p,y:m},vie(n)):{x:p,y:m};return p=T.x,m=T.y,l?Object.assign({},E,((C={})[x]=y?"0":"",C[b]=v?"0":"",C.transform=(w.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",C)):Object.assign({},E,((t={})[x]=y?m+"px":"",t[b]=v?p+"px":"",t.transform="",t))}var dse={left:"right",right:"left",bottom:"top",top:"bottom"};function pse(e){return e.replace(/left|right|bottom|top/g,(function(e){return dse[e]}))}var fse={start:"end",end:"start"};function mse(e){return e.replace(/start|end/g,(function(e){return fse[e]}))}function gse(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&xie(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function vse(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function yse(e,t,n){return t===Xie?vse(function(e,t){var n=vie(e),r=Aie(e),i=n.visualViewport,s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;var u=Cie();(u||!u&&"fixed"===t)&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a+Rie(e),y:l}}(e,n)):yie(t)?function(e,t){var n=Eie(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):vse(function(e){var t,n=Aie(e),r=Tie(e),i=null==(t=e.ownerDocument)?void 0:t.body,s=wie(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=wie(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+Rie(e),l=-r.scrollTop;return"rtl"===$ie(i||n).direction&&(a+=wie(n.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(Aie(e)))}function bse(e,t,n,r){var i="clippingParents"===t?function(e){var t=Lie(Fie(e)),n=["absolute","fixed"].indexOf($ie(e).position)>=0&&bie(e)?Bie(e):e;return yie(n)?t.filter((function(e){return yie(e)&&gse(e,n)&&"body"!==Nie(e)})):[]}(e):[].concat(t),s=[].concat(i,[n]),o=s[0],a=s.reduce((function(t,n){var i=yse(e,n,r);return t.top=wie(i.top,t.top),t.right=kie(i.right,t.right),t.bottom=kie(i.bottom,t.bottom),t.left=wie(i.left,t.left),t}),yse(e,o,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function xse(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function wse(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function kse(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=void 0===r?e.placement:r,s=n.strategy,o=void 0===s?e.strategy:s,a=n.boundary,l=void 0===a?"clippingParents":a,u=n.rootBoundary,c=void 0===u?Xie:u,h=n.elementContext,d=void 0===h?Yie:h,p=n.altBoundary,f=void 0!==p&&p,m=n.padding,g=void 0===m?0:m,v=xse("number"!==typeof g?g:wse(g,Hie)),y=d===Yie?"reference":Yie,b=e.rects.popper,x=e.elements[f?y:d],w=bse(yie(x)?x:x.contextElement||Aie(e.elements.popper),l,c,o),k=Eie(e.elements.reference),S=use({reference:k,element:b,strategy:"absolute",placement:i}),I=vse(Object.assign({},b,S)),C=d===Yie?I:k,E={top:w.top-C.top+v.top,bottom:C.bottom-w.bottom+v.bottom,left:w.left-C.left+v.left,right:C.right-w.right+v.right},T=e.modifiersData.offset;if(d===Yie&&T){var N=T[i];Object.keys(E).forEach((function(e){var t=[Vie,Wie].indexOf(e)>=0?1:-1,n=[Uie,Wie].indexOf(e)>=0?"y":"x";E[e]+=N[n]*t}))}return E}const Sse={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,s=void 0===i||i,o=n.altAxis,a=void 0===o||o,l=n.fallbackPlacements,u=n.padding,c=n.boundary,h=n.rootBoundary,d=n.altBoundary,p=n.flipVariations,f=void 0===p||p,m=n.allowedAutoPlacements,g=t.options.placement,v=ose(g),y=l||(v===g||!f?[pse(g)]:function(e){if(ose(e)===Gie)return[];var t=pse(e);return[mse(e),t,mse(t)]}(g)),b=[g].concat(y).reduce((function(e,n){return e.concat(ose(n)===Gie?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=n.boundary,s=n.rootBoundary,o=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,u=void 0===l?Jie:l,c=ase(r),h=c?a?Qie:Qie.filter((function(e){return ase(e)===c})):Hie,d=h.filter((function(e){return u.indexOf(e)>=0}));0===d.length&&(d=h);var p=d.reduce((function(t,n){return t[n]=kse(e,{placement:n,boundary:i,rootBoundary:s,padding:o})[ose(n)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:n,boundary:c,rootBoundary:h,padding:u,flipVariations:f,allowedAutoPlacements:m}):n)}),[]),x=t.rects.reference,w=t.rects.popper,k=new Map,S=!0,I=b[0],C=0;C<b.length;C++){var E=b[C],T=ose(E),N=ase(E)===qie,A=[Uie,Wie].indexOf(T)>=0,R=A?"width":"height",$=kse(t,{placement:E,boundary:c,rootBoundary:h,altBoundary:d,padding:u}),_=A?N?Vie:jie:N?Wie:Uie;x[R]>w[R]&&(_=pse(_));var O=pse(_),D=[];if(s&&D.push($[T]<=0),a&&D.push($[_]<=0,$[O]<=0),D.every((function(e){return e}))){I=E,S=!1;break}k.set(E,D)}if(S)for(var F=function(e){var t=b.find((function(t){var n=k.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return I=t,"break"},M=f?3:1;M>0;M--){if("break"===F(M))break}t.placement!==I&&(t.modifiersData[r]._skip=!0,t.placement=I,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Ise(e,t,n){return wie(e,kie(t,n))}function Cse(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function Ese(e){return[Uie,Vie,Wie,jie].some((function(t){return e[t]>=0}))}var Tse=ise({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,s=void 0===i||i,o=r.resize,a=void 0===o||o,l=vie(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&u.forEach((function(e){e.addEventListener("scroll",n.update,sse)})),a&&l.addEventListener("resize",n.update,sse),function(){s&&u.forEach((function(e){e.removeEventListener("scroll",n.update,sse)})),a&&l.removeEventListener("resize",n.update,sse)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=use({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=void 0===r||r,s=n.adaptive,o=void 0===s||s,a=n.roundOffsets,l=void 0===a||a,u={placement:ose(t.placement),variation:ase(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,hse(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,hse(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},i=t.elements[e];bie(i)&&Nie(i)&&(Object.assign(i.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],i=t.attributes[e]||{},s=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});bie(r)&&Nie(r)&&(Object.assign(r.style,s),Object.keys(i).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]},{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.offset,s=void 0===i?[0,0]:i,o=Jie.reduce((function(e,n){return e[n]=function(e,t,n){var r=ose(e),i=[jie,Uie].indexOf(r)>=0?-1:1,s="function"===typeof n?n(Object.assign({},t,{placement:e})):n,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[jie,Vie].indexOf(r)>=0?{x:a,y:o}:{x:o,y:a}}(n,t.rects,s),e}),{}),a=o[t.placement],l=a.x,u=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=u),t.modifiersData[r]=o}},Sse,{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,s=void 0===i||i,o=n.altAxis,a=void 0!==o&&o,l=n.boundary,u=n.rootBoundary,c=n.altBoundary,h=n.padding,d=n.tether,p=void 0===d||d,f=n.tetherOffset,m=void 0===f?0:f,g=kse(t,{boundary:l,rootBoundary:u,padding:h,altBoundary:c}),v=ose(t.placement),y=ase(t.placement),b=!y,x=lse(v),w="x"===x?"y":"x",k=t.modifiersData.popperOffsets,S=t.rects.reference,I=t.rects.popper,C="function"===typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,E="number"===typeof C?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),T=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,N={x:0,y:0};if(k){if(s){var A,R="y"===x?Uie:jie,$="y"===x?Wie:Vie,_="y"===x?"height":"width",O=k[x],D=O+g[R],F=O-g[$],M=p?-I[_]/2:0,L=y===qie?S[_]:I[_],P=y===qie?-I[_]:-S[_],z=t.elements.arrow,B=p&&z?Die(z):{width:0,height:0},U=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},W=U[R],V=U[$],j=Ise(0,S[_],B[_]),G=b?S[_]/2-M-j-W-E.mainAxis:L-j-W-E.mainAxis,H=b?-S[_]/2+M+j+V+E.mainAxis:P+j+V+E.mainAxis,q=t.elements.arrow&&Bie(t.elements.arrow),K=q?"y"===x?q.clientTop||0:q.clientLeft||0:0,X=null!=(A=null==T?void 0:T[x])?A:0,Y=O+H-X,Q=Ise(p?kie(D,O+G-X-K):D,O,p?wie(F,Y):F);k[x]=Q,N[x]=Q-O}if(a){var J,Z="x"===x?Uie:jie,ee="x"===x?Wie:Vie,te=k[w],ne="y"===w?"height":"width",re=te+g[Z],ie=te-g[ee],se=-1!==[Uie,jie].indexOf(v),oe=null!=(J=null==T?void 0:T[w])?J:0,ae=se?re:te-S[ne]-I[ne]-oe+E.altAxis,le=se?te+S[ne]+I[ne]-oe-E.altAxis:ie,ue=p&&se?function(e,t,n){var r=Ise(e,t,n);return r>n?n:r}(ae,te,le):Ise(p?ae:re,te,p?le:ie);k[w]=ue,N[w]=ue-te}t.modifiersData[r]=N}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,i=e.options,s=n.elements.arrow,o=n.modifiersData.popperOffsets,a=ose(n.placement),l=lse(a),u=[jie,Vie].indexOf(a)>=0?"height":"width";if(s&&o){var c=function(e,t){return xse("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:wse(e,Hie))}(i.padding,n),h=Die(s),d="y"===l?Uie:jie,p="y"===l?Wie:Vie,f=n.rects.reference[u]+n.rects.reference[l]-o[l]-n.rects.popper[u],m=o[l]-n.rects.reference[l],g=Bie(s),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=f/2-m/2,b=c[d],x=v-h[u]-c[p],w=v/2-h[u]/2+y,k=Ise(b,w,x),S=l;n.modifiersData[r]=((t={})[S]=k,t.centerOffset=k-w,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!==typeof r||(r=t.elements.popper.querySelector(r)))&&gse(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,s=t.modifiersData.preventOverflow,o=kse(t,{elementContext:"reference"}),a=kse(t,{altBoundary:!0}),l=Cse(o,r),u=Cse(a,i,s),c=Ese(l),h=Ese(u);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":h})}}]});function Nse(e){return wt("MuiPopper",e)}kt("MuiPopper",["root"]);const Ase=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],Rse=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function $se(e){return"function"===typeof e?e():e}function _se(e){return void 0!==e.nodeType}const Ose={},Dse=a.forwardRef((function(e,t){var n;const{anchorEl:r,children:i,direction:s,disablePortal:o,modifiers:l,open:u,placement:c,popperOptions:h,popperRef:d,slotProps:p={},slots:f={},TransitionProps:m}=e,g=(0,Ce.A)(e,Ase),v=a.useRef(null),y=Ik(v,t),b=a.useRef(null),x=Ik(b,d),w=a.useRef(x);Pk((()=>{w.current=x}),[x]),a.useImperativeHandle(d,(()=>b.current),[]);const k=function(e,t){if("ltr"===t)return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(c,s),[S,I]=a.useState(k),[C,E]=a.useState($se(r));a.useEffect((()=>{b.current&&b.current.forceUpdate()})),a.useEffect((()=>{r&&E($se(r))}),[r]),Pk((()=>{if(!C||!u)return;let e=[{name:"preventOverflow",options:{altBoundary:o}},{name:"flip",options:{altBoundary:o}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:e=>{let{state:t}=e;I(t.placement)}}];null!=l&&(e=e.concat(l)),h&&null!=h.modifiers&&(e=e.concat(h.modifiers));const t=Tse(C,v.current,(0,Ie.A)({placement:k},h,{modifiers:e}));return w.current(t),()=>{t.destroy(),w.current(null)}}),[C,o,l,u,h,k]);const T={placement:S};null!==m&&(T.TransitionProps=m);const N=(e=>{const{classes:t}=e;return Tw({root:["root"]},Nse,t)})(e),A=null!=(n=f.root)?n:"div",R=$C({elementType:A,externalSlotProps:p.root,externalForwardedProps:g,additionalProps:{role:"tooltip",ref:y},ownerState:e,className:N.root});return(0,Me.jsx)(A,(0,Ie.A)({},R,{children:"function"===typeof i?i(T):i}))})),Fse=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],Mse=Yw(a.forwardRef((function(e,t){const{anchorEl:n,children:r,container:i,direction:s="ltr",disablePortal:o=!1,keepMounted:l=!1,modifiers:u,open:c,placement:h="bottom",popperOptions:d=Ose,popperRef:p,style:f,transition:m=!1,slotProps:g={},slots:v={}}=e,y=(0,Ce.A)(e,Rse),[b,x]=a.useState(!0);if(!l&&!c&&(!m||b))return null;let w;if(i)w=i;else if(n){const e=$se(n);w=e&&_se(e)?rI(e).body:rI(null).body}const k=c||!l||m&&!b?void 0:"none",S=m?{in:c,onEnter:()=>{x(!1)},onExited:()=>{x(!0)}}:void 0;return(0,Me.jsx)(gE,{disablePortal:o,container:w,children:(0,Me.jsx)(Dse,(0,Ie.A)({anchorEl:n,direction:s,disablePortal:o,modifiers:u,ref:t,open:m?!b:c,placement:h,popperOptions:d,popperRef:p,slotProps:g,slots:v},y,{style:(0,Ie.A)({position:"fixed",top:0,left:0,display:k},f),TransitionProps:S,children:r}))})})),{name:"MuiPopper",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Lse=a.forwardRef((function(e,t){var n;const r=(0,gie.A)(),i=ek({props:e,name:"MuiPopper"}),{anchorEl:s,component:o,components:a,componentsProps:l,container:u,disablePortal:c,keepMounted:h,modifiers:d,open:p,placement:f,popperOptions:m,popperRef:g,transition:v,slots:y,slotProps:b}=i,x=(0,Ce.A)(i,Fse),w=null!=(n=null==y?void 0:y.root)?n:null==a?void 0:a.Root,k=(0,Ie.A)({anchorEl:s,container:u,disablePortal:c,keepMounted:h,modifiers:d,open:p,placement:f,popperOptions:m,popperRef:g,transition:v},x);return(0,Me.jsx)(Mse,(0,Ie.A)({as:o,direction:null==r?void 0:r.direction,slots:{root:w},slotProps:null!=b?b:l},k,{ref:t}))})),Pse=nI;function zse(e){return wt("MuiTooltip",e)}const Bse=kt("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),Use=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];const Wse=Yw(Lse,{name:"MuiTooltip",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.popper,!n.disableInteractive&&t.popperInteractive,n.arrow&&t.popperArrow,!n.open&&t.popperClose]}})((e=>{let{theme:t,ownerState:n,open:r}=e;return(0,Ie.A)({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none"},!n.disableInteractive&&{pointerEvents:"auto"},!r&&{pointerEvents:"none"},n.arrow&&{[`&[data-popper-placement*="bottom"] .${Bse.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Bse.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Bse.arrow}`]:(0,Ie.A)({},n.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${Bse.arrow}`]:(0,Ie.A)({},n.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})})),Vse=Yw("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.tooltip,n.touch&&t.touch,n.arrow&&t.tooltipArrow,t[`tooltipPlacement${Gw(n.placement.split("-")[0])}`]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:(0,Ve.X4)(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium},n.arrow&&{position:"relative",margin:0},n.touch&&{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:(r=16/14,Math.round(1e5*r)/1e5)+"em",fontWeight:t.typography.fontWeightRegular},{[`.${Bse.popper}[data-popper-placement*="left"] &`]:(0,Ie.A)({transformOrigin:"right center"},n.isRtl?(0,Ie.A)({marginLeft:"14px"},n.touch&&{marginLeft:"24px"}):(0,Ie.A)({marginRight:"14px"},n.touch&&{marginRight:"24px"})),[`.${Bse.popper}[data-popper-placement*="right"] &`]:(0,Ie.A)({transformOrigin:"left center"},n.isRtl?(0,Ie.A)({marginRight:"14px"},n.touch&&{marginRight:"24px"}):(0,Ie.A)({marginLeft:"14px"},n.touch&&{marginLeft:"24px"})),[`.${Bse.popper}[data-popper-placement*="top"] &`]:(0,Ie.A)({transformOrigin:"center bottom",marginBottom:"14px"},n.touch&&{marginBottom:"24px"}),[`.${Bse.popper}[data-popper-placement*="bottom"] &`]:(0,Ie.A)({transformOrigin:"center top",marginTop:"14px"},n.touch&&{marginTop:"24px"})});var r})),jse=Yw("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(e,t)=>t.arrow})((e=>{let{theme:t}=e;return{overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:(0,Ve.X4)(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}}));let Gse=!1;const Hse=new Vk;let qse={x:0,y:0};function Kse(e,t){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];t&&t(n,...i),e(n,...i)}}const Xse=a.forwardRef((function(e,t){var n,r,i,s,o,l,u,c,h,d,p,f,m,g,v,y,b,x,w;const k=ek({props:e,name:"MuiTooltip"}),{arrow:S=!1,children:I,components:C={},componentsProps:E={},describeChild:T=!1,disableFocusListener:N=!1,disableHoverListener:A=!1,disableInteractive:R=!1,disableTouchListener:$=!1,enterDelay:_=100,enterNextDelay:O=0,enterTouchDelay:D=700,followCursor:F=!1,id:M,leaveDelay:L=0,leaveTouchDelay:P=1500,onClose:z,onOpen:B,open:U,placement:W="bottom",PopperComponent:V,PopperProps:j={},slotProps:G={},slots:H={},title:q,TransitionComponent:K=hE,TransitionProps:X}=k,Y=(0,Ce.A)(k,Use),Q=a.isValidElement(I)?I:(0,Me.jsx)("span",{children:I}),J=rE(),Z=NC(),[ee,te]=a.useState(),[ne,re]=a.useState(null),ie=a.useRef(!1),se=R||F,oe=jk(),ae=jk(),le=jk(),ue=jk(),[ce,he]=mT({controlled:U,default:!1,name:"Tooltip",state:"open"});let de=ce;const pe=Pse(M),fe=a.useRef(),me=Bk((()=>{void 0!==fe.current&&(document.body.style.WebkitUserSelect=fe.current,fe.current=void 0),ue.clear()}));a.useEffect((()=>me),[me]);const ge=e=>{Hse.clear(),Gse=!0,he(!0),B&&!de&&B(e)},ve=Bk((e=>{Hse.start(800+L,(()=>{Gse=!1})),he(!1),z&&de&&z(e),oe.start(J.transitions.duration.shortest,(()=>{ie.current=!1}))})),ye=e=>{ie.current&&"touchstart"!==e.type||(ee&&ee.removeAttribute("title"),ae.clear(),le.clear(),_||Gse&&O?ae.start(Gse?O:_,(()=>{ge(e)})):ge(e))},be=e=>{ae.clear(),le.start(L,(()=>{ve(e)}))},{isFocusVisibleRef:xe,onBlur:we,onFocus:ke,ref:Se}=eS(),[,Ee]=a.useState(!1),Ne=e=>{we(e),!1===xe.current&&(Ee(!1),be(e))},Ae=e=>{ee||te(e.currentTarget),ke(e),!0===xe.current&&(Ee(!0),ye(e))},Re=e=>{ie.current=!0;const t=Q.props;t.onTouchStart&&t.onTouchStart(e)},$e=e=>{Re(e),le.clear(),oe.clear(),me(),fe.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",ue.start(D,(()=>{document.body.style.WebkitUserSelect=fe.current,ye(e)}))},_e=e=>{Q.props.onTouchEnd&&Q.props.onTouchEnd(e),me(),le.start(P,(()=>{ve(e)}))};a.useEffect((()=>{if(de)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){"Escape"!==e.key&&"Esc"!==e.key||ve(e)}}),[ve,de]);const Oe=Lk(IC(Q),Se,te,t);q||0===q||(de=!1);const De=a.useRef(),Fe={},Le="string"===typeof q;T?(Fe.title=de||!Le||A?null:q,Fe["aria-describedby"]=de?pe:null):(Fe["aria-label"]=Le?q:null,Fe["aria-labelledby"]=de&&!Le?pe:null);const Pe=(0,Ie.A)({},Fe,Y,Q.props,{className:Te(Y.className,Q.props.className),onTouchStart:Re,ref:Oe},F?{onMouseMove:e=>{const t=Q.props;t.onMouseMove&&t.onMouseMove(e),qse={x:e.clientX,y:e.clientY},De.current&&De.current.update()}}:{});const ze={};$||(Pe.onTouchStart=$e,Pe.onTouchEnd=_e),A||(Pe.onMouseOver=Kse(ye,Pe.onMouseOver),Pe.onMouseLeave=Kse(be,Pe.onMouseLeave),se||(ze.onMouseOver=ye,ze.onMouseLeave=be)),N||(Pe.onFocus=Kse(Ae,Pe.onFocus),Pe.onBlur=Kse(Ne,Pe.onBlur),se||(ze.onFocus=Ae,ze.onBlur=Ne));const Be=a.useMemo((()=>{var e;let t=[{name:"arrow",enabled:Boolean(ne),options:{element:ne,padding:4}}];return null!=(e=j.popperOptions)&&e.modifiers&&(t=t.concat(j.popperOptions.modifiers)),(0,Ie.A)({},j.popperOptions,{modifiers:t})}),[ne,j]),Ue=(0,Ie.A)({},k,{isRtl:Z,arrow:S,disableInteractive:se,placement:W,PopperComponentProp:V,touch:ie.current}),We=(e=>{const{classes:t,disableInteractive:n,arrow:r,touch:i,placement:s}=e;return Tw({popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",i&&"touch",`tooltipPlacement${Gw(s.split("-")[0])}`],arrow:["arrow"]},zse,t)})(Ue),Ve=null!=(n=null!=(r=H.popper)?r:C.Popper)?n:Wse,je=null!=(i=null!=(s=null!=(o=H.transition)?o:C.Transition)?s:K)?i:hE,Ge=null!=(l=null!=(u=H.tooltip)?u:C.Tooltip)?l:Vse,He=null!=(c=null!=(h=H.arrow)?h:C.Arrow)?c:jse,qe=Ek(Ve,(0,Ie.A)({},j,null!=(d=G.popper)?d:E.popper,{className:Te(We.popper,null==j?void 0:j.className,null==(p=null!=(f=G.popper)?f:E.popper)?void 0:p.className)}),Ue),Ke=Ek(je,(0,Ie.A)({},X,null!=(m=G.transition)?m:E.transition),Ue),Xe=Ek(Ge,(0,Ie.A)({},null!=(g=G.tooltip)?g:E.tooltip,{className:Te(We.tooltip,null==(v=null!=(y=G.tooltip)?y:E.tooltip)?void 0:v.className)}),Ue),Ye=Ek(He,(0,Ie.A)({},null!=(b=G.arrow)?b:E.arrow,{className:Te(We.arrow,null==(x=null!=(w=G.arrow)?w:E.arrow)?void 0:x.className)}),Ue);return(0,Me.jsxs)(a.Fragment,{children:[a.cloneElement(Q,Pe),(0,Me.jsx)(Ve,(0,Ie.A)({as:null!=V?V:Lse,placement:W,anchorEl:F?{getBoundingClientRect:()=>({top:qse.y,left:qse.x,right:qse.x,bottom:qse.y,width:0,height:0})}:ee,popperRef:De,open:!!ee&&de,id:pe,transition:!0},ze,qe,{popperOptions:Be,children:e=>{let{TransitionProps:t}=e;return(0,Me.jsx)(je,(0,Ie.A)({timeout:J.transitions.duration.shorter},t,Ke,{children:(0,Me.jsxs)(Ge,(0,Ie.A)({},Xe,{children:[q,S?(0,Me.jsx)(He,(0,Ie.A)({},Ye,{ref:re})):null]}))}))}}))]})})),Yse=BS((0,Me.jsx)("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"}),"Pause"),Qse=BS((0,Me.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),Jse=BS((0,Me.jsx)("path",{d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"}),"Fullscreen"),Zse=e=>{let{isStreaming:t,toggleStreaming:n,isProcessing:r}=e;return(0,Me.jsxs)(Ct,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2},children:[(0,Me.jsx)(AN,{variant:t?"outlined":"contained",color:t?"error":"primary",startIcon:t?(0,Me.jsx)(Yse,{}):(0,Me.jsx)(Qse,{}),onClick:n,children:t?"Stop Streaming":"Start Streaming"}),(0,Me.jsx)(YT,{direction:"row",spacing:1,children:r&&(0,Me.jsxs)(Ct,{sx:{display:"flex",alignItems:"center"},children:[(0,Me.jsx)(mie,{size:24,sx:{mr:1}}),"Analyzing..."]})}),(0,Me.jsxs)(YT,{direction:"row",spacing:1,children:[(0,Me.jsx)(Xse,{title:"Video Settings",children:(0,Me.jsx)(AN,{size:"small",variant:"outlined",color:"primary",startIcon:(0,Me.jsx)(FR,{}),children:"Video Settings"})}),(0,Me.jsx)(Xse,{title:"Fullscreen",children:(0,Me.jsx)(AN,{size:"small",variant:"outlined",color:"primary",startIcon:(0,Me.jsx)(Jse,{}),children:"Fullscreen"})})]})]})},eoe=BS((0,Me.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error"),toe=e=>{let{status:t}=e,n=null,r="",i="";switch(t){case"normal":n=(0,Me.jsx)(OR,{}),r="Normal Activity",i="success.main";break;case"warning":n=(0,Me.jsx)(DR,{}),r="Unusual Movement Detected",i="warning.main";break;case"alert":n=(0,Me.jsx)(eoe,{}),r="Potential Emergency",i="error.main";break;default:n=(0,Me.jsx)(OR,{}),r="Status Normal",i="success.main"}return(0,Me.jsx)(Xse,{title:r,children:(0,Me.jsxs)(Ct,{sx:{display:"flex",alignItems:"center"},children:[(0,Me.jsx)(Ct,{sx:{color:i,mr:1,display:"flex"},children:n}),(0,Me.jsx)(lk,{variant:"body2",color:i,children:r})]})})};let noe=null;function roe(){const e=(0,a.useRef)(null),t=(0,a.useRef)(null),[n,r]=(0,a.useState)(!1),[i,s]=(0,a.useState)(!1),[o,l]=(0,a.useState)(!1),[u,c]=(0,a.useState)("normal"),[h,d]=(0,a.useState)(50),[p,f]=(0,a.useState)([]),[m,g]=(0,a.useState)({detectionFrequency:500,motionThreshold:.3,fallThreshold:.7,enableFallDetection:!0,enableMotionTracking:!0}),[v,y]=(0,a.useState)(null),{userProfile:b}=cw(),{createAlert:x}=Zre();(0,a.useEffect)((()=>(async function(){try{noe||(await new Promise((e=>setTimeout(e,2e3))),console.log("Model loaded successfully"),noe={loaded:!0,detect:async e=>[{score:Math.random(),keypoints:[{position:{x:640*Math.random(),y:480*Math.random()},score:Math.random()},{position:{x:640*Math.random(),y:480*Math.random()},score:Math.random()}]}]},s(!0))}catch(v){console.error("Error loading ML models:",v),y("Failed to load detection models. Please refresh the page.")}}(),()=>{l(!1)})),[]),(0,a.useEffect)((()=>{let e=null;return n&&i&&m.enableMotionTracking?(l(!0),e=setInterval((()=>{w()}),m.detectionFrequency)):l(!1),()=>{e&&clearInterval(e)}}),[n,i,m]);const w=async()=>{if(e.current&&e.current.video&&4===e.current.video.readyState&&noe){e.current.video;try{const e=Math.random();f((t=>{const n=[...t,e];return n.length>20?n.slice(n.length-20):n}));const n=.7-.4*(h/100);if(e>.9&&m.enableFallDetection?(c("alert"),x({type:"fall_detected",severity:"critical",title:"Fall Detected",message:"Potential fall detected in the monitoring area. Please check immediately."})):c(e>n?"warning":"normal"),t.current){t.current.getContext("2d")}}catch(v){console.error("Error in motion detection:",v)}}},k=(e,t)=>{g((n=>({...n,[e]:t})))};return(0,Me.jsx)(tk,{maxWidth:"xl",children:(0,Me.jsxs)(Ct,{sx:{mt:4,mb:4},children:[v&&(0,Me.jsx)(ZS,{severity:"error",sx:{mb:3},children:v}),(0,Me.jsx)(lk,{variant:"h4",component:"h1",gutterBottom:!0,children:"Patient Monitoring Dashboard"}),(0,Me.jsxs)(kA,{container:!0,spacing:3,children:[(0,Me.jsx)(kA,{item:!0,xs:12,md:8,children:(0,Me.jsxs)(fk,{elevation:2,sx:{p:2},children:[(0,Me.jsxs)(Ct,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Me.jsx)(lk,{variant:"h6",children:"Live Video Feed"}),(0,Me.jsx)(toe,{status:u})]}),(0,Me.jsx)(BA,{sx:{mb:2}}),(0,Me.jsxs)(Ct,{className:"video-container",sx:{position:"relative"},children:[n?(0,Me.jsx)(LR(),{ref:e,audio:!1,width:"100%",height:400,screenshotFormat:"image/jpeg",videoConstraints:{facingMode:"user"},style:{borderRadius:8}}):(0,Me.jsx)(Ct,{sx:{height:400,backgroundColor:"#000",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:1},children:(0,Me.jsx)(lk,{variant:"body1",color:"white",children:"Click Start Streaming to begin monitoring"})}),(0,Me.jsx)("canvas",{ref:t,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1}}),(0,Me.jsx)("div",{className:`status-indicator status-${u}`})]}),(0,Me.jsx)(Zse,{isStreaming:n,toggleStreaming:()=>{r((e=>!e))},isProcessing:o})]})}),(0,Me.jsx)(kA,{item:!0,xs:12,md:4,children:(0,Me.jsxs)(kA,{container:!0,spacing:3,direction:"column",children:[(0,Me.jsx)(kA,{item:!0,children:(0,Me.jsx)(yk,{children:(0,Me.jsxs)(kk,{children:[(0,Me.jsx)(lk,{variant:"h6",gutterBottom:!0,children:"Monitoring Status"}),(0,Me.jsxs)(Ct,{sx:{display:"flex",alignItems:"center",mt:2},children:["normal"===u?(0,Me.jsx)(OR,{sx:{color:"success.main",mr:1}}):"warning"===u?(0,Me.jsx)(DR,{sx:{color:"warning.main",mr:1}}):(0,Me.jsx)(DR,{sx:{color:"error.main",mr:1}}),(0,Me.jsx)(lk,{variant:"body1",children:"normal"===u?"Normal Activity":"warning"===u?"Unusual Movement Detected":"Potential Fall Detected"})]}),(0,Me.jsxs)(Ct,{sx:{mt:2},children:[(0,Me.jsxs)(lk,{variant:"body2",gutterBottom:!0,children:["ML Analysis: ",o?"Active":"Inactive"]}),(0,Me.jsx)(XA,{label:n?"Streaming":"Offline",color:n?"success":"default",size:"small",sx:{mr:1}}),(0,Me.jsx)(XA,{label:i?"Model Loaded":"Loading Model",color:i?"primary":"warning",size:"small"})]})]})})}),(0,Me.jsx)(kA,{item:!0,children:(0,Me.jsx)(yk,{children:(0,Me.jsxs)(kk,{children:[(0,Me.jsxs)(Ct,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Me.jsx)(lk,{variant:"h6",gutterBottom:!0,children:"Detection Settings"}),(0,Me.jsx)(FR,{})]}),(0,Me.jsx)(lk,{variant:"body2",gutterBottom:!0,children:"Adjust sensitivity for motion detection alerts"}),(0,Me.jsxs)(Ct,{sx:{mt:3},children:[(0,Me.jsxs)(lk,{id:"sensitivity-slider",gutterBottom:!0,children:["Alert Sensitivity: ",h,"%"]}),(0,Me.jsx)(IR,{value:h,onChange:(e,t)=>{d(t)},"aria-labelledby":"sensitivity-slider",valueLabelDisplay:"auto",step:5,marks:!0,min:0,max:100})]}),(0,Me.jsx)(Ct,{sx:{mt:3},children:(0,Me.jsx)(nN,{control:(0,Me.jsx)(_R,{checked:m.enableFallDetection,onChange:e=>k("enableFallDetection",e.target.checked),color:"primary"}),label:"Fall Detection"})}),(0,Me.jsx)(Ct,{sx:{mt:1},children:(0,Me.jsx)(nN,{control:(0,Me.jsx)(_R,{checked:m.enableMotionTracking,onChange:e=>k("enableMotionTracking",e.target.checked),color:"primary"}),label:"Motion Analysis"})})]})})}),(0,Me.jsx)(kA,{item:!0,children:(0,Me.jsx)(yk,{children:(0,Me.jsxs)(kk,{children:[(0,Me.jsx)(lk,{variant:"h6",gutterBottom:!0,children:"Patient Information"}),(0,Me.jsx)(lk,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"This is a demonstration of the live monitoring interface. In a real implementation, this section would display patient information and context."}),(0,Me.jsx)(AN,{variant:"outlined",size:"small",onClick:()=>{x({type:"test",severity:"info",title:"Test Alert",message:"This is a test notification to verify that the alert system is working."})},sx:{mt:1},children:"Test Alert System"})]})})})]})})]})]})})}function ioe(e){return wt("MuiAppBar",e)}kt("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const soe=["className","color","enableColorOnDark","position"],ooe=(e,t)=>e?`${null==e?void 0:e.replace(")","")}, ${t})`:t,aoe=Yw(fk,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${Gw(n.position)}`],t[`color${Gw(n.color)}`]]}})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[900];return(0,Ie.A)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===n.position&&{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===n.position&&{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},"sticky"===n.position&&{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},"static"===n.position&&{position:"static"},"relative"===n.position&&{position:"relative"},!t.vars&&(0,Ie.A)({},"default"===n.color&&{backgroundColor:r,color:t.palette.getContrastText(r)},n.color&&"default"!==n.color&&"inherit"!==n.color&&"transparent"!==n.color&&{backgroundColor:t.palette[n.color].main,color:t.palette[n.color].contrastText},"inherit"===n.color&&{color:"inherit"},"dark"===t.palette.mode&&!n.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===n.color&&(0,Ie.A)({backgroundColor:"transparent",color:"inherit"},"dark"===t.palette.mode&&{backgroundImage:"none"})),t.vars&&(0,Ie.A)({},"default"===n.color&&{"--AppBar-background":n.enableColorOnDark?t.vars.palette.AppBar.defaultBg:ooe(t.vars.palette.AppBar.darkBg,t.vars.palette.AppBar.defaultBg),"--AppBar-color":n.enableColorOnDark?t.vars.palette.text.primary:ooe(t.vars.palette.AppBar.darkColor,t.vars.palette.text.primary)},n.color&&!n.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":n.enableColorOnDark?t.vars.palette[n.color].main:ooe(t.vars.palette.AppBar.darkBg,t.vars.palette[n.color].main),"--AppBar-color":n.enableColorOnDark?t.vars.palette[n.color].contrastText:ooe(t.vars.palette.AppBar.darkColor,t.vars.palette[n.color].contrastText)},!["inherit","transparent"].includes(n.color)&&{backgroundColor:"var(--AppBar-background)"},{color:"inherit"===n.color?"inherit":"var(--AppBar-color)"},"transparent"===n.color&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))})),loe=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiAppBar"}),{className:r,color:i="primary",enableColorOnDark:s=!1,position:o="fixed"}=n,a=(0,Ce.A)(n,soe),l=(0,Ie.A)({},n,{color:i,position:o,enableColorOnDark:s}),u=(e=>{const{color:t,position:n,classes:r}=e;return Tw({root:["root",`color${Gw(t)}`,`position${Gw(n)}`]},ioe,r)})(l);return(0,Me.jsx)(aoe,(0,Ie.A)({square:!0,component:"header",ownerState:l,elevation:4,className:Te(u.root,r,"fixed"===o&&"mui-fixed"),ref:t},a))}));function uoe(e){return wt("MuiToolbar",e)}kt("MuiToolbar",["root","gutters","regular","dense"]);const coe=["className","component","disableGutters","variant"],hoe=Yw("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableGutters&&t.gutters,t[n.variant]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({position:"relative",display:"flex",alignItems:"center"},!n.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}},"dense"===n.variant&&{minHeight:48})}),(e=>{let{theme:t,ownerState:n}=e;return"regular"===n.variant&&t.mixins.toolbar})),doe=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiToolbar"}),{className:r,component:i="div",disableGutters:s=!1,variant:o="regular"}=n,a=(0,Ce.A)(n,coe),l=(0,Ie.A)({},n,{component:i,disableGutters:s,variant:o}),u=(e=>{const{classes:t,disableGutters:n,variant:r}=e;return Tw({root:["root",!n&&"gutters",r]},uoe,t)})(l);return(0,Me.jsx)(hoe,(0,Ie.A)({as:i,className:Te(u.root,r),ref:t,ownerState:l},a))})),poe=doe,foe=e=>{const t=a.useRef({});return a.useEffect((()=>{t.current=e})),t.current};const moe=function(e){const{badgeContent:t,invisible:n=!1,max:r=99,showZero:i=!1}=e,s=foe({badgeContent:t,max:r});let o=n;!1!==n||0!==t||i||(o=!0);const{badgeContent:a,max:l=r}=o?s:e;return{badgeContent:a,invisible:o,max:l,displayValue:a&&Number(a)>l?`${l}+`:a}};function goe(e){return wt("MuiBadge",e)}const voe=kt("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),yoe=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],boe=Yw("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),xoe=Yw("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${Gw(n.anchorOrigin.vertical)}${Gw(n.anchorOrigin.horizontal)}${Gw(n.overlap)}`],"default"!==n.color&&t[`color${Gw(n.color)}`],n.invisible&&t.invisible]}})((e=>{let{theme:t}=e;var n;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(12),minWidth:20,lineHeight:1,padding:"0 6px",height:20,borderRadius:10,zIndex:1,transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.enteringScreen}),variants:[...Object.keys((null!=(n=t.vars)?n:t).palette).filter((e=>{var n,r;return(null!=(n=t.vars)?n:t).palette[e].main&&(null!=(r=t.vars)?r:t).palette[e].contrastText})).map((e=>({props:{color:e},style:{backgroundColor:(t.vars||t).palette[e].main,color:(t.vars||t).palette[e].contrastText}}))),{props:{variant:"dot"},style:{borderRadius:4,height:8,minWidth:8,padding:0}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${voe.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${voe.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${voe.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${voe.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${voe.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${voe.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${voe.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${voe.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.leavingScreen})}}]}})),woe=a.forwardRef((function(e,t){var n,r,i,s,o,a;const l=ek({props:e,name:"MuiBadge"}),{anchorOrigin:u={vertical:"top",horizontal:"right"},className:c,component:h,components:d={},componentsProps:p={},children:f,overlap:m="rectangular",color:g="default",invisible:v=!1,max:y=99,badgeContent:b,slots:x,slotProps:w,showZero:k=!1,variant:S="standard"}=l,I=(0,Ce.A)(l,yoe),{badgeContent:C,invisible:E,max:T,displayValue:N}=moe({max:y,invisible:v,badgeContent:b,showZero:k}),A=foe({anchorOrigin:u,color:g,overlap:m,variant:S,badgeContent:b}),R=E||null==C&&"dot"!==S,{color:$=g,overlap:_=m,anchorOrigin:O=u,variant:D=S}=R?A:l,F="dot"!==D?N:void 0,M=(0,Ie.A)({},l,{badgeContent:C,invisible:R,max:T,displayValue:F,showZero:k,anchorOrigin:O,color:$,overlap:_,variant:D}),L=(e=>{const{color:t,anchorOrigin:n,invisible:r,overlap:i,variant:s,classes:o={}}=e;return Tw({root:["root"],badge:["badge",s,r&&"invisible",`anchorOrigin${Gw(n.vertical)}${Gw(n.horizontal)}`,`anchorOrigin${Gw(n.vertical)}${Gw(n.horizontal)}${Gw(i)}`,`overlap${Gw(i)}`,"default"!==t&&`color${Gw(t)}`]},goe,o)})(M),P=null!=(n=null!=(r=null==x?void 0:x.root)?r:d.Root)?n:boe,z=null!=(i=null!=(s=null==x?void 0:x.badge)?s:d.Badge)?i:xoe,B=null!=(o=null==w?void 0:w.root)?o:p.root,U=null!=(a=null==w?void 0:w.badge)?a:p.badge,W=$C({elementType:P,externalSlotProps:B,externalForwardedProps:I,additionalProps:{ref:t,as:h},ownerState:M,className:Te(null==B?void 0:B.className,L.root,c)}),V=$C({elementType:z,externalSlotProps:U,ownerState:M,className:Te(L.badge,null==U?void 0:U.className)});return(0,Me.jsxs)(P,(0,Ie.A)({},W,{children:[f,(0,Me.jsx)(z,(0,Ie.A)({},V,{children:F}))]}))})),koe=woe;function Soe(e){return wt("MuiLink",e)}const Ioe=kt("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]);var Coe=n(7162);const Eoe={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Toe=e=>{let{theme:t,ownerState:n}=e;const r=(e=>Eoe[e]||e)(n.color),i=(0,Coe.Yn)(t,`palette.${r}`,!1)||n.color,s=(0,Coe.Yn)(t,`palette.${r}Channel`);return"vars"in t&&s?`rgba(${s} / 0.4)`:(0,Ve.X4)(i,.4)},Noe=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],Aoe=Yw(lk,{name:"MuiLink",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`underline${Gw(n.underline)}`],"button"===n.component&&t.button]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({},"none"===n.underline&&{textDecoration:"none"},"hover"===n.underline&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},"always"===n.underline&&(0,Ie.A)({textDecoration:"underline"},"inherit"!==n.color&&{textDecorationColor:Toe({theme:t,ownerState:n})},{"&:hover":{textDecorationColor:"inherit"}}),"button"===n.component&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Ioe.focusVisible}`]:{outline:"auto"}})})),Roe=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiLink"}),{className:r,color:i="primary",component:s="a",onBlur:o,onFocus:l,TypographyClasses:u,underline:c="always",variant:h="inherit",sx:d}=n,p=(0,Ce.A)(n,Noe),{isFocusVisibleRef:f,onBlur:m,onFocus:g,ref:v}=eS(),[y,b]=a.useState(!1),x=Lk(t,v),w=(0,Ie.A)({},n,{color:i,component:s,focusVisible:y,underline:c,variant:h}),k=(e=>{const{classes:t,component:n,focusVisible:r,underline:i}=e;return Tw({root:["root",`underline${Gw(i)}`,"button"===n&&"button",r&&"focusVisible"]},Soe,t)})(w);return(0,Me.jsx)(Aoe,(0,Ie.A)({color:i,className:Te(k.root,r),classes:u,component:s,onBlur:e=>{m(e),!1===f.current&&b(!1),o&&o(e)},onFocus:e=>{g(e),!0===f.current&&b(!0),l&&l(e)},ref:x,ownerState:w,variant:h,sx:[...Object.keys(Eoe).includes(i)?[]:[{color:i}],...Array.isArray(d)?d:[d]]},p))})),$oe=Roe,_oe=BS((0,Me.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function Ooe(e){return wt("MuiAvatar",e)}kt("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const Doe=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],Foe=Yw("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],n.colorDefault&&t.colorDefault]}})((e=>{let{theme:t}=e;return{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:(0,Ie.A)({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:(0,Ie.A)({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]}})),Moe=Yw("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(e,t)=>t.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),Loe=Yw(_oe,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(e,t)=>t.fallback})({width:"75%",height:"75%"});const Poe=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiAvatar"}),{alt:r,children:i,className:s,component:o="div",slots:l={},slotProps:u={},imgProps:c,sizes:h,src:d,srcSet:p,variant:f="circular"}=n,m=(0,Ce.A)(n,Doe);let g=null;const v=function(e){let{crossOrigin:t,referrerPolicy:n,src:r,srcSet:i}=e;const[s,o]=a.useState(!1);return a.useEffect((()=>{if(!r&&!i)return;o(!1);let e=!0;const s=new Image;return s.onload=()=>{e&&o("loaded")},s.onerror=()=>{e&&o("error")},s.crossOrigin=t,s.referrerPolicy=n,s.src=r,i&&(s.srcset=i),()=>{e=!1}}),[t,n,r,i]),s}((0,Ie.A)({},c,{src:d,srcSet:p})),y=d||p,b=y&&"error"!==v,x=(0,Ie.A)({},n,{colorDefault:!b,component:o,variant:f}),w=(e=>{const{classes:t,variant:n,colorDefault:r}=e;return Tw({root:["root",n,r&&"colorDefault"],img:["img"],fallback:["fallback"]},Ooe,t)})(x),[k,S]=Dk("img",{className:w.img,elementType:Moe,externalForwardedProps:{slots:l,slotProps:{img:(0,Ie.A)({},c,u.img)}},additionalProps:{alt:r,src:d,srcSet:p,sizes:h},ownerState:x});return g=b?(0,Me.jsx)(k,(0,Ie.A)({},S)):i||0===i?i:y&&r?r[0]:(0,Me.jsx)(Loe,{ownerState:x,className:w.fallback}),(0,Me.jsx)(Foe,(0,Ie.A)({as:o,ownerState:x,className:Te(w.root,s),ref:t},m,{children:g}))})),zoe=Poe,Boe=["className"],Uoe=Yw("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"flex-start"===n.alignItems&&t.alignItemsFlexStart]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Ie.A)({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex"},"flex-start"===n.alignItems&&{marginTop:8})})),Woe=a.forwardRef((function(e,t){const n=ek({props:e,name:"MuiListItemIcon"}),{className:r}=n,i=(0,Ce.A)(n,Boe),s=a.useContext(_C),o=(0,Ie.A)({},n,{alignItems:s.alignItems}),l=(e=>{const{alignItems:t,classes:n}=e;return Tw({root:["root","flex-start"===t&&"alignItemsFlexStart"]},CA,n)})(o);return(0,Me.jsx)(Uoe,(0,Ie.A)({className:Te(l.root,r),ownerState:o,ref:t},i))})),Voe=BS((0,Me.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),joe=BS((0,Me.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),Goe=BS((0,Me.jsx)("path",{d:"M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8zm0-18v6h8V3z"}),"Dashboard"),Hoe=BS((0,Me.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person"),qoe=BS((0,Me.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout");function Koe(){var e;const[t,n]=(0,a.useState)(null),[r,i]=(0,a.useState)(null),[s,o]=(0,a.useState)(null),{currentUser:l,userProfile:u,logout:c}=cw(),{notifications:h}=Zre(),d=ie(),p=[{title:"Dashboard",path:"/dashboard"},{title:"Settings",path:"/settings"}],f=()=>{n(null)},m=()=>{i(null)},g=()=>{o(null)},v=h.filter((e=>!e.read)).length;return(0,Me.jsx)(loe,{position:"static",children:(0,Me.jsx)(tk,{maxWidth:"xl",children:(0,Me.jsxs)(poe,{disableGutters:!0,children:[(0,Me.jsx)(lk,{variant:"h6",noWrap:!0,component:kw,to:"/dashboard",sx:{mr:2,display:{xs:"none",md:"flex"},fontWeight:700,color:"inherit",textDecoration:"none"},children:"BAADI"}),(0,Me.jsxs)(Ct,{sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:[(0,Me.jsx)(DS,{size:"large","aria-label":"navigation menu","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:e=>{n(e.currentTarget)},color:"inherit",children:(0,Me.jsx)(Voe,{})}),(0,Me.jsx)(iT,{id:"menu-appbar",anchorEl:t,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:Boolean(t),onClose:f,sx:{display:{xs:"block",md:"none"}},children:p.map((e=>(0,Me.jsx)(_A,{onClick:()=>{f(),d(e.path)},children:(0,Me.jsx)(lk,{textAlign:"center",children:e.title})},e.title)))})]}),(0,Me.jsx)(lk,{variant:"h5",noWrap:!0,component:"div",sx:{flexGrow:1,display:{xs:"flex",md:"none"},fontWeight:700},children:"BAADI"}),(0,Me.jsx)(Ct,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:p.map((e=>(0,Me.jsx)(AN,{component:kw,to:e.path,onClick:f,sx:{my:2,color:"white",display:"block"},children:e.title},e.title)))}),(0,Me.jsxs)(Ct,{sx:{flexGrow:0,display:"flex"},children:[(0,Me.jsx)(Xse,{title:"Notifications",children:(0,Me.jsx)(DS,{onClick:e=>{o(e.currentTarget)},sx:{mr:1},color:"inherit",children:(0,Me.jsx)(koe,{badgeContent:v,color:"error",children:(0,Me.jsx)(joe,{})})})}),(0,Me.jsxs)(iT,{sx:{mt:"45px"},id:"menu-notifications",anchorEl:s,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(s),onClose:g,children:[(0,Me.jsx)(lk,{sx:{p:2},children:"Notifications"}),(0,Me.jsx)(BA,{}),0===h.length?(0,Me.jsx)(_A,{children:(0,Me.jsx)(lk,{variant:"body2",children:"No notifications"})}):h.slice(0,5).map((e=>{var t;return(0,Me.jsx)(_A,{onClick:g,children:(0,Me.jsxs)(Ct,{sx:{display:"flex",flexDirection:"column",minWidth:240,maxWidth:300},children:[(0,Me.jsx)(lk,{variant:"subtitle2",sx:{fontWeight:e.read?"normal":"bold",color:"critical"===e.severity?"error.main":"text.primary"},children:e.title}),(0,Me.jsx)(lk,{variant:"body2",noWrap:!0,children:e.message}),(0,Me.jsx)(lk,{variant:"caption",color:"text.secondary",children:(null===(t=e.timestamp)||void 0===t?void 0:t.toLocaleString())||"Just now"})]})},e.id)})),h.length>5&&(0,Me.jsx)(Ct,{sx:{textAlign:"center",p:1},children:(0,Me.jsx)($oe,{component:kw,to:"/notifications",onClick:g,underline:"hover",children:"View all notifications"})})]}),(0,Me.jsx)(Xse,{title:"Open user menu",children:(0,Me.jsx)(DS,{onClick:e=>{i(e.currentTarget)},sx:{p:0,ml:1},children:(0,Me.jsx)(zoe,{alt:(null===l||void 0===l?void 0:l.displayName)||"User",src:"/static/avatar.jpg",sx:{bgcolor:"primary.main"},children:(null===l||void 0===l||null===(e=l.displayName)||void 0===e?void 0:e.charAt(0))||"U"})})}),(0,Me.jsxs)(iT,{sx:{mt:"45px"},id:"menu-appbar",anchorEl:r,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(r),onClose:m,children:[(0,Me.jsxs)(Ct,{sx:{px:2,py:1},children:[(0,Me.jsx)(lk,{variant:"subtitle1",children:null===l||void 0===l?void 0:l.displayName}),(0,Me.jsx)(lk,{variant:"body2",color:"text.secondary",children:null===l||void 0===l?void 0:l.email}),(0,Me.jsx)(lk,{variant:"caption",color:"text.secondary",children:"primary_caregiver"===(null===u||void 0===u?void 0:u.role)?"Primary Caregiver":"secondary_caregiver"===(null===u||void 0===u?void 0:u.role)?"Secondary Caregiver":"healthcare_professional"===(null===u||void 0===u?void 0:u.role)?"Healthcare Professional":"Family Member"})]}),(0,Me.jsx)(BA,{}),(0,Me.jsxs)(_A,{onClick:()=>{m(),d("/dashboard")},children:[(0,Me.jsx)(Woe,{children:(0,Me.jsx)(Goe,{fontSize:"small"})}),"Dashboard"]}),(0,Me.jsxs)(_A,{onClick:()=>{m(),d("/profile")},children:[(0,Me.jsx)(Woe,{children:(0,Me.jsx)(Hoe,{fontSize:"small"})}),"Profile"]}),(0,Me.jsxs)(_A,{onClick:()=>{m(),d("/settings")},children:[(0,Me.jsx)(Woe,{children:(0,Me.jsx)(FR,{fontSize:"small"})}),"Settings"]}),(0,Me.jsx)(BA,{}),(0,Me.jsxs)(_A,{onClick:()=>{m(),(async()=>{try{await c(),d("/login")}catch(e){console.error("Failed to log out",e)}})()},children:[(0,Me.jsx)(Woe,{children:(0,Me.jsx)(qoe,{fontSize:"small"})}),"Logout"]})]})]})]})})})}const Xoe=()=>{var e,t,n;const{userProfile:r,updateUserProfile:i}=cw(),[s,o]=(0,a.useState)((null===r||void 0===r?void 0:r.settings)||{alertSensitivity:"medium",motionThreshold:.5,fallThreshold:.7,notificationPreferences:{email:!0,push:!0,sms:!1}}),[l,u]=(0,a.useState)(!1),[c,h]=(0,a.useState)(""),[d,p]=(0,a.useState)(!1),f=(e,t)=>n=>{o(e?r=>({...r,[e]:{...r[e],[t]:n.target.checked}}):e=>({...e,[t]:n.target.checked}))},m=e=>(t,n)=>{o((t=>({...t,[e]:n})))};return(0,Me.jsx)(tk,{maxWidth:"md",children:(0,Me.jsxs)(Ct,{sx:{mt:4,mb:4},children:[(0,Me.jsx)(lk,{variant:"h4",component:"h1",gutterBottom:!0,children:"Settings"}),l&&(0,Me.jsx)(ZS,{severity:"success",sx:{mb:3},children:"Settings saved successfully!"}),c&&(0,Me.jsx)(ZS,{severity:"error",sx:{mb:3},children:c}),(0,Me.jsxs)(kA,{container:!0,spacing:3,children:[(0,Me.jsx)(kA,{item:!0,xs:12,children:(0,Me.jsx)(yk,{children:(0,Me.jsxs)(kk,{children:[(0,Me.jsx)(lk,{variant:"h6",gutterBottom:!0,children:"Notification Preferences"}),(0,Me.jsx)(BA,{sx:{mb:2}}),(0,Me.jsx)(nN,{control:(0,Me.jsx)(_R,{checked:(null===(e=s.notificationPreferences)||void 0===e?void 0:e.email)||!1,onChange:f("notificationPreferences","email")}),label:"Email Notifications"}),(0,Me.jsx)(lk,{variant:"body2",color:"text.secondary",sx:{ml:3,mb:2},children:"Receive alerts via email for critical events"}),(0,Me.jsx)(nN,{control:(0,Me.jsx)(_R,{checked:(null===(t=s.notificationPreferences)||void 0===t?void 0:t.push)||!1,onChange:f("notificationPreferences","push")}),label:"Push Notifications"}),(0,Me.jsx)(lk,{variant:"body2",color:"text.secondary",sx:{ml:3,mb:2},children:"Receive mobile push notifications for immediate alerts"}),(0,Me.jsx)(nN,{control:(0,Me.jsx)(_R,{checked:(null===(n=s.notificationPreferences)||void 0===n?void 0:n.sms)||!1,onChange:f("notificationPreferences","sms")}),label:"SMS Notifications"}),(0,Me.jsx)(lk,{variant:"body2",color:"text.secondary",sx:{ml:3},children:"Receive text messages for critical alerts"})]})})}),(0,Me.jsx)(kA,{item:!0,xs:12,md:6,children:(0,Me.jsx)(yk,{sx:{height:"100%"},children:(0,Me.jsxs)(kk,{children:[(0,Me.jsx)(lk,{variant:"h6",gutterBottom:!0,children:"Alert Settings"}),(0,Me.jsx)(BA,{sx:{mb:2}}),(0,Me.jsx)(lk,{gutterBottom:!0,children:"Motion Threshold"}),(0,Me.jsx)(IR,{value:s.motionThreshold||.5,onChange:m("motionThreshold"),step:.1,marks:!0,min:.1,max:1,valueLabelDisplay:"auto",sx:{mb:3}}),(0,Me.jsx)(lk,{gutterBottom:!0,children:"Fall Detection Threshold"}),(0,Me.jsx)(IR,{value:s.fallThreshold||.7,onChange:m("fallThreshold"),step:.1,marks:!0,min:.1,max:1,valueLabelDisplay:"auto"})]})})}),(0,Me.jsx)(kA,{item:!0,xs:12,md:6,children:(0,Me.jsx)(yk,{sx:{height:"100%"},children:(0,Me.jsxs)(kk,{children:[(0,Me.jsx)(lk,{variant:"h6",gutterBottom:!0,children:"Emergency Contacts"}),(0,Me.jsx)(BA,{sx:{mb:2}}),(0,Me.jsx)(UT,{label:"Primary Emergency Contact",fullWidth:!0,margin:"normal",variant:"outlined",placeholder:"Phone Number",value:s.emergencyContact1||"",onChange:e=>o((t=>({...t,emergencyContact1:e.target.value})))}),(0,Me.jsx)(UT,{label:"Secondary Emergency Contact",fullWidth:!0,margin:"normal",variant:"outlined",placeholder:"Phone Number",value:s.emergencyContact2||"",onChange:e=>o((t=>({...t,emergencyContact2:e.target.value})))})]})})}),(0,Me.jsx)(kA,{item:!0,xs:12,children:(0,Me.jsx)(Ct,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,Me.jsx)(AN,{variant:"contained",color:"primary",size:"large",onClick:async()=>{try{p(!0),h(""),u(!1),await i({settings:s}),u(!0)}catch(c){console.error("Error saving settings:",c),h("Failed to save settings.")}finally{p(!1)}},disabled:d,children:d?"Saving...":"Save Settings"})})})]})]})})},Yoe=()=>(0,Me.jsx)(tk,{maxWidth:"md",children:(0,Me.jsxs)(Ct,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80vh",textAlign:"center"},children:[(0,Me.jsx)(lk,{variant:"h1",component:"h1",gutterBottom:!0,children:"404"}),(0,Me.jsx)(lk,{variant:"h4",component:"h2",gutterBottom:!0,children:"Page Not Found"}),(0,Me.jsx)(lk,{variant:"body1",paragraph:!0,children:"The page you are looking for doesn't exist or has been moved."}),(0,Me.jsx)(AN,{component:kw,to:"/",variant:"contained",color:"primary",size:"large",children:"Back to Home"})]})});const Qoe=function(){const{currentUser:e,loading:t}=cw();return t?(0,Me.jsx)(Ct,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:"Loading..."}):(0,Me.jsxs)("div",{className:"app-container",children:[e&&(0,Me.jsx)(Koe,{}),(0,Me.jsx)("div",{className:"main-content",children:(0,Me.jsxs)(ke,{children:[(0,Me.jsx)(xe,{path:"/",element:e?(0,Me.jsx)(be,{to:"/dashboard",replace:!0}):(0,Me.jsx)(RN,{})}),(0,Me.jsx)(xe,{path:"/login",element:(0,Me.jsx)(RN,{})}),(0,Me.jsx)(xe,{path:"/register",element:(0,Me.jsx)(DA,{})}),(0,Me.jsx)(xe,{path:"/forgot-password",element:(0,Me.jsx)(FA,{})}),(0,Me.jsx)(xe,{path:"/dashboard",element:(0,Me.jsx)(dw,{children:(0,Me.jsx)(roe,{})})}),(0,Me.jsx)(xe,{path:"/settings",element:(0,Me.jsx)(dw,{children:(0,Me.jsx)(Xoe,{})})}),(0,Me.jsx)(xe,{path:"*",element:(0,Me.jsx)(Yoe,{})})]})})]})},Joe=e=>{e&&e instanceof Function&&n.e(488).then(n.bind(n,2488)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:s,getTTFB:o}=t;n(e),r(e),i(e),s(e),o(e)}))};const Zoe=a.createContext(null);function eae(){return a.useContext(Zoe)}const tae="function"===typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__";const nae=function(e){const{children:t,theme:n}=e,r=eae(),i=a.useMemo((()=>{const e=null===r?n:function(e,t){if("function"===typeof t)return t(e);return(0,Ie.A)({},e,t)}(r,n);return null!=e&&(e[tae]=null!==r),e}),[n,r]);return(0,Me.jsx)(Zoe.Provider,{value:i,children:t})},rae={};function iae(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return a.useMemo((()=>{const i=e&&t[e]||t;if("function"===typeof n){const s=n(i),o=e?(0,Ie.A)({},t,{[e]:s}):s;return r?()=>o:o}return e?(0,Ie.A)({},t,{[e]:n}):(0,Ie.A)({},t,n)}),[e,t,n,r])}const sae=function(e){const{children:t,theme:n,themeId:r}=e,i=Oe(rae),s=eae()||rae,o=iae(r,i,n),a=iae(r,s,n,!0),l="rtl"===o.direction;return(0,Me.jsx)(nae,{theme:a,children:(0,Me.jsx)(_e.T.Provider,{value:o,children:(0,Me.jsx)(AC,{value:l,children:(0,Me.jsx)(Zw,{value:null==o?void 0:o.components,children:t})})})})},oae=["theme"];function aae(e){let{theme:t}=e,n=(0,Ce.A)(e,oae);const r=t[bt];let i=r||t;return"function"!==typeof t&&(r&&!r.vars?i=(0,Ie.A)({},r,{vars:null}):t&&!t.vars&&(i=(0,Ie.A)({},t,{vars:null}))),(0,Me.jsx)(sae,(0,Ie.A)({},n,{themeId:r?bt:void 0,theme:i}))}const lae=(e,t)=>(0,Ie.A)({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},t&&!e.vars&&{colorScheme:e.palette.mode}),uae=e=>(0,Ie.A)({color:(e.vars||e).palette.text.primary},e.typography.body1,{backgroundColor:(e.vars||e).palette.background.default,"@media print":{backgroundColor:(e.vars||e).palette.common.white}});const cae=function(e){const t=ek({props:e,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=t;return(0,Me.jsxs)(a.Fragment,{children:[(0,Me.jsx)(vI,{styles:e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n;const r={};t&&e.colorSchemes&&Object.entries(e.colorSchemes).forEach((t=>{let[n,i]=t;var s;r[e.getColorSchemeSelector(n).replace(/\s*&/,"")]={colorScheme:null==(s=i.palette)?void 0:s.mode}}));let i=(0,Ie.A)({html:lae(e,t),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:(0,Ie.A)({margin:0},uae(e),{"&::backdrop":{backgroundColor:(e.vars||e).palette.background.default}})},r);const s=null==(n=e.components)||null==(n=n.MuiCssBaseline)?void 0:n.styleOverrides;return s&&(i=[i,s]),i}(e,r)}),n]})},hae=yt({palette:{primary:{main:"#2196f3",light:"#64b5f6",dark:"#0d47a1",contrastText:"#ffffff"},secondary:{main:"#f50057",light:"#ff4081",dark:"#c51162",contrastText:"#ffffff"},error:{main:"#f44336",light:"#e57373",dark:"#d32f2f"},warning:{main:"#ff9800",light:"#ffb74d",dark:"#f57c00"},info:{main:"#2196f3",light:"#64b5f6",dark:"#1976d2"},success:{main:"#4caf50",light:"#81c784",dark:"#388e3c"},background:{default:"#f5f5f5",paper:"#ffffff"}},typography:{fontFamily:["Roboto",'"Helvetica Neue"',"Arial","sans-serif"].join(","),h1:{fontSize:"2.5rem",fontWeight:500},h2:{fontSize:"2rem",fontWeight:500},h3:{fontSize:"1.75rem",fontWeight:500},h4:{fontSize:"1.5rem",fontWeight:500},h5:{fontSize:"1.25rem",fontWeight:500},h6:{fontSize:"1rem",fontWeight:500}},shape:{borderRadius:8},components:{MuiButton:{styleOverrides:{root:{textTransform:"none",borderRadius:8,padding:"8px 16px"},contained:{boxShadow:"none","&:hover":{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"}}}},MuiPaper:{styleOverrides:{root:{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)"},elevation1:{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)"},elevation2:{boxShadow:"0 3px 6px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.12)"},elevation3:{boxShadow:"0 10px 20px rgba(0, 0, 0, 0.15), 0 3px 6px rgba(0, 0, 0, 0.10)"},elevation4:{boxShadow:"0 15px 25px rgba(0, 0, 0, 0.15), 0 5px 10px rgba(0, 0, 0, 0.05)"}}},MuiAppBar:{styleOverrides:{root:{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)"}}},MuiCard:{styleOverrides:{root:{borderRadius:12,boxShadow:"0 3px 6px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.12)"}}}}});u.createRoot(document.getElementById("root")).render((0,Me.jsx)(a.StrictMode,{children:(0,Me.jsx)(bw,{children:(0,Me.jsxs)(aae,{theme:hae,children:[(0,Me.jsx)(cae,{}),(0,Me.jsx)(hw,{children:(0,Me.jsx)(eie,{children:(0,Me.jsx)(Qoe,{})})})]})})})),Joe()})()})();
//# sourceMappingURL=main.8be19d5c.js.map