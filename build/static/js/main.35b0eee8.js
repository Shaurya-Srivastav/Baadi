/*! For license information please see main.35b0eee8.js.LICENSE.txt */
(()=>{var e={219:(e,t,n)=>{"use strict";var r=n(3763),s={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function l(e){return r.isMemo(e)?i:o[e.$$typeof]||s}o[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[r.Memo]=i;var u=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(f){var s=p(n);s&&s!==f&&e(t,s,r)}var i=c(n);d&&(i=i.concat(d(n)));for(var o=l(t),m=l(n),g=0;g<i.length;++g){var y=i[g];if(!a[y]&&(!r||!r[y])&&(!m||!m[y])&&(!o||!o[y])){var v=h(n,y);try{u(t,y,v)}catch(b){}}}}return t}},457:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A});var r=n(7868)},528:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler");Symbol.for("react.provider");var o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.for("react.offscreen"),m=Symbol.for("react.client.reference");function g(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case s:case i:case a:case c:case d:return e;default:switch(e=e&&e.$$typeof){case l:case u:case p:case h:case o:return e;default:return t}}case r:return t}}}t.vM=u,t.lD=h},551:()=>{},579:(e,t,n)=>{"use strict";e.exports=n(1153)},869:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});n(5043);var r=n(3290),s=n(579);function a(e){const{styles:t,defaultTheme:n={}}=e,a="function"===typeof t?e=>{return t(void 0===(r=e)||null===r||0===Object.keys(r).length?n:e);var r}:t;return(0,s.jsx)(r.mL,{styles:a})}},918:(e,t,n)=>{"use strict";function r(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}n.d(t,{A:()=>r})},1153:(e,t,n)=>{"use strict";var r=n(5043),s=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,a={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:s,type:e,key:u,ref:c,props:a,_owner:o.current}}t.Fragment=a,t.jsx=u,t.jsxs=u},1188:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,n))}},1234:()=>{},1722:(e,t,n)=>{"use strict";n.d(t,{Rk:()=>r,SF:()=>s,sk:()=>a});function r(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):n&&(r+=n+" ")})),r}var s=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},a=function(e,t,n){s(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var a=t;do{e.insert(t===a?"."+r:"",a,e.sheet,!0),a=a.next}while(void 0!==a)}}},2374:(e,t,n)=>{"use strict";t.A=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=s?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(5043)),s=n(3174);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=r.useContext(s.ThemeContext);return t&&(n=t,0!==Object.keys(n).length)?t:e;var n}},2430:function(e,t,n){var r;!function(s,a,i){var o,l=256,u=i.pow(l,6),c=i.pow(2,52),d=2*c,h=255;function p(e,t,n){var r=[],h=y(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,v(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(l):(e=new Uint8Array(l),(s.crypto||s.msCrypto).getRandomValues(e)),v(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,v(a)]}}():e,3),r),p=new f(r),b=function(){for(var e=p.g(6),t=u,n=0;e<c;)e=(e+n)*l,t*=l,n=p.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|p.g(4)},b.quick=function(){return p.g(4)/4294967296},b.double=b,y(v(p.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,p),e.state=function(){return m(p,{})}),n?(i.random=e,t):e})(b,h,"global"in t?t.global:this==i,t.state)}function f(e){var t,n=e.length,r=this,s=0,a=r.i=r.j=0,i=r.S=[];for(n||(e=[n++]);s<l;)i[s]=s++;for(s=0;s<l;s++)i[s]=i[a=h&a+e[s%n]+(t=i[s])],i[a]=t;(r.g=function(e){for(var t,n=0,s=r.i,a=r.j,i=r.S;e--;)t=i[s=h&s+1],n=n*l+i[h&(i[s]=i[a=h&a+t])+(i[a]=t)];return r.i=s,r.j=a,n})(l)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n,r=[],s=typeof e;if(t&&"object"==s)for(n in e)try{r.push(g(e[n],t-1))}catch(a){}return r.length?r:"string"==s?e:e+"\0"}function y(e,t){for(var n,r=e+"",s=0;s<r.length;)t[h&s]=h&(n^=19*t[h&s])+r.charCodeAt(s++);return v(t)}function v(e){return String.fromCharCode.apply(0,e)}if(y(i.random(),a),e.exports){e.exports=p;try{o=n(1234)}catch(b){}}else void 0===(r=function(){return p}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2730:(e,t,n)=>{"use strict";var r=n(5043),s=n(8853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,s,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var s=g.hasOwnProperty(t)?g[t]:null;(null!==s?0!==s.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,r)&&(n=null),r||null===s?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,r=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),N=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),$=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var F,L=Object.assign;function P(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var z=!1;function B(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var s=u.stack.split("\n"),a=r.stack.split("\n"),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(1!==i||1!==o)do{if(i--,0>--o||s[i]!==a[o]){var l="\n"+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?P(e):""}function j(e){switch(e.tag){case 5:return P(e.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case k:return"Portal";case C:return"Profiler";case I:return"StrictMode";case A:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case N:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case $:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Q(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(r&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ae(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,de=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),s=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Se=null,Ie=null;function Ce(e){if(e=bs(e)){if("function"!==typeof ke)throw Error(a(280));var t=e.stateNode;t&&(t=ws(t),ke(e.stateNode,e.type,t))}}function Te(e){Se?Ie?Ie.push(e):Ie=[e]:Se=e}function Ne(){if(Se){var e=Se,t=Ie;if(Ie=Se=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ee(e,t){return e(t)}function Ae(){}var Re=!1;function _e(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ee(e,t,n)}finally{Re=!1,(null!==Se||null!==Ie)&&(Ae(),Ne())}}function $e(e,t){var n=e.stateNode;if(null===n)return null;var r=ws(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Oe=!1;if(c)try{var De={};Object.defineProperty(De,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ce){Oe=!1}function Me(e,t,n,r,s,a,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Fe=!1,Le=null,Pe=!1,ze=null,Be={onError:function(e){Fe=!0,Le=e}};function je(e,t,n,r,s,a,i,o,l){Fe=!1,Le=null,Me.apply(Be,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ue(e)!==e)throw Error(a(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(null===s)break;var i=s.alternate;if(null===i){if(null!==(r=s.return)){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return We(s),e;if(i===r)return We(s),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var qe=s.unstable_scheduleCallback,Ke=s.unstable_cancelCallback,Xe=s.unstable_shouldYield,Ye=s.unstable_requestPaint,Qe=s.unstable_now,Je=s.unstable_getCurrentPriorityLevel,Ze=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,rt=s.unstable_IdlePriority,st=null,at=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,s=e.suspendedLanes,a=e.pingedLanes,i=268435455&n;if(0!==i){var o=i&~s;0!==o?r=dt(o):0!==(a&=i)&&(r=dt(a))}else 0!==(i=n&~s)?r=dt(i):0!==a&&(r=dt(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(a=t&-t)||16===s&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)s=1<<(n=31-it(t)),r|=e[n],t&=~s;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,St,It,Ct,Tt=!1,Nt=[],Et=null,At=null,Rt=null,_t=new Map,$t=new Map,Ot=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":_t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":$t.delete(t.pointerId)}}function Ft(e,t,n,r,s,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},null!==t&&(null!==(t=bs(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Lt(e){var t=vs(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Ct(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Pt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bs(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function zt(e,t,n){Pt(e)&&n.delete(t)}function Bt(){Tt=!1,null!==Et&&Pt(Et)&&(Et=null),null!==At&&Pt(At)&&(At=null),null!==Rt&&Pt(Rt)&&(Rt=null),_t.forEach(zt),$t.forEach(zt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Bt)))}function Ut(e){function t(t){return jt(t,e)}if(0<Nt.length){jt(Nt[0],e);for(var n=1;n<Nt.length;n++){var r=Nt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&jt(Et,e),null!==At&&jt(At,e),null!==Rt&&jt(Rt,e),_t.forEach(t),$t.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Lt(n),null===n.blockedOn&&Ot.shift()}var Vt=x.ReactCurrentBatchConfig,Wt=!0;function Gt(e,t,n,r){var s=bt,a=Vt.transition;Vt.transition=null;try{bt=1,qt(e,t,n,r)}finally{bt=s,Vt.transition=a}}function Ht(e,t,n,r){var s=bt,a=Vt.transition;Vt.transition=null;try{bt=4,qt(e,t,n,r)}finally{bt=s,Vt.transition=a}}function qt(e,t,n,r){if(Wt){var s=Xt(e,t,n,r);if(null===s)Wr(e,t,r,Kt,n),Mt(e,r);else if(function(e,t,n,r,s){switch(t){case"focusin":return Et=Ft(Et,e,t,n,r,s),!0;case"dragenter":return At=Ft(At,e,t,n,r,s),!0;case"mouseover":return Rt=Ft(Rt,e,t,n,r,s),!0;case"pointerover":var a=s.pointerId;return _t.set(a,Ft(_t.get(a)||null,e,t,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,$t.set(a,Ft($t.get(a)||null,e,t,n,r,s)),!0}return!1}(s,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==s;){var a=bs(s);if(null!==a&&wt(a),null===(a=Xt(e,t,n,r))&&Wr(e,t,r,Kt,n),a===s)break;s=a}null!==s&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Kt=null;function Xt(e,t,n,r){if(Kt=null,null!==(e=vs(e=we(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,s="value"in Qt?Qt.value:Qt.textContent,a=s.length;for(e=0;e<r&&n[e]===s[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===s[a-t];t++);return Zt=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,s,a){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=sn(un),dn=L({},un,{view:0,detail:0}),hn=sn(dn),pn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),fn=sn(pn),mn=sn(L({},pn,{dataTransfer:0})),gn=sn(L({},dn,{relatedTarget:0})),yn=sn(L({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=L({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(vn),xn=sn(L({},un,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function In(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Cn(){return In}var Tn=L({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Nn=sn(Tn),En=sn(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=sn(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Rn=sn(L({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),_n=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$n=sn(_n),On=[9,13,27,32],Dn=c&&"CompositionEvent"in window,Mn=null;c&&"documentMode"in document&&(Mn=document.documentMode);var Fn=c&&"TextEvent"in window&&!Mn,Ln=c&&(!Dn||Mn&&8<Mn&&11>=Mn),Pn=String.fromCharCode(32),zn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Gn(e,t,n,r){Te(r),0<(t=Hr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,qn=null;function Kn(e){Pr(e,0)}function Xn(e){if(q(xs(e)))return e}function Yn(e,t){if("change"===e)return t}var Qn=!1;if(c){var Jn;if(c){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),qn=Hn=null)}function nr(e){if("value"===e.propertyName&&Xn(qn)){var t=[];Gn(t,qn,e,we(e)),_e(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),qn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(qn)}function ar(e,t){if("click"===e)return Xn(t)}function ir(e,t){if("input"===e||"change"===e)return Xn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!d.call(t,s)||!or(e[s],t[s]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=void 0===r.end?a:Math.min(r.end,s),!e.extend&&a>r&&(s=r,r=a,a=s),s=cr(n,a);var i=cr(n,r);s&&i&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==K(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Hr(yr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},Ir={};function Cr(e){if(Sr[e])return Sr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ir)return Sr[e]=n[t];return e}c&&(Ir=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Tr=Cr("animationend"),Nr=Cr("animationiteration"),Er=Cr("animationstart"),Ar=Cr("transitionend"),Rr=new Map,_r="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $r(e,t){Rr.set(e,t),l(t,[e])}for(var Or=0;Or<_r.length;Or++){var Dr=_r[Or];$r(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}$r(Tr,"onAnimationEnd"),$r(Nr,"onAnimationIteration"),$r(Er,"onAnimationStart"),$r("dblclick","onDoubleClick"),$r("focusin","onFocus"),$r("focusout","onBlur"),$r(Ar,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,s,i,o,l,u){if(je.apply(this,arguments),Fe){if(!Fe)throw Error(a(198));var c=Le;Fe=!1,Le=null,Pe||(Pe=!0,ze=c)}}(r,t,void 0,e),e.currentTarget=null}function Pr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;Lr(s,o,u),a=l}else for(i=0;i<r.length;i++){if(l=(o=r[i]).instance,u=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;Lr(s,o,u),a=l}}}if(Pe)throw e=ze,Pe=!1,ze=null,e}function zr(e,t){var n=t[ms];void 0===n&&(n=t[ms]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var jr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[jr]){e[jr]=!0,i.forEach((function(t){"selectionchange"!==t&&(Fr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jr]||(t[jr]=!0,Br("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Yt(t)){case 1:var s=Gt;break;case 4:s=Ht;break;default:s=qt}n=s.bind(null,t,n,e),s=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),r?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,s){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var o=r.stateNode.containerInfo;if(o===s||8===o.nodeType&&o.parentNode===s)break;if(4===i)for(i=r.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;i=i.return}for(;null!==o;){if(null===(i=vs(o)))return;if(5===(l=i.tag)||6===l){r=a=i;continue e}o=o.parentNode}}r=r.return}_e((function(){var r=a,s=we(n),i=[];e:{var o=Rr.get(e);if(void 0!==o){var l=cn,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Nn;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case Tr:case Nr:case Er:l=yn;break;case Ar:l=Rn;break;case"scroll":l=hn;break;case"wheel":l=$n;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var c=0!==(4&t),d=!c&&"scroll"===e,h=c?null!==o?o+"Capture":null:o;c=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=$e(f,h))&&c.push(Gr(f,m,p)))),d)break;f=f.return}0<c.length&&(o=new l(o,u,null,n,s),i.push({event:o,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===xe||!(u=n.relatedTarget||n.fromElement)||!vs(u)&&!u[fs])&&(l||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?vs(u):null)&&(u!==(d=Ue(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(c=En,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?o:xs(l),p=null==u?o:xs(u),(o=new c(m,f+"leave",l,n,s)).target=d,o.relatedTarget=p,m=null,vs(s)===r&&((c=new c(h,f+"enter",u,n,s)).target=p,c.relatedTarget=d,m=c),d=m,l&&u)e:{for(h=u,f=0,p=c=l;p;p=qr(p))f++;for(p=0,m=h;m;m=qr(m))p++;for(;0<f-p;)c=qr(c),f--;for(;0<p-f;)h=qr(h),p--;for(;f--;){if(c===h||null!==h&&c===h.alternate)break e;c=qr(c),h=qr(h)}c=null}else c=null;null!==l&&Kr(i,o,l,c,!1),null!==u&&null!==d&&Kr(i,d,u,c,!0)}if("select"===(l=(o=r?xs(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Yn;else if(Wn(o))if(Qn)g=ir;else{g=sr;var y=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ar);switch(g&&(g=g(e,r))?Gn(i,g,n,s):(y&&y(e,o,r),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=r?xs(r):window,e){case"focusin":(Wn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(i,n,s);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(i,n,s)}var v;if(Dn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(v=en()):(Jt="value"in(Qt=s)?Qt.value:Qt.textContent,Un=!0)),0<(y=Hr(r,b)).length&&(b=new xn(b,e,null,n,s),i.push({event:b,listeners:y}),v?b.data=v:null!==(v=jn(n))&&(b.data=v))),(v=Fn?function(e,t){switch(e){case"compositionend":return jn(t);case"keypress":return 32!==t.which?null:(zn=!0,Pn);case"textInput":return(e=t.data)===Pn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!Dn&&Bn(e,t)?(e=en(),Zt=Jt=Qt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(s=new xn("onBeforeInput","beforeinput",null,n,s),i.push({event:s,listeners:r}),s.data=v))}Pr(i,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var s=e,a=s.stateNode;5===s.tag&&null!==a&&(s=a,null!=(a=$e(e,n))&&r.unshift(Gr(e,a,s)),null!=(a=$e(e,t))&&r.push(Gr(e,a,s))),e=e.return}return r}function qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,s){for(var a=t._reactName,i=[];null!==n&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==u&&(o=u,s?null!=(l=$e(n,a))&&i.unshift(Gr(n,l,o)):s||null!=(l=$e(n,a))&&i.push(Gr(n,l,o))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Xr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Xr,"\n").replace(Yr,"")}function Jr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(a(425))}function Zr(){}var es=null,ts=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rs="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,as="function"===typeof Promise?Promise:void 0,is="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof as?function(e){return as.resolve(null).then(e).catch(os)}:rs;function os(e){setTimeout((function(){throw e}))}function ls(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===r)return e.removeChild(s),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=s}while(n);Ut(t)}function us(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function cs(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ds=Math.random().toString(36).slice(2),hs="__reactFiber$"+ds,ps="__reactProps$"+ds,fs="__reactContainer$"+ds,ms="__reactEvents$"+ds,gs="__reactListeners$"+ds,ys="__reactHandles$"+ds;function vs(e){var t=e[hs];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fs]||n[hs]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=cs(e);null!==e;){if(n=e[hs])return n;e=cs(e)}return t}n=(e=n).parentNode}return null}function bs(e){return!(e=e[hs]||e[fs])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xs(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function ws(e){return e[ps]||null}var ks=[],Ss=-1;function Is(e){return{current:e}}function Cs(e){0>Ss||(e.current=ks[Ss],ks[Ss]=null,Ss--)}function Ts(e,t){Ss++,ks[Ss]=e.current,e.current=t}var Ns={},Es=Is(Ns),As=Is(!1),Rs=Ns;function _s(e,t){var n=e.type.contextTypes;if(!n)return Ns;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s,a={};for(s in n)a[s]=t[s];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function $s(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Os(){Cs(As),Cs(Es)}function Ds(e,t,n){if(Es.current!==Ns)throw Error(a(168));Ts(Es,t),Ts(As,n)}function Ms(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var s in r=r.getChildContext())if(!(s in t))throw Error(a(108,V(e)||"Unknown",s));return L({},n,r)}function Fs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ns,Rs=Es.current,Ts(Es,e),Ts(As,As.current),!0}function Ls(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Ms(e,t,Rs),r.__reactInternalMemoizedMergedChildContext=e,Cs(As),Cs(Es),Ts(Es,e)):Cs(As),Ts(As,n)}var Ps=null,zs=!1,Bs=!1;function js(e){null===Ps?Ps=[e]:Ps.push(e)}function Us(){if(!Bs&&null!==Ps){Bs=!0;var e=0,t=bt;try{var n=Ps;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ps=null,zs=!1}catch(s){throw null!==Ps&&(Ps=Ps.slice(e+1)),qe(Ze,Us),s}finally{bt=t,Bs=!1}}return null}var Vs=[],Ws=0,Gs=null,Hs=0,qs=[],Ks=0,Xs=null,Ys=1,Qs="";function Js(e,t){Vs[Ws++]=Hs,Vs[Ws++]=Gs,Gs=e,Hs=t}function Zs(e,t,n){qs[Ks++]=Ys,qs[Ks++]=Qs,qs[Ks++]=Xs,Xs=e;var r=Ys;e=Qs;var s=32-it(r)-1;r&=~(1<<s),n+=1;var a=32-it(t)+s;if(30<a){var i=s-s%5;a=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Ys=1<<32-it(t)+s|n<<s|r,Qs=a+e}else Ys=1<<a|n<<s|r,Qs=e}function ea(e){null!==e.return&&(Js(e,1),Zs(e,1,0))}function ta(e){for(;e===Gs;)Gs=Vs[--Ws],Vs[Ws]=null,Hs=Vs[--Ws],Vs[Ws]=null;for(;e===Xs;)Xs=qs[--Ks],qs[Ks]=null,Qs=qs[--Ks],qs[Ks]=null,Ys=qs[--Ks],qs[Ks]=null}var na=null,ra=null,sa=!1,aa=null;function ia(e,t){var n=_u(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=us(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xs?{id:Ys,overflow:Qs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=_u(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ua(e){if(sa){var t=ra;if(t){var n=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=us(n.nextSibling);var r=na;t&&oa(e,t)?ia(r,n):(e.flags=-4097&e.flags|2,sa=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,sa=!1,na=e}}}function ca(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function da(e){if(e!==na)return!1;if(!sa)return ca(e),sa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=ra)){if(la(e))throw ha(),Error(a(418));for(;t;)ia(e,t),t=us(t.nextSibling)}if(ca(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=us(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?us(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ra;e;)e=us(e.nextSibling)}function pa(){ra=na=null,sa=!1}function fa(e){null===aa?aa=[e]:aa.push(e)}var ma=x.ReactCurrentBatchConfig;function ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var s=r,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=s.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ya(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function va(e){return(0,e._init)(e._payload)}function ba(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Ou(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lu(n,e.mode,r)).return=e,t):((t=s(t,n)).return=e,t)}function u(e,t,n,r){var a=n.type;return a===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===$&&va(a)===t.type)?((r=s(t,n.props)).ref=ga(e,t,n),r.return=e,r):((r=Du(n.type,n.key,n.props,null,e.mode,r)).ref=ga(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Pu(n,e.mode,r)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Mu(n,e.mode,r,a)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Du(t.type,t.key,t.props,null,e.mode,n)).ref=ga(e,null,t),n.return=e,n;case k:return(t=Pu(t,e.mode,n)).return=e,t;case $:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Mu(t,e.mode,n,null)).return=e,t;ya(e,t)}return null}function p(e,t,n,r){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===s?u(e,t,n,r):null;case k:return n.key===s?c(e,t,n,r):null;case $:return p(e,t,(s=n._init)(n._payload),r)}if(te(n)||M(n))return null!==s?null:d(e,t,n,r,null);ya(e,n)}return null}function f(e,t,n,r,s){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,s);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,s);case k:return c(t,e=e.get(null===r.key?n:r.key)||null,r,s);case $:return f(e,t,n,(0,r._init)(r._payload),s)}if(te(r)||M(r))return d(t,e=e.get(n)||null,r,s,null);ya(t,r)}return null}function m(s,a,o,l){for(var u=null,c=null,d=a,m=a=0,g=null;null!==d&&m<o.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=p(s,d,o[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(s,d),a=i(y,a,m),null===c?u=y:c.sibling=y,c=y,d=g}if(m===o.length)return n(s,d),sa&&Js(s,m),u;if(null===d){for(;m<o.length;m++)null!==(d=h(s,o[m],l))&&(a=i(d,a,m),null===c?u=d:c.sibling=d,c=d);return sa&&Js(s,m),u}for(d=r(s,d);m<o.length;m++)null!==(g=f(d,s,m,o[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),a=i(g,a,m),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach((function(e){return t(s,e)})),sa&&Js(s,m),u}function g(s,o,l,u){var c=M(l);if("function"!==typeof c)throw Error(a(150));if(null==(l=c.call(l)))throw Error(a(151));for(var d=c=null,m=o,g=o=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=p(s,m,v.value,u);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(s,m),o=i(b,o,g),null===d?c=b:d.sibling=b,d=b,m=y}if(v.done)return n(s,m),sa&&Js(s,g),c;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=h(s,v.value,u))&&(o=i(v,o,g),null===d?c=v:d.sibling=v,d=v);return sa&&Js(s,g),c}for(m=r(s,m);!v.done;g++,v=l.next())null!==(v=f(m,s,g,v.value,u))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),o=i(v,o,g),null===d?c=v:d.sibling=v,d=v);return e&&m.forEach((function(e){return t(s,e)})),sa&&Js(s,g),c}return function e(r,a,i,l){if("object"===typeof i&&null!==i&&i.type===S&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var u=i.key,c=a;null!==c;){if(c.key===u){if((u=i.type)===S){if(7===c.tag){n(r,c.sibling),(a=s(c,i.props.children)).return=r,r=a;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===$&&va(u)===c.type){n(r,c.sibling),(a=s(c,i.props)).ref=ga(r,c,i),a.return=r,r=a;break e}n(r,c);break}t(r,c),c=c.sibling}i.type===S?((a=Mu(i.props.children,r.mode,l,i.key)).return=r,r=a):((l=Du(i.type,i.key,i.props,null,r.mode,l)).ref=ga(r,a,i),l.return=r,r=l)}return o(r);case k:e:{for(c=i.key;null!==a;){if(a.key===c){if(4===a.tag&&a.stateNode.containerInfo===i.containerInfo&&a.stateNode.implementation===i.implementation){n(r,a.sibling),(a=s(a,i.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Pu(i,r.mode,l)).return=r,r=a}return o(r);case $:return e(r,a,(c=i._init)(i._payload),l)}if(te(i))return m(r,a,i,l);if(M(i))return g(r,a,i,l);ya(r,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==a&&6===a.tag?(n(r,a.sibling),(a=s(a,i)).return=r,r=a):(n(r,a),(a=Lu(i,r.mode,l)).return=r,r=a),o(r)):n(r,a)}}var xa=ba(!0),wa=ba(!1),ka=Is(null),Sa=null,Ia=null,Ca=null;function Ta(){Ca=Ia=Sa=null}function Na(e){var t=ka.current;Cs(ka),e._currentValue=t}function Ea(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Aa(e,t){Sa=e,Ca=Ia=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function Ra(e){var t=e._currentValue;if(Ca!==e)if(e={context:e,memoizedValue:t,next:null},null===Ia){if(null===Sa)throw Error(a(308));Ia=e,Sa.dependencies={lanes:0,firstContext:e}}else Ia=Ia.next=e;return t}var _a=null;function $a(e){null===_a?_a=[e]:_a.push(e)}function Oa(e,t,n,r){var s=t.interleaved;return null===s?(n.next=n,$a(t)):(n.next=s.next,s.next=n),t.interleaved=n,Da(e,r)}function Da(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ma=!1;function Fa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function La(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function za(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&El)){var s=r.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Da(e,n)}return null===(s=r.interleaved)?(t.next=t,$a(r)):(t.next=s.next,s.next=t),r.interleaved=t,Da(e,n)}function Ba(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function ja(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var s=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?s=a=i:a=a.next=i,n=n.next}while(null!==n);null===a?s=a=t:a=a.next=t}else s=a=t;return n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ua(e,t,n,r){var s=e.updateQueue;Ma=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,u=l.next;l.next=null,null===i?a=u:i.next=u,i=l;var c=e.alternate;null!==c&&((o=(c=c.updateQueue).lastBaseUpdate)!==i&&(null===o?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(null!==a){var d=s.baseState;for(i=0,c=u=l=null,o=a;;){var h=o.lane,p=o.eventTime;if((r&h)===h){null!==c&&(c=c.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=L({},d,h);break e;case 2:Ma=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(u=c=p,l=d):c=c.next=p,i|=h;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(h=o).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===c&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=c,null!==(t=s.shared.interleaved)){s=t;do{i|=s.lane,s=s.next}while(s!==t)}else null===a&&(s.shared.lanes=0);Fl|=i,e.lanes=i,e.memoizedState=d}}function Va(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(null!==s){if(r.callback=null,r=n,"function"!==typeof s)throw Error(a(191,s));s.call(r)}}}var Wa={},Ga=Is(Wa),Ha=Is(Wa),qa=Is(Wa);function Ka(e){if(e===Wa)throw Error(a(174));return e}function Xa(e,t){switch(Ts(qa,t),Ts(Ha,e),Ts(Ga,Wa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Cs(Ga),Ts(Ga,t)}function Ya(){Cs(Ga),Cs(Ha),Cs(qa)}function Qa(e){Ka(qa.current);var t=Ka(Ga.current),n=le(t,e.type);t!==n&&(Ts(Ha,e),Ts(Ga,n))}function Ja(e){Ha.current===e&&(Cs(Ga),Cs(Ha))}var Za=Is(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ni(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ri=x.ReactCurrentDispatcher,si=x.ReactCurrentBatchConfig,ai=0,ii=null,oi=null,li=null,ui=!1,ci=!1,di=0,hi=0;function pi(){throw Error(a(321))}function fi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function mi(e,t,n,r,s,i){if(ai=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ri.current=null===e||null===e.memoizedState?Ji:Zi,e=n(r,s),ci){i=0;do{if(ci=!1,di=0,25<=i)throw Error(a(301));i+=1,li=oi=null,t.updateQueue=null,ri.current=eo,e=n(r,s)}while(ci)}if(ri.current=Qi,t=null!==oi&&null!==oi.next,ai=0,li=oi=ii=null,ui=!1,t)throw Error(a(300));return e}function gi(){var e=0!==di;return di=0,e}function yi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function vi(){if(null===oi){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,oi=e;else{if(null===e)throw Error(a(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function bi(e,t){return"function"===typeof t?t(e):t}function xi(e){var t=vi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=oi,s=r.baseQueue,i=n.pending;if(null!==i){if(null!==s){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(null!==s){i=s.next,r=r.baseState;var l=o=null,u=null,c=i;do{var d=c.lane;if((ai&d)===d)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=h,o=r):u=u.next=h,ii.lanes|=d,Fl|=d}c=c.next}while(null!==c&&c!==i);null===u?o=r:u.next=l,or(r,t.memoizedState)||(bo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){s=e;do{i=s.lane,ii.lanes|=i,Fl|=i,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wi(e){var t=vi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(null!==s){n.pending=null;var o=s=s.next;do{i=e(i,o.action),o=o.next}while(o!==s);or(i,t.memoizedState)||(bo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ki(){}function Si(e,t){var n=ii,r=vi(),s=t(),i=!or(r.memoizedState,s);if(i&&(r.memoizedState=s,bo=!0),r=r.queue,Mi(Ti.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(n.flags|=2048,Ri(9,Ci.bind(null,n,r,s,t),void 0,null),null===Al)throw Error(a(349));0!==(30&ai)||Ii(n,t,s)}return s}function Ii(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ci(e,t,n,r){t.value=n,t.getSnapshot=r,Ni(t)&&Ei(e)}function Ti(e,t,n){return n((function(){Ni(t)&&Ei(e)}))}function Ni(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Ei(e){var t=Da(e,1);null!==t&&nu(t,e,1,-1)}function Ai(e){var t=yi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bi,lastRenderedState:e},t.queue=e,e=e.dispatch=qi.bind(null,ii,e),[t.memoizedState,e]}function Ri(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function _i(){return vi().memoizedState}function $i(e,t,n,r){var s=yi();ii.flags|=e,s.memoizedState=Ri(1|t,n,void 0,void 0===r?null:r)}function Oi(e,t,n,r){var s=vi();r=void 0===r?null:r;var a=void 0;if(null!==oi){var i=oi.memoizedState;if(a=i.destroy,null!==r&&fi(r,i.deps))return void(s.memoizedState=Ri(t,n,a,r))}ii.flags|=e,s.memoizedState=Ri(1|t,n,a,r)}function Di(e,t){return $i(8390656,8,e,t)}function Mi(e,t){return Oi(2048,8,e,t)}function Fi(e,t){return Oi(4,2,e,t)}function Li(e,t){return Oi(4,4,e,t)}function Pi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zi(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oi(4,4,Pi.bind(null,t,e),n)}function Bi(){}function ji(e,t){var n=vi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ui(e,t){var n=vi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fi(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Vi(e,t,n){return 0===(21&ai)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(or(n,t)||(n=mt(),ii.lanes|=n,Fl|=n,e.baseState=!0),t)}function Wi(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=si.transition;si.transition={};try{e(!1),t()}finally{bt=n,si.transition=r}}function Gi(){return vi().memoizedState}function Hi(e,t,n){var r=tu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ki(e))Xi(t,n);else if(null!==(n=Oa(e,t,n,r))){nu(n,e,r,eu()),Yi(n,t,r)}}function qi(e,t,n){var r=tu(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ki(e))Xi(t,s);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=a(i,n);if(s.hasEagerState=!0,s.eagerState=o,or(o,i)){var l=t.interleaved;return null===l?(s.next=s,$a(t)):(s.next=l.next,l.next=s),void(t.interleaved=s)}}catch(u){}null!==(n=Oa(e,t,s,r))&&(nu(n,e,r,s=eu()),Yi(n,t,r))}}function Ki(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function Xi(e,t){ci=ui=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yi(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Qi={readContext:Ra,useCallback:pi,useContext:pi,useEffect:pi,useImperativeHandle:pi,useInsertionEffect:pi,useLayoutEffect:pi,useMemo:pi,useReducer:pi,useRef:pi,useState:pi,useDebugValue:pi,useDeferredValue:pi,useTransition:pi,useMutableSource:pi,useSyncExternalStore:pi,useId:pi,unstable_isNewReconciler:!1},Ji={readContext:Ra,useCallback:function(e,t){return yi().memoizedState=[e,void 0===t?null:t],e},useContext:Ra,useEffect:Di,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,$i(4194308,4,Pi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return $i(4194308,4,e,t)},useInsertionEffect:function(e,t){return $i(4,2,e,t)},useMemo:function(e,t){var n=yi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=yi();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Hi.bind(null,ii,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},yi().memoizedState=e},useState:Ai,useDebugValue:Bi,useDeferredValue:function(e){return yi().memoizedState=e},useTransition:function(){var e=Ai(!1),t=e[0];return e=Wi.bind(null,e[1]),yi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ii,s=yi();if(sa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Al)throw Error(a(349));0!==(30&ai)||Ii(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Di(Ti.bind(null,r,i,e),[e]),r.flags|=2048,Ri(9,Ci.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=yi(),t=Al.identifierPrefix;if(sa){var n=Qs;t=":"+t+"R"+(n=(Ys&~(1<<32-it(Ys)-1)).toString(32)+n),0<(n=di++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zi={readContext:Ra,useCallback:ji,useContext:Ra,useEffect:Mi,useImperativeHandle:zi,useInsertionEffect:Fi,useLayoutEffect:Li,useMemo:Ui,useReducer:xi,useRef:_i,useState:function(){return xi(bi)},useDebugValue:Bi,useDeferredValue:function(e){return Vi(vi(),oi.memoizedState,e)},useTransition:function(){return[xi(bi)[0],vi().memoizedState]},useMutableSource:ki,useSyncExternalStore:Si,useId:Gi,unstable_isNewReconciler:!1},eo={readContext:Ra,useCallback:ji,useContext:Ra,useEffect:Mi,useImperativeHandle:zi,useInsertionEffect:Fi,useLayoutEffect:Li,useMemo:Ui,useReducer:wi,useRef:_i,useState:function(){return wi(bi)},useDebugValue:Bi,useDeferredValue:function(e){var t=vi();return null===oi?t.memoizedState=e:Vi(t,oi.memoizedState,e)},useTransition:function(){return[wi(bi)[0],vi().memoizedState]},useMutableSource:ki,useSyncExternalStore:Si,useId:Gi,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=eu(),s=tu(e),a=Pa(r,s);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=za(e,a,s))&&(nu(t,e,s,r),Ba(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=eu(),s=tu(e),a=Pa(r,s);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=za(e,a,s))&&(nu(t,e,s,r),Ba(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=eu(),r=tu(e),s=Pa(n,r);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=za(e,s,r))&&(nu(t,e,r,n),Ba(t,e,r))}};function so(e,t,n,r,s,a,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(s,a))}function ao(e,t,n){var r=!1,s=Ns,a=t.contextType;return"object"===typeof a&&null!==a?a=Ra(a):(s=$s(t)?Rs:Es.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?_s(e,s):Ns),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function io(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Fa(e);var a=t.contextType;"object"===typeof a&&null!==a?s.context=Ra(a):(a=$s(t)?Rs:Es.current,s.context=_s(e,a)),s.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(no(e,t,a,n),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&ro.enqueueReplaceState(s,s.state,null),Ua(e,n,s,r),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=j(r),r=r.return}while(r);var s=n}catch(a){s="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:s,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function co(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Pa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Gl=r),co(0,t)},n}function fo(e,t,n){(n=Pa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){co(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){co(0,t),"function"!==typeof r&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var s=new Set;r.set(t,s)}else void 0===(s=r.get(t))&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Cu.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,r,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Pa(-1,1)).tag=2,za(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var vo=x.ReactCurrentOwner,bo=!1;function xo(e,t,n,r){t.child=null===e?wa(t,null,n,r):xa(t,e.child,n,r)}function wo(e,t,n,r,s){n=n.render;var a=t.ref;return Aa(t,s),r=mi(e,t,n,r,a,s),n=gi(),null===e||bo?(sa&&n&&ea(t),t.flags|=1,xo(e,t,r,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Wo(e,t,s))}function ko(e,t,n,r,s){if(null===e){var a=n.type;return"function"!==typeof a||$u(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Du(n.type,null,r,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,So(e,t,a,r,s))}if(a=e.child,0===(e.lanes&s)){var i=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(i,r)&&e.ref===t.ref)return Wo(e,t,s)}return t.flags|=1,(e=Ou(a,r)).ref=t.ref,e.return=t,t.child=e}function So(e,t,n,r,s){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(bo=!1,t.pendingProps=r=a,0===(e.lanes&s))return t.lanes=e.lanes,Wo(e,t,s);0!==(131072&e.flags)&&(bo=!0)}}return To(e,t,n,r,s)}function Io(e,t,n){var r=t.pendingProps,s=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ts(Ol,$l),$l|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ts(Ol,$l),$l|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ts(Ol,$l),$l|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ts(Ol,$l),$l|=r;return xo(e,t,s,n),t.child}function Co(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function To(e,t,n,r,s){var a=$s(n)?Rs:Es.current;return a=_s(t,a),Aa(t,s),n=mi(e,t,n,r,a,s),r=gi(),null===e||bo?(sa&&r&&ea(t),t.flags|=1,xo(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Wo(e,t,s))}function No(e,t,n,r,s){if($s(n)){var a=!0;Fs(t)}else a=!1;if(Aa(t,s),null===t.stateNode)Vo(e,t),ao(t,n,r),oo(t,n,r,s),r=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,u=n.contextType;"object"===typeof u&&null!==u?u=Ra(u):u=_s(t,u=$s(n)?Rs:Es.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof i.getSnapshotBeforeUpdate;d||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==r||l!==u)&&io(t,i,r,u),Ma=!1;var h=t.memoizedState;i.state=h,Ua(t,r,i,s),l=t.memoizedState,o!==r||h!==l||As.current||Ma?("function"===typeof c&&(no(t,n,c,r),l=t.memoizedState),(o=Ma||so(t,n,o,r,h,l,u))?(d||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),i.props=r,i.state=l,i.context=u,r=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,La(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:to(t.type,o),i.props=u,d=t.pendingProps,h=i.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ra(l):l=_s(t,l=$s(n)?Rs:Es.current);var p=n.getDerivedStateFromProps;(c="function"===typeof p||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==d||h!==l)&&io(t,i,r,l),Ma=!1,h=t.memoizedState,i.state=h,Ua(t,r,i,s);var f=t.memoizedState;o!==d||h!==f||As.current||Ma?("function"===typeof p&&(no(t,n,p,r),f=t.memoizedState),(u=Ma||so(t,n,u,r,h,f,l)||!1)?(c||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,f,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),i.props=r,i.state=f,i.context=l,r=u):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Eo(e,t,n,r,a,s)}function Eo(e,t,n,r,s,a){Co(e,t);var i=0!==(128&t.flags);if(!r&&!i)return s&&Ls(t,n,!1),Wo(e,t,a);r=t.stateNode,vo.current=t;var o=i&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=xa(t,e.child,null,a),t.child=xa(t,null,o,a)):xo(e,t,o,a),t.memoizedState=r.state,s&&Ls(t,n,!0),t.child}function Ao(e){var t=e.stateNode;t.pendingContext?Ds(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ds(0,t.context,!1),Xa(e,t.containerInfo)}function Ro(e,t,n,r,s){return pa(),fa(s),t.flags|=256,xo(e,t,n,r),t.child}var _o,$o,Oo,Do,Mo={dehydrated:null,treeContext:null,retryLane:0};function Fo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,n){var r,s=t.pendingProps,i=Za.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ts(Za,1&i),null===e)return ua(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=s.children,e=s.fallback,o?(s=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&s)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Fu(l,s,0,null),e=Mu(e,s,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Fo(n),t.memoizedState=Mo,e):Po(t,l));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,s,i,o){if(n)return 256&t.flags?(t.flags&=-257,zo(e,t,o,r=uo(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Fu({mode:"visible",children:r.children},s,0,null),(i=Mu(i,s,o,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,0!==(1&t.mode)&&xa(t,e.child,null,o),t.child.memoizedState=Fo(o),t.memoizedState=Mo,i);if(0===(1&t.mode))return zo(e,t,o,null);if("$!"===s.data){if(r=s.nextSibling&&s.nextSibling.dataset)var l=r.dgst;return r=l,zo(e,t,o,r=uo(i=Error(a(419)),r,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(r=Al)){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(r.suspendedLanes|o))?0:s)&&s!==i.retryLane&&(i.retryLane=s,Da(e,s),nu(r,e,s,-1))}return mu(),zo(e,t,o,r=uo(Error(a(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Nu.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,ra=us(s.nextSibling),na=t,sa=!0,aa=null,null!==e&&(qs[Ks++]=Ys,qs[Ks++]=Qs,qs[Ks++]=Xs,Ys=e.id,Qs=e.overflow,Xs=t),t=Po(t,r.children),t.flags|=4096,t)}(e,t,l,s,r,i,n);if(o){o=s.fallback,l=t.mode,r=(i=e.child).sibling;var u={mode:"hidden",children:s.children};return 0===(1&l)&&t.child!==i?((s=t.child).childLanes=0,s.pendingProps=u,t.deletions=null):(s=Ou(i,u)).subtreeFlags=14680064&i.subtreeFlags,null!==r?o=Ou(r,o):(o=Mu(o,l,n,null)).flags|=2,o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,l=null===(l=e.child.memoizedState)?Fo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Mo,s}return e=(o=e.child).sibling,s=Ou(o,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Po(e,t){return(t=Fu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zo(e,t,n,r){return null!==r&&fa(r),xa(t,e.child,null,n),(e=Po(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ea(e.return,t,n)}function jo(e,t,n,r,s){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function Uo(e,t,n){var r=t.pendingProps,s=r.revealOrder,a=r.tail;if(xo(e,t,r.children,n),0!==(2&(r=Za.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bo(e,n,t);else if(19===e.tag)Bo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ts(Za,r),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===ei(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),jo(t,!1,s,n,a);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ei(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}jo(t,!0,n,null,a);break;case"together":jo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Ou(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ou(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!sa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ho(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=14680064&s.subtreeFlags,r|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function qo(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ho(t),null;case 1:case 17:return $s(t.type)&&Os(),Ho(t),null;case 3:return r=t.stateNode,Ya(),Cs(As),Cs(Es),ni(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(da(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(iu(aa),aa=null))),$o(e,t),Ho(t),null;case 5:Ja(t);var s=Ka(qa.current);if(n=t.type,null!==e&&null!=t.stateNode)Oo(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Ho(t),null}if(e=Ka(Ga.current),da(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[hs]=t,r[ps]=i,e=0!==(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(s=0;s<Mr.length;s++)zr(Mr[s],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":Y(r,i),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},zr("invalid",r);break;case"textarea":se(r,i),zr("invalid",r)}for(var l in ve(n,i),s=null,i)if(i.hasOwnProperty(l)){var u=i[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==i.suppressHydrationWarning&&Jr(r.textContent,u,e),s=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==i.suppressHydrationWarning&&Jr(r.textContent,u,e),s=["children",""+u]):o.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&zr("scroll",r)}switch(n){case"input":H(r),Z(r,i,!0);break;case"textarea":H(r),ie(r);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(r.onclick=Zr)}r=s,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hs]=t,e[ps]=r,_o(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":zr("cancel",e),zr("close",e),s=r;break;case"iframe":case"object":case"embed":zr("load",e),s=r;break;case"video":case"audio":for(s=0;s<Mr.length;s++)zr(Mr[s],e);s=r;break;case"source":zr("error",e),s=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),s=r;break;case"details":zr("toggle",e),s=r;break;case"input":Y(e,r),s=X(e,r),zr("invalid",e);break;case"option":default:s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=L({},r,{value:void 0}),zr("invalid",e);break;case"textarea":se(e,r),s=re(e,r),zr("invalid",e)}for(i in ve(n,s),u=s)if(u.hasOwnProperty(i)){var c=u[i];"style"===i?ge(e,c):"dangerouslySetInnerHTML"===i?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===i?"string"===typeof c?("textarea"!==n||""!==c)&&he(e,c):"number"===typeof c&&he(e,""+c):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=c&&"onScroll"===i&&zr("scroll",e):null!=c&&b(e,i,c,l))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),ie(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ne(e,!!r.multiple,i,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ho(t),null;case 6:if(e&&null!=t.stateNode)Do(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Ka(qa.current),Ka(Ga.current),da(t)){if(r=t.stateNode,n=t.memoizedProps,r[hs]=t,(i=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hs]=t,t.stateNode=r}return Ho(t),null;case 13:if(Cs(Za),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(sa&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))ha(),pa(),t.flags|=98560,i=!1;else if(i=da(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[hs]=t}else pa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ho(t),i=!1}else null!==aa&&(iu(aa),aa=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Za.current)?0===Dl&&(Dl=3):mu())),null!==t.updateQueue&&(t.flags|=4),Ho(t),null);case 4:return Ya(),$o(e,t),null===e&&Ur(t.stateNode.containerInfo),Ho(t),null;case 10:return Na(t.type._context),Ho(t),null;case 19:if(Cs(Za),null===(i=t.memoizedState))return Ho(t),null;if(r=0!==(128&t.flags),null===(l=i.rendering))if(r)Go(i,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,Go(i,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ts(Za,1&Za.current|2),t.child}e=e.sibling}null!==i.tail&&Qe()>Ul&&(t.flags|=128,r=!0,Go(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ei(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!sa)return Ho(t),null}else 2*Qe()-i.renderingStartTime>Ul&&1073741824!==n&&(t.flags|=128,r=!0,Go(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Qe(),t.sibling=null,n=Za.current,Ts(Za,r?1&n|2:1&n),t):(Ho(t),null);case 22:case 23:return du(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&$l)&&(Ho(t),6&t.subtreeFlags&&(t.flags|=8192)):Ho(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Ko(e,t){switch(ta(t),t.tag){case 1:return $s(t.type)&&Os(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ya(),Cs(As),Cs(Es),ni(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ja(t),null;case 13:if(Cs(Za),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));pa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Cs(Za),null;case 4:return Ya(),null;case 10:return Na(t.type._context),null;case 22:case 23:return du(),null;default:return null}}_o=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},$o=function(){},Oo=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Ka(Ga.current);var a,i=null;switch(n){case"input":s=X(e,s),r=X(e,r),i=[];break;case"select":s=L({},s,{value:void 0}),r=L({},r,{value:void 0}),i=[];break;case"textarea":s=re(e,s),r=re(e,r),i=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(c in ve(n,r),n=null,s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&null!=s[c])if("style"===c){var l=s[c];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(o.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=s?s[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(i=i||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(i=i||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(o.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&zr("scroll",e),i||l===u||(i=[])):(i=i||[]).push(c,u))}n&&(i=i||[]).push("style",n);var c=i;(t.updateQueue=c)&&(t.flags|=4)}},Do=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xo=!1,Yo=!1,Qo="function"===typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Iu(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Iu(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var s=r=r.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,void 0!==a&&el(t,n,a)}s=s.next}while(s!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hs],delete t[ps],delete t[ms],delete t[gs],delete t[ys])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var cl=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(st,n)}catch(o){}switch(n.tag){case 5:Yo||Zo(n,t);case 6:var r=cl,s=dl;cl=null,hl(e,t,n),dl=s,null!==(cl=r)&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?ls(e.parentNode,n):1===e.nodeType&&ls(e,n),Ut(e)):ls(cl,n.stateNode));break;case 4:r=cl,s=dl,cl=n.stateNode.containerInfo,dl=!0,hl(e,t,n),cl=r,dl=s;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){s=r=r.next;do{var a=s,i=a.destroy;a=a.tag,void 0!==i&&(0!==(2&a)||0!==(4&a))&&el(n,t,i),s=s.next}while(s!==r)}hl(e,t,n);break;case 1:if(!Yo&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Iu(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Yo=(r=Yo)||null!==n.memoizedState,hl(e,t,n),Yo=r):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qo),t.forEach((function(t){var r=Eu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,dl=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===cl)throw Error(a(160));pl(i,o,s),cl=null,dl=!1;var u=s.alternate;null!==u&&(u.return=null),s.return=null}catch(c){Iu(s,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Iu(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Iu(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(g){Iu(e,e.return,g)}}if(4&r&&null!=(s=e.stateNode)){var i=e.memoizedProps,o=null!==n?n.memoizedProps:i,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===i.type&&null!=i.name&&Q(s,i),be(l,o);var c=be(l,i);for(o=0;o<u.length;o+=2){var d=u[o],h=u[o+1];"style"===d?ge(s,h):"dangerouslySetInnerHTML"===d?de(s,h):"children"===d?he(s,h):b(s,d,h,c)}switch(l){case"input":J(s,i);break;case"textarea":ae(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?ne(s,!!i.multiple,f,!1):p!==!!i.multiple&&(null!=i.defaultValue?ne(s,!!i.multiple,i.defaultValue,!0):ne(s,!!i.multiple,i.multiple?[]:"",!1))}s[ps]=i}catch(g){Iu(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(a(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(g){Iu(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(g){Iu(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(s=e.child).flags&&(i=null!==s.memoizedState,s.stateNode.isHidden=i,!i||null!==s.alternate&&null!==s.alternate.memoizedState||(jl=Qe())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(c=Yo)||d,ml(t,e),Yo=c):ml(t,e),yl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&0!==(1&e.mode))for(Jo=e,d=e.child;null!==d;){for(h=Jo=d;null!==Jo;){switch(f=(p=Jo).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Zo(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Iu(r,n,g)}}break;case 5:Zo(p,p.return);break;case 22:if(null!==p.memoizedState){wl(h);continue}}null!==f?(f.return=p,Jo=f):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{s=h.stateNode,c?"function"===typeof(i=s.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,o=void 0!==(u=h.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",o))}catch(g){Iu(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){Iu(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),yl(e),4&r&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(il(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var s=r.stateNode;32&r.flags&&(he(s,""),r.flags&=-33),ul(e,ol(e),s);break;case 3:case 4:var i=r.stateNode.containerInfo;ll(e,ol(e),i);break;default:throw Error(a(161))}}catch(o){Iu(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Jo=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Jo;){var s=Jo,a=s.child;if(22===s.tag&&r){var i=null!==s.memoizedState||Xo;if(!i){var o=s.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Xo;var u=Yo;if(Xo=i,(Yo=l)&&!u)for(Jo=s;null!==Jo;)l=(i=Jo).child,22===i.tag&&null!==i.memoizedState?kl(s):null!==l?(l.return=i,Jo=l):kl(s);for(;null!==a;)Jo=a,bl(a,t,n),a=a.sibling;Jo=s,Xo=o,Yo=u}xl(e)}else 0!==(8772&s.subtreeFlags)&&null!==a?(a.return=s,Jo=a):xl(e)}}function xl(e){for(;null!==Jo;){var t=Jo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Yo)if(null===n)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Va(t,i,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Va(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Ut(h)}}}break;default:throw Error(a(163))}Yo||512&t.flags&&sl(t)}catch(p){Iu(t,t.return,p)}}if(t===e){Jo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Jo=n;break}Jo=t.return}}function wl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Jo=n;break}Jo=t.return}}function kl(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Iu(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var s=t.return;try{r.componentDidMount()}catch(l){Iu(t,s,l)}}var a=t.return;try{sl(t)}catch(l){Iu(t,a,l)}break;case 5:var i=t.return;try{sl(t)}catch(l){Iu(t,i,l)}}}catch(l){Iu(t,t.return,l)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var Sl,Il=Math.ceil,Cl=x.ReactCurrentDispatcher,Tl=x.ReactCurrentOwner,Nl=x.ReactCurrentBatchConfig,El=0,Al=null,Rl=null,_l=0,$l=0,Ol=Is(0),Dl=0,Ml=null,Fl=0,Ll=0,Pl=0,zl=null,Bl=null,jl=0,Ul=1/0,Vl=null,Wl=!1,Gl=null,Hl=null,ql=!1,Kl=null,Xl=0,Yl=0,Ql=null,Jl=-1,Zl=0;function eu(){return 0!==(6&El)?Qe():-1!==Jl?Jl:Jl=Qe()}function tu(e){return 0===(1&e.mode)?1:0!==(2&El)&&0!==_l?_l&-_l:null!==ma.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nu(e,t,n,r){if(50<Yl)throw Yl=0,Ql=null,Error(a(185));yt(e,n,r),0!==(2&El)&&e===Al||(e===Al&&(0===(2&El)&&(Ll|=n),4===Dl&&ou(e,_l)),ru(e,r),1===n&&0===El&&0===(1&t.mode)&&(Ul=Qe()+500,zs&&Us()))}function ru(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-it(a),o=1<<i,l=s[i];-1===l?0!==(o&n)&&0===(o&r)||(s[i]=pt(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var r=ht(e,e===Al?_l:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){zs=!0,js(e)}(lu.bind(null,e)):js(lu.bind(null,e)),is((function(){0===(6&El)&&Us()})),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Au(n,su.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function su(e,t){if(Jl=-1,Zl=0,0!==(6&El))throw Error(a(327));var n=e.callbackNode;if(ku()&&e.callbackNode!==n)return null;var r=ht(e,e===Al?_l:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gu(e,r);else{t=r;var s=El;El|=2;var i=fu();for(Al===e&&_l===t||(Vl=null,Ul=Qe()+500,hu(e,t));;)try{vu();break}catch(l){pu(e,l)}Ta(),Cl.current=i,El=s,null!==Rl?t=0:(Al=null,_l=0,t=Dl)}if(0!==t){if(2===t&&(0!==(s=ft(e))&&(r=s,t=au(e,s))),1===t)throw n=Ml,hu(e,0),ou(e,r),ru(e,Qe()),n;if(6===t)ou(e,r);else{if(s=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!or(a(),s))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=gu(e,r))&&(0!==(i=ft(e))&&(r=i,t=au(e,i))),1===t))throw n=Ml,hu(e,0),ou(e,r),ru(e,Qe()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:wu(e,Bl,Vl);break;case 3:if(ou(e,r),(130023424&r)===r&&10<(t=jl+500-Qe())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&r)!==r){eu(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=rs(wu.bind(null,e,Bl,Vl),t);break}wu(e,Bl,Vl);break;case 4:if(ou(e,r),(4194240&r)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-it(r);i=1<<o,(o=t[o])>s&&(s=o),r&=~i}if(r=s,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Il(r/1960))-r)){e.timeoutHandle=rs(wu.bind(null,e,Bl,Vl),r);break}wu(e,Bl,Vl);break;default:throw Error(a(329))}}}return ru(e,Qe()),e.callbackNode===n?su.bind(null,e):null}function au(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(hu(e,t).flags|=256),2!==(e=gu(e,t))&&(t=Bl,Bl=n,null!==t&&iu(t)),e}function iu(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function ou(e,t){for(t&=~Pl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function lu(e){if(0!==(6&El))throw Error(a(327));ku();var t=ht(e,0);if(0===(1&t))return ru(e,Qe()),null;var n=gu(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=au(e,r))}if(1===n)throw n=Ml,hu(e,0),ou(e,t),ru(e,Qe()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wu(e,Bl,Vl),ru(e,Qe()),null}function uu(e,t){var n=El;El|=1;try{return e(t)}finally{0===(El=n)&&(Ul=Qe()+500,zs&&Us())}}function cu(e){null!==Kl&&0===Kl.tag&&0===(6&El)&&ku();var t=El;El|=1;var n=Nl.transition,r=bt;try{if(Nl.transition=null,bt=1,e)return e()}finally{bt=r,Nl.transition=n,0===(6&(El=t))&&Us()}}function du(){$l=Ol.current,Cs(Ol)}function hu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ss(n)),null!==Rl)for(n=Rl.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Os();break;case 3:Ya(),Cs(As),Cs(Es),ni();break;case 5:Ja(r);break;case 4:Ya();break;case 13:case 19:Cs(Za);break;case 10:Na(r.type._context);break;case 22:case 23:du()}n=n.return}if(Al=e,Rl=e=Ou(e.current,null),_l=$l=t,Dl=0,Ml=null,Pl=Ll=Fl=0,Bl=zl=null,null!==_a){for(t=0;t<_a.length;t++)if(null!==(r=(n=_a[t]).interleaved)){n.interleaved=null;var s=r.next,a=n.pending;if(null!==a){var i=a.next;a.next=s,r.next=i}n.pending=r}_a=null}return e}function pu(e,t){for(;;){var n=Rl;try{if(Ta(),ri.current=Qi,ui){for(var r=ii.memoizedState;null!==r;){var s=r.queue;null!==s&&(s.pending=null),r=r.next}ui=!1}if(ai=0,li=oi=ii=null,ci=!1,di=0,Tl.current=null,null===n||null===n.return){Dl=1,Ml=t,Rl=null;break}e:{var i=e,o=n.return,l=n,u=t;if(t=_l,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=go(o);if(null!==f){f.flags&=-257,yo(f,o,l,0,t),1&f.mode&&mo(i,c,t),u=c;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(0===(1&t)){mo(i,c,t),mu();break e}u=Error(a(426))}else if(sa&&1&l.mode){var y=go(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),yo(y,o,l,0,t),fa(lo(u,l));break e}}i=u=lo(u,l),4!==Dl&&(Dl=2),null===zl?zl=[i]:zl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,ja(i,po(0,u,t));break e;case 1:l=u;var v=i.type,b=i.stateNode;if(0===(128&i.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Hl||!Hl.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,ja(i,fo(i,l,t));break e}}i=i.return}while(null!==i)}xu(n)}catch(x){t=x,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function fu(){var e=Cl.current;return Cl.current=Qi,null===e?Qi:e}function mu(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Al||0===(268435455&Fl)&&0===(268435455&Ll)||ou(Al,_l)}function gu(e,t){var n=El;El|=2;var r=fu();for(Al===e&&_l===t||(Vl=null,hu(e,t));;)try{yu();break}catch(s){pu(e,s)}if(Ta(),El=n,Cl.current=r,null!==Rl)throw Error(a(261));return Al=null,_l=0,Dl}function yu(){for(;null!==Rl;)bu(Rl)}function vu(){for(;null!==Rl&&!Xe();)bu(Rl)}function bu(e){var t=Sl(e.alternate,e,$l);e.memoizedProps=e.pendingProps,null===t?xu(e):Rl=t,Tl.current=null}function xu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=qo(n,t,$l)))return void(Rl=n)}else{if(null!==(n=Ko(n,t)))return n.flags&=32767,void(Rl=n);if(null===e)return Dl=6,void(Rl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rl=t);Rl=t=e}while(null!==t);0===Dl&&(Dl=5)}function wu(e,t,n){var r=bt,s=Nl.transition;try{Nl.transition=null,bt=1,function(e,t,n,r){do{ku()}while(null!==Kl);if(0!==(6&El))throw Error(a(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-it(n),a=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~a}}(e,i),e===Al&&(Rl=Al=null,_l=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||ql||(ql=!0,Au(tt,(function(){return ku(),null}))),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=Nl.transition,Nl.transition=null;var o=bt;bt=1;var l=El;El|=4,Tl.current=null,function(e,t){if(es=Wt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(w){n=null;break e}var o=0,l=-1,u=-1,c=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==s&&3!==h.nodeType||(l=o+s),h!==i||0!==r&&3!==h.nodeType||(u=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++c===s&&(l=o),p===i&&++d===r&&(u=o),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ts={focusedElem:e,selectionRange:n},Wt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(a(163))}}catch(w){Iu(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}m=tl,tl=!1}(e,n),gl(n,e),fr(ts),Wt=!!es,ts=es=null,e.current=n,vl(n,e,s),Ye(),El=l,bt=o,Nl.transition=i}else e.current=n;if(ql&&(ql=!1,Kl=e,Xl=s),i=e.pendingLanes,0===i&&(Hl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ru(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Wl)throw Wl=!1,e=Gl,Gl=null,e;0!==(1&Xl)&&0!==e.tag&&ku(),i=e.pendingLanes,0!==(1&i)?e===Ql?Yl++:(Yl=0,Ql=e):Yl=0,Us()}(e,t,n,r)}finally{Nl.transition=s,bt=r}return null}function ku(){if(null!==Kl){var e=xt(Xl),t=Nl.transition,n=bt;try{if(Nl.transition=null,bt=16>e?16:e,null===Kl)var r=!1;else{if(e=Kl,Kl=null,Xl=0,0!==(6&El))throw Error(a(331));var s=El;for(El|=4,Jo=e.current;null!==Jo;){var i=Jo,o=i.child;if(0!==(16&Jo.flags)){var l=i.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Jo=c;null!==Jo;){var d=Jo;switch(d.tag){case 0:case 11:case 15:nl(8,d,i)}var h=d.child;if(null!==h)h.return=d,Jo=h;else for(;null!==Jo;){var p=(d=Jo).sibling,f=d.return;if(al(d),d===c){Jo=null;break}if(null!==p){p.return=f,Jo=p;break}Jo=f}}}var m=i.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Jo=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Jo=o;else e:for(;null!==Jo;){if(0!==(2048&(i=Jo).flags))switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var v=i.sibling;if(null!==v){v.return=i.return,Jo=v;break e}Jo=i.return}}var b=e.current;for(Jo=b;null!==Jo;){var x=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Jo=x;else e:for(o=b;null!==Jo;){if(0!==(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(k){Iu(l,l.return,k)}if(l===o){Jo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Jo=w;break e}Jo=l.return}}if(El=s,Us(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(st,e)}catch(k){}r=!0}return r}finally{bt=n,Nl.transition=t}}return!1}function Su(e,t,n){e=za(e,t=po(0,t=lo(n,t),1),1),t=eu(),null!==e&&(yt(e,1,t),ru(e,t))}function Iu(e,t,n){if(3===e.tag)Su(e,e,n);else for(;null!==t;){if(3===t.tag){Su(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Hl||!Hl.has(r))){t=za(t,e=fo(t,e=lo(n,e),1),1),e=eu(),null!==t&&(yt(t,1,e),ru(t,e));break}}t=t.return}}function Cu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=eu(),e.pingedLanes|=e.suspendedLanes&n,Al===e&&(_l&n)===n&&(4===Dl||3===Dl&&(130023424&_l)===_l&&500>Qe()-jl?hu(e,0):Pl|=n),ru(e,t)}function Tu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=eu();null!==(e=Da(e,t))&&(yt(e,t,n),ru(e,n))}function Nu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tu(e,n)}function Eu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Tu(e,n)}function Au(e,t){return qe(e,t)}function Ru(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _u(e,t,n,r){return new Ru(e,t,n,r)}function $u(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ou(e,t){var n=e.alternate;return null===n?((n=_u(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Du(e,t,n,r,s,i){var o=2;if(r=e,"function"===typeof e)$u(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Mu(n.children,s,i,t);case I:o=8,s|=8;break;case C:return(e=_u(12,n,t,2|s)).elementType=C,e.lanes=i,e;case A:return(e=_u(13,n,t,s)).elementType=A,e.lanes=i,e;case R:return(e=_u(19,n,t,s)).elementType=R,e.lanes=i,e;case O:return Fu(n,s,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:o=10;break e;case N:o=9;break e;case E:o=11;break e;case _:o=14;break e;case $:o=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=_u(o,n,t,s)).elementType=e,t.type=r,t.lanes=i,t}function Mu(e,t,n,r){return(e=_u(7,e,r,t)).lanes=n,e}function Fu(e,t,n,r){return(e=_u(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Lu(e,t,n){return(e=_u(6,e,null,t)).lanes=n,e}function Pu(e,t,n){return(t=_u(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zu(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Bu(e,t,n,r,s,a,i,o,l){return e=new zu(e,t,n,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=_u(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fa(a),e}function ju(e){if(!e)return Ns;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if($s(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if($s(n))return Ms(e,n,t)}return t}function Uu(e,t,n,r,s,a,i,o,l){return(e=Bu(n,r,!0,e,0,a,0,o,l)).context=ju(null),n=e.current,(a=Pa(r=eu(),s=tu(n))).callback=void 0!==t&&null!==t?t:null,za(n,a,s),e.current.lanes=s,yt(e,s,r),ru(e,r),e}function Vu(e,t,n,r){var s=t.current,a=eu(),i=tu(s);return n=ju(n),null===t.context?t.context=n:t.pendingContext=n,(t=Pa(a,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=za(s,t,i))&&(nu(e,s,i,a),Ba(e,s,i)),i}function Wu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hu(e,t){Gu(e,t),(e=e.alternate)&&Gu(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||As.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Ao(t),pa();break;case 5:Qa(t);break;case 1:$s(t.type)&&Fs(t);break;case 4:Xa(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Ts(ka,r._currentValue),r._currentValue=s;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ts(Za,1&Za.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Lo(e,t,n):(Ts(Za,1&Za.current),null!==(e=Wo(e,t,n))?e.sibling:null);Ts(Za,1&Za.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Uo(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ts(Za,Za.current),r)break;return null;case 22:case 23:return t.lanes=0,Io(e,t,n)}return Wo(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,sa&&0!==(1048576&t.flags)&&Zs(t,Hs,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vo(e,t),e=t.pendingProps;var s=_s(t,Es.current);Aa(t,n),s=mi(null,t,r,e,s,n);var i=gi();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,$s(r)?(i=!0,Fs(t)):i=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Fa(t),s.updater=ro,t.stateNode=s,s._reactInternals=t,oo(t,r,e,n),t=Eo(null,t,r,!0,i,n)):(t.tag=0,sa&&i&&ea(t),xo(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vo(e,t),e=t.pendingProps,r=(s=r._init)(r._payload),t.type=r,s=t.tag=function(e){if("function"===typeof e)return $u(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===_)return 14}return 2}(r),e=to(r,e),s){case 0:t=To(null,t,r,e,n);break e;case 1:t=No(null,t,r,e,n);break e;case 11:t=wo(null,t,r,e,n);break e;case 14:t=ko(null,t,r,to(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,To(e,t,r,s=t.elementType===r?s:to(r,s),n);case 1:return r=t.type,s=t.pendingProps,No(e,t,r,s=t.elementType===r?s:to(r,s),n);case 3:e:{if(Ao(t),null===e)throw Error(a(387));r=t.pendingProps,s=(i=t.memoizedState).element,La(e,t),Ua(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ro(e,t,r,n,s=lo(Error(a(423)),t));break e}if(r!==s){t=Ro(e,t,r,n,s=lo(Error(a(424)),t));break e}for(ra=us(t.stateNode.containerInfo.firstChild),na=t,sa=!0,aa=null,n=wa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pa(),r===s){t=Wo(e,t,n);break e}xo(e,t,r,n)}t=t.child}return t;case 5:return Qa(t),null===e&&ua(t),r=t.type,s=t.pendingProps,i=null!==e?e.memoizedProps:null,o=s.children,ns(r,s)?o=null:null!==i&&ns(r,i)&&(t.flags|=32),Co(e,t),xo(e,t,o,n),t.child;case 6:return null===e&&ua(t),null;case 13:return Lo(e,t,n);case 4:return Xa(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=xa(t,null,r,n):xo(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,wo(e,t,r,s=t.elementType===r?s:to(r,s),n);case 7:return xo(e,t,t.pendingProps,n),t.child;case 8:case 12:return xo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Ts(ka,r._currentValue),r._currentValue=o,null!==i)if(or(i.value,o)){if(i.children===s.children&&!As.current){t=Wo(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===i.tag){(u=Pa(-1,n&-n)).tag=2;var c=i.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=n,null!==(u=i.alternate)&&(u.lanes|=n),Ea(i.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ea(o,n,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}xo(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Aa(t,n),r=r(s=Ra(s)),t.flags|=1,xo(e,t,r,n),t.child;case 14:return s=to(r=t.type,t.pendingProps),ko(e,t,r,s=to(r.type,s),n);case 15:return So(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:to(r,s),Vo(e,t),t.tag=1,$s(r)?(e=!0,Fs(t)):e=!1,Aa(t,n),ao(t,r,s),oo(t,r,s,n),Eo(null,t,r,!0,e,n);case 19:return Uo(e,t,n);case 22:return Io(e,t,n)}throw Error(a(156,t.tag))};var qu="function"===typeof reportError?reportError:function(e){console.error(e)};function Ku(e){this._internalRoot=e}function Xu(e){this._internalRoot=e}function Yu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Ju(){}function Zu(e,t,n,r,s){var a=n._reactRootContainer;if(a){var i=a;if("function"===typeof s){var o=s;s=function(){var e=Wu(i);o.call(e)}}Vu(t,i,e,s)}else i=function(e,t,n,r,s){if(s){if("function"===typeof r){var a=r;r=function(){var e=Wu(i);a.call(e)}}var i=Uu(t,r,e,0,null,!1,0,"",Ju);return e._reactRootContainer=i,e[fs]=i.current,Ur(8===e.nodeType?e.parentNode:e),cu(),i}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof r){var o=r;r=function(){var e=Wu(l);o.call(e)}}var l=Bu(e,0,!1,null,0,!1,0,"",Ju);return e._reactRootContainer=l,e[fs]=l.current,Ur(8===e.nodeType?e.parentNode:e),cu((function(){Vu(t,l,n,r)})),l}(n,t,e,s,r);return Wu(i)}Xu.prototype.render=Ku.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Vu(e,t,null,null)},Xu.prototype.unmount=Ku.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cu((function(){Vu(null,e,null,null)})),t[fs]=null}},Xu.prototype.unstable_scheduleHydration=function(e){if(e){var t=It();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),ru(t,Qe()),0===(6&El)&&(Ul=Qe()+500,Us()))}break;case 13:cu((function(){var t=Da(e,1);if(null!==t){var n=eu();nu(t,e,1,n)}})),Hu(e,1)}},kt=function(e){if(13===e.tag){var t=Da(e,134217728);if(null!==t)nu(t,e,134217728,eu());Hu(e,134217728)}},St=function(e){if(13===e.tag){var t=tu(e),n=Da(e,t);if(null!==n)nu(n,e,t,eu());Hu(e,t)}},It=function(){return bt},Ct=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=ws(r);if(!s)throw Error(a(90));q(r),J(r,s)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=uu,Ae=cu;var ec={usingClientEntryPoint:!1,Events:[bs,xs,ws,Te,Ne,uu]},tc={findFiberByHostInstance:vs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nc={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{st=rc.inject(nc),at=rc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yu(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yu(e))throw Error(a(299));var n=!1,r="",s=qu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=Bu(e,1,!1,null,0,n,0,r,s),e[fs]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Ku(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return cu(e)},t.hydrate=function(e,t,n){if(!Qu(t))throw Error(a(200));return Zu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yu(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,s=!1,i="",o=qu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Uu(t,null,e,1,null!=n?n:null,s,0,i,o),e[fs]=t.current,Ur(e),r)for(e=0;e<r.length;e++)s=(s=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Xu(t)},t.render=function(e,t,n){if(!Qu(t))throw Error(a(200));return Zu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qu(e))throw Error(a(40));return!!e._reactRootContainer&&(cu((function(){Zu(null,null,e,!1,(function(){e._reactRootContainer=null,e[fs]=null}))})),!0)},t.unstable_batchedUpdates=uu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Qu(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Zu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},3174:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalStyles:()=>k.A,StyledEngineProvider:()=>w,ThemeContext:()=>s.T,css:()=>y.AH,default:()=>S,internal_processStyles:()=>I,keyframes:()=>y.i7});var r=n(8168),s=n(9369),a=n(6598),i=n(9436),o=n(1722),l=n(5043),u=n(918),c=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,d=(0,u.A)((function(e){return c.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),h=function(e){return"theme"!==e},p=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?d:h},f=function(e,t,n){var r;if(t){var s=t.shouldForwardProp;r=e.__emotion_forwardProp&&s?function(t){return e.__emotion_forwardProp(t)&&s(t)}:s}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},m=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return(0,o.SF)(t,n,r),(0,i.s)((function(){return(0,o.sk)(t,n,r)})),null},g=function e(t,n){var i,u,c=t.__emotion_real===t,d=c&&t.__emotion_base||t;void 0!==n&&(i=n.label,u=n.target);var h=f(t,n,c),g=h||p(d),y=!g("as");return function(){var v=arguments,b=c&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&b.push("label:"+i+";"),null==v[0]||void 0===v[0].raw)b.push.apply(b,v);else{var x=v[0];b.push(x[0]);for(var w=v.length,k=1;k<w;k++)b.push(v[k],x[k])}var S=(0,s.w)((function(e,t,n){var r=y&&e.as||d,i="",c=[],f=e;if(null==e.theme){for(var v in f={},e)f[v]=e[v];f.theme=l.useContext(s.T)}"string"===typeof e.className?i=(0,o.Rk)(t.registered,c,e.className):null!=e.className&&(i=e.className+" ");var x=(0,a.J)(b.concat(c),t.registered,f);i+=t.key+"-"+x.name,void 0!==u&&(i+=" "+u);var w=y&&void 0===h?p(r):g,k={};for(var S in e)y&&"as"===S||w(S)&&(k[S]=e[S]);return k.className=i,n&&(k.ref=n),l.createElement(l.Fragment,null,l.createElement(m,{cache:t,serialized:x,isStringTag:"string"===typeof r}),l.createElement(r,k))}));return S.displayName=void 0!==i?i:"Styled("+("string"===typeof d?d:d.displayName||d.name||"Component")+")",S.defaultProps=t.defaultProps,S.__emotion_real=S,S.__emotion_base=d,S.__emotion_styles=b,S.__emotion_forwardProp=h,Object.defineProperty(S,"toString",{value:function(){return"."+u}}),S.withComponent=function(t,s){return e(t,(0,r.A)({},n,s,{shouldForwardProp:f(S,s,!0)})).apply(void 0,b)},S}}.bind(null);["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){g[e]=g(e)}));var y=n(3290),v=n(3803),b=n(579);let x;function w(e){const{injectFirst:t,children:n}=e;return t&&x?(0,b.jsx)(s.C,{value:x,children:n}):n}"object"===typeof document&&(x=(0,v.A)({key:"css",prepend:!0}));var k=n(869);function S(e,t){return g(e,t)}const I=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}},3234:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A,extendSxProp:()=>s.A,unstable_createStyleFunctionSx:()=>r.k,unstable_defaultSxConfig:()=>a.A});var r=n(8812),s=n(8698),a=n(7758)},3290:(e,t,n)=>{"use strict";n.d(t,{AH:()=>c,i7:()=>d,mL:()=>u});var r=n(9369),s=n(5043),a=n(1722),i=n(9436),o=n(6598),l=(n(3803),n(219),function(e,t){var n=arguments;if(null==t||!r.h.call(t,"css"))return s.createElement.apply(void 0,n);var a=n.length,i=new Array(a);i[0]=r.E,i[1]=(0,r.c)(e,t);for(var o=2;o<a;o++)i[o]=n[o];return s.createElement.apply(null,i)});!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(l||(l={}));var u=(0,r.w)((function(e,t){var n=e.styles,l=(0,o.J)([n],void 0,s.useContext(r.T)),u=s.useRef();return(0,i.i)((function(){var e=t.key+"-global",n=new t.sheet.constructor({key:e,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),r=!1,s=document.querySelector('style[data-emotion="'+e+" "+l.name+'"]');return t.sheet.tags.length&&(n.before=t.sheet.tags[0]),null!==s&&(r=!0,s.setAttribute("data-emotion",e),n.hydrate([s])),u.current=[n,r],function(){n.flush()}}),[t]),(0,i.i)((function(){var e=u.current,n=e[0];if(e[1])e[1]=!1;else{if(void 0!==l.next&&(0,a.sk)(t,l.next,!0),n.tags.length){var r=n.tags[n.tags.length-1].nextElementSibling;n.before=r,n.flush()}t.insert("",l,n,!1)}}),[t,l.name]),null}));function c(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,o.J)(t)}function d(){var e=c.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}},3382:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l,getFunctionName:()=>a});var r=n(528);const s=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function a(e){const t=`${e}`.match(s);return t&&t[1]||""}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.displayName||e.name||a(e)||t}function o(e,t,n){const r=i(t);return e.displayName||(""!==r?`${n}(${r})`:n)}function l(e){if(null!=e){if("string"===typeof e)return e;if("function"===typeof e)return i(e,"Component");if("object"===typeof e)switch(e.$$typeof){case r.vM:return o(e,e.render,"ForwardRef");case r.lD:return o(e,e.type,"memo");default:return}}}},3763:(e,t,n)=>{"use strict";e.exports=n(4983)},3803:(e,t,n)=>{"use strict";n.d(t,{A:()=>se});var r=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),s=Math.abs,a=String.fromCharCode,i=Object.assign;function o(e){return e.trim()}function l(e,t,n){return e.replace(t,n)}function u(e,t){return e.indexOf(t)}function c(e,t){return 0|e.charCodeAt(t)}function d(e,t,n){return e.slice(t,n)}function h(e){return e.length}function p(e){return e.length}function f(e,t){return t.push(e),e}var m=1,g=1,y=0,v=0,b=0,x="";function w(e,t,n,r,s,a,i){return{value:e,root:t,parent:n,type:r,props:s,children:a,line:m,column:g,length:i,return:""}}function k(e,t){return i(w("",null,null,"",null,null,0),e,{length:-e.length},t)}function S(){return b=v>0?c(x,--v):0,g--,10===b&&(g=1,m--),b}function I(){return b=v<y?c(x,v++):0,g++,10===b&&(g=1,m++),b}function C(){return c(x,v)}function T(){return v}function N(e,t){return d(x,e,t)}function E(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function A(e){return m=g=1,y=h(x=e),v=0,[]}function R(e){return x="",e}function _(e){return o(N(v-1,D(91===e?e+2:40===e?e+1:e)))}function $(e){for(;(b=C())&&b<33;)I();return E(e)>2||E(b)>3?"":" "}function O(e,t){for(;--t&&I()&&!(b<48||b>102||b>57&&b<65||b>70&&b<97););return N(e,T()+(t<6&&32==C()&&32==I()))}function D(e){for(;I();)switch(b){case e:return v;case 34:case 39:34!==e&&39!==e&&D(b);break;case 40:41===e&&D(e);break;case 92:I()}return v}function M(e,t){for(;I()&&e+b!==57&&(e+b!==84||47!==C()););return"/*"+N(t,v-1)+"*"+a(47===e?e:I())}function F(e){for(;!E(C());)I();return N(e,v)}var L="-ms-",P="-moz-",z="-webkit-",B="comm",j="rule",U="decl",V="@keyframes";function W(e,t){for(var n="",r=p(e),s=0;s<r;s++)n+=t(e[s],s,e,t)||"";return n}function G(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case U:return e.return=e.return||e.value;case B:return"";case V:return e.return=e.value+"{"+W(e.children,r)+"}";case j:e.value=e.props.join(",")}return h(n=W(e.children,r))?e.return=e.value+"{"+n+"}":""}function H(e){return R(q("",null,null,null,[""],e=A(e),0,[0],e))}function q(e,t,n,r,s,i,o,d,p){for(var m=0,g=0,y=o,v=0,b=0,x=0,w=1,k=1,N=1,E=0,A="",R=s,D=i,L=r,P=A;k;)switch(x=E,E=I()){case 40:if(108!=x&&58==c(P,y-1)){-1!=u(P+=l(_(E),"&","&\f"),"&\f")&&(N=-1);break}case 34:case 39:case 91:P+=_(E);break;case 9:case 10:case 13:case 32:P+=$(x);break;case 92:P+=O(T()-1,7);continue;case 47:switch(C()){case 42:case 47:f(X(M(I(),T()),t,n),p);break;default:P+="/"}break;case 123*w:d[m++]=h(P)*N;case 125*w:case 59:case 0:switch(E){case 0:case 125:k=0;case 59+g:-1==N&&(P=l(P,/\f/g,"")),b>0&&h(P)-y&&f(b>32?Y(P+";",r,n,y-1):Y(l(P," ","")+";",r,n,y-2),p);break;case 59:P+=";";default:if(f(L=K(P,t,n,m,g,s,d,A,R=[],D=[],y),i),123===E)if(0===g)q(P,t,L,L,R,i,y,d,D);else switch(99===v&&110===c(P,3)?100:v){case 100:case 108:case 109:case 115:q(e,L,L,r&&f(K(e,L,L,0,0,s,d,A,s,R=[],y),D),s,D,y,d,r?R:D);break;default:q(P,L,L,L,[""],D,0,d,D)}}m=g=b=0,w=N=1,A=P="",y=o;break;case 58:y=1+h(P),b=x;default:if(w<1)if(123==E)--w;else if(125==E&&0==w++&&125==S())continue;switch(P+=a(E),E*w){case 38:N=g>0?1:(P+="\f",-1);break;case 44:d[m++]=(h(P)-1)*N,N=1;break;case 64:45===C()&&(P+=_(I())),v=C(),g=y=h(A=P+=F(T())),E++;break;case 45:45===x&&2==h(P)&&(w=0)}}return i}function K(e,t,n,r,a,i,u,c,h,f,m){for(var g=a-1,y=0===a?i:[""],v=p(y),b=0,x=0,k=0;b<r;++b)for(var S=0,I=d(e,g+1,g=s(x=u[b])),C=e;S<v;++S)(C=o(x>0?y[S]+" "+I:l(I,/&\f/g,y[S])))&&(h[k++]=C);return w(e,t,n,0===a?j:c,h,f,m)}function X(e,t,n){return w(e,t,n,B,a(b),d(e,2,-2),0)}function Y(e,t,n,r){return w(e,t,n,U,d(e,0,r),d(e,r+1,-1),r)}var Q=function(e,t,n){for(var r=0,s=0;r=s,s=C(),38===r&&12===s&&(t[n]=1),!E(s);)I();return N(e,v)},J=function(e,t){return R(function(e,t){var n=-1,r=44;do{switch(E(r)){case 0:38===r&&12===C()&&(t[n]=1),e[n]+=Q(v-1,t,n);break;case 2:e[n]+=_(r);break;case 4:if(44===r){e[++n]=58===C()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=a(r)}}while(r=I());return e}(A(e),t))},Z=new WeakMap,ee=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Z.get(n))&&!r){Z.set(e,!0);for(var s=[],a=J(t,s),i=n.props,o=0,l=0;o<a.length;o++)for(var u=0;u<i.length;u++,l++)e.props[l]=s[o]?a[o].replace(/&\f/g,i[u]):i[u]+" "+a[o]}}},te=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function ne(e,t){switch(function(e,t){return 45^c(e,0)?(((t<<2^c(e,0))<<2^c(e,1))<<2^c(e,2))<<2^c(e,3):0}(e,t)){case 5103:return z+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return z+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return z+e+P+e+L+e+e;case 6828:case 4268:return z+e+L+e+e;case 6165:return z+e+L+"flex-"+e+e;case 5187:return z+e+l(e,/(\w+).+(:[^]+)/,z+"box-$1$2"+L+"flex-$1$2")+e;case 5443:return z+e+L+"flex-item-"+l(e,/flex-|-self/,"")+e;case 4675:return z+e+L+"flex-line-pack"+l(e,/align-content|flex-|-self/,"")+e;case 5548:return z+e+L+l(e,"shrink","negative")+e;case 5292:return z+e+L+l(e,"basis","preferred-size")+e;case 6060:return z+"box-"+l(e,"-grow","")+z+e+L+l(e,"grow","positive")+e;case 4554:return z+l(e,/([^-])(transform)/g,"$1"+z+"$2")+e;case 6187:return l(l(l(e,/(zoom-|grab)/,z+"$1"),/(image-set)/,z+"$1"),e,"")+e;case 5495:case 3959:return l(e,/(image-set\([^]*)/,z+"$1$`$1");case 4968:return l(l(e,/(.+:)(flex-)?(.*)/,z+"box-pack:$3"+L+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+z+e+e;case 4095:case 3583:case 4068:case 2532:return l(e,/(.+)-inline(.+)/,z+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(h(e)-1-t>6)switch(c(e,t+1)){case 109:if(45!==c(e,t+4))break;case 102:return l(e,/(.+:)(.+)-([^]+)/,"$1"+z+"$2-$3$1"+P+(108==c(e,t+3)?"$3":"$2-$3"))+e;case 115:return~u(e,"stretch")?ne(l(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==c(e,t+1))break;case 6444:switch(c(e,h(e)-3-(~u(e,"!important")&&10))){case 107:return l(e,":",":"+z)+e;case 101:return l(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+z+(45===c(e,14)?"inline-":"")+"box$3$1"+z+"$2$3$1"+L+"$2box$3")+e}break;case 5936:switch(c(e,t+11)){case 114:return z+e+L+l(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return z+e+L+l(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return z+e+L+l(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return z+e+L+e+e}return e}var re=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case U:e.return=ne(e.value,e.length);break;case V:return W([k(e,{value:l(e.value,"@","@"+z)})],r);case j:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return W([k(e,{props:[l(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return W([k(e,{props:[l(t,/:(plac\w+)/,":"+z+"input-$1")]}),k(e,{props:[l(t,/:(plac\w+)/,":-moz-$1")]}),k(e,{props:[l(t,/:(plac\w+)/,L+"input-$1")]})],r)}return""}))}}],se=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var s,a,i=e.stylisPlugins||re,o={},l=[];s=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)o[t[n]]=!0;l.push(e)}));var u,c,d=[G,(c=function(e){u.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=p(e);return function(n,r,s,a){for(var i="",o=0;o<t;o++)i+=e[o](n,r,s,a)||"";return i}}([ee,te].concat(i,d));a=function(e,t,n,r){u=n,W(H(e?e+"{"+t.styles+"}":t.styles),h),r&&(f.inserted[t.name]=!0)};var f={key:t,sheet:new r({key:t,container:s,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:a};return f.sheet.hydrate(l),f}},3815:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(9172);const s=function(e,t){return t?(0,r.A)(e,t,{clone:!1}):e}},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,m(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var s,a={},i=null,o=null;if(null!=t)for(s in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)k.call(t,s)&&!I.hasOwnProperty(s)&&(a[s]=t[s]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];a.children=u}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===a[s]&&(a[s]=l[s]);return{$$typeof:n,type:e,key:i,ref:o,props:a,_owner:S.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var N=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,s,a,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return i=i(l=e),e=""===a?"."+E(l,0):a,w(i)?(s="",null!=e&&(s=e.replace(N,"$&/")+"/"),A(i,t,s,"",(function(e){return e}))):null!=i&&(T(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,s+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(N,"$&/")+"/")+e)),t.push(i)),1;if(l=0,a=""===a?".":a+":",w(e))for(var u=0;u<e.length;u++){var c=a+E(o=e[u],u);l+=A(o,t,s,c,i)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(o=e.next()).done;)l+=A(o=o.value,t,s,c=a+E(o,u++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function R(e,t,n){if(null==e)return e;var r=[],s=0;return A(e,r,"","",(function(e){return t.call(n,e,s++)})),r}function _(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var $={current:null},O={transition:null},D={ReactCurrentDispatcher:$,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=s,t.Profiler=i,t.PureComponent=b,t.StrictMode=a,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=m({},e.props),a=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)k.call(t,u)&&!I.hasOwnProperty(u)&&(s[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)s.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];s.children=l}return{$$typeof:n,type:e.type,key:a,ref:i,props:s,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:_}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return $.current.useCallback(e,t)},t.useContext=function(e){return $.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return $.current.useDeferredValue(e)},t.useEffect=function(e,t){return $.current.useEffect(e,t)},t.useId=function(){return $.current.useId()},t.useImperativeHandle=function(e,t,n){return $.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return $.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return $.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return $.current.useMemo(e,t)},t.useReducer=function(e,t,n){return $.current.useReducer(e,t,n)},t.useRef=function(e){return $.current.useRef(e)},t.useState=function(e){return $.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return $.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return $.current.useTransition()},t.version="18.3.1"},4334:(e,t,n)=>{var r=n(7359),s=n(7066),a=n(9016),i=n(9538),o=n(6288),l=n(5262),u=n(2430);u.alea=r,u.xor128=s,u.xorwow=a,u.xorshift7=i,u.xor4096=o,u.tychei=l,e.exports=u},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4530:()=>{},4634:e=>{function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4853:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(8587),s=n(8168);const a=["values","unit","step"],i=e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>(0,s.A)({},e,{[t.key]:t.val})),{})};function o(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:o=5}=e,l=(0,r.A)(e,a),u=i(t),c=Object.keys(u);function d(e){return`@media (min-width:${"number"===typeof t[e]?t[e]:e}${n})`}function h(e){return`@media (max-width:${("number"===typeof t[e]?t[e]:e)-o/100}${n})`}function p(e,r){const s=c.indexOf(r);return`@media (min-width:${"number"===typeof t[e]?t[e]:e}${n}) and (max-width:${(-1!==s&&"number"===typeof t[c[s]]?t[c[s]]:r)-o/100}${n})`}return(0,s.A)({keys:c,values:u,up:d,down:h,between:p,only:function(e){return c.indexOf(e)+1<c.length?p(e,c[c.indexOf(e)+1]):d(e)},not:function(e){const t=c.indexOf(e);return 0===t?d(c[1]):t===c.length-1?h(c[t]):p(e,c[c.indexOf(e)+1]).replace("@media","@media not all and")},unit:n},l)}},4893:e=>{e.exports=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n},e.exports.__esModule=!0,e.exports.default=e.exports},4983:(e,t)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,s=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,i=n?Symbol.for("react.strict_mode"):60108,o=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case d:case a:case o:case i:case p:return e;default:switch(e=e&&e.$$typeof){case u:case h:case g:case m:case l:return e;default:return t}}case s:return t}}}function k(e){return w(e)===d}t.AsyncMode=c,t.ConcurrentMode=d,t.ContextConsumer=u,t.ContextProvider=l,t.Element=r,t.ForwardRef=h,t.Fragment=a,t.Lazy=g,t.Memo=m,t.Portal=s,t.Profiler=o,t.StrictMode=i,t.Suspense=p,t.isAsyncMode=function(e){return k(e)||w(e)===c},t.isConcurrentMode=k,t.isContextConsumer=function(e){return w(e)===u},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===h},t.isFragment=function(e){return w(e)===a},t.isLazy=function(e){return w(e)===g},t.isMemo=function(e){return w(e)===m},t.isPortal=function(e){return w(e)===s},t.isProfiler=function(e){return w(e)===o},t.isStrictMode=function(e){return w(e)===i},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===d||e===o||e===i||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===h||e.$$typeof===v||e.$$typeof===b||e.$$typeof===x||e.$$typeof===y)},t.typeOf=w},4989:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A,private_createBreakpoints:()=>s.A,unstable_applyStyles:()=>a.A});var r=n(8280),s=n(4853),a=n(9703)},4994:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5262:function(e,t,n){var r;!function(e,s){function a(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,s=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^s,s=s-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^s,t.a=s-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function o(e,t){var n=new a(e),r=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,r&&("object"==typeof r&&i(r,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(r=function(){return o}.call(t,n,t,s))||(s.exports=r):this.tychei=o}(0,e=n.nmd(e),n.amdD)},5817:()=>{},6288:function(e,t,n){var r;!function(e,s){function a(e){var t=this;t.next=function(){var e,n,r=t.w,s=t.X,a=t.i;return t.w=r=r+1640531527|0,n=s[a+34&127],e=s[a=a+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=s[a]=n^e,t.i=a,n+(r^r>>>16)|0},function(e,t){var n,r,s,a,i,o=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),s=0,a=-32;a<l;++a)t&&(r^=t.charCodeAt((a+32)%t.length)),0===a&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=i+1640531527|0,s=0==(n=o[127&a]^=r+i)?s+1:0);for(s>=128&&(o[127&(t&&t.length||0)]=-1),s=127,a=512;a>0;--a)r=o[s+34&127],n=o[s=s+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,o[s]=r^n;e.w=i,e.X=o,e.i=s}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function o(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,r&&(r.X&&i(r,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(r=function(){return o}.call(t,n,t,s))||(s.exports=r):this.xor4096=o}(0,e=n.nmd(e),n.amdD)},6531:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A});var r=n(1188)},6598:(e,t,n)=>{"use strict";n.d(t,{J:()=>g});var r={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},s=n(918),a=!1,i=/[A-Z]|^ms/g,o=/_EMO_([^_]+?)_([^]*?)_EMO_/g,l=function(e){return 45===e.charCodeAt(1)},u=function(e){return null!=e&&"boolean"!==typeof e},c=(0,s.A)((function(e){return l(e)?e:e.replace(i,"-$&").toLowerCase()})),d=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(o,(function(e,t,n){return f={name:t,styles:n,next:f},t}))}return 1===r[e]||l(e)||"number"!==typeof t||0===t?t:t+"px"},h="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function p(e,t,n){if(null==n)return"";var r=n;if(void 0!==r.__emotion_styles)return r;switch(typeof n){case"boolean":return"";case"object":var s=n;if(1===s.anim)return f={name:s.name,styles:s.styles,next:f},s.name;var i=n;if(void 0!==i.styles){var o=i.next;if(void 0!==o)for(;void 0!==o;)f={name:o.name,styles:o.styles,next:f},o=o.next;return i.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var s=0;s<n.length;s++)r+=p(e,t,n[s])+";";else for(var i in n){var o=n[i];if("object"!==typeof o){var l=o;null!=t&&void 0!==t[l]?r+=i+"{"+t[l]+"}":u(l)&&(r+=c(i)+":"+d(i,l)+";")}else{if("NO_COMPONENT_SELECTOR"===i&&a)throw new Error(h);if(!Array.isArray(o)||"string"!==typeof o[0]||null!=t&&void 0!==t[o[0]]){var f=p(e,t,o);switch(i){case"animation":case"animationName":r+=c(i)+":"+f+";";break;default:r+=i+"{"+f+"}"}}else for(var m=0;m<o.length;m++)u(o[m])&&(r+=c(i)+":"+d(i,o[m])+";")}}return r}(e,t,n);case"function":if(void 0!==e){var l=f,m=n(e);return f=l,p(e,t,m)}}var g=n;if(null==t)return g;var y=t[g];return void 0!==y?y:g}var f,m=/label:\s*([^\s;{]+)\s*(;|$)/g;function g(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,s="";f=void 0;var a=e[0];null==a||void 0===a.raw?(r=!1,s+=p(n,t,a)):s+=a[0];for(var i=1;i<e.length;i++){if(s+=p(n,t,e[i]),r)s+=a[i]}m.lastIndex=0;for(var o,l="";null!==(o=m.exec(s));)l+="-"+o[1];var u=function(e){for(var t,n=0,r=0,s=e.length;s>=4;++r,s-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(s){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(s)+l;return{name:u,styles:s,next:f}}},7029:function(e,t,n){var r;r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,n){"use strict";n.r(t);var r=n("react"),s=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},a.apply(this,arguments)},i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n};function o(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)}"undefined"!==typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise((function(n,r){t.call(navigator,e,n,r)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}));var l=function(e){function t(t){var n=e.call(this,t)||this;return n.canvas=null,n.ctx=null,n.requestUserMediaId=0,n.unmounted=!1,n.state={hasUserMedia:!1},n}return s(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;this.unmounted=!1,o()?(e.hasUserMedia||this.requestUserMedia(),t.children&&"function"!=typeof t.children&&console.warn("children must be a function")):t.onUserMediaError("getUserMedia not supported")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(o()){var n=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),r=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),s=e.minScreenshotWidth!==t.minScreenshotWidth,a=e.minScreenshotHeight!==t.minScreenshotHeight;(r||s||a)&&(this.canvas=null,this.ctx=null),(n||r)&&(this.stopAndCleanup(),this.requestUserMedia())}else t.onUserMediaError("getUserMedia not supported")},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map((function(t){e.removeTrack(t),t.stop()})),e.getAudioTracks().map((function(t){e.removeTrack(t),t.stop()}))):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,n=this.props;if(!t.hasUserMedia)return null;var r=this.getCanvas(e);return r&&r.toDataURL(n.screenshotFormat,n.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,n=this.props;if(!this.video)return null;if(!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var r=this.video.videoWidth,s=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var a=r/s;s=(r=n.minScreenshotWidth||this.video.clientWidth)/a,n.minScreenshotHeight&&s<n.minScreenshotHeight&&(r=(s=n.minScreenshotHeight)*a)}this.canvas=document.createElement("canvas"),this.canvas.width=(null===e||void 0===e?void 0:e.width)||r,this.canvas.height=(null===e||void 0===e?void 0:e.height)||s,this.ctx=this.canvas.getContext("2d")}var i=this.ctx,o=this.canvas;return i&&o&&(o.width=(null===e||void 0===e?void 0:e.width)||o.width,o.height=(null===e||void 0===e?void 0:e.height)||o.height,n.mirrored&&(i.translate(o.width,0),i.scale(-1,1)),i.imageSmoothingEnabled=n.imageSmoothing,i.drawImage(this.video,0,0,(null===e||void 0===e?void 0:e.width)||o.width,(null===e||void 0===e?void 0:e.height)||o.height),n.mirrored&&(i.scale(-1,1),i.translate(-o.width,0))),o},t.prototype.requestUserMedia=function(){var e=this,n=this.props,r=function(r,s){var a={video:"undefined"===typeof s||s};n.audio&&(a.audio="undefined"===typeof r||r),e.requestUserMediaId++;var i=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(a).then((function(n){e.unmounted||i!==e.requestUserMediaId?t.stopMediaStream(n):e.handleUserMedia(null,n)})).catch((function(t){e.handleUserMedia(t)}))};if("mediaDevices"in navigator)r(n.audioConstraints,n.videoConstraints);else{var s=function(e){return{optional:[{sourceId:e}]}},a=function(e){var t=e.deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources((function(e){var t=null,i=null;e.forEach((function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(i=e.id)}));var o=a(n.audioConstraints);o&&(t=o);var l=a(n.videoConstraints);l&&(i=l),r(s(t),s(i))}))}},t.prototype.handleUserMedia=function(e,t){var n=this.props;if(e||!t)return this.setState({hasUserMedia:!1}),void n.onUserMediaError(e);this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(r){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}n.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,n=this.props,s=n.audio,o=(n.forceScreenshotSourceSize,n.disablePictureInPicture),l=(n.onUserMedia,n.onUserMediaError,n.screenshotFormat,n.screenshotQuality,n.minScreenshotWidth,n.minScreenshotHeight,n.audioConstraints,n.videoConstraints,n.imageSmoothing,n.mirrored),u=n.style,c=void 0===u?{}:u,d=n.children,h=i(n,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),p=l?a(a({},c),{transform:(c.transform||"")+" scaleX(-1)"}):c,f={getScreenshot:this.getScreenshot.bind(this)};return r.createElement(r.Fragment,null,r.createElement("video",a({autoPlay:!0,disablePictureInPicture:o,src:t.src,muted:!s,playsInline:!0,ref:function(t){e.video=t},style:p},h)),d&&d(f))},t.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(r.Component);t.default=l},react:function(t,n){t.exports=e}}).default},e.exports=r(n(5043))},7066:function(e,t,n){var r;!function(e,s){function a(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function o(e,t){var n=new a(e),r=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,r&&("object"==typeof r&&i(r,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(r=function(){return o}.call(t,n,t,s))||(s.exports=r):this.xor128=o}(0,e=n.nmd(e),n.amdD)},7162:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>o,BO:()=>i,Yn:()=>a});var r=n(7598),s=n(9751);function a(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){const n=`vars.${t}`.split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=n)return n}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function i(e,t,n){let r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||s:a(e,n)||s,t&&(r=t(r,s,e)),r}const o=function(e){const{prop:t,cssProperty:n=e.prop,themeKey:o,transform:l}=e,u=e=>{if(null==e[t])return null;const u=e[t],c=a(e.theme,o)||{};return(0,s.NI)(e,u,(e=>{let s=i(c,l,e);return e===s&&"string"===typeof e&&(s=i(c,l,`${t}${"default"===e?"":(0,r.A)(e)}`,e)),!1===n?s:{[n]:s}}))};return u.propTypes={},u.filterProps=[t],u}},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,s=e[r];if(!(0<a(s,t)))break e;e[r]=t,e[n]=s,n=r}}function r(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,s=e.length,i=s>>>1;r<i;){var o=2*(r+1)-1,l=e[o],u=o+1,c=e[u];if(0>a(l,n))u<s&&0>a(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[o]=n,r=o);else{if(!(u<s&&0>a(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(c);null!==t;){if(null===t.callback)s(c);else{if(!(t.startTime<=e))break;s(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function w(e){if(g=!1,x(e),!m)if(null!==r(u))m=!0,O(k);else{var t=r(c);null!==t&&D(w,t.startTime-e)}}function k(e,n){m=!1,g&&(g=!1,v(T),T=-1),f=!0;var a=p;try{for(x(n),h=r(u);null!==h&&(!(h.expirationTime>n)||e&&!A());){var i=h.callback;if("function"===typeof i){h.callback=null,p=h.priorityLevel;var o=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(u)&&s(u),x(n)}else s(u);h=r(u)}if(null!==h)var l=!0;else{var d=r(c);null!==d&&D(w,d.startTime-n),l=!1}return l}finally{h=null,p=a,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,I=!1,C=null,T=-1,N=5,E=-1;function A(){return!(t.unstable_now()-E<N)}function R(){if(null!==C){var e=t.unstable_now();E=e;var n=!0;try{n=C(!0,e)}finally{n?S():(I=!1,C=null)}}else I=!1}if("function"===typeof b)S=function(){b(R)};else if("undefined"!==typeof MessageChannel){var _=new MessageChannel,$=_.port2;_.port1.onmessage=R,S=function(){$.postMessage(null)}}else S=function(){y(R,0)};function O(e){C=e,I||(I=!0,S())}function D(e,n){T=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,O(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,s,a){var i=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?i+a:i:a=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:s,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>i?(e.sortIndex=a,n(c,e),null===r(u)&&e===r(c)&&(g?(v(T),T=-1):g=!0,D(w,a-i))):(e.sortIndex=o,n(u,e),m||f||(m=!0,O(k))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},7266:(e,t,n)=>{"use strict";var r=n(4994);t.X4=p,t.e$=f,t.eM=function(e,t){const n=h(e),r=h(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},t.a=m;var s=r(n(457)),a=r(n(6531));function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,a.default)(e,t,n)}function o(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&1===n[0].length&&(n=n.map((e=>e+e))),n?`rgb${4===n.length?"a":""}(${n.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", ")})`:""}function l(e){if(e.type)return e;if("#"===e.charAt(0))return l(o(e));const t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error((0,s.default)(9,e));let r,a=e.substring(t+1,e.length-1);if("color"===n){if(a=a.split(" "),r=a.shift(),4===a.length&&"/"===a[3].charAt(0)&&(a[3]=a[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error((0,s.default)(10,r))}else a=a.split(",");return a=a.map((e=>parseFloat(e))),{type:n,values:a,colorSpace:r}}const u=e=>{const t=l(e);return t.values.slice(0,3).map(((e,n)=>-1!==t.type.indexOf("hsl")&&0!==n?`${e}%`:e)).join(" ")};function c(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return-1!==t.indexOf("rgb")?r=r.map(((e,t)=>t<3?parseInt(e,10):e)):-1!==t.indexOf("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),r=-1!==t.indexOf("color")?`${n} ${r.join(" ")}`:`${r.join(", ")}`,`${t}(${r})`}function d(e){e=l(e);const{values:t}=e,n=t[0],r=t[1]/100,s=t[2]/100,a=r*Math.min(s,1-s),i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return s-a*Math.max(Math.min(t-3,9-t,1),-1)};let o="rgb";const u=[Math.round(255*i(0)),Math.round(255*i(8)),Math.round(255*i(4))];return"hsla"===e.type&&(o+="a",u.push(t[3])),c({type:o,values:u})}function h(e){let t="hsl"===(e=l(e)).type||"hsla"===e.type?l(d(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function p(e,t){return e=l(e),t=i(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,c(e)}function f(e,t){if(e=l(e),t=i(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return c(e)}function m(e,t){if(e=l(e),t=i(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return c(e)}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return h(e)>.5?f(e,t):m(e,t)}},7353:e=>{e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(C){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var s={},a={};function i(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=a[e])?r:(n=l(e,(0|e)<0?-1:0,!0),i&&(a[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=s[e])?r:(n=l(e,e<0?-1:0,!1),i&&(s[e]=n),n)}function o(e,t){if(isNaN(e))return t?y:g;if(t){if(e<0)return y;if(e>=p)return k}else{if(e<=-f)return S;if(e+1>=f)return w}return e<0?o(-e,t).neg():l(e%h|0,e/h|0,t)}function l(e,t,r){return new n(e,t,r)}n.fromInt=i,n.fromNumber=o,n.fromBits=l;var u=Math.pow;function c(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return c(e.substring(1),t,n).neg();for(var s=o(u(n,8)),a=g,i=0;i<e.length;i+=8){var l=Math.min(8,e.length-i),d=parseInt(e.substring(i,i+l),n);if(l<8){var h=o(u(n,l));a=a.mul(h).add(o(d))}else a=(a=a.mul(s)).add(o(d))}return a.unsigned=t,a}function d(e,t){return"number"===typeof e?o(e,t):"string"===typeof e?c(e,t):l(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=c,n.fromValue=d;var h=4294967296,p=h*h,f=p/2,m=i(1<<24),g=i(0);n.ZERO=g;var y=i(0,!0);n.UZERO=y;var v=i(1);n.ONE=v;var b=i(1,!0);n.UONE=b;var x=i(-1);n.NEG_ONE=x;var w=l(-1,2147483647,!1);n.MAX_VALUE=w;var k=l(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var S=l(0,-2147483648,!1);n.MIN_VALUE=S;var I=n.prototype;I.toInt=function(){return this.unsigned?this.low>>>0:this.low},I.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},I.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=o(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var s=o(u(e,6),this.unsigned),a=this,i="";;){var l=a.div(s),c=(a.sub(l.mul(s)).toInt()>>>0).toString(e);if((a=l).isZero())return c+i;for(;c.length<6;)c="0"+c;i=""+c+i}},I.getHighBits=function(){return this.high},I.getHighBitsUnsigned=function(){return this.high>>>0},I.getLowBits=function(){return this.low},I.getLowBitsUnsigned=function(){return this.low>>>0},I.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},I.isZero=function(){return 0===this.high&&0===this.low},I.eqz=I.isZero,I.isNegative=function(){return!this.unsigned&&this.high<0},I.isPositive=function(){return this.unsigned||this.high>=0},I.isOdd=function(){return 1===(1&this.low)},I.isEven=function(){return 0===(1&this.low)},I.equals=function(e){return r(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},I.eq=I.equals,I.notEquals=function(e){return!this.eq(e)},I.neq=I.notEquals,I.ne=I.notEquals,I.lessThan=function(e){return this.comp(e)<0},I.lt=I.lessThan,I.lessThanOrEqual=function(e){return this.comp(e)<=0},I.lte=I.lessThanOrEqual,I.le=I.lessThanOrEqual,I.greaterThan=function(e){return this.comp(e)>0},I.gt=I.greaterThan,I.greaterThanOrEqual=function(e){return this.comp(e)>=0},I.gte=I.greaterThanOrEqual,I.ge=I.greaterThanOrEqual,I.compare=function(e){if(r(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},I.comp=I.compare,I.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(v)},I.neg=I.negate,I.add=function(e){r(e)||(e=d(e));var t=this.high>>>16,n=65535&this.high,s=this.low>>>16,a=65535&this.low,i=e.high>>>16,o=65535&e.high,u=e.low>>>16,c=0,h=0,p=0,f=0;return p+=(f+=a+(65535&e.low))>>>16,h+=(p+=s+u)>>>16,c+=(h+=n+o)>>>16,c+=t+i,l((p&=65535)<<16|(f&=65535),(c&=65535)<<16|(h&=65535),this.unsigned)},I.subtract=function(e){return r(e)||(e=d(e)),this.add(e.neg())},I.sub=I.subtract,I.multiply=function(e){if(this.isZero())return g;if(r(e)||(e=d(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(S))return e.isOdd()?S:g;if(e.eq(S))return this.isOdd()?S:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return o(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,s=65535&this.high,a=this.low>>>16,i=65535&this.low,u=e.high>>>16,c=65535&e.high,h=e.low>>>16,p=65535&e.low,f=0,y=0,v=0,b=0;return v+=(b+=i*p)>>>16,y+=(v+=a*p)>>>16,v&=65535,y+=(v+=i*h)>>>16,f+=(y+=s*p)>>>16,y&=65535,f+=(y+=a*h)>>>16,y&=65535,f+=(y+=i*c)>>>16,f+=n*p+s*h+a*c+i*u,l((v&=65535)<<16|(b&=65535),(f&=65535)<<16|(y&=65535),this.unsigned)},I.mul=I.multiply,I.divide=function(e){if(r(e)||(e=d(e)),e.isZero())throw Error("division by zero");var n,s,a;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return b;a=y}else{if(this.eq(S))return e.eq(v)||e.eq(x)?S:e.eq(S)?v:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?v:x:(s=this.sub(e.mul(n)),a=n.add(s.div(e)));if(e.eq(S))return this.unsigned?y:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=g}for(s=this;s.gte(e);){n=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(n)/Math.LN2),c=i<=48?1:u(2,i-48),h=o(n),p=h.mul(e);p.isNegative()||p.gt(s);)p=(h=o(n-=c,this.unsigned)).mul(e);h.isZero()&&(h=v),a=a.add(h),s=s.sub(p)}return a},I.div=I.divide,I.modulo=function(e){return r(e)||(e=d(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},I.mod=I.modulo,I.rem=I.modulo,I.not=function(){return l(~this.low,~this.high,this.unsigned)},I.and=function(e){return r(e)||(e=d(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},I.or=function(e){return r(e)||(e=d(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},I.xor=function(e){return r(e)||(e=d(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},I.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},I.shl=I.shiftLeft,I.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},I.shr=I.shiftRight,I.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},I.shru=I.shiftRightUnsigned,I.shr_u=I.shiftRightUnsigned,I.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},I.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},I.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},I.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},I.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},7359:function(e,t,n){var r;!function(e,s){function a(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function o(e,t){var n=new a(e),r=t&&t.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,r&&("object"==typeof r&&i(r,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(r=function(){return o}.call(t,n,t,s))||(s.exports=r):this.alea=o}(0,e=n.nmd(e),n.amdD)},7598:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(7868);function s(e){if("string"!==typeof e)throw new Error((0,r.A)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},7758:(e,t,n)=>{"use strict";n.d(t,{A:()=>D});var r=n(8604),s=n(7162),a=n(3815);const i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>(t.filterProps.forEach((n=>{e[n]=t})),e)),{}),s=e=>Object.keys(e).reduce(((t,n)=>r[n]?(0,a.A)(t,r[n](e)):t),{});return s.propTypes={},s.filterProps=t.reduce(((e,t)=>e.concat(t.filterProps)),[]),s};var o=n(9751);function l(e){return"number"!==typeof e?e:`${e}px solid`}function u(e,t){return(0,s.Ay)({prop:e,themeKey:"borders",transform:t})}const c=u("border",l),d=u("borderTop",l),h=u("borderRight",l),p=u("borderBottom",l),f=u("borderLeft",l),m=u("borderColor"),g=u("borderTopColor"),y=u("borderRightColor"),v=u("borderBottomColor"),b=u("borderLeftColor"),x=u("outline",l),w=u("outlineColor"),k=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=(0,r.MA)(e.theme,"shape.borderRadius",4,"borderRadius"),n=e=>({borderRadius:(0,r._W)(t,e)});return(0,o.NI)(e,e.borderRadius,n)}return null};k.propTypes={},k.filterProps=["borderRadius"];i(c,d,h,p,f,m,g,y,v,b,k,x,w);const S=e=>{if(void 0!==e.gap&&null!==e.gap){const t=(0,r.MA)(e.theme,"spacing",8,"gap"),n=e=>({gap:(0,r._W)(t,e)});return(0,o.NI)(e,e.gap,n)}return null};S.propTypes={},S.filterProps=["gap"];const I=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=(0,r.MA)(e.theme,"spacing",8,"columnGap"),n=e=>({columnGap:(0,r._W)(t,e)});return(0,o.NI)(e,e.columnGap,n)}return null};I.propTypes={},I.filterProps=["columnGap"];const C=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=(0,r.MA)(e.theme,"spacing",8,"rowGap"),n=e=>({rowGap:(0,r._W)(t,e)});return(0,o.NI)(e,e.rowGap,n)}return null};C.propTypes={},C.filterProps=["rowGap"];i(S,I,C,(0,s.Ay)({prop:"gridColumn"}),(0,s.Ay)({prop:"gridRow"}),(0,s.Ay)({prop:"gridAutoFlow"}),(0,s.Ay)({prop:"gridAutoColumns"}),(0,s.Ay)({prop:"gridAutoRows"}),(0,s.Ay)({prop:"gridTemplateColumns"}),(0,s.Ay)({prop:"gridTemplateRows"}),(0,s.Ay)({prop:"gridTemplateAreas"}),(0,s.Ay)({prop:"gridArea"}));function T(e,t){return"grey"===t?t:e}i((0,s.Ay)({prop:"color",themeKey:"palette",transform:T}),(0,s.Ay)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:T}),(0,s.Ay)({prop:"backgroundColor",themeKey:"palette",transform:T}));function N(e){return e<=1&&0!==e?100*e+"%":e}const E=(0,s.Ay)({prop:"width",transform:N}),A=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{var n,r;const s=(null==(n=e.theme)||null==(n=n.breakpoints)||null==(n=n.values)?void 0:n[t])||o.zu[t];return s?"px"!==(null==(r=e.theme)||null==(r=r.breakpoints)?void 0:r.unit)?{maxWidth:`${s}${e.theme.breakpoints.unit}`}:{maxWidth:s}:{maxWidth:N(t)}};return(0,o.NI)(e,e.maxWidth,t)}return null};A.filterProps=["maxWidth"];const R=(0,s.Ay)({prop:"minWidth",transform:N}),_=(0,s.Ay)({prop:"height",transform:N}),$=(0,s.Ay)({prop:"maxHeight",transform:N}),O=(0,s.Ay)({prop:"minHeight",transform:N}),D=((0,s.Ay)({prop:"size",cssProperty:"width",transform:N}),(0,s.Ay)({prop:"size",cssProperty:"height",transform:N}),i(E,A,R,_,$,O,(0,s.Ay)({prop:"boxSizing"})),{border:{themeKey:"borders",transform:l},borderTop:{themeKey:"borders",transform:l},borderRight:{themeKey:"borders",transform:l},borderBottom:{themeKey:"borders",transform:l},borderLeft:{themeKey:"borders",transform:l},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:l},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:k},color:{themeKey:"palette",transform:T},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:T},backgroundColor:{themeKey:"palette",transform:T},p:{style:r.Ms},pt:{style:r.Ms},pr:{style:r.Ms},pb:{style:r.Ms},pl:{style:r.Ms},px:{style:r.Ms},py:{style:r.Ms},padding:{style:r.Ms},paddingTop:{style:r.Ms},paddingRight:{style:r.Ms},paddingBottom:{style:r.Ms},paddingLeft:{style:r.Ms},paddingX:{style:r.Ms},paddingY:{style:r.Ms},paddingInline:{style:r.Ms},paddingInlineStart:{style:r.Ms},paddingInlineEnd:{style:r.Ms},paddingBlock:{style:r.Ms},paddingBlockStart:{style:r.Ms},paddingBlockEnd:{style:r.Ms},m:{style:r.Lc},mt:{style:r.Lc},mr:{style:r.Lc},mb:{style:r.Lc},ml:{style:r.Lc},mx:{style:r.Lc},my:{style:r.Lc},margin:{style:r.Lc},marginTop:{style:r.Lc},marginRight:{style:r.Lc},marginBottom:{style:r.Lc},marginLeft:{style:r.Lc},marginX:{style:r.Lc},marginY:{style:r.Lc},marginInline:{style:r.Lc},marginInlineStart:{style:r.Lc},marginInlineEnd:{style:r.Lc},marginBlock:{style:r.Lc},marginBlockStart:{style:r.Lc},marginBlockEnd:{style:r.Lc},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:S},rowGap:{style:C},columnGap:{style:I},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:N},maxWidth:{style:A},minWidth:{transform:N},height:{transform:N},maxHeight:{transform:N},minHeight:{transform:N},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}})},7868:(e,t,n)=>{"use strict";function r(e){let t="https://mui.com/production-error/?code="+e;for(let n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}n.d(t,{A:()=>r})},7918:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A});var r=n(7598)},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8052:(e,t,n)=>{"use strict";var r=n(4994);t.Ay=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=m,rootShouldForwardProp:r=f,slotShouldForwardProp:l=f}=e,c=e=>(0,u.default)((0,s.default)({},e,{theme:y((0,s.default)({},e,{defaultTheme:n,themeId:t}))}));return c.__mui_systemSx=!0,function(e){let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.internal_processStyles)(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:d,slot:p,skipVariantsResolver:m,skipSx:x,overridesResolver:w=v(g(p))}=u,k=(0,a.default)(u,h),S=void 0!==m?m:p&&"Root"!==p&&"root"!==p||!1,I=x||!1;let C=f;"Root"===p||"root"===p?C=r:p?C=l:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(C=void 0);const T=(0,i.default)(e,(0,s.default)({shouldForwardProp:C,label:undefined},k)),N=e=>"function"===typeof e&&e.__emotion_real!==e||(0,o.isPlainObject)(e)?r=>b(e,(0,s.default)({},r,{theme:y({theme:r.theme,defaultTheme:n,themeId:t})})):e,E=function(r){let a=N(r);for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];const u=o?o.map(N):[];d&&w&&u.push((e=>{const r=y((0,s.default)({},e,{defaultTheme:n,themeId:t}));if(!r.components||!r.components[d]||!r.components[d].styleOverrides)return null;const a=r.components[d].styleOverrides,i={};return Object.entries(a).forEach((t=>{let[n,a]=t;i[n]=b(a,(0,s.default)({},e,{theme:r}))})),w(e,i)})),d&&!S&&u.push((e=>{var r;const a=y((0,s.default)({},e,{defaultTheme:n,themeId:t}));return b({variants:null==a||null==(r=a.components)||null==(r=r[d])?void 0:r.variants},(0,s.default)({},e,{theme:a}))})),I||u.push(c);const h=u.length-o.length;if(Array.isArray(r)&&h>0){const e=new Array(h).fill("");a=[...r,...e],a.raw=[...r.raw,...e]}const p=T(a,...u);return e.muiName&&(p.muiName=e.muiName),p};return T.withConfig&&(E.withConfig=T.withConfig),E}};var s=r(n(4634)),a=r(n(4893)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=s?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(3174)),o=n(9482),l=(r(n(7918)),r(n(3382)),r(n(4989))),u=r(n(3234));const c=["ownerState"],d=["variants"],h=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function f(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const m=(0,l.default)(),g=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function y(e){let{defaultTheme:t,theme:n,themeId:r}=e;return s=n,0===Object.keys(s).length?t:n[r]||n;var s}function v(e){return e?(t,n)=>n[e]:null}function b(e,t){let{ownerState:n}=t,r=(0,a.default)(t,c);const i="function"===typeof e?e((0,s.default)({ownerState:n},r)):e;if(Array.isArray(i))return i.flatMap((e=>b(e,(0,s.default)({ownerState:n},r))));if(i&&"object"===typeof i&&Array.isArray(i.variants)){const{variants:e=[]}=i;let t=(0,a.default)(i,d);return e.forEach((e=>{let a=!0;"function"===typeof e.props?a=e.props((0,s.default)({ownerState:n},r,n)):Object.keys(e.props).forEach((t=>{(null==n?void 0:n[t])!==e.props[t]&&r[t]!==e.props[t]&&(a=!1)})),a&&(Array.isArray(t)||(t=[t]),t.push("function"===typeof e.style?e.style((0,s.default)({ownerState:n},r,n)):e.style))})),t}return i}},8108:()=>{},8168:(e,t,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(null,arguments)}n.d(t,{A:()=>r})},8280:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var r=n(8168),s=n(8587),a=n(9172),i=n(4853);const o={borderRadius:4};var l=n(8604);var u=n(8812),c=n(7758),d=n(9703);const h=["breakpoints","palette","spacing","shape"];const p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:n={},spacing:p,shape:f={}}=e,m=(0,s.A)(e,h),g=(0,i.A)(t),y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;const t=(0,l.LX)({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0===n.length?[1]:n).map((e=>{const n=t(e);return"number"===typeof n?`${n}px`:n})).join(" ")};return n.mui=!0,n}(p);let v=(0,a.A)({breakpoints:g,direction:"ltr",components:{},palette:(0,r.A)({mode:"light"},n),spacing:y,shape:(0,r.A)({},o,f)},m);v.applyStyles=d.A;for(var b=arguments.length,x=new Array(b>1?b-1:0),w=1;w<b;w++)x[w-1]=arguments[w];return v=x.reduce(((e,t)=>(0,a.A)(e,t)),v),v.unstable_sxConfig=(0,r.A)({},c.A,null==m?void 0:m.unstable_sxConfig),v.unstable_sx=function(e){return(0,u.A)({sx:e,theme:this})},v}},8587:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}n.d(t,{A:()=>r})},8590:()=>{},8604:(e,t,n)=>{"use strict";n.d(t,{LX:()=>f,MA:()=>p,_W:()=>m,Lc:()=>v,Ms:()=>b});var r=n(9751),s=n(7162),a=n(3815);const i={m:"margin",p:"padding"},o={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},l={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},u=function(e){const t={};return n=>(void 0===t[n]&&(t[n]=e(n)),t[n])}((e=>{if(e.length>2){if(!l[e])return[e];e=l[e]}const[t,n]=e.split(""),r=i[t],s=o[n]||"";return Array.isArray(s)?s.map((e=>r+e)):[r+s]})),c=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],d=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],h=[...c,...d];function p(e,t,n,r){var a;const i=null!=(a=(0,s.Yn)(e,t,!1))?a:n;return"number"===typeof i?e=>"string"===typeof e?e:i*e:Array.isArray(i)?e=>"string"===typeof e?e:i[e]:"function"===typeof i?i:()=>{}}function f(e){return p(e,"spacing",8)}function m(e,t){if("string"===typeof t||null==t)return t;const n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:`-${n}`}function g(e,t,n,s){if(-1===t.indexOf(n))return null;const a=function(e,t){return n=>e.reduce(((e,r)=>(e[r]=m(t,n),e)),{})}(u(n),s),i=e[n];return(0,r.NI)(e,i,a)}function y(e,t){const n=f(e.theme);return Object.keys(e).map((r=>g(e,t,r,n))).reduce(a.A,{})}function v(e){return y(e,c)}function b(e){return y(e,d)}function x(e){return y(e,h)}v.propTypes={},v.filterProps=c,b.propTypes={},b.filterProps=d,x.propTypes={},x.filterProps=h},8698:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(8168),s=n(8587),a=n(9172),i=n(7758);const o=["sx"],l=e=>{var t,n;const r={systemProps:{},otherProps:{}},s=null!=(t=null==e||null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:i.A;return Object.keys(e).forEach((t=>{s[t]?r.systemProps[t]=e[t]:r.otherProps[t]=e[t]})),r};function u(e){const{sx:t}=e,n=(0,s.A)(e,o),{systemProps:i,otherProps:u}=l(n);let c;return c=Array.isArray(t)?[i,...t]:"function"===typeof t?function(){const e=t(...arguments);return(0,a.Q)(e)?(0,r.A)({},i,e):i}:(0,r.A)({},i,t),(0,r.A)({},u,{sx:c})}},8812:(e,t,n)=>{"use strict";n.d(t,{A:()=>c,k:()=>l});var r=n(7598),s=n(3815),a=n(7162),i=n(9751),o=n(7758);function l(){function e(e,t,n,s){const o={[e]:t,theme:n},l=s[e];if(!l)return{[e]:t};const{cssProperty:u=e,themeKey:c,transform:d,style:h}=l;if(null==t)return null;if("typography"===c&&"inherit"===t)return{[e]:t};const p=(0,a.Yn)(n,c)||{};if(h)return h(o);return(0,i.NI)(o,t,(t=>{let n=(0,a.BO)(p,d,t);return t===n&&"string"===typeof t&&(n=(0,a.BO)(p,d,`${e}${"default"===t?"":(0,r.A)(t)}`,t)),!1===u?n:{[u]:n}}))}return function t(n){var r;const{sx:a,theme:l={}}=n||{};if(!a)return null;const u=null!=(r=l.unstable_sxConfig)?r:o.A;function c(n){let r=n;if("function"===typeof n)r=n(l);else if("object"!==typeof n)return n;if(!r)return null;const a=(0,i.EU)(l.breakpoints),o=Object.keys(a);let c=a;return Object.keys(r).forEach((n=>{const a=(o=r[n],d=l,"function"===typeof o?o(d):o);var o,d;if(null!==a&&void 0!==a)if("object"===typeof a)if(u[n])c=(0,s.A)(c,e(n,a,l,u));else{const e=(0,i.NI)({theme:l},a,(e=>({[n]:e})));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>e.concat(Object.keys(t))),[]),s=new Set(r);return t.every((e=>s.size===Object.keys(e).length))}(e,a)?c=(0,s.A)(c,e):c[n]=t({sx:a,theme:l})}else c=(0,s.A)(c,e(n,a,l,u))})),(0,i.vf)(o,c)}return Array.isArray(a)?a.map(c):c(a)}}const u=l();u.filterProps=["sx"];const c=u},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},9016:function(e,t,n){var r;!function(e,s){function a(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function o(e,t){var n=new a(e),r=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,r&&("object"==typeof r&&i(r,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(r=function(){return o}.call(t,n,t,s))||(s.exports=r):this.xorwow=o}(0,e=n.nmd(e),n.amdD)},9172:(e,t,n)=>{"use strict";n.d(t,{A:()=>o,Q:()=>a});var r=n(8168),s=n(5043);function a(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function i(e){if(s.isValidElement(e)||!a(e))return e;const t={};return Object.keys(e).forEach((n=>{t[n]=i(e[n])})),t}function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const l=n.clone?(0,r.A)({},e):e;return a(e)&&a(t)&&Object.keys(t).forEach((r=>{s.isValidElement(t[r])?l[r]=t[r]:a(t[r])&&Object.prototype.hasOwnProperty.call(e,r)&&a(e[r])?l[r]=o(e[r],t[r],n):n.clone?l[r]=a(t[r])?i(t[r]):t[r]:l[r]=t[r]})),l}},9369:(e,t,n)=>{"use strict";n.d(t,{C:()=>u,E:()=>g,T:()=>d,c:()=>f,h:()=>h,w:()=>c});var r=n(5043),s=n(3803),a=n(1722),i=n(6598),o=n(9436),l=r.createContext("undefined"!==typeof HTMLElement?(0,s.A)({key:"css"}):null),u=l.Provider,c=function(e){return(0,r.forwardRef)((function(t,n){var s=(0,r.useContext)(l);return e(t,s,n)}))},d=r.createContext({});var h={}.hasOwnProperty,p="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",f=function(e,t){var n={};for(var r in t)h.call(t,r)&&(n[r]=t[r]);return n[p]=e,n},m=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return(0,a.SF)(t,n,r),(0,o.s)((function(){return(0,a.sk)(t,n,r)})),null},g=c((function(e,t,n){var s=e.css;"string"===typeof s&&void 0!==t.registered[s]&&(s=t.registered[s]);var o=e[p],l=[s],u="";"string"===typeof e.className?u=(0,a.Rk)(t.registered,l,e.className):null!=e.className&&(u=e.className+" ");var c=(0,i.J)(l,void 0,r.useContext(d));u+=t.key+"-"+c.name;var f={};for(var g in e)h.call(e,g)&&"css"!==g&&g!==p&&(f[g]=e[g]);return f.className=u,n&&(f.ref=n),r.createElement(r.Fragment,null,r.createElement(m,{cache:t,serialized:c,isStringTag:"string"===typeof o}),r.createElement(o,f))}))},9436:(e,t,n)=>{"use strict";var r;n.d(t,{i:()=>o,s:()=>i});var s=n(5043),a=!!(r||(r=n.t(s,2))).useInsertionEffect&&(r||(r=n.t(s,2))).useInsertionEffect,i=a||function(e){return e()},o=a||s.useLayoutEffect},9482:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A,isPlainObject:()=>r.Q});var r=n(9172)},9538:function(e,t,n){var r;!function(e,s){function a(e){var t=this;t.next=function(){var e,n,r=t.x,s=t.i;return e=r[s],n=(e^=e>>>7)^e<<24,n^=(e=r[s+1&7])^e>>>10,n^=(e=r[s+3&7])^e>>>3,n^=(e=r[s+4&7])^e<<7,e=r[s+7&7],n^=(e^=e<<13)^e<<9,r[s]=n,t.i=s+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function o(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,r&&(r.x&&i(r,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(r=function(){return o}.call(t,n,t,s))||(s.exports=r):this.xorshift7=o}(0,e=n.nmd(e),n.amdD)},9703:(e,t,n)=>{"use strict";function r(e,t){const n=this;if(n.vars&&"function"===typeof n.getColorSchemeSelector){const r=n.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)");return{[r]:t}}return n.palette.mode===e?t:{}}n.d(t,{A:()=>r})},9751:(e,t,n)=>{"use strict";n.d(t,{EU:()=>o,NI:()=>i,iZ:()=>u,kW:()=>c,vf:()=>l,zu:()=>s});var r=n(9172);const s={xs:0,sm:600,md:900,lg:1200,xl:1536},a={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${s[e]}px)`};function i(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const e=r.breakpoints||a;return t.reduce(((r,s,a)=>(r[e.up(e.keys[a])]=n(t[a]),r)),{})}if("object"===typeof t){const e=r.breakpoints||a;return Object.keys(t).reduce(((r,a)=>{if(-1!==Object.keys(e.values||s).indexOf(a)){r[e.up(a)]=n(t[a],a)}else{const e=a;r[e]=t[e]}return r}),{})}return n(t)}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return(null==(t=e.keys)?void 0:t.reduce(((t,n)=>(t[e.up(n)]={},t)),{}))||{}}function l(e,t){return e.reduce(((e,t)=>{const n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function u(e){const t=o(e);for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];const i=[t,...s].reduce(((e,t)=>(0,r.A)(e,t)),{});return l(Object.keys(t),i)}function c(e){let{values:t,breakpoints:n,base:r}=e;const s=r||function(e,t){if("object"!==typeof e)return{};const n={},r=Object.keys(t);return Array.isArray(e)?r.forEach(((t,r)=>{r<e.length&&(n[t]=!0)})):r.forEach((t=>{null!=e[t]&&(n[t]=!0)})),n}(t,n),a=Object.keys(s);if(0===a.length)return t;let i;return a.reduce(((e,n,r)=>(Array.isArray(t)?(e[n]=null!=t[r]?t[r]:t[i],i=r):"object"===typeof t?(e[n]=null!=t[n]?t[n]:t[i],i=n):e[n]=t,e)),{})}}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,s){if(1&s&&(r=this(r)),8&s)return r;if("object"===typeof r&&r){if(4&s&&r.__esModule)return r;if(16&s&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&s&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>i[e]=()=>r[e]));return i.default=()=>r,n.d(a,i),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".9e1fc54f.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="remote-patient-monitoring-baadi:";n.l=(r,s,a,i)=>{if(e[r])e[r].push(s);else{var o,l;if(void 0!==a)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+a){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+a),o.src=r),e[r]=[s];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var s=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach((e=>e(n))),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var s=n.o(e,t)?e[t]:void 0;if(0!==s)if(s)r.push(s[2]);else{var a=new Promise(((n,r)=>s=e[t]=[n,r]));r.push(s[2]=a);var i=n.p+n.u(t),o=new Error;n.l(i,(r=>{if(n.o(e,t)&&(0!==(s=e[t])&&(e[t]=void 0),s)){var a=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",o.name="ChunkLoadError",o.type=a,o.request=i,s[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var s,a,i=r[0],o=r[1],l=r[2],u=0;if(i.some((t=>0!==e[t]))){for(s in o)n.o(o,s)&&(n.m[s]=o[s]);if(l)l(n)}for(t&&t(r);u<i.length;u++)a=i[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkremote_patient_monitoring_baadi=self.webpackChunkremote_patient_monitoring_baadi||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{CompositeArrayBuffer:()=>jP,browserFiles:()=>MB,browserHTTPRequest:()=>WB,concatenateArrayBuffers:()=>iz,copyModel:()=>Gz,decodeWeights:()=>QP,decodeWeightsStream:()=>nz,encodeWeights:()=>YP,fromMemory:()=>KB,fromMemorySync:()=>XB,getLoadHandlers:()=>yz,getModelArtifactsForJSON:()=>cz,getModelArtifactsForJSONSync:()=>uz,getModelArtifactsInfoForJSON:()=>dz,getSaveHandlers:()=>gz,getWeightSpecs:()=>hz,http:()=>VB,isHTTPScheme:()=>jB,listModels:()=>Vz,loadWeights:()=>PB,moveModel:()=>Hz,registerLoadRouter:()=>mz,registerSaveRouter:()=>fz,removeModel:()=>Wz,weightsLoaderFactory:()=>zB,withSaveHandler:()=>YB,withSaveHandlerSync:()=>QB});var t={};n.r(t),n.d(t,{assertParamsValid:()=>sj,computeFlatOffset:()=>yj,computeOutShape:()=>ij,getNormalizedAxes:()=>cj,isSliceContinous:()=>gj,maskToAxes:()=>aj,parseSliceParams:()=>vj,sliceInfo:()=>bj,startForAxis:()=>fj,startIndicesWithElidedDims:()=>dj,stopForAxis:()=>mj,stopIndicesWithElidedDims:()=>hj,stridesForAxis:()=>pj,stridesWithElidedDims:()=>oj});var r={};n.r(r),n.d(r,{conv2d:()=>$G,depthwiseConv2d:()=>MG,matMul:()=>FG});var s={};n.r(s),n.d(s,{collectGatherOpShapeInfo:()=>jq,computeOutShape:()=>Bq,segOpComputeOptimalWindowSize:()=>zq});var a={};n.r(a),n.d(a,{ERF_A1:()=>rq,ERF_A2:()=>sq,ERF_A3:()=>aq,ERF_A4:()=>iq,ERF_A5:()=>oq,ERF_P:()=>nq,PARALLELIZE_THRESHOLD:()=>GH,RowPartitionType:()=>zH,SELU_SCALE:()=>tq,SELU_SCALEALPHA:()=>eq,applyActivation:()=>RG,assertAndGetBroadcastShape:()=>CB,assertAxesAreInnerMostDims:()=>HU,assertParamsConsistent:()=>LH,assignToTypedArray:()=>pq,axesAreInnerMostDims:()=>UU,calculateShapes:()=>iG,checkEinsumDimSizes:()=>kq,checkPadOnDimRoundingMode:()=>qj,combineLocations:()=>VU,combineRaggedTensorToTensorShapes:()=>jH,complexWithEvenIndex:()=>cq,complexWithOddIndex:()=>dq,computeConv2DInfo:()=>Fj,computeConv3DInfo:()=>Lj,computeDefaultPad:()=>Pj,computeDilation2DInfo:()=>Oj,computeOptimalWindowSize:()=>HH,computeOutAndReduceShapes:()=>WU,computeOutShape:()=>PH,computePool2DInfo:()=>Dj,computePool3DInfo:()=>Mj,convertConv2DDataFormat:()=>Hj,decodeEinsumEquation:()=>xq,eitherStridesOrDilationsAreOne:()=>Wj,expandShapeToKeepDim:()=>GU,exponent:()=>mq,exponents:()=>fq,fromStringArrayToUint8:()=>Vq,fromUint8ToStringArray:()=>Uq,getAxesPermutation:()=>qU,getBroadcastDims:()=>SB,getComplexWithIndex:()=>hq,getEinsumComputePath:()=>Sq,getEinsumPermutation:()=>wq,getFusedBiasGradient:()=>AG,getFusedDyActivation:()=>EG,getImageCenter:()=>qH,getInnerMostAxes:()=>XU,getPermuted:()=>XH,getRaggedRank:()=>VH,getReductionAxes:()=>IB,getReshaped:()=>KH,getReshapedPermuted:()=>YH,getRowPartitionTypesHelper:()=>UH,getSliceBeginCoords:()=>QH,getSliceSize:()=>JH,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>Nq,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>Eq,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>Aq,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>$q,getSparseReshapeInputOutputMismatchErrorMessage:()=>Dq,getSparseReshapeInputOutputMultipleErrorMessage:()=>Oq,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>Rq,getSparseReshapeNegativeOutputDimErrorMessage:()=>_q,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>Pq,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>Mq,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>Fq,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>Lq,getUndoAxesPermutation:()=>KU,isIdentityPermutation:()=>Iq,log:()=>uL,mergeRealAndImagArrays:()=>lq,prepareAndValidate:()=>ZH,prepareSplitSize:()=>Tq,segment_util:()=>s,shouldFuse:()=>_G,slice_util:()=>t,splitRealAndImagArrays:()=>uq,stridesOrDilationsArePositive:()=>Gj,tupleValuesAreOne:()=>Vj,upcastType:()=>hP,validateDefaultValueShape:()=>WH,validateInput:()=>aG,validateUpdateShape:()=>sG,warn:()=>lL});var i={};n.r(i),n.d(i,{json:()=>m1});var o={};n.r(o),n.d(o,{json:()=>g1});var l={};n.r(l),n.d(l,{json:()=>y1});var u={};n.r(u),n.d(u,{json:()=>v1});var c={};n.r(c),n.d(c,{json:()=>b1});var d={};n.r(d),n.d(d,{json:()=>x1});var h={};n.r(h),n.d(h,{json:()=>w1});var p={};n.r(p),n.d(p,{json:()=>k1});var f={};n.r(f),n.d(f,{json:()=>S1});var m={};n.r(m),n.d(m,{json:()=>I1});var g={};n.r(g),n.d(g,{json:()=>C1});var y={};n.r(y),n.d(y,{json:()=>T1});var v={};n.r(v),n.d(v,{json:()=>N1});var b={};n.r(b),n.d(b,{json:()=>E1});var x={};n.r(x),n.d(x,{json:()=>A1});var w={};n.r(w),n.d(w,{json:()=>R1});var k={};n.r(k),n.d(k,{json:()=>_1});var S={};n.r(S),n.d(S,{json:()=>$1});var I={};n.r(I),n.d(I,{json:()=>O1});var C={};n.r(C),n.d(C,{OP_SCOPE_SUFFIX:()=>MP,abs:()=>kB,acos:()=>wj,acosh:()=>kj,add:()=>tB,addN:()=>Sj,all:()=>Ij,any:()=>Cj,argMax:()=>Tj,argMin:()=>Nj,asin:()=>Ej,asinh:()=>Aj,atan:()=>Rj,atan2:()=>_j,atanh:()=>$j,avgPool:()=>Xj,avgPool3d:()=>Yj,basicLSTMCell:()=>nU,batchNorm:()=>sU,batchNorm2d:()=>aU,batchNorm3d:()=>iU,batchNorm4d:()=>oU,batchToSpaceND:()=>rU,bincount:()=>lU,bitwiseAnd:()=>uU,booleanMaskAsync:()=>yG,broadcastArgs:()=>cU,broadcastTo:()=>dU,buffer:()=>Qz,cast:()=>Jz,ceil:()=>hU,clipByValue:()=>pU,clone:()=>Zz,complex:()=>LP,concat:()=>Qj,concat1d:()=>fU,concat2d:()=>mU,concat3d:()=>gU,concat4d:()=>yU,conv1d:()=>bU,conv2d:()=>vU,conv2dTranspose:()=>wU,conv3d:()=>kU,conv3dTranspose:()=>IU,cos:()=>CU,cosh:()=>TU,cosineWindow:()=>CG,cumprod:()=>NU,cumsum:()=>EU,denseBincount:()=>AU,depthToSpace:()=>RU,depthwiseConv2d:()=>_U,diag:()=>$U,dilation2d:()=>OU,div:()=>rB,divNoNan:()=>FU,dot:()=>LU,dropout:()=>SG,einsum:()=>PU,elu:()=>zU,enclosingPowerOfTwo:()=>IG,ensureShape:()=>BU,equal:()=>DU,erf:()=>jU,euclideanNorm:()=>tV,exp:()=>nV,expandDims:()=>rV,expm1:()=>sV,eye:()=>iV,fft:()=>UW,fill:()=>yB,floor:()=>oV,floorDiv:()=>nB,fused:()=>r,gather:()=>lV,gatherND:()=>kG,greater:()=>uV,greaterEqual:()=>cV,ifft:()=>VW,imag:()=>dV,image:()=>AH,inTopKAsync:()=>TG,irfft:()=>WW,isFinite:()=>hV,isInf:()=>pV,isNaN:()=>fV,leakyRelu:()=>mV,less:()=>gV,lessEqual:()=>yV,linalg:()=>RH,linspace:()=>vV,localResponseNormalization:()=>bV,log:()=>xV,log1p:()=>wV,logSigmoid:()=>IV,logSoftmax:()=>CV,logSumExp:()=>TV,logicalAnd:()=>NV,logicalNot:()=>EV,logicalOr:()=>AV,logicalXor:()=>RV,losses:()=>_H,lowerBound:()=>OV,matMul:()=>Jj,max:()=>YU,maxPool:()=>DV,maxPool3d:()=>MV,maxPoolWithArgmax:()=>FV,maximum:()=>TB,mean:()=>LV,meshgrid:()=>BV,min:()=>QU,minimum:()=>jV,mirrorPad:()=>UV,mod:()=>VV,moments:()=>WV,movingAverage:()=>bG,mul:()=>sB,multiRNNCell:()=>GV,multinomial:()=>HV,neg:()=>kV,norm:()=>eV,notEqual:()=>qV,oneHot:()=>KV,ones:()=>zV,onesLike:()=>XV,op:()=>FP,outerProduct:()=>YV,pad:()=>QV,pad1d:()=>JV,pad2d:()=>ZV,pad3d:()=>eW,pad4d:()=>tW,pool:()=>rW,pow:()=>bB,prelu:()=>sW,print:()=>eB,prod:()=>aW,raggedGather:()=>iW,raggedRange:()=>oW,raggedTensorToTensor:()=>lW,rand:()=>uW,randomGamma:()=>fW,randomNormal:()=>mW,randomStandardNormal:()=>gW,randomUniform:()=>yW,randomUniformInt:()=>vW,range:()=>bW,real:()=>xW,reciprocal:()=>wW,relu:()=>kW,relu6:()=>SW,reshape:()=>Kj,reverse:()=>IW,reverse1d:()=>CW,reverse2d:()=>TW,reverse3d:()=>NW,reverse4d:()=>EW,rfft:()=>HW,round:()=>AW,rsqrt:()=>RW,scalar:()=>uB,scatterND:()=>xG,searchSorted:()=>$V,selu:()=>_W,separableConv2d:()=>$W,setdiff1dAsync:()=>OW,sigmoid:()=>Zj,sign:()=>DW,signal:()=>EH,sin:()=>MW,sinh:()=>FW,slice:()=>eU,slice1d:()=>LW,slice2d:()=>PW,slice3d:()=>zW,slice4d:()=>BW,softmax:()=>jW,softplus:()=>SV,spaceToBatchND:()=>nW,sparse:()=>$H,sparseToDense:()=>wG,spectral:()=>NH,split:()=>GW,sqrt:()=>aB,square:()=>iB,squaredDifference:()=>qW,squeeze:()=>KW,stack:()=>XW,step:()=>YW,stridedSlice:()=>QW,string:()=>OH,sub:()=>xB,sum:()=>JU,tan:()=>JW,tanh:()=>tU,tensor:()=>zP,tensor1d:()=>ZW,tensor2d:()=>eG,tensor3d:()=>JB,tensor4d:()=>tG,tensor5d:()=>nG,tensor6d:()=>rG,tensorScatterUpdate:()=>oG,tile:()=>aV,topk:()=>lG,transpose:()=>vG,truncatedNormal:()=>uG,unique:()=>cG,unsortedSegmentSum:()=>dG,unstack:()=>hG,upperBound:()=>pG,variable:()=>fG,where:()=>MU,whereAsync:()=>gG,zeros:()=>PV,zerosLike:()=>oB});var T={};n.r(T),n.d(T,{mx:()=>D3,XI:()=>T4,Nk:()=>N4,f6:()=>A4,ct:()=>A3,YG:()=>O4,hH:()=>z4,z3:()=>S5,sG:()=>D5,uM:()=>z5,vS:()=>n6,qB:()=>c6,GG:()=>h6,lg:()=>y6,rq:()=>f6,cu:()=>R6,WR:()=>N6,GE:()=>O6,px:()=>M6,jC:()=>Y6,He:()=>Z6,hE:()=>u9,BF:()=>m5,Dk:()=>b9,cl:()=>N9,_B:()=>B9,ub:()=>G9,_f:()=>K9,Ku:()=>e8,qy:()=>n8,Zy:()=>f8,bu:()=>y8,zv:()=>x3,dH:()=>V3,HS:()=>k4,yH:()=>L8,l3:()=>z8,z9:()=>j8,x6:()=>H8,_m:()=>Z8,eW:()=>s7,GK:()=>o7,SP:()=>c7,yr:()=>h7,dl:()=>G5,Dw:()=>y7,xT:()=>x7,_X:()=>Y3,wz:()=>C7});var N,E,A=n(5043),R=n.t(A,2),_=n(4391);function $(){return $=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$.apply(this,arguments)}(E=N||(N={})).Pop="POP",E.Push="PUSH",E.Replace="REPLACE";const O="popstate";function D(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function M(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function F(e,t){return{usr:e.state,key:e.key,idx:t}}function L(e,t,n,r){return void 0===n&&(n=null),$({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?z(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function P(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function z(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function B(e,t,n,r){void 0===r&&(r={});let{window:s=document.defaultView,v5Compat:a=!1}=r,i=s.history,o=N.Pop,l=null,u=c();function c(){return(i.state||{idx:null}).idx}function d(){o=N.Pop;let e=c(),t=null==e?null:e-u;u=e,l&&l({action:o,location:p.location,delta:t})}function h(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:P(e);return n=n.replace(/ $/,"%20"),D(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==u&&(u=0,i.replaceState($({},i.state,{idx:u}),""));let p={get action(){return o},get location(){return e(s,i)},listen(e){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(O,d),l=e,()=>{s.removeEventListener(O,d),l=null}},createHref:e=>t(s,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=N.Push;let r=L(p.location,e,t);n&&n(r,e),u=c()+1;let d=F(r,u),h=p.createHref(r);try{i.pushState(d,"",h)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;s.location.assign(h)}a&&l&&l({action:o,location:p.location,delta:1})},replace:function(e,t){o=N.Replace;let r=L(p.location,e,t);n&&n(r,e),u=c();let s=F(r,u),d=p.createHref(r);i.replaceState(s,"",d),a&&l&&l({action:o,location:p.location,delta:0})},go:e=>i.go(e)};return p}var j,U;(U=j||(j={})).data="data",U.deferred="deferred",U.redirect="redirect",U.error="error";new Set(["lazy","caseSensitive","path","id","index","children"]);function V(e,t,n){return void 0===n&&(n="/"),W(e,t,n,!1)}function W(e,t,n,r){let s=se(("string"===typeof t?z(t):t).pathname||"/",n);if(null==s)return null;let a=G(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(a);let i=null;for(let o=0;null==i&&o<a.length;++o){let e=re(s);i=te(a[o],e,r)}return i}function G(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let s=(e,s,a)=>{let i={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};i.relativePath.startsWith("/")&&(D(i.relativePath.startsWith(r),'Absolute route path "'+i.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(r.length));let o=ue([r,i.relativePath]),l=n.concat(i);e.children&&e.children.length>0&&(D(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),G(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:ee(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of H(e.path))s(e,t,r);else s(e,t)})),t}function H(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,s=n.endsWith("?"),a=n.replace(/\?$/,"");if(0===r.length)return s?[a,""]:[a];let i=H(r.join("/")),o=[];return o.push(...i.map((e=>""===e?a:[a,e].join("/")))),s&&o.push(...i),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const q=/^:[\w-]+$/,K=3,X=2,Y=1,Q=10,J=-2,Z=e=>"*"===e;function ee(e,t){let n=e.split("/"),r=n.length;return n.some(Z)&&(r+=J),t&&(r+=X),n.filter((e=>!Z(e))).reduce(((e,t)=>e+(q.test(t)?K:""===t?Y:Q)),r)}function te(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,s={},a="/",i=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,u="/"===a?t:t.slice(a.length)||"/",c=ne({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},u),d=e.route;if(!c&&l&&n&&!r[r.length-1].route.index&&(c=ne({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},u)),!c)return null;Object.assign(s,c.params),i.push({params:s,pathname:ue([a,c.pathname]),pathnameBase:ce(ue([a,c.pathnameBase])),route:d}),"/"!==c.pathnameBase&&(a=ue([a,c.pathnameBase]))}return i}function ne(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);M("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),s+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":""!==e&&"/"!==e&&(s+="(?:(?=\\/|$))");let a=new RegExp(s,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:s}=t;if("*"===r){let e=o[n]||"";i=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=s&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:a,pathnameBase:i,pattern:e}}function re(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return M(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function se(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function ae(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function ie(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function oe(e,t){let n=ie(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function le(e,t,n,r){let s;void 0===r&&(r=!1),"string"===typeof e?s=z(e):(s=$({},e),D(!s.pathname||!s.pathname.includes("?"),ae("?","pathname","search",s)),D(!s.pathname||!s.pathname.includes("#"),ae("#","pathname","hash",s)),D(!s.search||!s.search.includes("#"),ae("#","search","hash",s)));let a,i=""===e||""===s.pathname,o=i?"/":s.pathname;if(null==o)a=n;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;s.pathname=t.join("/")}a=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:s=""}="string"===typeof e?z(e):e,a=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:a,search:de(r),hash:he(s)}}(s,a),u=o&&"/"!==o&&o.endsWith("/"),c=(i||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!u&&!c||(l.pathname+="/"),l}const ue=e=>e.join("/").replace(/\/\/+/g,"/"),ce=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),de=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",he=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function pe(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const fe=["post","put","patch","delete"],me=(new Set(fe),["get",...fe]);new Set(me),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function ge(){return ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ge.apply(this,arguments)}const ye=A.createContext(null);const ve=A.createContext(null);const be=A.createContext(null);const xe=A.createContext(null);const we=A.createContext({outlet:null,matches:[],isDataRoute:!1});const ke=A.createContext(null);function Se(){return null!=A.useContext(xe)}function Ie(){return Se()||D(!1),A.useContext(xe).location}function Ce(e){A.useContext(be).static||A.useLayoutEffect(e)}function Te(){let{isDataRoute:e}=A.useContext(we);return e?function(){let{router:e}=Fe(De.UseNavigateStable),t=Pe(Me.UseNavigateStable),n=A.useRef(!1);return Ce((()=>{n.current=!0})),A.useCallback((function(r,s){void 0===s&&(s={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,ge({fromRouteId:t},s)))}),[e,t])}():function(){Se()||D(!1);let e=A.useContext(ye),{basename:t,future:n,navigator:r}=A.useContext(be),{matches:s}=A.useContext(we),{pathname:a}=Ie(),i=JSON.stringify(oe(s,n.v7_relativeSplatPath)),o=A.useRef(!1);return Ce((()=>{o.current=!0})),A.useCallback((function(n,s){if(void 0===s&&(s={}),!o.current)return;if("number"===typeof n)return void r.go(n);let l=le(n,JSON.parse(i),a,"path"===s.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:ue([t,l.pathname])),(s.replace?r.replace:r.push)(l,s.state,s)}),[t,r,i,a,e])}()}function Ne(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=A.useContext(be),{matches:s}=A.useContext(we),{pathname:a}=Ie(),i=JSON.stringify(oe(s,r.v7_relativeSplatPath));return A.useMemo((()=>le(e,JSON.parse(i),a,"path"===n)),[e,i,a,n])}function Ee(e,t,n,r){Se()||D(!1);let{navigator:s,static:a}=A.useContext(be),{matches:i}=A.useContext(we),o=i[i.length-1],l=o?o.params:{},u=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let c,d=Ie();if(t){var h;let e="string"===typeof t?z(t):t;"/"===u||(null==(h=e.pathname)?void 0:h.startsWith(u))||D(!1),c=e}else c=d;let p=c.pathname||"/",f=p;if("/"!==u){let e=u.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let m=!a&&n&&n.matches&&n.matches.length>0?n.matches:V(e,{pathname:f});let g=Oe(m&&m.map((e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:ue([u,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:ue([u,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),i,n,r);return t&&g?A.createElement(xe.Provider,{value:{location:ge({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:N.Pop}},g):g}function Ae(){let e=function(){var e;let t=A.useContext(ke),n=Le(Me.UseRouteError),r=Pe(Me.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=pe(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r};return A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},t),n?A.createElement("pre",{style:s},n):null,null)}const Re=A.createElement(Ae,null);class _e extends A.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?A.createElement(we.Provider,{value:this.props.routeContext},A.createElement(ke.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function $e(e){let{routeContext:t,match:n,children:r}=e,s=A.useContext(ye);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),A.createElement(we.Provider,{value:t},r)}function Oe(e,t,n,r){var s;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var a;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(a=r)&&a.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let i=e,o=null==(s=n)?void 0:s.errors;if(null!=o){let e=i.findIndex((e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id])));e>=0||D(!1),i=i.slice(0,Math.min(i.length,e+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<i.length;c++){let e=i[c];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=c),e.route.id){let{loaderData:t,errors:r}=n,s=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||s){l=!0,i=u>=0?i.slice(0,u+1):[i[0]];break}}}return i.reduceRight(((e,r,s)=>{let a,c=!1,d=null,h=null;var p;n&&(a=o&&r.route.id?o[r.route.id]:void 0,d=r.route.errorElement||Re,l&&(u<0&&0===s?(p="route-fallback",!1||ze[p]||(ze[p]=!0),c=!0,h=null):u===s&&(c=!0,h=r.route.hydrateFallbackElement||null)));let f=t.concat(i.slice(0,s+1)),m=()=>{let t;return t=a?d:c?h:r.route.Component?A.createElement(r.route.Component,null):r.route.element?r.route.element:e,A.createElement($e,{match:r,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===s)?A.createElement(_e,{location:n.location,revalidation:n.revalidation,component:d,error:a,children:m(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):m()}),null)}var De=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(De||{}),Me=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Me||{});function Fe(e){let t=A.useContext(ye);return t||D(!1),t}function Le(e){let t=A.useContext(ve);return t||D(!1),t}function Pe(e){let t=function(){let e=A.useContext(we);return e||D(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||D(!1),n.route.id}const ze={};function Be(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}R.startTransition;function je(e){let{to:t,replace:n,state:r,relative:s}=e;Se()||D(!1);let{future:a,static:i}=A.useContext(be),{matches:o}=A.useContext(we),{pathname:l}=Ie(),u=Te(),c=le(t,oe(o,a.v7_relativeSplatPath),l,"path"===s),d=JSON.stringify(c);return A.useEffect((()=>u(JSON.parse(d),{replace:n,state:r,relative:s})),[u,d,s,n,r]),null}function Ue(e){D(!1)}function Ve(e){let{basename:t="/",children:n=null,location:r,navigationType:s=N.Pop,navigator:a,static:i=!1,future:o}=e;Se()&&D(!1);let l=t.replace(/^\/*/,"/"),u=A.useMemo((()=>({basename:l,navigator:a,static:i,future:ge({v7_relativeSplatPath:!1},o)})),[l,o,a,i]);"string"===typeof r&&(r=z(r));let{pathname:c="/",search:d="",hash:h="",state:p=null,key:f="default"}=r,m=A.useMemo((()=>{let e=se(c,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:p,key:f},navigationType:s}}),[l,c,d,h,p,f,s]);return null==m?null:A.createElement(be.Provider,{value:u},A.createElement(xe.Provider,{children:n,value:m}))}function We(e){let{children:t,location:n}=e;return Ee(Ge(t),n)}new Promise((()=>{}));A.Component;function Ge(e,t){void 0===t&&(t=[]);let n=[];return A.Children.forEach(e,((e,r)=>{if(!A.isValidElement(e))return;let s=[...t,r];if(e.type===A.Fragment)return void n.push.apply(n,Ge(e.props.children,s));e.type!==Ue&&D(!1),e.props.index&&e.props.children&&D(!1);let a={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=Ge(e.props.children,s)),n.push(a)})),n}var He=n(8168),qe=n(8587);function Ke(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=Ke(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const Xe=function(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=Ke(e))&&(r&&(r+=" "),r+=t);return r};var Ye=n(3174),Qe=n(8812),Je=n(8698),Ze=n(8280),et=n(9369);const tt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=A.useContext(et.T);return t&&(n=t,0!==Object.keys(n).length)?t:e;var n},nt=(0,Ze.A)();const rt=function(){return tt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt)};var st=n(579);const at=["className","component"];const it=e=>e,ot=(()=>{let e=it;return{configure(t){e=t},generate:t=>e(t),reset(){e=it}}})();var lt=n(7868),ut=n(9172),ct=n(7758);var dt=n(7266);const ht={black:"#000",white:"#fff"},pt={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},ft={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},mt={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},gt={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},yt={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},vt={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},bt={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},xt=["mode","contrastThreshold","tonalOffset"],wt={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:ht.white,default:ht.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},kt={text:{primary:ht.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:ht.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function St(e,t,n,r){const s=r.light||r,a=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=(0,dt.a)(e.main,s):"dark"===t&&(e.dark=(0,dt.e$)(e.main,a)))}function It(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:r=.2}=e,s=(0,qe.A)(e,xt),a=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:yt[200],light:yt[50],dark:yt[400]}:{main:yt[700],light:yt[400],dark:yt[800]}}(t),i=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:ft[200],light:ft[50],dark:ft[400]}:{main:ft[500],light:ft[300],dark:ft[700]}}(t),o=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:mt[500],light:mt[300],dark:mt[700]}:{main:mt[700],light:mt[400],dark:mt[800]}}(t),l=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:vt[400],light:vt[300],dark:vt[700]}:{main:vt[700],light:vt[500],dark:vt[900]}}(t),u=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:bt[400],light:bt[300],dark:bt[700]}:{main:bt[800],light:bt[500],dark:bt[900]}}(t),c=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:gt[400],light:gt[300],dark:gt[700]}:{main:"#ed6c02",light:gt[500],dark:gt[900]}}(t);function d(e){return(0,dt.eM)(e,kt.text.primary)>=n?kt.text.primary:wt.text.primary}const h=e=>{let{color:t,name:n,mainShade:s=500,lightShade:a=300,darkShade:i=700}=e;if(t=(0,He.A)({},t),!t.main&&t[s]&&(t.main=t[s]),!t.hasOwnProperty("main"))throw new Error((0,lt.A)(11,n?` (${n})`:"",s));if("string"!==typeof t.main)throw new Error((0,lt.A)(12,n?` (${n})`:"",JSON.stringify(t.main)));return St(t,"light",a,r),St(t,"dark",i,r),t.contrastText||(t.contrastText=d(t.main)),t},p={dark:kt,light:wt};return(0,ut.A)((0,He.A)({common:(0,He.A)({},ht),mode:t,primary:h({color:a,name:"primary"}),secondary:h({color:i,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:o,name:"error"}),warning:h({color:c,name:"warning"}),info:h({color:l,name:"info"}),success:h({color:u,name:"success"}),grey:pt,contrastThreshold:n,getContrastText:d,augmentColor:h,tonalOffset:r},p[t]),s)}const Ct=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const Tt={textTransform:"uppercase"},Nt='"Roboto", "Helvetica", "Arial", sans-serif';function Et(e,t){const n="function"===typeof t?t(e):t,{fontFamily:r=Nt,fontSize:s=14,fontWeightLight:a=300,fontWeightRegular:i=400,fontWeightMedium:o=500,fontWeightBold:l=700,htmlFontSize:u=16,allVariants:c,pxToRem:d}=n,h=(0,qe.A)(n,Ct);const p=s/14,f=d||(e=>e/u*p+"rem"),m=(e,t,n,s,a)=>{return(0,He.A)({fontFamily:r,fontWeight:e,fontSize:f(t),lineHeight:n},r===Nt?{letterSpacing:(i=s/t,Math.round(1e5*i)/1e5)+"em"}:{},a,c);var i},g={h1:m(a,96,1.167,-1.5),h2:m(a,60,1.2,-.5),h3:m(i,48,1.167,0),h4:m(i,34,1.235,.25),h5:m(i,24,1.334,0),h6:m(o,20,1.6,.15),subtitle1:m(i,16,1.75,.15),subtitle2:m(o,14,1.57,.1),body1:m(i,16,1.5,.15),body2:m(i,14,1.43,.15),button:m(o,14,1.75,.4,Tt),caption:m(i,12,1.66,.4),overline:m(i,12,2.66,1,Tt),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return(0,ut.A)((0,He.A)({htmlFontSize:u,pxToRem:f,fontFamily:r,fontSize:s,fontWeightLight:a,fontWeightRegular:i,fontWeightMedium:o,fontWeightBold:l},g),h,{clone:!1})}function At(){return[`${arguments.length<=0?void 0:arguments[0]}px ${arguments.length<=1?void 0:arguments[1]}px ${arguments.length<=2?void 0:arguments[2]}px ${arguments.length<=3?void 0:arguments[3]}px rgba(0,0,0,0.2)`,`${arguments.length<=4?void 0:arguments[4]}px ${arguments.length<=5?void 0:arguments[5]}px ${arguments.length<=6?void 0:arguments[6]}px ${arguments.length<=7?void 0:arguments[7]}px rgba(0,0,0,0.14)`,`${arguments.length<=8?void 0:arguments[8]}px ${arguments.length<=9?void 0:arguments[9]}px ${arguments.length<=10?void 0:arguments[10]}px ${arguments.length<=11?void 0:arguments[11]}px rgba(0,0,0,0.12)`].join(",")}const Rt=["none",At(0,2,1,-1,0,1,1,0,0,1,3,0),At(0,3,1,-2,0,2,2,0,0,1,5,0),At(0,3,3,-2,0,3,4,0,0,1,8,0),At(0,2,4,-1,0,4,5,0,0,1,10,0),At(0,3,5,-1,0,5,8,0,0,1,14,0),At(0,3,5,-1,0,6,10,0,0,1,18,0),At(0,4,5,-2,0,7,10,1,0,2,16,1),At(0,5,5,-3,0,8,10,1,0,3,14,2),At(0,5,6,-3,0,9,12,1,0,3,16,2),At(0,6,6,-3,0,10,14,1,0,4,18,3),At(0,6,7,-4,0,11,15,1,0,4,20,3),At(0,7,8,-4,0,12,17,2,0,5,22,4),At(0,7,8,-4,0,13,19,2,0,5,24,4),At(0,7,9,-4,0,14,21,2,0,5,26,4),At(0,8,9,-5,0,15,22,2,0,6,28,5),At(0,8,10,-5,0,16,24,2,0,6,30,5),At(0,8,11,-5,0,17,26,2,0,6,32,5),At(0,9,11,-5,0,18,28,2,0,7,34,6),At(0,9,12,-6,0,19,29,2,0,7,36,6),At(0,10,13,-6,0,20,31,3,0,8,38,7),At(0,10,13,-6,0,21,33,3,0,8,40,7),At(0,10,14,-6,0,22,35,3,0,8,42,7),At(0,11,14,-7,0,23,36,3,0,9,44,8),At(0,11,15,-7,0,24,38,3,0,9,46,8)],_t=["duration","easing","delay"],$t={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Ot={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Dt(e){return`${Math.round(e)}ms`}function Mt(e){if(!e)return 0;const t=e/36;return Math.round(10*(4+15*t**.25+t/5))}function Ft(e){const t=(0,He.A)({},$t,e.easing),n=(0,He.A)({},Ot,e.duration);return(0,He.A)({getAutoHeightDuration:Mt,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:s=n.standard,easing:a=t.easeInOut,delay:i=0}=r;(0,qe.A)(r,_t);return(Array.isArray(e)?e:[e]).map((e=>`${e} ${"string"===typeof s?s:Dt(s)} ${a} ${"string"===typeof i?i:Dt(i)}`)).join(",")}},e,{easing:t,duration:n})}const Lt={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Pt=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function zt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mixins:t={},palette:n={},transitions:r={},typography:s={}}=e,a=(0,qe.A)(e,Pt);if(e.vars&&void 0===e.generateCssVars)throw new Error((0,lt.A)(18));const i=It(n),o=(0,Ze.A)(e);let l=(0,ut.A)(o,{mixins:(u=o.breakpoints,c=t,(0,He.A)({toolbar:{minHeight:56,[u.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[u.up("sm")]:{minHeight:64}}},c)),palette:i,shadows:Rt.slice(),typography:Et(i,s),transitions:Ft(r),zIndex:(0,He.A)({},Lt)});var u,c;l=(0,ut.A)(l,a);for(var d=arguments.length,h=new Array(d>1?d-1:0),p=1;p<d;p++)h[p-1]=arguments[p];return l=h.reduce(((e,t)=>(0,ut.A)(e,t)),l),l.unstable_sxConfig=(0,He.A)({},ct.A,null==a?void 0:a.unstable_sxConfig),l.unstable_sx=function(e){return(0,Qe.A)({sx:e,theme:this})},l}const Bt=zt,jt="$$material",Ut={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Vt(e,t){const n=Ut[t];return n?`${arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui"}-${n}`:`${ot.generate(e)}-${t}`}function Wt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const r={};return t.forEach((t=>{r[t]=Vt(e,t,n)})),r}const Gt=Wt("MuiBox",["root"]),Ht=Bt(),qt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:s}=e,a=(0,Ye.default)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(Qe.A);return A.forwardRef((function(e,i){const o=rt(n),l=(0,Je.A)(e),{className:u,component:c="div"}=l,d=(0,qe.A)(l,at);return(0,st.jsx)(a,(0,He.A)({as:c,ref:i,className:Xe(u,s?s(r):r),theme:t&&o[t]||o},d))}))}({themeId:jt,defaultTheme:Ht,defaultClassName:Gt.root,generateClassName:ot.generate}),Kt=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296===(64512&s)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},Xt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const t=e[s],a=s+1<e.length,i=a?e[s+1]:0,o=s+2<e.length,l=o?e[s+2]:0,u=t>>2,c=(3&t)<<4|i>>4;let d=(15&i)<<2|l>>6,h=63&l;o||(h=64,a||(d=64)),r.push(n[u],n[c],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Kt(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&a)}else if(s>239&&s<365){const a=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],i=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&a)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const t=n[e.charAt(s++)],a=s<e.length?n[e.charAt(s)]:0;++s;const i=s<e.length?n[e.charAt(s)]:64;++s;const o=s<e.length?n[e.charAt(s)]:64;if(++s,null==t||null==a||null==i||null==o)throw new Yt;const l=t<<2|a>>4;if(r.push(l),64!==i){const e=a<<4&240|i>>2;if(r.push(e),64!==o){const e=i<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Yt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Qt=function(e){return function(e){const t=Kt(e);return Xt.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Jt=function(e){try{return Xt.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const Zt=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,en=()=>{try{return Zt()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDlvkj8DgXD0iwKWC9btSpY19OiAZmVZxw",REACT_APP_FIREBASE_APP_ID:"1:657000742089:web:245b00c6be06a35f036118",REACT_APP_FIREBASE_AUTH_DOMAIN:"baadi-98448.firebaseapp.com",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-9787N1J6F6",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"657000742089",REACT_APP_FIREBASE_PROJECT_ID:"baadi-98448",REACT_APP_FIREBASE_STORAGE_BUCKET:"baadi-98448.firebasestorage.app",REACT_APP_FIREBASE_VAPID_KEY:"BHS9FiDvrQ3H6ldUNLCwSn34inyJf3tcG_GLnp82eNIhLAf58Ialoe1CDuOK--JI-vIg8rPOEd0soSOrIyuTYqkW"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&Jt(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},tn=e=>{var t,n;return null===(n=null===(t=en())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},nn=e=>{const t=tn(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},rn=()=>{var e;return null===(e=en())||void 0===e?void 0:e.config},sn=e=>{var t;return null===(t=en())||void 0===t?void 0:t[`_${e}`]};class an{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function on(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Qt(JSON.stringify({alg:"none",type:"JWT"})),Qt(JSON.stringify(a)),""].join(".")}function ln(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function un(){var e;const t=null===(e=en())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function cn(){try{return"object"===typeof indexedDB}catch(e){return!1}}function dn(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var e;t((null===(e=s.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class hn extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,hn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pn.prototype.create)}}class pn{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],s=r?function(e,t){return e.replace(fn,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(r,t):"Error",a=`${this.serviceName}: ${s} (${n}).`;return new hn(n,a,t)}}const fn=/\{\$([^}]+)}/g;function mn(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],a=t[s];if(gn(n)&&gn(a)){if(!mn(n,a))return!1}else if(n!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function gn(e){return null!==e&&"object"===typeof e}function yn(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function vn(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function bn(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class xn{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=wn),void 0===r.error&&(r.error=wn),void 0===r.complete&&(r.complete=wn);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function wn(){}function kn(e){return e&&e._delegate?e._delegate:e}class Sn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const In="[DEFAULT]";class Cn{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new an;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:In})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:In;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:In;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:In;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&a.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===In?void 0:s),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(a){}var s;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:In;return this.component?this.component.multipleInstances?e:In:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Tn{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Cn(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Nn=[];var En,An;(An=En||(En={}))[An.DEBUG=0]="DEBUG",An[An.VERBOSE=1]="VERBOSE",An[An.INFO=2]="INFO",An[An.WARN=3]="WARN",An[An.ERROR=4]="ERROR",An[An.SILENT=5]="SILENT";const Rn={debug:En.DEBUG,verbose:En.VERBOSE,info:En.INFO,warn:En.WARN,error:En.ERROR,silent:En.SILENT},_n=En.INFO,$n={[En.DEBUG]:"log",[En.VERBOSE]:"log",[En.INFO]:"info",[En.WARN]:"warn",[En.ERROR]:"error"},On=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=$n[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var s=arguments.length,a=new Array(s>2?s-2:0),i=2;i<s;i++)a[i-2]=arguments[i];console[r](`[${n}]  ${e.name}:`,...a)};class Dn{constructor(e){this.name=e,this._logLevel=_n,this._logHandler=On,this._userLogHandler=null,Nn.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in En))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Rn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,En.DEBUG,...t),this._logHandler(this,En.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,En.VERBOSE,...t),this._logHandler(this,En.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,En.INFO,...t),this._logHandler(this,En.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,En.WARN,...t),this._logHandler(this,En.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,En.ERROR,...t),this._logHandler(this,En.ERROR,...t)}}let Mn,Fn;const Ln=new WeakMap,Pn=new WeakMap,zn=new WeakMap,Bn=new WeakMap,jn=new WeakMap;let Un={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Pn.get(e);if("objectStoreNames"===t)return e.objectStoreNames||zn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Gn(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Vn(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Fn||(Fn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Hn(this),n),Gn(Ln.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Gn(e.apply(Hn(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];const a=e.call(Hn(this),t,...r);return zn.set(a,t.sort?t.sort():[t]),Gn(a)}}function Wn(e){return"function"===typeof e?Vn(e):(e instanceof IDBTransaction&&function(e){if(Pn.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)}));Pn.set(e,t)}(e),t=e,(Mn||(Mn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,Un):e);var t}function Gn(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{t(Gn(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&Ln.set(t,e)})).catch((()=>{})),jn.set(t,e),t}(e);if(Bn.has(e))return Bn.get(e);const t=Wn(e);return t!==e&&(Bn.set(e,t),jn.set(t,e)),t}const Hn=e=>jn.get(e);const qn=["get","getKey","getAll","getAllKeys","count"],Kn=["put","add","delete","clear"],Xn=new Map;function Yn(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Xn.get(t))return Xn.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=Kn.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!qn.includes(n))return;const a=async function(e){const t=this.transaction(e,s?"readwrite":"readonly");let a=t.store;for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return r&&(a=a.index(o.shift())),(await Promise.all([a[n](...o),s&&t.done]))[0]};return Xn.set(t,a),a}Un=(e=>({...e,get:(t,n,r)=>Yn(t,n)||e.get(t,n,r),has:(t,n)=>!!Yn(t,n)||e.has(t,n)}))(Un);class Qn{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Jn="@firebase/app",Zn="0.9.13",er=new Dn("@firebase/app"),tr="@firebase/app-compat",nr="@firebase/analytics-compat",rr="@firebase/analytics",sr="@firebase/app-check-compat",ar="@firebase/app-check",ir="@firebase/auth",or="@firebase/auth-compat",lr="@firebase/database",ur="@firebase/database-compat",cr="@firebase/functions",dr="@firebase/functions-compat",hr="@firebase/installations",pr="@firebase/installations-compat",fr="@firebase/messaging",mr="@firebase/messaging-compat",gr="@firebase/performance",yr="@firebase/performance-compat",vr="@firebase/remote-config",br="@firebase/remote-config-compat",xr="@firebase/storage",wr="@firebase/storage-compat",kr="@firebase/firestore",Sr="@firebase/firestore-compat",Ir="firebase",Cr="[DEFAULT]",Tr={[Jn]:"fire-core",[tr]:"fire-core-compat",[rr]:"fire-analytics",[nr]:"fire-analytics-compat",[ar]:"fire-app-check",[sr]:"fire-app-check-compat",[ir]:"fire-auth",[or]:"fire-auth-compat",[lr]:"fire-rtdb",[ur]:"fire-rtdb-compat",[cr]:"fire-fn",[dr]:"fire-fn-compat",[hr]:"fire-iid",[pr]:"fire-iid-compat",[fr]:"fire-fcm",[mr]:"fire-fcm-compat",[gr]:"fire-perf",[yr]:"fire-perf-compat",[vr]:"fire-rc",[br]:"fire-rc-compat",[xr]:"fire-gcs",[wr]:"fire-gcs-compat",[kr]:"fire-fst",[Sr]:"fire-fst-compat","fire-js":"fire-js",[Ir]:"fire-js-all"},Nr=new Map,Er=new Map;function Ar(e,t){try{e.container.addComponent(t)}catch(n){er.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Rr(e){const t=e.name;if(Er.has(t))return er.debug(`There were multiple attempts to register component ${t}.`),!1;Er.set(t,e);for(const n of Nr.values())Ar(n,e);return!0}function _r(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const $r=new pn("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Or{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Sn("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw $r.create("app-deleted",{appName:this._name})}}const Dr="9.23.0";function Mr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:Cr,automaticDataCollectionEnabled:!1},t),s=r.name;if("string"!==typeof s||!s)throw $r.create("bad-app-name",{appName:String(s)});if(n||(n=rn()),!n)throw $r.create("no-options");const a=Nr.get(s);if(a){if(mn(n,a.options)&&mn(r,a.config))return a;throw $r.create("duplicate-app",{appName:s})}const i=new Tn(s);for(const l of Er.values())i.addComponent(l);const o=new Or(n,r,i);return Nr.set(s,o),o}function Fr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr;const t=Nr.get(e);if(!t&&e===Cr&&rn())return Mr();if(!t)throw $r.create("no-app",{appName:e});return t}function Lr(e,t,n){var r;let s=null!==(r=Tr[e])&&void 0!==r?r:e;n&&(s+=`-${n}`);const a=s.match(/\s|\//),i=t.match(/\s|\//);if(a||i){const e=[`Unable to register library "${s}" with version "${t}":`];return a&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&i&&e.push("and"),i&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void er.warn(e.join(" "))}Rr(new Sn(`${s}-version`,(()=>({library:s,version:t})),"VERSION"))}const Pr="firebase-heartbeat-store";let zr=null;function Br(){return zr||(zr=function(e,t){let{blocked:n,upgrade:r,blocking:s,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),o=Gn(i);return r&&i.addEventListener("upgradeneeded",(e=>{r(Gn(i.result),e.oldVersion,e.newVersion,Gn(i.transaction),e)})),n&&i.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{a&&e.addEventListener("close",(()=>a())),s&&e.addEventListener("versionchange",(e=>s(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Pr)}}).catch((e=>{throw $r.create("idb-open",{originalErrorMessage:e.message})}))),zr}async function jr(e,t){try{const n=(await Br()).transaction(Pr,"readwrite"),r=n.objectStore(Pr);await r.put(t,Ur(e)),await n.done}catch(n){if(n instanceof hn)er.warn(n.message);else{const e=$r.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});er.warn(e.message)}}}function Ur(e){return`${e.name}!${e.options.appId}`}class Vr{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Gr(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Wr();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Wr(),{heartbeatsToSend:t,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const s of e){const e=n.find((e=>e.agent===s.agent));if(e){if(e.dates.push(s.date),Hr(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Hr(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=Qt(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Wr(){return(new Date).toISOString().substring(0,10)}class Gr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!cn()&&dn().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){try{const t=await Br();return await t.transaction(Pr).objectStore(Pr).get(Ur(e))}catch(t){if(t instanceof hn)er.warn(t.message);else{const e=$r.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});er.warn(e.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return jr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return jr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Hr(e){return Qt(JSON.stringify({version:2,heartbeats:e})).length}var qr;qr="",Rr(new Sn("platform-logger",(e=>new Qn(e)),"PRIVATE")),Rr(new Sn("heartbeat",(e=>new Vr(e)),"PRIVATE")),Lr(Jn,Zn,qr),Lr(Jn,Zn,"esm2017"),Lr("fire-js","");function Kr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Xr(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Yr=Xr,Qr=new pn("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Jr=new Dn("@firebase/auth");function Zr(e){if(Jr.logLevel<=En.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Jr.error(`Auth (${Dr}): ${e}`,...n)}}function es(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw rs(e,...n)}function ts(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return rs(e,...n)}function ns(e,t,n){const r=Object.assign(Object.assign({},Yr()),{[t]:n});return new pn("auth","Firebase",r).create(t,{appName:e.name})}function rs(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Qr.create(e,...n)}function ss(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];throw rs(t,...r)}}function as(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Zr(t),new Error(t)}function is(e,t){e||as(t)}function os(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function ls(){return"http:"===us()||"https:"===us()}function us(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function cs(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(ls()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class ds{constructor(e,t){this.shortDelay=e,this.longDelay=t,is(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ln())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return cs()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function hs(e,t){is(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class ps{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void as("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void as("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void as("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const fs={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ms=new ds(3e4,6e4);function gs(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function ys(e,t,n,r){return vs(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let s={},a={};r&&("GET"===t?a=r:s={body:JSON.stringify(r)});const i=yn(Object.assign({key:e.config.apiKey},a)).slice(1),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode),ps.fetch()(xs(e,e.config.apiHost,n,i),Object.assign({method:t,headers:o,referrerPolicy:"no-referrer"},s))}))}async function vs(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},fs),t);try{const t=new ws(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw ks(e,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const t=s.ok?a.errorMessage:a.error.message,[n,i]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw ks(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw ks(e,"email-already-in-use",a);if("USER_DISABLED"===n)throw ks(e,"user-disabled",a);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw ns(e,o,i);es(e,o)}}catch(s){if(s instanceof hn)throw s;es(e,"network-request-failed",{message:String(s)})}}async function bs(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const a=await ys(e,t,n,r,s);return"mfaPendingCredential"in a&&es(e,"multi-factor-auth-required",{_serverResponse:a}),a}function xs(e,t,n,r){const s=`${t}${n}?${r}`;return e.config.emulator?hs(e.config,s):`${e.config.apiScheme}://${s}`}class ws{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(ts(this.auth,"network-request-failed"))),ms.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function ks(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=ts(e,t,r);return s.customData._tokenResponse=n,s}function Ss(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Is(e){return 1e3*Number(e)}function Cs(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Zr("JWT malformed, contained fewer than 3 sections"),null;try{const e=Jt(n);return e?JSON.parse(e):(Zr("Failed to decode base64 JWT payload"),null)}catch(s){return Zr("Caught error parsing JWT payload as JSON",null===s||void 0===s?void 0:s.toString()),null}}async function Ts(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof hn&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Ns{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class Es{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ss(this.lastLoginAt),this.creationTime=Ss(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function As(e){var t;const n=e.auth,r=await e.getIdToken(),s=await Ts(e,async function(e,t){return ys(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));ss(null===s||void 0===s?void 0:s.users.length,n,"internal-error");const a=s.users[0];e._notifyReloadListener(a);const i=(null===(t=a.providerUserInfo)||void 0===t?void 0:t.length)?a.providerUserInfo.map((e=>{var{providerId:t}=e,n=Kr(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const o=(l=e.providerData,u=i,[...l.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var l,u;const c=e.isAnonymous,d=!(e.email&&a.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!c&&d,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Es(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(e,p)}class Rs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ss(e.idToken,"internal-error"),ss("undefined"!==typeof e.idToken,"internal-error"),ss("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){const t=Cs(e);return ss(t,"internal-error"),ss("undefined"!==typeof t.exp,"internal-error"),ss("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return ss(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await async function(e,t){const n=await vs(e,{},(async()=>{const n=yn({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,a=xs(e,r,"/v1/token",`key=${s}`),i=await e._getAdditionalHeaders();return i["Content-Type"]="application/x-www-form-urlencoded",ps.fetch()(a,{method:"POST",headers:i,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,a=new Rs;return n&&(ss("string"===typeof n,"internal-error",{appName:e}),a.refreshToken=n),r&&(ss("string"===typeof r,"internal-error",{appName:e}),a.accessToken=r),s&&(ss("number"===typeof s,"internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rs,this.toJSON())}_performRefresh(){return as("not implemented")}}function _s(e,t){ss("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class $s{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,s=Kr(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ns(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Es(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Ts(this,this.stsTokenManager.getToken(this.auth,e));return ss(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=kn(e),r=await n.getIdToken(t),s=Cs(r);ss(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const a="object"===typeof s.firebase?s.firebase:void 0,i=null===a||void 0===a?void 0:a.sign_in_provider;return{claims:s,token:r,authTime:Ss(Is(s.auth_time)),issuedAtTime:Ss(Is(s.iat)),expirationTime:Ss(Is(s.exp)),signInProvider:i||null,signInSecondFactor:(null===a||void 0===a?void 0:a.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=kn(e);await As(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(ss(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new $s(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ss(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await As(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Ts(this,async function(e,t){return ys(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,a,i,o,l,u;const c=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,p=null!==(a=t.photoURL)&&void 0!==a?a:void 0,f=null!==(i=t.tenantId)&&void 0!==i?i:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:b,isAnonymous:x,providerData:w,stsTokenManager:k}=t;ss(v&&k,e,"internal-error");const S=Rs.fromJSON(this.name,k);ss("string"===typeof v,e,"internal-error"),_s(c,e.name),_s(d,e.name),ss("boolean"===typeof b,e,"internal-error"),ss("boolean"===typeof x,e,"internal-error"),_s(h,e.name),_s(p,e.name),_s(f,e.name),_s(m,e.name),_s(g,e.name),_s(y,e.name);const I=new $s({uid:v,auth:e,email:d,emailVerified:b,displayName:c,isAnonymous:x,photoURL:p,phoneNumber:h,tenantId:f,stsTokenManager:S,createdAt:g,lastLoginAt:y});return w&&Array.isArray(w)&&(I.providerData=w.map((e=>Object.assign({},e)))),m&&(I._redirectEventId=m),I}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Rs;r.updateFromServerResponse(t);const s=new $s({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await As(s),s}}const Os=new Map;function Ds(e){is(e instanceof Function,"Expected a class definition");let t=Os.get(e);return t?(is(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Os.set(e,t),t)}class Ms{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ms.type="NONE";const Fs=Ms;function Ls(e,t,n){return`firebase:${e}:${t}:${n}`}class Ps{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=Ls(this.userKey,r.apiKey,s),this.fullPersistenceKey=Ls("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$s._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Ps(Ds(Fs),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let s=r[0]||Ds(Fs);const a=Ls(n,e.config.apiKey,e.name);let i=null;for(const u of t)try{const t=await u._get(a);if(t){const n=$s._fromJSON(e,t);u!==s&&(i=n),s=u;break}}catch(l){}const o=r.filter((e=>e._shouldAllowMigration));return s._shouldAllowMigration&&o.length?(s=o[0],i&&await s._set(a,i.toJSON()),await Promise.all(t.map((async e=>{if(e!==s)try{await e._remove(a)}catch(l){}}))),new Ps(s,e,n)):new Ps(s,e,n)}}function zs(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Vs(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Bs(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Gs(t))return"Blackberry";if(Hs(t))return"Webos";if(js(t))return"Safari";if((t.includes("chrome/")||Us(t))&&!t.includes("edge/"))return"Chrome";if(Ws(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Bs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln();return/firefox\//i.test(e)}function js(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Us(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln();return/crios\//i.test(e)}function Vs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln();return/iemobile/i.test(e)}function Ws(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln();return/android/i.test(e)}function Gs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln();return/blackberry/i.test(e)}function Hs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln();return/webos/i.test(e)}function qs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Ks(){return function(){const e=ln();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Xs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln();return qs(e)||Ws(e)||Hs(e)||Gs(e)||/windows phone/i.test(e)||Vs(e)}function Ys(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=zs(ln());break;case"Worker":t=`${zs(ln())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Dr}/${r}`}async function Qs(e,t){return ys(e,"GET","/v2/recaptchaConfig",gs(e,t))}function Js(e){return void 0!==e&&void 0!==e.enterprise}class Zs{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some((e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState))}}function ea(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=ts("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function ta(e){return`__${e}${Math.floor(1e6*Math.random())}`}class na{constructor(e){this.type="recaptcha-enterprise",this.auth=ia(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const s=window.grecaptcha;Js(s)?s.enterprise.ready((()=>{s.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Qs(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Zs(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((s=>{if(!t&&Js(window.grecaptcha))n(s,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));ea("https://www.google.com/recaptcha/enterprise.js?render="+s).then((()=>{n(s,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function ra(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=new na(e);let a;try{a=await s.verify(n)}catch(o){a=await s.verify(n,!0)}const i=Object.assign({},t);return r?Object.assign(i,{captchaResp:a}):Object.assign(i,{captchaResponse:a}),Object.assign(i,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(i,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),i}class sa{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(s){r(s)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class aa{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oa(this),this.idTokenSubscription=new oa(this),this.beforeStateQueue=new sa(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Qr,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ds(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Ps.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(s){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,a=null===r||void 0===r?void 0:r._redirectEventId,i=await this.tryRedirectSignIn(e);n&&n!==a||!(null===i||void 0===i?void 0:i.user)||(r=i.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(a)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ss(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await As(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?kn(e):null;return t&&ss(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&ss(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Ds(e))}))}async initializeRecaptchaConfig(){const e=await Qs(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new Zs(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){new na(this).verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new pn("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ds(e)||this._popupRedirectResolver;ss(t,this,"argument-error"),this.redirectPersistenceManager=await Ps.create(this,[Ds(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s="function"===typeof t?t:t.next.bind(t),a=this._isInitialized?Promise.resolve():this._initializationPromise;return ss(a,this,"internal-error"),a.then((()=>s(this.currentUser))),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ss(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ys(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Jr.logLevel<=En.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Jr.warn(`Auth (${Dr}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function ia(e){return kn(e)}class oa{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new xn(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return ss(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function la(e,t,n){const r=ia(e);ss(r._canInitEmulator,r,"emulator-config-failed"),ss(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!(null===n||void 0===n?void 0:n.disableWarnings),a=ua(t),{host:i,port:o}=function(e){const t=ua(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const e=s[1];return{host:e,port:ca(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:ca(t)}}}(t),l=null===o?"":`:${o}`;r.config.emulator={url:`${a}//${i}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:i,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function ua(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ca(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class da{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return as("not implemented")}_getIdTokenResponse(e){return as("not implemented")}_linkToIdToken(e,t){return as("not implemented")}_getReauthenticationResolver(e){return as("not implemented")}}async function ha(e,t){return ys(e,"POST","/v1/accounts:update",t)}async function pa(e,t){return bs(e,"POST","/v1/accounts:signInWithPassword",gs(e,t))}async function fa(e,t){return ys(e,"POST","/v1/accounts:sendOobCode",gs(e,t))}async function ma(e,t){return fa(e,t)}class ga extends da{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new ga(e,t,"password")}static _fromEmailAndCode(e,t){return new ga(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await ra(e,n,"signInWithPassword");return pa(e,t)}return pa(e,n).catch((async t=>{if("auth/missing-recaptcha-token"===t.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await ra(e,n,"signInWithPassword");return pa(e,t)}return Promise.reject(t)}));case"emailLink":return async function(e,t){return bs(e,"POST","/v1/accounts:signInWithEmailLink",gs(e,t))}(e,{email:this._email,oobCode:this._password});default:es(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ha(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return bs(e,"POST","/v1/accounts:signInWithEmailLink",gs(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:es(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ya(e,t){return bs(e,"POST","/v1/accounts:signInWithIdp",gs(e,t))}class va extends da{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new va(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):es("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,s=Kr(t,["providerId","signInMethod"]);if(!n||!r)return null;const a=new va(n,r);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){return ya(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ya(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ya(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=yn(t)}return e}}const ba={USER_NOT_FOUND:"user-not-found"};class xa extends da{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new xa({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new xa({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return bs(e,"POST","/v1/accounts:signInWithPhoneNumber",gs(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await bs(e,"POST","/v1/accounts:signInWithPhoneNumber",gs(e,t));if(n.temporaryProof)throw ks(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return bs(e,"POST","/v1/accounts:signInWithPhoneNumber",gs(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),ba)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}=e;return n||t||r||s?new xa({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}):null}}class wa{constructor(e){var t,n,r,s,a,i;const o=vn(bn(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,u=null!==(n=o.oobCode)&&void 0!==n?n:null,c=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);ss(l&&u&&c,"argument-error"),this.apiKey=l,this.operation=c,this.code=u,this.continueUrl=null!==(s=o.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(a=o.languageCode)&&void 0!==a?a:null,this.tenantId=null!==(i=o.tenantId)&&void 0!==i?i:null}static parseLink(e){const t=function(e){const t=vn(bn(e)).link,n=t?vn(bn(t)).deep_link_id:null,r=vn(bn(e)).deep_link_id;return(r?vn(bn(r)).link:null)||r||n||t||e}(e);try{return new wa(t)}catch(n){return null}}}class ka{constructor(){this.providerId=ka.PROVIDER_ID}static credential(e,t){return ga._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=wa.parseLink(t);return ss(n,"argument-error"),ga._fromEmailAndCode(e,n.code,n.tenantId)}}ka.PROVIDER_ID="password",ka.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ka.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Sa{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ia extends Sa{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ca extends Ia{constructor(){super("facebook.com")}static credential(e){return va._fromParams({providerId:Ca.PROVIDER_ID,signInMethod:Ca.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ca.credentialFromTaggedObject(e)}static credentialFromError(e){return Ca.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ca.credential(t.oauthAccessToken)}catch(n){return null}}}Ca.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ca.PROVIDER_ID="facebook.com";class Ta extends Ia{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return va._fromParams({providerId:Ta.PROVIDER_ID,signInMethod:Ta.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ta.credentialFromTaggedObject(e)}static credentialFromError(e){return Ta.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Ta.credential(n,r)}catch(s){return null}}}Ta.GOOGLE_SIGN_IN_METHOD="google.com",Ta.PROVIDER_ID="google.com";class Na extends Ia{constructor(){super("github.com")}static credential(e){return va._fromParams({providerId:Na.PROVIDER_ID,signInMethod:Na.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Na.credentialFromTaggedObject(e)}static credentialFromError(e){return Na.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Na.credential(t.oauthAccessToken)}catch(n){return null}}}Na.GITHUB_SIGN_IN_METHOD="github.com",Na.PROVIDER_ID="github.com";class Ea extends Ia{constructor(){super("twitter.com")}static credential(e,t){return va._fromParams({providerId:Ea.PROVIDER_ID,signInMethod:Ea.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ea.credentialFromTaggedObject(e)}static credentialFromError(e){return Ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Ea.credential(n,r)}catch(s){return null}}}async function Aa(e,t){return bs(e,"POST","/v1/accounts:signUp",gs(e,t))}Ea.TWITTER_SIGN_IN_METHOD="twitter.com",Ea.PROVIDER_ID="twitter.com";class Ra{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=await $s._fromIdTokenResponse(e,n,r),a=_a(n);return new Ra({user:s,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=_a(n);return new Ra({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function _a(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class $a extends hn{constructor(e,t,n,r){var s;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,$a.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new $a(e,t,n,r)}}function Oa(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw $a._fromErrorAndOperation(e,n,t,r);throw n}))}async function Da(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Ts(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ra._forOperation(e,"link",r)}async function Ma(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e,s="reauthenticate";try{const a=await Ts(e,Oa(r,s,t,e),n);ss(a.idToken,r,"internal-error");const i=Cs(a.idToken);ss(i,r,"internal-error");const{sub:o}=i;return ss(e.uid===o,r,"user-mismatch"),Ra._forOperation(e,s,a)}catch(a){throw"auth/user-not-found"===(null===a||void 0===a?void 0:a.code)&&es(r,"user-mismatch"),a}}async function Fa(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="signIn",s=await Oa(e,r,t),a=await Ra._fromIdTokenResponse(e,r,s);return n||await e._updateCurrentUser(a.user),a}async function La(e,t){return Fa(ia(e),t)}function Pa(e,t,n){var r;ss((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),ss("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(ss(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(ss(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function za(e,t){const n={identifier:t,continueUri:ls()?os():"http://localhost"},{signinMethods:r}=await async function(e,t){return ys(e,"POST","/v1/accounts:createAuthUri",gs(e,t))}(kn(e),n);return r||[]}async function Ba(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const s=kn(e),a={idToken:await s.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},i=await Ts(s,async function(e,t){return ys(e,"POST","/v1/accounts:update",t)}(s.auth,a));s.displayName=i.displayName||null,s.photoURL=i.photoUrl||null;const o=s.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));o&&(o.displayName=s.displayName,o.photoURL=s.photoURL),await s._updateTokensIfNecessary(i)}async function ja(e,t,n){const{auth:r}=e,s={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(s.email=t),n&&(s.password=n);const a=await Ts(e,ha(r,s));await e._updateTokensIfNecessary(a,!0)}new WeakMap;const Ua="__sak";class Va{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ua,"1"),this.storage.removeItem(Ua),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Wa extends Va{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=ln();return js(e)||qs(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Xs(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);Ks()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Wa.type="LOCAL";const Ga=Wa;class Ha extends Va{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ha.type="SESSION";const qa=Ha;class Ka{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Ka(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,a=this.handlersMap[r];if(!(null===a||void 0===a?void 0:a.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const i=Array.from(a).map((async e=>e(t.origin,s))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(i);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Xa(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Ka.receivers=[];class Ya{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,a;return new Promise(((i,o)=>{const l=Xa("",20);r.port1.start();const u=setTimeout((()=>{o(new Error("unsupported_event"))}),n);a={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(u),s=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),i(t.data.response);break;default:clearTimeout(u),clearTimeout(s),o(new Error("invalid_response"))}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{a&&this.removeMessageHandler(a)}))}}function Qa(){return window}function Ja(){return"undefined"!==typeof Qa().WorkerGlobalScope&&"function"===typeof Qa().importScripts}const Za="firebaseLocalStorageDb",ei="firebaseLocalStorage",ti="fbase_key";class ni{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function ri(e,t){return e.transaction([ei],t?"readwrite":"readonly").objectStore(ei)}function si(){const e=indexedDB.open(Za,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(ei,{keyPath:ti})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(ei)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Za);return new ni(e).toPromise()}(),t(await si()))}))}))}async function ai(e,t,n){const r=ri(e,!0).put({[ti]:t,value:n});return new ni(r).toPromise()}function ii(e,t){const n=ri(e,!0).delete(t);return new ni(n).toPromise()}class oi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await si()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ja()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ka._getInstance(Ja()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Ya(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await si();return await ai(e,Ua,"1"),await ii(e,Ua),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>ai(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=ri(e,!1).get(t),r=await new ni(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>ii(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=ri(e,!1).getAll();return new ni(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}oi.type="LOCAL";const li=oi;ta("rcb"),new ds(3e4,6e4);const ui="recaptcha";async function ci(e,t,n){var r;const s=await n.verify();try{let a;if(ss("string"===typeof s,e,"argument-error"),ss(n.type===ui,e,"argument-error"),a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){ss("enroll"===t.type,e,"internal-error");const n=await function(e,t){return ys(e,"POST","/v2/accounts/mfaEnrollment:start",gs(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,recaptchaToken:s}});return n.phoneSessionInfo.sessionInfo}{ss("signin"===t.type,e,"internal-error");const n=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;ss(n,e,"missing-multi-factor-info");const i=await function(e,t){return ys(e,"POST","/v2/accounts/mfaSignIn:start",gs(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:s}});return i.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return ys(e,"POST","/v1/accounts:sendVerificationCode",gs(e,t))}(e,{phoneNumber:a.phoneNumber,recaptchaToken:s});return t}}finally{n._reset()}}class di{constructor(e){this.providerId=di.PROVIDER_ID,this.auth=ia(e)}verifyPhoneNumber(e,t){return ci(this.auth,e,kn(t))}static credential(e,t){return xa._fromVerification(e,t)}static credentialFromResult(e){const t=e;return di.credentialFromTaggedObject(t)}static credentialFromError(e){return di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?xa._fromTokenResponse(n,r):null}}function hi(e,t){return t?Ds(t):(ss(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}di.PROVIDER_ID="phone",di.PHONE_SIGN_IN_METHOD="phone";class pi extends da{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ya(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ya(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ya(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function fi(e){return Fa(e.auth,new pi(e),e.bypassAuthState)}function mi(e){const{auth:t,user:n}=e;return ss(n,t,"internal-error"),Ma(n,new pi(e),e.bypassAuthState)}async function gi(e){const{auth:t,user:n}=e;return ss(n,t,"internal-error"),Da(n,new pi(e),e.bypassAuthState)}class yi{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:a,type:i}=e;if(a)return void this.reject(a);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(i)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return fi;case"linkViaPopup":case"linkViaRedirect":return gi;case"reauthViaPopup":case"reauthViaRedirect":return mi;default:es(this.auth,"internal-error")}}resolve(e){is(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){is(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const vi=new ds(2e3,1e4);class bi extends yi{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,bi.currentPopupAction&&bi.currentPopupAction.cancel(),bi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ss(e,this.auth,"internal-error"),e}async onExecution(){is(1===this.filter.length,"Popup operations only handle one event");const e=Xa();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(ts(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(ts(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,bi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(ts(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,vi.get())};e()}}bi.currentPopupAction=null;const xi=new Map;class wi extends yi{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=xi.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Ii(t),r=Si(e);if(!await r._isAvailable())return!1;const s="true"===await r._get(n);return await r._remove(n),s}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}xi.set(this.auth._key(),e)}return this.bypassAuthState||xi.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ki(e,t){xi.set(e._key(),t)}function Si(e){return Ds(e._redirectPersistence)}function Ii(e){return Ls("pendingRedirect",e.config.apiKey,e.name)}async function Ci(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=ia(e),s=hi(r,t),a=new wi(r,s,n),i=await a.execute();return i&&!n&&(delete i.user._redirectEventId,await r._persistUserIfCurrent(i.user),await r._setRedirectUser(null,t)),i}class Ti{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ei(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ei(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ts(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ni(e))}saveEventToCache(e){this.cachedEventUids.add(Ni(e)),this.lastProcessedEventTime=Date.now()}}function Ni(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Ei(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const Ai=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ri=/^https?/;async function _i(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return ys(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if($i(r))return}catch(n){}es(e,"unauthorized-domain")}function $i(e){const t=os(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===r}if(!Ri.test(n))return!1;if(Ai.test(e))return r===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Oi=new ds(3e4,6e4);function Di(){const e=Qa().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}let Mi=null;function Fi(e){return Mi=Mi||function(e){return new Promise(((t,n)=>{var r,s,a;function i(){Di(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Di(),n(ts(e,"network-request-failed"))},timeout:Oi.get()})}if(null===(s=null===(r=Qa().gapi)||void 0===r?void 0:r.iframes)||void 0===s?void 0:s.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=Qa().gapi)||void 0===a?void 0:a.load)){const t=ta("iframefcb");return Qa()[t]=()=>{gapi.load?i():n(ts(e,"network-request-failed"))},ea(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}i()}})).catch((e=>{throw Mi=null,e}))}(e),Mi}const Li=new ds(5e3,15e3),Pi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Bi(e){const t=e.config;ss(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?hs(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Dr},s=zi.get(e.config.apiHost);s&&(r.eid=s);const a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${yn(r).slice(1)}`}const ji={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ui{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Vi(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},ji),{width:r.toString(),height:s.toString(),top:a,left:i}),u=ln().toLowerCase();n&&(o=Us(u)?"_blank":n),Bs(u)&&(t=t||"http://localhost",l.scrollbars="yes");const c=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`}),"");if(function(){var e;return qs(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new Ui(null);const d=window.open(t||"",o,c);ss(d,e,"popup-blocked");try{d.focus()}catch(h){}return new Ui(d)}const Wi="__/auth/handler",Gi="emulator/auth/handler",Hi=encodeURIComponent("fac");async function qi(e,t,n,r,s,a){ss(e.config.authDomain,e,"auth-domain-config-required"),ss(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Dr,eventId:s};if(t instanceof Sa){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))i[e]=t}if(t instanceof Ia){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(i.scopes=e.join(","))}e.tenantId&&(i.tid=e.tenantId);const o=i;for(const c of Object.keys(o))void 0===o[c]&&delete o[c];const l=await e._getAppCheckToken(),u=l?`#${Hi}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Wi}`;return hs(t,Gi)}(e)}?${yn(o).slice(1)}${u}`}const Ki="webStorageSupport";const Xi=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qa,this._completeRedirectFn=Ci,this._overrideRedirectResult=ki}async _openPopup(e,t,n,r){var s;is(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");return Vi(e,await qi(e,t,n,os(),r),Xa())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Qa().location.href=e}(await qi(e,t,n,os(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(is(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await Fi(e),n=Qa().gapi;return ss(n,e,"internal-error"),t.open({where:document.body,url:Bi(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Pi,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const s=ts(e,"network-request-failed"),a=Qa().setTimeout((()=>{r(s)}),Li.get());function i(){Qa().clearTimeout(a),n(t)}t.ping(i).then(i,(()=>{r(s)}))}))))}(e),n=new Ti(e);return t.register("authEvent",(t=>{ss(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ki,{type:Ki},(n=>{var r;const s=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Ki];void 0!==s&&t(!!s),es(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=_i(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Xs()||js()||qs()}};var Yi="@firebase/auth",Qi="0.23.2";class Ji{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ss(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Zi=sn("authIdTokenMaxAge")||300;let eo=null;var to;to="Browser",Rr(new Sn("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=r.options;ss(i&&!i.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:i,authDomain:o,clientPlatform:to,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ys(to)},u=new aa(r,s,a,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ds);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(u,n),u}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Rr(new Sn("auth-internal",(e=>(e=>new Ji(e))(ia(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Lr(Yi,Qi,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(to)),Lr(Yi,Qi,"esm2017");var no,ro="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},so={},ao=ao||{},io=ro||self;function oo(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function lo(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var uo="closure_uid_"+(1e9*Math.random()>>>0),co=0;function ho(e,t,n){return e.call.apply(e.bind,arguments)}function po(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function fo(e,t,n){return(fo=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ho:po).apply(null,arguments)}function mo(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function go(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var s=Array(arguments.length-2),a=2;a<arguments.length;a++)s[a-2]=arguments[a];return t.prototype[n].apply(e,s)}}function yo(){this.s=this.s,this.o=this.o}yo.prototype.s=!1,yo.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,uo)&&e[uo]||(e[uo]=++co))},yo.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const vo=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function bo(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function xo(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(oo(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let s=0;s<r;s++)e[n+s]=t[s]}else e.push(t)}}function wo(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}wo.prototype.h=function(){this.defaultPrevented=!0};var ko=function(){if(!io.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{io.addEventListener("test",(()=>{}),t),io.removeEventListener("test",(()=>{}),t)}catch(n){}return e}();function So(e){return/^[\s\xa0]*$/.test(e)}function Io(){var e=io.navigator;return e&&(e=e.userAgent)?e:""}function Co(e){return-1!=Io().indexOf(e)}function To(e){return To[" "](e),e}To[" "]=function(){};var No,Eo,Ao=Co("Opera"),Ro=Co("Trident")||Co("MSIE"),_o=Co("Edge"),$o=_o||Ro,Oo=Co("Gecko")&&!(-1!=Io().toLowerCase().indexOf("webkit")&&!Co("Edge"))&&!(Co("Trident")||Co("MSIE"))&&!Co("Edge"),Do=-1!=Io().toLowerCase().indexOf("webkit")&&!Co("Edge");function Mo(){var e=io.document;return e?e.documentMode:void 0}e:{var Fo="",Lo=function(){var e=Io();return Oo?/rv:([^\);]+)(\)|;)/.exec(e):_o?/Edge\/([\d\.]+)/.exec(e):Ro?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Do?/WebKit\/(\S+)/.exec(e):Ao?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Lo&&(Fo=Lo?Lo[1]:""),Ro){var Po=Mo();if(null!=Po&&Po>parseFloat(Fo)){No=String(Po);break e}}No=Fo}if(io.document&&Ro){var zo=Mo();Eo=zo||(parseInt(No,10)||void 0)}else Eo=void 0;var Bo=Eo;function jo(e,t){if(wo.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Oo){e:{try{To(t.nodeName);var s=!0;break e}catch(a){}s=!1}s||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:Uo[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&jo.$.h.call(this)}}go(jo,wo);var Uo={2:"touch",3:"pen",4:"mouse"};jo.prototype.h=function(){jo.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Vo="closure_listenable_"+(1e6*Math.random()|0),Wo=0;function Go(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=s,this.key=++Wo,this.fa=this.ia=!1}function Ho(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function qo(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function Ko(e){const t={};for(const n in e)t[n]=e[n];return t}const Xo="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Yo(e,t){let n,r;for(let s=1;s<arguments.length;s++){for(n in r=arguments[s],r)e[n]=r[n];for(let t=0;t<Xo.length;t++)n=Xo[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Qo(e){this.src=e,this.g={},this.h=0}function Jo(e,t){var n=t.type;if(n in e.g){var r,s=e.g[n],a=vo(s,t);(r=0<=a)&&Array.prototype.splice.call(s,a,1),r&&(Ho(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Zo(e,t,n,r){for(var s=0;s<e.length;++s){var a=e[s];if(!a.fa&&a.listener==t&&a.capture==!!n&&a.la==r)return s}return-1}Qo.prototype.add=function(e,t,n,r,s){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var i=Zo(e,t,r,s);return-1<i?(t=e[i],n||(t.ia=!1)):((t=new Go(t,this.src,a,!!r,s)).ia=n,e.push(t)),t};var el="closure_lm_"+(1e6*Math.random()|0),tl={};function nl(e,t,n,r,s){if(r&&r.once)return sl(e,t,n,r,s);if(Array.isArray(t)){for(var a=0;a<t.length;a++)nl(e,t[a],n,r,s);return null}return n=dl(n),e&&e[Vo]?e.O(t,n,lo(r)?!!r.capture:!!r,s):rl(e,t,n,!1,r,s)}function rl(e,t,n,r,s,a){if(!t)throw Error("Invalid event type");var i=lo(s)?!!s.capture:!!s,o=ul(e);if(o||(e[el]=o=new Qo(e)),(n=o.add(t,n,r,i,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=ll;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)ko||(s=i),void 0===s&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(ol(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function sl(e,t,n,r,s){if(Array.isArray(t)){for(var a=0;a<t.length;a++)sl(e,t[a],n,r,s);return null}return n=dl(n),e&&e[Vo]?e.P(t,n,lo(r)?!!r.capture:!!r,s):rl(e,t,n,!0,r,s)}function al(e,t,n,r,s){if(Array.isArray(t))for(var a=0;a<t.length;a++)al(e,t[a],n,r,s);else r=lo(r)?!!r.capture:!!r,n=dl(n),e&&e[Vo]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Zo(a=e.g[t],n,r,s))&&(Ho(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=ul(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Zo(t,n,r,s)),(n=-1<e?t[e]:null)&&il(n))}function il(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Vo])Jo(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ol(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ul(t))?(Jo(n,e),0==n.h&&(n.src=null,t[el]=null)):Ho(e)}}}function ol(e){return e in tl?tl[e]:tl[e]="on"+e}function ll(e,t){if(e.fa)e=!0;else{t=new jo(t,this);var n=e.listener,r=e.la||e.src;e.ia&&il(e),e=n.call(r,t)}return e}function ul(e){return(e=e[el])instanceof Qo?e:null}var cl="__closure_events_fn_"+(1e9*Math.random()>>>0);function dl(e){return"function"===typeof e?e:(e[cl]||(e[cl]=function(t){return e.handleEvent(t)}),e[cl])}function hl(){yo.call(this),this.i=new Qo(this),this.S=this,this.J=null}function pl(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"===typeof t)t=new wo(t,e);else if(t instanceof wo)t.target=t.target||e;else{var s=t;Yo(t=new wo(r,e),s)}if(s=!0,n)for(var a=n.length-1;0<=a;a--){var i=t.g=n[a];s=fl(i,r,!0,t)&&s}if(s=fl(i=t.g=e,r,!0,t)&&s,s=fl(i,r,!1,t)&&s,n)for(a=0;a<n.length;a++)s=fl(i=t.g=n[a],r,!1,t)&&s}function fl(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,a=0;a<t.length;++a){var i=t[a];if(i&&!i.fa&&i.capture==n){var o=i.listener,l=i.la||i.src;i.ia&&Jo(e.i,i),s=!1!==o.call(l,r)&&s}}return s&&!r.defaultPrevented}go(hl,yo),hl.prototype[Vo]=!0,hl.prototype.removeEventListener=function(e,t,n,r){al(this,e,t,n,r)},hl.prototype.N=function(){if(hl.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ho(n[r]);delete t.g[e],t.h--}}this.J=null},hl.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},hl.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var ml=io.JSON.stringify;function gl(){var e=Sl;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var yl=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new vl),(e=>e.reset()));class vl{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function bl(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function xl(e){io.setTimeout((()=>{throw e}),0)}let wl,kl=!1,Sl=new class{constructor(){this.h=this.g=null}add(e,t){const n=yl.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},Il=()=>{const e=io.Promise.resolve(void 0);wl=()=>{e.then(Cl)}};var Cl=()=>{for(var e;e=gl();){try{e.h.call(e.g)}catch(n){xl(n)}var t=yl;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}kl=!1};function Tl(e,t){hl.call(this),this.h=e||1,this.g=t||io,this.j=fo(this.qb,this),this.l=Date.now()}function Nl(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function El(e,t,n){if("function"===typeof e)n&&(e=fo(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=fo(e.handleEvent,e)}return 2147483647<Number(t)?-1:io.setTimeout(e,t||0)}function Al(e){e.g=El((()=>{e.g=null,e.i&&(e.i=!1,Al(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}go(Tl,hl),(no=Tl.prototype).ga=!1,no.T=null,no.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),pl(this,"tick"),this.ga&&(Nl(this),this.start()))}},no.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},no.N=function(){Tl.$.N.call(this),Nl(this),delete this.g};class Rl extends yo{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Al(this)}N(){super.N(),this.g&&(io.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _l(e){yo.call(this),this.h=e,this.g={}}go(_l,yo);var $l=[];function Ol(e,t,n,r){Array.isArray(n)||(n&&($l[0]=n.toString()),n=$l);for(var s=0;s<n.length;s++){var a=nl(t,n[s],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function Dl(e){qo(e.g,(function(e,t){this.g.hasOwnProperty(t)&&il(e)}),e),e.g={}}function Ml(){this.g=!0}function Fl(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var a=s[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var i=1;i<s.length;i++)s[i]=""}}}return ml(n)}catch(o){return t}}(e,n)+(r?" "+r:"")}))}_l.prototype.N=function(){_l.$.N.call(this),Dl(this)},_l.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ml.prototype.Ea=function(){this.g=!1},Ml.prototype.info=function(){};var Ll={},Pl=null;function zl(){return Pl=Pl||new hl}function Bl(e){wo.call(this,Ll.Ta,e)}function jl(e){const t=zl();pl(t,new Bl(t))}function Ul(e,t){wo.call(this,Ll.STAT_EVENT,e),this.stat=t}function Vl(e){const t=zl();pl(t,new Ul(t,e))}function Wl(e,t){wo.call(this,Ll.Ua,e),this.size=t}function Gl(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return io.setTimeout((function(){e()}),t)}Ll.Ta="serverreachability",go(Bl,wo),Ll.STAT_EVENT="statevent",go(Ul,wo),Ll.Ua="timingevent",go(Wl,wo);var Hl={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ql={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Kl(){}function Xl(e){return e.h||(e.h=e.i())}function Yl(){}Kl.prototype.h=null;var Ql,Jl={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Zl(){wo.call(this,"d")}function eu(){wo.call(this,"c")}function tu(){}function nu(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new _l(this),this.P=su,e=$o?125:void 0,this.V=new Tl(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new ru}function ru(){this.i=null,this.g="",this.h=!1}go(Zl,wo),go(eu,wo),go(tu,Kl),tu.prototype.g=function(){return new XMLHttpRequest},tu.prototype.i=function(){return{}},Ql=new tu;var su=45e3,au={},iu={};function ou(e,t,n){e.L=1,e.v=Tu(wu(t)),e.s=n,e.S=!0,lu(e,null)}function lu(e,t){e.G=Date.now(),hu(e),e.A=wu(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),zu(n.i,"t",r),e.C=0,n=e.l.J,e.h=new ru,e.g=Bc(e.l,n?t:null,!e.s),0<e.O&&(e.M=new Rl(fo(e.Pa,e,e.g),e.O)),Ol(e.U,e.g,"readystatechange",e.nb),t=e.I?Ko(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),jl(),function(e,t,n,r,s,a){e.info((function(){if(e.g)if(a)for(var i="",o=a.split("&"),l=0;l<o.length;l++){var u=o[l].split("=");if(1<u.length){var c=u[0];u=u[1];var d=c.split("_");i=2<=d.length&&"type"==d[1]?i+(c+"=")+u+"&":i+(c+"=redacted&")}}else i=null;else i=a;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+n+"\n"+i}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function uu(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function cu(e,t,n){let r,s=!0;for(;!e.J&&e.C<n.length;){if(r=du(e,n),r==iu){4==t&&(e.o=4,Vl(14),s=!1),Fl(e.j,e.m,null,"[Incomplete Response]");break}if(r==au){e.o=4,Vl(15),Fl(e.j,e.m,n,"[Invalid Chunk]"),s=!1;break}Fl(e.j,e.m,r,null),yu(e,r)}uu(e)&&r!=iu&&r!=au&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Vl(16),s=!1),e.i=e.i&&s,s?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),$c(t),t.M=!0,Vl(11))):(Fl(e.j,e.m,n,"[Invalid Chunked Response]"),gu(e),mu(e))}function du(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?iu:(n=Number(t.substring(n,r)),isNaN(n)?au:(r+=1)+n>t.length?iu:(t=t.slice(r,r+n),e.C=r+n,t))}function hu(e){e.Y=Date.now()+e.P,pu(e,e.P)}function pu(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Gl(fo(e.lb,e),t)}function fu(e){e.B&&(io.clearTimeout(e.B),e.B=null)}function mu(e){0==e.l.H||e.J||Mc(e.l,e)}function gu(e){fu(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Nl(e.V),Dl(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function yu(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Hu(n.i,e)))if(!e.K&&Hu(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Dc(n),Ic(n)}_c(n),Vl(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&0==n.A&&!n.v&&(n.v=Gl(fo(n.ib,n),6e3));if(1>=Gu(n.i)&&n.oa){try{n.oa()}catch(u){}n.oa=void 0}}else Lc(n,11)}else if((e.K||n.g==e)&&Dc(n),!So(t))for(s=n.Ja.g.parse(t),t=0;t<s.length;t++){let u=s[t];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const t=u[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const s=u[4];null!=s&&(n.Ga=s,n.l.info("SVER="+n.Ga));const c=u[5];null!=c&&"number"===typeof c&&0<c&&(r=1.5*c,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var a=r.i;a.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(qu(a,a.h),a.h=null))}if(r.F){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,Cu(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var i=e;if((r=n).wa=zc(r,r.J?r.pa:null,r.Y),i.K){Ku(r.i,i);var o=i,l=r.L;l&&o.setTimeout(l),o.B&&(fu(o),hu(o)),r.g=i}else Rc(r);0<n.j.length&&Tc(n)}else"stop"!=u[0]&&"close"!=u[0]||Lc(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Lc(n,7):Sc(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}jl()}catch(u){}}function vu(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(oo(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(oo(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(oo(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),s=r.length,a=0;a<s;a++)t.call(void 0,r[a],n&&n[a],e)}(no=nu.prototype).setTimeout=function(e){this.P=e},no.nb=function(e){e=e.target;const t=this.M;t&&3==yc(e)?t.l():this.Pa(e)},no.Pa=function(e){try{if(e==this.g)e:{const c=yc(this.g);var t=this.g.Ia();this.g.da();if(!(3>c)&&(3!=c||$o||this.g&&(this.h.h||this.g.ja()||vc(this.g)))){this.J||4!=c||7==t||jl(),fu(this);var n=this.g.da();this.ca=n;t:if(uu(this)){var r=vc(this.g);e="";var s=r.length,a=4==yc(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){gu(this),mu(this);var i="";break t}this.h.i=new io.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:a&&t==s-1});r.splice(0,s),this.h.g+=e,this.C=0,i=this.h.g}else i=this.g.ja();if(this.i=200==n,function(e,t,n,r,s,a,i){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+a+" "+i}))}(this.j,this.u,this.A,this.m,this.W,c,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,l=this.g;if((o=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!So(o)){var u=o;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,Vl(12),gu(this),mu(this);break e}Fl(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,yu(this,n)}this.S?(cu(this,c,i),$o&&this.i&&3==c&&(Ol(this.U,this.V,"tick",this.mb),this.V.start())):(Fl(this.j,this.m,i,null),yu(this,i)),4==c&&gu(this),this.i&&!this.J&&(4==c?Mc(this.l,this):(this.i=!1,hu(this)))}else(function(e){const t={};e=(e.g&&2<=yc(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(So(e[r]))continue;var n=bl(e[r]);const s=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const a=t[s]||[];t[s]=a,a.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<i.indexOf("Unknown SID")?(this.o=3,Vl(12)):(this.o=0,Vl(13)),gu(this),mu(this)}}}catch(c){}},no.mb=function(){if(this.g){var e=yc(this.g),t=this.g.ja();this.C<t.length&&(fu(this),cu(this,e,t),this.i&&4!=e&&hu(this))}},no.cancel=function(){this.J=!0,gu(this)},no.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(jl(),Vl(17)),gu(this),this.o=2,mu(this)):pu(this,this.Y-e)};var bu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xu(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof xu){this.h=e.h,ku(this,e.j),this.s=e.s,this.g=e.g,Su(this,e.m),this.l=e.l;var t=e.i,n=new Mu;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Iu(this,n),this.o=e.o}else e&&(t=String(e).match(bu))?(this.h=!1,ku(this,t[1]||"",!0),this.s=Nu(t[2]||""),this.g=Nu(t[3]||"",!0),Su(this,t[4]),this.l=Nu(t[5]||"",!0),Iu(this,t[6]||"",!0),this.o=Nu(t[7]||"")):(this.h=!1,this.i=new Mu(null,this.h))}function wu(e){return new xu(e)}function ku(e,t,n){e.j=n?Nu(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Su(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Iu(e,t,n){t instanceof Mu?(e.i=t,function(e,t){t&&!e.j&&(Fu(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Lu(this,t),zu(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Eu(t,Ou)),e.i=new Mu(t,e.h))}function Cu(e,t,n){e.i.set(t,n)}function Tu(e){return Cu(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Nu(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Eu(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Au),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Au(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}xu.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Eu(t,Ru,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Eu(t,Ru,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Eu(n,"/"==n.charAt(0)?$u:_u,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Eu(n,Du)),e.join("")};var Ru=/[#\/\?@]/g,_u=/[#\?:]/g,$u=/[#\?]/g,Ou=/[#\?@]/g,Du=/#/g;function Mu(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Fu(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),s=null;if(0<=r){var a=e[n].substring(0,r);s=e[n].substring(r+1)}else a=e[n];t(a,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Lu(e,t){Fu(e),t=Bu(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Pu(e,t){return Fu(e),t=Bu(e,t),e.g.has(t)}function zu(e,t,n){Lu(e,t),0<n.length&&(e.i=null,e.g.set(Bu(e,t),bo(n)),e.h+=n.length)}function Bu(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(no=Mu.prototype).add=function(e,t){Fu(this),this.i=null,e=Bu(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},no.forEach=function(e,t){Fu(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},no.ta=function(){Fu(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const s=e[r];for(let e=0;e<s.length;e++)n.push(t[r])}return n},no.Z=function(e){Fu(this);let t=[];if("string"===typeof e)Pu(this,e)&&(t=t.concat(this.g.get(Bu(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},no.set=function(e,t){return Fu(this),this.i=null,Pu(this,e=Bu(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},no.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},no.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const a=encodeURIComponent(String(r)),i=this.Z(r);for(r=0;r<i.length;r++){var s=a;""!==i[r]&&(s+="="+encodeURIComponent(String(i[r]))),e.push(s)}}return this.i=e.join("&")};var ju=class{constructor(e,t){this.g=e,this.map=t}};function Uu(e){this.l=e||Vu,io.PerformanceNavigationTiming?e=0<(e=io.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(io.g&&io.g.Ka&&io.g.Ka()&&io.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Vu=10;function Wu(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Gu(e){return e.h?1:e.g?e.g.size:0}function Hu(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function qu(e,t){e.g?e.g.add(t):e.h=t}function Ku(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Xu(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return bo(e.i)}Uu.prototype.cancel=function(){if(this.i=Xu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Yu,Qu=class{stringify(e){return io.JSON.stringify(e,void 0)}parse(e){return io.JSON.parse(e,void 0)}};function Ju(){this.g=new Qu}function Zu(e,t,n){const r=n||"";try{vu(e,(function(e,n){let s=e;lo(e)&&(s=ml(e)),t.push(r+n+"="+encodeURIComponent(s))}))}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function ec(e,t,n,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch(a){}}function tc(e){this.l=e.fc||null,this.j=e.ob||!1}function nc(e,t){hl.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=rc,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}go(tc,Kl),tc.prototype.g=function(){return new nc(this.l,this.j)},tc.prototype.i=(Yu={},function(){return Yu}),go(nc,hl);var rc=0;function sc(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function ac(e){e.readyState=4,e.l=null,e.j=null,e.A=null,ic(e)}function ic(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(no=nc.prototype).open=function(e,t){if(this.readyState!=rc)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,ic(this)},no.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||io).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},no.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ac(this)),this.readyState=rc},no.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,ic(this)),this.g&&(this.readyState=3,ic(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof io.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;sc(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},no.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?ac(this):ic(this),3==this.readyState&&sc(this)}},no.Za=function(e){this.g&&(this.response=this.responseText=e,ac(this))},no.Ya=function(e){this.g&&(this.response=e,ac(this))},no.ka=function(){this.g&&ac(this)},no.setRequestHeader=function(e,t){this.v.append(e,t)},no.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},no.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(nc.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var oc=io.JSON.parse;function lc(e){hl.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=uc,this.L=this.M=!1}go(lc,hl);var uc="",cc=/^https?$/i,dc=["POST","PUT"];function hc(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,pc(e),mc(e)}function pc(e){e.F||(e.F=!0,pl(e,"complete"),pl(e,"error"))}function fc(e){if(e.h&&"undefined"!=typeof ao&&(!e.C[1]||4!=yc(e)||2!=e.da()))if(e.v&&4==yc(e))El(e.La,0,e);else if(pl(e,"readystatechange"),4==yc(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===o){var s=String(e.I).match(bu)[1]||null;!s&&io.self&&io.self.location&&(s=io.self.location.protocol.slice(0,-1)),r=!cc.test(s?s.toLowerCase():"")}n=r}if(n)pl(e,"complete"),pl(e,"success");else{e.m=6;try{var a=2<yc(e)?e.g.statusText:""}catch(i){a=""}e.j=a+" ["+e.da()+"]",pc(e)}}finally{mc(e)}}}function mc(e,t){if(e.g){gc(e);const r=e.g,s=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||pl(e,"ready");try{r.onreadystatechange=s}catch(n){}}}function gc(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(io.clearTimeout(e.A),e.A=null)}function yc(e){return e.g?e.g.readyState:0}function vc(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case uc:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function bc(e){let t="";return qo(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function xc(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=bc(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Cu(e,t,n))}function wc(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function kc(e){this.Ga=0,this.j=[],this.l=new Ml,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=wc("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=wc("baseRetryDelayMs",5e3,e),this.hb=wc("retryDelaySeedMs",1e4,e),this.eb=wc("forwardChannelMaxRetries",2,e),this.xa=wc("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Uu(e&&e.concurrentRequestLimit),this.Ja=new Ju,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Sc(e){if(Cc(e),3==e.H){var t=e.W++,n=wu(e.I);if(Cu(n,"SID",e.K),Cu(n,"RID",t),Cu(n,"TYPE","terminate"),Ec(e,n),(t=new nu(e,e.l,t)).L=2,t.v=Tu(wu(n)),n=!1,io.navigator&&io.navigator.sendBeacon)try{n=io.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&io.Image&&((new Image).src=t.v,n=!0),n||(t.g=Bc(t.l,null),t.g.ha(t.v)),t.G=Date.now(),hu(t)}Pc(e)}function Ic(e){e.g&&($c(e),e.g.cancel(),e.g=null)}function Cc(e){Ic(e),e.u&&(io.clearTimeout(e.u),e.u=null),Dc(e),e.i.cancel(),e.m&&("number"===typeof e.m&&io.clearTimeout(e.m),e.m=null)}function Tc(e){if(!Wu(e.i)&&!e.m){e.m=!0;var t=e.Na;wl||Il(),kl||(wl(),kl=!0),Sl.add(t,e),e.C=0}}function Nc(e,t){var n;n=t?t.m:e.W++;const r=wu(e.I);Cu(r,"SID",e.K),Cu(r,"RID",n),Cu(r,"AID",e.V),Ec(e,r),e.o&&e.s&&xc(r,e.o,e.s),n=new nu(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Ac(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),qu(e.i,n),ou(n,r,t)}function Ec(e,t){e.na&&qo(e.na,(function(e,n){Cu(t,n,e)})),e.h&&vu({},(function(e,n){Cu(t,n,e)}))}function Ac(e,t,n){n=Math.min(e.j.length,n);var r=e.h?fo(e.h.Va,e.h,e):null;e:{var s=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=s[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let i=!0;for(let o=0;o<n;o++){let n=s[o].g;const l=s[o].map;if(n-=t,0>n)t=Math.max(0,s[o].g-100),i=!1;else try{Zu(l,e,"req"+n+"_")}catch(a){r&&r(l)}}if(i){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function Rc(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;wl||Il(),kl||(wl(),kl=!0),Sl.add(t,e),e.A=0}}function _c(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=Gl(fo(e.Ma,e),Fc(e,e.A)),e.A++,!0)}function $c(e){null!=e.B&&(io.clearTimeout(e.B),e.B=null)}function Oc(e){e.g=new nu(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=wu(e.wa);Cu(t,"RID","rpc"),Cu(t,"SID",e.K),Cu(t,"AID",e.V),Cu(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Cu(t,"TO",e.qa),Cu(t,"TYPE","xmlhttp"),Ec(e,t),e.o&&e.s&&xc(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Tu(wu(t)),n.s=null,n.S=!0,lu(n,e)}function Dc(e){null!=e.v&&(io.clearTimeout(e.v),e.v=null)}function Mc(e,t){var n=null;if(e.g==t){Dc(e),$c(e),e.g=null;var r=2}else{if(!Hu(e.i,t))return;n=t.F,Ku(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var s=e.C;pl(r=zl(),new Wl(r,n)),Tc(e)}else Rc(e);else if(3==(s=t.o)||0==s&&0<t.ca||!(1==r&&function(e,t){return!(Gu(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=Gl(fo(e.Na,e,t),Fc(e,e.C)),e.C++,!0))}(e,t)||2==r&&_c(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),s){case 1:Lc(e,5);break;case 4:Lc(e,10);break;case 3:Lc(e,6);break;default:Lc(e,2)}}function Fc(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Lc(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=fo(e.pb,e);n||(n=new xu("//www.google.com/images/cleardot.gif"),io.location&&"http"==io.location.protocol||ku(n,"https"),Tu(n)),function(e,t){const n=new Ml;if(io.Image){const r=new Image;r.onload=mo(ec,n,r,"TestLoadImage: loaded",!0,t),r.onerror=mo(ec,n,r,"TestLoadImage: error",!1,t),r.onabort=mo(ec,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=mo(ec,n,r,"TestLoadImage: timeout",!1,t),io.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Vl(2);e.H=0,e.h&&e.h.za(t),Pc(e),Cc(e)}function Pc(e){if(e.H=0,e.ma=[],e.h){const t=Xu(e.i);0==t.length&&0==e.j.length||(xo(e.ma,t),xo(e.ma,e.j),e.i.i.length=0,bo(e.j),e.j.length=0),e.h.ya()}}function zc(e,t,n){var r=n instanceof xu?wu(n):new xu(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Su(r,r.m);else{var s=io.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var a=new xu(null);r&&ku(a,r),t&&(a.g=t),s&&Su(a,s),n&&(a.l=n),r=a}return n=e.F,t=e.Da,n&&t&&Cu(r,n,t),Cu(r,"VER",e.ra),Ec(e,r),r}function Bc(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new lc(new tc({ob:!0})):new lc(e.va)).Oa(e.J),t}function jc(){}function Uc(){if(Ro&&!(10<=Number(Bo)))throw Error("Environmental error: no available transport.")}function Vc(e,t){hl.call(this),this.g=new kc(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!So(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!So(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Hc(this)}function Wc(e){Zl.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Gc(){eu.call(this),this.status=1}function Hc(e){this.g=e}function qc(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Kc(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var s=0;16>s;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var a=e.g[3],i=t+(a^n&(s^a))+r[0]+3614090360&4294967295;i=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=(n=(s=(a=(t=n+(i<<7&4294967295|i>>>25))+((i=a+(s^t&(n^s))+r[1]+3905402710&4294967295)<<12&4294967295|i>>>20))+((i=s+(n^a&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^s&(a^t))+r[3]+3250441966&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^n&(s^a))+r[4]+4118548399&4294967295)<<7&4294967295|i>>>25))+((i=a+(s^t&(n^s))+r[5]+1200080426&4294967295)<<12&4294967295|i>>>20))+((i=s+(n^a&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^s&(a^t))+r[7]+4249261313&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^n&(s^a))+r[8]+1770035416&4294967295)<<7&4294967295|i>>>25))+((i=a+(s^t&(n^s))+r[9]+2336552879&4294967295)<<12&4294967295|i>>>20))+((i=s+(n^a&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^s&(a^t))+r[11]+2304563134&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^n&(s^a))+r[12]+1804603682&4294967295)<<7&4294967295|i>>>25))+((i=a+(s^t&(n^s))+r[13]+4254626195&4294967295)<<12&4294967295|i>>>20))+((i=s+(n^a&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^s&(a^t))+r[15]+1236535329&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^a&(n^s))+r[1]+4129170786&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^s&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|i>>>23))+((i=s+(t^n&(a^t))+r[11]+643717713&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(s^a))+r[0]+3921069994&4294967295)<<20&4294967295|i>>>12))+((i=t+(s^a&(n^s))+r[5]+3593408605&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^s&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|i>>>23))+((i=s+(t^n&(a^t))+r[15]+3634488961&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(s^a))+r[4]+3889429448&4294967295)<<20&4294967295|i>>>12))+((i=t+(s^a&(n^s))+r[9]+568446438&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^s&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|i>>>23))+((i=s+(t^n&(a^t))+r[3]+4107603335&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(s^a))+r[8]+1163531501&4294967295)<<20&4294967295|i>>>12))+((i=t+(s^a&(n^s))+r[13]+2850285829&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^s&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|i>>>23))+((i=s+(t^n&(a^t))+r[7]+1735328473&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(s^a))+r[12]+2368359562&4294967295)<<20&4294967295|i>>>12))+((i=t+(n^s^a)+r[5]+4294588738&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^s)+r[8]+2272392833&4294967295)<<11&4294967295|i>>>21))+((i=s+(a^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|i>>>16))+((i=n+(s^a^t)+r[14]+4259657740&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^s^a)+r[1]+2763975236&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^s)+r[4]+1272893353&4294967295)<<11&4294967295|i>>>21))+((i=s+(a^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|i>>>16))+((i=n+(s^a^t)+r[10]+3200236656&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^s^a)+r[13]+681279174&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^s)+r[0]+3936430074&4294967295)<<11&4294967295|i>>>21))+((i=s+(a^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|i>>>16))+((i=n+(s^a^t)+r[6]+76029189&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^s^a)+r[9]+3654602809&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^s)+r[12]+3873151461&4294967295)<<11&4294967295|i>>>21))+((i=s+(a^t^n)+r[15]+530742520&4294967295)<<16&4294967295|i>>>16))+((i=n+(s^a^t)+r[2]+3299628645&4294967295)<<23&4294967295|i>>>9))+((i=t+(s^(n|~a))+r[0]+4096336452&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~s))+r[7]+1126891415&4294967295)<<10&4294967295|i>>>22))+((i=s+(t^(a|~n))+r[14]+2878612391&4294967295)<<15&4294967295|i>>>17))+((i=n+(a^(s|~t))+r[5]+4237533241&4294967295)<<21&4294967295|i>>>11))+((i=t+(s^(n|~a))+r[12]+1700485571&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~s))+r[3]+2399980690&4294967295)<<10&4294967295|i>>>22))+((i=s+(t^(a|~n))+r[10]+4293915773&4294967295)<<15&4294967295|i>>>17))+((i=n+(a^(s|~t))+r[1]+2240044497&4294967295)<<21&4294967295|i>>>11))+((i=t+(s^(n|~a))+r[8]+1873313359&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~s))+r[15]+4264355552&4294967295)<<10&4294967295|i>>>22))+((i=s+(t^(a|~n))+r[6]+2734768916&4294967295)<<15&4294967295|i>>>17))+((i=n+(a^(s|~t))+r[13]+1309151649&4294967295)<<21&4294967295|i>>>11))+((a=(t=n+((i=t+(s^(n|~a))+r[4]+4149444226&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~s))+r[11]+3174756917&4294967295)<<10&4294967295|i>>>22))^((s=a+((i=s+(t^(a|~n))+r[2]+718787259&4294967295)<<15&4294967295|i>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(i<<21&4294967295|i>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+a&4294967295}function Xc(e,t){this.h=t;for(var n=[],r=!0,s=e.length-1;0<=s;s--){var a=0|e[s];r&&a==t||(n[s]=a,r=!1)}this.g=n}(no=lc.prototype).Oa=function(e){this.M=e},no.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ql.g(),this.C=this.u?Xl(this.u):Xl(Ql),this.g.onreadystatechange=fo(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(a){return void hc(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),s=io.FormData&&e instanceof io.FormData,!(0<=vo(dc,t))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{gc(this),0<this.B&&((this.L=function(e){return Ro&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=fo(this.ua,this)):this.A=El(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){hc(this,a)}},no.ua=function(){"undefined"!=typeof ao&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,pl(this,"timeout"),this.abort(8))},no.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,pl(this,"complete"),pl(this,"abort"),mc(this))},no.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),mc(this,!0)),lc.$.N.call(this)},no.La=function(){this.s||(this.G||this.v||this.l?fc(this):this.kb())},no.kb=function(){fc(this)},no.isActive=function(){return!!this.g},no.da=function(){try{return 2<yc(this)?this.g.status:-1}catch(Yu){return-1}},no.ja=function(){try{return this.g?this.g.responseText:""}catch(Yu){return""}},no.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),oc(t)}},no.Ia=function(){return this.m},no.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(no=kc.prototype).ra=8,no.H=1,no.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const s=new nu(this,this.l,e);let a=this.s;if(this.U&&(a?(a=Ko(a),Yo(a,this.U)):a=this.U),null!==this.o||this.O||(s.I=a,a=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Ac(this,s,t),Cu(n=wu(this.I),"RID",e),Cu(n,"CVER",22),this.F&&Cu(n,"X-HTTP-Session-Id",this.F),Ec(this,n),a&&(this.O?t="headers="+encodeURIComponent(String(bc(a)))+"&"+t:this.o&&xc(n,this.o,a)),qu(this.i,s),this.bb&&Cu(n,"TYPE","init"),this.P?(Cu(n,"$req",t),Cu(n,"SID","null"),s.aa=!0,ou(s,n,null)):ou(s,n,t),this.H=2}}else 3==this.H&&(e?Nc(this,e):0==this.j.length||Wu(this.i)||Nc(this))},no.Ma=function(){if(this.u=null,Oc(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Gl(fo(this.jb,this),e)}},no.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Vl(10),Ic(this),Oc(this))},no.ib=function(){null!=this.v&&(this.v=null,Ic(this),_c(this),Vl(19))},no.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Vl(2)):(this.l.info("Failed to ping google.com"),Vl(1))},no.isActive=function(){return!!this.h&&this.h.isActive(this)},(no=jc.prototype).Ba=function(){},no.Aa=function(){},no.za=function(){},no.ya=function(){},no.isActive=function(){return!0},no.Va=function(){},Uc.prototype.g=function(e,t){return new Vc(e,t)},go(Vc,hl),Vc.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Vl(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=zc(e,null,e.Y),Tc(e)},Vc.prototype.close=function(){Sc(this.g)},Vc.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=ml(e),e=n);t.j.push(new ju(t.fb++,e)),3==t.H&&Tc(t)},Vc.prototype.N=function(){this.g.h=null,delete this.j,Sc(this.g),delete this.g,Vc.$.N.call(this)},go(Wc,Zl),go(Gc,eu),go(Hc,jc),Hc.prototype.Ba=function(){pl(this.g,"a")},Hc.prototype.Aa=function(e){pl(this.g,new Wc(e))},Hc.prototype.za=function(e){pl(this.g,new Gc)},Hc.prototype.ya=function(){pl(this.g,"b")},go(qc,(function(){this.blockSize=-1})),qc.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},qc.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,s=this.h,a=0;a<t;){if(0==s)for(;a<=n;)Kc(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(r[s++]=e.charCodeAt(a++),s==this.blockSize){Kc(this,r),s=0;break}}else for(;a<t;)if(r[s++]=e[a++],s==this.blockSize){Kc(this,r),s=0;break}}this.h=s,this.i+=t},qc.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var Yc={};function Qc(e){return-128<=e&&128>e?function(e,t){var n=Yc;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new Xc([0|e],0>e?-1:0)})):new Xc([0|e],0>e?-1:0)}function Jc(e){if(isNaN(e)||!isFinite(e))return ed;if(0>e)return ad(Jc(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=Zc;return new Xc(t,0)}var Zc=4294967296,ed=Qc(0),td=Qc(1),nd=Qc(16777216);function rd(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function sd(e){return-1==e.h}function ad(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new Xc(n,~e.h).add(td)}function id(e,t){return e.add(ad(t))}function od(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function ld(e,t){this.g=e,this.h=t}function ud(e,t){if(rd(t))throw Error("division by zero");if(rd(e))return new ld(ed,ed);if(sd(e))return t=ud(ad(e),t),new ld(ad(t.g),ad(t.h));if(sd(t))return t=ud(e,ad(t)),new ld(ad(t.g),t.h);if(30<e.g.length){if(sd(e)||sd(t))throw Error("slowDivide_ only works with positive integers.");for(var n=td,r=t;0>=r.X(e);)n=cd(n),r=cd(r);var s=dd(n,1),a=dd(r,1);for(r=dd(r,2),n=dd(n,2);!rd(r);){var i=a.add(r);0>=i.X(e)&&(s=s.add(n),a=i),r=dd(r,1),n=dd(n,1)}return t=id(e,s.R(t)),new ld(s,t)}for(s=ed;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),i=(a=Jc(n)).R(t);sd(i)||0<i.X(e);)i=(a=Jc(n-=r)).R(t);rd(a)&&(a=td),s=s.add(a),e=id(e,i)}return new ld(s,e)}function cd(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new Xc(n,e.h)}function dd(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,s=[],a=0;a<r;a++)s[a]=0<t?e.D(a+n)>>>t|e.D(a+n+1)<<32-t:e.D(a+n);return new Xc(s,e.h)}(no=Xc.prototype).ea=function(){if(sd(this))return-ad(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:Zc+r)*t,t*=Zc}return e},no.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(rd(this))return"0";if(sd(this))return"-"+ad(this).toString(e);for(var t=Jc(Math.pow(e,6)),n=this,r="";;){var s=ud(n,t).g,a=((0<(n=id(n,s.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(rd(n=s))return a+r;for(;6>a.length;)a="0"+a;r=a+r}},no.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},no.X=function(e){return sd(e=id(this,e))?-1:rd(e)?0:1},no.abs=function(){return sd(this)?ad(this):this},no.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,s=0;s<=t;s++){var a=r+(65535&this.D(s))+(65535&e.D(s)),i=(a>>>16)+(this.D(s)>>>16)+(e.D(s)>>>16);r=i>>>16,a&=65535,i&=65535,n[s]=i<<16|a}return new Xc(n,-2147483648&n[n.length-1]?-1:0)},no.R=function(e){if(rd(this)||rd(e))return ed;if(sd(this))return sd(e)?ad(this).R(ad(e)):ad(ad(this).R(e));if(sd(e))return ad(this.R(ad(e)));if(0>this.X(nd)&&0>e.X(nd))return Jc(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<e.g.length;s++){var a=this.D(r)>>>16,i=65535&this.D(r),o=e.D(s)>>>16,l=65535&e.D(s);n[2*r+2*s]+=i*l,od(n,2*r+2*s),n[2*r+2*s+1]+=a*l,od(n,2*r+2*s+1),n[2*r+2*s+1]+=i*o,od(n,2*r+2*s+1),n[2*r+2*s+2]+=a*o,od(n,2*r+2*s+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new Xc(n,0)},no.gb=function(e){return ud(this,e).h},no.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new Xc(n,this.h&e.h)},no.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new Xc(n,this.h|e.h)},no.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new Xc(n,this.h^e.h)},Uc.prototype.createWebChannel=Uc.prototype.g,Vc.prototype.send=Vc.prototype.u,Vc.prototype.open=Vc.prototype.m,Vc.prototype.close=Vc.prototype.close,Hl.NO_ERROR=0,Hl.TIMEOUT=8,Hl.HTTP_ERROR=6,ql.COMPLETE="complete",Yl.EventType=Jl,Jl.OPEN="a",Jl.CLOSE="b",Jl.ERROR="c",Jl.MESSAGE="d",hl.prototype.listen=hl.prototype.O,lc.prototype.listenOnce=lc.prototype.P,lc.prototype.getLastError=lc.prototype.Sa,lc.prototype.getLastErrorCode=lc.prototype.Ia,lc.prototype.getStatus=lc.prototype.da,lc.prototype.getResponseJson=lc.prototype.Wa,lc.prototype.getResponseText=lc.prototype.ja,lc.prototype.send=lc.prototype.ha,lc.prototype.setWithCredentials=lc.prototype.Oa,qc.prototype.digest=qc.prototype.l,qc.prototype.reset=qc.prototype.reset,qc.prototype.update=qc.prototype.j,Xc.prototype.add=Xc.prototype.add,Xc.prototype.multiply=Xc.prototype.R,Xc.prototype.modulo=Xc.prototype.gb,Xc.prototype.compare=Xc.prototype.X,Xc.prototype.toNumber=Xc.prototype.ea,Xc.prototype.toString=Xc.prototype.toString,Xc.prototype.getBits=Xc.prototype.D,Xc.fromNumber=Jc,Xc.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return ad(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Jc(Math.pow(n,8)),s=ed,a=0;a<t.length;a+=8){var i=Math.min(8,t.length-a),o=parseInt(t.substring(a,a+i),n);8>i?(i=Jc(Math.pow(n,i)),s=s.R(i).add(Jc(o))):s=(s=s.R(r)).add(Jc(o))}return s};var hd=so.createWebChannelTransport=function(){return new Uc},pd=so.getStatEventTarget=function(){return zl()},fd=so.ErrorCode=Hl,md=so.EventType=ql,gd=so.Event=Ll,yd=so.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},vd=so.FetchXmlHttpFactory=tc,bd=so.WebChannel=Yl,xd=so.XhrIo=lc,wd=so.Md5=qc,kd=so.Integer=Xc;const Sd="@firebase/firestore";class Id{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Id.UNAUTHENTICATED=new Id(null),Id.GOOGLE_CREDENTIALS=new Id("google-credentials-uid"),Id.FIRST_PARTY=new Id("first-party-uid"),Id.MOCK_USER=new Id("mock-user");let Cd="9.23.0";const Td=new Dn("@firebase/firestore");function Nd(){return Td.logLevel}function Ed(e){if(Td.logLevel<=En.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(_d);Td.debug(`Firestore (${Cd}): ${e}`,...s)}}function Ad(e){if(Td.logLevel<=En.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(_d);Td.error(`Firestore (${Cd}): ${e}`,...s)}}function Rd(e){if(Td.logLevel<=En.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(_d);Td.warn(`Firestore (${Cd}): ${e}`,...s)}}function _d(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function $d(){const e=`FIRESTORE (${Cd}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw Ad(e),new Error(e)}function Od(e,t){e||$d()}function Dd(e,t){return e}const Md={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Fd extends hn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ld{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Pd{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class zd{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Id.UNAUTHENTICATED)))}shutdown(){}}class Bd{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class jd{constructor(e){this.t=e,this.currentUser=Id.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new Ld;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ld,e.enqueueRetryable((()=>r(this.currentUser)))};const a=()=>{const t=s;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},i=e=>{Ed("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit((e=>i(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?i(e):(Ed("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ld)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Ed("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Od("string"==typeof t.accessToken),new Pd(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Od(null===e||"string"==typeof e),new Id(e)}}class Ud{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=Id.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Vd{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new Ud(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(Id.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Wd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Gd{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&Ed("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.T;return this.T=e.token,Ed("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{Ed("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?r(e):Ed("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Od("string"==typeof e.token),this.T=e.token,new Wd(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Hd(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class qd{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=Hd(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%62))}return n}}function Kd(e,t){return e<t?-1:e>t?1:0}function Xd(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class Yd{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Fd(Md.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Fd(Md.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Fd(Md.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Fd(Md.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Yd.fromMillis(Date.now())}static fromDate(e){return Yd.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Yd(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Kd(this.nanoseconds,e.nanoseconds):Kd(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Qd{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Qd(e)}static min(){return new Qd(new Yd(0,0))}static max(){return new Qd(new Yd(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Jd{constructor(e,t,n){void 0===t?t=0:t>e.length&&$d(),void 0===n?n=e.length-t:n>e.length-t&&$d(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Jd.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Jd?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),s=t.get(r);if(n<s)return-1;if(n>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Zd extends Jd{construct(e,t,n){return new Zd(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n){if(s.indexOf("//")>=0)throw new Fd(Md.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);e.push(...s.split("/").filter((e=>e.length>0)))}return new Zd(e)}static emptyPath(){return new Zd([])}}const eh=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class th extends Jd{construct(e,t,n){return new th(e,t,n)}static isValidIdentifier(e){return eh.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),th.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new th(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new Fd(Md.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Fd(Md.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Fd(Md.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(a=!a,r++):"."!==t||a?(n+=t,r++):(s(),r++)}if(s(),a)throw new Fd(Md.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new th(t)}static emptyPath(){return new th([])}}class nh{constructor(e){this.path=e}static fromPath(e){return new nh(Zd.fromString(e))}static fromName(e){return new nh(Zd.fromString(e).popFirst(5))}static empty(){return new nh(Zd.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Zd.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Zd.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new nh(new Zd(e.slice()))}}class rh{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}rh.UNKNOWN_ID=-1;function sh(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=Qd.fromTimestamp(1e9===r?new Yd(n+1,0):new Yd(n,r));return new ih(s,nh.empty(),t)}function ah(e){return new ih(e.readTime,e.key,-1)}class ih{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ih(Qd.min(),nh.empty(),-1)}static max(){return new ih(Qd.max(),nh.empty(),-1)}}function oh(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=nh.comparator(e.documentKey,t.documentKey),0!==n?n:Kd(e.largestBatchId,t.largestBatchId))}const lh="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uh{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ch(e){if(e.code!==Md.FAILED_PRECONDITION||e.message!==lh)throw e;Ed("LocalStore","Unexpectedly lost primary lease")}class dh{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$d(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new dh(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof dh?t:dh.resolve(t)}catch(e){return dh.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):dh.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):dh.reject(t)}static resolve(e){return new dh(((t,n)=>{t(e)}))}static reject(e){return new dh(((t,n)=>{n(e)}))}static waitFor(e){return new dh(((t,n)=>{let r=0,s=0,a=!1;e.forEach((e=>{++r,e.next((()=>{++s,a&&s===r&&t()}),(e=>n(e)))})),a=!0,s===r&&t()}))}static or(e){let t=dh.resolve(!1);for(const n of e)t=t.next((e=>e?dh.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new dh(((n,r)=>{const s=e.length,a=new Array(s);let i=0;for(let o=0;o<s;o++){const l=o;t(e[l]).next((e=>{a[l]=e,++i,i===s&&n(a)}),(e=>r(e)))}}))}static doWhile(e,t){return new dh(((n,r)=>{const s=()=>{!0===e()?t().next((()=>{s()}),r):n()};s()}))}}function hh(e){return"IndexedDbTransactionError"===e.name}class ph{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function fh(e){return null==e}function mh(e){return 0===e&&1/e==-1/0}function gh(e){return"number"==typeof e&&Number.isInteger(e)&&!mh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}ph.ct=-1;const yh=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],vh=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],bh=vh;function xh(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function wh(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function kh(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Sh{constructor(e,t){this.comparator=e,this.root=t||Ch.EMPTY}insert(e,t){return new Sh(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ch.BLACK,null,null))}remove(e){return new Sh(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ch.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ih(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ih(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ih(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ih(this.root,e,this.comparator,!0)}}class Ih{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ch{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:Ch.RED,this.left=null!=r?r:Ch.EMPTY,this.right=null!=s?s:Ch.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new Ch(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ch.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ch.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ch.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ch.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw $d();if(this.right.isRed())throw $d();const e=this.left.check();if(e!==this.right.check())throw $d();return e+(this.isRed()?0:1)}}Ch.EMPTY=null,Ch.RED=!0,Ch.BLACK=!1,Ch.EMPTY=new class{constructor(){this.size=0}get key(){throw $d()}get value(){throw $d()}get color(){throw $d()}get left(){throw $d()}get right(){throw $d()}copy(e,t,n,r,s){return this}insert(e,t,n){return new Ch(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Th{constructor(e){this.comparator=e,this.data=new Sh(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Nh(this.data.getIterator())}getIteratorFrom(e){return new Nh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Th))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Th(this.comparator);return t.data=e,t}}class Nh{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Eh{constructor(e){this.fields=e,e.sort(th.comparator)}static empty(){return new Eh([])}unionWith(e){let t=new Th(th.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Eh(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xd(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Ah extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Rh{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ah("Invalid base64 string: "+e):e}}(e);return new Rh(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Rh(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Kd(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rh.EMPTY_BYTE_STRING=new Rh("");const _h=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $h(e){if(Od(!!e),"string"==typeof e){let t=0;const n=_h.exec(e);if(Od(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Oh(e.seconds),nanos:Oh(e.nanos)}}function Oh(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Dh(e){return"string"==typeof e?Rh.fromBase64String(e):Rh.fromUint8Array(e)}function Mh(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Fh(e){const t=e.mapValue.fields.__previous_value__;return Mh(t)?Fh(t):t}function Lh(e){const t=$h(e.mapValue.fields.__local_write_time__.timestampValue);return new Yd(t.seconds,t.nanos)}class Ph{constructor(e,t,n,r,s,a,i,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=i,this.longPollingOptions=o,this.useFetchStreams=l}}class zh{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new zh("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof zh&&e.projectId===this.projectId&&e.database===this.database}}const Bh={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function jh(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Mh(e)?4:tp(e)?9007199254740991:10:$d()}function Uh(e,t){if(e===t)return!0;const n=jh(e);if(n!==jh(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Lh(e).isEqual(Lh(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=$h(e.timestampValue),r=$h(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Dh(e.bytesValue).isEqual(Dh(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Oh(e.geoPointValue.latitude)===Oh(t.geoPointValue.latitude)&&Oh(e.geoPointValue.longitude)===Oh(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Oh(e.integerValue)===Oh(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Oh(e.doubleValue),r=Oh(t.doubleValue);return n===r?mh(n)===mh(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Xd(e.arrayValue.values||[],t.arrayValue.values||[],Uh);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(xh(n)!==xh(r))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===r[s]||!Uh(n[s],r[s])))return!1;return!0}(e,t);default:return $d()}}function Vh(e,t){return void 0!==(e.values||[]).find((e=>Uh(e,t)))}function Wh(e,t){if(e===t)return 0;const n=jh(e),r=jh(t);if(n!==r)return Kd(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Kd(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Oh(e.integerValue||e.doubleValue),r=Oh(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Gh(e.timestampValue,t.timestampValue);case 4:return Gh(Lh(e),Lh(t));case 5:return Kd(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Dh(e),r=Dh(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let s=0;s<n.length&&s<r.length;s++){const e=Kd(n[s],r[s]);if(0!==e)return e}return Kd(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Kd(Oh(e.latitude),Oh(t.latitude));return 0!==n?n:Kd(Oh(e.longitude),Oh(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let s=0;s<n.length&&s<r.length;++s){const e=Wh(n[s],r[s]);if(e)return e}return Kd(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Bh.mapValue&&t===Bh.mapValue)return 0;if(e===Bh.mapValue)return 1;if(t===Bh.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),s=t.fields||{},a=Object.keys(s);r.sort(),a.sort();for(let i=0;i<r.length&&i<a.length;++i){const e=Kd(r[i],a[i]);if(0!==e)return e;const t=Wh(n[r[i]],s[a[i]]);if(0!==t)return t}return Kd(r.length,a.length)}(e.mapValue,t.mapValue);default:throw $d()}}function Gh(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Kd(e,t);const n=$h(e),r=$h(t),s=Kd(n.seconds,r.seconds);return 0!==s?s:Kd(n.nanos,r.nanos)}function Hh(e){return qh(e)}function qh(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=$h(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Dh(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,nh.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=qh(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+=`${s}:${qh(e.fields[s])}`;return n+"}"}(e.mapValue):$d();var t,n}function Kh(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Xh(e){return!!e&&"integerValue"in e}function Yh(e){return!!e&&"arrayValue"in e}function Qh(e){return!!e&&"nullValue"in e}function Jh(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Zh(e){return!!e&&"mapValue"in e}function ep(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return wh(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=ep(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ep(e.arrayValue.values[n]);return t}return Object.assign({},e)}function tp(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class np{constructor(e){this.value=e}static empty(){return new np({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Zh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ep(t)}setAll(e){let t=th.emptyPath(),n={},r=[];e.forEach(((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=ep(e):r.push(s.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());Zh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Uh(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Zh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){wh(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new np(ep(this.value))}}function rp(e){const t=[];return wh(e.fields,((e,n)=>{const r=new th([e]);if(Zh(n)){const e=rp(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Eh(t)}class sp{constructor(e,t,n,r,s,a,i){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=a,this.documentState=i}static newInvalidDocument(e){return new sp(e,0,Qd.min(),Qd.min(),Qd.min(),np.empty(),0)}static newFoundDocument(e,t,n,r){return new sp(e,1,t,Qd.min(),n,r,0)}static newNoDocument(e,t){return new sp(e,2,t,Qd.min(),Qd.min(),np.empty(),0)}static newUnknownDocument(e,t){return new sp(e,3,t,Qd.min(),Qd.min(),np.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qd.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=np.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=np.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qd.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof sp&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new sp(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ap{constructor(e,t){this.position=e,this.inclusive=t}}function ip(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const a=t[s],i=e.position[s];if(r=a.field.isKeyField()?nh.comparator(nh.fromName(i.referenceValue),n.key):Wh(i,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function op(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Uh(e.position[n],t.position[n]))return!1;return!0}class lp{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function up(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class cp{}class dp extends cp{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new bp(e,t,n):"array-contains"===t?new Sp(e,n):"in"===t?new Ip(e,n):"not-in"===t?new Cp(e,n):"array-contains-any"===t?new Tp(e,n):new dp(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new xp(e,n):new wp(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Wh(t,this.value)):null!==t&&jh(this.value)===jh(t)&&this.matchesComparison(Wh(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return $d()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class hp extends cp{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new hp(e,t)}matches(e){return pp(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft((e=>e.isInequality()));return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function pp(e){return"and"===e.op}function fp(e){return mp(e)&&pp(e)}function mp(e){for(const t of e.filters)if(t instanceof hp)return!1;return!0}function gp(e){if(e instanceof dp)return e.field.canonicalString()+e.op.toString()+Hh(e.value);if(fp(e))return e.filters.map((e=>gp(e))).join(",");{const t=e.filters.map((e=>gp(e))).join(",");return`${e.op}(${t})`}}function yp(e,t){return e instanceof dp?function(e,t){return t instanceof dp&&e.op===t.op&&e.field.isEqual(t.field)&&Uh(e.value,t.value)}(e,t):e instanceof hp?function(e,t){return t instanceof hp&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&yp(n,t.filters[r])),!0)}(e,t):void $d()}function vp(e){return e instanceof dp?function(e){return`${e.field.canonicalString()} ${e.op} ${Hh(e.value)}`}(e):e instanceof hp?function(e){return e.op.toString()+" {"+e.getFilters().map(vp).join(" ,")+"}"}(e):"Filter"}class bp extends dp{constructor(e,t,n){super(e,t,n),this.key=nh.fromName(n.referenceValue)}matches(e){const t=nh.comparator(e.key,this.key);return this.matchesComparison(t)}}class xp extends dp{constructor(e,t){super(e,"in",t),this.keys=kp("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class wp extends dp{constructor(e,t){super(e,"not-in",t),this.keys=kp("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function kp(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>nh.fromName(e.referenceValue)))}class Sp extends dp{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Yh(t)&&Vh(t.arrayValue,this.value)}}class Ip extends dp{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Vh(this.value.arrayValue,t)}}class Cp extends dp{constructor(e,t){super(e,"not-in",t)}matches(e){if(Vh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Vh(this.value.arrayValue,t)}}class Tp extends dp{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Yh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Vh(this.value.arrayValue,e)))}}class Np{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=a,this.endAt=i,this.dt=null}}function Ep(e){return new Np(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Ap(e){const t=Dd(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>gp(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),fh(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Hh(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Hh(e))).join(",")),t.dt=e}return t.dt}function Rp(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!up(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!yp(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!op(e.startAt,t.startAt)&&op(e.endAt,t.endAt)}function _p(e){return nh.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class $p{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=a,this.startAt=i,this.endAt=o,this.wt=null,this._t=null,this.startAt,this.endAt}}function Op(e,t,n,r,s,a,i,o){return new $p(e,t,n,r,s,a,i,o)}function Dp(e){return new $p(e)}function Mp(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Fp(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Lp(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function Pp(e){return null!==e.collectionGroup}function zp(e){const t=Dd(e);if(null===t.wt){t.wt=[];const e=Lp(t),n=Fp(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new lp(e)),t.wt.push(new lp(th.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new lp(th.keyField(),e))}}}return t.wt}function Bp(e){const t=Dd(e);if(!t._t)if("F"===t.limitType)t._t=Ep(t.path,t.collectionGroup,zp(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const s of zp(t)){const t="desc"===s.dir?"asc":"desc";e.push(new lp(s.field,t))}const n=t.endAt?new ap(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ap(t.startAt.position,t.startAt.inclusive):null;t._t=Ep(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t._t}function jp(e,t){t.getFirstInequalityField(),Lp(e);const n=e.filters.concat([t]);return new $p(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Up(e,t,n){return new $p(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Vp(e,t){return Rp(Bp(e),Bp(t))&&e.limitType===t.limitType}function Wp(e){return`${Ap(Bp(e))}|lt:${e.limitType}`}function Gp(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>vp(e))).join(", ")}]`),fh(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Hh(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Hh(e))).join(",")),`Target(${t})`}(Bp(e))}; limitType=${e.limitType})`}function Hp(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):nh.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of zp(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=ip(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,zp(e),t))&&!(e.endAt&&!function(e,t,n){const r=ip(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,zp(e),t))}(e,t)}function qp(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Kp(e){return(t,n)=>{let r=!1;for(const s of zp(e)){const e=Xp(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}function Xp(e,t,n){const r=e.field.isKeyField()?nh.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?Wh(r,s):$d()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return $d()}}class Yp{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){wh(this.inner,((t,n)=>{for(const[r,s]of n)e(r,s)}))}isEmpty(){return kh(this.inner)}size(){return this.innerSize}}const Qp=new Sh(nh.comparator);function Jp(){return Qp}const Zp=new Sh(nh.comparator);function ef(){let e=Zp;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e=e.insert(s.key,s);return e}function tf(e){let t=Zp;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function nf(){return sf()}function rf(){return sf()}function sf(){return new Yp((e=>e.toString()),((e,t)=>e.isEqual(t)))}const af=new Sh(nh.comparator),of=new Th(nh.comparator);function lf(){let e=of;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e=e.add(s);return e}const uf=new Th(Kd);function cf(){return uf}function df(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mh(t)?"-0":t}}function hf(e){return{integerValue:""+e}}function pf(e,t){return gh(t)?hf(t):df(e,t)}class ff{constructor(){this._=void 0}}function mf(e,t,n){return e instanceof vf?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Mh(t)&&(t=Fh(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof bf?xf(e,t):e instanceof wf?kf(e,t):function(e,t){const n=yf(e,t),r=If(n)+If(e.gt);return Xh(n)&&Xh(e.gt)?hf(r):df(e.serializer,r)}(e,t)}function gf(e,t,n){return e instanceof bf?xf(e,t):e instanceof wf?kf(e,t):n}function yf(e,t){return e instanceof Sf?Xh(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class vf extends ff{}class bf extends ff{constructor(e){super(),this.elements=e}}function xf(e,t){const n=Cf(t);for(const r of e.elements)n.some((e=>Uh(e,r)))||n.push(r);return{arrayValue:{values:n}}}class wf extends ff{constructor(e){super(),this.elements=e}}function kf(e,t){let n=Cf(t);for(const r of e.elements)n=n.filter((e=>!Uh(e,r)));return{arrayValue:{values:n}}}class Sf extends ff{constructor(e,t){super(),this.serializer=e,this.gt=t}}function If(e){return Oh(e.integerValue||e.doubleValue)}function Cf(e){return Yh(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Tf{constructor(e,t){this.field=e,this.transform=t}}class Nf{constructor(e,t){this.version=e,this.transformResults=t}}class Ef{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ef}static exists(e){return new Ef(void 0,e)}static updateTime(e){return new Ef(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Af(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Rf{}function _f(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new jf(e.key,Ef.none()):new Ff(e.key,e.data,Ef.none());{const n=e.data,r=np.empty();let s=new Th(th.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),s=s.add(e)}return new Lf(e.key,r,new Eh(s.toArray()),Ef.none())}}function $f(e,t,n){e instanceof Ff?function(e,t,n){const r=e.value.clone(),s=zf(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Lf?function(e,t,n){if(!Af(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=zf(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(Pf(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Of(e,t,n,r){return e instanceof Ff?function(e,t,n,r){if(!Af(e.precondition,t))return n;const s=e.value.clone(),a=Bf(e.fieldTransforms,r,t);return s.setAll(a),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,r):e instanceof Lf?function(e,t,n,r){if(!Af(e.precondition,t))return n;const s=Bf(e.fieldTransforms,r,t),a=t.data;return a.setAll(Pf(e)),a.setAll(s),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Af(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Df(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),s=yf(r.transform,e||null);null!=s&&(null===n&&(n=np.empty()),n.set(r.field,s))}return n||null}function Mf(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Xd(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof bf&&t instanceof bf||e instanceof wf&&t instanceof wf?Xd(e.elements,t.elements,Uh):e instanceof Sf&&t instanceof Sf?Uh(e.gt,t.gt):e instanceof vf&&t instanceof vf}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ff extends Rf{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Lf extends Rf{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Pf(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function zf(e,t,n){const r=new Map;Od(e.length===n.length);for(let s=0;s<n.length;s++){const a=e[s],i=a.transform,o=t.data.field(a.field);r.set(a.field,gf(i,o,n[s]))}return r}function Bf(e,t,n){const r=new Map;for(const s of e){const e=s.transform,a=n.data.field(s.field);r.set(s.field,mf(e,a,t))}return r}class jf extends Rf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Uf extends Rf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Vf{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&$f(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Of(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Of(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=rf();return this.mutations.forEach((r=>{const s=e.get(r.key),a=s.overlayedDocument;let i=this.applyToLocalView(a,s.mutatedFields);i=t.has(r.key)?null:i;const o=_f(a,i);null!==o&&n.set(r.key,o),a.isValidDocument()||a.convertToNoDocument(Qd.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),lf())}isEqual(e){return this.batchId===e.batchId&&Xd(this.mutations,e.mutations,((e,t)=>Mf(e,t)))&&Xd(this.baseMutations,e.baseMutations,((e,t)=>Mf(e,t)))}}class Wf{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Od(e.mutations.length===n.length);let r=af;const s=e.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,n[a].version);return new Wf(e,t,n,r)}}class Gf{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Hf{constructor(e,t){this.count=e,this.unchangedNames=t}}var qf,Kf;function Xf(e){switch(e){default:return $d();case Md.CANCELLED:case Md.UNKNOWN:case Md.DEADLINE_EXCEEDED:case Md.RESOURCE_EXHAUSTED:case Md.INTERNAL:case Md.UNAVAILABLE:case Md.UNAUTHENTICATED:return!1;case Md.INVALID_ARGUMENT:case Md.NOT_FOUND:case Md.ALREADY_EXISTS:case Md.PERMISSION_DENIED:case Md.FAILED_PRECONDITION:case Md.ABORTED:case Md.OUT_OF_RANGE:case Md.UNIMPLEMENTED:case Md.DATA_LOSS:return!0}}function Yf(e){if(void 0===e)return Ad("GRPC error has no .code"),Md.UNKNOWN;switch(e){case qf.OK:return Md.OK;case qf.CANCELLED:return Md.CANCELLED;case qf.UNKNOWN:return Md.UNKNOWN;case qf.DEADLINE_EXCEEDED:return Md.DEADLINE_EXCEEDED;case qf.RESOURCE_EXHAUSTED:return Md.RESOURCE_EXHAUSTED;case qf.INTERNAL:return Md.INTERNAL;case qf.UNAVAILABLE:return Md.UNAVAILABLE;case qf.UNAUTHENTICATED:return Md.UNAUTHENTICATED;case qf.INVALID_ARGUMENT:return Md.INVALID_ARGUMENT;case qf.NOT_FOUND:return Md.NOT_FOUND;case qf.ALREADY_EXISTS:return Md.ALREADY_EXISTS;case qf.PERMISSION_DENIED:return Md.PERMISSION_DENIED;case qf.FAILED_PRECONDITION:return Md.FAILED_PRECONDITION;case qf.ABORTED:return Md.ABORTED;case qf.OUT_OF_RANGE:return Md.OUT_OF_RANGE;case qf.UNIMPLEMENTED:return Md.UNIMPLEMENTED;case qf.DATA_LOSS:return Md.DATA_LOSS;default:return $d()}}(Kf=qf||(qf={}))[Kf.OK=0]="OK",Kf[Kf.CANCELLED=1]="CANCELLED",Kf[Kf.UNKNOWN=2]="UNKNOWN",Kf[Kf.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kf[Kf.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kf[Kf.NOT_FOUND=5]="NOT_FOUND",Kf[Kf.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kf[Kf.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kf[Kf.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kf[Kf.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kf[Kf.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kf[Kf.ABORTED=10]="ABORTED",Kf[Kf.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kf[Kf.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kf[Kf.INTERNAL=13]="INTERNAL",Kf[Kf.UNAVAILABLE=14]="UNAVAILABLE",Kf[Kf.DATA_LOSS=15]="DATA_LOSS";class Qf{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Jf}static getOrCreateInstance(){return null===Jf&&(Jf=new Qf),Jf}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach((t=>t(e)))}}let Jf=null;function Zf(){return new TextEncoder}const em=new kd([4294967295,4294967295],0);function tm(e){const t=Zf().encode(e),n=new wd;return n.update(t),new Uint8Array(n.digest())}function nm(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new kd([n,r],0),new kd([s,a],0)]}class rm{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new sm(`Invalid padding: ${t}`);if(n<0)throw new sm(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new sm(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new sm(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=kd.fromNumber(this.It)}Et(e,t,n){let r=e.add(t.multiply(kd.fromNumber(n)));return 1===r.compare(em)&&(r=new kd([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=tm(e),[n,r]=nm(t);for(let s=0;s<this.hashCount;s++){const e=this.Et(n,r,s);if(!this.At(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new rm(s,r,t);return n.forEach((e=>a.insert(e))),a}insert(e){if(0===this.It)return;const t=tm(e),[n,r]=nm(t);for(let s=0;s<this.hashCount;s++){const e=this.Et(n,r,s);this.Rt(e)}}Rt(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class sm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class am{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,im.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new am(Qd.min(),r,new Sh(Kd),Jp(),lf())}}class im{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new im(n,t,lf(),lf(),lf())}}class om{constructor(e,t,n,r){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=r}}class lm{constructor(e,t){this.targetId=e,this.Vt=t}}class um{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Rh.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class cm{constructor(){this.St=0,this.Dt=pm(),this.Ct=Rh.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=lf(),t=lf(),n=lf();return this.Dt.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:$d()}})),new im(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=pm()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class dm{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Jp(),this.zt=hm(),this.Wt=new Sh(Kd)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,(t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:$d()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach(((e,n)=>{this.te(n)&&t(n)}))}ne(e){var t;const n=e.targetId,r=e.Vt.count,s=this.se(n);if(s){const a=s.target;if(_p(a))if(0===r){const e=new nh(a.path);this.Yt(n,e,sp.newNoDocument(e,Qd.min()))}else Od(1===r);else{const s=this.ie(n);if(s!==r){const r=this.re(e,s);if(0!==r){this.ee(n);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,e)}null===(t=Qf.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,s,a,i,o,l;const u={localCacheCount:t,existenceFilterCount:n.count},c=n.unchangedNames;return c&&(u.bloomFilter={applied:0===e,hashCount:null!==(r=null==c?void 0:c.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(i=null===(a=null===(s=null==c?void 0:c.bits)||void 0===s?void 0:s.bitmap)||void 0===a?void 0:a.length)&&void 0!==i?i:0,padding:null!==(l=null===(o=null==c?void 0:c.bits)||void 0===o?void 0:o.padding)&&void 0!==l?l:0}),u}(r,s,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:r}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:s="",padding:a=0},hashCount:i=0}=n;let o,l;try{o=Dh(s).toUint8Array()}catch(e){if(e instanceof Ah)return Rd("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{l=new rm(o,a,i)}catch(e){return Rd(e instanceof sm?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===l.It?1:r!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let r=0;return n.forEach((n=>{const s=this.Gt.ue(),a=`projects/${s.projectId}/databases/${s.database}/documents/${n.path.canonicalString()}`;t.vt(a)||(this.Yt(e,n,null),r++)})),r}ce(e){const t=new Map;this.Qt.forEach(((n,r)=>{const s=this.se(r);if(s){if(n.current&&_p(s.target)){const t=new nh(s.target.path);null!==this.jt.get(t)||this.ae(r,t)||this.Yt(r,t,sp.newNoDocument(t,e))}n.Mt&&(t.set(r,n.Ot()),n.Ft())}}));let n=lf();this.zt.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.se(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.jt.forEach(((t,n)=>n.setReadTime(e)));const r=new am(e,t,this.Wt,this.jt,n);return this.jt=Jp(),this.zt=hm(),this.Wt=new Sh(Kd),r}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new cm,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new Th(Kd),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Ed("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new cm),this.Gt.getRemoteKeysForTarget(e).forEach((t=>{this.Yt(e,t,null)}))}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function hm(){return new Sh(nh.comparator)}function pm(){return new Sh(nh.comparator)}const fm={asc:"ASCENDING",desc:"DESCENDING"},mm={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gm={and:"AND",or:"OR"};class ym{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vm(e,t){return e.useProto3Json||fh(t)?t:{value:t}}function bm(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function xm(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function wm(e,t){return bm(e,t.toTimestamp())}function km(e){return Od(!!e),Qd.fromTimestamp(function(e){const t=$h(e);return new Yd(t.seconds,t.nanos)}(e))}function Sm(e,t){return function(e){return new Zd(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Im(e){const t=Zd.fromString(e);return Od(Wm(t)),t}function Cm(e,t){return Sm(e.databaseId,t.path)}function Tm(e,t){const n=Im(t);if(n.get(1)!==e.databaseId.projectId)throw new Fd(Md.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Fd(Md.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new nh(Rm(n))}function Nm(e,t){return Sm(e.databaseId,t)}function Em(e){const t=Im(e);return 4===t.length?Zd.emptyPath():Rm(t)}function Am(e){return new Zd(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Rm(e){return Od(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function _m(e,t,n){return{name:Cm(e,t),fields:n.value.mapValue.fields}}function $m(e,t){let n;if(t instanceof Ff)n={update:_m(e,t.key,t.value)};else if(t instanceof jf)n={delete:Cm(e,t.key)};else if(t instanceof Lf)n={update:_m(e,t.key,t.data),updateMask:Vm(t.fieldMask)};else{if(!(t instanceof Uf))return $d();n={verify:Cm(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof vf)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof bf)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof wf)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Sf)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw $d()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:wm(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:$d()}(e,t.precondition)),n}function Om(e,t){return{documents:[Nm(e,t.path)]}}function Dm(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Nm(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Nm(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(e){if(0!==e.length)return Um(hp.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const a=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Bm(e.field),direction:Lm(e.dir)}}(e)))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const i=vm(e,t.limit);var o;return null!==i&&(n.structuredQuery.limit=i),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Mm(e){let t=Em(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Od(1===r);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){const t=Fm(e);return t instanceof hp&&fp(t)?t.getFilters():[t]}(n.where));let i=[];n.orderBy&&(i=n.orderBy.map((e=>function(e){return new lp(jm(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,fh(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new ap(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new ap(n,t)}(n.endAt)),Op(t,s,i,a,o,"F",l,u)}function Fm(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=jm(e.unaryFilter.field);return dp.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=jm(e.unaryFilter.field);return dp.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=jm(e.unaryFilter.field);return dp.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=jm(e.unaryFilter.field);return dp.create(s,"!=",{nullValue:"NULL_VALUE"});default:return $d()}}(e):void 0!==e.fieldFilter?function(e){return dp.create(jm(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $d()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return hp.create(e.compositeFilter.filters.map((e=>Fm(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return $d()}}(e.compositeFilter.op))}(e):$d()}function Lm(e){return fm[e]}function Pm(e){return mm[e]}function zm(e){return gm[e]}function Bm(e){return{fieldPath:e.canonicalString()}}function jm(e){return th.fromServerFormat(e.fieldPath)}function Um(e){return e instanceof dp?function(e){if("=="===e.op){if(Jh(e.value))return{unaryFilter:{field:Bm(e.field),op:"IS_NAN"}};if(Qh(e.value))return{unaryFilter:{field:Bm(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Jh(e.value))return{unaryFilter:{field:Bm(e.field),op:"IS_NOT_NAN"}};if(Qh(e.value))return{unaryFilter:{field:Bm(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bm(e.field),op:Pm(e.op),value:e.value}}}(e):e instanceof hp?function(e){const t=e.getFilters().map((e=>Um(e)));return 1===t.length?t[0]:{compositeFilter:{op:zm(e.op),filters:t}}}(e):$d()}function Vm(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Wm(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Gm{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Qd.min(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Qd.min(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Rh.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=i,this.expectedCount=o}withSequenceNumber(e){return new Gm(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Gm(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gm(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gm(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Hm{constructor(e){this.fe=e}}function qm(e){const t=Mm({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Up(t,t.limit,"L"):t}class Km{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Oh(e.integerValue));else if("doubleValue"in e){const n=Oh(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),mh(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(Dh(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?tp(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):$d()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const r of Object.keys(n))this.Te(r,t),this.me(n[r],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const r of n)this.me(r,t)}ve(e,t){this.ye(t,37),nh.fromName(e).path.forEach((e=>{this.ye(t,60),this.be(e,t)}))}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}Km.Ve=new Km;class Xm{constructor(){this.rn=new Ym}addToCollectionParentIndex(e,t){return this.rn.add(t),dh.resolve()}getCollectionParents(e,t){return dh.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return dh.resolve()}deleteFieldIndex(e,t){return dh.resolve()}getDocumentsMatchingTarget(e,t){return dh.resolve(null)}getIndexType(e,t){return dh.resolve(0)}getFieldIndexes(e,t){return dh.resolve([])}getNextCollectionGroupToUpdate(e){return dh.resolve(null)}getMinOffset(e,t){return dh.resolve(ih.min())}getMinOffsetFromCollectionGroup(e,t){return dh.resolve(ih.min())}updateCollectionGroup(e,t,n){return dh.resolve()}updateIndexEntries(e,t){return dh.resolve()}}class Ym{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Th(Zd.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Th(Zd.comparator)).toArray()}}new Uint8Array(0);class Qm{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Qm(e,Qm.DEFAULT_COLLECTION_PERCENTILE,Qm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Qm.DEFAULT_COLLECTION_PERCENTILE=10,Qm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qm.DEFAULT=new Qm(41943040,Qm.DEFAULT_COLLECTION_PERCENTILE,Qm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qm.DISABLED=new Qm(-1,0,0);class Jm{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Jm(0)}static Mn(){return new Jm(-1)}}class Zm{constructor(){this.changes=new Yp((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,sp.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?dh.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class eg{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class tg{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Of(n.mutation,e,Eh.empty(),Yd.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,lf()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lf();const r=nf();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=ef();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=nf();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,lf())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let s=Jp();const a=sf(),i=sf();return t.forEach(((e,t)=>{const i=n.get(t.key);r.has(t.key)&&(void 0===i||i.mutation instanceof Lf)?s=s.insert(t.key,t):void 0!==i?(a.set(t.key,i.mutation.getFieldMask()),Of(i.mutation,t,i.mutation.getFieldMask(),Yd.now())):a.set(t.key,Eh.empty())})),this.recalculateAndSaveOverlays(e,s).next((e=>(e.forEach(((e,t)=>a.set(e,t))),t.forEach(((e,t)=>{var n;return i.set(e,new eg(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),i)))}recalculateAndSaveOverlays(e,t){const n=sf();let r=new Sh(((e,t)=>e-t)),s=lf();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const s of e)s.keys().forEach((e=>{const a=t.get(e);if(null===a)return;let i=n.get(e)||Eh.empty();i=s.applyToLocalView(a,i),n.set(e,i);const o=(r.get(s.batchId)||lf()).add(e);r=r.insert(s.batchId,o)}))})).next((()=>{const a=[],i=r.getReverseIterator();for(;i.hasNext();){const r=i.getNext(),o=r.key,l=r.value,u=rf();l.forEach((e=>{if(!s.has(e)){const r=_f(t.get(e),n.get(e));null!==r&&u.set(e,r),s=s.add(e)}})),a.push(this.documentOverlayCache.saveOverlays(e,o,u))}return dh.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return nh.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Pp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((s=>{const a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):dh.resolve(nf());let i=-1,o=s;return a.next((t=>dh.forEach(t,((t,n)=>(i<n.largestBatchId&&(i=n.largestBatchId),s.get(t)?dh.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,s))).next((()=>this.computeViews(e,o,t,lf()))).next((e=>({batchId:i,changes:tf(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new nh(t)).next((e=>{let t=ef();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let s=ef();return this.indexManager.getCollectionParents(e,r).next((a=>dh.forEach(a,(a=>{const i=function(e,t){return new $p(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,i,n).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)))).next((e=>{r.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,sp.newInvalidDocument(r)))}));let n=ef();return e.forEach(((e,s)=>{const a=r.get(e);void 0!==a&&Of(a.mutation,s,Eh.empty(),Yd.now()),Hp(t,s)&&(n=n.insert(e,s))})),n}))}}class ng{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return dh.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:km(n.createTime)}),dh.resolve()}getNamedQuery(e,t){return dh.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:qm(e.bundledQuery),readTime:km(e.readTime)}}(t)),dh.resolve()}}class rg{constructor(){this.overlays=new Sh(nh.comparator),this.ls=new Map}getOverlay(e,t){return dh.resolve(this.overlays.get(t))}getOverlays(e,t){const n=nf();return dh.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.we(e,t,r)})),dh.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.ls.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.ls.delete(n)),dh.resolve()}getOverlaysForCollection(e,t,n){const r=nf(),s=t.length+1,a=new nh(t.child("")),i=this.overlays.getIteratorFrom(a);for(;i.hasNext();){const e=i.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===s&&e.largestBatchId>n&&r.set(e.getKey(),e)}return dh.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Sh(((e,t)=>e-t));const a=this.overlays.getIterator();for(;a.hasNext();){const e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=nf(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const i=nf(),o=s.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>i.set(e,t))),!(i.size()>=r)););return dh.resolve(i)}we(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Gf(t,n));let s=this.ls.get(t);void 0===s&&(s=lf(),this.ls.set(t,s)),this.ls.set(t,s.add(n.key))}}class sg{constructor(){this.fs=new Th(ag.ds),this.ws=new Th(ag._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new ag(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.ys(new ag(e,t))}ps(e,t){e.forEach((e=>this.removeReference(e,t)))}Is(e){const t=new nh(new Zd([])),n=new ag(t,e),r=new ag(t,e+1),s=[];return this.ws.forEachInRange([n,r],(e=>{this.ys(e),s.push(e.key)})),s}Ts(){this.fs.forEach((e=>this.ys(e)))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new nh(new Zd([])),n=new ag(t,e),r=new ag(t,e+1);let s=lf();return this.ws.forEachInRange([n,r],(e=>{s=s.add(e.key)})),s}containsKey(e){const t=new ag(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ag{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return nh.comparator(e.key,t.key)||Kd(e.As,t.As)}static _s(e,t){return Kd(e.As,t.As)||nh.comparator(e.key,t.key)}}class ig{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new Th(ag.ds)}checkEmpty(e){return dh.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Vf(s,t,n,r);this.mutationQueue.push(a);for(const i of r)this.Rs=this.Rs.add(new ag(i.key,s)),this.indexManager.addToCollectionParentIndex(e,i.key.path.popLast());return dh.resolve(a)}lookupMutationBatch(e,t){return dh.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.bs(n),s=r<0?0:r;return dh.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return dh.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return dh.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ag(t,0),r=new ag(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([n,r],(e=>{const t=this.Ps(e.As);s.push(t)})),dh.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Th(Kd);return t.forEach((e=>{const t=new ag(e,0),r=new ag(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,r],(e=>{n=n.add(e.As)}))})),dh.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;nh.isDocumentKey(s)||(s=s.child(""));const a=new ag(new nh(s),0);let i=new Th(Kd);return this.Rs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(i=i.add(e.As)),!0)}),a),dh.resolve(this.Vs(i))}Vs(e){const t=[];return e.forEach((e=>{const n=this.Ps(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Od(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return dh.forEach(t.mutations,(r=>{const s=new ag(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Rs=n}))}Cn(e){}containsKey(e,t){const n=new ag(t,0),r=this.Rs.firstAfterOrEqual(n);return dh.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,dh.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class og{constructor(e){this.Ds=e,this.docs=new Sh(nh.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,a=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return dh.resolve(n?n.document.mutableCopy():sp.newInvalidDocument(t))}getEntries(e,t){let n=Jp();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():sp.newInvalidDocument(e))})),dh.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=Jp();const a=t.path,i=new nh(a.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:e,value:{document:i}}=o.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||oh(ah(i),n)<=0||(r.has(i.key)||Hp(t,i))&&(s=s.insert(i.key,i.mutableCopy()))}return dh.resolve(s)}getAllFromCollectionGroup(e,t,n,r){$d()}Cs(e,t){return dh.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new lg(this)}getSize(e){return dh.resolve(this.size)}}class lg extends Zm{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.os.addEntry(e,r)):this.os.removeEntry(n)})),dh.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class ug{constructor(e){this.persistence=e,this.xs=new Yp((e=>Ap(e)),Rp),this.lastRemoteSnapshotVersion=Qd.min(),this.highestTargetId=0,this.Ns=0,this.ks=new sg,this.targetCount=0,this.Ms=Jm.kn()}forEachTarget(e,t){return this.xs.forEach(((e,n)=>t(n))),dh.resolve()}getLastRemoteSnapshotVersion(e){return dh.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return dh.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),dh.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),dh.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Jm(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,dh.resolve()}updateTargetData(e,t){return this.Fn(t),dh.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,dh.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.xs.forEach(((a,i)=>{i.sequenceNumber<=t&&null===n.get(i.targetId)&&(this.xs.delete(a),s.push(this.removeMatchingKeysForTargetId(e,i.targetId)),r++)})),dh.waitFor(s).next((()=>r))}getTargetCount(e){return dh.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return dh.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),dh.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((t=>{s.push(r.markPotentiallyOrphaned(e,t))})),dh.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),dh.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return dh.resolve(n)}containsKey(e,t){return dh.resolve(this.ks.containsKey(t))}}class cg{constructor(e,t){this.$s={},this.overlays={},this.Os=new ph(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new ug(this),this.indexManager=new Xm,this.remoteDocumentCache=function(e){return new og(e)}((e=>this.referenceDelegate.Ls(e))),this.serializer=new Hm(t),this.qs=new ng(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new rg,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new ig(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){Ed("MemoryPersistence","Starting transaction:",e);const r=new dg(this.Os.next());return this.referenceDelegate.Us(),n(r).next((e=>this.referenceDelegate.Ks(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Gs(e,t){return dh.or(Object.values(this.$s).map((n=>()=>n.containsKey(e,t))))}}class dg extends uh{constructor(e){super(),this.currentSequenceNumber=e}}class hg{constructor(e){this.persistence=e,this.Qs=new sg,this.js=null}static zs(e){return new hg(e)}get Ws(){if(this.js)return this.js;throw $d()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),dh.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),dh.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),dh.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach((e=>this.Ws.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Ws.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return dh.forEach(this.Ws,(n=>{const r=nh.fromPath(n);return this.Hs(e,r).next((e=>{e||t.removeEntry(r,Qd.min())}))})).next((()=>(this.js=null,t.apply(e))))}updateLimboDocument(e,t){return this.Hs(e,t).next((e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())}))}Ls(e){return 0}Hs(e,t){return dh.or([()=>dh.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class pg{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=r}static Li(e,t){let n=lf(),r=lf();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new pg(e,t.fromCache,n,r)}}class fg{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ki(e,t).next((s=>s||this.Gi(e,t,r,n))).next((n=>n||this.Qi(e,t)))}Ki(e,t){if(Mp(t))return dh.resolve(null);let n=Bp(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Up(t,null,"F"),n=Bp(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const s=lf(...r);return this.Ui.getDocuments(e,s).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const a=this.ji(t,r);return this.zi(t,a,s,n.readTime)?this.Ki(e,Up(t,null,"F")):this.Wi(e,a,t,n)}))))})))))}Gi(e,t,n,r){return Mp(t)||r.isEqual(Qd.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next((s=>{const a=this.ji(t,s);return this.zi(t,a,n,r)?this.Qi(e,t):(Nd()<=En.DEBUG&&Ed("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Gp(t)),this.Wi(e,a,t,sh(r,-1)))}))}ji(e,t){let n=new Th(Kp(e));return t.forEach(((t,r)=>{Hp(e,r)&&(n=n.add(r))})),n}zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Qi(e,t){return Nd()<=En.DEBUG&&Ed("QueryEngine","Using full collection scan to execute query:",Gp(t)),this.Ui.getDocumentsMatchingQuery(e,t,ih.min())}Wi(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class mg{constructor(e,t,n,r){this.persistence=e,this.Hi=t,this.serializer=r,this.Ji=new Sh(Kd),this.Yi=new Yp((e=>Ap(e)),Rp),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tg(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ji)))}}function gg(e,t,n,r){return new mg(e,t,n,r)}async function yg(e,t){const n=Dd(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((s=>(r=s,n.tr(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const s=[],a=[];let i=lf();for(const e of r){s.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}for(const e of t){a.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}return n.localDocuments.getDocuments(e,i).next((e=>({er:e,removedBatchIds:s,addedBatchIds:a})))}))}))}function vg(e){const t=Dd(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Bs.getLastRemoteSnapshotVersion(e)))}function bg(e,t,n){let r=lf(),s=lf();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Jp();return n.forEach(((n,a)=>{const i=e.get(n);a.isFoundDocument()!==i.isFoundDocument()&&(s=s.add(n)),a.isNoDocument()&&a.version.isEqual(Qd.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!i.isValidDocument()||a.version.compareTo(i.version)>0||0===a.version.compareTo(i.version)&&i.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Ed("LocalStore","Ignoring outdated watch update for ",n,". Current version:",i.version," Watch version:",a.version)})),{nr:r,sr:s}}))}function xg(e,t){const n=Dd(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function wg(e,t){const n=Dd(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Bs.getTargetData(e,t).next((s=>s?(r=s,dh.resolve(r)):n.Bs.allocateTargetId(e).next((s=>(r=new Gm(t,s,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ji.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e}))}async function kg(e,t,n){const r=Dd(e),s=r.Ji.get(t),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,(e=>r.persistence.referenceDelegate.removeTarget(e,s)))}catch(e){if(!hh(e))throw e;Ed("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ji=r.Ji.remove(t),r.Yi.delete(s.target)}function Sg(e,t,n){const r=Dd(e);let s=Qd.min(),a=lf();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=Dd(e),s=r.Yi.get(n);return void 0!==s?dh.resolve(r.Ji.get(s)):r.Bs.getTargetData(t,n)}(r,e,Bp(t)).next((t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(e,t.targetId).next((e=>{a=e}))})).next((()=>r.Hi.getDocumentsMatchingQuery(e,t,n?s:Qd.min(),n?a:lf()))).next((e=>(Ig(r,qp(t),e),{documents:e,ir:a})))))}function Ig(e,t,n){let r=e.Xi.get(t)||Qd.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Xi.set(t,r)}class Cg{constructor(){this.activeTargetIds=cf()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Tg{constructor(){this.Hr=new Cg,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Cg,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ng{Yr(e){}shutdown(){}}class Eg{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Ed("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Ed("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ag=null;function Rg(){return null===Ag?Ag=268435456+Math.round(2147483648*Math.random()):Ag++,"0x"+Ag.toString(16)}const _g={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class $g{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const Og="WebChannelConnection";class Dg extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,r,s){const a=Rg(),i=this.To(e,t);Ed("RestConnection",`Sending RPC '${e}' ${a}:`,i,n);const o={};return this.Eo(o,r,s),this.Ao(e,i,o,n).then((t=>(Ed("RestConnection",`Received RPC '${e}' ${a}: `,t),t)),(t=>{throw Rd("RestConnection",`RPC '${e}' ${a} failed with error: `,t,"url: ",i,"request:",n),t}))}vo(e,t,n,r,s,a){return this.Io(e,t,n,r,s)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Cd,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}To(e,t){const n=_g[e];return`${this.mo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,r){const s=Rg();return new Promise(((a,i)=>{const o=new xd;o.setWithCredentials(!0),o.listenOnce(md.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case fd.NO_ERROR:const t=o.getResponseJson();Ed(Og,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),a(t);break;case fd.TIMEOUT:Ed(Og,`RPC '${e}' ${s} timed out`),i(new Fd(Md.DEADLINE_EXCEEDED,"Request time out"));break;case fd.HTTP_ERROR:const n=o.getStatus();if(Ed(Og,`RPC '${e}' ${s} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Md).indexOf(t)>=0?t:Md.UNKNOWN}(t.status);i(new Fd(e,t.message))}else i(new Fd(Md.UNKNOWN,"Server responded with status "+o.getStatus()))}else i(new Fd(Md.UNAVAILABLE,"Connection failed."));break;default:$d()}}finally{Ed(Og,`RPC '${e}' ${s} completed.`)}}));const l=JSON.stringify(r);Ed(Og,`RPC '${e}' ${s} sending request:`,r),o.send(t,"POST",l,n,15)}))}Ro(e,t,n){const r=Rg(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=hd(),i=pd(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.xmlHttpFactory=new vd({})),this.Eo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const u=s.join("");Ed(Og,`Creating RPC '${e}' stream ${r}: ${u}`,o);const c=a.createWebChannel(u,o);let d=!1,h=!1;const p=new $g({ro:t=>{h?Ed(Og,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(Ed(Og,`Opening RPC '${e}' stream ${r} transport.`),c.open(),d=!0),Ed(Og,`RPC '${e}' stream ${r} sending:`,t),c.send(t))},oo:()=>c.close()}),f=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return f(c,bd.EventType.OPEN,(()=>{h||Ed(Og,`RPC '${e}' stream ${r} transport opened.`)})),f(c,bd.EventType.CLOSE,(()=>{h||(h=!0,Ed(Og,`RPC '${e}' stream ${r} transport closed`),p.wo())})),f(c,bd.EventType.ERROR,(t=>{h||(h=!0,Rd(Og,`RPC '${e}' stream ${r} transport errored:`,t),p.wo(new Fd(Md.UNAVAILABLE,"The operation could not be completed")))})),f(c,bd.EventType.MESSAGE,(t=>{var n;if(!h){const s=t.data[0];Od(!!s);const a=s,i=a.error||(null===(n=a[0])||void 0===n?void 0:n.error);if(i){Ed(Og,`RPC '${e}' stream ${r} received error:`,i);const t=i.status;let n=function(e){const t=qf[e];if(void 0!==t)return Yf(t)}(t),s=i.message;void 0===n&&(n=Md.INTERNAL,s="Unknown error status: "+t+" with message "+i.message),h=!0,p.wo(new Fd(n,s)),c.close()}else Ed(Og,`RPC '${e}' stream ${r} received:`,s),p._o(s)}})),f(i,gd.STAT_EVENT,(t=>{t.stat===yd.PROXY?Ed(Og,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===yd.NOPROXY&&Ed(Og,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.fo()}),0),p}}function Mg(){return"undefined"!=typeof document?document:null}function Fg(e){return new ym(e,!0)}class Lg{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ii=e,this.timerId=t,this.Po=n,this.bo=r,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),r=Math.max(0,t-n);r>0&&Ed("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,(()=>(this.Co=Date.now(),e()))),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class Pg{constructor(e,t,n,r,s,a,i,o){this.ii=e,this.$o=n,this.Oo=r,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=i,this.listener=o,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Lg(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(()=>this.zo())))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===Md.RESOURCE_EXHAUSTED?(Ad(t.toString()),Ad("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===Md.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.Fo===t&&this.Zo(n,r)}),(t=>{e((()=>{const e=new Fd(Md.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)}))}))}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo((()=>{n((()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,(()=>(this.Ko()&&(this.state=3),Promise.resolve()))),this.listener.uo())))})),this.stream.ao((e=>{n((()=>this.tu(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Go(){this.state=5,this.qo.No((async()=>{this.state=0,this.start()}))}tu(e){return Ed("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget((()=>this.Fo===e?t():(Ed("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class zg extends Pg{constructor(e,t,n,r,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,a),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:$d()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(Od(void 0===t||"string"==typeof t),Rh.fromBase64String(t||"")):(Od(void 0===t||t instanceof Uint8Array),Rh.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(e){const t=void 0===e.code?Md.UNKNOWN:Yf(e.code);return new Fd(t,e.message||"")}(i);n=new um(r,s,a,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=Tm(e,r.document.name),a=km(r.document.updateTime),i=r.document.createTime?km(r.document.createTime):Qd.min(),o=new np({mapValue:{fields:r.document.fields}}),l=sp.newFoundDocument(s,a,i,o),u=r.targetIds||[],c=r.removedTargetIds||[];n=new om(u,c,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=Tm(e,r.document),a=r.readTime?km(r.readTime):Qd.min(),i=sp.newNoDocument(s,a),o=r.removedTargetIds||[];n=new om([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=Tm(e,r.document),a=r.removedTargetIds||[];n=new om([],a,s,null)}else{if(!("filter"in t))return $d();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:s}=e,a=new Hf(r,s),i=e.targetId;n=new lm(i,a)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Qd.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Qd.min():t.readTime?km(t.readTime):Qd.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=Am(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=_p(r)?{documents:Om(e,r)}:{query:Dm(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=xm(e,t.resumeToken);const r=vm(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Qd.min())>0){n.readTime=bm(e,t.snapshotVersion.toTimestamp());const r=vm(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $d()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=Am(this.serializer),t.removeTarget=e,this.Wo(t)}}class Bg extends Pg{constructor(e,t,n,r,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,a),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(Od(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function(e,t){return e&&e.length>0?(Od(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?km(e.updateTime):km(t);return n.isEqual(Qd.min())&&(n=km(t)),new Nf(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=km(e.commitTime);return this.listener.cu(n,t)}return Od(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Am(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>$m(this.serializer,e)))};this.Wo(t)}}class jg extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new Fd(Md.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((r=>{let[s,a]=r;return this.connection.Io(e,t,n,s,a)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Md.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Fd(Md.UNKNOWN,e.toString())}))}vo(e,t,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[a,i]=s;return this.connection.vo(e,t,n,a,i,r)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Md.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Fd(Md.UNKNOWN,e.toString())}))}terminate(){this.lu=!0}}class Ug{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve()))))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Ad(t),this.mu=!1):Ed("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class Vg{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr((e=>{n.enqueueAndForget((async()=>{Jg(this)&&(Ed("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Dd(e);t.vu.add(4),await Gg(t),t.bu.set("Unknown"),t.vu.delete(4),await Wg(t)}(this))}))})),this.bu=new Ug(n,r)}}async function Wg(e){if(Jg(e))for(const t of e.Ru)await t(!0)}async function Gg(e){for(const t of e.Ru)await t(!1)}function Hg(e,t){const n=Dd(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),Qg(n)?Yg(n):gy(n).Ko()&&Kg(n,t))}function qg(e,t){const n=Dd(e),r=gy(n);n.Au.delete(t),r.Ko()&&Xg(n,t),0===n.Au.size&&(r.Ko()?r.jo():Jg(n)&&n.bu.set("Unknown"))}function Kg(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Qd.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}gy(e).su(t)}function Xg(e,t){e.Vu.qt(t),gy(e).iu(t)}function Yg(e){e.Vu=new dm({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),le:t=>e.Au.get(t)||null,ue:()=>e.datastore.serializer.databaseId}),gy(e).start(),e.bu.gu()}function Qg(e){return Jg(e)&&!gy(e).Uo()&&e.Au.size>0}function Jg(e){return 0===Dd(e).vu.size}function Zg(e){e.Vu=void 0}async function ey(e){e.Au.forEach(((t,n)=>{Kg(e,t)}))}async function ty(e,t){Zg(e),Qg(e)?(e.bu.Iu(t),Yg(e)):e.bu.set("Unknown")}async function ny(e,t,n){if(e.bu.set("Online"),t instanceof um&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Au.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Au.delete(r),e.Vu.removeTarget(r))}(e,t)}catch(n){Ed("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await ry(e,n)}else if(t instanceof om?e.Vu.Ht(t):t instanceof lm?e.Vu.ne(t):e.Vu.Xt(t),!n.isEqual(Qd.min()))try{const t=await vg(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Vu.ce(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.Au.get(r);s&&e.Au.set(r,s.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.Au.get(t);if(!r)return;e.Au.set(t,r.withResumeToken(Rh.EMPTY_BYTE_STRING,r.snapshotVersion)),Xg(e,t);const s=new Gm(r.target,t,n,r.sequenceNumber);Kg(e,s)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Ed("RemoteStore","Failed to raise snapshot:",t),await ry(e,t)}}async function ry(e,t,n){if(!hh(t))throw t;e.vu.add(1),await Gg(e),e.bu.set("Offline"),n||(n=()=>vg(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Ed("RemoteStore","Retrying IndexedDB access"),await n(),e.vu.delete(1),await Wg(e)}))}function sy(e,t){return t().catch((n=>ry(e,n,t)))}async function ay(e){const t=Dd(e),n=yy(t);let r=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;iy(t);)try{const e=await xg(t.localStore,r);if(null===e){0===t.Eu.length&&n.jo();break}r=e.batchId,oy(t,e)}catch(e){await ry(t,e)}ly(t)&&uy(t)}function iy(e){return Jg(e)&&e.Eu.length<10}function oy(e,t){e.Eu.push(t);const n=yy(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function ly(e){return Jg(e)&&!yy(e).Uo()&&e.Eu.length>0}function uy(e){yy(e).start()}async function cy(e){yy(e).hu()}async function dy(e){const t=yy(e);for(const n of e.Eu)t.uu(n.mutations)}async function hy(e,t,n){const r=e.Eu.shift(),s=Wf.from(r,t,n);await sy(e,(()=>e.remoteSyncer.applySuccessfulWrite(s))),await ay(e)}async function py(e,t){t&&yy(e).ou&&await async function(e,t){if(Xf(n=t.code)&&n!==Md.ABORTED){const n=e.Eu.shift();yy(e).Qo(),await sy(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await ay(e)}var n}(e,t),ly(e)&&uy(e)}async function fy(e,t){const n=Dd(e);n.asyncQueue.verifyOperationInProgress(),Ed("RemoteStore","RemoteStore received new credentials");const r=Jg(n);n.vu.add(3),await Gg(n),r&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),await Wg(n)}async function my(e,t){const n=Dd(e);t?(n.vu.delete(2),await Wg(n)):t||(n.vu.add(2),await Gg(n),n.bu.set("Unknown"))}function gy(e){return e.Su||(e.Su=function(e,t,n){const r=Dd(e);return r.fu(),new zg(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:ey.bind(null,e),ao:ty.bind(null,e),nu:ny.bind(null,e)}),e.Ru.push((async t=>{t?(e.Su.Qo(),Qg(e)?Yg(e):e.bu.set("Unknown")):(await e.Su.stop(),Zg(e))}))),e.Su}function yy(e){return e.Du||(e.Du=function(e,t,n){const r=Dd(e);return r.fu(),new Bg(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:cy.bind(null,e),ao:py.bind(null,e),au:dy.bind(null,e),cu:hy.bind(null,e)}),e.Ru.push((async t=>{t?(e.Du.Qo(),await ay(e)):(await e.Du.stop(),e.Eu.length>0&&(Ed("RemoteStore",`Stopping write stream with ${e.Eu.length} pending writes`),e.Eu=[]))}))),e.Du}class vy{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new Ld,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,r,s){const a=Date.now()+n,i=new vy(e,t,a,r,s);return i.start(n),i}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Fd(Md.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function by(e,t){if(Ad("AsyncQueue",`${t}: ${e}`),hh(e))return new Fd(Md.UNAVAILABLE,`${t}: ${e}`);throw e}class xy{constructor(e){this.comparator=e?(t,n)=>e(t,n)||nh.comparator(t.key,n.key):(e,t)=>nh.comparator(e.key,t.key),this.keyedMap=ef(),this.sortedSet=new Sh(this.comparator)}static emptySet(e){return new xy(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof xy))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new xy;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class wy{constructor(){this.Cu=new Sh(nh.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):$d():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal(((t,n)=>{e.push(n)})),e}}class ky{constructor(e,t,n,r,s,a,i,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=i,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,s){const a=[];return t.forEach((e=>{a.push({type:0,doc:e})})),new ky(e,t,xy.emptySet(t),a,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Vp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Sy{constructor(){this.Nu=void 0,this.listeners=[]}}class Iy{constructor(){this.queries=new Yp((e=>Wp(e)),Vp),this.onlineState="Unknown",this.ku=new Set}}async function Cy(e,t){const n=Dd(e),r=t.query;let s=!1,a=n.queries.get(r);if(a||(s=!0,a=new Sy),s)try{a.Nu=await n.onListen(r)}catch(e){const n=by(e,`Initialization of query '${Gp(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,a),a.listeners.push(t),t.Mu(n.onlineState),a.Nu&&t.$u(a.Nu)&&Ay(n)}async function Ty(e,t){const n=Dd(e),r=t.query;let s=!1;const a=n.queries.get(r);if(a){const e=a.listeners.indexOf(t);e>=0&&(a.listeners.splice(e,1),s=0===a.listeners.length)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function Ny(e,t){const n=Dd(e);let r=!1;for(const s of t){const e=s.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.$u(s)&&(r=!0);t.Nu=s}}r&&Ay(n)}function Ey(e,t,n){const r=Dd(e),s=r.queries.get(t);if(s)for(const a of s.listeners)a.onError(n);r.queries.delete(t)}function Ay(e){e.ku.forEach((e=>{e.next()}))}class Ry{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new ky(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Uu(e){e=ky.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class _y{constructor(e){this.key=e}}class $y{constructor(e){this.key=e}}class Oy{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=lf(),this.mutatedKeys=lf(),this.tc=Kp(e),this.ec=new xy(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new wy,r=t?t.ec:this.ec;let s=t?t.mutatedKeys:this.mutatedKeys,a=r,i=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),c=Hp(this.query,t)?t:null,d=!!u&&this.mutatedKeys.has(u.key),h=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let p=!1;u&&c?u.data.isEqual(c.data)?d!==h&&(n.track({type:3,doc:c}),p=!0):this.rc(u,c)||(n.track({type:2,doc:c}),p=!0,(o&&this.tc(c,o)>0||l&&this.tc(c,l)<0)&&(i=!0)):!u&&c?(n.track({type:0,doc:c}),p=!0):u&&!c&&(n.track({type:1,doc:u}),p=!0,(o||l)&&(i=!0)),p&&(c?(a=a.add(c),s=h?s.add(e):s.delete(e)):(a=a.delete(e),s=s.delete(e)))})),null!==this.query.limit)for(;a.size>this.query.limit;){const e="F"===this.query.limitType?a.last():a.first();a=a.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{ec:a,ic:n,zi:i,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $d()}};return n(e)-n(t)}(e.type,t.type)||this.tc(e.doc,t.doc))),this.oc(n);const a=t?this.uc():[],i=0===this.Zu.size&&this.current?1:0,o=i!==this.Xu;return this.Xu=i,0!==s.length||o?{snapshot:new ky(this.query,e.ec,r,s,e.mutatedKeys,0===i,o,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:a}:{cc:a}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new wy,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach((e=>this.Yu=this.Yu.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Yu=this.Yu.delete(e))),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=lf(),this.ec.forEach((e=>{this.ac(e.key)&&(this.Zu=this.Zu.add(e.key))}));const t=[];return e.forEach((e=>{this.Zu.has(e)||t.push(new $y(e))})),this.Zu.forEach((n=>{e.has(n)||t.push(new _y(n))})),t}hc(e){this.Yu=e.ir,this.Zu=lf();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return ky.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class Dy{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class My{constructor(e){this.key=e,this.fc=!1}}class Fy{constructor(e,t,n,r,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.dc={},this.wc=new Yp((e=>Wp(e)),Vp),this._c=new Map,this.mc=new Set,this.gc=new Sh(nh.comparator),this.yc=new Map,this.Ic=new sg,this.Tc={},this.Ec=new Map,this.Ac=Jm.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function Ly(e,t){const n=tv(e);let r,s;const a=n.wc.get(t);if(a)r=a.targetId,n.sharedClientState.addLocalQueryTarget(r),s=a.view.lc();else{const e=await wg(n.localStore,Bp(t)),a=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,s=await Py(n,t,r,"current"===a,e.resumeToken),n.isPrimaryClient&&Hg(n.remoteStore,e)}return s}async function Py(e,t,n,r,s){e.Rc=(t,n,r)=>async function(e,t,n,r){let s=t.view.sc(n);s.zi&&(s=await Sg(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.sc(n,s)})));const a=r&&r.targetChanges.get(t.targetId),i=t.view.applyChanges(s,e.isPrimaryClient,a);return Xy(e,t.targetId,i.cc),i.snapshot}(e,t,n,r);const a=await Sg(e.localStore,t,!0),i=new Oy(t,a.ir),o=i.sc(a.documents),l=im.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,s),u=i.applyChanges(o,e.isPrimaryClient,l);Xy(e,n,u.cc);const c=new Dy(t,n,i);return e.wc.set(t,c),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),u.snapshot}async function zy(e,t){const n=Dd(e),r=n.wc.get(t),s=n._c.get(r.targetId);if(s.length>1)return n._c.set(r.targetId,s.filter((e=>!Vp(e,t)))),void n.wc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await kg(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),qg(n.remoteStore,r.targetId),qy(n,r.targetId)})).catch(ch)):(qy(n,r.targetId),await kg(n.localStore,r.targetId,!0))}async function By(e,t){const n=Dd(e);try{const e=await function(e,t){const n=Dd(e),r=t.snapshotVersion;let s=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const a=n.Zi.newChangeBuffer({trackRemovals:!0});s=n.Ji;const i=[];t.targetChanges.forEach(((a,o)=>{const l=s.get(o);if(!l)return;i.push(n.Bs.removeMatchingKeys(e,a.removedDocuments,o).next((()=>n.Bs.addMatchingKeys(e,a.addedDocuments,o))));let u=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?u=u.withResumeToken(Rh.EMPTY_BYTE_STRING,Qd.min()).withLastLimboFreeSnapshotVersion(Qd.min()):a.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(a.resumeToken,r)),s=s.insert(o,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,u,a)&&i.push(n.Bs.updateTargetData(e,u))}));let o=Jp(),l=lf();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&i.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),i.push(bg(e,a,t.documentUpdates).next((e=>{o=e.nr,l=e.sr}))),!r.isEqual(Qd.min())){const t=n.Bs.getLastRemoteSnapshotVersion(e).next((t=>n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,r)));i.push(t)}return dh.waitFor(i).next((()=>a.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(n.Ji=s,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.yc.get(t);r&&(Od(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.fc=!0:e.modifiedDocuments.size>0?Od(r.fc):e.removedDocuments.size>0&&(Od(r.fc),r.fc=!1))})),await Jy(n,e,t)}catch(e){await ch(e)}}function jy(e,t,n){const r=Dd(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.wc.forEach(((n,r)=>{const s=r.view.Mu(t);s.snapshot&&e.push(s.snapshot)})),function(e,t){const n=Dd(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const s of n.listeners)s.Mu(t)&&(r=!0)})),r&&Ay(n)}(r.eventManager,t),e.length&&r.dc.nu(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Uy(e,t,n){const r=Dd(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.yc.get(t),a=s&&s.key;if(a){let e=new Sh(nh.comparator);e=e.insert(a,sp.newNoDocument(a,Qd.min()));const n=lf().add(a),s=new am(Qd.min(),new Map,new Sh(Kd),e,n);await By(r,s),r.gc=r.gc.remove(a),r.yc.delete(t),Qy(r)}else await kg(r.localStore,t,!1).then((()=>qy(r,t,n))).catch(ch)}async function Vy(e,t){const n=Dd(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Dd(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),s=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const s=n.batch,a=s.keys();let i=dh.resolve();return a.forEach((e=>{i=i.next((()=>r.getEntry(t,e))).next((t=>{const a=n.docVersions.get(e);Od(null!==a),t.version.compareTo(a)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),i.next((()=>e.mutationQueue.removeMutationBatch(t,s)))}(n,e,t,s).next((()=>s.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=lf();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Hy(n,r,null),Gy(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Jy(n,e)}catch(e){await ch(e)}}async function Wy(e,t,n){const r=Dd(e);try{const e=await function(e,t){const n=Dd(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Od(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Hy(r,t,n),Gy(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Jy(r,e)}catch(n){await ch(n)}}function Gy(e,t){(e.Ec.get(t)||[]).forEach((e=>{e.resolve()})),e.Ec.delete(t)}function Hy(e,t,n){const r=Dd(e);let s=r.Tc[r.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),r.Tc[r.currentUser.toKey()]=s}}function qy(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e._c.get(t))e.wc.delete(r),n&&e.dc.Pc(r,n);e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach((t=>{e.Ic.containsKey(t)||Ky(e,t)}))}function Ky(e,t){e.mc.delete(t.path.canonicalString());const n=e.gc.get(t);null!==n&&(qg(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),Qy(e))}function Xy(e,t,n){for(const r of n)r instanceof _y?(e.Ic.addReference(r.key,t),Yy(e,r)):r instanceof $y?(Ed("SyncEngine","Document no longer in limbo: "+r.key),e.Ic.removeReference(r.key,t),e.Ic.containsKey(r.key)||Ky(e,r.key)):$d()}function Yy(e,t){const n=t.key,r=n.path.canonicalString();e.gc.get(n)||e.mc.has(r)||(Ed("SyncEngine","New document in limbo: "+n),e.mc.add(r),Qy(e))}function Qy(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){const t=e.mc.values().next().value;e.mc.delete(t);const n=new nh(Zd.fromString(t)),r=e.Ac.next();e.yc.set(r,new My(n)),e.gc=e.gc.insert(n,r),Hg(e.remoteStore,new Gm(Bp(Dp(n.path)),r,"TargetPurposeLimboResolution",ph.ct))}}async function Jy(e,t,n){const r=Dd(e),s=[],a=[],i=[];r.wc.isEmpty()||(r.wc.forEach(((e,o)=>{i.push(r.Rc(o,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(o.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){s.push(e);const t=pg.Li(o.targetId,e);a.push(t)}})))})),await Promise.all(i),r.dc.nu(s),await async function(e,t){const n=Dd(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>dh.forEach(t,(t=>dh.forEach(t.Fi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>dh.forEach(t.Bi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!hh(e))throw e;Ed("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ji.get(e),r=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(r);n.Ji=n.Ji.insert(e,s)}}}(r.localStore,a))}async function Zy(e,t){const n=Dd(e);if(!n.currentUser.isEqual(t)){Ed("SyncEngine","User change. New user:",t.toKey());const e=await yg(n.localStore,t);n.currentUser=t,function(e){e.Ec.forEach((e=>{e.forEach((e=>{e.reject(new Fd(Md.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ec.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Jy(n,e.er)}}function ev(e,t){const n=Dd(e),r=n.yc.get(t);if(r&&r.fc)return lf().add(r.key);{let e=lf();const r=n._c.get(t);if(!r)return e;for(const t of r){const r=n.wc.get(t);e=e.unionWith(r.view.nc)}return e}}function tv(e){const t=Dd(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=By.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ev.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Uy.bind(null,t),t.dc.nu=Ny.bind(null,t.eventManager),t.dc.Pc=Ey.bind(null,t.eventManager),t}function nv(e){const t=Dd(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Vy.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Wy.bind(null,t),t}class rv{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Fg(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return gg(this.persistence,new fg,e.initialUser,this.serializer)}createPersistence(e){return new cg(hg.zs,this.serializer)}createSharedClientState(e){return new Tg}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class sv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>jy(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Zy.bind(null,this.syncEngine),await my(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Iy}createDatastore(e){const t=Fg(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new Dg(r));var r;return function(e,t,n,r){return new jg(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,s=e=>jy(this.syncEngine,e,0),a=Eg.D()?new Eg:new Ng,new Vg(t,n,r,s,a);var t,n,r,s,a}createSyncEngine(e,t){return function(e,t,n,r,s,a,i){const o=new Fy(e,t,n,r,s,a);return i&&(o.vc=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Dd(e);Ed("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await Gg(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}class av{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Ad("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class iv{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Id.UNAUTHENTICATED,this.clientId=qd.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{Ed("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Ed("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Fd(Md.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ld;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=by(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function ov(e,t){e.asyncQueue.verifyOperationInProgress(),Ed("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await yg(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function lv(e,t){e.asyncQueue.verifyOperationInProgress();const n=await cv(e);Ed("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>fy(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>fy(t.remoteStore,n))),e._onlineComponents=t}function uv(e){return"FirebaseError"===e.name?e.code===Md.FAILED_PRECONDITION||e.code===Md.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function cv(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ed("FirestoreClient","Using user provided OfflineComponentProvider");try{await ov(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!uv(n))throw n;Rd("Error using user provided cache. Falling back to memory cache: "+n),await ov(e,new rv)}}else Ed("FirestoreClient","Using default OfflineComponentProvider"),await ov(e,new rv);return e._offlineComponents}async function dv(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ed("FirestoreClient","Using user provided OnlineComponentProvider"),await lv(e,e._uninitializedComponentsProvider._online)):(Ed("FirestoreClient","Using default OnlineComponentProvider"),await lv(e,new sv))),e._onlineComponents}function hv(e){return dv(e).then((e=>e.syncEngine))}async function pv(e){const t=await dv(e),n=t.eventManager;return n.onListen=Ly.bind(null,t.syncEngine),n.onUnlisten=zy.bind(null,t.syncEngine),n}function fv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Ld;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,s){const a=new av({next:a=>{t.enqueueAndForget((()=>Ty(e,i)));const o=a.docs.has(n);!o&&a.fromCache?s.reject(new Fd(Md.UNAVAILABLE,"Failed to get document because the client is offline.")):o&&a.fromCache&&r&&"server"===r.source?s.reject(new Fd(Md.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(a)},error:e=>s.reject(e)}),i=new Ry(Dp(n.path),a,{includeMetadataChanges:!0,Ku:!0});return Cy(e,i)}(await pv(e),e.asyncQueue,t,n,r))),r.promise}function mv(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const gv=new Map;function yv(e,t,n){if(!n)throw new Fd(Md.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function vv(e){if(!nh.isDocumentKey(e))throw new Fd(Md.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function bv(e){if(nh.isDocumentKey(e))throw new Fd(Md.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function xv(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":$d()}function wv(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Fd(Md.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=xv(e);throw new Fd(Md.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function kv(e,t){if(t<=0)throw new Fd(Md.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class Sv{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Fd(Md.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Fd(Md.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Fd(Md.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mv(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Fd(Md.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Fd(Md.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Fd(Md.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class Iv{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sv({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Fd(Md.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Fd(Md.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sv(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new zd;switch(e.type){case"firstParty":return new Vd(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Fd(Md.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=gv.get(e);t&&(Ed("ComponentProvider","Removing Datastore"),gv.delete(e),t.terminate())}(this),Promise.resolve()}}class Cv{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nv(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Cv(this.firestore,e,this._key)}}class Tv{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Tv(this.firestore,e,this._query)}}class Nv extends Tv{constructor(e,t,n){super(e,t,Dp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Cv(this.firestore,null,new nh(e))}withConverter(e){return new Nv(this.firestore,e,this._path)}}function Ev(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(e=kn(e),yv("collection","path",t),e instanceof Iv){const n=Zd.fromString(t,...r);return bv(n),new Nv(e,null,n)}{if(!(e instanceof Cv||e instanceof Nv))throw new Fd(Md.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Zd.fromString(t,...r));return bv(n),new Nv(e.firestore,null,n)}}function Av(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(e=kn(e),1===arguments.length&&(t=qd.A()),yv("doc","path",t),e instanceof Iv){const n=Zd.fromString(t,...r);return vv(n),new Cv(e,null,new nh(n))}{if(!(e instanceof Cv||e instanceof Nv))throw new Fd(Md.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Zd.fromString(t,...r));return vv(n),new Cv(e.firestore,e instanceof Nv?e.converter:null,new nh(n))}}class Rv{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Lg(this,"async_queue_retry"),this.Xc=()=>{const e=Mg();e&&Ed("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=Mg();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=Mg();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise((()=>{}));const t=new Ld;return this.ta((()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Qc.push(e),this.ea())))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!hh(e))throw e;Ed("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No((()=>this.ea()))}}ta(e){const t=this.Gc.then((()=>(this.Hc=!0,e().catch((e=>{this.Wc=e,this.Hc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Ad("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Hc=!1,e))))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const r=vy.createAndSchedule(this,e,t,n,(e=>this.na(e)));return this.zc.push(r),r}Zc(){this.Wc&&$d()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then((()=>{this.zc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()}))}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function _v(e){return function(e){if("object"!=typeof e||null===e)return!1;const t=e;for(const n of["next","error","complete"])if(n in t&&"function"==typeof t[n])return!0;return!1}(e)}class $v extends Iv{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Rv,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Dv(this),this._firestoreClient.terminate()}}function Ov(e){return e._firestoreClient||Dv(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Dv(e){var t,n,r;const s=e._freezeSettings(),a=function(e,t,n,r){return new Ph(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,mv(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,s);e._firestoreClient=new iv(e._authCredentials,e._appCheckCredentials,e._queue,a),(null===(n=s.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=s.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.cache.kind,_offline:s.cache._offlineComponentProvider,_online:s.cache._onlineComponentProvider})}class Mv{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mv(Rh.fromBase64String(e))}catch(e){throw new Fd(Md.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Mv(Rh.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Fv{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Fd(Md.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new th(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Lv{constructor(e){this._methodName=e}}class Pv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Fd(Md.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Fd(Md.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Kd(this._lat,e._lat)||Kd(this._long,e._long)}}const zv=/^__.*__$/;class Bv{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Lf(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ff(e,this.data,t,this.fieldTransforms)}}class jv{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Lf(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Uv(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $d()}}class Vv{constructor(e,t,n,r,s,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Vv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return ab(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(Uv(this.ca)&&zv.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Wv{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Fg(e)}ya(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Vv({ca:e,methodName:t,ga:n,path:th.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gv(e){const t=e._freezeSettings(),n=Fg(e._databaseId);return new Wv(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Hv(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=e.ya(a.merge||a.mergeFields?2:0,t,n,s);tb("Data must be an object, but it was:",i,r);const o=Zv(r,i);let l,u;if(a.merge)l=new Eh(i.fieldMask),u=i.fieldTransforms;else if(a.mergeFields){const e=[];for(const r of a.mergeFields){const s=nb(t,r,n);if(!i.contains(s))throw new Fd(Md.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);ib(e,s)||e.push(s)}l=new Eh(e),u=i.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,u=i.fieldTransforms;return new Bv(new np(o),l,u)}class qv extends Lv{_toFieldTransform(e){if(2!==e.ca)throw 1===e.ca?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qv}}class Kv extends Lv{_toFieldTransform(e){return new Tf(e.path,new vf)}isEqual(e){return e instanceof Kv}}function Xv(e,t,n,r){const s=e.ya(1,t,n);tb("Data must be an object, but it was:",s,r);const a=[],i=np.empty();wh(r,((e,r)=>{const o=sb(t,e,n);r=kn(r);const l=s.da(o);if(r instanceof qv)a.push(o);else{const e=Jv(r,l);null!=e&&(a.push(o),i.set(o,e))}}));const o=new Eh(a);return new jv(i,o,s.fieldTransforms)}function Yv(e,t,n,r,s,a){const i=e.ya(1,t,n),o=[nb(t,r,n)],l=[s];if(a.length%2!=0)throw new Fd(Md.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<a.length;h+=2)o.push(nb(t,a[h])),l.push(a[h+1]);const u=[],c=np.empty();for(let h=o.length-1;h>=0;--h)if(!ib(u,o[h])){const e=o[h];let t=l[h];t=kn(t);const n=i.da(e);if(t instanceof qv)u.push(e);else{const r=Jv(t,n);null!=r&&(u.push(e),c.set(e,r))}}const d=new Eh(u);return new jv(c,d,i.fieldTransforms)}function Qv(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Jv(n,e.ya(r?4:3,t))}function Jv(e,t){if(eb(e=kn(e)))return tb("Unsupported field value:",t,e),Zv(e,t);if(e instanceof Lv)return function(e,t){if(!Uv(t.ca))throw t._a(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t._a(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const s of e){let e=Jv(s,t.wa(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=kn(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return pf(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Yd.fromDate(e);return{timestampValue:bm(t.serializer,n)}}if(e instanceof Yd){const n=new Yd(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:bm(t.serializer,n)}}if(e instanceof Pv)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Mv)return{bytesValue:xm(t.serializer,e._byteString)};if(e instanceof Cv){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t._a(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Sm(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a(`Unsupported field value: ${xv(e)}`)}(e,t)}function Zv(e,t){const n={};return kh(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):wh(e,((e,r)=>{const s=Jv(r,t.ha(e));null!=s&&(n[e]=s)})),{mapValue:{fields:n}}}function eb(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Yd||e instanceof Pv||e instanceof Mv||e instanceof Cv||e instanceof Lv)}function tb(e,t,n){if(!eb(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=xv(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}}function nb(e,t,n){if((t=kn(t))instanceof Fv)return t._internalPath;if("string"==typeof t)return sb(e,t);throw ab("Field path arguments must be of type string or ",e,!1,void 0,n)}const rb=new RegExp("[~\\*/\\[\\]]");function sb(e,t,n){if(t.search(rb)>=0)throw ab(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Fv(...t.split("."))._internalPath}catch(r){throw ab(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function ab(e,t,n,r,s){const a=r&&!r.isEmpty(),i=void 0!==s;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||i)&&(l+=" (found",a&&(l+=` in field ${r}`),i&&(l+=` in document ${s}`),l+=")"),new Fd(Md.INVALID_ARGUMENT,o+e+l)}function ib(e,t){return e.some((e=>e.isEqual(t)))}class ob{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Cv(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new lb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ub("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class lb extends ob{data(){return super.data()}}function ub(e,t){return"string"==typeof t?sb(e,t):t instanceof Fv?t._internalPath:t._delegate._internalPath}function cb(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Fd(Md.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class db{}class hb extends db{}function pb(e,t){let n=[];for(var r=arguments.length,s=new Array(r>2?r-2:0),a=2;a<r;a++)s[a-2]=arguments[a];t instanceof db&&n.push(t),n=n.concat(s),function(e){const t=e.filter((e=>e instanceof mb)).length,n=e.filter((e=>e instanceof fb)).length;if(t>1||t>0&&n>0)throw new Fd(Md.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)e=i._apply(e);return e}class fb extends hb{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new fb(e,t,n)}_apply(e){const t=this._parse(e);return kb(e._query,t),new Tv(e.firestore,e.converter,jp(e._query,t))}_parse(e){const t=Gv(e.firestore),n=function(e,t,n,r,s,a,i){let o;if(s.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Fd(Md.INVALID_ARGUMENT,`Invalid Query. You can't perform '${a}' queries on documentId().`);if("in"===a||"not-in"===a){wb(i,a);const t=[];for(const n of i)t.push(xb(r,e,n));o={arrayValue:{values:t}}}else o=xb(r,e,i)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||wb(i,a),o=Qv(n,"where",i,"in"===a||"not-in"===a);return dp.create(s,a,o)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class mb extends db{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new mb(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:hp.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const s of r)kb(n,s),n=jp(n,s)}(e._query,t),new Tv(e.firestore,e.converter,jp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class gb extends hb{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new gb(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Fd(Md.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Fd(Md.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new lp(t,n);return function(e,t){if(null===Fp(e)){const n=Lp(e);null!==n&&Sb(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new Tv(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new $p(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function yb(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=ub("orderBy",e);return gb._create(n,t)}class vb extends hb{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new vb(e,t,n)}_apply(e){return new Tv(e.firestore,e.converter,Up(e._query,this._limit,this._limitType))}}function bb(e){return kv("limit",e),vb._create("limit",e,"F")}function xb(e,t,n){if("string"==typeof(n=kn(n))){if(""===n)throw new Fd(Md.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Pp(t)&&-1!==n.indexOf("/"))throw new Fd(Md.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Zd.fromString(n));if(!nh.isDocumentKey(r))throw new Fd(Md.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Kh(e,new nh(r))}if(n instanceof Cv)return Kh(e,n._key);throw new Fd(Md.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xv(n)}.`)}function wb(e,t){if(!Array.isArray(e)||0===e.length)throw new Fd(Md.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function kb(e,t){if(t.isInequality()){const n=Lp(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new Fd(Md.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${r.toString()}'`);const s=Fp(e);null!==s&&Sb(e,r,s)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Fd(Md.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Fd(Md.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Sb(e,t,n){if(!n.isEqual(t))throw new Fd(Md.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class Ib{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(jh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Oh(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Dh(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw $d()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return wh(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new Pv(Oh(e.latitude),Oh(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Fh(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Lh(e));default:return null}}convertTimestamp(e){const t=$h(e);return new Yd(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Zd.fromString(e);Od(Wm(n));const r=new zh(n.get(1),n.get(3)),s=new nh(n.popFirst(5));return r.isEqual(t)||Ad(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Cb(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Tb{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Nb extends ob{constructor(e,t,n,r,s,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Eb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(ub("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Eb extends Nb{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Ab{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Tb(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Eb(this._firestore,this._userDataWriter,n.key,n,new Tb(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Fd(Md.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Eb(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Tb(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Eb(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Tb(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,a=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:Rb(t.type),doc:r,oldIndex:s,newIndex:a}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Rb(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $d()}}function _b(e){e=wv(e,Cv);const t=wv(e.firestore,$v);return fv(Ov(t),e._key).then((n=>Pb(t,e,n)))}class $b extends Ib{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mv(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Cv(this.firestore,null,t)}}function Ob(e,t,n){e=wv(e,Cv);const r=wv(e.firestore,$v),s=Cb(e.converter,t,n);return Lb(r,[Hv(Gv(r),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,Ef.none())])}function Db(e,t,n){e=wv(e,Cv);const r=wv(e.firestore,$v),s=Gv(r);let a;for(var i=arguments.length,o=new Array(i>3?i-3:0),l=3;l<i;l++)o[l-3]=arguments[l];return a="string"==typeof(t=kn(t))||t instanceof Fv?Yv(s,"updateDoc",e._key,t,n,o):Xv(s,"updateDoc",e._key,t),Lb(r,[a.toMutation(e._key,Ef.exists(!0))])}function Mb(e,t){const n=wv(e.firestore,$v),r=Av(e),s=Cb(e.converter,t);return Lb(n,[Hv(Gv(e.firestore),"addDoc",r._key,s,null!==e.converter,{}).toMutation(r._key,Ef.exists(!1))]).then((()=>r))}function Fb(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s,a,i;e=kn(e);let o={includeMetadataChanges:!1},l=0;"object"!=typeof n[l]||_v(n[l])||(o=n[l],l++);const u={includeMetadataChanges:o.includeMetadataChanges};if(_v(n[l])){const e=n[l];n[l]=null===(s=e.next)||void 0===s?void 0:s.bind(e),n[l+1]=null===(a=e.error)||void 0===a?void 0:a.bind(e),n[l+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let c,d,h;if(e instanceof Cv)d=wv(e.firestore,$v),h=Dp(e._key.path),c={next:t=>{n[l]&&n[l](Pb(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=wv(e,Tv);d=wv(t.firestore,$v),h=t._query;const r=new $b(d);c={next:e=>{n[l]&&n[l](new Ab(d,r,t,e))},error:n[l+1],complete:n[l+2]},cb(e._query)}return function(e,t,n,r){const s=new av(r),a=new Ry(t,s,n);return e.asyncQueue.enqueueAndForget((async()=>Cy(await pv(e),a))),()=>{s.Dc(),e.asyncQueue.enqueueAndForget((async()=>Ty(await pv(e),a)))}}(Ov(d),h,u,c)}function Lb(e,t){return function(e,t){const n=new Ld;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=nv(e);try{const e=await function(e,t){const n=Dd(e),r=Yd.now(),s=t.reduce(((e,t)=>e.add(t.key)),lf());let a,i;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=Jp(),l=lf();return n.Zi.getEntries(e,s).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((s=>{a=s;const i=[];for(const e of t){const t=Df(e,a.get(e.key).overlayedDocument);null!=t&&i.push(new Lf(e.key,t,rp(t.value.mapValue),Ef.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,i,t)})).next((t=>{i=t;const r=t.applyToLocalDocumentSet(a,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:i.batchId,changes:tf(a)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Tc[e.currentUser.toKey()];r||(r=new Sh(Kd)),r=r.insert(t,n),e.Tc[e.currentUser.toKey()]=r}(r,e.batchId,n),await Jy(r,e.changes),await ay(r.remoteStore)}catch(e){const t=by(e,"Failed to persist write");n.reject(t)}}(await hv(e),t,n))),n.promise}(Ov(e),t)}function Pb(e,t,n){const r=n.docs.get(t._key),s=new $b(e);return new Nb(e,s,t._key,r,new Tb(n.hasPendingWrites,n.fromCache),t.converter)}function zb(){return new Kv("serverTimestamp")}!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Cd=e}(Dr),Rr(new Sn("firestore",((e,n)=>{let{instanceIdentifier:r,options:s}=n;const a=e.getProvider("app").getImmediate(),i=new $v(new jd(e.getProvider("auth-internal")),new Gd(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Fd(Md.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zh(e.options.projectId,t)}(a,r),a);return s=Object.assign({useFetchStreams:t},s),i._setSettings(s),i}),"PUBLIC").setMultipleInstances(!0)),Lr(Sd,"3.13.0",e),Lr(Sd,"3.13.0","esm2017")}();Lr("firebase","9.23.0","app");const Bb="firebasestorage.googleapis.com",jb="storageBucket";class Ub extends hn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(qb(e),`Firebase Storage: ${t} (${qb(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ub.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qb(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var Vb,Wb,Gb,Hb;function qb(e){return"storage/"+e}function Kb(){return new Ub(Vb.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Xb(){return new Ub(Vb.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Yb(){return new Ub(Vb.CANCELED,"User canceled the upload/download.")}function Qb(){return new Ub(Vb.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Jb(e){return new Ub(Vb.INVALID_ARGUMENT,e)}function Zb(){return new Ub(Vb.APP_DELETED,"The Firebase app was deleted.")}function ex(e,t){return new Ub(Vb.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function tx(e){throw new Ub(Vb.INTERNAL_ERROR,"Internal error: "+e)}(Wb=Vb||(Vb={})).UNKNOWN="unknown",Wb.OBJECT_NOT_FOUND="object-not-found",Wb.BUCKET_NOT_FOUND="bucket-not-found",Wb.PROJECT_NOT_FOUND="project-not-found",Wb.QUOTA_EXCEEDED="quota-exceeded",Wb.UNAUTHENTICATED="unauthenticated",Wb.UNAUTHORIZED="unauthorized",Wb.UNAUTHORIZED_APP="unauthorized-app",Wb.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",Wb.INVALID_CHECKSUM="invalid-checksum",Wb.CANCELED="canceled",Wb.INVALID_EVENT_NAME="invalid-event-name",Wb.INVALID_URL="invalid-url",Wb.INVALID_DEFAULT_BUCKET="invalid-default-bucket",Wb.NO_DEFAULT_BUCKET="no-default-bucket",Wb.CANNOT_SLICE_BLOB="cannot-slice-blob",Wb.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",Wb.NO_DOWNLOAD_URL="no-download-url",Wb.INVALID_ARGUMENT="invalid-argument",Wb.INVALID_ARGUMENT_COUNT="invalid-argument-count",Wb.APP_DELETED="app-deleted",Wb.INVALID_ROOT_OPERATION="invalid-root-operation",Wb.INVALID_FORMAT="invalid-format",Wb.INTERNAL_ERROR="internal-error",Wb.UNSUPPORTED_ENVIRONMENT="unsupported-environment";class nx{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=nx.makeFromUrl(e,t)}catch(s){return new nx(e,"")}if(""===n.path)return n;throw r=e,new Ub(Vb.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const s=new RegExp("^gs://"+r+"(/(.*))?$","i");function a(e){e.path_=decodeURIComponent(e.path)}const i=t.replace(/[.]/g,"\\."),o=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${i}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp(`^https?://${t===Bb?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:a}];for(let l=0;l<o.length;l++){const t=o[l],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let s=r[t.indices.path];s||(s=""),n=new nx(e,s),t.postModify(n);break}}if(null==n)throw function(e){return new Ub(Vb.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class rx{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function sx(e){return"string"===typeof e||e instanceof String}function ax(e){return ix()&&e instanceof Blob}function ix(){return"undefined"!==typeof Blob&&!un()}function ox(e,t,n,r){if(r<t)throw Jb(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw Jb(`Invalid value for '${e}'. Expected ${n} or less.`)}function lx(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function ux(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function cx(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),s=-1!==t.indexOf(e);return n||r||s}(Hb=Gb||(Gb={}))[Hb.NO_ERROR=0]="NO_ERROR",Hb[Hb.NETWORK_ERROR=1]="NETWORK_ERROR",Hb[Hb.ABORT=2]="ABORT";class dx{constructor(e,t,n,r,s,a,i,o,l,u,c){let d=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=i,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=c,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new hx(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===Gb.NO_ERROR,s=n.getStatus();if(!t||cx(s,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Gb.ABORT;return void e(!1,new hx(!1,null,t))}const a=-1!==this.successCodes_.indexOf(s);e(!0,new hx(a,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,s=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(s,s.getResponse());void 0!==e?n(e):n()}catch(a){r(a)}else if(null!==s){const e=Kb();e.serverResponse=s.getErrorText(),this.errorCallback_?r(this.errorCallback_(s,e)):r(e)}else if(t.canceled){r(this.appDelete_?Zb():Yb())}else{r(Xb())}};this.canceled_?t(0,new hx(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,s=null,a=null,i=!1,o=0;function l(){return 2===o}let u=!1;function c(){if(!u){u=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function d(t){s=setTimeout((()=>{s=null,e(p,l())}),t)}function h(){a&&clearTimeout(a)}function p(e){if(u)return void h();for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];if(e)return h(),void c.call(null,e,...n);if(l()||i)return h(),void c.call(null,e,...n);let a;r<64&&(r*=2),1===o?(o=2,a=0):a=1e3*(r+Math.random()),d(a)}let f=!1;function m(e){f||(f=!0,h(),u||(null!==s?(e||(o=2),clearTimeout(s),d(0)):e||(o=1)))}return d(0),a=setTimeout((()=>{i=!0,m(!0)}),n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class hx{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function px(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function fx(){const e=px();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){const t=new e;for(let e=0;e<n.length;e++)t.append(n[e]);return t.getBlob()}if(ix())return new Blob(n);throw new Ub(Vb.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function mx(e){if("undefined"===typeof atob)throw t="base-64",new Ub(Vb.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);var t;return atob(e)}const gx="raw",yx="base64",vx="base64url",bx="data_url";class xx{constructor(e,t){this.data=e,this.contentType=t||null}}function wx(e,t){switch(e){case gx:return new xx(kx(t));case yx:case vx:return new xx(Sx(e,t));case bx:return new xx(function(e){const t=new Ix(e);return t.base64?Sx(yx,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(n){throw ex(bx,"Malformed data URL.")}return kx(t)}(t.rest)}(t),new Ix(t).contentType)}throw Kb()}function kx(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Sx(e,t){switch(e){case yx:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw ex(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case vx:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw ex(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=mx(t)}catch(s){if(s.message.includes("polyfill"))throw s;throw ex(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return r}class Ix{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw ex(bx,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class Cx{constructor(e,t){let n=0,r="";ax(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(ax(this.data_)){const a=this.data_,i=(r=e,s=t,(n=a).webkitSlice?n.webkitSlice(r,s):n.mozSlice?n.mozSlice(r,s):n.slice?n.slice(r,s):null);return null===i?null:new Cx(i)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Cx(n,!0)}var n,r,s}static getBlob(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(ix()){const e=t.map((e=>e instanceof Cx?e.data_:e));return new Cx(fx.apply(null,e))}{const e=t.map((e=>sx(e)?wx(gx,e).data:e.data_));let n=0;e.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let s=0;return e.forEach((e=>{for(let t=0;t<e.length;t++)r[s++]=e[t]})),new Cx(r,!0)}}uploadData(){return this.data_}}function Tx(e){let t;try{t=JSON.parse(e)}catch(r){return null}return"object"!==typeof(n=t)||Array.isArray(n)?null:t;var n}function Nx(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Ex(e,t){return t}class Ax{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||Ex}}let Rx=null;function _x(){if(Rx)return Rx;const e=[];e.push(new Ax("bucket")),e.push(new Ax("generation")),e.push(new Ax("metageneration")),e.push(new Ax("name","fullPath",!0));const t=new Ax("name");t.xform=function(e,t){return function(e){return!sx(e)||e.length<2?e:Nx(e)}(t)},e.push(t);const n=new Ax("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new Ax("timeCreated")),e.push(new Ax("updated")),e.push(new Ax("md5Hash",null,!0)),e.push(new Ax("cacheControl",null,!0)),e.push(new Ax("contentDisposition",null,!0)),e.push(new Ax("contentEncoding",null,!0)),e.push(new Ax("contentLanguage",null,!0)),e.push(new Ax("contentType",null,!0)),e.push(new Ax("metadata","customMetadata",!0)),Rx=e,Rx}function $x(e,t,n){const r={type:"file"},s=n.length;for(let a=0;a<s;a++){const e=n[a];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,s=new nx(n,r);return t._makeStorageReference(s)}})}(r,e),r}function Ox(e,t,n){const r=Tx(t);if(null===r)return null;return $x(e,r,n)}function Dx(e,t){const n={},r=t.length;for(let s=0;s<r;s++){const r=t[s];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}class Mx{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Fx(e){if(!e)throw Kb()}function Lx(e,t){return function(n,r){const s=Ox(e,r,t);return Fx(null!==s),s}}function Px(e,t){return function(n,r){const s=Ox(e,r,t);return Fx(null!==s),function(e,t,n,r){const s=Tx(t);if(null===s)return null;if(!sx(s.downloadTokens))return null;const a=s.downloadTokens;if(0===a.length)return null;const i=encodeURIComponent;return a.split(",").map((t=>{const s=e.bucket,a=e.fullPath;return lx("/b/"+i(s)+"/o/"+i(a),n,r)+ux({alt:"media",token:t})}))[0]}(s,r,e.host,e._protocol)}}function zx(e){return function(t,n){let r;var s,a;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new Ub(Vb.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new Ub(Vb.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(a=e.bucket,r=new Ub(Vb.QUOTA_EXCEEDED,"Quota for bucket '"+a+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(s=e.path,r=new Ub(Vb.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function Bx(e){const t=zx(e);return function(n,r){let s=t(n,r);var a;return 404===n.getStatus()&&(a=e.path,s=new Ub(Vb.OBJECT_NOT_FOUND,"Object '"+a+"' does not exist.")),s.serverResponse=r.serverResponse,s}}function jx(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function Ux(e,t,n,r,s){const a=t.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};const o=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();i["Content-Type"]="multipart/related; boundary="+o;const l=jx(t,r,s),u="--"+o+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Dx(l,n)+"\r\n--"+o+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",c="\r\n--"+o+"--",d=Cx.getBlob(u,r,c);if(null===d)throw Qb();const h={name:l.fullPath},p=lx(a,e.host,e._protocol),f=e.maxUploadRetryTime,m=new Mx(p,"POST",Lx(e,n),f);return m.urlParams=h,m.headers=i,m.body=d.uploadData(),m.errorHandler=zx(t),m}class Vx{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Gb.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=Gb.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=Gb.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r){if(this.sent_)throw tx("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw tx("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw tx("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw tx("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw tx("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Wx extends Vx{initXhr(){this.xhr_.responseType="text"}}function Gx(){return new Wx}class Hx{constructor(e,t){this._service=e,this._location=t instanceof nx?t:nx.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Hx(e,t)}get root(){const e=new nx(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Nx(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new nx(this._location.bucket,e);return new Hx(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Ub(Vb.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function qx(e,t,n){e._throwIfRoot("uploadBytes");const r=Ux(e.storage,e._location,_x(),new Cx(t,!0),n);return e.storage.makeRequestWithTokens(r,Gx).then((t=>({metadata:t,ref:e})))}function Kx(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=lx(t.fullServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,a=new Mx(r,"GET",Px(e,n),s);return a.errorHandler=Bx(t),a}(e.storage,e._location,_x());return e.storage.makeRequestWithTokens(t,Gx).then((e=>{if(null===e)throw new Ub(Vb.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function Xx(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new nx(e._location.bucket,n);return new Hx(e.storage,r)}function Yx(e,t){if(e instanceof Zx){const n=e;if(null==n._bucket)throw new Ub(Vb.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+jb+"' property when initializing the app?");const r=new Hx(n,n._bucket);return null!=t?Yx(r,t):r}return void 0!==t?Xx(e,t):e}function Qx(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Zx)return new Hx(e,t);throw Jb("To use ref(service, url), the first argument must be a Storage instance.")}return Yx(e,t)}function Jx(e,t){const n=null===t||void 0===t?void 0:t[jb];return null==n?null:nx.makeFromBucketSpec(n,e)}class Zx{constructor(e,t,n,r,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=Bb,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?nx.makeFromBucketSpec(r,this._host):Jx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=nx.makeFromBucketSpec(this._url,e):this._bucket=Jx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ox("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ox("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Hx(this,e)}_makeRequest(e,t,n,r){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new rx(Zb());{const a=function(e,t,n,r,s,a){let i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const o=ux(e.urlParams),l=e.url+o,u=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(u,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(u,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(u,a),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(u,r),new dx(l,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,i)}(e,this._appId,n,r,t,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then((()=>this._requests.delete(a)),(()=>this._requests.delete(a))),a}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const ew="@firebase/storage",tw="0.11.2",nw="storage";function rw(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new Zx(r,s,a,n,Dr)}Rr(new Sn(nw,rw,"PUBLIC").setMultipleInstances(!0)),Lr(ew,tw,""),Lr(ew,tw,"esm2017");let sw,aw;const iw=new WeakMap,ow=new WeakMap,lw=new WeakMap,uw=new WeakMap,cw=new WeakMap;let dw={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ow.get(e);if("objectStoreNames"===t)return e.objectStoreNames||lw.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return fw(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function hw(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(aw||(aw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(mw(this),n),fw(iw.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return fw(e.apply(mw(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];const a=e.call(mw(this),t,...r);return lw.set(a,t.sort?t.sort():[t]),fw(a)}}function pw(e){return"function"===typeof e?hw(e):(e instanceof IDBTransaction&&function(e){if(ow.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)}));ow.set(e,t)}(e),t=e,(sw||(sw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,dw):e);var t}function fw(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{t(fw(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&iw.set(t,e)})).catch((()=>{})),cw.set(t,e),t}(e);if(uw.has(e))return uw.get(e);const t=pw(e);return t!==e&&(uw.set(e,t),cw.set(t,e)),t}const mw=e=>cw.get(e);const gw=["get","getKey","getAll","getAllKeys","count"],yw=["put","add","delete","clear"],vw=new Map;function bw(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(vw.get(t))return vw.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=yw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!gw.includes(n))return;const a=async function(e){const t=this.transaction(e,s?"readwrite":"readonly");let a=t.store;for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return r&&(a=a.index(o.shift())),(await Promise.all([a[n](...o),s&&t.done]))[0]};return vw.set(t,a),a}!function(e){dw=e(dw)}((e=>({...e,get:(t,n,r)=>bw(t,n)||e.get(t,n,r),has:(t,n)=>!!bw(t,n)||e.has(t,n)})));const xw="@firebase/installations",ww="0.6.4",kw=1e4,Sw=`w:${ww}`,Iw="FIS_v2",Cw=36e5,Tw=new pn("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Nw(e){return e instanceof hn&&e.code.includes("request-failed")}function Ew(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function Aw(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Rw(e,t){const n=(await t.json()).error;return Tw.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function _w(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function $w(e,t){let{refreshToken:n}=t;const r=_w(e);return r.append("Authorization",function(e){return`${Iw} ${e}`}(n)),r}async function Ow(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Dw(e){return new Promise((t=>{setTimeout(t,e)}))}const Mw=/^[cdef][\w-]{21}$/;function Fw(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return Mw.test(t)?t:""}catch(e){return""}}function Lw(e){return`${e.appName}!${e.appId}`}const Pw=new Map;function zw(e,t){const n=Lw(e);Bw(n,t),function(e,t){const n=Uw();n&&n.postMessage({key:e,fid:t});Vw()}(n,t)}function Bw(e,t){const n=Pw.get(e);if(n)for(const r of n)r(t)}let jw=null;function Uw(){return!jw&&"BroadcastChannel"in self&&(jw=new BroadcastChannel("[Firebase] FID Change"),jw.onmessage=e=>{Bw(e.data.key,e.data.fid)}),jw}function Vw(){0===Pw.size&&jw&&(jw.close(),jw=null)}const Ww="firebase-installations-store";let Gw=null;function Hw(){return Gw||(Gw=function(e,t){let{blocked:n,upgrade:r,blocking:s,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),o=fw(i);return r&&i.addEventListener("upgradeneeded",(e=>{r(fw(i.result),e.oldVersion,e.newVersion,fw(i.transaction))})),n&&i.addEventListener("blocked",(()=>n())),o.then((e=>{a&&e.addEventListener("close",(()=>a())),s&&e.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),o}("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Ww)}})),Gw}async function qw(e,t){const n=Lw(e),r=(await Hw()).transaction(Ww,"readwrite"),s=r.objectStore(Ww),a=await s.get(n);return await s.put(t,n),await r.done,a&&a.fid===t.fid||zw(e,t.fid),t}async function Kw(e){const t=Lw(e),n=(await Hw()).transaction(Ww,"readwrite");await n.objectStore(Ww).delete(t),await n.done}async function Xw(e,t){const n=Lw(e),r=(await Hw()).transaction(Ww,"readwrite"),s=r.objectStore(Ww),a=await s.get(n),i=t(a);return void 0===i?await s.delete(n):await s.put(i,n),await r.done,!i||a&&a.fid===i.fid||zw(e,i.fid),i}async function Yw(e){let t;const n=await Xw(e.appConfig,(n=>{const r=function(e){const t=e||{fid:Fw(),registrationStatus:0};return Zw(t)}(n),s=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Tw.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:s}=t;const a=Ew(n),i=_w(n),o=r.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const l={fid:s,authVersion:Iw,appId:n.appId,sdkVersion:Sw},u={method:"POST",headers:i,body:JSON.stringify(l)},c=await Ow((()=>fetch(a,u)));if(c.ok){const e=await c.json();return{fid:e.fid||s,registrationStatus:2,refreshToken:e.refreshToken,authToken:Aw(e.authToken)}}throw await Rw("Create Installation",c)}(e,t);return qw(e.appConfig,n)}catch(n){throw Nw(n)&&409===n.customData.serverCode?await Kw(e.appConfig):await qw(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Qw(e)}:{installationEntry:t}}(e,r);return t=s.registrationPromise,s.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function Qw(e){let t=await Jw(e.appConfig);for(;1===t.registrationStatus;)await Dw(100),t=await Jw(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Yw(e);return n||t}return t}function Jw(e){return Xw(e,(e=>{if(!e)throw Tw.create("installation-not-found");return Zw(e)}))}function Zw(e){return 1===(t=e).registrationStatus&&t.registrationTime+kw<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function ek(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const s=function(e,t){let{fid:n}=t;return`${Ew(e)}/${n}/authTokens:generate`}(n,t),a=$w(n,t),i=r.getImmediate({optional:!0});if(i){const e=await i.getHeartbeatsHeader();e&&a.append("x-firebase-client",e)}const o={installation:{sdkVersion:Sw,appId:n.appId}},l={method:"POST",headers:a,body:JSON.stringify(o)},u=await Ow((()=>fetch(s,l)));if(u.ok){return Aw(await u.json())}throw await Rw("Generate Auth Token",u)}async function tk(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await Xw(e.appConfig,(r=>{if(!rk(r))throw Tw.create("not-registered");const s=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Cw}(e)}(s))return r;if(1===s.requestStatus)return t=async function(e,t){let n=await nk(e.appConfig);for(;1===n.authToken.requestStatus;)await Dw(100),n=await nk(e.appConfig);const r=n.authToken;return 0===r.requestStatus?tk(e,t):r}(e,n),r;{if(!navigator.onLine)throw Tw.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await ek(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await qw(e.appConfig,r),n}catch(n){if(!Nw(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await qw(e.appConfig,n)}else await Kw(e.appConfig);throw n}}(e,n),n}}));return t?await t:r.authToken}function nk(e){return Xw(e,(e=>{if(!rk(e))throw Tw.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+kw<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function rk(e){return void 0!==e&&2===e.registrationStatus}async function sk(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await Yw(e);t&&await t}(n);return(await tk(n,t)).token}function ak(e){return Tw.create("missing-app-config-values",{valueName:e})}const ik="installations",ok=e=>{const t=_r(e.getProvider("app").getImmediate(),ik).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Yw(t);return r?r.catch(console.error):tk(t).catch(console.error),n.fid}(t),getToken:e=>sk(t,e)}};Rr(new Sn(ik,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw ak("App Configuration");if(!e.name)throw ak("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw ak(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:_r(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),Rr(new Sn("installations-internal",ok,"PRIVATE")),Lr(xw,ww),Lr(xw,ww,"esm2017");let lk,uk;const ck=new WeakMap,dk=new WeakMap,hk=new WeakMap,pk=new WeakMap,fk=new WeakMap;let mk={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return dk.get(e);if("objectStoreNames"===t)return e.objectStoreNames||hk.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vk(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function gk(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(uk||(uk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(bk(this),n),vk(ck.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return vk(e.apply(bk(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];const a=e.call(bk(this),t,...r);return hk.set(a,t.sort?t.sort():[t]),vk(a)}}function yk(e){return"function"===typeof e?gk(e):(e instanceof IDBTransaction&&function(e){if(dk.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)}));dk.set(e,t)}(e),t=e,(lk||(lk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,mk):e);var t}function vk(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{t(vk(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&ck.set(t,e)})).catch((()=>{})),fk.set(t,e),t}(e);if(pk.has(e))return pk.get(e);const t=yk(e);return t!==e&&(pk.set(e,t),fk.set(t,e)),t}const bk=e=>fk.get(e);function xk(e,t){let{blocked:n,upgrade:r,blocking:s,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),o=vk(i);return r&&i.addEventListener("upgradeneeded",(e=>{r(vk(i.result),e.oldVersion,e.newVersion,vk(i.transaction))})),n&&i.addEventListener("blocked",(()=>n())),o.then((e=>{a&&e.addEventListener("close",(()=>a())),s&&e.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),o}function wk(e){let{blocked:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(()=>t())),vk(n).then((()=>{}))}const kk=["get","getKey","getAll","getAllKeys","count"],Sk=["put","add","delete","clear"],Ik=new Map;function Ck(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Ik.get(t))return Ik.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=Sk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!kk.includes(n))return;const a=async function(e){const t=this.transaction(e,s?"readwrite":"readonly");let a=t.store;for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return r&&(a=a.index(o.shift())),(await Promise.all([a[n](...o),s&&t.done]))[0]};return Ik.set(t,a),a}!function(e){mk=e(mk)}((e=>({...e,get:(t,n,r)=>Ck(t,n)||e.get(t,n,r),has:(t,n)=>!!Ck(t,n)||e.has(t,n)})));const Tk="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Nk="google.c.a.c_id";var Ek,Ak,Rk;function _k(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function $k(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let s=0;s<n.length;++s)r[s]=n.charCodeAt(s);return r}(Ak=Ek||(Ek={}))[Ak.DATA_MESSAGE=1]="DATA_MESSAGE",Ak[Ak.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION",function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(Rk||(Rk={}));const Ok="fcm_token_details_db",Dk="fcm_token_object_Store";const Mk="firebase-messaging-store";let Fk=null;function Lk(){return Fk||(Fk=xk("firebase-messaging-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Mk)}})),Fk}async function Pk(e){const t=Bk(e),n=await Lk(),r=await n.transaction(Mk).objectStore(Mk).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map((e=>e.name));if(!e.includes(Ok))return null}let t=null;return(await xk(Ok,5,{upgrade:async(n,r,s,a)=>{var i;if(r<2)return;if(!n.objectStoreNames.contains(Dk))return;const o=a.objectStore(Dk),l=await o.index("fcmSenderId").get(e);if(await o.clear(),l)if(2===r){const e=l;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(i=e.createTime)&&void 0!==i?i:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"===typeof e.vapidKey?e.vapidKey:_k(e.vapidKey)}}}else if(3===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:_k(e.auth),p256dh:_k(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:_k(e.vapidKey)}}}else if(4===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:_k(e.auth),p256dh:_k(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:_k(e.vapidKey)}}}}})).close(),await wk(Ok),await wk("fcm_vapid_details_db"),await wk("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"===typeof e.createTime&&e.createTime>0&&"string"===typeof e.token&&e.token.length>0&&"string"===typeof t.auth&&t.auth.length>0&&"string"===typeof t.p256dh&&t.p256dh.length>0&&"string"===typeof t.endpoint&&t.endpoint.length>0&&"string"===typeof t.swScope&&t.swScope.length>0&&"string"===typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await zk(e,t),t}}async function zk(e,t){const n=Bk(e),r=(await Lk()).transaction(Mk,"readwrite");return await r.objectStore(Mk).put(t,n),await r.done,t}function Bk(e){let{appConfig:t}=e;return t.appId}const jk=new pn("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});async function Uk(e,t){const n={method:"DELETE",headers:await Wk(e)};try{const r=await fetch(`${Vk(e.appConfig)}/${t}`,n),s=await r.json();if(s.error){const e=s.error.message;throw jk.create("token-unsubscribe-failed",{errorInfo:e})}}catch(r){throw jk.create("token-unsubscribe-failed",{errorInfo:null===r||void 0===r?void 0:r.toString()})}}function Vk(e){let{projectId:t}=e;return`https://fcmregistrations.googleapis.com/v1/projects/${t}/registrations`}async function Wk(e){let{appConfig:t,installations:n}=e;const r=await n.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${r}`})}function Gk(e){let{p256dh:t,auth:n,endpoint:r,vapidKey:s}=e;const a={web:{endpoint:r,auth:n,p256dh:t}};return s!==Tk&&(a.web.applicationPubKey=s),a}async function Hk(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:$k(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:_k(t.getKey("auth")),p256dh:_k(t.getKey("p256dh"))},r=await Pk(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,s=t.auth===e.auth,a=t.p256dh===e.p256dh;return n&&r&&s&&a}(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await Wk(e),r=Gk(t.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let a;try{const n=await fetch(`${Vk(e.appConfig)}/${t.token}`,s);a=await n.json()}catch(i){throw jk.create("token-update-failed",{errorInfo:null===i||void 0===i?void 0:i.toString()})}if(a.error){const e=a.error.message;throw jk.create("token-update-failed",{errorInfo:e})}if(!a.token)throw jk.create("token-update-no-token");return a.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await zk(e.firebaseDependencies,r),n}catch(n){throw await qk(e),n}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await Uk(e.firebaseDependencies,r.token)}catch(s){console.warn(s)}return Kk(e.firebaseDependencies,n)}return Kk(e.firebaseDependencies,n)}async function qk(e){const t=await Pk(e.firebaseDependencies);t&&(await Uk(e.firebaseDependencies,t.token),await async function(e){const t=Bk(e),n=(await Lk()).transaction(Mk,"readwrite");await n.objectStore(Mk).delete(t),await n.done}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function Kk(e,t){const n=await async function(e,t){const n=await Wk(e),r=Gk(t),s={method:"POST",headers:n,body:JSON.stringify(r)};let a;try{const t=await fetch(Vk(e.appConfig),s);a=await t.json()}catch(i){throw jk.create("token-subscribe-failed",{errorInfo:null===i||void 0===i?void 0:i.toString()})}if(a.error){const e=a.error.message;throw jk.create("token-subscribe-failed",{errorInfo:e})}if(!a.token)throw jk.create("token-subscribe-no-token");return a.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await zk(e,r),r.token}function Xk(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const s=t.notification.image;s&&(e.notification.image=s);const a=t.notification.icon;a&&(e.notification.icon=a)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,s,a,i;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const o=null!==(s=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==s?s:null===(a=t.notification)||void 0===a?void 0:a.click_action;o&&(e.fcmOptions.link=o);const l=null===(i=t.fcmOptions)||void 0===i?void 0:i.analytics_label;l&&(e.fcmOptions.analyticsLabel=l)}(t,e),t}function Yk(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function Qk(e){return jk.create("missing-app-config-values",{valueName:e})}Yk("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Yk("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Jk{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw Qk("App Configuration Object");if(!e.name)throw Qk("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const r of t)if(!n[r])throw Qk(r);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}async function Zk(e){try{e.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),e.swRegistration.update().catch((()=>{}))}catch(t){throw jk.create("failed-service-worker-registration",{browserErrorMessage:null===t||void 0===t?void 0:t.message})}}async function eS(e,t){if(!navigator)throw jk.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw jk.create("permission-blocked");return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=Tk)}(e,null===t||void 0===t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await Zk(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw jk.create("invalid-sw-registration");e.swRegistration=t}}(e,null===t||void 0===t?void 0:t.serviceWorkerRegistration),Hk(e)}async function tS(e,t,n){const r=function(e){switch(e){case Rk.NOTIFICATION_CLICKED:return"notification_open";case Rk.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[Nk],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function nS(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===Rk.PUSH_RECEIVED&&("function"===typeof e.onMessageHandler?e.onMessageHandler(Xk(n)):e.onMessageHandler.next(Xk(n)));const r=n.data;var s;"object"===typeof(s=r)&&s&&Nk in s&&"1"===r["google.c.a.e"]&&await tS(e,n.messageType,r)}const rS="@firebase/messaging",sS="0.12.4",aS=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>eS(t,e)}};async function iS(){try{await dn()}catch(e){return!1}return"undefined"!==typeof window&&cn()&&!("undefined"===typeof navigator||!navigator.cookieEnabled)&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function oS(e,t){return function(e,t){if(!navigator)throw jk.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=kn(e),t)}Rr(new Sn("messaging",(e=>{const t=new Jk(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",(e=>nS(t,e))),t}),"PUBLIC")),Rr(new Sn("messaging-internal",aS,"PRIVATE")),Lr(rS,sS),Lr(rS,sS,"esm2017");const lS=Mr({apiKey:"AIzaSyDlvkj8DgXD0iwKWC9btSpY19OiAZmVZxw",authDomain:"baadi-98448.firebaseapp.com",projectId:"baadi-98448",storageBucket:"baadi-98448.firebasestorage.app",messagingSenderId:"657000742089",appId:"1:657000742089:web:245b00c6be06a35f036118",measurementId:"G-9787N1J6F6"}),uS=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fr();const t=_r(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=_r(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(mn(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;es(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Xi,persistence:[li,Ga,qa]}),r=sn("authTokenSyncURL");if(r){const e=(s=r,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Zi)return;const r=null===t||void 0===t?void 0:t.token;eo!==r&&(eo=r,await fetch(s,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){kn(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(e,t,n,r){kn(e).onIdTokenChanged(t,n,r)}(n,(t=>e(t)))}var s;const a=tn("auth");return a&&la(n,`http://${a}`),n}(lS),cS=function(e,t){const n="string"==typeof e?e:t||"(default)",r=_r("object"==typeof e?e:Fr(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=nn("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var s;const a=(e=wv(e,Iv))._getSettings(),i=`${t}:${n}`;if("firestore.googleapis.com"!==a.host&&a.host!==i&&Rd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:i,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Id.MOCK_USER;else{t=on(r.mockUserToken,null===(s=e._app)||void 0===s?void 0:s.options.projectId);const a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new Fd(Md.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Id(a)}e._authCredentials=new Bd(new Pd(t,n))}}(r,...e)}return r}(lS),dS=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fr(),t=arguments.length>1?arguments[1]:void 0;e=kn(e);const n=_r(e,nw).getImmediate({identifier:t}),r=nn("storage");return r&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:s}=r;s&&(e._overrideAuthToken="string"===typeof s?s:on(s,e.app.options.projectId))}(e,t,n,r)}(n,...r),n}(lS),hS=async()=>{try{return await iS()?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fr();return iS().then((e=>{if(!e)throw jk.create("unsupported-browser")}),(e=>{throw jk.create("indexed-db-unsupported")})),_r(kn(e),"messaging").getImmediate()}(lS):(console.log("Firebase Cloud Messaging is not supported in this environment"),null)}catch(e){return console.error("Error initializing Firebase Cloud Messaging:",e),null}},pS=(0,A.createContext)();function fS(){return(0,A.useContext)(pS)}function mS(e){let{children:t}=e;const[n,r]=(0,A.useState)(null),[s,a]=(0,A.useState)(null),[i,o]=(0,A.useState)(!0),[l,u]=(0,A.useState)("");async function c(e){try{return(await za(uS,e)).length>0}catch(l){return console.error("Error checking email:",l),!1}}async function d(e){try{const t=Av(cS,"users",e),n=await _b(t);return n.exists()?{id:n.id,...n.data()}:(console.error("No user profile found"),null)}catch(l){return console.error("Error fetching user profile:",l),null}}(0,A.useEffect)((()=>{const e=function(e,t,n,r){return kn(e).onAuthStateChanged(t,n,r)}(uS,(async e=>{if(r(e),e)try{const t=await d(e.uid);a(t)}catch(l){console.error("Error in auth state change:",l)}else a(null);o(!1)}));return e}),[]);const h={currentUser:n,userProfile:s,loading:i,error:l,signup:async function(e,t,n,r,s){try{if(await c(e))throw{code:"auth/email-already-in-use"};const a=await async function(e,t,n){var r;const s=ia(e),a={returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"};let i;if(null===(r=s._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){const e=await ra(s,a,"signUpPassword");i=Aa(s,e)}else i=Aa(s,a).catch((async e=>{if("auth/missing-recaptcha-token"===e.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const e=await ra(s,a,"signUpPassword");return Aa(s,e)}return Promise.reject(e)}));const o=await i.catch((e=>Promise.reject(e))),l=await Ra._fromIdTokenResponse(s,"signIn",o);return await s._updateCurrentUser(l.user),l}(uS,e,t),i=a.user;return await Ba(i,{displayName:`${n} ${r}`}),await Ob(Av(cS,"users",i.uid),{firstName:n,lastName:r,email:e,role:s||"caregiver",createdAt:zb(),settings:{alertSensitivity:"medium",notificationPreferences:{email:!0,push:!0,sms:!1}}}),"patient"===s&&await Ob(Av(cS,"patients",i.uid),{userId:i.uid,firstName:n,lastName:r,email:e,primaryCaregiver:null,createdAt:zb(),lastActive:zb(),status:"active"}),i}catch(l){throw console.error("Registration error:",l),l}},login:function(e,t){return function(e,t,n){return La(kn(e),ka.credential(t,n))}(uS,e,t)},logout:function(){return kn(uS).signOut()},resetPassword:function(e){return async function(e,t,n){var r;const s=ia(e),a={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};if(null===(r=s._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){const e=await ra(s,a,"getOobCode",!0);n&&Pa(s,e,n),await ma(s,e)}else n&&Pa(s,a,n),await ma(s,a).catch((async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const e=await ra(s,a,"getOobCode",!0);n&&Pa(s,e,n),await ma(s,e)}}))}(uS,e)},updateUserEmail:function(e){return t=e,ja(kn(n),t,null);var t},updateUserPassword:function(e){return t=e,ja(kn(n),null,t);var t},updateUserProfile:async function(e){if(n)try{await Ob(Av(cS,"users",n.uid),{...e,updatedAt:zb()},{merge:!0});const t=await d(n.uid);return a(t),t}catch(l){throw console.error("Error updating profile:",l),l}},checkEmailExists:c};return(0,st.jsx)(pS.Provider,{value:h,children:!i&&t})}function gS(e){let{children:t}=e;const{currentUser:n,loading:r}=fS();return r?(0,st.jsx)("div",{children:"Loading..."}):n?t:(0,st.jsx)(je,{to:"/login"})}var yS=n(7950),vS=n.t(yS,2);function bS(){return bS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bS.apply(this,arguments)}function xS(e,t){if(null==e)return{};var n,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const wS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(Ipe){}new Map;const kS=R.startTransition;vS.flushSync,R.useId;function SS(e){let{basename:t,children:n,future:r,window:s}=e,a=A.useRef();var i;null==a.current&&(a.current=(void 0===(i={window:s,v5Compat:!0})&&(i={}),B((function(e,t){let{pathname:n,search:r,hash:s}=e.location;return L("",{pathname:n,search:r,hash:s},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:P(t)}),null,i)));let o=a.current,[l,u]=A.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},d=A.useCallback((e=>{c&&kS?kS((()=>u(e))):u(e)}),[u,c]);return A.useLayoutEffect((()=>o.listen(d)),[o,d]),A.useEffect((()=>Be(r)),[r]),A.createElement(Ve,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const IS="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,CS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,TS=A.forwardRef((function(e,t){let n,{onClick:r,relative:s,reloadDocument:a,replace:i,state:o,target:l,to:u,preventScrollReset:c,viewTransition:d}=e,h=xS(e,wS),{basename:p}=A.useContext(be),f=!1;if("string"===typeof u&&CS.test(u)&&(n=u,IS))try{let e=new URL(window.location.href),t=u.startsWith("//")?new URL(e.protocol+u):new URL(u),n=se(t.pathname,p);t.origin===e.origin&&null!=n?u=n+t.search+t.hash:f=!0}catch(Ipe){}let m=function(e,t){let{relative:n}=void 0===t?{}:t;Se()||D(!1);let{basename:r,navigator:s}=A.useContext(be),{hash:a,pathname:i,search:o}=Ne(e,{relative:n}),l=i;return"/"!==r&&(l="/"===i?r:ue([r,i])),s.createHref({pathname:l,search:o,hash:a})}(u,{relative:s}),g=function(e,t){let{target:n,replace:r,state:s,preventScrollReset:a,relative:i,viewTransition:o}=void 0===t?{}:t,l=Te(),u=Ie(),c=Ne(e,{relative:i});return A.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:P(u)===P(c);l(e,{replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o})}}),[u,l,c,r,s,n,e,a,i,o])}(u,{replace:i,state:o,target:l,preventScrollReset:c,relative:s,viewTransition:d});return A.createElement("a",bS({},h,{href:n||m,onClick:f||a?r:function(e){r&&r(e),e.defaultPrevented||g(e)},ref:t,target:l}))}));var NS,ES,AS,RS;(ES=NS||(NS={})).UseScrollRestoration="useScrollRestoration",ES.UseSubmit="useSubmit",ES.UseSubmitFetcher="useSubmitFetcher",ES.UseFetcher="useFetcher",ES.useViewTransitionState="useViewTransitionState",(RS=AS||(AS={})).UseFetcher="useFetcher",RS.UseFetchers="useFetchers",RS.UseScrollRestoration="useScrollRestoration";function _S(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const r={};return Object.keys(e).forEach((s=>{r[s]=e[s].reduce(((e,r)=>{if(r){const s=t(r);""!==s&&e.push(s),n&&n[r]&&e.push(n[r])}return e}),[]).join(" ")})),r}var $S=n(7598);function OS(e,t){const n=(0,He.A)({},t);return Object.keys(e).forEach((r=>{if(r.toString().match(/^(components|slots)$/))n[r]=(0,He.A)({},e[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const s=e[r]||{},a=t[r];n[r]={},a&&Object.keys(a)?s&&Object.keys(s)?(n[r]=(0,He.A)({},a),Object.keys(s).forEach((e=>{n[r][e]=OS(s[e],a[e])}))):n[r]=a:n[r]=s}else void 0===n[r]&&(n[r]=e[r])})),n}function DS(e){let{props:t,name:n,defaultTheme:r,themeId:s}=e,a=rt(r);s&&(a=a[s]||a);const i=function(e){const{theme:t,name:n,props:r}=e;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?OS(t.components[n].defaultProps,r):r}({theme:a,name:n,props:t});return i}const MS=["ownerState"],FS=["variants"],LS=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function PS(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const zS=(0,Ze.A)(),BS=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function jS(e){let{defaultTheme:t,theme:n,themeId:r}=e;return s=n,0===Object.keys(s).length?t:n[r]||n;var s}function US(e){return e?(t,n)=>n[e]:null}function VS(e,t){let{ownerState:n}=t,r=(0,qe.A)(t,MS);const s="function"===typeof e?e((0,He.A)({ownerState:n},r)):e;if(Array.isArray(s))return s.flatMap((e=>VS(e,(0,He.A)({ownerState:n},r))));if(s&&"object"===typeof s&&Array.isArray(s.variants)){const{variants:e=[]}=s;let t=(0,qe.A)(s,FS);return e.forEach((e=>{let s=!0;"function"===typeof e.props?s=e.props((0,He.A)({ownerState:n},r,n)):Object.keys(e.props).forEach((t=>{(null==n?void 0:n[t])!==e.props[t]&&r[t]!==e.props[t]&&(s=!1)})),s&&(Array.isArray(t)||(t=[t]),t.push("function"===typeof e.style?e.style((0,He.A)({ownerState:n},r,n)):e.style))})),t}return s}const WS=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=zS,rootShouldForwardProp:r=PS,slotShouldForwardProp:s=PS}=e,a=e=>(0,Qe.A)((0,He.A)({},e,{theme:jS((0,He.A)({},e,{defaultTheme:n,themeId:t}))}));return a.__mui_systemSx=!0,function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Ye.internal_processStyles)(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:o,slot:l,skipVariantsResolver:u,skipSx:c,overridesResolver:d=US(BS(l))}=i,h=(0,qe.A)(i,LS),p=void 0!==u?u:l&&"Root"!==l&&"root"!==l||!1,f=c||!1;let m=PS;"Root"===l||"root"===l?m=r:l?m=s:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(m=void 0);const g=(0,Ye.default)(e,(0,He.A)({shouldForwardProp:m,label:undefined},h)),y=e=>"function"===typeof e&&e.__emotion_real!==e||(0,ut.Q)(e)?r=>VS(e,(0,He.A)({},r,{theme:jS({theme:r.theme,defaultTheme:n,themeId:t})})):e,v=function(r){let s=y(r);for(var i=arguments.length,l=new Array(i>1?i-1:0),u=1;u<i;u++)l[u-1]=arguments[u];const c=l?l.map(y):[];o&&d&&c.push((e=>{const r=jS((0,He.A)({},e,{defaultTheme:n,themeId:t}));if(!r.components||!r.components[o]||!r.components[o].styleOverrides)return null;const s=r.components[o].styleOverrides,a={};return Object.entries(s).forEach((t=>{let[n,s]=t;a[n]=VS(s,(0,He.A)({},e,{theme:r}))})),d(e,a)})),o&&!p&&c.push((e=>{var r;const s=jS((0,He.A)({},e,{defaultTheme:n,themeId:t}));return VS({variants:null==s||null==(r=s.components)||null==(r=r[o])?void 0:r.variants},(0,He.A)({},e,{theme:s}))})),f||c.push(a);const h=c.length-l.length;if(Array.isArray(r)&&h>0){const e=new Array(h).fill("");s=[...r,...e],s.raw=[...r.raw,...e]}const m=g(s,...c);return e.muiName&&(m.muiName=e.muiName),m};return g.withConfig&&(v.withConfig=g.withConfig),v}}(),GS=["className","component","disableGutters","fixed","maxWidth","classes"],HS=(0,Ze.A)(),qS=WS("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`maxWidth${(0,$S.A)(String(n.maxWidth))}`],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),KS=e=>DS({props:e,name:"MuiContainer",defaultTheme:HS});const XS=$S.A;var YS=n(8052);const QS=Bt();const JS=function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e},ZS=e=>JS(e)&&"classes"!==e,eI=(0,YS.Ay)({themeId:jt,defaultTheme:QS,rootShouldForwardProp:ZS}),tI=A.createContext(void 0);function nI(e){let{props:t,name:n}=e;return function(e){const{theme:t,name:n,props:r}=e;if(!t||!t.components||!t.components[n])return r;const s=t.components[n];return s.defaultProps?OS(s.defaultProps,r):s.styleOverrides||s.variants?r:OS(s,r)}({props:t,name:n,theme:{components:A.useContext(tI)}})}const rI=function(e){let{value:t,children:n}=e;return(0,st.jsx)(tI.Provider,{value:t,children:n})};function sI(e){return nI(e)}const aI=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:t=qS,useThemeProps:n=KS,componentName:r="MuiContainer"}=e,s=t((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!n.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}})}),(e=>{let{theme:t,ownerState:n}=e;return n.fixed&&Object.keys(t.breakpoints.values).reduce(((e,n)=>{const r=n,s=t.breakpoints.values[r];return 0!==s&&(e[t.breakpoints.up(r)]={maxWidth:`${s}${t.breakpoints.unit}`}),e}),{})}),(e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({},"xs"===n.maxWidth&&{[t.breakpoints.up("xs")]:{maxWidth:Math.max(t.breakpoints.values.xs,444)}},n.maxWidth&&"xs"!==n.maxWidth&&{[t.breakpoints.up(n.maxWidth)]:{maxWidth:`${t.breakpoints.values[n.maxWidth]}${t.breakpoints.unit}`}})}));return A.forwardRef((function(e,t){const a=n(e),{className:i,component:o="div",disableGutters:l=!1,fixed:u=!1,maxWidth:c="lg"}=a,d=(0,qe.A)(a,GS),h=(0,He.A)({},a,{component:o,disableGutters:l,fixed:u,maxWidth:c}),p=((e,t)=>{const{classes:n,fixed:r,disableGutters:s,maxWidth:a}=e;return _S({root:["root",a&&`maxWidth${(0,$S.A)(String(a))}`,r&&"fixed",s&&"disableGutters"]},(e=>Vt(t,e)),n)})(h,r);return(0,st.jsx)(s,(0,He.A)({as:o,ownerState:h,className:Xe(p.root,i),ref:t},d))}))}({createStyledComponent:eI("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`maxWidth${XS(String(n.maxWidth))}`],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),useThemeProps:e=>sI({props:e,name:"MuiContainer"})});function iI(e){return Vt("MuiTypography",e)}Wt("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const oI=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],lI=eI("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],"inherit"!==n.align&&t[`align${XS(n.align)}`],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({margin:0},"inherit"===n.variant&&{font:"inherit"},"inherit"!==n.variant&&t.typography[n.variant],"inherit"!==n.align&&{textAlign:n.align},n.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.gutterBottom&&{marginBottom:"0.35em"},n.paragraph&&{marginBottom:16})})),uI={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},cI={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},dI=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiTypography"}),r=(e=>cI[e]||e)(n.color),s=(0,Je.A)((0,He.A)({},n,{color:r})),{align:a="inherit",className:i,component:o,gutterBottom:l=!1,noWrap:u=!1,paragraph:c=!1,variant:d="body1",variantMapping:h=uI}=s,p=(0,qe.A)(s,oI),f=(0,He.A)({},s,{align:a,color:r,className:i,component:o,gutterBottom:l,noWrap:u,paragraph:c,variant:d,variantMapping:h}),m=o||(c?"p":h[d]||uI[d])||"span",g=(e=>{const{align:t,gutterBottom:n,noWrap:r,paragraph:s,variant:a,classes:i}=e;return _S({root:["root",a,"inherit"!==e.align&&`align${XS(t)}`,n&&"gutterBottom",r&&"noWrap",s&&"paragraph"]},iI,i)})(f);return(0,st.jsx)(lI,(0,He.A)({as:m,ref:t,ownerState:f,className:Xe(g.root,i)},p))})),hI=dI,pI=e=>{let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,(t/100).toFixed(2)};function fI(e){return Vt("MuiPaper",e)}Wt("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const mI=["className","component","elevation","square","variant"],gI=eI("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],!n.square&&t.rounded,"elevation"===n.variant&&t[`elevation${n.elevation}`]]}})((e=>{let{theme:t,ownerState:n}=e;var r;return(0,He.A)({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!n.square&&{borderRadius:t.shape.borderRadius},"outlined"===n.variant&&{border:`1px solid ${(t.vars||t).palette.divider}`},"elevation"===n.variant&&(0,He.A)({boxShadow:(t.vars||t).shadows[n.elevation]},!t.vars&&"dark"===t.palette.mode&&{backgroundImage:`linear-gradient(${(0,dt.X4)("#fff",pI(n.elevation))}, ${(0,dt.X4)("#fff",pI(n.elevation))})`},t.vars&&{backgroundImage:null==(r=t.vars.overlays)?void 0:r[n.elevation]}))})),yI=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiPaper"}),{className:r,component:s="div",elevation:a=1,square:i=!1,variant:o="elevation"}=n,l=(0,qe.A)(n,mI),u=(0,He.A)({},n,{component:s,elevation:a,square:i,variant:o}),c=(e=>{const{square:t,elevation:n,variant:r,classes:s}=e;return _S({root:["root",r,!t&&"rounded","elevation"===r&&`elevation${n}`]},fI,s)})(u);return(0,st.jsx)(gI,(0,He.A)({as:s,ownerState:u,className:Xe(c.root,r),ref:t},l))})),vI=yI;function bI(e){return Vt("MuiCard",e)}Wt("MuiCard",["root"]);const xI=["className","raised"],wI=eI(vI,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),kI=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiCard"}),{className:r,raised:s=!1}=n,a=(0,qe.A)(n,xI),i=(0,He.A)({},n,{raised:s}),o=(e=>{const{classes:t}=e;return _S({root:["root"]},bI,t)})(i);return(0,st.jsx)(wI,(0,He.A)({className:Xe(o.root,r),elevation:s?8:void 0,ref:t,ownerState:i},a))}));function SI(e){return Vt("MuiCardContent",e)}Wt("MuiCardContent",["root"]);const II=["className","component"],CI=eI("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),TI=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiCardContent"}),{className:r,component:s="div"}=n,a=(0,qe.A)(n,II),i=(0,He.A)({},n,{component:s}),o=(e=>{const{classes:t}=e;return _S({root:["root"]},SI,t)})(i);return(0,st.jsx)(CI,(0,He.A)({as:s,className:Xe(o.root,r),ownerState:i,ref:t},a))}));function NI(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function EI(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return A.useMemo((()=>t.every((e=>null==e))?null:e=>{t.forEach((t=>{NI(t,e)}))}),t)}const AI=function(e){return"string"===typeof e};const RI=function(e,t,n){return void 0===e||AI(e)?t:(0,He.A)({},t,{ownerState:(0,He.A)({},t.ownerState,n)})};const _I=function(e,t,n){return"function"===typeof e?e(t,n):e};const $I=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const n={};return Object.keys(e).filter((n=>n.match(/^on[A-Z]/)&&"function"===typeof e[n]&&!t.includes(n))).forEach((t=>{n[t]=e[t]})),n};const OI=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t]))).forEach((n=>{t[n]=e[n]})),t};const DI=function(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:s,className:a}=e;if(!t){const e=Xe(null==n?void 0:n.className,a,null==s?void 0:s.className,null==r?void 0:r.className),t=(0,He.A)({},null==n?void 0:n.style,null==s?void 0:s.style,null==r?void 0:r.style),i=(0,He.A)({},n,s,r);return e.length>0&&(i.className=e),Object.keys(t).length>0&&(i.style=t),{props:i,internalRef:void 0}}const i=$I((0,He.A)({},s,r)),o=OI(r),l=OI(s),u=t(i),c=Xe(null==u?void 0:u.className,null==n?void 0:n.className,a,null==s?void 0:s.className,null==r?void 0:r.className),d=(0,He.A)({},null==u?void 0:u.style,null==n?void 0:n.style,null==s?void 0:s.style,null==r?void 0:r.style),h=(0,He.A)({},u,n,l,o);return c.length>0&&(h.className=c),Object.keys(d).length>0&&(h.style=d),{props:h,internalRef:u.ref}},MI=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],FI=["component","slots","slotProps"],LI=["component"];function PI(e,t){const{className:n,elementType:r,ownerState:s,externalForwardedProps:a,getSlotOwnerState:i,internalForwardedProps:o}=t,l=(0,qe.A)(t,MI),{component:u,slots:c={[e]:void 0},slotProps:d={[e]:void 0}}=a,h=(0,qe.A)(a,FI),p=c[e]||r,f=_I(d[e],s),m=DI((0,He.A)({className:n},l,{externalForwardedProps:"root"===e?h:void 0,externalSlotProps:f})),{props:{component:g},internalRef:y}=m,v=(0,qe.A)(m.props,LI),b=EI(y,null==f?void 0:f.ref,t.ref),x=i?i(v):{},w=(0,He.A)({},s,x),k="root"===e?g||u:g,S=RI(p,(0,He.A)({},"root"===e&&!u&&!c[e]&&o,"root"!==e&&!c[e]&&o,v,k&&{as:k},{ref:b}),w);return Object.keys(x).forEach((e=>{delete S[e]})),[p,S]}function zI(e){return Vt("MuiAlert",e)}const BI=Wt("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),jI=EI,UI="undefined"!==typeof window?A.useLayoutEffect:A.useEffect;const VI=function(e){const t=A.useRef(e);return UI((()=>{t.current=e})),A.useRef((function(){return(0,t.current)(...arguments)})).current},WI=VI,GI={};const HI=[];class qI{constructor(){this.currentId=null,this.clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new qI}start(e,t){this.clear(),this.currentId=setTimeout((()=>{this.currentId=null,t()}),e)}}function KI(){const e=function(e,t){const n=A.useRef(GI);return n.current===GI&&(n.current=e(t)),n}(qI.create).current;var t;return t=e.disposeEffect,A.useEffect(t,HI),e}let XI=!0,YI=!1;const QI=new qI,JI={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function ZI(e){e.metaKey||e.altKey||e.ctrlKey||(XI=!0)}function eC(){XI=!1}function tC(){"hidden"===this.visibilityState&&YI&&(XI=!0)}function nC(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch(n){}return XI||function(e){const{type:t,tagName:n}=e;return!("INPUT"!==n||!JI[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}function rC(){const e=A.useCallback((e=>{var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",ZI,!0),t.addEventListener("mousedown",eC,!0),t.addEventListener("pointerdown",eC,!0),t.addEventListener("touchstart",eC,!0),t.addEventListener("visibilitychange",tC,!0))}),[]),t=A.useRef(!1);return{isFocusVisibleRef:t,onFocus:function(e){return!!nC(e)&&(t.current=!0,!0)},onBlur:function(){return!!t.current&&(YI=!0,QI.start(100,(()=>{YI=!1})),t.current=!1,!0)},ref:e}}const sC=rC;function aC(e,t){return aC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},aC(e,t)}function iC(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,aC(e,t)}const oC=A.createContext(null);function lC(e,t){var n=Object.create(null);return e&&A.Children.map(e,(function(e){return e})).forEach((function(e){n[e.key]=function(e){return t&&(0,A.isValidElement)(e)?t(e):e}(e)})),n}function uC(e,t,n){return null!=n[t]?n[t]:e.props[t]}function cC(e,t,n){var r=lC(e.children),s=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,s=Object.create(null),a=[];for(var i in e)i in t?a.length&&(s[i]=a,a=[]):a.push(i);var o={};for(var l in t){if(s[l])for(r=0;r<s[l].length;r++){var u=s[l][r];o[s[l][r]]=n(u)}o[l]=n(l)}for(r=0;r<a.length;r++)o[a[r]]=n(a[r]);return o}(t,r);return Object.keys(s).forEach((function(a){var i=s[a];if((0,A.isValidElement)(i)){var o=a in t,l=a in r,u=t[a],c=(0,A.isValidElement)(u)&&!u.props.in;!l||o&&!c?l||!o||c?l&&o&&(0,A.isValidElement)(u)&&(s[a]=(0,A.cloneElement)(i,{onExited:n.bind(null,i),in:u.props.in,exit:uC(i,"exit",e),enter:uC(i,"enter",e)})):s[a]=(0,A.cloneElement)(i,{in:!1}):s[a]=(0,A.cloneElement)(i,{onExited:n.bind(null,i),in:!0,exit:uC(i,"exit",e),enter:uC(i,"enter",e)})}})),s}var dC=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},hC=function(e){function t(t,n){var r,s=(r=e.call(this,t,n)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r));return r.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},r}iC(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var n,r,s=t.children,a=t.handleExited;return{children:t.firstRender?(n=e,r=a,lC(n.children,(function(e){return(0,A.cloneElement)(e,{onExited:r.bind(null,e),in:!0,appear:uC(e,"appear",n),enter:uC(e,"enter",n),exit:uC(e,"exit",n)})}))):cC(e,s,a),firstRender:!1}},n.handleExited=function(e,t){var n=lC(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=(0,He.A)({},t.children);return delete n[e.key],{children:n}})))},n.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=(0,qe.A)(e,["component","childFactory"]),s=this.state.contextValue,a=dC(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?A.createElement(oC.Provider,{value:s},a):A.createElement(oC.Provider,{value:s},A.createElement(t,r,a))},t}(A.Component);hC.propTypes={},hC.defaultProps={component:"div",childFactory:function(e){return e}};const pC=hC;var fC=n(3290);const mC=function(e){const{className:t,classes:n,pulsate:r=!1,rippleX:s,rippleY:a,rippleSize:i,in:o,onExited:l,timeout:u}=e,[c,d]=A.useState(!1),h=Xe(t,n.ripple,n.rippleVisible,r&&n.ripplePulsate),p={width:i,height:i,top:-i/2+a,left:-i/2+s},f=Xe(n.child,c&&n.childLeaving,r&&n.childPulsate);return o||c||d(!0),A.useEffect((()=>{if(!o&&null!=l){const e=setTimeout(l,u);return()=>{clearTimeout(e)}}}),[l,o,u]),(0,st.jsx)("span",{className:h,style:p,children:(0,st.jsx)("span",{className:f})})};const gC=Wt("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),yC=["center","classes","className"];let vC,bC,xC,wC,kC=e=>e;const SC=(0,fC.i7)(vC||(vC=kC`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),IC=(0,fC.i7)(bC||(bC=kC`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),CC=(0,fC.i7)(xC||(xC=kC`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),TC=eI("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),NC=eI(mC,{name:"MuiTouchRipple",slot:"Ripple"})(wC||(wC=kC`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),gC.rippleVisible,SC,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),gC.ripplePulsate,(e=>{let{theme:t}=e;return t.transitions.duration.shorter}),gC.child,gC.childLeaving,IC,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),gC.childPulsate,CC,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut})),EC=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiTouchRipple"}),{center:r=!1,classes:s={},className:a}=n,i=(0,qe.A)(n,yC),[o,l]=A.useState([]),u=A.useRef(0),c=A.useRef(null);A.useEffect((()=>{c.current&&(c.current(),c.current=null)}),[o]);const d=A.useRef(!1),h=KI(),p=A.useRef(null),f=A.useRef(null),m=A.useCallback((e=>{const{pulsate:t,rippleX:n,rippleY:r,rippleSize:a,cb:i}=e;l((e=>[...e,(0,st.jsx)(NC,{classes:{ripple:Xe(s.ripple,gC.ripple),rippleVisible:Xe(s.rippleVisible,gC.rippleVisible),ripplePulsate:Xe(s.ripplePulsate,gC.ripplePulsate),child:Xe(s.child,gC.child),childLeaving:Xe(s.childLeaving,gC.childLeaving),childPulsate:Xe(s.childPulsate,gC.childPulsate)},timeout:550,pulsate:t,rippleX:n,rippleY:r,rippleSize:a},u.current)])),u.current+=1,c.current=i}),[s]),g=A.useCallback((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};const{pulsate:s=!1,center:a=r||t.pulsate,fakeElement:i=!1}=t;if("mousedown"===(null==e?void 0:e.type)&&d.current)return void(d.current=!1);"touchstart"===(null==e?void 0:e.type)&&(d.current=!0);const o=i?null:f.current,l=o?o.getBoundingClientRect():{width:0,height:0,left:0,top:0};let u,c,g;if(a||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)u=Math.round(l.width/2),c=Math.round(l.height/2);else{const{clientX:t,clientY:n}=e.touches&&e.touches.length>0?e.touches[0]:e;u=Math.round(t-l.left),c=Math.round(n-l.top)}if(a)g=Math.sqrt((2*l.width**2+l.height**2)/3),g%2===0&&(g+=1);else{const e=2*Math.max(Math.abs((o?o.clientWidth:0)-u),u)+2,t=2*Math.max(Math.abs((o?o.clientHeight:0)-c),c)+2;g=Math.sqrt(e**2+t**2)}null!=e&&e.touches?null===p.current&&(p.current=()=>{m({pulsate:s,rippleX:u,rippleY:c,rippleSize:g,cb:n})},h.start(80,(()=>{p.current&&(p.current(),p.current=null)}))):m({pulsate:s,rippleX:u,rippleY:c,rippleSize:g,cb:n})}),[r,m,h]),y=A.useCallback((()=>{g({},{pulsate:!0})}),[g]),v=A.useCallback(((e,t)=>{if(h.clear(),"touchend"===(null==e?void 0:e.type)&&p.current)return p.current(),p.current=null,void h.start(0,(()=>{v(e,t)}));p.current=null,l((e=>e.length>0?e.slice(1):e)),c.current=t}),[h]);return A.useImperativeHandle(t,(()=>({pulsate:y,start:g,stop:v})),[y,g,v]),(0,st.jsx)(TC,(0,He.A)({className:Xe(gC.root,s.root,a),ref:f},i,{children:(0,st.jsx)(pC,{component:null,exit:!0,children:o})}))}));function AC(e){return Vt("MuiButtonBase",e)}const RC=Wt("MuiButtonBase",["root","disabled","focusVisible"]),_C=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],$C=eI("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${RC.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),OC=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiButtonBase"}),{action:r,centerRipple:s=!1,children:a,className:i,component:o="button",disabled:l=!1,disableRipple:u=!1,disableTouchRipple:c=!1,focusRipple:d=!1,LinkComponent:h="a",onBlur:p,onClick:f,onContextMenu:m,onDragLeave:g,onFocus:y,onFocusVisible:v,onKeyDown:b,onKeyUp:x,onMouseDown:w,onMouseLeave:k,onMouseUp:S,onTouchEnd:I,onTouchMove:C,onTouchStart:T,tabIndex:N=0,TouchRippleProps:E,touchRippleRef:R,type:_}=n,$=(0,qe.A)(n,_C),O=A.useRef(null),D=A.useRef(null),M=jI(D,R),{isFocusVisibleRef:F,onFocus:L,onBlur:P,ref:z}=sC(),[B,j]=A.useState(!1);l&&B&&j(!1),A.useImperativeHandle(r,(()=>({focusVisible:()=>{j(!0),O.current.focus()}})),[]);const[U,V]=A.useState(!1);A.useEffect((()=>{V(!0)}),[]);const W=U&&!u&&!l;function G(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c;return WI((r=>{t&&t(r);return!n&&D.current&&D.current[e](r),!0}))}A.useEffect((()=>{B&&d&&!u&&U&&D.current.pulsate()}),[u,d,B,U]);const H=G("start",w),q=G("stop",m),K=G("stop",g),X=G("stop",S),Y=G("stop",(e=>{B&&e.preventDefault(),k&&k(e)})),Q=G("start",T),J=G("stop",I),Z=G("stop",C),ee=G("stop",(e=>{P(e),!1===F.current&&j(!1),p&&p(e)}),!1),te=WI((e=>{O.current||(O.current=e.currentTarget),L(e),!0===F.current&&(j(!0),v&&v(e)),y&&y(e)})),ne=()=>{const e=O.current;return o&&"button"!==o&&!("A"===e.tagName&&e.href)},re=A.useRef(!1),se=WI((e=>{d&&!re.current&&B&&D.current&&" "===e.key&&(re.current=!0,D.current.stop(e,(()=>{D.current.start(e)}))),e.target===e.currentTarget&&ne()&&" "===e.key&&e.preventDefault(),b&&b(e),e.target===e.currentTarget&&ne()&&"Enter"===e.key&&!l&&(e.preventDefault(),f&&f(e))})),ae=WI((e=>{d&&" "===e.key&&D.current&&B&&!e.defaultPrevented&&(re.current=!1,D.current.stop(e,(()=>{D.current.pulsate(e)}))),x&&x(e),f&&e.target===e.currentTarget&&ne()&&" "===e.key&&!e.defaultPrevented&&f(e)}));let ie=o;"button"===ie&&($.href||$.to)&&(ie=h);const oe={};"button"===ie?(oe.type=void 0===_?"button":_,oe.disabled=l):($.href||$.to||(oe.role="button"),l&&(oe["aria-disabled"]=l));const le=jI(t,z,O);const ue=(0,He.A)({},n,{centerRipple:s,component:o,disabled:l,disableRipple:u,disableTouchRipple:c,focusRipple:d,tabIndex:N,focusVisible:B}),ce=(e=>{const{disabled:t,focusVisible:n,focusVisibleClassName:r,classes:s}=e,a=_S({root:["root",t&&"disabled",n&&"focusVisible"]},AC,s);return n&&r&&(a.root+=` ${r}`),a})(ue);return(0,st.jsxs)($C,(0,He.A)({as:ie,className:Xe(ce.root,i),ownerState:ue,onBlur:ee,onClick:f,onContextMenu:q,onFocus:te,onKeyDown:se,onKeyUp:ae,onMouseDown:H,onMouseLeave:Y,onMouseUp:X,onDragLeave:K,onTouchEnd:J,onTouchMove:Z,onTouchStart:Q,ref:le,tabIndex:l?-1:N,type:_},oe,$,{children:[a,W?(0,st.jsx)(EC,(0,He.A)({ref:M,center:s},E)):null]}))}));function DC(e){return Vt("MuiIconButton",e)}const MC=Wt("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),FC=["edge","children","className","color","disabled","disableFocusRipple","size"],LC=eI(OC,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"default"!==n.color&&t[`color${XS(n.color)}`],n.edge&&t[`edge${XS(n.edge)}`],t[`size${XS(n.size)}`]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!n.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,dt.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===n.edge&&{marginLeft:"small"===n.size?-3:-12},"end"===n.edge&&{marginRight:"small"===n.size?-3:-12})}),(e=>{let{theme:t,ownerState:n}=e;var r;const s=null==(r=(t.vars||t).palette)?void 0:r[n.color];return(0,He.A)({},"inherit"===n.color&&{color:"inherit"},"inherit"!==n.color&&"default"!==n.color&&(0,He.A)({color:null==s?void 0:s.main},!n.disableRipple&&{"&:hover":(0,He.A)({},s&&{backgroundColor:t.vars?`rgba(${s.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,dt.X4)(s.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),"small"===n.size&&{padding:5,fontSize:t.typography.pxToRem(18)},"large"===n.size&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${MC.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})})),PC=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiIconButton"}),{edge:r=!1,children:s,className:a,color:i="default",disabled:o=!1,disableFocusRipple:l=!1,size:u="medium"}=n,c=(0,qe.A)(n,FC),d=(0,He.A)({},n,{edge:r,color:i,disabled:o,disableFocusRipple:l,size:u}),h=(e=>{const{classes:t,disabled:n,color:r,edge:s,size:a}=e;return _S({root:["root",n&&"disabled","default"!==r&&`color${XS(r)}`,s&&`edge${XS(s)}`,`size${XS(a)}`]},DC,t)})(d);return(0,st.jsx)(LC,(0,He.A)({className:Xe(h.root,a),centerRipple:!0,focusRipple:!l,disabled:o,ref:t},c,{ownerState:d,children:s}))}));function zC(e){return Vt("MuiSvgIcon",e)}Wt("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const BC=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],jC=eI("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"inherit"!==n.color&&t[`color${XS(n.color)}`],t[`fontSize${XS(n.fontSize)}`]]}})((e=>{let{theme:t,ownerState:n}=e;var r,s,a,i,o,l,u,c,d,h,p,f,m;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:n.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(r=t.transitions)||null==(s=r.create)?void 0:s.call(r,"fill",{duration:null==(a=t.transitions)||null==(a=a.duration)?void 0:a.shorter}),fontSize:{inherit:"inherit",small:(null==(i=t.typography)||null==(o=i.pxToRem)?void 0:o.call(i,20))||"1.25rem",medium:(null==(l=t.typography)||null==(u=l.pxToRem)?void 0:u.call(l,24))||"1.5rem",large:(null==(c=t.typography)||null==(d=c.pxToRem)?void 0:d.call(c,35))||"2.1875rem"}[n.fontSize],color:null!=(h=null==(p=(t.vars||t).palette)||null==(p=p[n.color])?void 0:p.main)?h:{action:null==(f=(t.vars||t).palette)||null==(f=f.action)?void 0:f.active,disabled:null==(m=(t.vars||t).palette)||null==(m=m.action)?void 0:m.disabled,inherit:void 0}[n.color]}})),UC=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiSvgIcon"}),{children:r,className:s,color:a="inherit",component:i="svg",fontSize:o="medium",htmlColor:l,inheritViewBox:u=!1,titleAccess:c,viewBox:d="0 0 24 24"}=n,h=(0,qe.A)(n,BC),p=A.isValidElement(r)&&"svg"===r.type,f=(0,He.A)({},n,{color:a,component:i,fontSize:o,instanceFontSize:e.fontSize,inheritViewBox:u,viewBox:d,hasSvgAsChild:p}),m={};u||(m.viewBox=d);const g=(e=>{const{color:t,fontSize:n,classes:r}=e;return _S({root:["root","inherit"!==t&&`color${XS(t)}`,`fontSize${XS(n)}`]},zC,r)})(f);return(0,st.jsxs)(jC,(0,He.A)({as:i,className:Xe(g.root,s),focusable:"false",color:l,"aria-hidden":!c||void 0,role:c?"img":void 0,ref:t},m,h,p&&r.props,{ownerState:f,children:[p?r.props.children:r,c?(0,st.jsx)("title",{children:c}):null]}))}));UC.muiName="SvgIcon";const VC=UC;function WC(e,t){function n(n,r){return(0,st.jsx)(VC,(0,He.A)({"data-testid":`${t}Icon`,ref:r},n,{children:e}))}return n.muiName=VC.muiName,A.memo(A.forwardRef(n))}const GC=WC((0,st.jsx)("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),HC=WC((0,st.jsx)("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),qC=WC((0,st.jsx)("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),KC=WC((0,st.jsx)("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),XC=WC((0,st.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),YC=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],QC=eI(vI,{name:"MuiAlert",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${XS(n.color||n.severity)}`]]}})((e=>{let{theme:t}=e;const n="light"===t.palette.mode?dt.e$:dt.a,r="light"===t.palette.mode?dt.a:dt.e$;return(0,He.A)({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.light})).map((e=>{let[s]=e;return{props:{colorSeverity:s,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${s}Color`]:n(t.palette[s].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${s}StandardBg`]:r(t.palette[s].light,.9),[`& .${BI.icon}`]:t.vars?{color:t.vars.palette.Alert[`${s}IconColor`]}:{color:t.palette[s].main}}}})),...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.light})).map((e=>{let[r]=e;return{props:{colorSeverity:r,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${r}Color`]:n(t.palette[r].light,.6),border:`1px solid ${(t.vars||t).palette[r].light}`,[`& .${BI.icon}`]:t.vars?{color:t.vars.palette.Alert[`${r}IconColor`]}:{color:t.palette[r].main}}}})),...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.dark})).map((e=>{let[n]=e;return{props:{colorSeverity:n,variant:"filled"},style:(0,He.A)({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${n}FilledColor`],backgroundColor:t.vars.palette.Alert[`${n}FilledBg`]}:{backgroundColor:"dark"===t.palette.mode?t.palette[n].dark:t.palette[n].main,color:t.palette.getContrastText(t.palette[n].main)})}}))]})})),JC=eI("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,t)=>t.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),ZC=eI("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),eT=eI("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),tT={success:(0,st.jsx)(GC,{fontSize:"inherit"}),warning:(0,st.jsx)(HC,{fontSize:"inherit"}),error:(0,st.jsx)(qC,{fontSize:"inherit"}),info:(0,st.jsx)(KC,{fontSize:"inherit"})},nT=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiAlert"}),{action:r,children:s,className:a,closeText:i="Close",color:o,components:l={},componentsProps:u={},icon:c,iconMapping:d=tT,onClose:h,role:p="alert",severity:f="success",slotProps:m={},slots:g={},variant:y="standard"}=n,v=(0,qe.A)(n,YC),b=(0,He.A)({},n,{color:o,severity:f,variant:y,colorSeverity:o||f}),x=(e=>{const{variant:t,color:n,severity:r,classes:s}=e;return _S({root:["root",`color${XS(n||r)}`,`${t}${XS(n||r)}`,`${t}`],icon:["icon"],message:["message"],action:["action"]},zI,s)})(b),w={slots:(0,He.A)({closeButton:l.CloseButton,closeIcon:l.CloseIcon},g),slotProps:(0,He.A)({},u,m)},[k,S]=PI("closeButton",{elementType:PC,externalForwardedProps:w,ownerState:b}),[I,C]=PI("closeIcon",{elementType:XC,externalForwardedProps:w,ownerState:b});return(0,st.jsxs)(QC,(0,He.A)({role:p,elevation:0,ownerState:b,className:Xe(x.root,a),ref:t},v,{children:[!1!==c?(0,st.jsx)(JC,{ownerState:b,className:x.icon,children:c||d[f]||tT[f]}):null,(0,st.jsx)(ZC,{ownerState:b,className:x.message,children:s}),null!=r?(0,st.jsx)(eT,{ownerState:b,className:x.action,children:r}):null,null==r&&h?(0,st.jsx)(eT,{ownerState:b,className:x.action,children:(0,st.jsx)(k,(0,He.A)({size:"small","aria-label":i,title:i,color:"inherit",onClick:h},S,{children:(0,st.jsx)(I,(0,He.A)({fontSize:"small"},C))}))}):null]}))})),rT=nT;let sT=0;const aT=R["useId".toString()];function iT(e){if(void 0!==aT){const t=aT();return null!=e?e:t}return function(e){const[t,n]=A.useState(e),r=e||t;return A.useEffect((()=>{null==t&&(sT+=1,n(`mui-${sT}`))}),[t]),r}(e)}function oT(e){return e&&e.ownerDocument||document}function lT(e){return oT(e).defaultView||window}function uT(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];clearTimeout(t),t=setTimeout((()=>{e.apply(this,s)}),n)}return r.clear=()=>{clearTimeout(t)},r}const cT=["onChange","maxRows","minRows","style","value"];function dT(e){return parseInt(e,10)||0}const hT={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};function pT(e){return function(e){for(const t in e)return!1;return!0}(e)||0===e.outerHeightStyle&&!e.overflowing}const fT=A.forwardRef((function(e,t){const{onChange:n,maxRows:r,minRows:s=1,style:a,value:i}=e,o=(0,qe.A)(e,cT),{current:l}=A.useRef(null!=i),u=A.useRef(null),c=EI(t,u),d=A.useRef(null),h=A.useRef(null),p=A.useCallback((()=>{const t=u.current,n=h.current;if(!t||!n)return;const a=lT(t).getComputedStyle(t);if("0px"===a.width)return{outerHeightStyle:0,overflowing:!1};n.style.width=a.width,n.value=t.value||e.placeholder||"x","\n"===n.value.slice(-1)&&(n.value+=" ");const i=a.boxSizing,o=dT(a.paddingBottom)+dT(a.paddingTop),l=dT(a.borderBottomWidth)+dT(a.borderTopWidth),c=n.scrollHeight;n.value="x";const d=n.scrollHeight;let p=c;s&&(p=Math.max(Number(s)*d,p)),r&&(p=Math.min(Number(r)*d,p)),p=Math.max(p,d);return{outerHeightStyle:p+("border-box"===i?o+l:0),overflowing:Math.abs(p-c)<=1}}),[r,s,e.placeholder]),f=VI((()=>{const e=u.current,t=p();if(!e||!t||pT(t))return!1;const n=t.outerHeightStyle;return null!=d.current&&d.current!==n})),m=A.useCallback((()=>{const e=u.current,t=p();if(!e||!t||pT(t))return;const n=t.outerHeightStyle;d.current!==n&&(d.current=n,e.style.height=`${n}px`),e.style.overflow=t.overflowing?"hidden":""}),[p]),g=A.useRef(-1);UI((()=>{const e=uT(m),t=null==u?void 0:u.current;if(!t)return;const n=lT(t);let r;return n.addEventListener("resize",e),"undefined"!==typeof ResizeObserver&&(r=new ResizeObserver((()=>{f()&&(r.unobserve(t),cancelAnimationFrame(g.current),m(),g.current=requestAnimationFrame((()=>{r.observe(t)})))})),r.observe(t)),()=>{e.clear(),cancelAnimationFrame(g.current),n.removeEventListener("resize",e),r&&r.disconnect()}}),[p,m,f]),UI((()=>{m()}));return(0,st.jsxs)(A.Fragment,{children:[(0,st.jsx)("textarea",(0,He.A)({value:i,onChange:e=>{l||m(),n&&n(e)},ref:c,rows:s,style:a},o)),(0,st.jsx)("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:h,tabIndex:-1,style:(0,He.A)({},hT,a,{paddingTop:0,paddingBottom:0})})]})}));function mT(e){let{props:t,states:n,muiFormControl:r}=e;return n.reduce(((e,n)=>(e[n]=t[n],r&&"undefined"===typeof t[n]&&(e[n]=r[n]),e)),{})}const gT=A.createContext(void 0);function yT(){return A.useContext(gT)}const vT=UI;var bT=n(869);const xT=function(e){let{styles:t,themeId:n,defaultTheme:r={}}=e;const s=rt(r),a="function"===typeof t?t(n&&s[n]||s):t;return(0,st.jsx)(bT.A,{styles:a})};const wT=function(e){return(0,st.jsx)(xT,(0,He.A)({},e,{defaultTheme:QS,themeId:jt}))};function kT(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function ST(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(kT(e.value)&&""!==e.value||t&&kT(e.defaultValue)&&""!==e.defaultValue)}function IT(e){return Vt("MuiInputBase",e)}const CT=Wt("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),TT=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],NT=(e,t)=>{const{ownerState:n}=e;return[t.root,n.formControl&&t.formControl,n.startAdornment&&t.adornedStart,n.endAdornment&&t.adornedEnd,n.error&&t.error,"small"===n.size&&t.sizeSmall,n.multiline&&t.multiline,n.color&&t[`color${XS(n.color)}`],n.fullWidth&&t.fullWidth,n.hiddenLabel&&t.hiddenLabel]},ET=(e,t)=>{const{ownerState:n}=e;return[t.input,"small"===n.size&&t.inputSizeSmall,n.multiline&&t.inputMultiline,"search"===n.type&&t.inputTypeSearch,n.startAdornment&&t.inputAdornedStart,n.endAdornment&&t.inputAdornedEnd,n.hiddenLabel&&t.inputHiddenLabel]},AT=eI("div",{name:"MuiInputBase",slot:"Root",overridesResolver:NT})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${CT.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},n.multiline&&(0,He.A)({padding:"4px 0 5px"},"small"===n.size&&{paddingTop:1}),n.fullWidth&&{width:"100%"})})),RT=eI("input",{name:"MuiInputBase",slot:"Input",overridesResolver:ET})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode,s=(0,He.A)({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),a={opacity:"0 !important"},i=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return(0,He.A)({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${CT.formControl} &`]:{"&::-webkit-input-placeholder":a,"&::-moz-placeholder":a,"&:-ms-input-placeholder":a,"&::-ms-input-placeholder":a,"&:focus::-webkit-input-placeholder":i,"&:focus::-moz-placeholder":i,"&:focus:-ms-input-placeholder":i,"&:focus::-ms-input-placeholder":i},[`&.${CT.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},"small"===n.size&&{paddingTop:1},n.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},"search"===n.type&&{MozAppearance:"textfield"})})),_T=(0,st.jsx)(wT,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),$T=A.forwardRef((function(e,t){var n;const r=sI({props:e,name:"MuiInputBase"}),{"aria-describedby":s,autoComplete:a,autoFocus:i,className:o,components:l={},componentsProps:u={},defaultValue:c,disabled:d,disableInjectingGlobalStyles:h,endAdornment:p,fullWidth:f=!1,id:m,inputComponent:g="input",inputProps:y={},inputRef:v,maxRows:b,minRows:x,multiline:w=!1,name:k,onBlur:S,onChange:I,onClick:C,onFocus:T,onKeyDown:N,onKeyUp:E,placeholder:R,readOnly:_,renderSuffix:$,rows:O,slotProps:D={},slots:M={},startAdornment:F,type:L="text",value:P}=r,z=(0,qe.A)(r,TT),B=null!=y.value?y.value:P,{current:j}=A.useRef(null!=B),U=A.useRef(),V=A.useCallback((e=>{0}),[]),W=jI(U,v,y.ref,V),[G,H]=A.useState(!1),q=yT();const K=mT({props:r,muiFormControl:q,states:["color","disabled","error","hiddenLabel","size","required","filled"]});K.focused=q?q.focused:G,A.useEffect((()=>{!q&&d&&G&&(H(!1),S&&S())}),[q,d,G,S]);const X=q&&q.onFilled,Y=q&&q.onEmpty,Q=A.useCallback((e=>{ST(e)?X&&X():Y&&Y()}),[X,Y]);vT((()=>{j&&Q({value:B})}),[B,Q,j]);A.useEffect((()=>{Q(U.current)}),[]);let J=g,Z=y;w&&"input"===J&&(Z=O?(0,He.A)({type:void 0,minRows:O,maxRows:O},Z):(0,He.A)({type:void 0,maxRows:b,minRows:x},Z),J=fT);A.useEffect((()=>{q&&q.setAdornedStart(Boolean(F))}),[q,F]);const ee=(0,He.A)({},r,{color:K.color||"primary",disabled:K.disabled,endAdornment:p,error:K.error,focused:K.focused,formControl:q,fullWidth:f,hiddenLabel:K.hiddenLabel,multiline:w,size:K.size,startAdornment:F,type:L}),te=(e=>{const{classes:t,color:n,disabled:r,error:s,endAdornment:a,focused:i,formControl:o,fullWidth:l,hiddenLabel:u,multiline:c,readOnly:d,size:h,startAdornment:p,type:f}=e;return _S({root:["root",`color${XS(n)}`,r&&"disabled",s&&"error",l&&"fullWidth",i&&"focused",o&&"formControl",h&&"medium"!==h&&`size${XS(h)}`,c&&"multiline",p&&"adornedStart",a&&"adornedEnd",u&&"hiddenLabel",d&&"readOnly"],input:["input",r&&"disabled","search"===f&&"inputTypeSearch",c&&"inputMultiline","small"===h&&"inputSizeSmall",u&&"inputHiddenLabel",p&&"inputAdornedStart",a&&"inputAdornedEnd",d&&"readOnly"]},IT,t)})(ee),ne=M.root||l.Root||AT,re=D.root||u.root||{},se=M.input||l.Input||RT;return Z=(0,He.A)({},Z,null!=(n=D.input)?n:u.input),(0,st.jsxs)(A.Fragment,{children:[!h&&_T,(0,st.jsxs)(ne,(0,He.A)({},re,!AI(ne)&&{ownerState:(0,He.A)({},ee,re.ownerState)},{ref:t,onClick:e=>{U.current&&e.currentTarget===e.target&&U.current.focus(),C&&C(e)}},z,{className:Xe(te.root,re.className,o,_&&"MuiInputBase-readOnly"),children:[F,(0,st.jsx)(gT.Provider,{value:null,children:(0,st.jsx)(se,(0,He.A)({ownerState:ee,"aria-invalid":K.error,"aria-describedby":s,autoComplete:a,autoFocus:i,defaultValue:c,disabled:K.disabled,id:m,onAnimationStart:e=>{Q("mui-auto-fill-cancel"===e.animationName?U.current:{value:"x"})},name:k,placeholder:R,readOnly:_,required:K.required,rows:O,value:B,onKeyDown:N,onKeyUp:E,type:L},Z,!AI(se)&&{as:J,ownerState:(0,He.A)({},ee,Z.ownerState)},{ref:W,className:Xe(te.input,Z.className,_&&"MuiInputBase-readOnly"),onBlur:e=>{S&&S(e),y.onBlur&&y.onBlur(e),q&&q.onBlur?q.onBlur(e):H(!1)},onChange:function(e){if(!j){const t=e.target||U.current;if(null==t)throw new Error((0,lt.A)(1));Q({value:t.value})}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];y.onChange&&y.onChange(e,...n),I&&I(e,...n)},onFocus:e=>{K.disabled?e.stopPropagation():(T&&T(e),y.onFocus&&y.onFocus(e),q&&q.onFocus?q.onFocus(e):H(!0))}}))}),p,$?$((0,He.A)({},K,{startAdornment:F})):null]}))]})}));function OT(e){return Vt("MuiInput",e)}const DT=(0,He.A)({},CT,Wt("MuiInput",["root","underline","input"])),MT=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],FT=eI(AT,{shouldForwardProp:e=>ZS(e)||"classes"===e,name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...NT(e,t),!n.disableUnderline&&t.underline]}})((e=>{let{theme:t,ownerState:n}=e;let r="light"===t.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),(0,He.A)({position:"relative"},n.formControl&&{"label + &":{marginTop:16}},!n.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[n.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${DT.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${DT.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${DT.disabled}, .${DT.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${DT.disabled}:before`]:{borderBottomStyle:"dotted"}})})),LT=eI(RT,{name:"MuiInput",slot:"Input",overridesResolver:ET})({}),PT=A.forwardRef((function(e,t){var n,r,s,a;const i=sI({props:e,name:"MuiInput"}),{disableUnderline:o,components:l={},componentsProps:u,fullWidth:c=!1,inputComponent:d="input",multiline:h=!1,slotProps:p,slots:f={},type:m="text"}=i,g=(0,qe.A)(i,MT),y=(e=>{const{classes:t,disableUnderline:n}=e,r=_S({root:["root",!n&&"underline"],input:["input"]},OT,t);return(0,He.A)({},t,r)})(i),v={root:{ownerState:{disableUnderline:o}}},b=(null!=p?p:u)?(0,ut.A)(null!=p?p:u,v):v,x=null!=(n=null!=(r=f.root)?r:l.Root)?n:FT,w=null!=(s=null!=(a=f.input)?a:l.Input)?s:LT;return(0,st.jsx)($T,(0,He.A)({slots:{root:x,input:w},slotProps:b,fullWidth:c,inputComponent:d,multiline:h,ref:t,type:m},g,{classes:y}))}));PT.muiName="Input";const zT=PT;function BT(e){return Vt("MuiFilledInput",e)}const jT=(0,He.A)({},CT,Wt("MuiFilledInput",["root","underline","input"])),UT=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],VT=eI(AT,{shouldForwardProp:e=>ZS(e)||"classes"===e,name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...NT(e,t),!n.disableUnderline&&t.underline]}})((e=>{let{theme:t,ownerState:n}=e;var r;const s="light"===t.palette.mode,a=s?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",i=s?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",o=s?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",l=s?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return(0,He.A)({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:o,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i}},[`&.${jT.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i},[`&.${jT.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:l}},!n.disableUnderline&&{"&::after":{borderBottom:`2px solid ${null==(r=(t.vars||t).palette[n.color||"primary"])?void 0:r.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${jT.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${jT.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:a}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${jT.disabled}, .${jT.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${jT.disabled}:before`]:{borderBottomStyle:"dotted"}},n.startAdornment&&{paddingLeft:12},n.endAdornment&&{paddingRight:12},n.multiline&&(0,He.A)({padding:"25px 12px 8px"},"small"===n.size&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.hiddenLabel&&"small"===n.size&&{paddingTop:8,paddingBottom:9}))})),WT=eI(RT,{name:"MuiFilledInput",slot:"Input",overridesResolver:ET})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===n.size&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0},n.hiddenLabel&&"small"===n.size&&{paddingTop:8,paddingBottom:9},n.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})})),GT=A.forwardRef((function(e,t){var n,r,s,a;const i=sI({props:e,name:"MuiFilledInput"}),{components:o={},componentsProps:l,fullWidth:u=!1,inputComponent:c="input",multiline:d=!1,slotProps:h,slots:p={},type:f="text"}=i,m=(0,qe.A)(i,UT),g=(0,He.A)({},i,{fullWidth:u,inputComponent:c,multiline:d,type:f}),y=(e=>{const{classes:t,disableUnderline:n}=e,r=_S({root:["root",!n&&"underline"],input:["input"]},BT,t);return(0,He.A)({},t,r)})(i),v={root:{ownerState:g},input:{ownerState:g}},b=(null!=h?h:l)?(0,ut.A)(v,null!=h?h:l):v,x=null!=(n=null!=(r=p.root)?r:o.Root)?n:VT,w=null!=(s=null!=(a=p.input)?a:o.Input)?s:WT;return(0,st.jsx)($T,(0,He.A)({slots:{root:x,input:w},componentsProps:b,fullWidth:u,inputComponent:c,multiline:d,ref:t,type:f},m,{classes:y}))}));GT.muiName="Input";const HT=GT;var qT;const KT=["children","classes","className","label","notched"],XT=eI("fieldset",{shouldForwardProp:ZS})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),YT=eI("legend",{shouldForwardProp:ZS})((e=>{let{ownerState:t,theme:n}=e;return(0,He.A)({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:n.transitions.create("width",{duration:150,easing:n.transitions.easing.easeOut})},t.withLabel&&(0,He.A)({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:n.transitions.create("max-width",{duration:50,easing:n.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:n.transitions.create("max-width",{duration:100,easing:n.transitions.easing.easeOut,delay:50})}))}));function QT(e){return Vt("MuiOutlinedInput",e)}const JT=(0,He.A)({},CT,Wt("MuiOutlinedInput",["root","notchedOutline","input"])),ZT=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],eN=eI(AT,{shouldForwardProp:e=>ZS(e)||"classes"===e,name:"MuiOutlinedInput",slot:"Root",overridesResolver:NT})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return(0,He.A)({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${JT.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${JT.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${JT.focused} .${JT.notchedOutline}`]:{borderColor:(t.vars||t).palette[n.color].main,borderWidth:2},[`&.${JT.error} .${JT.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${JT.disabled} .${JT.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},n.startAdornment&&{paddingLeft:14},n.endAdornment&&{paddingRight:14},n.multiline&&(0,He.A)({padding:"16.5px 14px"},"small"===n.size&&{padding:"8.5px 14px"}))})),tN=eI((function(e){const{className:t,label:n,notched:r}=e,s=(0,qe.A)(e,KT),a=null!=n&&""!==n,i=(0,He.A)({},e,{notched:r,withLabel:a});return(0,st.jsx)(XT,(0,He.A)({"aria-hidden":!0,className:t,ownerState:i},s,{children:(0,st.jsx)(YT,{ownerState:i,children:a?(0,st.jsx)("span",{children:n}):qT||(qT=(0,st.jsx)("span",{className:"notranslate",children:"\u200b"}))})}))}),{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})((e=>{let{theme:t}=e;const n="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}})),nN=eI(RT,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:ET})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===n.size&&{padding:"8.5px 14px"},n.multiline&&{padding:0},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0})})),rN=A.forwardRef((function(e,t){var n,r,s,a,i;const o=sI({props:e,name:"MuiOutlinedInput"}),{components:l={},fullWidth:u=!1,inputComponent:c="input",label:d,multiline:h=!1,notched:p,slots:f={},type:m="text"}=o,g=(0,qe.A)(o,ZT),y=(e=>{const{classes:t}=e,n=_S({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},QT,t);return(0,He.A)({},t,n)})(o),v=yT(),b=mT({props:o,muiFormControl:v,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),x=(0,He.A)({},o,{color:b.color||"primary",disabled:b.disabled,error:b.error,focused:b.focused,formControl:v,fullWidth:u,hiddenLabel:b.hiddenLabel,multiline:h,size:b.size,type:m}),w=null!=(n=null!=(r=f.root)?r:l.Root)?n:eN,k=null!=(s=null!=(a=f.input)?a:l.Input)?s:nN;return(0,st.jsx)($T,(0,He.A)({slots:{root:w,input:k},renderSuffix:e=>(0,st.jsx)(tN,{ownerState:x,className:y.notchedOutline,label:null!=d&&""!==d&&b.required?i||(i=(0,st.jsxs)(A.Fragment,{children:[d,"\u2009","*"]})):d,notched:"undefined"!==typeof p?p:Boolean(e.startAdornment||e.filled||e.focused)}),fullWidth:u,inputComponent:c,multiline:h,ref:t,type:m},g,{classes:(0,He.A)({},y,{notchedOutline:null})}))}));rN.muiName="Input";const sN=rN;function aN(e){return Vt("MuiFormLabel",e)}const iN=Wt("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),oN=["children","className","color","component","disabled","error","filled","focused","required"],lN=eI("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return(0,He.A)({},t.root,"secondary"===n.color&&t.colorSecondary,n.filled&&t.filled)}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${iN.focused}`]:{color:(t.vars||t).palette[n.color].main},[`&.${iN.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${iN.error}`]:{color:(t.vars||t).palette.error.main}})})),uN=eI("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((e=>{let{theme:t}=e;return{[`&.${iN.error}`]:{color:(t.vars||t).palette.error.main}}})),cN=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiFormLabel"}),{children:r,className:s,component:a="label"}=n,i=(0,qe.A)(n,oN),o=mT({props:n,muiFormControl:yT(),states:["color","required","focused","disabled","error","filled"]}),l=(0,He.A)({},n,{color:o.color||"primary",component:a,disabled:o.disabled,error:o.error,filled:o.filled,focused:o.focused,required:o.required}),u=(e=>{const{classes:t,color:n,focused:r,disabled:s,error:a,filled:i,required:o}=e;return _S({root:["root",`color${XS(n)}`,s&&"disabled",a&&"error",i&&"filled",r&&"focused",o&&"required"],asterisk:["asterisk",a&&"error"]},aN,t)})(l);return(0,st.jsxs)(lN,(0,He.A)({as:a,ownerState:l,className:Xe(u.root,s),ref:t},i,{children:[r,o.required&&(0,st.jsxs)(uN,{ownerState:l,"aria-hidden":!0,className:u.asterisk,children:["\u2009","*"]})]}))}));function dN(e){return Vt("MuiInputLabel",e)}Wt("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const hN=["disableAnimation","margin","shrink","variant","className"],pN=eI(cN,{shouldForwardProp:e=>ZS(e)||"classes"===e,name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${iN.asterisk}`]:t.asterisk},t.root,n.formControl&&t.formControl,"small"===n.size&&t.sizeSmall,n.shrink&&t.shrink,!n.disableAnimation&&t.animated,n.focused&&t.focused,t[n.variant]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},n.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},"small"===n.size&&{transform:"translate(0, 17px) scale(1)"},n.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!n.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},"filled"===n.variant&&(0,He.A)({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(12px, 13px) scale(1)"},n.shrink&&(0,He.A)({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},"small"===n.size&&{transform:"translate(12px, 4px) scale(0.75)"})),"outlined"===n.variant&&(0,He.A)({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(14px, 9px) scale(1)"},n.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))})),fN=A.forwardRef((function(e,t){const n=sI({name:"MuiInputLabel",props:e}),{disableAnimation:r=!1,shrink:s,className:a}=n,i=(0,qe.A)(n,hN),o=yT();let l=s;"undefined"===typeof l&&o&&(l=o.filled||o.focused||o.adornedStart);const u=mT({props:n,muiFormControl:o,states:["size","variant","required","focused"]}),c=(0,He.A)({},n,{disableAnimation:r,formControl:o,shrink:l,size:u.size,variant:u.variant,required:u.required,focused:u.focused}),d=(e=>{const{classes:t,formControl:n,size:r,shrink:s,disableAnimation:a,variant:i,required:o}=e,l=_S({root:["root",n&&"formControl",!a&&"animated",s&&"shrink",r&&"normal"!==r&&`size${XS(r)}`,i],asterisk:[o&&"asterisk"]},dN,t);return(0,He.A)({},t,l)})(c);return(0,st.jsx)(pN,(0,He.A)({"data-shrink":l,ownerState:c,ref:t,className:Xe(d.root,a)},i,{classes:d}))})),mN=fN;const gN=function(e,t){var n,r;return A.isValidElement(e)&&-1!==t.indexOf(null!=(n=e.type.muiName)?n:null==(r=e.type)||null==(r=r._payload)||null==(r=r.value)?void 0:r.muiName)};function yN(e){return Vt("MuiFormControl",e)}Wt("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const vN=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],bN=eI("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return(0,He.A)({},t.root,t[`margin${XS(n.margin)}`],n.fullWidth&&t.fullWidth)}})((e=>{let{ownerState:t}=e;return(0,He.A)({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},"normal"===t.margin&&{marginTop:16,marginBottom:8},"dense"===t.margin&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})})),xN=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiFormControl"}),{children:r,className:s,color:a="primary",component:i="div",disabled:o=!1,error:l=!1,focused:u,fullWidth:c=!1,hiddenLabel:d=!1,margin:h="none",required:p=!1,size:f="medium",variant:m="outlined"}=n,g=(0,qe.A)(n,vN),y=(0,He.A)({},n,{color:a,component:i,disabled:o,error:l,fullWidth:c,hiddenLabel:d,margin:h,required:p,size:f,variant:m}),v=(e=>{const{classes:t,margin:n,fullWidth:r}=e;return _S({root:["root","none"!==n&&`margin${XS(n)}`,r&&"fullWidth"]},yN,t)})(y),[b,x]=A.useState((()=>{let e=!1;return r&&A.Children.forEach(r,(t=>{if(!gN(t,["Input","Select"]))return;const n=gN(t,["Select"])?t.props.input:t;n&&n.props.startAdornment&&(e=!0)})),e})),[w,k]=A.useState((()=>{let e=!1;return r&&A.Children.forEach(r,(t=>{gN(t,["Input","Select"])&&(ST(t.props,!0)||ST(t.props.inputProps,!0))&&(e=!0)})),e})),[S,I]=A.useState(!1);o&&S&&I(!1);const C=void 0===u||o?S:u;let T;const N=A.useMemo((()=>({adornedStart:b,setAdornedStart:x,color:a,disabled:o,error:l,filled:w,focused:C,fullWidth:c,hiddenLabel:d,size:f,onBlur:()=>{I(!1)},onEmpty:()=>{k(!1)},onFilled:()=>{k(!0)},onFocus:()=>{I(!0)},registerEffect:T,required:p,variant:m})),[b,a,o,l,w,C,c,d,T,p,f,m]);return(0,st.jsx)(gT.Provider,{value:N,children:(0,st.jsx)(bN,(0,He.A)({as:i,ownerState:y,className:Xe(v.root,s),ref:t},g,{children:r}))})})),wN=xN;function kN(e){return Vt("MuiFormHelperText",e)}const SN=Wt("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var IN;const CN=["children","className","component","disabled","error","filled","focused","margin","required","variant"],TN=eI("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.size&&t[`size${XS(n.size)}`],n.contained&&t.contained,n.filled&&t.filled]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${SN.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${SN.error}`]:{color:(t.vars||t).palette.error.main}},"small"===n.size&&{marginTop:4},n.contained&&{marginLeft:14,marginRight:14})})),NN=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiFormHelperText"}),{children:r,className:s,component:a="p"}=n,i=(0,qe.A)(n,CN),o=mT({props:n,muiFormControl:yT(),states:["variant","size","disabled","error","filled","focused","required"]}),l=(0,He.A)({},n,{component:a,contained:"filled"===o.variant||"outlined"===o.variant,variant:o.variant,size:o.size,disabled:o.disabled,error:o.error,filled:o.filled,focused:o.focused,required:o.required}),u=(e=>{const{classes:t,contained:n,size:r,disabled:s,error:a,filled:i,focused:o,required:l}=e;return _S({root:["root",s&&"disabled",a&&"error",r&&`size${XS(r)}`,n&&"contained",o&&"focused",i&&"filled",l&&"required"]},kN,t)})(l);return(0,st.jsx)(TN,(0,He.A)({as:a,ownerState:l,className:Xe(u.root,s),ref:t},i,{children:" "===r?IN||(IN=(0,st.jsx)("span",{className:"notranslate",children:"\u200b"})):r}))}));function EN(e){var t;return parseInt(A.version,10)>=19?(null==e||null==(t=e.props)?void 0:t.ref)||null:(null==e?void 0:e.ref)||null}const AN=oT,RN=["value"],_N=A.createContext();const $N=()=>{const e=A.useContext(_N);return null!=e&&e},ON=function(e){let{value:t}=e,n=(0,qe.A)(e,RN);return(0,st.jsx)(_N.Provider,(0,He.A)({value:null==t||t},n))},DN=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];const MN=function(e){var t;const{elementType:n,externalSlotProps:r,ownerState:s,skipResolvingSlotProps:a=!1}=e,i=(0,qe.A)(e,DN),o=a?{}:_I(r,s),{props:l,internalRef:u}=DI((0,He.A)({},i,{externalSlotProps:o})),c=EI(u,null==o?void 0:o.ref,null==(t=e.additionalProps)?void 0:t.ref);return RI(n,(0,He.A)({},l,{ref:c}),s)};const FN=A.createContext({});function LN(e){return Vt("MuiList",e)}Wt("MuiList",["root","padding","dense","subheader"]);const PN=["children","className","component","dense","disablePadding","subheader"],zN=eI("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disablePadding&&t.padding,n.dense&&t.dense,n.subheader&&t.subheader]}})((e=>{let{ownerState:t}=e;return(0,He.A)({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})})),BN=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiList"}),{children:r,className:s,component:a="ul",dense:i=!1,disablePadding:o=!1,subheader:l}=n,u=(0,qe.A)(n,PN),c=A.useMemo((()=>({dense:i})),[i]),d=(0,He.A)({},n,{component:a,dense:i,disablePadding:o}),h=(e=>{const{classes:t,disablePadding:n,dense:r,subheader:s}=e;return _S({root:["root",!n&&"padding",r&&"dense",s&&"subheader"]},LN,t)})(d);return(0,st.jsx)(FN.Provider,{value:c,children:(0,st.jsxs)(zN,(0,He.A)({as:a,className:Xe(h.root,s),ref:t,ownerState:d},u,{children:[l,r]}))})}));function jN(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}const UN=jN,VN=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function WN(e,t,n){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:n?null:e.firstChild}function GN(e,t,n){return e===t?n?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:n?null:e.lastChild}function HN(e,t){if(void 0===t)return!0;let n=e.innerText;return void 0===n&&(n=e.textContent),n=n.trim().toLowerCase(),0!==n.length&&(t.repeating?n[0]===t.keys[0]:0===n.indexOf(t.keys.join("")))}function qN(e,t,n,r,s,a){let i=!1,o=s(e,t,!!t&&n);for(;o;){if(o===e.firstChild){if(i)return!1;i=!0}const t=!r&&(o.disabled||"true"===o.getAttribute("aria-disabled"));if(o.hasAttribute("tabindex")&&HN(o,a)&&!t)return o.focus(),!0;o=s(e,o,n)}return!1}const KN=A.forwardRef((function(e,t){const{actions:n,autoFocus:r=!1,autoFocusItem:s=!1,children:a,className:i,disabledItemsFocusable:o=!1,disableListWrap:l=!1,onKeyDown:u,variant:c="selectedMenu"}=e,d=(0,qe.A)(e,VN),h=A.useRef(null),p=A.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});vT((()=>{r&&h.current.focus()}),[r]),A.useImperativeHandle(n,(()=>({adjustStyleForScrollbar:(e,t)=>{let{direction:n}=t;const r=!h.current.style.width;if(e.clientHeight<h.current.clientHeight&&r){const t=`${UN(AN(e))}px`;h.current.style["rtl"===n?"paddingLeft":"paddingRight"]=t,h.current.style.width=`calc(100% + ${t})`}return h.current}})),[]);const f=jI(h,t);let m=-1;A.Children.forEach(a,((e,t)=>{A.isValidElement(e)?(e.props.disabled||("selectedMenu"===c&&e.props.selected||-1===m)&&(m=t),m===t&&(e.props.disabled||e.props.muiSkipListHighlight||e.type.muiSkipListHighlight)&&(m+=1,m>=a.length&&(m=-1))):m===t&&(m+=1,m>=a.length&&(m=-1))}));const g=A.Children.map(a,((e,t)=>{if(t===m){const t={};return s&&(t.autoFocus=!0),void 0===e.props.tabIndex&&"selectedMenu"===c&&(t.tabIndex=0),A.cloneElement(e,t)}return e}));return(0,st.jsx)(BN,(0,He.A)({role:"menu",ref:f,className:i,onKeyDown:e=>{const t=h.current,n=e.key,r=AN(t).activeElement;if("ArrowDown"===n)e.preventDefault(),qN(t,r,l,o,WN);else if("ArrowUp"===n)e.preventDefault(),qN(t,r,l,o,GN);else if("Home"===n)e.preventDefault(),qN(t,null,l,o,WN);else if("End"===n)e.preventDefault(),qN(t,null,l,o,GN);else if(1===n.length){const s=p.current,a=n.toLowerCase(),i=performance.now();s.keys.length>0&&(i-s.lastTime>500?(s.keys=[],s.repeating=!0,s.previousKeyMatched=!0):s.repeating&&a!==s.keys[0]&&(s.repeating=!1)),s.lastTime=i,s.keys.push(a);const l=r&&!s.repeating&&HN(r,s);s.previousKeyMatched&&(l||qN(t,r,!1,o,WN,s))?e.preventDefault():s.previousKeyMatched=!1}u&&u(e)},tabIndex:r?0:-1},d,{children:g}))})),XN=KN,YN=uT,QN=lT,JN=!1;var ZN="unmounted",eE="exited",tE="entering",nE="entered",rE="exiting",sE=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var s,a=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?a?(s=eE,r.appearStatus=tE):s=nE:s=t.unmountOnExit||t.mountOnEnter?ZN:eE,r.state={status:s},r.nextCallback=null,r}iC(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===ZN?{status:eE}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==tE&&n!==nE&&(t=tE):n!==tE&&n!==nE||(t=rE)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===tE){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:yS.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===eE&&this.setState({status:ZN})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,s=this.props.nodeRef?[r]:[yS.findDOMNode(this),r],a=s[0],i=s[1],o=this.getTimeouts(),l=r?o.appear:o.enter;!e&&!n||JN?this.safeSetState({status:nE},(function(){t.props.onEntered(a)})):(this.props.onEnter(a,i),this.safeSetState({status:tE},(function(){t.props.onEntering(a,i),t.onTransitionEnd(l,(function(){t.safeSetState({status:nE},(function(){t.props.onEntered(a,i)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:yS.findDOMNode(this);t&&!JN?(this.props.onExit(r),this.safeSetState({status:rE},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:eE},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:eE},(function(){e.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:yS.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var s=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],a=s[0],i=s[1];this.props.addEndListener(a,i)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===ZN)return null;var t=this.props,n=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,qe.A)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return A.createElement(oC.Provider,{value:null},"function"===typeof n?n(e,r):A.cloneElement(A.Children.only(n),r))},t}(A.Component);function aE(){}sE.contextType=oC,sE.propTypes={},sE.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:aE,onEntering:aE,onEntered:aE,onExit:aE,onExiting:aE,onExited:aE},sE.UNMOUNTED=ZN,sE.EXITED=eE,sE.ENTERING=tE,sE.ENTERED=nE,sE.EXITING=rE;const iE=sE;function oE(){const e=rt(QS);return e[jt]||e}const lE=e=>e.scrollTop;function uE(e,t){var n,r;const{timeout:s,easing:a,style:i={}}=e;return{duration:null!=(n=i.transitionDuration)?n:"number"===typeof s?s:s[t.mode]||0,easing:null!=(r=i.transitionTimingFunction)?r:"object"===typeof a?a[t.mode]:a,delay:i.transitionDelay}}const cE=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function dE(e){return`scale(${e}, ${e**2})`}const hE={entering:{opacity:1,transform:dE(1)},entered:{opacity:1,transform:"none"}},pE="undefined"!==typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),fE=A.forwardRef((function(e,t){const{addEndListener:n,appear:r=!0,children:s,easing:a,in:i,onEnter:o,onEntered:l,onEntering:u,onExit:c,onExited:d,onExiting:h,style:p,timeout:f="auto",TransitionComponent:m=iE}=e,g=(0,qe.A)(e,cE),y=KI(),v=A.useRef(),b=oE(),x=A.useRef(null),w=jI(x,EN(s),t),k=e=>t=>{if(e){const n=x.current;void 0===t?e(n):e(n,t)}},S=k(u),I=k(((e,t)=>{lE(e);const{duration:n,delay:r,easing:s}=uE({style:p,timeout:f,easing:a},{mode:"enter"});let i;"auto"===f?(i=b.transitions.getAutoHeightDuration(e.clientHeight),v.current=i):i=n,e.style.transition=[b.transitions.create("opacity",{duration:i,delay:r}),b.transitions.create("transform",{duration:pE?i:.666*i,delay:r,easing:s})].join(","),o&&o(e,t)})),C=k(l),T=k(h),N=k((e=>{const{duration:t,delay:n,easing:r}=uE({style:p,timeout:f,easing:a},{mode:"exit"});let s;"auto"===f?(s=b.transitions.getAutoHeightDuration(e.clientHeight),v.current=s):s=t,e.style.transition=[b.transitions.create("opacity",{duration:s,delay:n}),b.transitions.create("transform",{duration:pE?s:.666*s,delay:pE?n:n||.333*s,easing:r})].join(","),e.style.opacity=0,e.style.transform=dE(.75),c&&c(e)})),E=k(d);return(0,st.jsx)(m,(0,He.A)({appear:r,in:i,nodeRef:x,onEnter:I,onEntered:C,onEntering:S,onExit:N,onExited:E,onExiting:T,addEndListener:e=>{"auto"===f&&y.start(v.current||0,e),n&&n(x.current,e)},timeout:"auto"===f?null:f},g,{children:(e,t)=>A.cloneElement(s,(0,He.A)({style:(0,He.A)({opacity:0,transform:dE(.75),visibility:"exited"!==e||i?void 0:"hidden"},hE[e],p,s.props.style),ref:w},t))}))}));fE.muiSupportAuto=!0;const mE=fE,gE=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function yE(e){const t=[],n=[];return Array.from(e.querySelectorAll(gE)).forEach(((e,r)=>{const s=function(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?"true"===e.contentEditable||("AUDIO"===e.nodeName||"VIDEO"===e.nodeName||"DETAILS"===e.nodeName)&&null===e.getAttribute("tabindex")?0:e.tabIndex:t}(e);-1!==s&&function(e){return!(e.disabled||"INPUT"===e.tagName&&"hidden"===e.type||function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return!1;if(!e.name)return!1;const t=t=>e.ownerDocument.querySelector(`input[type="radio"]${t}`);let n=t(`[name="${e.name}"]:checked`);return n||(n=t(`[name="${e.name}"]`)),n!==e}(e))}(e)&&(0===s?t.push(e):n.push({documentOrder:r,tabIndex:s,node:e}))})),n.sort(((e,t)=>e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex)).map((e=>e.node)).concat(t)}function vE(){return!0}const bE=function(e){const{children:t,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:s=!1,getTabbable:a=yE,isEnabled:i=vE,open:o}=e,l=A.useRef(!1),u=A.useRef(null),c=A.useRef(null),d=A.useRef(null),h=A.useRef(null),p=A.useRef(!1),f=A.useRef(null),m=EI(EN(t),f),g=A.useRef(null);A.useEffect((()=>{o&&f.current&&(p.current=!n)}),[n,o]),A.useEffect((()=>{if(!o||!f.current)return;const e=oT(f.current);return f.current.contains(e.activeElement)||(f.current.hasAttribute("tabIndex")||f.current.setAttribute("tabIndex","-1"),p.current&&f.current.focus()),()=>{s||(d.current&&d.current.focus&&(l.current=!0,d.current.focus()),d.current=null)}}),[o]),A.useEffect((()=>{if(!o||!f.current)return;const e=oT(f.current),t=t=>{g.current=t,!r&&i()&&"Tab"===t.key&&e.activeElement===f.current&&t.shiftKey&&(l.current=!0,c.current&&c.current.focus())},n=()=>{const t=f.current;if(null===t)return;if(!e.hasFocus()||!i()||l.current)return void(l.current=!1);if(t.contains(e.activeElement))return;if(r&&e.activeElement!==u.current&&e.activeElement!==c.current)return;if(e.activeElement!==h.current)h.current=null;else if(null!==h.current)return;if(!p.current)return;let n=[];if(e.activeElement!==u.current&&e.activeElement!==c.current||(n=a(f.current)),n.length>0){var s,o;const e=Boolean((null==(s=g.current)?void 0:s.shiftKey)&&"Tab"===(null==(o=g.current)?void 0:o.key)),t=n[0],r=n[n.length-1];"string"!==typeof t&&"string"!==typeof r&&(e?r.focus():t.focus())}else t.focus()};e.addEventListener("focusin",n),e.addEventListener("keydown",t,!0);const s=setInterval((()=>{e.activeElement&&"BODY"===e.activeElement.tagName&&n()}),50);return()=>{clearInterval(s),e.removeEventListener("focusin",n),e.removeEventListener("keydown",t,!0)}}),[n,r,s,i,o,a]);const y=e=>{null===d.current&&(d.current=e.relatedTarget),p.current=!0};return(0,st.jsxs)(A.Fragment,{children:[(0,st.jsx)("div",{tabIndex:o?0:-1,onFocus:y,ref:u,"data-testid":"sentinelStart"}),A.cloneElement(t,{ref:m,onFocus:e=>{null===d.current&&(d.current=e.relatedTarget),p.current=!0,h.current=e.target;const n=t.props.onFocus;n&&n(e)}}),(0,st.jsx)("div",{tabIndex:o?0:-1,onFocus:y,ref:c,"data-testid":"sentinelEnd"})]})};const xE=A.forwardRef((function(e,t){const{children:n,container:r,disablePortal:s=!1}=e,[a,i]=A.useState(null),o=EI(A.isValidElement(n)?EN(n):null,t);if(UI((()=>{s||i(function(e){return"function"===typeof e?e():e}(r)||document.body)}),[r,s]),UI((()=>{if(a&&!s)return NI(t,a),()=>{NI(t,null)}}),[t,a,s]),s){if(A.isValidElement(n)){const e={ref:o};return A.cloneElement(n,e)}return(0,st.jsx)(A.Fragment,{children:n})}return(0,st.jsx)(A.Fragment,{children:a?yS.createPortal(n,a):a})})),wE=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],kE={entering:{opacity:1},entered:{opacity:1}},SE=A.forwardRef((function(e,t){const n=oE(),r={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:s,appear:a=!0,children:i,easing:o,in:l,onEnter:u,onEntered:c,onEntering:d,onExit:h,onExited:p,onExiting:f,style:m,timeout:g=r,TransitionComponent:y=iE}=e,v=(0,qe.A)(e,wE),b=A.useRef(null),x=jI(b,EN(i),t),w=e=>t=>{if(e){const n=b.current;void 0===t?e(n):e(n,t)}},k=w(d),S=w(((e,t)=>{lE(e);const r=uE({style:m,timeout:g,easing:o},{mode:"enter"});e.style.webkitTransition=n.transitions.create("opacity",r),e.style.transition=n.transitions.create("opacity",r),u&&u(e,t)})),I=w(c),C=w(f),T=w((e=>{const t=uE({style:m,timeout:g,easing:o},{mode:"exit"});e.style.webkitTransition=n.transitions.create("opacity",t),e.style.transition=n.transitions.create("opacity",t),h&&h(e)})),N=w(p);return(0,st.jsx)(y,(0,He.A)({appear:a,in:l,nodeRef:b,onEnter:S,onEntered:I,onEntering:k,onExit:T,onExited:N,onExiting:C,addEndListener:e=>{s&&s(b.current,e)},timeout:g},v,{children:(e,t)=>A.cloneElement(i,(0,He.A)({style:(0,He.A)({opacity:0,visibility:"exited"!==e||l?void 0:"hidden"},kE[e],m,i.props.style),ref:x},t))}))})),IE=SE;function CE(e){return Vt("MuiBackdrop",e)}Wt("MuiBackdrop",["root","invisible"]);const TE=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],NE=eI("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.invisible&&t.invisible]}})((e=>{let{ownerState:t}=e;return(0,He.A)({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})})),EE=A.forwardRef((function(e,t){var n,r,s;const a=sI({props:e,name:"MuiBackdrop"}),{children:i,className:o,component:l="div",components:u={},componentsProps:c={},invisible:d=!1,open:h,slotProps:p={},slots:f={},TransitionComponent:m=IE,transitionDuration:g}=a,y=(0,qe.A)(a,TE),v=(0,He.A)({},a,{component:l,invisible:d}),b=(e=>{const{classes:t,invisible:n}=e;return _S({root:["root",n&&"invisible"]},CE,t)})(v),x=null!=(n=p.root)?n:c.root;return(0,st.jsx)(m,(0,He.A)({in:h,timeout:g},y,{children:(0,st.jsx)(NE,(0,He.A)({"aria-hidden":!0},x,{as:null!=(r=null!=(s=f.root)?s:u.Root)?r:l,className:Xe(b.root,o,null==x?void 0:x.className),ownerState:(0,He.A)({},v,null==x?void 0:x.ownerState),classes:b,ref:t,children:i}))}))}));function AE(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>null==t?e:function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];e.apply(this,r),t.apply(this,r)}),(()=>{}))}function RE(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function _E(e){return parseInt(lT(e).getComputedStyle(e).paddingRight,10)||0}function $E(e,t,n,r,s){const a=[t,n,...r];[].forEach.call(e.children,(e=>{const t=-1===a.indexOf(e),n=!function(e){const t=-1!==["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName),n="INPUT"===e.tagName&&"hidden"===e.getAttribute("type");return t||n}(e);t&&n&&RE(e,s)}))}function OE(e,t){let n=-1;return e.some(((e,r)=>!!t(e)&&(n=r,!0))),n}function DE(e,t){const n=[],r=e.container;if(!t.disableScrollLock){if(function(e){const t=oT(e);return t.body===e?lT(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(r)){const e=jN(oT(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${_E(r)+e}px`;const t=oT(r).querySelectorAll(".mui-fixed");[].forEach.call(t,(t=>{n.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight=`${_E(t)+e}px`}))}let e;if(r.parentNode instanceof DocumentFragment)e=oT(r).body;else{const t=r.parentElement,n=lT(r);e="HTML"===(null==t?void 0:t.nodeName)&&"scroll"===n.getComputedStyle(t).overflowY?t:r}n.push({value:e.style.overflow,property:"overflow",el:e},{value:e.style.overflowX,property:"overflow-x",el:e},{value:e.style.overflowY,property:"overflow-y",el:e}),e.style.overflow="hidden"}return()=>{n.forEach((e=>{let{value:t,el:n,property:r}=e;t?n.style.setProperty(r,t):n.style.removeProperty(r)}))}}const ME=new class{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,t){let n=this.modals.indexOf(e);if(-1!==n)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&RE(e.modalRef,!1);const r=function(e){const t=[];return[].forEach.call(e.children,(e=>{"true"===e.getAttribute("aria-hidden")&&t.push(e)})),t}(t);$E(t,e.mount,e.modalRef,r,!0);const s=OE(this.containers,(e=>e.container===t));return-1!==s?(this.containers[s].modals.push(e),n):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblings:r}),n)}mount(e,t){const n=OE(this.containers,(t=>-1!==t.modals.indexOf(e))),r=this.containers[n];r.restore||(r.restore=DE(r,t))}remove(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.modals.indexOf(e);if(-1===n)return n;const r=OE(this.containers,(t=>-1!==t.modals.indexOf(e))),s=this.containers[r];if(s.modals.splice(s.modals.indexOf(e),1),this.modals.splice(n,1),0===s.modals.length)s.restore&&s.restore(),e.modalRef&&RE(e.modalRef,t),$E(s.container,e.mount,e.modalRef,s.hiddenSiblings,!1),this.containers.splice(r,1);else{const e=s.modals[s.modals.length-1];e.modalRef&&RE(e.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}};const FE=function(e){const{container:t,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:s=ME,closeAfterTransition:a=!1,onTransitionEnter:i,onTransitionExited:o,children:l,onClose:u,open:c,rootRef:d}=e,h=A.useRef({}),p=A.useRef(null),f=A.useRef(null),m=EI(f,d),[g,y]=A.useState(!c),v=function(e){return!!e&&e.props.hasOwnProperty("in")}(l);let b=!0;"false"!==e["aria-hidden"]&&!1!==e["aria-hidden"]||(b=!1);const x=()=>(h.current.modalRef=f.current,h.current.mount=p.current,h.current),w=()=>{s.mount(x(),{disableScrollLock:r}),f.current&&(f.current.scrollTop=0)},k=VI((()=>{const e=function(e){return"function"===typeof e?e():e}(t)||oT(p.current).body;s.add(x(),e),f.current&&w()})),S=A.useCallback((()=>s.isTopModal(x())),[s]),I=VI((e=>{p.current=e,e&&(c&&S()?w():f.current&&RE(f.current,b))})),C=A.useCallback((()=>{s.remove(x(),b)}),[b,s]);A.useEffect((()=>()=>{C()}),[C]),A.useEffect((()=>{c?k():v&&a||C()}),[c,C,v,a,k]);const T=e=>t=>{var r;null==(r=e.onKeyDown)||r.call(e,t),"Escape"===t.key&&229!==t.which&&S()&&(n||(t.stopPropagation(),u&&u(t,"escapeKeyDown")))},N=e=>t=>{var n;null==(n=e.onClick)||n.call(e,t),t.target===t.currentTarget&&u&&u(t,"backdropClick")};return{getRootProps:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=$I(e);delete n.onTransitionEnter,delete n.onTransitionExited;const r=(0,He.A)({},n,t);return(0,He.A)({role:"presentation"},r,{onKeyDown:T(r),ref:m})},getBackdropProps:function(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,He.A)({"aria-hidden":!0},e,{onClick:N(e),open:c})},getTransitionProps:()=>({onEnter:AE((()=>{y(!1),i&&i()}),null==l?void 0:l.props.onEnter),onExited:AE((()=>{y(!0),o&&o(),a&&C()}),null==l?void 0:l.props.onExited)}),rootRef:m,portalRef:I,isTopModal:S,exited:g,hasTransition:v}};function LE(e){return Vt("MuiModal",e)}Wt("MuiModal",["root","hidden","backdrop"]);const PE=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],zE=eI("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.open&&n.exited&&t.hidden]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!n.open&&n.exited&&{visibility:"hidden"})})),BE=eI(EE,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),jE=A.forwardRef((function(e,t){var n,r,s,a,i,o;const l=sI({name:"MuiModal",props:e}),{BackdropComponent:u=BE,BackdropProps:c,className:d,closeAfterTransition:h=!1,children:p,container:f,component:m,components:g={},componentsProps:y={},disableAutoFocus:v=!1,disableEnforceFocus:b=!1,disableEscapeKeyDown:x=!1,disablePortal:w=!1,disableRestoreFocus:k=!1,disableScrollLock:S=!1,hideBackdrop:I=!1,keepMounted:C=!1,onBackdropClick:T,open:N,slotProps:E,slots:R}=l,_=(0,qe.A)(l,PE),$=(0,He.A)({},l,{closeAfterTransition:h,disableAutoFocus:v,disableEnforceFocus:b,disableEscapeKeyDown:x,disablePortal:w,disableRestoreFocus:k,disableScrollLock:S,hideBackdrop:I,keepMounted:C}),{getRootProps:O,getBackdropProps:D,getTransitionProps:M,portalRef:F,isTopModal:L,exited:P,hasTransition:z}=FE((0,He.A)({},$,{rootRef:t})),B=(0,He.A)({},$,{exited:P}),j=(e=>{const{open:t,exited:n,classes:r}=e;return _S({root:["root",!t&&n&&"hidden"],backdrop:["backdrop"]},LE,r)})(B),U={};if(void 0===p.props.tabIndex&&(U.tabIndex="-1"),z){const{onEnter:e,onExited:t}=M();U.onEnter=e,U.onExited=t}const V=null!=(n=null!=(r=null==R?void 0:R.root)?r:g.Root)?n:zE,W=null!=(s=null!=(a=null==R?void 0:R.backdrop)?a:g.Backdrop)?s:u,G=null!=(i=null==E?void 0:E.root)?i:y.root,H=null!=(o=null==E?void 0:E.backdrop)?o:y.backdrop,q=MN({elementType:V,externalSlotProps:G,externalForwardedProps:_,getSlotProps:O,additionalProps:{ref:t,as:m},ownerState:B,className:Xe(d,null==G?void 0:G.className,null==j?void 0:j.root,!B.open&&B.exited&&(null==j?void 0:j.hidden))}),K=MN({elementType:W,externalSlotProps:H,additionalProps:c,getSlotProps:e=>D((0,He.A)({},e,{onClick:t=>{T&&T(t),null!=e&&e.onClick&&e.onClick(t)}})),className:Xe(null==H?void 0:H.className,null==c?void 0:c.className,null==j?void 0:j.backdrop),ownerState:B});return C||N||z&&!P?(0,st.jsx)(xE,{ref:F,container:f,disablePortal:w,children:(0,st.jsxs)(V,(0,He.A)({},q,{children:[!I&&u?(0,st.jsx)(W,(0,He.A)({},K)):null,(0,st.jsx)(bE,{disableEnforceFocus:b,disableAutoFocus:v,disableRestoreFocus:k,isEnabled:L,open:N,children:A.cloneElement(p,U)})]}))}):null}));function UE(e){return Vt("MuiPopover",e)}Wt("MuiPopover",["root","paper"]);const VE=["onEntering"],WE=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],GE=["slotProps"];function HE(e,t){let n=0;return"number"===typeof t?n=t:"center"===t?n=e.height/2:"bottom"===t&&(n=e.height),n}function qE(e,t){let n=0;return"number"===typeof t?n=t:"center"===t?n=e.width/2:"right"===t&&(n=e.width),n}function KE(e){return[e.horizontal,e.vertical].map((e=>"number"===typeof e?`${e}px`:e)).join(" ")}function XE(e){return"function"===typeof e?e():e}const YE=eI(jE,{name:"MuiPopover",slot:"Root",overridesResolver:(e,t)=>t.root})({}),QE=eI(vI,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,t)=>t.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),JE=A.forwardRef((function(e,t){var n,r,s;const a=sI({props:e,name:"MuiPopover"}),{action:i,anchorEl:o,anchorOrigin:l={vertical:"top",horizontal:"left"},anchorPosition:u,anchorReference:c="anchorEl",children:d,className:h,container:p,elevation:f=8,marginThreshold:m=16,open:g,PaperProps:y={},slots:v,slotProps:b,transformOrigin:x={vertical:"top",horizontal:"left"},TransitionComponent:w=mE,transitionDuration:k="auto",TransitionProps:{onEntering:S}={},disableScrollLock:I=!1}=a,C=(0,qe.A)(a.TransitionProps,VE),T=(0,qe.A)(a,WE),N=null!=(n=null==b?void 0:b.paper)?n:y,E=A.useRef(),R=jI(E,N.ref),_=(0,He.A)({},a,{anchorOrigin:l,anchorReference:c,elevation:f,marginThreshold:m,externalPaperSlotProps:N,transformOrigin:x,TransitionComponent:w,transitionDuration:k,TransitionProps:C}),$=(e=>{const{classes:t}=e;return _S({root:["root"],paper:["paper"]},UE,t)})(_),O=A.useCallback((()=>{if("anchorPosition"===c)return u;const e=XE(o),t=(e&&1===e.nodeType?e:AN(E.current).body).getBoundingClientRect();return{top:t.top+HE(t,l.vertical),left:t.left+qE(t,l.horizontal)}}),[o,l.horizontal,l.vertical,u,c]),D=A.useCallback((e=>({vertical:HE(e,x.vertical),horizontal:qE(e,x.horizontal)})),[x.horizontal,x.vertical]),M=A.useCallback((e=>{const t={width:e.offsetWidth,height:e.offsetHeight},n=D(t);if("none"===c)return{top:null,left:null,transformOrigin:KE(n)};const r=O();let s=r.top-n.vertical,a=r.left-n.horizontal;const i=s+t.height,l=a+t.width,u=QN(XE(o)),d=u.innerHeight-m,h=u.innerWidth-m;if(null!==m&&s<m){const e=s-m;s-=e,n.vertical+=e}else if(null!==m&&i>d){const e=i-d;s-=e,n.vertical+=e}if(null!==m&&a<m){const e=a-m;a-=e,n.horizontal+=e}else if(l>h){const e=l-h;a-=e,n.horizontal+=e}return{top:`${Math.round(s)}px`,left:`${Math.round(a)}px`,transformOrigin:KE(n)}}),[o,c,O,D,m]),[F,L]=A.useState(g),P=A.useCallback((()=>{const e=E.current;if(!e)return;const t=M(e);null!==t.top&&(e.style.top=t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin,L(!0)}),[M]);A.useEffect((()=>(I&&window.addEventListener("scroll",P),()=>window.removeEventListener("scroll",P))),[o,I,P]);A.useEffect((()=>{g&&P()})),A.useImperativeHandle(i,(()=>g?{updatePosition:()=>{P()}}:null),[g,P]),A.useEffect((()=>{if(!g)return;const e=YN((()=>{P()})),t=QN(o);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}}),[o,g,P]);let z=k;"auto"!==k||w.muiSupportAuto||(z=void 0);const B=p||(o?AN(XE(o)).body:void 0),j=null!=(r=null==v?void 0:v.root)?r:YE,U=null!=(s=null==v?void 0:v.paper)?s:QE,V=MN({elementType:U,externalSlotProps:(0,He.A)({},N,{style:F?N.style:(0,He.A)({},N.style,{opacity:0})}),additionalProps:{elevation:f,ref:R},ownerState:_,className:Xe($.paper,null==N?void 0:N.className)}),W=MN({elementType:j,externalSlotProps:(null==b?void 0:b.root)||{},externalForwardedProps:T,additionalProps:{ref:t,slotProps:{backdrop:{invisible:!0}},container:B,open:g},ownerState:_,className:Xe($.root,h)}),{slotProps:G}=W,H=(0,qe.A)(W,GE);return(0,st.jsx)(j,(0,He.A)({},H,!AI(j)&&{slotProps:G,disableScrollLock:I},{children:(0,st.jsx)(w,(0,He.A)({appear:!0,in:g,onEntering:(e,t)=>{S&&S(e,t),P()},onExited:()=>{L(!1)},timeout:z},C,{children:(0,st.jsx)(U,(0,He.A)({},V,{children:d}))}))}))}));function ZE(e){return Vt("MuiMenu",e)}Wt("MuiMenu",["root","paper","list"]);const eA=["onEntering"],tA=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],nA={vertical:"top",horizontal:"right"},rA={vertical:"top",horizontal:"left"},sA=eI(JE,{shouldForwardProp:e=>ZS(e)||"classes"===e,name:"MuiMenu",slot:"Root",overridesResolver:(e,t)=>t.root})({}),aA=eI(QE,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,t)=>t.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),iA=eI(XN,{name:"MuiMenu",slot:"List",overridesResolver:(e,t)=>t.list})({outline:0}),oA=A.forwardRef((function(e,t){var n,r;const s=sI({props:e,name:"MuiMenu"}),{autoFocus:a=!0,children:i,className:o,disableAutoFocusItem:l=!1,MenuListProps:u={},onClose:c,open:d,PaperProps:h={},PopoverClasses:p,transitionDuration:f="auto",TransitionProps:{onEntering:m}={},variant:g="selectedMenu",slots:y={},slotProps:v={}}=s,b=(0,qe.A)(s.TransitionProps,eA),x=(0,qe.A)(s,tA),w=$N(),k=(0,He.A)({},s,{autoFocus:a,disableAutoFocusItem:l,MenuListProps:u,onEntering:m,PaperProps:h,transitionDuration:f,TransitionProps:b,variant:g}),S=(e=>{const{classes:t}=e;return _S({root:["root"],paper:["paper"],list:["list"]},ZE,t)})(k),I=a&&!l&&d,C=A.useRef(null);let T=-1;A.Children.map(i,((e,t)=>{A.isValidElement(e)&&(e.props.disabled||("selectedMenu"===g&&e.props.selected||-1===T)&&(T=t))}));const N=null!=(n=y.paper)?n:aA,E=null!=(r=v.paper)?r:h,R=MN({elementType:y.root,externalSlotProps:v.root,ownerState:k,className:[S.root,o]}),_=MN({elementType:N,externalSlotProps:E,ownerState:k,className:S.paper});return(0,st.jsx)(sA,(0,He.A)({onClose:c,anchorOrigin:{vertical:"bottom",horizontal:w?"right":"left"},transformOrigin:w?nA:rA,slots:{paper:N,root:y.root},slotProps:{root:R,paper:_},open:d,ref:t,transitionDuration:f,TransitionProps:(0,He.A)({onEntering:(e,t)=>{C.current&&C.current.adjustStyleForScrollbar(e,{direction:w?"rtl":"ltr"}),m&&m(e,t)}},b),ownerState:k},x,{classes:p,children:(0,st.jsx)(iA,(0,He.A)({onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),c&&c(e,"tabKeyDown"))},actions:C,autoFocus:a&&(-1===T||l),autoFocusItem:I,variant:g},u,{className:Xe(S.list,u.className),children:i}))}))})),lA=oA;function uA(e){return Vt("MuiNativeSelect",e)}const cA=Wt("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),dA=["className","disabled","error","IconComponent","inputRef","variant"],hA=e=>{let{ownerState:t,theme:n}=e;return(0,He.A)({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":(0,He.A)({},n.vars?{backgroundColor:`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:"light"===n.palette.mode?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${cA.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(n.vars||n).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},"filled"===t.variant&&{"&&&":{paddingRight:32}},"outlined"===t.variant&&{borderRadius:(n.vars||n).shape.borderRadius,"&:focus":{borderRadius:(n.vars||n).shape.borderRadius},"&&&":{paddingRight:32}})},pA=eI("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:ZS,overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.select,t[n.variant],n.error&&t.error,{[`&.${cA.multiple}`]:t.multiple}]}})(hA),fA=e=>{let{ownerState:t,theme:n}=e;return(0,He.A)({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(n.vars||n).palette.action.active,[`&.${cA.disabled}`]:{color:(n.vars||n).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},"filled"===t.variant&&{right:7},"outlined"===t.variant&&{right:7})},mA=eI("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t[`icon${XS(n.variant)}`],n.open&&t.iconOpen]}})(fA),gA=A.forwardRef((function(e,t){const{className:n,disabled:r,error:s,IconComponent:a,inputRef:i,variant:o="standard"}=e,l=(0,qe.A)(e,dA),u=(0,He.A)({},e,{disabled:r,variant:o,error:s}),c=(e=>{const{classes:t,variant:n,disabled:r,multiple:s,open:a,error:i}=e;return _S({select:["select",n,r&&"disabled",s&&"multiple",i&&"error"],icon:["icon",`icon${XS(n)}`,a&&"iconOpen",r&&"disabled"]},uA,t)})(u);return(0,st.jsxs)(A.Fragment,{children:[(0,st.jsx)(pA,(0,He.A)({ownerState:u,className:Xe(c.select,n),disabled:r,ref:i||t},l)),e.multiple?null:(0,st.jsx)(mA,{as:a,ownerState:u,className:c.icon})]})})),yA=gA;function vA(e){let{controlled:t,default:n,name:r,state:s="value"}=e;const{current:a}=A.useRef(void 0!==t),[i,o]=A.useState(n);return[a?t:i,A.useCallback((e=>{a||o(e)}),[])]}const bA=vA;function xA(e){return Vt("MuiSelect",e)}const wA=Wt("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var kA;const SA=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],IA=eI("div",{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`&.${wA.select}`]:t.select},{[`&.${wA.select}`]:t[n.variant]},{[`&.${wA.error}`]:t.error},{[`&.${wA.multiple}`]:t.multiple}]}})(hA,{[`&.${wA.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),CA=eI("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t[`icon${XS(n.variant)}`],n.open&&t.iconOpen]}})(fA),TA=eI("input",{shouldForwardProp:e=>JS(e)&&"classes"!==e,name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,t)=>t.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function NA(e,t){return"object"===typeof t&&null!==t?e===t:String(e)===String(t)}function EA(e){return null==e||"string"===typeof e&&!e.trim()}const AA=A.forwardRef((function(e,t){var n;const{"aria-describedby":r,"aria-label":s,autoFocus:a,autoWidth:i,children:o,className:l,defaultOpen:u,defaultValue:c,disabled:d,displayEmpty:h,error:p=!1,IconComponent:f,inputRef:m,labelId:g,MenuProps:y={},multiple:v,name:b,onBlur:x,onChange:w,onClose:k,onFocus:S,onOpen:I,open:C,readOnly:T,renderValue:N,SelectDisplayProps:E={},tabIndex:R,value:_,variant:$="standard"}=e,O=(0,qe.A)(e,SA),[D,M]=bA({controlled:_,default:c,name:"Select"}),[F,L]=bA({controlled:C,default:u,name:"Select"}),P=A.useRef(null),z=A.useRef(null),[B,j]=A.useState(null),{current:U}=A.useRef(null!=C),[V,W]=A.useState(),G=jI(t,m),H=A.useCallback((e=>{z.current=e,e&&j(e)}),[]),q=null==B?void 0:B.parentNode;A.useImperativeHandle(G,(()=>({focus:()=>{z.current.focus()},node:P.current,value:D})),[D]),A.useEffect((()=>{u&&F&&B&&!U&&(W(i?null:q.clientWidth),z.current.focus())}),[B,i]),A.useEffect((()=>{a&&z.current.focus()}),[a]),A.useEffect((()=>{if(!g)return;const e=AN(z.current).getElementById(g);if(e){const t=()=>{getSelection().isCollapsed&&z.current.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}}),[g]);const K=(e,t)=>{e?I&&I(t):k&&k(t),U||(W(i?null:q.clientWidth),L(e))},X=A.Children.toArray(o),Y=e=>t=>{let n;if(t.currentTarget.hasAttribute("tabindex")){if(v){n=Array.isArray(D)?D.slice():[];const t=D.indexOf(e.props.value);-1===t?n.push(e.props.value):n.splice(t,1)}else n=e.props.value;if(e.props.onClick&&e.props.onClick(t),D!==n&&(M(n),w)){const r=t.nativeEvent||t,s=new r.constructor(r.type,r);Object.defineProperty(s,"target",{writable:!0,value:{value:n,name:b}}),w(s,e)}v||K(!1,t)}},Q=null!==B&&F;let J,Z;delete O["aria-invalid"];const ee=[];let te=!1,ne=!1;(ST({value:D})||h)&&(N?J=N(D):te=!0);const re=X.map((e=>{if(!A.isValidElement(e))return null;let t;if(v){if(!Array.isArray(D))throw new Error((0,lt.A)(2));t=D.some((t=>NA(t,e.props.value))),t&&te&&ee.push(e.props.children)}else t=NA(D,e.props.value),t&&te&&(Z=e.props.children);return t&&(ne=!0),A.cloneElement(e,{"aria-selected":t?"true":"false",onClick:Y(e),onKeyUp:t=>{" "===t.key&&t.preventDefault(),e.props.onKeyUp&&e.props.onKeyUp(t)},role:"option",selected:t,value:void 0,"data-value":e.props.value})}));te&&(J=v?0===ee.length?null:ee.reduce(((e,t,n)=>(e.push(t),n<ee.length-1&&e.push(", "),e)),[]):Z);let se,ae=V;!i&&U&&B&&(ae=q.clientWidth),se="undefined"!==typeof R?R:d?null:0;const ie=E.id||(b?`mui-component-select-${b}`:void 0),oe=(0,He.A)({},e,{variant:$,value:D,open:Q,error:p}),le=(e=>{const{classes:t,variant:n,disabled:r,multiple:s,open:a,error:i}=e;return _S({select:["select",n,r&&"disabled",s&&"multiple",i&&"error"],icon:["icon",`icon${XS(n)}`,a&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]},xA,t)})(oe),ue=(0,He.A)({},y.PaperProps,null==(n=y.slotProps)?void 0:n.paper),ce=iT();return(0,st.jsxs)(A.Fragment,{children:[(0,st.jsx)(IA,(0,He.A)({ref:H,tabIndex:se,role:"combobox","aria-controls":ce,"aria-disabled":d?"true":void 0,"aria-expanded":Q?"true":"false","aria-haspopup":"listbox","aria-label":s,"aria-labelledby":[g,ie].filter(Boolean).join(" ")||void 0,"aria-describedby":r,onKeyDown:e=>{if(!T){-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),K(!0,e))}},onMouseDown:d||T?null:e=>{0===e.button&&(e.preventDefault(),z.current.focus(),K(!0,e))},onBlur:e=>{!Q&&x&&(Object.defineProperty(e,"target",{writable:!0,value:{value:D,name:b}}),x(e))},onFocus:S},E,{ownerState:oe,className:Xe(E.className,le.select,l),id:ie,children:EA(J)?kA||(kA=(0,st.jsx)("span",{className:"notranslate",children:"\u200b"})):J})),(0,st.jsx)(TA,(0,He.A)({"aria-invalid":p,value:Array.isArray(D)?D.join(","):D,name:b,ref:P,"aria-hidden":!0,onChange:e=>{const t=X.find((t=>t.props.value===e.target.value));void 0!==t&&(M(t.props.value),w&&w(e,t))},tabIndex:-1,disabled:d,className:le.nativeInput,autoFocus:a,ownerState:oe},O)),(0,st.jsx)(CA,{as:f,className:le.icon,ownerState:oe}),(0,st.jsx)(lA,(0,He.A)({id:`menu-${b||""}`,anchorEl:q,open:Q,onClose:e=>{K(!1,e)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},y,{MenuListProps:(0,He.A)({"aria-labelledby":g,role:"listbox","aria-multiselectable":v?"true":void 0,disableListWrap:!0,id:ce},y.MenuListProps),slotProps:(0,He.A)({},y.slotProps,{paper:(0,He.A)({},ue,{style:(0,He.A)({minWidth:ae},null!=ue?ue.style:null)})}),children:re}))]})})),RA=AA,_A=WC((0,st.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),$A=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],OA=["root"],DA={name:"MuiSelect",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>ZS(e)&&"variant"!==e,slot:"Root"},MA=eI(zT,DA)(""),FA=eI(sN,DA)(""),LA=eI(HT,DA)(""),PA=A.forwardRef((function(e,t){const n=sI({name:"MuiSelect",props:e}),{autoWidth:r=!1,children:s,classes:a={},className:i,defaultOpen:o=!1,displayEmpty:l=!1,IconComponent:u=_A,id:c,input:d,inputProps:h,label:p,labelId:f,MenuProps:m,multiple:g=!1,native:y=!1,onClose:v,onOpen:b,open:x,renderValue:w,SelectDisplayProps:k,variant:S="outlined"}=n,I=(0,qe.A)(n,$A),C=y?yA:RA,T=mT({props:n,muiFormControl:yT(),states:["variant","error"]}),N=T.variant||S,E=(0,He.A)({},n,{variant:N,classes:a}),R=(e=>{const{classes:t}=e;return t})(E),_=(0,qe.A)(R,OA),$=d||{standard:(0,st.jsx)(MA,{ownerState:E}),outlined:(0,st.jsx)(FA,{label:p,ownerState:E}),filled:(0,st.jsx)(LA,{ownerState:E})}[N],O=jI(t,EN($));return(0,st.jsx)(A.Fragment,{children:A.cloneElement($,(0,He.A)({inputComponent:C,inputProps:(0,He.A)({children:s,error:T.error,IconComponent:u,variant:N,type:void 0,multiple:g},y?{id:c}:{autoWidth:r,defaultOpen:o,displayEmpty:l,labelId:f,MenuProps:m,onClose:v,onOpen:b,open:x,renderValue:w,SelectDisplayProps:(0,He.A)({id:c},k)},h,{classes:h?(0,ut.A)(_,h.classes):_},d?d.props.inputProps:{})},(g&&y||l)&&"outlined"===N?{notched:!0}:{},{ref:O,className:Xe($.props.className,i,R.root)},!d&&{variant:N},I))})}));PA.muiName="Select";const zA=PA;function BA(e){return Vt("MuiTextField",e)}Wt("MuiTextField",["root"]);const jA=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],UA={standard:zT,filled:HT,outlined:sN},VA=eI(wN,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),WA=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiTextField"}),{autoComplete:r,autoFocus:s=!1,children:a,className:i,color:o="primary",defaultValue:l,disabled:u=!1,error:c=!1,FormHelperTextProps:d,fullWidth:h=!1,helperText:p,id:f,InputLabelProps:m,inputProps:g,InputProps:y,inputRef:v,label:b,maxRows:x,minRows:w,multiline:k=!1,name:S,onBlur:I,onChange:C,onFocus:T,placeholder:N,required:E=!1,rows:A,select:R=!1,SelectProps:_,type:$,value:O,variant:D="outlined"}=n,M=(0,qe.A)(n,jA),F=(0,He.A)({},n,{autoFocus:s,color:o,disabled:u,error:c,fullWidth:h,multiline:k,required:E,select:R,variant:D}),L=(e=>{const{classes:t}=e;return _S({root:["root"]},BA,t)})(F);const P={};"outlined"===D&&(m&&"undefined"!==typeof m.shrink&&(P.notched=m.shrink),P.label=b),R&&(_&&_.native||(P.id=void 0),P["aria-describedby"]=void 0);const z=iT(f),B=p&&z?`${z}-helper-text`:void 0,j=b&&z?`${z}-label`:void 0,U=UA[D],V=(0,st.jsx)(U,(0,He.A)({"aria-describedby":B,autoComplete:r,autoFocus:s,defaultValue:l,fullWidth:h,multiline:k,name:S,rows:A,maxRows:x,minRows:w,type:$,value:O,id:z,inputRef:v,onBlur:I,onChange:C,onFocus:T,placeholder:N,inputProps:g},P,y));return(0,st.jsxs)(VA,(0,He.A)({className:Xe(L.root,i),disabled:u,error:c,fullWidth:h,ref:t,required:E,color:o,variant:D,ownerState:F},M,{children:[null!=b&&""!==b&&(0,st.jsx)(mN,(0,He.A)({htmlFor:z,id:j},m,{children:b})),R?(0,st.jsx)(zA,(0,He.A)({"aria-describedby":B,id:z,labelId:j,value:O,input:V},_,{children:a})):V,p&&(0,st.jsx)(NN,(0,He.A)({id:B},d,{children:p}))]}))})),GA=WA;var HA=n(9751),qA=n(8604);const KA=["component","direction","spacing","divider","children","className","useFlexGap"],XA=(0,Ze.A)(),YA=WS("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root});function QA(e){return DS({props:e,name:"MuiStack",defaultTheme:XA})}function JA(e,t){const n=A.Children.toArray(e).filter(Boolean);return n.reduce(((e,r,s)=>(e.push(r),s<n.length-1&&e.push(A.cloneElement(t,{key:`separator-${s}`})),e)),[])}const ZA=e=>{let{ownerState:t,theme:n}=e,r=(0,He.A)({display:"flex",flexDirection:"column"},(0,HA.NI)({theme:n},(0,HA.kW)({values:t.direction,breakpoints:n.breakpoints.values}),(e=>({flexDirection:e}))));if(t.spacing){const e=(0,qA.LX)(n),s=Object.keys(n.breakpoints.values).reduce(((e,n)=>(("object"===typeof t.spacing&&null!=t.spacing[n]||"object"===typeof t.direction&&null!=t.direction[n])&&(e[n]=!0),e)),{}),a=(0,HA.kW)({values:t.direction,base:s}),i=(0,HA.kW)({values:t.spacing,base:s});"object"===typeof a&&Object.keys(a).forEach(((e,t,n)=>{if(!a[e]){const r=t>0?a[n[t-1]]:"column";a[e]=r}}));const o=(n,r)=>{return t.useFlexGap?{gap:(0,qA._W)(e,n)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${s=r?a[r]:t.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[s]}`]:(0,qA._W)(e,n)}};var s};r=(0,ut.A)(r,(0,HA.NI)({theme:n},i,o))}return r=(0,HA.iZ)(n.breakpoints,r),r};const eR=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:t=YA,useThemeProps:n=QA,componentName:r="MuiStack"}=e,s=t(ZA);return A.forwardRef((function(e,t){const a=n(e),i=(0,Je.A)(a),{component:o="div",direction:l="column",spacing:u=0,divider:c,children:d,className:h,useFlexGap:p=!1}=i,f=(0,qe.A)(i,KA),m={direction:l,spacing:u,useFlexGap:p},g=_S({root:["root"]},(e=>Vt(r,e)),{});return(0,st.jsx)(s,(0,He.A)({as:o,ownerState:m,ref:t,className:Xe(g.root,h)},f,{children:c?JA(d,c):d}))}))}({createStyledComponent:eI("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root}),useThemeProps:e=>sI({props:e,name:"MuiStack"})});function tR(e){return Vt("MuiFormControlLabel",e)}const nR=Wt("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),rR=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],sR=eI("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${nR.label}`]:t.label},t.root,t[`labelPlacement${XS(n.labelPlacement)}`]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${nR.disabled}`]:{cursor:"default"}},"start"===n.labelPlacement&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},"top"===n.labelPlacement&&{flexDirection:"column-reverse",marginLeft:16},"bottom"===n.labelPlacement&&{flexDirection:"column",marginLeft:16},{[`& .${nR.label}`]:{[`&.${nR.disabled}`]:{color:(t.vars||t).palette.text.disabled}}})})),aR=eI("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((e=>{let{theme:t}=e;return{[`&.${nR.error}`]:{color:(t.vars||t).palette.error.main}}})),iR=A.forwardRef((function(e,t){var n,r;const s=sI({props:e,name:"MuiFormControlLabel"}),{className:a,componentsProps:i={},control:o,disabled:l,disableTypography:u,label:c,labelPlacement:d="end",required:h,slotProps:p={}}=s,f=(0,qe.A)(s,rR),m=yT(),g=null!=(n=null!=l?l:o.props.disabled)?n:null==m?void 0:m.disabled,y=null!=h?h:o.props.required,v={disabled:g,required:y};["checked","name","onChange","value","inputRef"].forEach((e=>{"undefined"===typeof o.props[e]&&"undefined"!==typeof s[e]&&(v[e]=s[e])}));const b=mT({props:s,muiFormControl:m,states:["error"]}),x=(0,He.A)({},s,{disabled:g,labelPlacement:d,required:y,error:b.error}),w=(e=>{const{classes:t,disabled:n,labelPlacement:r,error:s,required:a}=e;return _S({root:["root",n&&"disabled",`labelPlacement${XS(r)}`,s&&"error",a&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",s&&"error"]},tR,t)})(x),k=null!=(r=p.typography)?r:i.typography;let S=c;return null==S||S.type===hI||u||(S=(0,st.jsx)(hI,(0,He.A)({component:"span"},k,{className:Xe(w.label,null==k?void 0:k.className),children:S}))),(0,st.jsxs)(sR,(0,He.A)({className:Xe(w.root,a),ownerState:x,ref:t},f,{children:[A.cloneElement(o,v),y?(0,st.jsxs)(eR,{display:"block",children:[S,(0,st.jsxs)(aR,{ownerState:x,"aria-hidden":!0,className:w.asterisk,children:["\u2009","*"]})]}):S]}))}));function oR(e){return Vt("PrivateSwitchBase",e)}Wt("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const lR=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],uR=eI(OC)((e=>{let{ownerState:t}=e;return(0,He.A)({padding:9,borderRadius:"50%"},"start"===t.edge&&{marginLeft:"small"===t.size?-3:-12},"end"===t.edge&&{marginRight:"small"===t.size?-3:-12})})),cR=eI("input",{shouldForwardProp:ZS})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),dR=A.forwardRef((function(e,t){const{autoFocus:n,checked:r,checkedIcon:s,className:a,defaultChecked:i,disabled:o,disableFocusRipple:l=!1,edge:u=!1,icon:c,id:d,inputProps:h,inputRef:p,name:f,onBlur:m,onChange:g,onFocus:y,readOnly:v,required:b=!1,tabIndex:x,type:w,value:k}=e,S=(0,qe.A)(e,lR),[I,C]=bA({controlled:r,default:Boolean(i),name:"SwitchBase",state:"checked"}),T=yT();let N=o;T&&"undefined"===typeof N&&(N=T.disabled);const E="checkbox"===w||"radio"===w,A=(0,He.A)({},e,{checked:I,disabled:N,disableFocusRipple:l,edge:u}),R=(e=>{const{classes:t,checked:n,disabled:r,edge:s}=e;return _S({root:["root",n&&"checked",r&&"disabled",s&&`edge${XS(s)}`],input:["input"]},oR,t)})(A);return(0,st.jsxs)(uR,(0,He.A)({component:"span",className:Xe(R.root,a),centerRipple:!0,focusRipple:!l,disabled:N,tabIndex:null,role:void 0,onFocus:e=>{y&&y(e),T&&T.onFocus&&T.onFocus(e)},onBlur:e=>{m&&m(e),T&&T.onBlur&&T.onBlur(e)},ownerState:A,ref:t},S,{children:[(0,st.jsx)(cR,(0,He.A)({autoFocus:n,checked:r,defaultChecked:i,className:R.input,disabled:N,id:E?d:void 0,name:f,onChange:e=>{if(e.nativeEvent.defaultPrevented)return;const t=e.target.checked;C(t),g&&g(e,t)},readOnly:v,ref:p,required:b,ownerState:A,tabIndex:x,type:w},"checkbox"===w&&void 0===k?{}:{value:k},h)),I?s:c]}))})),hR=WC((0,st.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),pR=WC((0,st.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),fR=WC((0,st.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function mR(e){return Vt("MuiCheckbox",e)}const gR=Wt("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),yR=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],vR=eI(dR,{shouldForwardProp:e=>ZS(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.indeterminate&&t.indeterminate,t[`size${XS(n.size)}`],"default"!==n.color&&t[`color${XS(n.color)}`]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({color:(t.vars||t).palette.text.secondary},!n.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${"default"===n.color?t.vars.palette.action.activeChannel:t.vars.palette[n.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,dt.X4)("default"===n.color?t.palette.action.active:t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==n.color&&{[`&.${gR.checked}, &.${gR.indeterminate}`]:{color:(t.vars||t).palette[n.color].main},[`&.${gR.disabled}`]:{color:(t.vars||t).palette.action.disabled}})})),bR=(0,st.jsx)(pR,{}),xR=(0,st.jsx)(hR,{}),wR=(0,st.jsx)(fR,{}),kR=A.forwardRef((function(e,t){var n,r;const s=sI({props:e,name:"MuiCheckbox"}),{checkedIcon:a=bR,color:i="primary",icon:o=xR,indeterminate:l=!1,indeterminateIcon:u=wR,inputProps:c,size:d="medium",className:h}=s,p=(0,qe.A)(s,yR),f=l?u:o,m=l?u:a,g=(0,He.A)({},s,{color:i,indeterminate:l,size:d}),y=(e=>{const{classes:t,indeterminate:n,color:r,size:s}=e,a=_S({root:["root",n&&"indeterminate",`color${XS(r)}`,`size${XS(s)}`]},mR,t);return(0,He.A)({},t,a)})(g);return(0,st.jsx)(vR,(0,He.A)({type:"checkbox",inputProps:(0,He.A)({"data-indeterminate":l},c),icon:A.cloneElement(f,{fontSize:null!=(n=f.props.fontSize)?n:d}),checkedIcon:A.cloneElement(m,{fontSize:null!=(r=m.props.fontSize)?r:d}),ownerState:g,ref:t,className:Xe(y.root,h)},p,{classes:y}))}));function SR(e){return Vt("MuiButton",e)}const IR=Wt("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);const CR=A.createContext({});const TR=A.createContext(void 0),NR=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],ER=e=>(0,He.A)({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}}),AR=eI(OC,{shouldForwardProp:e=>ZS(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${XS(n.color)}`],t[`size${XS(n.size)}`],t[`${n.variant}Size${XS(n.size)}`],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})((e=>{let{theme:t,ownerState:n}=e;var r,s;const a="light"===t.palette.mode?t.palette.grey[300]:t.palette.grey[800],i="light"===t.palette.mode?t.palette.grey.A100:t.palette.grey[700];return(0,He.A)({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":(0,He.A)({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,dt.X4)(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===n.variant&&"inherit"!==n.color&&{backgroundColor:t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,dt.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===n.variant&&"inherit"!==n.color&&{border:`1px solid ${(t.vars||t).palette[n.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,dt.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===n.variant&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:i,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},"contained"===n.variant&&"inherit"!==n.color&&{backgroundColor:(t.vars||t).palette[n.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[n.color].main}}),"&:active":(0,He.A)({},"contained"===n.variant&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${IR.focusVisible}`]:(0,He.A)({},"contained"===n.variant&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${IR.disabled}`]:(0,He.A)({color:(t.vars||t).palette.action.disabled},"outlined"===n.variant&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"contained"===n.variant&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},"text"===n.variant&&{padding:"6px 8px"},"text"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].main},"outlined"===n.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[n.color].mainChannel} / 0.5)`:`1px solid ${(0,dt.X4)(t.palette[n.color].main,.5)}`},"contained"===n.variant&&{color:t.vars?t.vars.palette.text.primary:null==(r=(s=t.palette).getContrastText)?void 0:r.call(s,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:a,boxShadow:(t.vars||t).shadows[2]},"contained"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].contrastText,backgroundColor:(t.vars||t).palette[n.color].main},"inherit"===n.color&&{color:"inherit",borderColor:"currentColor"},"small"===n.size&&"text"===n.variant&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"text"===n.variant&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},"small"===n.size&&"outlined"===n.variant&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"outlined"===n.variant&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},"small"===n.size&&"contained"===n.variant&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"contained"===n.variant&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},n.fullWidth&&{width:"100%"})}),(e=>{let{ownerState:t}=e;return t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${IR.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${IR.disabled}`]:{boxShadow:"none"}}})),RR=eI("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,t[`iconSize${XS(n.size)}`]]}})((e=>{let{ownerState:t}=e;return(0,He.A)({display:"inherit",marginRight:8,marginLeft:-4},"small"===t.size&&{marginLeft:-2},ER(t))})),_R=eI("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,t[`iconSize${XS(n.size)}`]]}})((e=>{let{ownerState:t}=e;return(0,He.A)({display:"inherit",marginRight:-4,marginLeft:8},"small"===t.size&&{marginRight:-2},ER(t))})),$R=A.forwardRef((function(e,t){const n=A.useContext(CR),r=A.useContext(TR),s=sI({props:OS(n,e),name:"MuiButton"}),{children:a,color:i="primary",component:o="button",className:l,disabled:u=!1,disableElevation:c=!1,disableFocusRipple:d=!1,endIcon:h,focusVisibleClassName:p,fullWidth:f=!1,size:m="medium",startIcon:g,type:y,variant:v="text"}=s,b=(0,qe.A)(s,NR),x=(0,He.A)({},s,{color:i,component:o,disabled:u,disableElevation:c,disableFocusRipple:d,fullWidth:f,size:m,type:y,variant:v}),w=(e=>{const{color:t,disableElevation:n,fullWidth:r,size:s,variant:a,classes:i}=e,o=_S({root:["root",a,`${a}${XS(t)}`,`size${XS(s)}`,`${a}Size${XS(s)}`,`color${XS(t)}`,n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${XS(s)}`],endIcon:["icon","endIcon",`iconSize${XS(s)}`]},SR,i);return(0,He.A)({},i,o)})(x),k=g&&(0,st.jsx)(RR,{className:w.startIcon,ownerState:x,children:g}),S=h&&(0,st.jsx)(_R,{className:w.endIcon,ownerState:x,children:h}),I=r||"";return(0,st.jsxs)(AR,(0,He.A)({ownerState:x,className:Xe(n.className,w.root,l,I),component:o,disabled:u,focusRipple:!d,focusVisibleClassName:Xe(w.focusVisible,p),ref:t,type:y},b,{classes:w,children:[k,a,S]}))})),OR=$R;function DR(e){return Vt("MuiCircularProgress",e)}Wt("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const MR=["className","color","disableShrink","size","style","thickness","value","variant"];let FR,LR,PR,zR,BR=e=>e;const jR=44,UR=(0,fC.i7)(FR||(FR=BR`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),VR=(0,fC.i7)(LR||(LR=BR`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),WR=eI("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`color${XS(n.color)}`]]}})((e=>{let{ownerState:t,theme:n}=e;return(0,He.A)({display:"inline-block"},"determinate"===t.variant&&{transition:n.transitions.create("transform")},"inherit"!==t.color&&{color:(n.vars||n).palette[t.color].main})}),(e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&(0,fC.AH)(PR||(PR=BR`
      animation: ${0} 1.4s linear infinite;
    `),UR)})),GR=eI("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),HR=eI("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.circle,t[`circle${XS(n.variant)}`],n.disableShrink&&t.circleDisableShrink]}})((e=>{let{ownerState:t,theme:n}=e;return(0,He.A)({stroke:"currentColor"},"determinate"===t.variant&&{transition:n.transitions.create("stroke-dashoffset")},"indeterminate"===t.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})}),(e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&!t.disableShrink&&(0,fC.AH)(zR||(zR=BR`
      animation: ${0} 1.4s ease-in-out infinite;
    `),VR)})),qR=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiCircularProgress"}),{className:r,color:s="primary",disableShrink:a=!1,size:i=40,style:o,thickness:l=3.6,value:u=0,variant:c="indeterminate"}=n,d=(0,qe.A)(n,MR),h=(0,He.A)({},n,{color:s,disableShrink:a,size:i,thickness:l,value:u,variant:c}),p=(e=>{const{classes:t,variant:n,color:r,disableShrink:s}=e;return _S({root:["root",n,`color${XS(r)}`],svg:["svg"],circle:["circle",`circle${XS(n)}`,s&&"circleDisableShrink"]},DR,t)})(h),f={},m={},g={};if("determinate"===c){const e=2*Math.PI*((jR-l)/2);f.strokeDasharray=e.toFixed(3),g["aria-valuenow"]=Math.round(u),f.strokeDashoffset=`${((100-u)/100*e).toFixed(3)}px`,m.transform="rotate(-90deg)"}return(0,st.jsx)(WR,(0,He.A)({className:Xe(p.root,r),style:(0,He.A)({width:i,height:i},m,o),ownerState:h,ref:t,role:"progressbar"},g,d,{children:(0,st.jsx)(GR,{className:p.svg,ownerState:h,viewBox:"22 22 44 44",children:(0,st.jsx)(HR,{className:p.circle,style:f,ownerState:h,cx:jR,cy:jR,r:(jR-l)/2,fill:"none",strokeWidth:l})})}))})),KR=qR;function XR(){const[e,t]=(0,A.useState)(""),[n,r]=(0,A.useState)(""),[s,a]=(0,A.useState)(!1),[i,o]=(0,A.useState)(""),[l,u]=(0,A.useState)(!1),{login:c}=fS(),d=Te();return(0,A.useEffect)((()=>{const e=localStorage.getItem("rememberedEmail");e&&(t(e),a(!0))}),[]),(0,st.jsx)(aI,{maxWidth:"sm",children:(0,st.jsxs)(qt,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80vh"},children:[(0,st.jsx)(hI,{component:"h1",variant:"h4",gutterBottom:!0,children:"Remote Patient Monitoring - Baadi"}),(0,st.jsx)(kI,{sx:{width:"100%",mt:3},children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{component:"h2",variant:"h5",align:"center",gutterBottom:!0,children:"Login"}),i&&(0,st.jsx)(rT,{severity:"error",sx:{mb:2},children:i}),(0,st.jsxs)(qt,{component:"form",onSubmit:async function(t){if(t.preventDefault(),e)if(n)try{o(""),u(!0),await c(e,n),s?localStorage.setItem("rememberedEmail",e):localStorage.removeItem("rememberedEmail"),d("/dashboard")}catch(i){console.error("Login error:",i),"auth/user-not-found"===i.code||"auth/wrong-password"===i.code?o("Invalid email or password. Please try again."):"auth/invalid-email"===i.code?o("Invalid email format. Please enter a valid email."):"auth/too-many-requests"===i.code?o("Too many failed login attempts. Please try again later or reset your password."):"auth/user-disabled"===i.code?o("This account has been disabled. Please contact support."):o("Failed to sign in. Please check your credentials.")}finally{u(!1)}else o("Password is required");else o("Email is required")},noValidate:!0,children:[(0,st.jsx)(GA,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:e,onChange:e=>t(e.target.value)}),(0,st.jsx)(GA,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:n,onChange:e=>r(e.target.value)}),(0,st.jsx)(iR,{control:(0,st.jsx)(kR,{value:"remember",color:"primary",checked:s,onChange:e=>a(e.target.checked)}),label:"Remember me"}),(0,st.jsx)(OR,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:l,sx:{mt:3,mb:2},children:l?(0,st.jsx)(KR,{size:24,color:"inherit"}):"Sign In"}),(0,st.jsxs)(qt,{sx:{mt:2,display:"flex",justifyContent:"space-between"},children:[(0,st.jsx)(TS,{to:"/forgot-password",style:{textDecoration:"none"},children:(0,st.jsx)(hI,{variant:"body2",color:"primary",children:"Forgot password?"})}),(0,st.jsx)(TS,{to:"/register",style:{textDecoration:"none"},children:(0,st.jsx)(hI,{variant:"body2",color:"primary",children:"Don't have an account? Sign Up"})})]})]})]})})]})})}function YR(e){return Vt("MuiStepper",e)}Wt("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const QR=A.createContext({});const JR=QR,ZR=A.createContext({});const e_=ZR;function t_(e){return Vt("MuiStepConnector",e)}Wt("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const n_=["className"],r_=eI("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})((e=>{let{ownerState:t}=e;return(0,He.A)({flex:"1 1 auto"},"vertical"===t.orientation&&{marginLeft:12},t.alternativeLabel&&{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})})),s_=eI("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.line,t[`line${XS(n.orientation)}`]]}})((e=>{let{ownerState:t,theme:n}=e;const r="light"===n.palette.mode?n.palette.grey[400]:n.palette.grey[600];return(0,He.A)({display:"block",borderColor:n.vars?n.vars.palette.StepConnector.border:r},"horizontal"===t.orientation&&{borderTopStyle:"solid",borderTopWidth:1},"vertical"===t.orientation&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})})),a_=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiStepConnector"}),{className:r}=n,s=(0,qe.A)(n,n_),{alternativeLabel:a,orientation:i="horizontal"}=A.useContext(JR),{active:o,disabled:l,completed:u}=A.useContext(e_),c=(0,He.A)({},n,{alternativeLabel:a,orientation:i,active:o,completed:u,disabled:l}),d=(e=>{const{classes:t,orientation:n,alternativeLabel:r,active:s,completed:a,disabled:i}=e;return _S({root:["root",n,r&&"alternativeLabel",s&&"active",a&&"completed",i&&"disabled"],line:["line",`line${XS(n)}`]},t_,t)})(c);return(0,st.jsx)(r_,(0,He.A)({className:Xe(d.root,r),ref:t,ownerState:c},s,{children:(0,st.jsx)(s_,{className:d.line,ownerState:c})}))})),i_=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],o_=eI("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.nonLinear&&t.nonLinear]}})((e=>{let{ownerState:t}=e;return(0,He.A)({display:"flex"},"horizontal"===t.orientation&&{flexDirection:"row",alignItems:"center"},"vertical"===t.orientation&&{flexDirection:"column"},t.alternativeLabel&&{alignItems:"flex-start"})})),l_=(0,st.jsx)(a_,{}),u_=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiStepper"}),{activeStep:r=0,alternativeLabel:s=!1,children:a,className:i,component:o="div",connector:l=l_,nonLinear:u=!1,orientation:c="horizontal"}=n,d=(0,qe.A)(n,i_),h=(0,He.A)({},n,{nonLinear:u,alternativeLabel:s,orientation:c,component:o}),p=(e=>{const{orientation:t,nonLinear:n,alternativeLabel:r,classes:s}=e;return _S({root:["root",t,n&&"nonLinear",r&&"alternativeLabel"]},YR,s)})(h),f=A.Children.toArray(a).filter(Boolean),m=f.map(((e,t)=>A.cloneElement(e,(0,He.A)({index:t,last:t+1===f.length},e.props)))),g=A.useMemo((()=>({activeStep:r,alternativeLabel:s,connector:l,nonLinear:u,orientation:c})),[r,s,l,u,c]);return(0,st.jsx)(JR.Provider,{value:g,children:(0,st.jsx)(o_,(0,He.A)({as:o,ownerState:h,className:Xe(p.root,i),ref:t},d,{children:m}))})}));function c_(e){return Vt("MuiStep",e)}Wt("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const d_=["active","children","className","component","completed","disabled","expanded","index","last"],h_=eI("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})((e=>{let{ownerState:t}=e;return(0,He.A)({},"horizontal"===t.orientation&&{paddingLeft:8,paddingRight:8},t.alternativeLabel&&{flex:1,position:"relative"})})),p_=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiStep"}),{active:r,children:s,className:a,component:i="div",completed:o,disabled:l,expanded:u=!1,index:c,last:d}=n,h=(0,qe.A)(n,d_),{activeStep:p,connector:f,alternativeLabel:m,orientation:g,nonLinear:y}=A.useContext(JR);let[v=!1,b=!1,x=!1]=[r,o,l];p===c?v=void 0===r||r:!y&&p>c?b=void 0===o||o:!y&&p<c&&(x=void 0===l||l);const w=A.useMemo((()=>({index:c,last:d,expanded:u,icon:c+1,active:v,completed:b,disabled:x})),[c,d,u,v,b,x]),k=(0,He.A)({},n,{active:v,orientation:g,alternativeLabel:m,completed:b,disabled:x,expanded:u,component:i}),S=(e=>{const{classes:t,orientation:n,alternativeLabel:r,completed:s}=e;return _S({root:["root",n,r&&"alternativeLabel",s&&"completed"]},c_,t)})(k),I=(0,st.jsxs)(h_,(0,He.A)({as:i,className:Xe(S.root,a),ref:t,ownerState:k},h,{children:[f&&m&&0!==c?f:null,s]}));return(0,st.jsx)(e_.Provider,{value:w,children:f&&!m&&0!==c?(0,st.jsxs)(A.Fragment,{children:[f,I]}):I})})),f_=WC((0,st.jsx)("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),m_=WC((0,st.jsx)("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function g_(e){return Vt("MuiStepIcon",e)}const y_=Wt("MuiStepIcon",["root","active","completed","error","text"]);var v_;const b_=["active","className","completed","error","icon"],x_=eI(VC,{name:"MuiStepIcon",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),color:(t.vars||t).palette.text.disabled,[`&.${y_.completed}`]:{color:(t.vars||t).palette.primary.main},[`&.${y_.active}`]:{color:(t.vars||t).palette.primary.main},[`&.${y_.error}`]:{color:(t.vars||t).palette.error.main}}})),w_=eI("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(e,t)=>t.text})((e=>{let{theme:t}=e;return{fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily}})),k_=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiStepIcon"}),{active:r=!1,className:s,completed:a=!1,error:i=!1,icon:o}=n,l=(0,qe.A)(n,b_),u=(0,He.A)({},n,{active:r,completed:a,error:i}),c=(e=>{const{classes:t,active:n,completed:r,error:s}=e;return _S({root:["root",n&&"active",r&&"completed",s&&"error"],text:["text"]},g_,t)})(u);if("number"===typeof o||"string"===typeof o){const e=Xe(s,c.root);return i?(0,st.jsx)(x_,(0,He.A)({as:m_,className:e,ref:t,ownerState:u},l)):a?(0,st.jsx)(x_,(0,He.A)({as:f_,className:e,ref:t,ownerState:u},l)):(0,st.jsxs)(x_,(0,He.A)({className:e,ref:t,ownerState:u},l,{children:[v_||(v_=(0,st.jsx)("circle",{cx:"12",cy:"12",r:"12"})),(0,st.jsx)(w_,{className:c.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:u,children:o})]}))}return o}));function S_(e){return Vt("MuiStepLabel",e)}const I_=Wt("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),C_=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],T_=eI("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation]]}})((e=>{let{ownerState:t}=e;return(0,He.A)({display:"flex",alignItems:"center",[`&.${I_.alternativeLabel}`]:{flexDirection:"column"},[`&.${I_.disabled}`]:{cursor:"default"}},"vertical"===t.orientation&&{textAlign:"left",padding:"8px 0"})})),N_=eI("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(e,t)=>t.label})((e=>{let{theme:t}=e;return(0,He.A)({},t.typography.body2,{display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),[`&.${I_.active}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${I_.completed}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${I_.alternativeLabel}`]:{marginTop:16},[`&.${I_.error}`]:{color:(t.vars||t).palette.error.main}})})),E_=eI("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(e,t)=>t.iconContainer})((()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${I_.alternativeLabel}`]:{paddingRight:0}}))),A_=eI("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})((e=>{let{theme:t}=e;return{width:"100%",color:(t.vars||t).palette.text.secondary,[`&.${I_.alternativeLabel}`]:{textAlign:"center"}}})),R_=A.forwardRef((function(e,t){var n;const r=sI({props:e,name:"MuiStepLabel"}),{children:s,className:a,componentsProps:i={},error:o=!1,icon:l,optional:u,slotProps:c={},StepIconComponent:d,StepIconProps:h}=r,p=(0,qe.A)(r,C_),{alternativeLabel:f,orientation:m}=A.useContext(JR),{active:g,disabled:y,completed:v,icon:b}=A.useContext(e_),x=l||b;let w=d;x&&!w&&(w=k_);const k=(0,He.A)({},r,{active:g,alternativeLabel:f,completed:v,disabled:y,error:o,orientation:m}),S=(e=>{const{classes:t,orientation:n,active:r,completed:s,error:a,disabled:i,alternativeLabel:o}=e;return _S({root:["root",n,a&&"error",i&&"disabled",o&&"alternativeLabel"],label:["label",r&&"active",s&&"completed",a&&"error",i&&"disabled",o&&"alternativeLabel"],iconContainer:["iconContainer",r&&"active",s&&"completed",a&&"error",i&&"disabled",o&&"alternativeLabel"],labelContainer:["labelContainer",o&&"alternativeLabel"]},S_,t)})(k),I=null!=(n=c.label)?n:i.label;return(0,st.jsxs)(T_,(0,He.A)({className:Xe(S.root,a),ref:t,ownerState:k},p,{children:[x||w?(0,st.jsx)(E_,{className:S.iconContainer,ownerState:k,children:(0,st.jsx)(w,(0,He.A)({completed:v,active:g,error:o,icon:x},h))}):null,(0,st.jsxs)(A_,{className:S.labelContainer,ownerState:k,children:[s?(0,st.jsx)(N_,(0,He.A)({ownerState:k},I,{className:Xe(S.label,null==I?void 0:I.className),children:s})):null,u]})]}))}));R_.muiName="StepLabel";const __=R_;const $_=A.createContext();function O_(e){return Vt("MuiGrid",e)}const D_=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],M_=Wt("MuiGrid",["root","container","item","zeroMinWidth",...[0,1,2,3,4,5,6,7,8,9,10].map((e=>`spacing-xs-${e}`)),...["column-reverse","column","row-reverse","row"].map((e=>`direction-xs-${e}`)),...["nowrap","wrap-reverse","wrap"].map((e=>`wrap-xs-${e}`)),...D_.map((e=>`grid-xs-${e}`)),...D_.map((e=>`grid-sm-${e}`)),...D_.map((e=>`grid-md-${e}`)),...D_.map((e=>`grid-lg-${e}`)),...D_.map((e=>`grid-xl-${e}`))]),F_=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function L_(e){const t=parseFloat(e);return`${t}${String(e).replace(String(t),"")||"px"}`}function P_(e){let{breakpoints:t,values:n}=e,r="";Object.keys(n).forEach((e=>{""===r&&0!==n[e]&&(r=e)}));const s=Object.keys(t).sort(((e,n)=>t[e]-t[n]));return s.slice(0,s.indexOf(r))}const z_=eI("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{container:r,direction:s,item:a,spacing:i,wrap:o,zeroMinWidth:l,breakpoints:u}=n;let c=[];r&&(c=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return[n[`spacing-xs-${String(e)}`]];const r=[];return t.forEach((t=>{const s=e[t];Number(s)>0&&r.push(n[`spacing-${t}-${String(s)}`])})),r}(i,u,t));const d=[];return u.forEach((e=>{const r=n[e];r&&d.push(t[`grid-${e}-${String(r)}`])})),[t.root,r&&t.container,a&&t.item,l&&t.zeroMinWidth,...c,"row"!==s&&t[`direction-xs-${String(s)}`],"wrap"!==o&&t[`wrap-xs-${String(o)}`],...d]}})((e=>{let{ownerState:t}=e;return(0,He.A)({boxSizing:"border-box"},t.container&&{display:"flex",flexWrap:"wrap",width:"100%"},t.item&&{margin:0},t.zeroMinWidth&&{minWidth:0},"wrap"!==t.wrap&&{flexWrap:t.wrap})}),(function(e){let{theme:t,ownerState:n}=e;const r=(0,HA.kW)({values:n.direction,breakpoints:t.breakpoints.values});return(0,HA.NI)({theme:t},r,(e=>{const t={flexDirection:e};return 0===e.indexOf("column")&&(t[`& > .${M_.item}`]={maxWidth:"none"}),t}))}),(function(e){let{theme:t,ownerState:n}=e;const{container:r,rowSpacing:s}=n;let a={};if(r&&0!==s){const e=(0,HA.kW)({values:s,breakpoints:t.breakpoints.values});let n;"object"===typeof e&&(n=P_({breakpoints:t.breakpoints.values,values:e})),a=(0,HA.NI)({theme:t},e,((e,r)=>{var s;const a=t.spacing(e);return"0px"!==a?{marginTop:`-${L_(a)}`,[`& > .${M_.item}`]:{paddingTop:L_(a)}}:null!=(s=n)&&s.includes(r)?{}:{marginTop:0,[`& > .${M_.item}`]:{paddingTop:0}}}))}return a}),(function(e){let{theme:t,ownerState:n}=e;const{container:r,columnSpacing:s}=n;let a={};if(r&&0!==s){const e=(0,HA.kW)({values:s,breakpoints:t.breakpoints.values});let n;"object"===typeof e&&(n=P_({breakpoints:t.breakpoints.values,values:e})),a=(0,HA.NI)({theme:t},e,((e,r)=>{var s;const a=t.spacing(e);return"0px"!==a?{width:`calc(100% + ${L_(a)})`,marginLeft:`-${L_(a)}`,[`& > .${M_.item}`]:{paddingLeft:L_(a)}}:null!=(s=n)&&s.includes(r)?{}:{width:"100%",marginLeft:0,[`& > .${M_.item}`]:{paddingLeft:0}}}))}return a}),(function(e){let t,{theme:n,ownerState:r}=e;return n.breakpoints.keys.reduce(((e,s)=>{let a={};if(r[s]&&(t=r[s]),!t)return e;if(!0===t)a={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if("auto"===t)a={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const i=(0,HA.kW)({values:r.columns,breakpoints:n.breakpoints.values}),o="object"===typeof i?i[s]:i;if(void 0===o||null===o)return e;const l=Math.round(t/o*1e8)/1e6+"%";let u={};if(r.container&&r.item&&0!==r.columnSpacing){const e=n.spacing(r.columnSpacing);if("0px"!==e){const t=`calc(${l} + ${L_(e)})`;u={flexBasis:t,maxWidth:t}}}a=(0,He.A)({flexBasis:l,flexGrow:0,maxWidth:l},u)}return 0===n.breakpoints.values[s]?Object.assign(e,a):e[n.breakpoints.up(s)]=a,e}),{})}));const B_=e=>{const{classes:t,container:n,direction:r,item:s,spacing:a,wrap:i,zeroMinWidth:o,breakpoints:l}=e;let u=[];n&&(u=function(e,t){if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return[`spacing-xs-${String(e)}`];const n=[];return t.forEach((t=>{const r=e[t];if(Number(r)>0){const e=`spacing-${t}-${String(r)}`;n.push(e)}})),n}(a,l));const c=[];l.forEach((t=>{const n=e[t];n&&c.push(`grid-${t}-${String(n)}`)}));return _S({root:["root",n&&"container",s&&"item",o&&"zeroMinWidth",...u,"row"!==r&&`direction-xs-${String(r)}`,"wrap"!==i&&`wrap-xs-${String(i)}`,...c]},O_,t)};const j_=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiGrid"}),{breakpoints:r}=oE(),s=(0,Je.A)(n),{className:a,columns:i,columnSpacing:o,component:l="div",container:u=!1,direction:c="row",item:d=!1,rowSpacing:h,spacing:p=0,wrap:f="wrap",zeroMinWidth:m=!1}=s,g=(0,qe.A)(s,F_),y=h||p,v=o||p,b=A.useContext($_),x=u?i||12:b,w={},k=(0,He.A)({},g);r.keys.forEach((e=>{null!=g[e]&&(w[e]=g[e],delete k[e])}));const S=(0,He.A)({},s,{columns:x,container:u,direction:c,item:d,rowSpacing:y,columnSpacing:v,wrap:f,zeroMinWidth:m,spacing:p},w,{breakpoints:r.keys}),I=B_(S);return(0,st.jsx)($_.Provider,{value:x,children:(0,st.jsx)(z_,(0,He.A)({ownerState:S,className:Xe(I.root,a),as:l,ref:t},k))})}));function U_(e){return Vt("MuiDivider",e)}const V_=Wt("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);function W_(e){return Vt("MuiListItemIcon",e)}const G_=Wt("MuiListItemIcon",["root","alignItemsFlexStart"]);function H_(e){return Vt("MuiListItemText",e)}const q_=Wt("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function K_(e){return Vt("MuiMenuItem",e)}const X_=Wt("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Y_=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],Q_=eI(OC,{shouldForwardProp:e=>ZS(e)||"classes"===e,name:"MuiMenuItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.divider&&t.divider,!n.disableGutters&&t.gutters]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!n.disableGutters&&{paddingLeft:16,paddingRight:16},n.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${X_.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,dt.X4)(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${X_.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,dt.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${X_.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:(0,dt.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,dt.X4)(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${X_.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${X_.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${V_.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${V_.inset}`]:{marginLeft:52},[`& .${q_.root}`]:{marginTop:0,marginBottom:0},[`& .${q_.inset}`]:{paddingLeft:36},[`& .${G_.root}`]:{minWidth:36}},!n.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},n.dense&&(0,He.A)({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{[`& .${G_.root} svg`]:{fontSize:"1.25rem"}}))})),J_=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiMenuItem"}),{autoFocus:r=!1,component:s="li",dense:a=!1,divider:i=!1,disableGutters:o=!1,focusVisibleClassName:l,role:u="menuitem",tabIndex:c,className:d}=n,h=(0,qe.A)(n,Y_),p=A.useContext(FN),f=A.useMemo((()=>({dense:a||p.dense||!1,disableGutters:o})),[p.dense,a,o]),m=A.useRef(null);vT((()=>{r&&m.current&&m.current.focus()}),[r]);const g=(0,He.A)({},n,{dense:f.dense,divider:i,disableGutters:o}),y=(e=>{const{disabled:t,dense:n,divider:r,disableGutters:s,selected:a,classes:i}=e,o=_S({root:["root",n&&"dense",t&&"disabled",!s&&"gutters",r&&"divider",a&&"selected"]},K_,i);return(0,He.A)({},i,o)})(n),v=jI(m,t);let b;return n.disabled||(b=void 0!==c?c:-1),(0,st.jsx)(FN.Provider,{value:f,children:(0,st.jsx)(Q_,(0,He.A)({ref:v,role:u,tabIndex:b,component:s,focusVisibleClassName:Xe(y.focusVisible,l),className:Xe(y.root,d)},h,{ownerState:g,classes:y}))})})),Z_=["Account Information","Personal Details","Role Selection"],e$=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function t$(){const[e,t]=(0,A.useState)(0),[n,r]=(0,A.useState)(""),[s,a]=(0,A.useState)(""),[i,o]=(0,A.useState)(""),[l,u]=(0,A.useState)(""),[c,d]=(0,A.useState)(""),[h,p]=(0,A.useState)(""),[f,m]=(0,A.useState)("caregiver"),[g,y]=(0,A.useState)(""),[v,b]=(0,A.useState)(!1),[x,w]=(0,A.useState)(!1),{signup:k,checkEmailExists:S}=fS(),I=Te();(0,A.useEffect)((()=>{if(!n)return void a("");if(!e$.test(n))return void a("Please enter a valid email address");const e=setTimeout((async()=>{w(!0);try{const e=await S(n);a(e?"Email is already in use. Please try a different email.":"")}catch(g){console.error("Error checking email:",g)}finally{w(!1)}}),500);return()=>clearTimeout(e)}),[n,S]);const C=()=>{if(0===e){if(!n)return y("Email is required"),!1;if(s)return y(s),!1;if(!i)return y("Password is required"),!1;if(i.length<6)return y("Password must be at least 6 characters"),!1;if(i!==l)return y("Passwords do not match"),!1}else if(1===e){if(!c)return y("First name is required"),!1;if(!h)return y("Last name is required"),!1}return!0};return(0,st.jsx)(aI,{maxWidth:"sm",children:(0,st.jsxs)(qt,{sx:{marginTop:4,marginBottom:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,st.jsx)(hI,{component:"h1",variant:"h4",gutterBottom:!0,children:"Remote Patient Monitoring - Baadi"}),(0,st.jsx)(kI,{sx:{width:"100%",mt:3},children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{component:"h2",variant:"h5",align:"center",gutterBottom:!0,children:"Create an Account"}),(0,st.jsx)(u_,{activeStep:e,sx:{mt:3,mb:4},children:Z_.map((e=>(0,st.jsx)(p_,{children:(0,st.jsx)(__,{children:e})},e)))}),g&&(0,st.jsx)(rT,{severity:"error",sx:{mb:2},children:g}),(0,st.jsxs)(qt,{component:"form",onSubmit:2===e?async function(e){if(e.preventDefault(),C())try{y(""),b(!0),await k(n,i,c,h,f),I("/dashboard")}catch(g){console.error("Registration error:",g),"auth/email-already-in-use"===g.code?y("Email is already in use. Please try a different email or login."):"auth/invalid-email"===g.code?y("Invalid email format. Please enter a valid email address."):"auth/weak-password"===g.code?y("Password is too weak. Please choose a stronger password."):"permission-denied"===g.code?y("You do not have permission to register. Please contact support."):y("Failed to create an account. Please try again.")}finally{b(!1)}}:void 0,noValidate:!0,children:[0===e&&(0,st.jsxs)(st.Fragment,{children:[(0,st.jsx)(GA,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:n,onChange:e=>r(e.target.value),error:!!s,helperText:s,InputProps:{endAdornment:x?(0,st.jsx)(KR,{color:"inherit",size:20}):null}}),(0,st.jsx)(GA,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"new-password",value:i,onChange:e=>o(e.target.value)}),(0,st.jsx)(GA,{margin:"normal",required:!0,fullWidth:!0,name:"confirmPassword",label:"Confirm Password",type:"password",id:"confirmPassword",autoComplete:"new-password",value:l,onChange:e=>u(e.target.value)})]}),1===e&&(0,st.jsx)(st.Fragment,{children:(0,st.jsxs)(j_,{container:!0,spacing:2,children:[(0,st.jsx)(j_,{item:!0,xs:12,sm:6,children:(0,st.jsx)(GA,{margin:"normal",required:!0,fullWidth:!0,id:"firstName",label:"First Name",name:"firstName",autoComplete:"given-name",value:c,onChange:e=>d(e.target.value)})}),(0,st.jsx)(j_,{item:!0,xs:12,sm:6,children:(0,st.jsx)(GA,{margin:"normal",required:!0,fullWidth:!0,id:"lastName",label:"Last Name",name:"lastName",autoComplete:"family-name",value:h,onChange:e=>p(e.target.value)})})]})}),2===e&&(0,st.jsx)(st.Fragment,{children:(0,st.jsxs)(GA,{select:!0,margin:"normal",required:!0,fullWidth:!0,id:"role",label:"Your Role",name:"role",value:f,onChange:e=>m(e.target.value),helperText:"Please select your role in patient care",children:[(0,st.jsx)(J_,{value:"caregiver",children:"Primary Caregiver"}),(0,st.jsx)(J_,{value:"secondary_caregiver",children:"Secondary Caregiver"}),(0,st.jsx)(J_,{value:"family_member",children:"Family Member"}),(0,st.jsx)(J_,{value:"patient",children:"Patient"})]})}),(0,st.jsxs)(qt,{sx:{display:"flex",justifyContent:"space-between",mt:3},children:[(0,st.jsx)(OR,{disabled:0===e,onClick:()=>{y(""),t((e=>e-1))},variant:"outlined",children:"Back"}),e===Z_.length-1?(0,st.jsx)(OR,{type:"submit",variant:"contained",color:"primary",disabled:v||x,children:v?"Creating Account...":"Create Account"}):(0,st.jsx)(OR,{variant:"contained",onClick:()=>{y(""),C()&&t((e=>e+1))},disabled:x,children:"Next"})]}),(0,st.jsx)(qt,{sx:{mt:2,textAlign:"center"},children:(0,st.jsx)(TS,{to:"/login",style:{textDecoration:"none"},children:(0,st.jsx)(hI,{variant:"body2",color:"primary",children:"Already have an account? Sign In"})})})]})]})})]})})}function n$(){const[e,t]=(0,A.useState)(""),[n,r]=(0,A.useState)(""),[s,a]=(0,A.useState)(""),[i,o]=(0,A.useState)(!1),{resetPassword:l}=fS();return(0,st.jsx)(aI,{maxWidth:"sm",children:(0,st.jsxs)(qt,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80vh"},children:[(0,st.jsx)(hI,{component:"h1",variant:"h4",gutterBottom:!0,children:"Remote Patient Monitoring - Baadi"}),(0,st.jsx)(kI,{sx:{width:"100%",mt:3},children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{component:"h2",variant:"h5",align:"center",gutterBottom:!0,children:"Password Reset"}),(0,st.jsx)(hI,{variant:"body1",align:"center",sx:{mb:3},children:"Enter your email address and we'll send you a link to reset your password."}),n&&(0,st.jsx)(rT,{severity:"error",sx:{mb:2},children:n}),s&&(0,st.jsx)(rT,{severity:"success",sx:{mb:2},children:s}),(0,st.jsxs)(qt,{component:"form",onSubmit:async function(t){t.preventDefault();try{a(""),r(""),o(!0),await l(e),a("Check your email for further instructions")}catch(n){console.error("Password reset error:",n),r("Failed to reset password. Please check if the email is correct.")}finally{o(!1)}},noValidate:!0,children:[(0,st.jsx)(GA,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:e,onChange:e=>t(e.target.value)}),(0,st.jsx)(OR,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",sx:{mt:3,mb:2},disabled:i,children:i?"Sending...":"Reset Password"}),(0,st.jsx)(qt,{sx:{display:"flex",justifyContent:"center"},children:(0,st.jsx)(TS,{to:"/login",style:{textDecoration:"none"},children:(0,st.jsx)(hI,{variant:"body2",color:"primary",children:"Return to Login"})})})]})]})})]})})}const r$=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],s$=eI("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.absolute&&t.absolute,t[n.variant],n.light&&t.light,"vertical"===n.orientation&&t.vertical,n.flexItem&&t.flexItem,n.children&&t.withChildren,n.children&&"vertical"===n.orientation&&t.withChildrenVertical,"right"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignRight,"left"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignLeft]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin"},n.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},n.light&&{borderColor:t.vars?`rgba(${t.vars.palette.dividerChannel} / 0.08)`:(0,dt.X4)(t.palette.divider,.08)},"inset"===n.variant&&{marginLeft:72},"middle"===n.variant&&"horizontal"===n.orientation&&{marginLeft:t.spacing(2),marginRight:t.spacing(2)},"middle"===n.variant&&"vertical"===n.orientation&&{marginTop:t.spacing(1),marginBottom:t.spacing(1)},"vertical"===n.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},n.flexItem&&{alignSelf:"stretch",height:"auto"})}),(e=>{let{ownerState:t}=e;return(0,He.A)({},t.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({},n.children&&"vertical"!==n.orientation&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({},n.children&&"vertical"===n.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}})}),(e=>{let{ownerState:t}=e;return(0,He.A)({},"right"===t.textAlign&&"vertical"!==t.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===t.textAlign&&"vertical"!==t.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})})),a$=eI("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.wrapper,"vertical"===n.orientation&&t.wrapperVertical]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`},"vertical"===n.orientation&&{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`})})),i$=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiDivider"}),{absolute:r=!1,children:s,className:a,component:i=(s?"div":"hr"),flexItem:o=!1,light:l=!1,orientation:u="horizontal",role:c=("hr"!==i?"separator":void 0),textAlign:d="center",variant:h="fullWidth"}=n,p=(0,qe.A)(n,r$),f=(0,He.A)({},n,{absolute:r,component:i,flexItem:o,light:l,orientation:u,role:c,textAlign:d,variant:h}),m=(e=>{const{absolute:t,children:n,classes:r,flexItem:s,light:a,orientation:i,textAlign:o,variant:l}=e;return _S({root:["root",t&&"absolute",l,a&&"light","vertical"===i&&"vertical",s&&"flexItem",n&&"withChildren",n&&"vertical"===i&&"withChildrenVertical","right"===o&&"vertical"!==i&&"textAlignRight","left"===o&&"vertical"!==i&&"textAlignLeft"],wrapper:["wrapper","vertical"===i&&"wrapperVertical"]},U_,r)})(f);return(0,st.jsx)(s$,(0,He.A)({as:i,className:Xe(m.root,a),role:c,ref:t,ownerState:f},p,{children:s?(0,st.jsx)(a$,{className:m.wrapper,ownerState:f,children:s}):null}))}));i$.muiSkipListHighlight=!0;const o$=i$,l$=WC((0,st.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function u$(e){return Vt("MuiChip",e)}const c$=Wt("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),d$=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],h$=eI("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{color:r,iconColor:s,clickable:a,onDelete:i,size:o,variant:l}=n;return[{[`& .${c$.avatar}`]:t.avatar},{[`& .${c$.avatar}`]:t[`avatar${XS(o)}`]},{[`& .${c$.avatar}`]:t[`avatarColor${XS(r)}`]},{[`& .${c$.icon}`]:t.icon},{[`& .${c$.icon}`]:t[`icon${XS(o)}`]},{[`& .${c$.icon}`]:t[`iconColor${XS(s)}`]},{[`& .${c$.deleteIcon}`]:t.deleteIcon},{[`& .${c$.deleteIcon}`]:t[`deleteIcon${XS(o)}`]},{[`& .${c$.deleteIcon}`]:t[`deleteIconColor${XS(r)}`]},{[`& .${c$.deleteIcon}`]:t[`deleteIcon${XS(l)}Color${XS(r)}`]},t.root,t[`size${XS(o)}`],t[`color${XS(r)}`],a&&t.clickable,a&&"default"!==r&&t[`clickableColor${XS(r)})`],i&&t.deletable,i&&"default"!==r&&t[`deletableColor${XS(r)}`],t[l],t[`${l}${XS(r)}`]]}})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode?t.palette.grey[700]:t.palette.grey[300];return(0,He.A)({maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:16,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${c$.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${c$.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:r,fontSize:t.typography.pxToRem(12)},[`& .${c$.avatarColorPrimary}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},[`& .${c$.avatarColorSecondary}`]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},[`& .${c$.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},[`& .${c$.icon}`]:(0,He.A)({marginLeft:5,marginRight:-6},"small"===n.size&&{fontSize:18,marginLeft:4,marginRight:-4},n.iconColor===n.color&&(0,He.A)({color:t.vars?t.vars.palette.Chip.defaultIconColor:r},"default"!==n.color&&{color:"inherit"})),[`& .${c$.deleteIcon}`]:(0,He.A)({WebkitTapHighlightColor:"transparent",color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.26)`:(0,dt.X4)(t.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.4)`:(0,dt.X4)(t.palette.text.primary,.4)}},"small"===n.size&&{fontSize:16,marginRight:4,marginLeft:-4},"default"!==n.color&&{color:t.vars?`rgba(${t.vars.palette[n.color].contrastTextChannel} / 0.7)`:(0,dt.X4)(t.palette[n.color].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[n.color].contrastText}})},"small"===n.size&&{height:24},"default"!==n.color&&{backgroundColor:(t.vars||t).palette[n.color].main,color:(t.vars||t).palette[n.color].contrastText},n.onDelete&&{[`&.${c$.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,dt.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},n.onDelete&&"default"!==n.color&&{[`&.${c$.focusVisible}`]:{backgroundColor:(t.vars||t).palette[n.color].dark}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({},n.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:(0,dt.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)},[`&.${c$.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,dt.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},"&:active":{boxShadow:(t.vars||t).shadows[1]}},n.clickable&&"default"!==n.color&&{[`&:hover, &.${c$.focusVisible}`]:{backgroundColor:(t.vars||t).palette[n.color].dark}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({},"outlined"===n.variant&&{backgroundColor:"transparent",border:t.vars?`1px solid ${t.vars.palette.Chip.defaultBorder}`:`1px solid ${"light"===t.palette.mode?t.palette.grey[400]:t.palette.grey[700]}`,[`&.${c$.clickable}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${c$.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`& .${c$.avatar}`]:{marginLeft:4},[`& .${c$.avatarSmall}`]:{marginLeft:2},[`& .${c$.icon}`]:{marginLeft:4},[`& .${c$.iconSmall}`]:{marginLeft:2},[`& .${c$.deleteIcon}`]:{marginRight:5},[`& .${c$.deleteIconSmall}`]:{marginRight:3}},"outlined"===n.variant&&"default"!==n.color&&{color:(t.vars||t).palette[n.color].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / 0.7)`:(0,dt.X4)(t.palette[n.color].main,.7)}`,[`&.${c$.clickable}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,dt.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity)},[`&.${c$.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / ${t.vars.palette.action.focusOpacity})`:(0,dt.X4)(t.palette[n.color].main,t.palette.action.focusOpacity)},[`& .${c$.deleteIcon}`]:{color:t.vars?`rgba(${t.vars.palette[n.color].mainChannel} / 0.7)`:(0,dt.X4)(t.palette[n.color].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[n.color].main}}})})),p$=eI("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,t)=>{const{ownerState:n}=e,{size:r}=n;return[t.label,t[`label${XS(r)}`]]}})((e=>{let{ownerState:t}=e;return(0,He.A)({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},"outlined"===t.variant&&{paddingLeft:11,paddingRight:11},"small"===t.size&&{paddingLeft:8,paddingRight:8},"small"===t.size&&"outlined"===t.variant&&{paddingLeft:7,paddingRight:7})}));function f$(e){return"Backspace"===e.key||"Delete"===e.key}const m$=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiChip"}),{avatar:r,className:s,clickable:a,color:i="default",component:o,deleteIcon:l,disabled:u=!1,icon:c,label:d,onClick:h,onDelete:p,onKeyDown:f,onKeyUp:m,size:g="medium",variant:y="filled",tabIndex:v,skipFocusWhenDisabled:b=!1}=n,x=(0,qe.A)(n,d$),w=A.useRef(null),k=jI(w,t),S=e=>{e.stopPropagation(),p&&p(e)},I=!(!1===a||!h)||a,C=I||p?OC:o||"div",T=(0,He.A)({},n,{component:C,disabled:u,size:g,color:i,iconColor:A.isValidElement(c)&&c.props.color||i,onDelete:!!p,clickable:I,variant:y}),N=(e=>{const{classes:t,disabled:n,size:r,color:s,iconColor:a,onDelete:i,clickable:o,variant:l}=e;return _S({root:["root",l,n&&"disabled",`size${XS(r)}`,`color${XS(s)}`,o&&"clickable",o&&`clickableColor${XS(s)}`,i&&"deletable",i&&`deletableColor${XS(s)}`,`${l}${XS(s)}`],label:["label",`label${XS(r)}`],avatar:["avatar",`avatar${XS(r)}`,`avatarColor${XS(s)}`],icon:["icon",`icon${XS(r)}`,`iconColor${XS(a)}`],deleteIcon:["deleteIcon",`deleteIcon${XS(r)}`,`deleteIconColor${XS(s)}`,`deleteIcon${XS(l)}Color${XS(s)}`]},u$,t)})(T),E=C===OC?(0,He.A)({component:o||"div",focusVisibleClassName:N.focusVisible},p&&{disableRipple:!0}):{};let R=null;p&&(R=l&&A.isValidElement(l)?A.cloneElement(l,{className:Xe(l.props.className,N.deleteIcon),onClick:S}):(0,st.jsx)(l$,{className:Xe(N.deleteIcon),onClick:S}));let _=null;r&&A.isValidElement(r)&&(_=A.cloneElement(r,{className:Xe(N.avatar,r.props.className)}));let $=null;return c&&A.isValidElement(c)&&($=A.cloneElement(c,{className:Xe(N.icon,c.props.className)})),(0,st.jsxs)(h$,(0,He.A)({as:C,className:Xe(N.root,s),disabled:!(!I||!u)||void 0,onClick:h,onKeyDown:e=>{e.currentTarget===e.target&&f$(e)&&e.preventDefault(),f&&f(e)},onKeyUp:e=>{e.currentTarget===e.target&&(p&&f$(e)?p(e):"Escape"===e.key&&w.current&&w.current.blur()),m&&m(e)},ref:k,tabIndex:b&&u?-1:v,ownerState:T},E,x,{children:[_||$,(0,st.jsx)(p$,{className:Xe(N.label),ownerState:T,children:d}),R]}))})),g$=m$;var y$=n(1188);const v$={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};const b$=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))};function x$(e,t){return e-t}function w$(e,t){var n;const{index:r}=null!=(n=e.reduce(((e,n,r)=>{const s=Math.abs(t-n);return null===e||s<e.distance||s===e.distance?{distance:s,index:r}:e}),null))?n:{};return r}function k$(e,t){if(void 0!==t.current&&e.changedTouches){const n=e;for(let e=0;e<n.changedTouches.length;e+=1){const r=n.changedTouches[e];if(r.identifier===t.current)return{x:r.clientX,y:r.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function S$(e,t,n){return 100*(e-t)/(n-t)}function I$(e,t,n){const r=Math.round((e-n)/t)*t+n;return Number(r.toFixed(function(e){if(Math.abs(e)<1){const t=e.toExponential().split("e-"),n=t[0].split(".")[1];return(n?n.length:0)+parseInt(t[1],10)}const t=e.toString().split(".")[1];return t?t.length:0}(t)))}function C$(e){let{values:t,newValue:n,index:r}=e;const s=t.slice();return s[r]=n,s.sort(x$)}function T$(e){let{sliderRef:t,activeIndex:n,setActive:r}=e;var s,a;const i=oT(t.current);var o;null!=(s=t.current)&&s.contains(i.activeElement)&&Number(null==i||null==(a=i.activeElement)?void 0:a.getAttribute("data-index"))===n||(null==(o=t.current)||o.querySelector(`[type="range"][data-index="${n}"]`).focus());r&&r(n)}function N$(e,t){return"number"===typeof e&&"number"===typeof t?e===t:"object"===typeof e&&"object"===typeof t&&b$(e,t)}const E$={horizontal:{offset:e=>({left:`${e}%`}),leap:e=>({width:`${e}%`})},"horizontal-reverse":{offset:e=>({right:`${e}%`}),leap:e=>({width:`${e}%`})},vertical:{offset:e=>({bottom:`${e}%`}),leap:e=>({height:`${e}%`})}},A$=e=>e;let R$;function _$(){return void 0===R$&&(R$="undefined"===typeof CSS||"function"!==typeof CSS.supports||CSS.supports("touch-action","none")),R$}const $$=e=>!e||!AI(e);function O$(e){return Vt("MuiSlider",e)}const D$=Wt("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]);const M$=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","shiftStep","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"];function F$(e){return e}const L$=eI("span",{name:"MuiSlider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`color${XS(n.color)}`],"medium"!==n.size&&t[`size${XS(n.size)}`],n.marked&&t.marked,"vertical"===n.orientation&&t.vertical,"inverted"===n.track&&t.trackInverted,!1===n.track&&t.trackFalse]}})((e=>{let{theme:t}=e;var n;return{borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${D$.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${D$.dragging}`]:{[`& .${D$.thumb}, & .${D$.track}`]:{transition:"none"}},variants:[...Object.keys((null!=(n=t.vars)?n:t).palette).filter((e=>{var n;return(null!=(n=t.vars)?n:t).palette[e].main})).map((e=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}})),P$=eI("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(e,t)=>t.rail})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),z$=eI("span",{name:"MuiSlider",slot:"Track",overridesResolver:(e,t)=>t.track})((e=>{let{theme:t}=e;var n;return{display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.keys((null!=(n=t.vars)?n:t).palette).filter((e=>{var n;return(null!=(n=t.vars)?n:t).palette[e].main})).map((e=>({props:{color:e,track:"inverted"},style:(0,He.A)({},t.vars?{backgroundColor:t.vars.palette.Slider[`${e}Track`],borderColor:t.vars.palette.Slider[`${e}Track`]}:(0,He.A)({backgroundColor:(0,dt.a)(t.palette[e].main,.62),borderColor:(0,dt.a)(t.palette[e].main,.62)},t.applyStyles("dark",{backgroundColor:(0,dt.e$)(t.palette[e].main,.5)}),t.applyStyles("dark",{borderColor:(0,dt.e$)(t.palette[e].main,.5)})))})))]}})),B$=eI("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.thumb,t[`thumbColor${XS(n.color)}`],"medium"!==n.size&&t[`thumbSize${XS(n.size)}`]]}})((e=>{let{theme:t}=e;var n;return{position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${D$.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.keys((null!=(n=t.vars)?n:t).palette).filter((e=>{var n;return(null!=(n=t.vars)?n:t).palette[e].main})).map((e=>({props:{color:e},style:{[`&:hover, &.${D$.focusVisible}`]:(0,He.A)({},t.vars?{boxShadow:`0px 0px 0px 8px rgba(${t.vars.palette[e].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 8px ${(0,dt.X4)(t.palette[e].main,.16)}`},{"@media (hover: none)":{boxShadow:"none"}}),[`&.${D$.active}`]:(0,He.A)({},t.vars?{boxShadow:`0px 0px 0px 14px rgba(${t.vars.palette[e].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 14px ${(0,dt.X4)(t.palette[e].main,.16)}`})}})))]}})),j$=eI((function(e){const{children:t,className:n,value:r}=e,s=(e=>{const{open:t}=e;return{offset:Xe(t&&D$.valueLabelOpen),circle:D$.valueLabelCircle,label:D$.valueLabelLabel}})(e);return t?A.cloneElement(t,{className:Xe(t.props.className)},(0,st.jsxs)(A.Fragment,{children:[t.props.children,(0,st.jsx)("span",{className:Xe(s.offset,n),"aria-hidden":!0,children:(0,st.jsx)("span",{className:s.circle,children:(0,st.jsx)("span",{className:s.label,children:r})})})]})):null}),{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(e,t)=>t.valueLabel})((e=>{let{theme:t}=e;return(0,He.A)({zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${D$.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${D$.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]})})),U$=eI("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:e=>JS(e)&&"markActive"!==e,overridesResolver:(e,t)=>{const{markActive:n}=e;return[t.mark,n&&t.markActive]}})((e=>{let{theme:t}=e;return{position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}})),V$=eI("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:e=>JS(e)&&"markLabelActive"!==e,overridesResolver:(e,t)=>t.markLabel})((e=>{let{theme:t}=e;return(0,He.A)({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]})})),W$=e=>{let{children:t}=e;return t},G$=A.forwardRef((function(e,t){var n,r,s,a,i,o,l,u,c,d,h,p,f,m,g,y,v,b,x,w,k,S,I,C;const T=sI({props:e,name:"MuiSlider"}),N=$N(),{"aria-label":E,"aria-valuetext":R,"aria-labelledby":_,component:$="span",components:O={},componentsProps:D={},color:M="primary",classes:F,className:L,disableSwap:P=!1,disabled:z=!1,getAriaLabel:B,getAriaValueText:j,marks:U=!1,max:V=100,min:W=0,orientation:G="horizontal",shiftStep:H=10,size:q="medium",step:K=1,scale:X=F$,slotProps:Y,slots:Q,track:J="normal",valueLabelDisplay:Z="off",valueLabelFormat:ee=F$}=T,te=(0,qe.A)(T,M$),ne=(0,He.A)({},T,{isRtl:N,max:V,min:W,classes:F,disabled:z,disableSwap:P,orientation:G,marks:U,color:M,size:q,step:K,shiftStep:H,scale:X,track:J,valueLabelDisplay:Z,valueLabelFormat:ee}),{axisProps:re,getRootProps:se,getHiddenInputProps:ae,getThumbProps:ie,open:oe,active:le,axis:ue,focusedThumbIndex:ce,range:de,dragging:he,marks:pe,values:fe,trackOffset:me,trackLeap:ge,getThumbStyle:ye}=function(e){const{"aria-labelledby":t,defaultValue:n,disabled:r=!1,disableSwap:s=!1,isRtl:a=!1,marks:i=!1,max:o=100,min:l=0,name:u,onChange:c,onChangeCommitted:d,orientation:h="horizontal",rootRef:p,scale:f=A$,step:m=1,shiftStep:g=10,tabIndex:y,value:v}=e,b=A.useRef(void 0),[x,w]=A.useState(-1),[k,S]=A.useState(-1),[I,C]=A.useState(!1),T=A.useRef(0),[N,E]=vA({controlled:v,default:null!=n?n:l,name:"Slider"}),R=c&&((e,t,n)=>{const r=e.nativeEvent||e,s=new r.constructor(r.type,r);Object.defineProperty(s,"target",{writable:!0,value:{value:t,name:u}}),c(s,t,n)}),_=Array.isArray(N);let $=_?N.slice().sort(x$):[N];$=$.map((e=>null==e?l:(0,y$.A)(e,l,o)));const O=!0===i&&null!==m?[...Array(Math.floor((o-l)/m)+1)].map(((e,t)=>({value:l+m*t}))):i||[],D=O.map((e=>e.value)),{isFocusVisibleRef:M,onBlur:F,onFocus:L,ref:P}=rC(),[z,B]=A.useState(-1),j=A.useRef(null),U=EI(P,j),V=EI(p,U),W=e=>t=>{var n;const r=Number(t.currentTarget.getAttribute("data-index"));L(t),!0===M.current&&B(r),S(r),null==e||null==(n=e.onFocus)||n.call(e,t)},G=e=>t=>{var n;F(t),!1===M.current&&B(-1),S(-1),null==e||null==(n=e.onBlur)||n.call(e,t)},H=(e,t)=>{const n=Number(e.currentTarget.getAttribute("data-index")),r=$[n],a=D.indexOf(r);let i=t;if(O&&null==m){const e=D[D.length-1];i=i>e?e:i<D[0]?D[0]:i<r?D[a-1]:D[a+1]}if(i=(0,y$.A)(i,l,o),_){s&&(i=(0,y$.A)(i,$[n-1]||-1/0,$[n+1]||1/0));const e=i;i=C$({values:$,newValue:i,index:n});let t=n;s||(t=i.indexOf(e)),T$({sliderRef:j,activeIndex:t})}E(i),B(n),R&&!N$(i,N)&&R(e,i,n),d&&d(e,i)},q=e=>t=>{var n;if(null!==m){const e=Number(t.currentTarget.getAttribute("data-index")),n=$[e];let r=null;("ArrowLeft"===t.key||"ArrowDown"===t.key)&&t.shiftKey||"PageDown"===t.key?r=Math.max(n-g,l):(("ArrowRight"===t.key||"ArrowUp"===t.key)&&t.shiftKey||"PageUp"===t.key)&&(r=Math.min(n+g,o)),null!==r&&(H(t,r),t.preventDefault())}null==e||null==(n=e.onKeyDown)||n.call(e,t)};UI((()=>{var e;r&&j.current.contains(document.activeElement)&&(null==(e=document.activeElement)||e.blur())}),[r]),r&&-1!==x&&w(-1),r&&-1!==z&&B(-1);const K=A.useRef(void 0);let X=h;a&&"horizontal"===h&&(X+="-reverse");const Y=e=>{let{finger:t,move:n=!1}=e;const{current:r}=j,{width:a,height:i,bottom:u,left:c}=r.getBoundingClientRect();let d,h;if(d=0===X.indexOf("vertical")?(u-t.y)/i:(t.x-c)/a,-1!==X.indexOf("-reverse")&&(d=1-d),h=function(e,t,n){return(n-t)*e+t}(d,l,o),m)h=I$(h,m,l);else{const e=w$(D,h);h=D[e]}h=(0,y$.A)(h,l,o);let p=0;if(_){p=n?K.current:w$($,h),s&&(h=(0,y$.A)(h,$[p-1]||-1/0,$[p+1]||1/0));const e=h;h=C$({values:$,newValue:h,index:p}),s&&n||(p=h.indexOf(e),K.current=p)}return{newValue:h,activeIndex:p}},Q=VI((e=>{const t=k$(e,b);if(!t)return;if(T.current+=1,"mousemove"===e.type&&0===e.buttons)return void J(e);const{newValue:n,activeIndex:r}=Y({finger:t,move:!0});T$({sliderRef:j,activeIndex:r,setActive:w}),E(n),!I&&T.current>2&&C(!0),R&&!N$(n,N)&&R(e,n,r)})),J=VI((e=>{const t=k$(e,b);if(C(!1),!t)return;const{newValue:n}=Y({finger:t,move:!0});w(-1),"touchend"===e.type&&S(-1),d&&d(e,n),b.current=void 0,ee()})),Z=VI((e=>{if(r)return;_$()||e.preventDefault();const t=e.changedTouches[0];null!=t&&(b.current=t.identifier);const n=k$(e,b);if(!1!==n){const{newValue:t,activeIndex:r}=Y({finger:n});T$({sliderRef:j,activeIndex:r,setActive:w}),E(t),R&&!N$(t,N)&&R(e,t,r)}T.current=0;const s=oT(j.current);s.addEventListener("touchmove",Q,{passive:!0}),s.addEventListener("touchend",J,{passive:!0})})),ee=A.useCallback((()=>{const e=oT(j.current);e.removeEventListener("mousemove",Q),e.removeEventListener("mouseup",J),e.removeEventListener("touchmove",Q),e.removeEventListener("touchend",J)}),[J,Q]);A.useEffect((()=>{const{current:e}=j;return e.addEventListener("touchstart",Z,{passive:_$()}),()=>{e.removeEventListener("touchstart",Z),ee()}}),[ee,Z]),A.useEffect((()=>{r&&ee()}),[r,ee]);const te=S$(_?$[0]:l,l,o),ne=S$($[$.length-1],l,o)-te,re=e=>t=>{var n;null==(n=e.onMouseLeave)||n.call(e,t),S(-1)};return{active:x,axis:X,axisProps:E$,dragging:I,focusedThumbIndex:z,getHiddenInputProps:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var s;const i=$I(n),c={onChange:(d=i||{},e=>{var t;null==(t=d.onChange)||t.call(d,e),H(e,e.target.valueAsNumber)}),onFocus:W(i||{}),onBlur:G(i||{}),onKeyDown:q(i||{})};var d;const p=(0,He.A)({},i,c);return(0,He.A)({tabIndex:y,"aria-labelledby":t,"aria-orientation":h,"aria-valuemax":f(o),"aria-valuemin":f(l),name:u,type:"range",min:e.min,max:e.max,step:null===e.step&&e.marks?"any":null!=(s=e.step)?s:void 0,disabled:r},n,p,{style:(0,He.A)({},v$,{direction:a?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=$I(e),n={onMouseDown:(s=t||{},e=>{var t;if(null==(t=s.onMouseDown)||t.call(s,e),r)return;if(e.defaultPrevented)return;if(0!==e.button)return;e.preventDefault();const n=k$(e,b);if(!1!==n){const{newValue:t,activeIndex:r}=Y({finger:n});T$({sliderRef:j,activeIndex:r,setActive:w}),E(t),R&&!N$(t,N)&&R(e,t,r)}T.current=0;const a=oT(j.current);a.addEventListener("mousemove",Q,{passive:!0}),a.addEventListener("mouseup",J)})};var s;const a=(0,He.A)({},t,n);return(0,He.A)({},e,{ref:V},a)},getThumbProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=$I(e),n={onMouseOver:(r=t||{},e=>{var t;null==(t=r.onMouseOver)||t.call(r,e);const n=Number(e.currentTarget.getAttribute("data-index"));S(n)}),onMouseLeave:re(t||{})};var r;return(0,He.A)({},e,t,n)},marks:O,open:k,range:_,rootRef:V,trackLeap:ne,trackOffset:te,values:$,getThumbStyle:e=>({pointerEvents:-1!==x&&x!==e?"none":void 0})}}((0,He.A)({},ne,{rootRef:t}));ne.marked=pe.length>0&&pe.some((e=>e.label)),ne.dragging=he,ne.focusedThumbIndex=ce;const ve=(e=>{const{disabled:t,dragging:n,marked:r,orientation:s,track:a,classes:i,color:o,size:l}=e;return _S({root:["root",t&&"disabled",n&&"dragging",r&&"marked","vertical"===s&&"vertical","inverted"===a&&"trackInverted",!1===a&&"trackFalse",o&&`color${XS(o)}`,l&&`size${XS(l)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",t&&"disabled",l&&`thumbSize${XS(l)}`,o&&`thumbColor${XS(o)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]},O$,i)})(ne),be=null!=(n=null!=(r=null==Q?void 0:Q.root)?r:O.Root)?n:L$,xe=null!=(s=null!=(a=null==Q?void 0:Q.rail)?a:O.Rail)?s:P$,we=null!=(i=null!=(o=null==Q?void 0:Q.track)?o:O.Track)?i:z$,ke=null!=(l=null!=(u=null==Q?void 0:Q.thumb)?u:O.Thumb)?l:B$,Se=null!=(c=null!=(d=null==Q?void 0:Q.valueLabel)?d:O.ValueLabel)?c:j$,Ie=null!=(h=null!=(p=null==Q?void 0:Q.mark)?p:O.Mark)?h:U$,Ce=null!=(f=null!=(m=null==Q?void 0:Q.markLabel)?m:O.MarkLabel)?f:V$,Te=null!=(g=null!=(y=null==Q?void 0:Q.input)?y:O.Input)?g:"input",Ne=null!=(v=null==Y?void 0:Y.root)?v:D.root,Ee=null!=(b=null==Y?void 0:Y.rail)?b:D.rail,Ae=null!=(x=null==Y?void 0:Y.track)?x:D.track,Re=null!=(w=null==Y?void 0:Y.thumb)?w:D.thumb,_e=null!=(k=null==Y?void 0:Y.valueLabel)?k:D.valueLabel,$e=null!=(S=null==Y?void 0:Y.mark)?S:D.mark,Oe=null!=(I=null==Y?void 0:Y.markLabel)?I:D.markLabel,De=null!=(C=null==Y?void 0:Y.input)?C:D.input,Me=MN({elementType:be,getSlotProps:se,externalSlotProps:Ne,externalForwardedProps:te,additionalProps:(0,He.A)({},$$(be)&&{as:$}),ownerState:(0,He.A)({},ne,null==Ne?void 0:Ne.ownerState),className:[ve.root,L]}),Fe=MN({elementType:xe,externalSlotProps:Ee,ownerState:ne,className:ve.rail}),Le=MN({elementType:we,externalSlotProps:Ae,additionalProps:{style:(0,He.A)({},re[ue].offset(me),re[ue].leap(ge))},ownerState:(0,He.A)({},ne,null==Ae?void 0:Ae.ownerState),className:ve.track}),Pe=MN({elementType:ke,getSlotProps:ie,externalSlotProps:Re,ownerState:(0,He.A)({},ne,null==Re?void 0:Re.ownerState),className:ve.thumb}),ze=MN({elementType:Se,externalSlotProps:_e,ownerState:(0,He.A)({},ne,null==_e?void 0:_e.ownerState),className:ve.valueLabel}),Be=MN({elementType:Ie,externalSlotProps:$e,ownerState:ne,className:ve.mark}),je=MN({elementType:Ce,externalSlotProps:Oe,ownerState:ne,className:ve.markLabel}),Ue=MN({elementType:Te,getSlotProps:ae,externalSlotProps:De,ownerState:ne});return(0,st.jsxs)(be,(0,He.A)({},Me,{children:[(0,st.jsx)(xe,(0,He.A)({},Fe)),(0,st.jsx)(we,(0,He.A)({},Le)),pe.filter((e=>e.value>=W&&e.value<=V)).map(((e,t)=>{const n=S$(e.value,W,V),r=re[ue].offset(n);let s;return s=!1===J?-1!==fe.indexOf(e.value):"normal"===J&&(de?e.value>=fe[0]&&e.value<=fe[fe.length-1]:e.value<=fe[0])||"inverted"===J&&(de?e.value<=fe[0]||e.value>=fe[fe.length-1]:e.value>=fe[0]),(0,st.jsxs)(A.Fragment,{children:[(0,st.jsx)(Ie,(0,He.A)({"data-index":t},Be,!AI(Ie)&&{markActive:s},{style:(0,He.A)({},r,Be.style),className:Xe(Be.className,s&&ve.markActive)})),null!=e.label?(0,st.jsx)(Ce,(0,He.A)({"aria-hidden":!0,"data-index":t},je,!AI(Ce)&&{markLabelActive:s},{style:(0,He.A)({},r,je.style),className:Xe(ve.markLabel,je.className,s&&ve.markLabelActive),children:e.label})):null]},t)})),fe.map(((e,t)=>{const n=S$(e,W,V),r=re[ue].offset(n),s="off"===Z?W$:Se;return(0,st.jsx)(s,(0,He.A)({},!AI(s)&&{valueLabelFormat:ee,valueLabelDisplay:Z,value:"function"===typeof ee?ee(X(e),t):ee,index:t,open:oe===t||le===t||"on"===Z,disabled:z},ze,{children:(0,st.jsx)(ke,(0,He.A)({"data-index":t},Pe,{className:Xe(ve.thumb,Pe.className,le===t&&ve.active,ce===t&&ve.focusVisible),style:(0,He.A)({},r,ye(t),Pe.style),children:(0,st.jsx)(Te,(0,He.A)({"data-index":t,"aria-label":B?B(t):E,"aria-valuenow":X(e),"aria-labelledby":_,"aria-valuetext":j?j(X(e),t):R,value:fe[t]},Ue))}))}),t)}))]}))}));function H$(e){return Vt("MuiSwitch",e)}const q$=Wt("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),K$=["className","color","edge","size","sx"],X$=eI("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.edge&&t[`edge${XS(n.edge)}`],t[`size${XS(n.size)}`]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${q$.thumb}`]:{width:16,height:16},[`& .${q$.switchBase}`]:{padding:4,[`&.${q$.checked}`]:{transform:"translateX(16px)"}}}}]}),Y$=eI(dR,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.switchBase,{[`& .${q$.input}`]:t.input},"default"!==n.color&&t[`color${XS(n.color)}`]]}})((e=>{let{theme:t}=e;return{position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${"light"===t.palette.mode?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${q$.checked}`]:{transform:"translateX(20px)"},[`&.${q$.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${"light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${q$.checked} + .${q$.track}`]:{opacity:.5},[`&.${q$.disabled} + .${q$.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:""+("light"===t.palette.mode?.12:.2)},[`& .${q$.input}`]:{left:"-100%",width:"300%"}}}),(e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,dt.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.light})).map((e=>{let[n]=e;return{props:{color:n},style:{[`&.${q$.checked}`]:{color:(t.vars||t).palette[n].main,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,dt.X4)(t.palette[n].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${q$.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${n}DisabledColor`]:`${"light"===t.palette.mode?(0,dt.a)(t.palette[n].main,.62):(0,dt.e$)(t.palette[n].main,.55)}`}},[`&.${q$.checked} + .${q$.track}`]:{backgroundColor:(t.vars||t).palette[n].main}}}}))]}})),Q$=eI("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})((e=>{let{theme:t}=e;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${"light"===t.palette.mode?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:""+("light"===t.palette.mode?.38:.3)}})),J$=eI("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})((e=>{let{theme:t}=e;return{boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}})),Z$=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiSwitch"}),{className:r,color:s="primary",edge:a=!1,size:i="medium",sx:o}=n,l=(0,qe.A)(n,K$),u=(0,He.A)({},n,{color:s,edge:a,size:i}),c=(e=>{const{classes:t,edge:n,size:r,color:s,checked:a,disabled:i}=e,o=_S({root:["root",n&&`edge${XS(n)}`,`size${XS(r)}`],switchBase:["switchBase",`color${XS(s)}`,a&&"checked",i&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},H$,t);return(0,He.A)({},t,o)})(u),d=(0,st.jsx)(J$,{className:c.thumb,ownerState:u});return(0,st.jsxs)(X$,{className:Xe(c.root,r),sx:o,ownerState:u,children:[(0,st.jsx)(Y$,(0,He.A)({type:"checkbox",icon:d,checkedIcon:d,ref:t,ownerState:u},l,{classes:(0,He.A)({},c,{root:c.switchBase})})),(0,st.jsx)(Q$,{className:c.track,ownerState:u})]})})),eO=WC((0,st.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),tO=WC((0,st.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning"),nO=WC((0,st.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings");var rO=n(7029),sO=n.n(rO);class aO{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class iO{refCount(e){return oO("refCount")}incRef(e){return oO("incRef")}timerAvailable(){return!0}time(e){return oO("time")}read(e){return oO("read")}readSync(e){return oO("readSync")}readToGPU(e,t){return oO("readToGPU")}numDataIds(){return oO("numDataIds")}disposeData(e,t){return oO("disposeData")}write(e,t,n){return oO("write")}move(e,t,n,r,s){return oO("move")}createTensorFromGPUData(e,t,n){return oO("createTensorFromGPUData")}memory(){return oO("memory")}floatPrecision(){return oO("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return oO("dispose")}}function oO(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function lO(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,dO(e,t,n)}function uO(e,t,n){return Math.max(e,Math.min(t,n))}function cO(e){return e%2===0?e:e+1}function dO(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function hO(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function pO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";hO(gO(e,t),(()=>n+` Shapes ${e} and ${t} must match`))}function fO(e){hO(null!=e,(()=>"The input to the tensor constructor must be a non-null value."))}function mO(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function gO(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function yO(e){return e%1===0}function vO(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function bO(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function xO(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise(((s,a)=>{let i=0;const o=()=>{if(e())return void s();i++;const l=t(i);null!=n&&i>=n?a():null!=r?r(o,l):setTimeout(o,l)};o()}))}function wO(e,t){let n=1,r=-1;for(let a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${a}`);r=a}else if(e[a]<0)throw Error(`Shapes can not be < 0. Found ${e[a]} at dim ${a}`);if(-1===r){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(0===n)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const s=e.slice();return s[r]=t/n,s}function kO(e,t){const n=t.length;return hO((e=null==e?t.map(((e,t)=>t)):[].concat(e)).every((e=>e>=-n&&e<n)),(()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`)),hO(e.every((e=>yO(e))),(()=>`All values in axis param must be integers but got axis ${e}`)),e.map((e=>e<0?n+e:e))}function SO(e,t){const n=[],r=[],s=null!=t&&Array.isArray(t)&&0===t.length,a=null==t||s?null:kO(t,e).sort();let i=0;for(let o=0;o<e.length;++o){if(null!=a){if(a[i]===o&&1!==e[o])throw new Error(`Can't squeeze axis ${o} since its dim '${e[o]}' is not 1`);(null==a[i]||a[i]>o)&&1===e[o]&&(n.push(e[o]),r.push(o)),a[i]<=o&&i++}1!==e[o]&&(n.push(e[o]),r.push(o))}return{newShape:n,keptDims:r}}function IO(e,t){return CO(e,t)}function CO(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error(`Unknown data type ${e}`);n=new Array(t)}return n}function TO(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function NO(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error(`Unknown dtype ${e}`)}function EO(e){return"string"===typeof e||e instanceof String}function AO(e){return"number"===typeof e}function RO(e){return Array.isArray(e)?RO(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":AO(e)?"float32":EO(e)?"string":"boolean"===typeof e?"bool":"float32"}function _O(e){return!!(e&&e.constructor&&e.call&&e.apply)}function $O(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function OO(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function DO(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=new Array;if(1===t.length){const a=t[0]*(r?2:1);for(let t=0;t<a;t++)s[t]=n[e+t]}else{const a=t[0],i=t.slice(1),o=i.reduce(((e,t)=>e*t))*(r?2:1);for(let t=0;t<a;t++)s[t]=DO(e+t*o,i,n,r)}return s}function MO(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];const r=e.reduce(((e,t)=>e*t))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return DO(0,e,t,n)}function FO(e,t){const n=LO(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function LO(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function PO(e,t){const n=e.reduce(((e,t)=>e*t),1);if(null==t||"float32"===t)return MO(e,new Float32Array(n));if("int32"===t)return MO(e,new Int32Array(n));if("bool"===t)return MO(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function zO(e){e.forEach((t=>{hO(Number.isInteger(t)&&t>=0,(()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`))}))}function BO(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=n[s]*e[s];return r}function jO(e,t,n){if(0===t)return[];if(1===t)return[e];const r=new Array(t);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(e/n[s]),e-=r[s]*n[s];return r[r.length-1]=e,r}function UO(e){return e&&e.then&&"function"===typeof e.then}const VO="tfjsflags";class WO{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=GO,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(HO().getBool("IS_TEST")||HO().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){const t=this.urlFlags[e];HO().getBool("IS_TEST")||HO().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${t}.`),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(UO(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);if(VO in e){e[VO].split(",").forEach((e=>{const[t,n]=e.split(":");this.urlFlags[t]=function(e,t){const n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:""+ +n===n?+n:t}(0,n)}))}}}function GO(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,r[0],r[1]),r.join("=")})),t}function HO(){return KO}let qO,KO=null;function XO(){if(null==qO){let e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}qO=e}return qO}function YO(e,t){const n=function(){const e=XO();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const QO="Abs",JO="Acos",ZO="Acosh",eD="Add",tD="AddN",nD="All",rD="Any",sD="ArgMax",aD="ArgMin",iD="Asin",oD="Asinh",lD="Atan",uD="Atanh",cD="Atan2",dD="AvgPool",hD="AvgPoolGrad",pD="AvgPool3D",fD="AvgPool3DGrad",mD="BatchMatMul",gD="BatchToSpaceND",yD="Bincount",vD="BitwiseAnd",bD="BroadcastArgs",xD="Cast",wD="Ceil",kD="ClipByValue",SD="Complex",ID="ComplexAbs",CD="Concat",TD="Conv2D",ND="Conv2DBackpropFilter",ED="Conv2DBackpropInput",AD="Conv3D",RD="Conv3DBackpropFilterV2",_D="Conv3DBackpropInputV2",$D="Cos",OD="Cosh",DD="Cumprod",MD="Cumsum",FD="CropAndResize",LD="DenseBincount",PD="DepthToSpace",zD="DepthwiseConv2dNative",BD="DepthwiseConv2dNativeBackpropFilter",jD="DepthwiseConv2dNativeBackpropInput",UD="Diag",VD="Dilation2D",WD="Dilation2DBackpropInput",GD="Dilation2DBackpropFilter",HD="Draw",qD="RealDiv",KD="Einsum",XD="Elu",YD="EluGrad",QD="Erf",JD="Equal",ZD="Exp",eM="ExpandDims",tM="Expm1",nM="FFT",rM="Fill",sM="FlipLeftRight",aM="Floor",iM="FloorDiv",oM="FusedBatchNorm",lM="GatherV2",uM="GatherNd",cM="Greater",dM="GreaterEqual",hM="Identity",pM="IFFT",fM="Imag",mM="IsFinite",gM="IsInf",yM="IsNan",vM="LeakyRelu",bM="Less",xM="LessEqual",wM="LinSpace",kM="Log",SM="Log1p",IM="LogicalAnd",CM="LogicalNot",TM="LogicalOr",NM="LRN",EM="LRNGrad",AM="Max",RM="Maximum",_M="MaxPool",$M="MaxPoolGrad",OM="MaxPool3D",DM="MaxPool3DGrad",MM="MaxPoolWithArgmax",FM="Mean",LM="Min",PM="Minimum",zM="MirrorPad",BM="Mod",jM="Multinomial",UM="Multiply",VM="Neg",WM="NotEqual",GM="NonMaxSuppressionV3",HM="NonMaxSuppressionV4",qM="NonMaxSuppressionV5",KM="OnesLike",XM="OneHot",YM="Pack",QM="PadV2",JM="Pow",ZM="Prelu",eF="Prod",tF="RaggedGather",nF="RaggedRange",rF="RaggedTensorToTensor",sF="Range",aF="Real",iF="Reciprocal",oF="Relu",lF="Reshape",uF="ResizeNearestNeighbor",cF="ResizeNearestNeighborGrad",dF="ResizeBilinear",hF="ResizeBilinearGrad",pF="Relu6",fF="Reverse",mF="Round",gF="Rsqrt",yF="ScatterNd",vF="TensorScatterUpdate",bF="SearchSorted",xF="Select",wF="Selu",kF="Slice",SF="Sin",IF="Sinh",CF="Sign",TF="Sigmoid",NF="Softplus",EF="Sqrt",AF="Sum",RF="SpaceToBatchND",_F="SplitV",$F="Softmax",OF="SparseFillEmptyRows",DF="SparseReshape",MF="SparseSegmentMean",FF="SparseSegmentSum",LF="SparseToDense",PF="SquaredDifference",zF="Square",BF="StaticRegexReplace",jF="StridedSlice",UF="StringNGrams",VF="StringSplit",WF="StringToHashBucketFast",GF="Sub",HF="Tan",qF="Tanh",KF="Tile",XF="TopK",YF="Transform",QF="Transpose",JF="Unique",ZF="Unpack",eL="UnsortedSegmentSum",tL="ZerosLike",nL="Step",rL="FromPixels",sL="RotateWithOffset",aL="_FusedMatMul",iL="FusedConv2D",oL="FusedDepthwiseConv2D";function lL(){HO().getBool("IS_TEST")||HO().getBool("PROD")||console.warn(...arguments)}function uL(){HO().getBool("IS_TEST")||HO().getBool("PROD")||console.log(...arguments)}const cL=YO("kernelRegistry",(()=>new Map)),dL=YO("gradRegistry",(()=>new Map));function hL(e,t){const n=yL(e,t);return cL.get(n)}function pL(e){return dL.get(e)}function fL(e){const t=cL.entries(),n=[];for(;;){const{done:r,value:s}=t.next();if(r)break;const[a,i]=s,[o]=a.split("_");o===e&&n.push(i)}return n}function mL(e){const{kernelName:t,backendName:n}=e,r=yL(t,n);cL.has(r)&&lL(`The kernel '${t}' for backend '${n}' is already registered`),cL.set(r,e)}function gL(e){const{kernelName:t}=e;dL.has(t)&&HO().getBool("DEBUG")&&lL(`Overriding the gradient for '${t}'`),dL.set(t,e)}function yL(e,t){return`${t}_${e}`}function vL(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var bL=n(7353);const xL=n.n(bL)()||bL;function wL(e){return xL.fromString(e,!0,16)}const kL=wL("c3a5c85c97cb3127"),SL=wL("b492b66fbe98f273"),IL=wL("9ae16a3b2f90404f");function CL(e){return e.xor(e.shru(47))}function TL(e,t,n){const r=e.slice(t,t+n);return xL.fromBytes(Array.from(r),!0,!0)}function NL(e,t){return TL(e,t,8)}function EL(e,t){return TL(e,t,4)}function AL(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function RL(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wL("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));let s=t.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function _L(e,t,n,r){return function(e,t,n,r,s,a){s=s.add(e),a=AL(a.add(s).add(r),21);const i=s;return s=(s=s.add(t)).add(n),a=a.add(AL(s,44)),[s.add(r),a.add(i)]}(NL(e,t),NL(e,t+8),NL(e,t+16),NL(e,t+24),n,r)}function $L(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=xL.fromNumber(81,!0);if(t<=32)return t<=16?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){const n=IL.add(2*t),r=NL(e,0).add(IL),s=NL(e,t-8);return RL(AL(s,37).mul(n).add(r),AL(r,25).add(s).mul(n),n)}if(t>=4){const n=IL.add(2*t);return RL(EL(e,0).shl(3).add(t),EL(e,t-4),n)}if(t>0){const n=e[0]+(e[t>>1]<<8),r=t+(e[t-1]<<2);return CL(IL.mul(n).xor(kL.mul(r))).mul(IL)}return IL}(e,t):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=IL.add(2*t),r=NL(e,0).mul(SL),s=NL(e,8),a=NL(e,t-8).mul(n),i=NL(e,t-16).mul(IL);return RL(AL(r.add(s),43).add(AL(a,30)).add(i),r.add(AL(s.add(IL),18)).add(a),n)}(e,t);if(t<=64)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=IL.add(2*t),r=NL(e,0).mul(IL),s=NL(e,8),a=NL(e,t-8).mul(n),i=NL(e,t-16).mul(IL),o=AL(r.add(s),43).add(AL(a,30)).add(i),l=RL(o,r.add(AL(s.add(IL),18)).add(a),n),u=NL(e,16).mul(n),c=NL(e,24),d=o.add(NL(e,t-32)).mul(n),h=l.add(NL(e,t-24)).mul(n);return RL(AL(u.add(c),43).add(AL(d,30)).add(h),u.add(AL(c.add(r),18)).add(d),n)}(e,t);let r=n,s=n.mul(SL).add(113),a=CL(s.mul(IL).add(113)).mul(IL),i=[xL.UZERO,xL.UZERO],o=[xL.UZERO,xL.UZERO];r=r.mul(IL).add(NL(e,0));let l=0;const u=64*(t-1>>6),c=u+(t-1&63)-63;do{r=AL(r.add(s).add(i[0]).add(NL(e,l+8)),37).mul(SL),s=AL(s.add(i[1]).add(NL(e,l+48)),42).mul(SL),r=r.xor(o[1]),s=s.add(i[0]).add(NL(e,l+40)),a=AL(a.add(o[0]),33).mul(SL),i=_L(e,l,i[1].mul(SL),r.add(o[0])),o=_L(e,l+32,a.add(o[1]),s.add(NL(e,l+16))),[a,r]=[r,a],l+=64}while(l!==u);const d=SL.add(a.and(255).shl(1));return l=c,o[0]=o[0].add(t-1&63),i[0]=i[0].add(o[0]),o[0]=o[0].add(i[0]),r=AL(r.add(s).add(i[0]).add(NL(e,l+8)),37).mul(d),s=AL(s.add(i[1]).add(NL(e,l+48)),42).mul(d),r=r.xor(o[1].mul(9)),s=s.add(i[0].mul(9).add(NL(e,l+40))),a=AL(a.add(o[0]),33).mul(d),i=_L(e,l,i[1].mul(d),r.add(o[0])),o=_L(e,l+32,a.add(o[1]),s.add(NL(e,l+16))),[a,r]=[r,a],RL(RL(i[0],o[0],d).add(CL(s).mul(kL)).add(a),RL(i[1],o[1],d).add(r),d)}function OL(e,t){return"string"===t?FL(e):DL([e],t)}function DL(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=zL(e)),HO().getBool("DEBUG")&&function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error(`Unknown data type ${t}`)}function ML(){return HO().platform.now()}function FL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",HO().platform.encode(e,t)}function LL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",HO().platform.decode(e,t)}function PL(e){return null!=HO().platform.isTypedArray?HO().platform.isTypedArray(e):vL(e)}function zL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||UO(e)||null==e||PL(e)&&n)t.push(e);else if(Array.isArray(e)||PL(e))for(let r=0;r<e.length;++r)zL(e[r],t,n);else{let r=-1;for(const t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(r=Math.max(r,Number(t)));for(let s=0;s<=r;s++)zL(e[s],t,n)}return t}class BL{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new UL)}profileKernel(e,t,n){let r;const s=()=>{r=n()};let a;const i=ML();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(s);else{s();for(const e of r)e.dataSync();a=Promise.resolve({kernelMs:ML()-i})}if(HO().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let o=0;o<r.length;o++){const t=r[o];t.data().then((n=>{jL(n,t.dtype,e)}))}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((e=>e.kernelMs)),extraInfo:a.then((e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""))}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:r,inputs:s,extraInfo:a}=e;n.forEach((e=>{Promise.all([e.data(),r,a]).then((n=>{this.logger.logKernelProfile(t,e,n[0],n[1],s,n[2])}))}))}}function jL(e,t,n){if("float32"!==t)return!1;for(let r=0;r<e.length;r++){const t=e[r];if(isNaN(t)||!isFinite(t))return console.warn(`Found ${t} in the result of '${n}'`),!0}return!1}class UL{logKernelProfile(e,t,n,r,s,a){const i="number"===typeof r?bO(`${r}ms`,9):r.error,o=bO(e,25),l=t.rank,u=t.size,c=bO(t.shape.toString(),14);let d="";for(const h in s){const e=s[h];if(null!=e){const n=e.shape||t.shape,r=n.length;d+=`${h}: ${r}D ${r>0?n:""} `}}console.log(`%c${o}\t%c${i}\t%c${l}D ${c}\t%c${u}\t%c${d}\t%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function VL(e,t,n,r){const s=OO(t),a=function(e,t,n,r){const s=mO(t),a=r[r.length-1],i=new Array(a).fill(0),o=t.length,l="complex64"===n?qL(e):e;if(o>1)for(let u=0;u<s/a;u++){const e=u*a;for(let t=0;t<a;t++)i[t]=Math.max(i[t],WL(l[e+t],0,n).length)}return i}(e,t,n,s),i=t.length,o=HL(e,t,n,s,a),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(o.map((e=>"    "+e)).join("\n")),l.join("\n")}function WL(e,t,n){let r;return r=Array.isArray(e)?`${parseFloat(e[0].toFixed(7))} + ${parseFloat(e[1].toFixed(7))}j`:EO(e)?`'${e}'`:"bool"===n?GL(e):parseFloat(e.toFixed(7)).toString(),bO(r,t)}function GL(e){return 0===e?"false":"true"}function HL(e,t,n,r,s){let a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const i="complex64"===n?2:1,o=t[0],l=t.length;if(0===l){if("complex64"===n){return[WL(qL(e)[0],0,n)]}return"bool"===n?[GL(e[0])]:[e[0].toString()]}if(1===l){if(o>20){const t=3*i;let r=Array.from(e.slice(0,t)),a=Array.from(e.slice((o-3)*i,o*i));return"complex64"===n&&(r=qL(r),a=qL(a)),["["+r.map(((e,t)=>WL(e,s[t],n))).join(", ")+", ..., "+a.map(((e,t)=>WL(e,s[o-3+t],n))).join(", ")+"]"]}return["["+("complex64"===n?qL(e):Array.from(e)).map(((e,t)=>WL(e,s[t],n))).join(", ")+"]"]}const u=t.slice(1),c=r.slice(1),d=r[0]*i,h=[];if(o>20){for(let t=0;t<3;t++){const r=t*d,a=r+d;h.push(...HL(e.slice(r,a),u,n,c,s,!1))}h.push("...");for(let t=o-3;t<o;t++){const r=t*d,a=r+d;h.push(...HL(e.slice(r,a),u,n,c,s,t===o-1))}}else for(let m=0;m<o;m++){const t=m*d,r=t+d;h.push(...HL(e.slice(t,r),u,n,c,s,m===o-1))}const p=2===l?",":"";h[0]="["+(o>0?h[0]+p:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+p;let f=",\n";for(let m=2;m<l;m++)f+="\n";return h[h.length-1]=" "+h[h.length-1]+"]"+(a?"":f),h}function qL(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}class KL{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=mO(e),null!=n){const e=n.length;hO(e===this.size,(()=>`Length of values '${e}' does not match the size inferred by the shape '${this.size}'.`))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||CO(t,this.size),this.strides=OO(e)}set(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),hO(n.length===this.rank,(()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`));const s=this.locToIndex(n);this.values[s]=e}get(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);let r=0;for(const a of t){if(a<0||a>=this.shape[r]){const e=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(e)}r++}let s=t[t.length-1];for(let a=0;a<t.length-1;++a)s+=this.strides[a]*t[a];return this.values[s]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return XL().makeTensor(this.values,this.shape,this.dtype)}}let XL=null,YL=null,QL=null;class JL{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=mO(e),this.strides=OO(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return YL.buffer(this.shape,this.dtype,e)}bufferSync(){return YL.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return MO(this.shape,e,"complex64"===this.dtype)}arraySync(){return MO(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=XL().read(this.dataId);if("string"===this.dtype){const n=await e;try{return n.map((e=>LL(e)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),XL().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=XL().readSync(this.dataId);if("string"===this.dtype)try{return e.map((e=>LL(e)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await XL().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),XL().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return YL.print(this,e)}clone(){return this.throwIfDisposed(),YL.clone(this)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return VL(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),YL.cast(this,e)}variable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),XL().makeVariable(this,e,t,n)}}function ZL(){return YO("Tensor",(()=>JL))}Object.defineProperty(JL,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),ZL();class eP extends JL{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!gO(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);XL().disposeTensor(this),this.dataId=e.dataId,XL().incRef(this,null)}dispose(){XL().disposeVariable(this),this.isDisposedInternal=!0}}var tP,nP,rP,sP,aP,iP,oP,lP,uP,cP;Object.defineProperty(eP,Symbol.hasInstance,{value:e=>e instanceof JL&&null!=e.assign&&e.assign instanceof Function}),(nP=tP||(tP={})).R0="R0",nP.R1="R1",nP.R2="R2",nP.R3="R3",nP.R4="R4",nP.R5="R5",nP.R6="R6",(sP=rP||(rP={})).float32="float32",sP.int32="int32",sP.bool="int32",sP.complex64="complex64",(iP=aP||(aP={})).float32="float32",iP.int32="int32",iP.bool="bool",iP.complex64="complex64",(lP=oP||(oP={})).float32="float32",lP.int32="float32",lP.bool="float32",lP.complex64="complex64",(cP=uP||(uP={})).float32="complex64",cP.int32="complex64",cP.bool="complex64",cP.complex64="complex64";const dP={float32:oP,int32:rP,bool:aP,complex64:uP};function hP(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return dP[e][t]}function pP(e){return hP(e,"int32")}function fP(e){return null!=e&&"object"===typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function mP(e){return"undefined"!==typeof GPUBuffer&&null!=e&&"object"===typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function gP(e,t){if(e.dtype===t.dtype)return[e,t];const n=hP(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function yP(e,t){return t.some((t=>t.id===e.id))}function vP(e){const t=[];return bP(e,t,new Set),t}function bP(e,t,n){if(null==e)return;if(e instanceof JL)return void t.push(e);if(r=e,!Array.isArray(r)&&"object"!==typeof r)return;var r;const s=e;for(const a in s){const e=s[a];n.has(e)||(n.add(e),bP(e,t,n))}}function xP(e){return null!=e.kernelName}class wP{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((e=>e.name))))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class kP{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new wP}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(lL(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new BL(this.backendInstance),!0}setupRegisteredKernels(){fL(this.backendName).forEach((e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(e){fL(e).forEach((t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])}))}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const n=t.factory();if(!n||n instanceof iO||"function"!==typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,r=n.then((n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0))).catch((n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,lL(`Initialization of backend ${e} failed`),lL(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return lL(`Initialization of backend ${e} failed`),lL(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority))}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:r,asyncInit:s}=this.initializeBackend(n);if(s||r)return{name:n,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),r=n.backend,s=this.readSync(t),a=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,s,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(e,t,n){e();try{const e=n();return t(),e}catch(r){throw t(),r}}nextTensorId(){return kP.nextTensorId++}nextVariableId(){return kP.nextVariableId++}clone(e){const t=IP.runKernel(hM,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(e=>({x:()=>{const t={x:e},n={dtype:"float32"};return IP.runKernel(xD,t,n)}})),[],{}),t}runKernel(e,t,n){null==this.backendName&&this.backend;if(!(null!=hL(e,this.backendName)))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const r=this.backend.numDataIds();let s=0;n.forEach((e=>{s+="complex64"===e.dtype?3:1}));const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=r-t-s-a;if(i>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${i} data ids) after running '${e}'`)}runKernelFunc(e){let t,n=[];const r=this.isTapeOn(),s=this.state.numBytes,a=this.state.numTensors;let i,o;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const l=xP(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(xP(e)){const{kernelName:t,inputs:s,attrs:a}=e;null==this.backendName&&this.backend;const l=hL(t,this.backendName);hO(null!=l,(()=>`Cannot find registered kernel '${t}' for backend '${this.backendName}'`)),i=()=>{const e=this.backend.numDataIds();o=l.kernelFunc({inputs:s,attrs:a,backend:this.backend});const i=Array.isArray(o)?o:[o];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,i);const u=i.map((e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e)));if(r){const e=this.getTensorsForGradient(t,s,u);n=this.saveTensorsForBackwardMode(e)}return u}}else{const{forwardFunc:t}=e,s=e=>{r&&(n=e.map((e=>this.keep(this.clone(e)))))};i=()=>{const e=this.backend.numDataIds();o=this.tidy((()=>t(this.backend,s)));const n=Array.isArray(o)?o:[o];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,e,n),n}}const{inputs:u,attrs:c}=e,d=xP(e)?null:e.backwardsFunc;let h;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(h=this.profiler.profileKernel(l,u,(()=>i())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),t=h.outputs):t=i()})),r&&this.addTapeNode(l,u,t,d,n,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map((e=>null!=u[e]?u[e].shape:null)),outputShapes:t.map((e=>e.shape)),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(o)?t:t[0]}saveTensorsForBackwardMode(e){return e.map((e=>this.keep(this.clone(e))))}getTensorsForGradient(e,t,n){const r=pL(e);if(null!=r){const e=r.inputsToSave||[],s=r.outputsToSave||[];let a;r.saveAllInputs?(hO(Array.isArray(t),(()=>"saveAllInputs is true, expected inputs to be an array.")),a=Object.keys(t).map((e=>t[e]))):a=e.map((e=>t[e]));const i=n.filter(((e,t)=>s[t]));return a.concat(i)}return[]}makeTensor(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let s=e;"string"===n&&EO(e[0])&&(s=e.map((e=>FL(e))));const a=r.write(s,t,n),i=new JL(t,n,a,this.nextTensorId());if(this.trackTensor(i,r),"string"===n){const e=this.state.tensorInfo.get(a),t=function(e){if(null==e)return 0;let t=0;return e.forEach((e=>t+=e.length)),t}(s);this.state.numBytes+=t-e.bytes,e.bytes=t}return i}makeTensorFromDataId(e,t,n,r){const s={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(s,r)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:r,dtype:s}=e,a=new JL(r,s,n,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));const s=new eP(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[s.name])throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*NO(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof eP||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*NO(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((e=>e.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,s,a){const i={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:s},o=pL(e);null!=o&&(r=o.gradFunc),null!=r&&(i.gradient=e=>(e=e.map(((e,t)=>{if(null==e){const e=n[t],r=LO(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e})),r(e.length>1?e:e[0],s,a))),this.state.activeTape.push(i)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=vP(e),n=new Set(t.map((e=>e.id)));for(let s=0;s<this.state.activeScope.track.length;s++){const e=this.state.activeScope.track[s];e.kept||n.has(e.id)||e.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach((e=>{e.kept||e.scopeId!==r.id||this.track(e)}))}gradients(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(hO(t.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const s=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",e)));hO(s instanceof JL,(()=>"The result y returned by f() must be a tensor."));const a=function(e,t,n){const r={},s={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){const n=e[l],a=n.inputs;for(const e in a){const i=a[e];let o=!1;for(let e=0;e<t.length;e++)if(r[i.id]){n.outputs.forEach((e=>r[e.id]=!0)),o=!0,s[n.id]=!0;break}if(o)break}}const a={};a[n.id]=!0;const i={};for(let l=e.length-1;l>=0;l--){const t=e[l],n=t.inputs;for(let e=0;e<t.outputs.length;e++)if(a[t.outputs[e].id]){for(const e in n)a[n[e].id]=!0,i[t.id]=!0;break}}const o=[];for(let l=0;l<e.length;l++){const t=e[l];if(s[t.id]&&i[t.id]){const e={};for(const s in t.inputs){const n=t.inputs[s];r[n.id]&&(e[s]=n)}const n=Object.assign({},t);n.inputs=e,n.outputs=t.outputs,o.push(n)}}return o}(this.state.activeTape,t,s);if(!r&&0===a.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const e={};e[s.id]=null==n?function(e){const t=FO(mO(e),"float32");return IP.makeTensor(t,e,"float32")}(s.shape):n,function(e,t,n,r){for(let s=t.length-1;s>=0;s--){const a=t[s],i=[];if(a.outputs.forEach((t=>{const n=e[t.id];null!=n?i.push(n):i.push(null)})),null==a.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const o=a.gradient(i);for(const t in a.inputs){if(!(t in o))throw new Error(`Cannot backprop through input ${t}. Available gradients found: ${Object.keys(o)}.`);const s=n((()=>o[t]()));if("float32"!==s.dtype)throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${t} must have 'float32' dtype, but has '${s.dtype}'`);const i=a.inputs[t];if(!gO(s.shape,i.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${t}' has shape '${s.shape}', which does not match the shape of the input '${i.shape}'`);if(null==e[i.id])e[i.id]=s;else{const t=e[i.id];e[i.id]=r(t,s),t.dispose()}}}}(e,a,(e=>this.tidy(e)),CP);const r=t.map((t=>e[t.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((e=>{for(const t of e.saved)t.dispose()})),this.state.activeTape=null),{value:s,grads:r}}))}customGrad(e){var t=this;return hO(_O(e),(()=>"The f passed in customGrad(f) must be a function.")),function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];let a;hO(r.every((e=>e instanceof JL)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const i={};r.forEach(((e,t)=>{i[t]=e}));return t.runKernelFunc({forwardFunc:(t,n)=>(a=e(...r,n),hO(a.value instanceof JL,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),hO(_O(a.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),a.value),backwardsFunc:(e,t)=>{const n=a.gradFunc(e,t),s=Array.isArray(n)?n:[n];hO(s.length===r.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),hO(s.every((e=>e instanceof JL)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const i={};return s.forEach(((e,t)=>{i[t]=()=>e})),i},inputs:i})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=ML(),n=await this.backend.time(e);return n.wallMs=ML()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new wP;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function SP(){const e=XO();if(null==e._tfengine){const t=new WO(e);e._tfengine=new kP(t)}var t;return t=e._tfengine.ENV,KO=t,XL=()=>e._tfengine,e._tfengine}kP.nextTensorId=0,kP.nextVariableId=0;const IP=SP();function CP(e,t){const n={a:e,b:t};return IP.runKernel(eD,n)}let TP;function NP(e){if(void 0!==TP)return TP;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;const t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){const t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function EP(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}const AP=HO();function RP(e,t){let n=e;if(PL(e))return"string"===t?[]:[e.length];if(fP(e)){const t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(mP(e))return[e.buffer.size/(null==t?4:NO(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||PL(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&HO().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&_P(e,r,[]),r}function _P(e,t,n){if(n=n||[],!Array.isArray(e)&&!PL(e))return void hO(0===t.length,(()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`));hO(t.length>0,(()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`)),hO(e.length===t[0],(()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`));const r=t.slice(1);for(let s=0;s<e.length;++s)_P(e[s],r,n.concat(s))}function $P(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function OP(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof ZL())return $P(r,e.dtype,t,n),e;let s=RO(e);if("string"!==s&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),$P(r,s,t,n),null==e||!PL(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){const r=null==e?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const a=RP(e,s);PL(e)||Array.isArray(e)||(e=[e]);const i="string"!==s?DL(e,s):zL(e,[],!0);return IP.makeTensor(i,a,s)}function DP(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map(((e,s)=>OP(e,`${t}[${s}]`,n,r)))}AP.registerFlag("DEBUG",(()=>!1),(e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),AP.registerFlag("IS_BROWSER",(()=>EP())),AP.registerFlag("IS_NODE",(()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node)),AP.registerFlag("IS_CHROME",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),AP.registerFlag("IS_SAFARI",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),AP.registerFlag("PROD",(()=>!1)),AP.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>AP.getBool("DEBUG"))),AP.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),AP.registerFlag("IS_TEST",(()=>!1)),AP.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>AP.getBool("DEBUG"))),AP.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),AP.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),AP.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1));const MP="__op";function FP(e){const t=Object.keys(e);if(1!==t.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=MP;const s=function(){IP.startScope(n);try{const e=r(...arguments);return UO(e)&&console.error("Cannot return a Promise inside of tidy."),IP.endScope(e),e}catch(e){throw IP.endScope(null),e}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}const LP=FP({complex_:function(e,t){const n=OP(e,"real","complex"),r=OP(t,"imag","complex");pO(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return IP.runKernel(SD,s)}});function PP(e,t,n,r){if(null==r)r=RO(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(mP(e)||fP(e)){if("float32"!==r&&"int32"!==r)throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return IP.backend.createTensorFromGPUData(e,t||n,r)}if(!PL(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){zO(t);const e=mO(t),r=mO(n);hO(e===r,(()=>`Based on the provided shape, [${t}], the tensor should have ${e} values but has ${r}`));for(let s=0;s<n.length;++s){const e=n[s],r=s!==n.length-1||e!==mO(t.slice(s));hO(n[s]===t[s]||!r,(()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `))}}return PL(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?DL(e,r):zL(e,[],!0),IP.makeTensor(e,t,r)}function zP(e,t,n){return PP(e,t,RP(e,n),n)}const BP={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class jP{static join(e){return new jP(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e)return;if(e instanceof Array||(e=[e]),0===(e=e.map((e=>PL(e)?e.buffer:e))).length)return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){const r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const s=t+r.byteLength;this.shards.push({buffer:r,start:t,end:s}),t=s}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const n=this.findShardForByte(e);if(-1===n)throw new Error(`Could not find start shard for byte ${e}`);const r=new ArrayBuffer(t-e),s=new Uint8Array(r);let a=0;for(let i=n;i<this.shards.length;i++){const n=this.shards[i],r=e+a-n.start,o=a,l=Math.min(t,n.end)-n.start,u=new Uint8Array(n.buffer,r,l-r);if(s.set(u,o),a+=u.length,t<n.end)break}return r}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(e,t){let n=0,r=e.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,a=t(e[s]);if(0===a)return s;a<0?r=s:n=s+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function UP(){return IP}function VP(){return IP.memory()}function WP(e,t){return IP.tidy(e,t)}function GP(e){vP(e).forEach((e=>e.dispose()))}function HP(e){return IP.keep(e)}function qP(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return IP.registerBackend(e,t,n)}function KP(){return IP.backend}QL=function(e){HO().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")};const XP=4;async function YP(e,t){const n=[],r=[],s=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);for(let a=0;a<s.length;++a){const i=s[a],o=Array.isArray(e)?e[a].tensor:e[i];if("float32"!==o.dtype&&"int32"!==o.dtype&&"bool"!==o.dtype&&"string"!==o.dtype&&"complex64"!==o.dtype)throw new Error(`Unsupported dtype in weight '${i}': ${o.dtype}`);const l={name:i,shape:o.shape,dtype:o.dtype};if("string"===o.dtype){const e=new Promise((async e=>{const t=await o.bytes(),n=t.reduce(((e,t)=>e+t.length),0)+XP*t.length,r=new Uint8Array(n);let s=0;for(let a=0;a<t.length;a++){const e=t[a],n=new Uint8Array(new Uint32Array([e.length]).buffer);r.set(n,s),s+=XP,r.set(e,s),s+=e.length}e(r)}));r.push(e)}else r.push(o.data());null!=t&&(l.group=t),n.push(l)}return{data:rz(await Promise.all(r)),specs:n}}function QP(e,t){const n=new jP(e),r={};let s=0;for(const a of t){const e=JP(a,((e,t)=>n.slice(s+e,s+t)));r[a.name]=ez(a,n.slice(s,s+e)),s+=e}return r}function JP(e,t){const n=mO(e.shape);let r;if("quantization"in e){const t=e.quantization;r=BP[t.dtype]}else{if("string"===e.dtype){let e=0;for(let r=0;r<n;r++)e+=XP+new Uint32Array(t(e,e+XP))[0];return e}r=BP[e.dtype]}return n*r}async function ZP(e,t){const n=mO(e.shape);let r;if("quantization"in e){const t=e.quantization;r=BP[t.dtype]}else{if("string"===e.dtype){let e=0;for(let r=0;r<n;r++)e+=XP+new Uint32Array(await t(e,e+XP))[0];return e}r=BP[e.dtype]}return n*r}function ez(e,t){const n=e.name,r=e.dtype,s=e.shape,a=mO(s);let i,o=0;if("quantization"in e){const s=e.quantization;if("uint8"===s.dtype||"uint16"===s.dtype){if(!("min"in s)||!("scale"in s))throw new Error(`Weight ${e.name} with quantization ${s.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==s.dtype)throw new Error(`Weight ${e.name} has unknown quantization dtype ${s.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==r)throw new Error(`Weight ${e.name} is quantized with ${s.dtype} which only supports weights of type float32 not ${r}.`)}const l=BP[s.dtype],u="uint8"===s.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===r)if("uint8"===s.dtype||"uint16"===s.dtype){i=new Float32Array(u.length);for(let e=0;e<u.length;e++){const t=u[e];i[e]=t*s.scale+s.min}}else{if("float16"!==s.dtype)throw new Error(`Unsupported quantization type ${s.dtype} for weight type float32.`);{const e=function(){const e=function(){const e=e=>{let t=e<<13,n=0;for(;0===(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}(),t=function(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return r=>{const s=new ArrayBuffer(4*r.length),a=new Uint32Array(s);for(let i=0;i<r.length;i++){const s=r[i],o=e[n[s>>10]+(1023&s)]+t[s>>10];a[i]=o}return new Float32Array(s)}}();i=e(u)}}else{if("int32"!==r)throw new Error(`Unsupported dtype in weight '${n}': ${r}`);if("uint8"!==s.dtype&&"uint16"!==s.dtype)throw new Error(`Unsupported quantization type ${s.dtype} for weight type int32.`);i=new Int32Array(u.length);for(let e=0;e<u.length;e++){const t=u[e];i[e]=Math.round(t*s.scale+s.min)}}o+=a*l}else if("string"===r){const n=mO(e.shape);i=[];for(let e=0;e<n;e++){const e=new Uint32Array(t.slice(o,o+XP))[0];o+=XP;const n=new Uint8Array(t.slice(o,o+e));i.push(n),o+=e}}else{const e=BP[r];if("float32"===r)i=new Float32Array(t);else if("int32"===r)i=new Int32Array(t);else{if("bool"!==r){if("complex64"===r){i=new Float32Array(t);const e=new Float32Array(i.length/2),n=new Float32Array(i.length/2);for(let t=0;t<e.length;t++)e[t]=i[2*t],n[t]=i[2*t+1];const r=zP(e,s,"float32"),a=zP(n,s,"float32"),o=LP(r,a);return r.dispose(),a.dispose(),o}throw new Error(`Unsupported dtype in weight '${n}': ${r}`)}i=new Uint8Array(t)}o+=a*e}return zP(i,s,r)}async function tz(e,t,n){let r=new Uint8Array(t);for(;r.byteLength<n;){const{done:t,value:s}=await e.read();if(t&&null==s){const e=n-r.byteLength;throw new Error(`Reader is done but ${e} bytes are still expected`)}const a=new Uint8Array(r.length+s.byteLength);a.set(r,0),a.set(new Uint8Array(s),r.length),r=a}return r.buffer}async function nz(e,t){const n={},r=e.getReader();let s=new ArrayBuffer(0);for(const a of t){const e=await ZP(a,(async(e,t)=>(s=await tz(r,s,t),s.slice(e,t))));s=await tz(r,s,e);const t=s.slice(0,e);s=s.slice(e);const i=ez(a,t);if(n[a.name]=i,"webgpu"===IP.backendName){const e=KP();"uploadToGPU"in e&&mO(i.shape)>=HO().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&e.uploadToGPU(i.dataId)}}return n}function rz(e){if(null===e)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach((e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${e.constructor.name}`)}));const r=new Uint8Array(t);let s=0;return n.forEach((e=>{r.set(new Uint8Array(e.buffer),s),s+=e.byteLength})),r.buffer}const sz="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function az(e){return sz?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function iz(e){return jP.join(e)}function oz(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);const t=e.split("/");return t[t.length-1]}function lz(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function uz(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}async function cz(e,t){let n,r;return null!=e.weightsManifest&&([n,r]=await t(e.weightsManifest)),uz(e,n,r)}function dz(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:az(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:az(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new jP(e.weightData).byteLength}}function hz(e){const t=[];for(const n of e)t.push(...n.weights);return t}class pz{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==pz.instance&&(pz.instance=new pz),pz.instance}static registerSaveRouter(e){pz.getInstance().saveRouters.push(e)}static registerLoadRouter(e){pz.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return pz.getHandlers(e,"save")}static getLoadHandlers(e,t){return pz.getHandlers(e,"load",t)}static getHandlers(e,t,n){const r=[];return("load"===t?pz.getInstance().loadRouters:pz.getInstance().saveRouters).forEach((t=>{const s=t(e,n);null!==s&&r.push(s)})),r}}const fz=e=>pz.registerSaveRouter(e),mz=e=>pz.registerLoadRouter(e),gz=e=>pz.getSaveHandlers(e),yz=(e,t)=>pz.getLoadHandlers(e,t),vz="tensorflowjs",bz="models_store",xz="model_info_store";function wz(){if(!HO().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function kz(e){const t=e.result;t.createObjectStore(bz,{keyPath:"modelPath"}),t.createObjectStore(xz,{keyPath:"modelPath"})}class Sz{constructor(e){if(this.indexedDB=wz(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise(((e,n)=>{const r=this.indexedDB.open(vz,1);r.onupgradeneeded=()=>kz(r),r.onsuccess=()=>{const s=r.result;if(null==t){const t=s.transaction(bz,"readonly"),r=t.objectStore(bz).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return s.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));e(r.result.modelArtifacts)},r.onerror=e=>(s.close(),n(r.error)),t.oncomplete=()=>s.close()}else{t.weightData=jP.join(t.weightData);const r=dz(t),i=s.transaction(xz,"readwrite");let o,l,u=i.objectStore(xz);try{o=u.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(a){return n(a)}o.onsuccess=()=>{l=s.transaction(bz,"readwrite");const o=l.objectStore(bz);let c;try{c=o.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:r})}catch(a){return n(a)}c.onsuccess=()=>e({modelArtifactsInfo:r}),c.onerror=e=>{u=i.objectStore(xz);const t=u.delete(this.modelPath);t.onsuccess=()=>(s.close(),n(c.error)),t.onerror=e=>(s.close(),n(c.error))}},o.onerror=e=>(s.close(),n(o.error)),i.oncomplete=()=>{null==l?s.close():l.oncomplete=()=>s.close()}}},r.onerror=e=>n(r.error)}))}}Sz.URL_SCHEME="indexeddb://";const Iz=e=>{return HO().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Sz.URL_SCHEME)?(t=e.slice(Sz.URL_SCHEME.length),new Sz(t)):null;var t};pz.registerSaveRouter(Iz),pz.registerLoadRouter(Iz);class Cz{constructor(){this.indexedDB=wz()}async listModels(){return new Promise(((e,t)=>{const n=this.indexedDB.open(vz,1);n.onupgradeneeded=()=>kz(n),n.onsuccess=()=>{const r=n.result,s=r.transaction(xz,"readonly"),a=s.objectStore(xz).getAll();a.onsuccess=()=>{const t={};for(const e of a.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},a.onerror=e=>(r.close(),t(a.error)),s.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)}))}async removeModel(e){var t;return e=(t=e).startsWith(Sz.URL_SCHEME)?t.slice(Sz.URL_SCHEME.length):t,new Promise(((t,n)=>{const r=this.indexedDB.open(vz,1);r.onupgradeneeded=()=>kz(r),r.onsuccess=()=>{const s=r.result,a=s.transaction(xz,"readwrite"),i=a.objectStore(xz),o=i.get(e);let l;o.onsuccess=()=>{if(null==o.result)return s.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const r=i.delete(e),a=()=>{l=s.transaction(bz,"readwrite");const r=l.objectStore(bz).delete(e);r.onsuccess=()=>t(o.result.modelArtifactsInfo),r.onerror=e=>n(o.error)};r.onsuccess=a,r.onerror=e=>(a(),s.close(),n(o.error))}},o.onerror=e=>(s.close(),n(o.error)),a.oncomplete=()=>{null==l?s.close():l.oncomplete=()=>s.close()}},r.onerror=e=>n(r.error)}))}}const Tz="/",Nz="tensorflowjs_models",Ez="info",Az="model_topology",Rz="weight_specs",_z="weight_data",$z="model_metadata";function Oz(e){return{info:[Nz,e,Ez].join(Tz),topology:[Nz,e,Az].join(Tz),weightSpecs:[Nz,e,Rz].join(Tz),weightData:[Nz,e,_z].join(Tz),modelMetadata:[Nz,e,$z].join(Tz)}}function Dz(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function Mz(e){const t=e.split(Tz);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(Tz)}class Fz{constructor(e){if(!HO().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Oz(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=dz(e),a=jP.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(e){if(sz)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,s=t.length;r<s;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(a));const t={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(t)),{modelArtifactsInfo:s}}catch(t){throw Dz(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const s=this.LS.getItem(this.keys.modelMetadata);if(null!=s){const e=JSON.parse(s);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(null==a)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=function(e){if(sz){const t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}(a),t}}Fz.URL_SCHEME="localstorage://";const Lz=e=>{return HO().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Fz.URL_SCHEME)?(t=e.slice(Fz.URL_SCHEME.length),new Fz(t)):null;var t};pz.registerSaveRouter(Lz),pz.registerLoadRouter(Lz);class Pz{constructor(){hO(HO().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),hO("undefined"===typeof window||"undefined"!==typeof window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const e={},t=Nz+Tz,n=Tz+Ez;for(let r=0;r<this.LS.length;++r){const s=this.LS.key(r);if(s.startsWith(t)&&s.endsWith(n)){e[Mz(s)]=JSON.parse(this.LS.getItem(s))}}return e}async removeModel(e){var t;const n=Oz(e=(t=e).startsWith(Fz.URL_SCHEME)?t.slice(Fz.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return Dz(n),r}}const zz="://";class Bz{constructor(){this.managers={}}static getInstance(){return null==Bz.instance&&(Bz.instance=new Bz),Bz.instance}static registerManager(e,t){hO(null!=e,(()=>"scheme must not be undefined or null.")),e.endsWith(zz)&&(e=e.slice(0,e.indexOf(zz))),hO(e.length>0,(()=>"scheme must not be an empty string."));const n=Bz.getInstance();hO(null==n.managers[e],(()=>`A model store manager is already registered for scheme '${e}'.`)),n.managers[e]=t}static getManager(e){const t=Bz.getInstance().managers[e];if(null==t)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(Bz.getInstance().managers)}}function jz(e){if(-1===e.indexOf(zz))throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Bz.getSchemes().join(",")}`);return{scheme:e.split(zz)[0],path:e.split(zz)[1]}}async function Uz(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];hO(e!==t,(()=>`Old path and new path are the same: '${e}'`));const r=pz.getLoadHandlers(e);hO(r.length>0,(()=>`Copying failed because no load handler is found for source URL ${e}.`)),hO(r.length<2,(()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`));const s=r[0],a=pz.getSaveHandlers(t);hO(a.length>0,(()=>`Copying failed because no save handler is found for destination URL ${t}.`)),hO(a.length<2,(()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`));const i=a[0],o=jz(e).scheme,l=jz(e).path,u=o===jz(e).scheme,c=await s.load();n&&u&&await Bz.getManager(o).removeModel(l);const d=await i.save(c);return n&&!u&&await Bz.getManager(o).removeModel(l),d.modelArtifactsInfo}async function Vz(){const e=Bz.getSchemes(),t={};for(const n of e){const e=await Bz.getManager(n).listModels();for(const r in e){t[n+zz+r]=e[r]}}return t}async function Wz(e){const t=jz(e);return Bz.getManager(t.scheme).removeModel(t.path)}async function Gz(e,t){return Uz(e,t,!1)}async function Hz(e,t){return Uz(e,t,!0)}class qz{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!==typeof window&&HO().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(e=>{if(e.source===window&&e.data.name===this.messageName){e.stopPropagation();(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}}),!0))):setTimeout(e,t)}isTypedArray(e){return vL(e)}}if(HO().get("IS_BROWSER")){HO().setPlatform("browser",new qz);try{Bz.registerManager(Fz.URL_SCHEME,new Pz)}catch(Cpe){}try{Bz.registerManager(Sz.URL_SCHEME,new Cz)}catch(Cpe){}}const Kz=()=>n(5817);let Xz;class Yz{constructor(){this.util=n(8590),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=HO().global.fetch?HO().global.fetch(e,t):(null==Xz&&(Xz=Kz()),Xz(e,t))}now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}function Qz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",zO(e),new KL(e,t,n)}HO().get("IS_NODE")&&!HO().get("IS_BROWSER")&&HO().setPlatform("node",new Yz);const Jz=FP({cast_:function(e,t){const n=OP(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:t};return IP.runKernel(xD,r,s)}});const Zz=FP({clone_:function(e){const t={x:OP(e,"x","clone","string_or_numeric")};return IP.runKernel(hM,t)}});function eB(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}SP();YL={buffer:Qz,cast:Jz,clone:Zz,print:eB};const tB=FP({add_:function(e,t){let n=OP(e,"a","add"),r=OP(t,"b","add");[n,r]=gP(n,r);const s={a:n,b:r};return IP.runKernel(eD,s)}});const nB=FP({floorDiv_:function(e,t){let n=OP(e,"a","floorDiv"),r=OP(t,"b","floorDiv");[n,r]=gP(n,r);const s={a:n,b:r};return IP.runKernel(iM,s)}});const rB=FP({div_:function(e,t){let n=OP(e,"a","div"),r=OP(t,"b","div");if([n,r]=gP(n,r),"int32"===n.dtype&&"int32"===r.dtype)return nB(n,r);const s={a:n,b:r};return IP.runKernel(qD,s,{})}});const sB=FP({mul_:function(e,t){let n=OP(e,"a","mul"),r=OP(t,"b","mul");[n,r]=gP(n,r);const s={a:n,b:r};return IP.runKernel(UM,s)}});const aB=FP({sqrt_:function(e){const t={x:OP(e,"x","sqrt","float32")};return IP.runKernel(EF,t)}});const iB=FP({square_:function(e){const t=OP(e,"x","square");return IP.runKernel("Square",{x:t},{})}});const oB=FP({zerosLike_:function(e){const t={x:OP(e,"x","zerosLike")};return IP.runKernel(tL,t)}});function lB(e){return IP.customGrad(e)}function uB(e,t){if((PL(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&PL(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return PP(e,[],[],t)}const cB=new Map,dB=new Map;class hB{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class pB{constructor(){this.classNameMap={}}static getMap(){return null==pB.instance&&(pB.instance=new pB),pB.instance}static register(e){pB.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function fB(e,t,n){hO(null!=e.className,(()=>"Class being registered does not have the static className property defined.")),hO("string"===typeof e.className,(()=>"className is required to be a string, but got type "+typeof e.className)),hO(e.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),"undefined"===typeof t&&(t="Custom"),"undefined"===typeof n&&(n=e.className);const r=t+">"+n;return pB.register(e),cB.set(r,e),dB.set(e,r),e}class mB extends hB{minimize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:r,grads:s}=this.computeGradients(e,n);if(null!=n){const e=n.map((e=>({name:e.name,tensor:s[e.name]})));this.applyGradients(e)}else this.applyGradients(s);return GP(s),t?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return function(e,t){hO(_O(e),(()=>"The f passed in variableGrads(f) must be a function")),hO(null==t||Array.isArray(t)&&t.every((e=>e instanceof eP)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=t;if(!n){t=[];for(const e in IP.registeredVariables)t.push(IP.registeredVariables[e])}const r=n?t.filter((e=>!e.trainable)):null,s=t.length;hO((t=t.filter((e=>e.trainable))).length>0,(()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`));const{value:a,grads:i}=IP.gradients(e,t,null,!0);hO(i.some((e=>null!=e)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),hO(0===a.rank,(()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`));const o={};return t.forEach(((e,t)=>{null!=i[t]&&(o[e.name]=i[t])})),null!=r&&r.forEach((e=>o[e.name]=null)),{value:a,grads:o}}(e,t)}dispose(){null!=this.iterations_&&GP(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:uB(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(mB,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});class gB extends mB{static get className(){return"Adadelta"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=IP.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=IP.registeredVariables[t],s=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${t}/accum_grad`,variable:WP((()=>oB(r).variable(s)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:`${t}/accum_var`,variable:WP((()=>oB(r).variable(s)))});const a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;const i=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;WP((()=>{const e=tB(sB(i,this.rho),sB(iB(a),1-this.rho)),t=sB(rB(aB(tB(o,this.epsilon)),aB(tB(i,this.epsilon))),a),n=tB(sB(o,this.rho),sB(iB(t),1-this.rho));i.assign(e),o.assign(n);const s=tB(sB(t,-this.learningRate),r);r.assign(s)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(GP(this.accumulatedGrads.map((e=>e.variable))),GP(this.accumulatedUpdates.map((e=>e.variable))))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){const t=(e=await this.extractIterations(e)).length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedUpdates=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}function yB(e,t,n){zO(e);const r={shape:e,value:t,dtype:n=n||RO(t)};return IP.runKernel(rM,{},r)}class vB extends mB{static get className(){return"Adagrad"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=IP.registeredVariables[t];if(null==this.accumulatedGrads[n]){const e=!1;this.accumulatedGrads[n]={originalName:`${t}/accumulator`,variable:WP((()=>yB(r.shape,this.initialAccumulatorValue).variable(e)))}}const s=Array.isArray(e)?e[n].tensor:e[t];if(null==s)return;const a=this.accumulatedGrads[n].variable;WP((()=>{const e=tB(a,iB(s));a.assign(e);const t=tB(sB(rB(s,aB(tB(e,IP.backend.epsilon()))),-this.learningRate),r);r.assign(t)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&GP(this.accumulatedGrads.map((e=>e.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);this.accumulatedGrads=e.map((e=>({originalName:e.name,variable:e.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}const bB=FP({pow_:function(e,t){let n=OP(e,"base","pow"),r=OP(t,"exp","pow");[n,r]=gP(n,r);const s={a:n,b:r};return IP.runKernel(JM,s)}});const xB=FP({sub_:function(e,t){let n=OP(e,"a","sub"),r=OP(t,"b","sub");[n,r]=gP(n,r);const s={a:n,b:r};return IP.runKernel(GF,s)}});class wB extends mB{static get className(){return"Adam"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],WP((()=>{this.accBeta1=uB(t).variable(),this.accBeta2=uB(n).variable()})),null==r&&(this.epsilon=IP.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);WP((()=>{const n=xB(1,this.accBeta1),r=xB(1,this.accBeta2);t.forEach(((t,s)=>{const a=IP.registeredVariables[t],i=!1;null==this.accumulatedFirstMoment[s]&&(this.accumulatedFirstMoment[s]={originalName:`${t}/m`,variable:WP((()=>oB(a).variable(i)))}),null==this.accumulatedSecondMoment[s]&&(this.accumulatedSecondMoment[s]={originalName:`${t}/v`,variable:WP((()=>oB(a).variable(i)))});const o=Array.isArray(e)?e[s].tensor:e[t];if(null==o)return;const l=this.accumulatedFirstMoment[s].variable,u=this.accumulatedSecondMoment[s].variable,c=tB(sB(l,this.beta1),sB(o,1-this.beta1)),d=tB(sB(u,this.beta2),sB(iB(o),1-this.beta2)),h=rB(c,n),p=rB(d,r);l.assign(c),u.assign(d);const f=tB(sB(rB(h,tB(aB(p),this.epsilon)),-this.learningRate),a);a.assign(f)})),this.accBeta1.assign(sB(this.accBeta1,this.beta1)),this.accBeta2.assign(sB(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&GP(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedSecondMoment&&GP(this.accumulatedSecondMoment.map((e=>e.variable)))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e),WP((()=>{this.accBeta1.assign(bB(this.beta1,this.iterations_+1)),this.accBeta2.assign(bB(this.beta2,this.iterations_+1))}));const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedSecondMoment=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}const kB=FP({abs_:function(e){const t=OP(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return IP.runKernel(ID,e)}{const e={x:t};return IP.runKernel(QO,e)}}});function SB(e,t){const n=e.length,r=[];for(let s=0;s<n;s++){const a=n-1-s,i=e[a]||1;(t[t.length-1-s]||1)>1&&1===i&&r.unshift(a)}return r}function IB(e,t){const n=[];for(let r=0;r<t.length;r++){const s=e[e.length-r-1],a=t.length-r-1,i=t[a];(null==s||1===s&&i>1)&&n.unshift(a)}return n}function CB(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let s=0;s<n;s++){let a=e[e.length-s-1];null==a&&(a=1);let i=t[t.length-s-1];if(null==i&&(i=1),1===a)r[n-s-1]=i;else if(1===i)r[n-s-1]=a;else{if(a!==i){throw Error(`Operands could not be broadcast together with shapes ${e} and ${t}.`)}r[n-s-1]=a}}return r}const TB=FP({maximum_:function(e,t){let n=OP(e,"a","maximum"),r=OP(t,"b","maximum");[n,r]=gP(n,r),"bool"===n.dtype&&(n=Jz(n,"int32"),r=Jz(r,"int32")),CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(RM,s)}});class NB extends mB{static get className(){return"Adamax"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],WP((()=>{this.iteration=uB(0).variable(),this.accBeta1=uB(t).variable()})),null==r&&(this.epsilon=IP.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);WP((()=>{const n=xB(1,this.accBeta1),r=rB(-this.learningRate,tB(sB(this.iteration,this.decay),1));t.forEach(((t,s)=>{const a=IP.registeredVariables[t],i=!1;null==this.accumulatedFirstMoment[s]&&(this.accumulatedFirstMoment[s]={originalName:`${t}/m`,variable:oB(a).variable(i)}),null==this.accumulatedWeightedInfNorm[s]&&(this.accumulatedWeightedInfNorm[s]={originalName:`${t}/v`,variable:oB(a).variable(i)});const o=Array.isArray(e)?e[s].tensor:e[t];if(null==o)return;const l=this.accumulatedFirstMoment[s].variable,u=this.accumulatedWeightedInfNorm[s].variable,c=tB(sB(l,this.beta1),sB(o,1-this.beta1)),d=sB(u,this.beta2),h=kB(o),p=TB(d,h);l.assign(c),u.assign(p);const f=tB(sB(rB(r,n),rB(c,tB(p,this.epsilon))),a);a.assign(f)})),this.iteration.assign(tB(this.iteration,1)),this.accBeta1.assign(sB(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&GP(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedWeightedInfNorm&&GP(this.accumulatedWeightedInfNorm.map((e=>e.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}class EB extends mB{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;const s=IP.registeredVariables[t];WP((()=>{const e=tB(sB(this.c,r),s);s.assign(e)}))})),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=HP(uB(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}class AB extends EB{static get className(){return"Momentum"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=uB(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=IP.registeredVariables[t];if(null==this.accumulations[n]){const e=!1;this.accumulations[n]={originalName:`${t}/momentum`,variable:WP((()=>oB(r).variable(e)))}}const s=this.accumulations[n].variable,a=Array.isArray(e)?e[n].tensor:e[t];null!=a&&WP((()=>{let e;const t=tB(sB(this.m,s),a);e=this.useNesterov?tB(sB(this.c,tB(a,sB(t,this.m))),r):tB(sB(this.c,t),r),s.assign(t),r.assign(e)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&GP(this.accumulations.map((e=>e.variable)))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);this.accumulations=e.map((e=>({originalName:e.name,variable:e.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}class RB extends mB{static get className(){return"RMSProp"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,null==r&&(this.epsilon=IP.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=IP.registeredVariables[t],s=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:`${t}/rms`,variable:WP((()=>oB(r).variable(s)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:`${t}/momentum`,variable:WP((()=>oB(r).variable(s)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${t}/mg`,variable:WP((()=>oB(r).variable(s)))});const a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;const i=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;WP((()=>{const e=tB(sB(i,this.decay),sB(iB(a),1-this.decay));if(this.centered){const t=this.accumulatedMeanGrads[n].variable,s=tB(sB(t,this.decay),sB(a,1-this.decay)),l=rB(sB(a,this.learningRate),aB(xB(e,tB(iB(s),this.epsilon)))),u=tB(sB(o,this.momentum),l);i.assign(e),t.assign(s),o.assign(u);const c=xB(r,u);r.assign(c)}else{const e=tB(sB(i,this.decay),sB(iB(a),1-this.decay)),t=tB(sB(o,this.momentum),rB(sB(a,this.learningRate),aB(tB(e,this.epsilon))));i.assign(e),o.assign(t);const n=xB(r,t);r.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&GP(this.accumulatedMeanSquares.map((e=>e.variable))),null!=this.accumulatedMeanGrads&&this.centered&&GP(this.accumulatedMeanGrads.map((e=>e.variable))),null!=this.accumulatedMoments&&GP(this.accumulatedMoments.map((e=>e.variable)))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedMoments=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}const _B=[gB,vB,wB,NB,AB,RB,EB];function $B(e){return new Promise((e=>setTimeout(e))).then(e)}class OB{constructor(e){if(!HO().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(OB.URL_SCHEME)&&(e=e.slice(OB.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=jP.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const t=lz(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),s=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(s.download=this.modelJsonFileName,s.href=r,await $B((()=>s.dispatchEvent(new MouseEvent("click")))),null!=e.weightData){const e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await $B((()=>e.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:dz(e)}}}}OB.URL_SCHEME="downloads://";class DB{constructor(e){if(null==e||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise(((e,t)=>{const n=new FileReader;n.onload=n=>{const r=JSON.parse(n.target.result),s=r.modelTopology;if(null==s)return void t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));if(null==r.weightsManifest)return void t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));if(0===this.weightsFiles.length)return void e({modelTopology:s});const a=cz(r,(e=>this.loadWeights(e)));e(a)},n.onerror=e=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)}))}loadWeights(e){const t=[],n=[];for(const a of e)t.push(...a.weights),n.push(...a.paths);const r=this.checkManifestAndWeightFiles(e),s=n.map((e=>this.loadWeightsFile(e,r[e])));return Promise.all(s).then((e=>[t,e]))}loadWeightsFile(e,t){return new Promise(((n,r)=>{const s=new FileReader;s.onload=e=>{const t=e.target.result;n(t)},s.onerror=t=>r(`Failed to weights data from file of path '${e}'.`),s.readAsArrayBuffer(t)}))}checkManifestAndWeightFiles(e){const t=[],n=this.weightsFiles.map((e=>oz(e.name))),r={};for(const s of e)s.paths.forEach((e=>{const s=oz(e);if(-1!==t.indexOf(s))throw new Error(`Duplicate file basename found in weights manifest: '${s}'`);if(t.push(s),-1===n.indexOf(s))throw new Error(`Weight file with basename '${s}' is not provided.`);r[e]=this.weightsFiles[n.indexOf(s)]}));if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}function MB(e){return new DB(e)}function FB(e,t,n,r){!function(e){hO(null!=e&&Array.isArray(e)&&e.length>0,(()=>"promises must be a none empty array"))}(e),function(e,t){hO(e>=0&&e<=1,(()=>`Progress fraction must be in range [0, 1], but got startFraction ${e}`)),hO(t>=0&&t<=1,(()=>`Progress fraction must be in range [0, 1], but got endFraction ${t}`)),hO(t>=e,(()=>`startFraction must be no more than endFraction, but got startFraction ${e} and endFraction ${t}`))}(n=null==n?0:n,r=null==r?1:r);let s=0;return Promise.all(e.map((a=>(a.then((a=>{const i=n+ ++s/e.length*(r-n);return t(i),a})),a))))}async function LB(e,t){null==t&&(t={});const n=null==t.fetchFunc?HO().platform.fetch:t.fetchFunc,r=e.map((e=>n(e,t.requestInit,{isBinary:!0}))),s=(null==t.onProgress?await Promise.all(r):await FB(r,t.onProgress,0,.5)).map((e=>e.arrayBuffer()));return null==t.onProgress?await Promise.all(s):await FB(s,t.onProgress,.5,1)}async function PB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return zB((e=>LB(e,{requestInit:r})))(e,t,n)}function zB(e){return async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;const s=t.map((()=>!1)),a={},i=null!=r?r.map((()=>!1)):[],o=[];if(t.forEach(((e,t)=>{let n=0;e.weights.forEach((e=>{const l="quantization"in e?e.quantization.dtype:e.dtype,u=BP[l]*mO(e.shape),c=()=>{s[t]=!0,null==a[t]&&(a[t]=[]),a[t].push({manifestEntry:e,groupOffset:n,sizeBytes:u})};null!=r?r.forEach(((t,n)=>{t===e.name&&(c(),i[n]=!0)})):c(),o.push(e.name),n+=u}))})),!i.every((e=>e))){const e=r.filter(((e,t)=>!i[t]));throw new Error(`Could not find weights in manifest with names: ${e.join(", ")}. \nManifest JSON has weights with names: ${o.join(", ")}.`)}const l=s.reduce(((e,t,n)=>(t&&e.push(n),e)),[]),u=[];l.forEach((e=>{t[e].paths.forEach((e=>{const t=n+(n.endsWith("/")?"":"/")+e;u.push(t)}))}));const c=await e(u),d={};let h=0;return l.forEach((e=>{const n=t[e].paths.length,r=new jP(c.slice(h,h+n));a[e].forEach((e=>{const t=QP(r.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(const n in t)d[n]=t[n]})),h+=n})),d}}pz.registerSaveRouter((e=>HO().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(OB.URL_SCHEME)?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new OB(e)}(e.slice(OB.URL_SCHEME.length)):null));class BB{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(hO("function"===typeof t.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=t.fetchFunc):this.fetch=HO().platform.fetch,hO(null!=e&&e.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(e)&&hO(2===e.length,(()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`)),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=lz(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){const n=jP.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:dz(e),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch(Ipe){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=t.modelTopology,r=t.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();return cz(await this.loadModelJSON(),(e=>this.loadWeights(e)))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=hz(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>function(e,t){var n;const r=null==t.fetchFunc?HO().platform.fetch:t.fetchFunc;let s,a=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:async n=>{for(var i;a<e.length;){if(!s){const n=(await r(e[a],t.requestInit,{isBinary:!0})).body;s=n.getReader()}const{done:o,value:l}=await s.read();if(!o)return void n.enqueue(l);a++,s=void 0,null===(i=t.onProgress)||void 0===i||i.call(t,a/e.length)}n.close()}})}(t,this.loadOptions)})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),s=n>t?e.substring(n):"";return[r+"/",s]}(t),s=this.weightPathPrefix||n,a=[],i=[];for(const o of e)for(const e of o.paths)null!=this.weightUrlConverter?i.push(this.weightUrlConverter(e)):a.push(s+e+r);return this.weightUrlConverter&&a.push(...await Promise.all(i)),a}async loadWeights(e){const t=await this.getWeightUrls(e);return[hz(e),await LB(t,this.loadOptions)]}}function jB(e){return null!=e.match(BB.URL_SCHEME_REGEX)}BB.URL_SCHEME_REGEX=/^https?:\/\//;const UB=(e,t)=>{if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every((e=>jB(e))):jB(e),n)return VB(e,t)}return null};function VB(e,t){return new BB(e,t)}function WB(e,t){return VB(e,t)}pz.registerSaveRouter(UB),pz.registerLoadRouter(UB);class GB{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class HB{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class qB{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function KB(e,t,n,r){return new qB(XB(...arguments))}function XB(e,t,n,r){if(1===arguments.length){return null!=e.modelTopology||null!=e.weightSpecs?new GB(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new GB({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new GB({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function YB(e){return new HB(e)}function QB(e){return new HB(e)}function JB(e,t,n){if(fO(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const r=RP(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return PP(e,t,r,n)}let ZB;function ej(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,a=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)s=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)a=!0;else if(null!=e.getContext)i=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);o=!0}if(null!=hL(rL,IP.backendName)){const n={pixels:e},r={numChannels:t};return IP.runKernel(rL,n,r)}const[l,u]=s?[e.videoWidth,e.videoHeight]:[e.width,e.height];let c,d;if(i)c=e.getContext("2d").getImageData(0,0,l,u).data;else if(r||n)c=e.data;else if(a||s||o){if(null==ZB)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");ZB=new OffscreenCanvas(1,1).getContext("2d")}else ZB=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});ZB.canvas.width=l,ZB.canvas.height=u,ZB.drawImage(e,0,0,l,u),c=ZB.getImageData(0,0,l,u).data}if(4===t)d=new Int32Array(c);else{const e=l*u;d=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)d[n*t+e]=c[4*n+e]}return JB(d,[u,l,t],"int32")}const tj=FP({fromPixels_:ej}),nj=-2,rj=-1;function sj(e,t,n){const r=e.shape.length;hO(r===t.length,(()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`)),hO(r===n.length,(()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`));for(let s=0;s<r;++s)hO(t[s]+n[s]<=e.shape[s],(()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${t[s]+n[s]}) would overflow input.shape[${s}] (${e.shape[s]})`))}function aj(e){const t=[];let n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function ij(e,t,n){const r=[];for(let s=0;s<e.length;s++)r[s]=Math.ceil((t[s]-e[s])/n[s]);return r}function oj(e,t,n,r){const s=[...e];for(let a=s.length;a<r.length;a++)s.push(1);for(let a=0;a<n;a++)0===a?s[t]=1:(s.splice(t,0,1),s.pop());return s}function lj(e,t,n){return n<=e?n:n-(t-1)}function uj(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function cj(e,t,n,r,s,a,i,o,l){const u=e.length;let c=new Array(u),d=new Array(u),h=new Array(u);if(t.length&&n>0){const l=t[0],u=n+1;c=dj(i,l,u,r,e),d=hj(o,l,u,s,e),h=oj(a,l,u,e)}else for(let p=0;p<u;p++)c[p]=fj(i,r,a,e,p,l),d[p]=mj(o,s,a,e,p,l),h[p]=pj(a,p,l);return{begin:c,end:d,strides:h}}function dj(e,t,n,r,s){const a=[...s],i=uj(n,t);for(let o=0;o<a.length;o++)if(i.indexOf(o)>-1)a[o]=0;else{const s=lj(t,n,o);let i=r[s];e&1<<s&&(i=0),a[o]=i}return a}function hj(e,t,n,r,s){const a=[...s],i=uj(n,t);for(let o=0;o<a.length;o++)if(i.indexOf(o)>-1)a[o]=Number.MAX_SAFE_INTEGER;else{const s=lj(t,n,o);let i=r[s];e&1<<s&&(i=Number.MAX_SAFE_INTEGER),a[o]=i}for(let o=0;o<a.length;o++){const e=s[o];a[o]<0&&(a[o]+=e),a[o]=uO(0,a[o],s[o])}return a}function pj(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function fj(e,t,n,r,s,a){let i=t[s];const o=n[s]||1;(e&1<<s||a&1<<s||null==i)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),i=uO(0,i,l-1),i}function mj(e,t,n,r,s,a){let i=t[s];const o=n[s]||1;(e&1<<s||a&1<<s||null==i)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),i=o>0?uO(0,i,l):uO(-1,i,l-1),i}function gj(e,t,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(t[s]>0||n[s]!==e[s])return!1;return!0}function yj(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function vj(e,t,n){let r;const s=e.shape.length;let a;return r="number"===typeof t?[t,...new Array(s-1).fill(0)]:t.length<s?t.concat(new Array(s-t.length).fill(0)):t.slice(),r.forEach((e=>{hO(-1!==e,(()=>"slice() does not support negative begin indexing."))})),a=null==n?new Array(s).fill(-1):"number"===typeof n?[n,...new Array(s-1).fill(-1)]:n.length<s?n.concat(new Array(s-n.length).fill(-1)):n,a=a.map(((t,n)=>t>=0?t:(hO(-1===t,(()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${n}.`)),e.shape[n]-r[n]))),[r,a]}function bj(e,t,n,r,s,a,i,o,l){let u;if(null==r?(u=new Array(t.length),u.fill(1)):u=r,null!=i&&0!==(i&i-1))throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:u.slice(),beginMask:s,endMask:a,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};for(let v=0;v<d.dims;v++)c&&0!==(1<<v&o)&&d.numAddAxisAfterEllipsis++,1<<v&i&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const s=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<s;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(nj),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(rj),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(d,h);let p=!0,f=!0,m=!0;const g=[],y=[];for(let v=0;v<e.length;++v){if(0===h.strides[v])throw Error(`strides[${v}] must be non-zero`);const t=!!(h.shrinkAxisMask&1<<v),n=e[v];if(-1===n){g.push(t?1:-1);continue}const r=[h.beginMask&1<<v,h.endMask&1<<v],s=[h.strides[v]>0?0:-1,h.strides[v]>0?n:n-1];if(t&&h.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===h.strides[v];const a=!!(h.beginMask&1<<v&&h.endMask&1<<v);if(h.beginValid&&h.endValid){if(t){const e=h.begin[v]<0?n+h.begin[v]:h.begin[v];if(h.begin[v]=e,h.end[v]=h.begin[v]+1,e<0||e>=n)throw Error(`slice index ${h.begin[v]} of dimension ${v} out of bounds.`)}else h.begin[v]=xj(h.begin[v],0,h.strides[v],n,r,s),h.end[v]=xj(h.end[v],1,h.strides[v],n,r,s);const e=1===h.strides[v]&&0===h.begin[v]&&h.end[v]===n;p=p&&e,f=f&&(0===v&&1===h.strides[v]||e)}else p=p&&1===h.strides[v]&&a,f=f&&(0===v&&1===h.strides[v]||a);let i,o=!1;if(h.beginValid&&h.endValid?(i=h.end[v]-h.begin[v],o=!0):t?(i=1,o=!0):a&&n>=0&&(i=h.strides[v]<0?-n:n,o=!0),o){let e;e=0===i||i<0!==h.strides[v]<0?0:Math.trunc(i/h.strides[v])+(i%h.strides[v]!==0?1:0),g.push(e)}else g.push(-1)}for(let v=0;v<h.finalShapeGatherIndices.length;++v){const e=h.finalShapeGatherIndices[v];e>=0?y.push(g[e]):e===nj&&y.push(1)}return{finalShapeSparse:y.filter(((e,t)=>h.finalShapeGatherIndices[t]!==nj)),finalShape:y,isIdentity:p,sliceDim0:f,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function xj(e,t,n,r,s,a){if(s[t])return n>0?a[t]:a[t+1&1];{const t=e<0?r+e:e;return t<a[0]?a[0]:t>a[1]?a[1]:t}}const wj=FP({acos_:function(e){const t={x:OP(e,"x","acos")};return IP.runKernel(JO,t)}});const kj=FP({acosh_:function(e){const t={x:OP(e,"x","acosh")};return IP.runKernel(ZO,t)}});const Sj=FP({addN_:function(e){hO(Array.isArray(e),(()=>"The argument passed to tf.addN() must be a list of tensors")),hO(e.length>=1,(()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`));const t=e.map(((e,t)=>OP(e,`tensors${t}`,"addN"))),n=t[0];t.forEach((e=>{if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((e=>{if(!gO(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const r=t;return IP.runKernel(tD,r)}});const Ij=FP({all_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:OP(e,"x","all","bool")},s={axis:t,keepDims:n};return IP.runKernel(nD,r,s)}});const Cj=FP({any_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:OP(e,"x","any","bool")},s={axis:t,keepDims:n};return IP.runKernel(rD,r,s)}});const Tj=FP({argMax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:OP(e,"x","argMax")},r={axis:t};return IP.runKernel(sD,n,r)}});const Nj=FP({argMin_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:OP(e,"x","argMin")},r={axis:t};return IP.runKernel(aD,n,r)}});const Ej=FP({asin_:function(e){const t={x:OP(e,"x","asin")};return IP.runKernel(iD,t)}});const Aj=FP({asinh_:function(e){const t={x:OP(e,"x","asinh")};return IP.runKernel(oD,t)}});const Rj=FP({atan_:function(e){const t={x:OP(e,"x","atan")};return IP.runKernel(lD,t)}});const _j=FP({atan2_:function(e,t){let n=OP(e,"a","atan2"),r=OP(t,"b","atan2");[n,r]=gP(n,r);const s={a:n,b:r};return IP.runKernel(cD,s)}});const $j=FP({atanh_:function(e){const t={x:OP(e,"x","atanh")};return IP.runKernel(uD,t)}});function Oj(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",a=arguments.length>5?arguments[5]:void 0;return Fj(e,[...t,e[3]],n,a,r,null,null,Hj(s))}function Dj(e,t,n,r,s,a){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[o,l]=zj(t);let u;if("channelsLast"===i)u=[o,l,e[3],e[3]];else{if("channelsFirst"!==i)throw new Error(`Unknown dataFormat ${i}`);u=[o,l,e[1],e[1]]}return Fj(e,u,n,r,s,a,!1,i)}function Mj(e,t,n,r,s,a){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[o,l,u]=Bj(t);let c,d;if("NDHWC"===i)d="channelsLast",c=[o,l,u,e[4],e[4]];else{if("NCDHW"!==i)throw new Error(`Unknown dataFormat ${i}`);d="channelsFirst",c=[o,l,u,e[1],e[1]]}return Lj(e,c,n,r,s,!1,d,a)}function Fj(e,t,n,r,s,a){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[l,u,c,d]=[-1,-1,-1,-1];if("channelsLast"===o)[l,u,c,d]=e;else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);[l,d,u,c]=e}const[h,p,,f]=t,[m,g]=zj(n),[y,v]=zj(r),b=jj(h,y),x=jj(p,v),{padInfo:w,outHeight:k,outWidth:S}=function(e,t,n,r,s,a,i,o,l){let u,c,d;if("number"===typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const s=function(e,t,n,r,s){null==r&&(r=Pj(e,t,n));const a=e[0],i=e[1],o=Uj((a-t+2*r)/n+1,s),l=Uj((i-t+2*r)/n+1,s);return[o,l]}([t,n],a,r,e,o);c=s[0],d=s[1]}else if("same"===e){c=Math.ceil(t/r),d=Math.ceil(n/s);const e=Math.max(0,(c-1)*r+a-t),o=Math.max(0,(d-1)*s+i-n),l=Math.floor(e/2),h=e-l,p=Math.floor(o/2);u={top:l,bottom:h,left:p,right:o-p,type:"SAME"}}else if("valid"===e)u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-a+1)/r),d=Math.ceil((n-i+1)/s);else{if("object"!==typeof e)throw Error(`Unknown padding parameter: ${e}`);{const h="channelsLast"===l?e[1][0]:e[2][0],p="channelsLast"===l?e[1][1]:e[2][1],f="channelsLast"===l?e[2][0]:e[3][0],m="channelsLast"===l?e[2][1]:e[3][1];u={top:h,bottom:p,left:f,right:m,type:0===h&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},c=Uj((t-a+h+p)/r+1,o),d=Uj((n-i+f+m)/s+1,o)}}return{padInfo:u,outHeight:c,outWidth:d}}(s,u,c,m,g,b,x,a,o),I=i?f*d:f;let C;return"channelsFirst"===o?C=[l,I,k,S]:"channelsLast"===o&&(C=[l,k,S,I]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:c,inChannels:d,outHeight:k,outWidth:S,outChannels:I,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:p,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:y,dilationWidth:v,inShape:e,outShape:C,filterShape:t}}function Lj(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",o=arguments.length>7?arguments[7]:void 0,[l,u,c,d,h]=[-1,-1,-1,-1,-1];if("channelsLast"===i)[l,u,c,d,h]=e;else{if("channelsFirst"!==i)throw new Error(`Unknown dataFormat ${i}`);[l,h,u,c,d]=e}const[p,f,m,,g]=t,[y,v,b]=Bj(n),[x,w,k]=Bj(r),S=jj(p,x),I=jj(f,w),C=jj(m,k),{padInfo:T,outDepth:N,outHeight:E,outWidth:A}=function(e,t,n,r,s,a,i,o,l,u,c){let d,h,p,f;"valid"===e&&(e=0);if("number"===typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};const m=function(e,t,n,r,s,a){null==s&&(s=Pj(e,t[0],r[0]));const i=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*s>=t[o]&&(i[o]=Uj((e[o]-t[o]+2*s)/r[o]+1,a));return i}([t,n,r,1],[o,l,u],1,[s,a,i],e,c);h=m[0],p=m[1],f=m[2]}else{if("same"!==e)throw Error(`Unknown padding parameter: ${e}`);{h=Math.ceil(t/s),p=Math.ceil(n/a),f=Math.ceil(r/i);const e=(h-1)*s+o-t,c=(p-1)*a+l-n,m=(f-1)*i+u-r,g=Math.floor(e/2),y=e-g,v=Math.floor(c/2),b=c-v,x=Math.floor(m/2);d={top:v,bottom:b,left:x,right:m-x,front:g,back:y,type:"SAME"}}}return{padInfo:d,outDepth:h,outHeight:p,outWidth:f}}(s,u,c,d,y,v,b,S,I,C,o),R=a?g*h:g;let _;return"channelsFirst"===i?_=[l,R,N,E,A]:"channelsLast"===i&&(_=[l,N,E,A,R]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:c,inWidth:d,inChannels:h,outDepth:N,outHeight:E,outWidth:A,outChannels:R,padInfo:T,strideDepth:y,strideHeight:v,strideWidth:b,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:I,effectiveFilterWidth:C,dilationDepth:x,dilationHeight:w,dilationWidth:k,inShape:e,outShape:_,filterShape:t}}function Pj(e,t,n){const r=jj(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)}function zj(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Bj(e){return"number"===typeof e?[e,e,e]:e}function jj(e,t){return t<=1?e:e+(e-1)*(t-1)}function Uj(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function Vj(e){const[t,n,r]=zj(e);return 1===t&&1===n&&1===r}function Wj(e,t){return Vj(e)||Vj(t)}function Gj(e){return zj(e).every((e=>e>0))}function Hj(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function qj(e,t,n){if(null!=n){if("string"===typeof t)throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if("number"===typeof t)hO(yO(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`));else{if("object"!==typeof t)throw Error(`Error in ${e}: Unknown padding parameter: ${t}`);t.forEach((t=>{t.forEach((t=>{hO(yO(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`))}))}))}}}const Kj=FP({reshape_:function(e,t){const n={x:OP(e,"x","reshape","string_or_numeric")},r={shape:t};return IP.runKernel(lF,n,r)}});const Xj=FP({avgPool_:function(e,t,n,r,s){const a=OP(e,"x","avgPool","float32");hO(Wj(n,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`));let i=a,o=!1;3===a.rank&&(o=!0,i=Kj(a,[1,a.shape[0],a.shape[1],a.shape[2]])),hO(4===i.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${i.rank}.`)),qj("avgPool",r,s);const l={x:i},u={filterSize:t,strides:n,pad:r,dimRoundingMode:s};let c=IP.runKernel(dD,l,u);return c=Jz(c,a.dtype),o?Kj(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const Yj=FP({avgPool3d_:function(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const i=OP(e,"x","avgPool3d","float32");let o=i,l=!1;4===i.rank&&(l=!0,o=Kj(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),hO(5===o.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`)),hO("NDHWC"===a,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`)),hO("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`)),qj("avgPool3d",r,s);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:s,dataFormat:a};let d=IP.runKernel(pD,u,c);return d=Jz(d,o.dtype),l?Kj(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const Qj=FP({concat_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;hO(e.length>=1,(()=>"Pass at least one tensor to concat"));const n=DP(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((e=>{if("complex64"!==e.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${e.dtype}. `)})),1===n.length)return Zz(n[0]);const r=n,s={axis:t};return IP.runKernel(CD,r,s)}});const Jj=FP({matMul_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=OP(e,"a","matMul"),a=OP(t,"b","matMul");[s,a]=gP(s,a);const i={a:s,b:a},o={transposeA:n,transposeB:r};return IP.runKernel(mD,i,o)}});const Zj=FP({sigmoid_:function(e){const t={x:OP(e,"x","sigmoid","float32")};return IP.runKernel(TF,t)}});const eU=FP({slice_:function(e,t,n){const r=OP(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const s={x:r},a={begin:t,size:n};return IP.runKernel(kF,s,a)}});const tU=FP({tanh_:function(e){const t={x:OP(e,"x","tanh","float32")};return IP.runKernel(qF,t)}});const nU=FP({basicLSTMCell_:function(e,t,n,r,s,a){const i=OP(e,"forgetBias","basicLSTMCell"),o=OP(t,"lstmKernel","basicLSTMCell"),l=OP(n,"lstmBias","basicLSTMCell"),u=OP(r,"data","basicLSTMCell"),c=OP(s,"c","basicLSTMCell"),d=OP(a,"h","basicLSTMCell"),h=Qj([u,d],1),p=Jj(h,o),f=tB(p,l),m=f.shape[0],g=f.shape[1]/4,y=[m,g],v=eU(f,[0,0],y),b=eU(f,[0,g],y),x=eU(f,[0,2*g],y),w=eU(f,[0,3*g],y),k=tB(sB(Zj(v),tU(b)),sB(c,Zj(tB(i,x))));return[k,sB(tU(k),Zj(w))]}});const rU=FP({batchToSpaceND_:function(e,t,n){const r=OP(e,"x","batchToSpaceND"),s=t.reduce(((e,t)=>e*t));hO(r.rank>=1+t.length,(()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`)),hO(n.length===t.length,(()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`)),hO(r.shape[0]%s===0,(()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${s}`));const a={x:r},i={blockShape:t,crops:n};return IP.runKernel(gD,a,i)}});const sU=FP({batchNorm_:function(e,t,n,r,s,a){null==a&&(a=.001);const i=OP(e,"x","batchNorm"),o=OP(t,"mean","batchNorm"),l=OP(n,"variance","batchNorm");let u,c;null!=s&&(u=OP(s,"scale","batchNorm")),null!=r&&(c=OP(r,"offset","batchNorm")),hO(o.rank===l.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),hO(null==c||o.rank===c.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),hO(null==u||o.rank===u.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const d={x:function(e){let t;return t=0===e.rank||1===e.rank?Kj(e,[1,1,1,e.size]):2===e.rank?Kj(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Kj(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(i),scale:u,offset:c,mean:o,variance:l},h={varianceEpsilon:a},p=IP.runKernel(oM,d,h);return Kj(p,i.shape)}});const aU=FP({batchNorm2d_:function(e,t,n,r,s,a){const i=OP(e,"x","batchNorm"),o=OP(t,"mean","batchNorm"),l=OP(n,"variance","batchNorm");let u,c;return null!=s&&(u=OP(s,"scale","batchNorm")),null!=r&&(c=OP(r,"offset","batchNorm")),hO(2===i.rank,(()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`)),hO(2===o.rank||1===o.rank,(()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`)),hO(2===l.rank||1===l.rank,(()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`)),null!=u&&hO(2===u.rank||1===u.rank,(()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`)),null!=c&&hO(2===c.rank||1===c.rank,(()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`)),sU(i,o,l,c,u,a)}});const iU=FP({batchNorm3d_:function(e,t,n,r,s,a){const i=OP(e,"x","batchNorm"),o=OP(t,"mean","batchNorm"),l=OP(n,"variance","batchNorm");let u,c;return null!=s&&(u=OP(s,"scale","batchNorm")),null!=r&&(c=OP(r,"offset","batchNorm")),hO(3===i.rank,(()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`)),hO(3===o.rank||1===o.rank,(()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`)),hO(3===l.rank||1===l.rank,(()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`)),null!=u&&hO(3===u.rank||1===u.rank,(()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`)),null!=c&&hO(3===c.rank||1===c.rank,(()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`)),sU(i,o,l,c,u,a)}});const oU=FP({batchNorm4d_:function(e,t,n,r,s,a){const i=OP(e,"x","batchNorm"),o=OP(t,"mean","batchNorm"),l=OP(n,"variance","batchNorm");let u,c;return null!=s&&(u=OP(s,"scale","batchNorm")),null!=r&&(c=OP(r,"offset","batchNorm")),hO(4===i.rank,(()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`)),hO(4===o.rank||1===o.rank,(()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`)),hO(4===l.rank||1===l.rank,(()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`)),null!=u&&hO(4===u.rank||1===u.rank,(()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`)),null!=c&&hO(4===c.rank||1===c.rank,(()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`)),sU(i,o,l,c,u,a)}});const lU=FP({bincount_:function(e,t,n){const r=OP(e,"x","bincount"),s=OP(t,"weights","bincount");hO("int32"===r.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`)),hO(n>=0,(()=>`size must be non-negative, but got ${n}.`)),hO(s.size===r.size||0===s.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`));const a={x:r,weights:s},i={size:n};return IP.runKernel(yD,a,i)}});const uU=FP({bitwiseAnd_:function(e,t){const n=OP(e,"x","bitwiseAnd"),r=OP(t,"y","bitwiseAnd");if(!gO(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const s={a:n,b:r};return IP.runKernel(vD,s)}});const cU=FP({broadcastArgs_:function(e,t){const n=OP(e,"s0","broadcastArgs","int32"),r=OP(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(1!==r.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:n,s1:r};return IP.runKernel(bD,s)}});const dU=FP({broadcastTo_:function(e,t){let n=OP(e,"broadcastTo","x");const r=n.shape;if(zO(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=Kj(n,e)}const s=n.shape,a=Array.from(t);for(let l=t.length-1;l>=0;l--)if(s[l]===t[l])a[l]=1;else if(1!==n.shape[l])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(0===a.map(((e,t)=>e>1?t:-1)).filter((e=>e>=0)).length)return Zz(n);const i={x:n},o={reps:a};return IP.runKernel(KF,i,o)}});const hU=FP({ceil_:function(e){const t={x:OP(e,"x","ceil","float32")};return IP.runKernel(wD,t)}});const pU=FP({clipByValue_:function(e,t,n){const r=OP(e,"x","clipByValue");if(hO(t<=n,(()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`)),t===n)return yB(r.shape,t,r.dtype);const s={x:r},a={clipValueMin:t,clipValueMax:n};return IP.runKernel(kD,s,a)}});const fU=FP({concat1d_:function(e){return Qj(e,0)}});const mU=FP({concat2d_:function(e,t){return Qj(e,t)}});const gU=FP({concat3d_:function(e,t){return Qj(e,t)}});const yU=FP({concat4d_:function(e,t){return Qj(e,t)}});const vU=FP({conv2d_:function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0;const o=OP(e,"x","conv2d","float32"),l=OP(t,"filter","conv2d","float32");let u=o,c=!1;3===o.rank&&(c=!0,u=Kj(o,[1,o.shape[0],o.shape[1],o.shape[2]])),hO(4===u.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`)),hO(4===l.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`)),qj("conv2d",r,i);const d="NHWC"===s?u.shape[3]:u.shape[1];hO(d===l.shape[2],(()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`)),hO(Wj(n,a),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`)),hO(Gj(a),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),hO(Gj(n),(()=>"Error in conv2D: Strides should be larger than 0."));const h={x:u,filter:l},p={strides:n,pad:r,dataFormat:s,dilations:a,dimRoundingMode:i},f=IP.runKernel(TD,h,p);return c?Kj(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const bU=FP({conv1d_:function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=arguments.length>6?arguments[6]:void 0;const o=OP(e,"x","conv1d"),l=OP(t,"filter","conv1d");let u=o,c=!1;2===o.rank&&(c=!0,u=Kj(o,[1,o.shape[0],o.shape[1]])),hO(3===u.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`)),hO(3===l.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`)),qj("conv1d",r,i),hO(u.shape[2]===l.shape[1],(()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`)),hO(Wj(n,a),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`)),hO(Gj(a),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),hO(Gj(n),(()=>"Error in conv1D: Stride should be larger than 0.")),hO("NWC"===s,(()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`));const d=Kj(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=Kj(u,[u.shape[0],1,u.shape[1],u.shape[2]]),p=vU(h,d,[1,n],r,"NHWC",[1,a],i);return Kj(p,c?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}});const xU=FP({conv2DBackpropInput_:function(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0;hO(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let o=e,l=t,u=!1;3===t.rank&&(u=!0,l=Kj(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),hO(4===o.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`)),hO(4===l.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`)),hO(4===n.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`));const c="NHWC"===a?o[3]:o[1],d="NHWC"===a?l.shape[3]:l.shape[1];hO(c===n.shape[2],(()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`)),hO(d===n.shape[3],(()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`)),qj("conv2dDerInput",s,i);const h={dy:l,filter:n},p={strides:r,pad:s,dataFormat:a,dimRoundingMode:i,inputShape:o},f=IP.runKernel(ED,h,p);return u?Kj(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const wU=FP({conv2dTranspose_:function(e,t,n,r,s,a){const i=OP(e,"x","conv2dTranspose"),o=OP(t,"filter","conv2dTranspose");return xU(n,i,o,r,s,"NHWC",a)}});const kU=FP({conv3d_:function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const i=OP(e,"x","conv3d"),o=OP(t,"filter","conv3d");let l=i,u=!1;4===i.rank&&(u=!0,l=Kj(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),hO(5===l.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`)),hO(5===o.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`)),hO(l.shape[4]===o.shape[3],(()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`)),hO(Wj(n,a),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`)),hO("NDHWC"===s,(()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`)),hO(Gj(a),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),hO(Gj(n),(()=>"Error in conv3D: Strides should be larger than 0."));const c={x:l,filter:o},d={strides:n,pad:r,dataFormat:s,dilations:a},h=IP.runKernel(AD,c,d);return u?Kj(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const SU=FP({conv3DBackpropInput_:function(e,t,n,r,s){hO(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let a=e,i=t,o=!1;4===t.rank&&(o=!0,i=Kj(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),a=[1,e[0],e[1],e[2],e[3]]);const l=a[4],u=i.shape[4];hO(5===a.length,(()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`)),hO(5===i.rank,(()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`)),hO(5===n.rank,(()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`)),hO(l===n.shape[3],(()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`)),hO(u===n.shape[4],(()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`));const c={dy:i,filter:n},d={pad:s,strides:r,inputShape:a},h=IP.runKernel(_D,c,d);return o?Kj(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const IU=FP({conv3dTranspose_:function(e,t,n,r,s){const a=OP(e,"x","conv3dTranspose"),i=OP(t,"filter","conv3dTranspose");return SU(n,a,i,r,s)}});const CU=FP({cos_:function(e){const t={x:OP(e,"x","cos","float32")};return IP.runKernel($D,t)}});const TU=FP({cosh_:function(e){const t={x:OP(e,"x","cosh","float32")};return IP.runKernel(OD,t)}});const NU=FP({cumprod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s={x:OP(e,"x","cumprod")},a={axis:t,exclusive:n,reverse:r};return IP.runKernel(DD,s,a)}});const EU=FP({cumsum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s={x:OP(e,"x","cumsum")},a={axis:t,exclusive:n,reverse:r};return IP.runKernel(MD,s,a)}});const AU=FP({denseBincount_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=OP(e,"x","denseBincount"),a=OP(t,"weights","denseBincount");hO("int32"===s.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`)),hO(s.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`)),hO(n>=0,(()=>`size must be non-negative, but got ${n}.`)),hO(a.size===s.size||0===a.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${a.shape}.`));const i={x:s,weights:a},o={size:n,binaryOutput:r};return IP.runKernel(LD,i,o)}});const RU=FP({depthToSpace_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const r=OP(e,"x","depthToSpace","float32"),s="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],i="NHWC"===n?r.shape[3]:r.shape[1];hO(t>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`)),hO(s*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${s} and ${t}  for depthToSpace with input shape\n    ${r.shape}`)),hO(a*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${a} and ${t} for depthToSpace with input shape\n        ${r.shape}`)),hO(i%(t*t)===0,(()=>`Dimension size must be evenly divisible by ${t*t} but is ${i} for depthToSpace with input shape ${r.shape}`));const o={x:r},l={blockSize:t,dataFormat:n};return IP.runKernel(PD,o,l)}});const _U=FP({depthwiseConv2d_:function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0;const o=OP(e,"x","depthwiseConv2d","float32"),l=OP(t,"filter","depthwiseConv2d","float32");let u=o,c=!1;3===o.rank&&(c=!0,u=Kj(o,[1,o.shape[0],o.shape[1],o.shape[2]])),hO(4===u.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`)),hO(4===l.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`));const d="NHWC"===s?u.shape[3]:u.shape[1];hO(d===l.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`)),qj("depthwiseConv2d",r,i);const h={x:u,filter:l},p={strides:n,pad:r,dataFormat:s,dilations:a,dimRoundingMode:i},f=IP.runKernel(zD,h,p);return c?Kj(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const $U=FP({diag_:function(e){const t={x:OP(e,"x","diag")};return IP.runKernel(UD,t)}});const OU=FP({dilation2d_:function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const i=OP(e,"x","dilation2d"),o=OP(t,"filter","dilation2d");hO(3===i.rank||4===i.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`)),hO(3===o.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`)),hO("NHWC"===a,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`));let l=i,u=!1;3===i.rank&&(l=Kj(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),hO(l.shape[3]===o.shape[2],(()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`));const c={x:l,filter:o},d={strides:n,pad:r,dilations:s},h=IP.runKernel(VD,c,d);return u?Kj(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});const DU=FP({equal_:function(e,t){let n=OP(e,"a","equal","string_or_numeric"),r=OP(t,"b","equal","string_or_numeric");[n,r]=gP(n,r),CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(JD,s)}});const MU=FP({where_:function(e,t,n){const r=OP(t,"a","where"),s=OP(n,"b","where"),a=OP(e,"condition","where","bool"),i=CB(CB(a.shape,r.shape),s.shape),o={condition:dU(a,i),t:dU(r,i),e:dU(s,i)};return IP.runKernel(xF,o)}});const FU=FP({divNoNan_:function(e,t){let n=OP(e,"a","div"),r=OP(t,"b","div");[n,r]=gP(n,r);const s=rB(n,r),a=oB(s),i=DU(r,a);return MU(i,a,s)}});const LU=FP({dot_:function(e,t){const n=OP(e,"t1","dot"),r=OP(t,"t2","dot");hO((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`));const s=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];if(hO(s===a,(()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${a}.`)),1===n.rank&&1===r.rank){const e=Kj(n,[1,-1]),t=Kj(r,[-1,1]),s=Jj(e,t);return Kj(s,[])}if(1===n.rank&&2===r.rank){const e=Kj(n,[1,-1]),t=Kj(r,[r.shape[0],r.shape[1]]),s=Jj(e,t);return Kj(s,[s.size])}if(2===n.rank&&1===r.rank){const e=Kj(r,[-1,1]),t=Jj(n,e);return Kj(t,[t.size])}{const e=Kj(r,[r.shape[0],r.shape[1]]);return Jj(n,e)}}});const PU=FP({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(((e,t)=>OP(e,`tensors${t}`,"einsum"))),a={equation:e};return IP.runKernel(KD,s,a)}});const zU=FP({elu_:function(e){const t={x:OP(e,"x","elu","float32")};return IP.runKernel(XD,t)}});const BU=FP({ensureShape_:function(e,t){const n=OP(e,"x","ensureShape","string_or_numeric");if(!function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}});const jU=FP({erf_:function(e){let t=OP(e,"x","erf");hO("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=Jz(t,"float32"));const n={x:t};return IP.runKernel(QD,n)}});function UU(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function VU(e,t,n){const r=e.length+t.length,s=[];let a=0,i=0;for(let o=0;o<r;o++)-1===n.indexOf(o)?s.push(e[a++]):s.push(t[i++]);return s}function WU(e,t){const n=[],r=e.length;for(let s=0;s<r;s++)-1===t.indexOf(s)&&n.push(e[s]);return[n,t.map((t=>e[t]))]}function GU(e,t){return VU(e,t.map((e=>1)),t)}function HU(e,t,n){hO(UU(t,n),(()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`))}function qU(e,t){if(UU(e,t))return null;const n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((e=>n.push(e))),n}function KU(e){return e.map(((e,t)=>[t,e])).sort(((e,t)=>e[1]-t[1])).map((e=>e[0]))}function XU(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}const YU=FP({max_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:OP(e,"x","max")},s={reductionIndices:t,keepDims:n};return IP.runKernel(AM,r,s)}});const QU=FP({min_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:OP(e,"x","min")},s={axis:t,keepDims:n};return IP.runKernel(LM,r,s)}});const JU=FP({sum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=OP(e,"x","sum");"bool"===r.dtype&&(r=Jz(r,"int32"));const s={x:r},a={axis:t,keepDims:n};return IP.runKernel(AF,s,a)}});function ZU(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return kB(e);if(1!==e.rank&&null===n)return ZU(Kj(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return JU(kB(e),n);if(t===1/0)return YU(kB(e),n);if(t===-1/0)return QU(kB(e),n);if("euclidean"===t||2===t)return aB(JU(bB(kB(e),uB(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&2===n.length){if(1===t)return YU(JU(kB(e),n[0]),n[1]-1);if(t===1/0)return YU(JU(kB(e),n[1]),n[0]);if(t===-1/0)return QU(JU(kB(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return aB(JU(iB(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const eV=FP({norm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=ZU(e=OP(e,"x","norm"),t,n);let a=s.shape;if(r){const t=kO(n,e.shape);a=GU(s.shape,t)}return Kj(s,a)}});const tV=FP({euclideanNorm_:function(e){return eV(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});const nV=FP({exp_:function(e){const t={x:OP(e,"x","exp")};return IP.runKernel(ZD,t)}});const rV=FP({expandDims_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=OP(e,"x","expandDims","string_or_numeric");hO(t<=n.rank,(()=>"Axis must be <= rank of the tensor"));const r={input:n},s={dim:t};return IP.runKernel(eM,r,s)}});const sV=FP({expm1_:function(e){const t={x:OP(e,"x","expm1")};return IP.runKernel(tM,t)}});const aV=FP({tile_:function(e,t){const n=OP(e,"x","tile","string_or_numeric");hO(n.rank===t.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`));const r={x:n},s={reps:t};return IP.runKernel(KF,r,s)}});const iV=FP({eye_:function(e,t,n){null==t&&(t=e);const r=Qz([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),s=e<=t?e:t;for(let i=0;i<s;++i)r.set(1,i,i);const a=Kj(r.toTensor(),[e,t]);if(null==n)return a;if(1===n.length)return aV(rV(a,0),[n[0],1,1]);if(2===n.length)return aV(rV(rV(a,0),0),[n[0],n[1],1,1]);if(3===n.length)return aV(rV(rV(rV(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}});const oV=FP({floor_:function(e){const t={x:OP(e,"x","floor","float32")};return IP.runKernel(aM,t)}});const lV=FP({gather_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s={x:OP(e,"x","gather"),indices:OP(t,"indices","gather","int32")},a={axis:n,batchDims:r};return IP.runKernel(lM,s,a)}});const uV=FP({greater_:function(e,t){let n=OP(e,"a","greater","string_or_numeric"),r=OP(t,"b","greater","string_or_numeric");[n,r]=gP(n,r),CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(cM,s)}});const cV=FP({greaterEqual_:function(e,t){let n=OP(e,"a","greaterEqual","string_or_numeric"),r=OP(t,"b","greaterEqual","string_or_numeric");[n,r]=gP(n,r),CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(dM,s)}});const dV=FP({imag_:function(e){const t={input:OP(e,"input","imag")};return IP.runKernel(fM,t)}});const hV=FP({isFinite_:function(e){const t={x:OP(e,"x","isFinite")};return IP.runKernel(mM,t)}});const pV=FP({isInf_:function(e){const t={x:OP(e,"x","isInf")};return IP.runKernel(gM,t)}});const fV=FP({isNaN_:function(e){const t={x:OP(e,"x","isNaN")};return IP.runKernel(yM,t)}});const mV=FP({leakyRelu_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:OP(e,"x","leakyRelu")},r={alpha:t};return IP.runKernel(vM,n,r)}});const gV=FP({less_:function(e,t){let n=OP(e,"a","less","string_or_numeric"),r=OP(t,"b","less","string_or_numeric");[n,r]=gP(n,r),CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(bM,s)}});const yV=FP({lessEqual_:function(e,t){let n=OP(e,"a","lessEqual","string_or_numeric"),r=OP(t,"b","lessEqual","string_or_numeric");[n,r]=gP(n,r),CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(xM,s)}});function vV(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:e,stop:t,num:n};return IP.runKernel(wM,{},r)}const bV=FP({localResponseNormalization_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const a=OP(e,"x","localResponseNormalization");hO(4===a.rank||3===a.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${a.rank}.`)),hO(yO(t),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`));let i=a,o=!1;3===a.rank&&(o=!0,i=Kj(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const l={x:i},u={depthRadius:t,bias:n,alpha:r,beta:s},c=IP.runKernel(NM,l,u);return o?Kj(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const xV=FP({log_:function(e){const t={x:OP(e,"x","log","float32")};return IP.runKernel(kM,t)}});const wV=FP({log1p_:function(e){const t={x:OP(e,"x","log1p")};return IP.runKernel(SM,t)}});const kV=FP({neg_:function(e){const t={x:OP(e,"x","neg")};return IP.runKernel(VM,t)}});const SV=FP({softplus_:function(e){const t={x:OP(e,"x","softplus")};return IP.runKernel(NF,t)}});const IV=FP({logSigmoid_:function(e){const t=OP(e,"x","logSigmoid");return lB((e=>({value:kV(SV(kV(e))),gradFunc:t=>sB(t,Zj(kV(e)))})))(t)}});const CV=FP({logSoftmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=OP(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return lB(((e,n)=>{const r=YU(e,t,!0),s=xB(e,r),a=xB(Jz(s,"float32"),xV(JU(nV(s),t,!0)));n([a]);return{value:a,gradFunc:(e,n)=>{const[r]=n,s=nV(r);return xB(e,sB(JU(e,t,!0),s))}}}))(n)}});const TV=FP({logSumExp_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=OP(e,"x","logSumExp"),s=kO(t,r.shape),a=YU(r,s,!0),i=xB(r,a),o=nV(i),l=JU(o,s),u=xV(l),c=tB(Kj(a,u.shape),u);if(n){const e=GU(c.shape,s);return Kj(c,e)}return c}});const NV=FP({logicalAnd_:function(e,t){const n=OP(e,"a","logicalAnd","bool"),r=OP(t,"b","logicalAnd","bool");CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(IM,s)}});const EV=FP({logicalNot_:function(e){const t={x:OP(e,"x","logicalNot","bool")};return IP.runKernel(CM,t)}});const AV=FP({logicalOr_:function(e,t){const n=OP(e,"a","logicalOr","bool"),r=OP(t,"b","logicalOr","bool");CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(TM,s)}});const RV=FP({logicalXor_:function(e,t){const n=OP(e,"a","logicalXor","bool"),r=OP(t,"b","logicalXor","bool");return CB(n.shape,r.shape),NV(AV(e,t),EV(NV(e,t)))}}),_V=2147483648;const $V=FP({searchSorted_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left";const r=OP(e,"sortedSequence","searchSorted"),s=OP(t,"values","searchSorted"),a=r.shape[r.shape.length-1],i=s.shape[s.shape.length-1],o=Kj(r,[-1,a]),l=Kj(s,[-1,i]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(mO(l.shape)>=_V)throw new Error("values tensor size must less than 2147483648");if(o.shape[1]>=_V)throw new Error(`trailing dim_size must less than 2147483648 for int32 output type, was ${o.shape[1]}`);const u={sortedSequence:o,values:l},c={side:n};return IP.runKernel(bF,u,c)}});function OV(e,t){return $V(e,t,"left")}const DV=FP({maxPool_:function(e,t,n,r,s){const a=OP(e,"x","maxPool");let i=a,o=!1;3===a.rank&&(o=!0,i=Kj(a,[1,a.shape[0],a.shape[1],a.shape[2]])),hO(4===i.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${i.rank}.`)),hO(Wj(n,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`)),qj("maxPool",r,s);const l={x:i},u={filterSize:t,strides:n,pad:r,dimRoundingMode:s},c=IP.runKernel(_M,l,u);return o?Kj(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const MV=FP({maxPool3d_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const i=OP(e,"x","maxPool3d");let o=i,l=!1;4===i.rank&&(l=!0,o=Kj(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),hO(5===o.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`)),hO("NDHWC"===a,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`)),qj("maxPool3d",r,s);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:s,dataFormat:a},d=IP.runKernel(OM,u,c);return l?Kj(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const FV=FP({maxPoolWithArgmax_:function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a={x:OP(e,"x","maxPoolWithArgmax")},i={filterSize:t,strides:n,pad:r,includeBatchInIndex:s},o=IP.runKernel(MM,a,i);return{result:o[0],indexes:o[1]}}});const LV=FP({mean_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:OP(e,"x","mean")},s={axis:t,keepDims:n};return IP.runKernel(FM,r,s)}});function PV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(zO(e),"complex64"===t){const t=PV(e,"float32"),n=PV(e,"float32");return LP(t,n)}const n=LO(mO(e),t);return IP.makeTensor(n,e,t)}function zV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(zO(e),"complex64"===t){const t=zV(e,"float32"),n=PV(e,"float32");return LP(t,n)}const n=FO(mO(e),t);return IP.makeTensor(n,e,t)}function BV(e,t){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(void 0===e)return[];let r=OP(e,"x","meshgrid",e instanceof JL?e.dtype:"float32");if(void 0===t)return[r];let s=OP(t,"y","meshgrid",t instanceof JL?t.dtype:"float32");const a=mO(r.shape),i=mO(s.shape);return"xy"===n?(r=Kj(r,[1,-1]),s=Kj(s,[-1,1]),[Jj(zV([i,1],r.dtype),r),Jj(s,zV([1,a],s.dtype))]):(r=Kj(r,[-1,1]),s=Kj(s,[1,-1]),[Jj(r,zV([1,i],r.dtype)),Jj(zV([a,1],s.dtype),s)])}const jV=FP({minimum_:function(e,t){let n=OP(e,"a","minimum"),r=OP(t,"b","minimum");[n,r]=gP(n,r),"bool"===n.dtype&&(n=Jz(n,"int32"),r=Jz(r,"int32")),CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(PM,s)}});const UV=FP({mirrorPad_:function(e,t,n){hO("reflect"===n||"symmetric"===n,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`));const r=OP(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");hO(t.length===r.rank,(()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`));const s="reflect"===n?1:0;for(let o=0;o<r.rank;o++)hO(2===t[o].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),hO(t[o][0]>=0&&t[o][0]<=r.shape[o]-s&&t[o][1]>=0&&t[o][1]<=r.shape[o]-s,(()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-s} or less than 0 for input of shape ${r.shape}`));const a={paddings:t,mode:n},i={x:r};return IP.runKernel(zM,i,a)}});const VV=FP({mod_:function(e,t){let n=OP(e,"a","mod"),r=OP(t,"b","mod");[n,r]=gP(n,r);const s={a:n,b:r};return IP.runKernel(BM,s)}});const WV=FP({moments_:function(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=kO(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=OP(e,"x","moments")).shape),r=LV(e,n,t);let s=r.shape;t||(s=GU(r.shape,n));const a=iB(xB(Jz(e,"float32"),Kj(r,s)));return{mean:r,variance:LV(a,n,t)}}});const GV=FP({multiRNNCell_:function(e,t,n,r){const s=OP(t,"data","multiRNNCell"),a=DP(n,"c","multiRNNCell"),i=DP(r,"h","multiRNNCell");let o=s;const l=[];for(let d=0;d<e.length;d++){const t=e[d](o,a[d],i[d]);l.push(t[0]),l.push(t[1]),o=t[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}});const HV=FP({multinomial_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=OP(e,"logits","multinomial"),a=s.size,i=s.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);n=n||Math.random();const o={logits:1===i?Kj(s,[1,-1]):s},l={numSamples:t,seed:n,normalized:r},u=IP.runKernel(jM,o,l);return 1===i?Kj(u,[u.size]):u}});const qV=FP({notEqual_:function(e,t){let n=OP(e,"a","notEqual","string_or_numeric"),r=OP(t,"b","notEqual","string_or_numeric");[n,r]=gP(n,r),CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(WM,s)}});const KV=FP({oneHot_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const a={indices:OP(e,"indices","oneHot","int32")},i={dtype:s,depth:t,onValue:n,offValue:r};return IP.runKernel(XM,a,i)}});const XV=FP({onesLike_:function(e){const t={x:OP(e,"x","onesLike")};return IP.runKernel(KM,t)}});const YV=FP({outerProduct_:function(e,t){const n=OP(e,"v1","outerProduct"),r=OP(t,"v2","outerProduct");hO(1===n.rank&&1===r.rank,(()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`));const s=Kj(n,[-1,1]),a=Kj(r,[1,-1]);return Jj(s,a)}});const QV=FP({pad_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=OP(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:t,constantValue:n},a={x:r};return IP.runKernel(QM,a,s)}});const JV=FP({pad1d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return hO(2===t.length,(()=>"Invalid number of paddings. Must be length of 2.")),QV(e,[t],n)}});const ZV=FP({pad2d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return hO(2===t.length&&2===t[0].length&&2===t[1].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),QV(e,t,n)}});const eW=FP({pad3d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return hO(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),QV(e,t,n)}});const tW=FP({pad4d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return hO(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),QV(e,t,n)}});const nW=FP({spaceToBatchND_:function(e,t,n){const r=OP(e,"x","spaceToBatchND");hO(r.rank>=1+t.length,(()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`)),hO(n.length===t.length,(()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`)),hO(r.shape.reduce(((e,r,s)=>s>0&&s<=t.length?e&&(r+n[s-1][0]+n[s-1][1])%t[s-1]===0:e),!0),(()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`));const s={x:r},a={blockShape:t,paddings:n};return IP.runKernel(RF,s,a)}});const rW=FP({pool_:function(e,t,n,r,s,a,i){null==s&&(s=[1,1]),null==a&&(a=1),0===r&&(r="valid");const o=OP(e,"x","maxPool");let l=o,u=!1;3===o.rank&&(u=!0,l=Kj(o,[1,o.shape[0],o.shape[1],o.shape[2]])),hO(Wj(a,s),(()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${s}'`));const c=Dj(l.shape,t,a,s,r),d=[c.dilationHeight,c.dilationWidth];let h;h="same"===r?function(e,t){const n=e.map(((e,n)=>e+(e-1)*(t[n]-1))),r=n.map((e=>e-1)),s=r.map((e=>Math.floor(e/2))),a=r.map(((e,t)=>e-s[t]));return r.map(((e,t)=>[s[t],a[t]]))}([c.filterHeight,c.filterWidth],d):[[0,0],[0,0]];const p=1===d[0]&&1===d[1],[f,m]=function(e,t,n){const r=n.map((e=>e[0])),s=n.map((e=>e[1])),a=e.concat(r,s),i=t.map(((e,t)=>(e-a[t]%e)%e)),o=s.map(((e,t)=>e+i[t])),l=t.map(((e,t)=>[r[t],o[t]])),u=t.map(((e,t)=>[0,i[t]]));return[l,u]}([c.inHeight,c.inWidth],d,h),g=p?r:"valid",y=p?l:nW(l,d,f),v=("avg"===n?()=>Xj(y,t,a,g,i):()=>DV(y,t,a,g,i))(),b=p?v:rU(v,d,m);return u?Kj(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});const sW=FP({prelu_:function(e,t){const n={x:OP(e,"x","prelu"),alpha:OP(t,"alpha","prelu")};return IP.runKernel(ZM,n)}});const aW=FP({prod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=OP(e,"x","prod");"bool"===r.dtype&&(r=Jz(r,"int32"));const s={x:r},a={axis:t,keepDims:n};return IP.runKernel(eF,s,a)}});const iW=FP({raggedGather_:function(e,t,n,r){const s={paramsNestedSplits:e.map(((e,t)=>OP(e,`tensors${t}`,"raggedGather","int32"))),paramsDenseValues:OP(t,"paramsDenseValues","raggedGather"),indices:OP(n,"indices","raggedGather","int32")},a={outputRaggedRank:r},i=IP.runKernel(tF,s,a);return{outputNestedSplits:i.slice(0,i.length-1),outputDenseValues:i[i.length-1]}}});const oW=FP({raggedRange_:function(e,t,n){const r=OP(e,"starts","raggedRange"),s={starts:r,limits:OP(t,"limits","raggedRange",r.dtype),deltas:OP(n,"deltas","raggedRange",r.dtype)},a=IP.runKernel(nF,s);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}});const lW=FP({raggedTensorToTensor_:function(e,t,n,r,s){const a=OP(e,"shape","raggedTensorToTensor","int32"),i=OP(t,"values","raggedTensorToTensor"),o={shape:a,values:i,defaultValue:OP(n,"defaultValue","raggedTensorToTensor",i.dtype),rowPartitionTensors:r.map(((e,t)=>OP(e,`tensors${t}`,"raggedTensorToTensor","int32")))},l={rowPartitionTypes:s};return IP.runKernel(rF,o,l)}});const uW=FP({rand_:function(e,t,n){zO(e);const r=mO(e);let s=null;if(null==n||"float32"===n)s=new Float32Array(r);else if("int32"===n)s=new Int32Array(r);else{if("bool"!==n)throw new Error(`Unknown data type ${n}`);s=new Uint8Array(r)}for(let a=0;a<r;a++)s[a]=t();return IP.makeTensor(s,e,n)}});var cW=n(4334);class dW{constructor(e,t,n,r,s){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const a=s||Math.random();this.random=cW.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,s,a;do{r=2*this.random()-1,s=2*this.random()-1,a=r*r+s*s}while(a>=1||0===a);const i=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*r*i,t=this.mean+this.stdDev*s*i,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class hW{constructor(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;const s=r||Math.random();this.randu=cW.alea(s.toString()),this.randn=new dW(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,r,s,a;for(;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,e=r*r,t=1-.331*e*e,n=.5*e+this.d*(1-a+Math.log(a)),s=this.randu(),s<t||Math.log(s)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}}class pW{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=cW.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const fW=FP({randomGamma_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",s=arguments.length>4?arguments[4]:void 0;if(zO(e),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error(`Unsupported data type ${r}`);const a=new hW(t,n,r,s),i=Qz(e,r);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}});const mW=FP({randomNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(zO(e),null!=r&&"bool"===r)throw new Error(`Unsupported data type ${r}`);const a=new dW(t,n,r,!1,s),i=Qz(e,r);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}});const gW=FP({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error(`Unsupported data type ${t}`);return mW(e,0,1,t,n)}});const yW=FP({randomUniform_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",s=arguments.length>4?arguments[4]:void 0;zO(e);const a=Qz(e,r),i=new pW(t,n,null,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}});const vW=FP({randomUniformInt_:function(e,t,n,r){return yW(e,t,n,"int32",r)}});function bW(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const s={start:e,stop:t,step:n,dtype:r};return IP.runKernel(sF,{},s)}const xW=FP({real_:function(e){const t={input:OP(e,"input","real")};return IP.runKernel(aF,t)}});const wW=FP({reciprocal_:function(e){const t={x:OP(e,"x","reciprocal")};return IP.runKernel(iF,t)}});const kW=FP({relu_:function(e){const t={x:OP(e,"x","relu")};return IP.runKernel(oF,t)}});const SW=FP({relu6_:function(e){const t={x:OP(e,"x","relu6")};return IP.runKernel(pF,t)}});const IW=FP({reverse_:function(e,t){const n={x:OP(e,"x","reverse")},r={dims:t};return IP.runKernel(fF,n,r)}});const CW=FP({reverse1d_:function(e){const t=OP(e,"x","reverse");return hO(1===t.rank,(()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`)),IW(t,0)}});const TW=FP({reverse2d_:function(e,t){const n=OP(e,"x","reverse");return hO(2===n.rank,(()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`)),IW(n,t)}});const NW=FP({reverse3d_:function(e,t){const n=OP(e,"x","reverse");return hO(3===n.rank,(()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`)),IW(n,t)}});const EW=FP({reverse4d_:function(e,t){const n=OP(e,"x","reverse");return hO(4===n.rank,(()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`)),IW(n,t)}});const AW=FP({round_:function(e){const t={x:OP(e,"x","round")};return IP.runKernel(mF,t)}});const RW=FP({rsqrt_:function(e){const t={x:OP(e,"x","rsqrt","float32")};return IP.runKernel(gF,t)}});const _W=FP({selu_:function(e){const t={x:OP(e,"x","selu")};return IP.runKernel(wF,t)}});const $W=FP({separableConv2d_:function(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const o=OP(e,"x","separableConv2d"),l=OP(t,"depthwiseFilter","separableConv2d"),u=OP(n,"pointwiseFilter","separableConv2d");let c=o,d=!1;if(3===o.rank&&(d=!0,c=Kj(o,[1,o.shape[0],o.shape[1],o.shape[2]])),"NCHW"===i)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");hO(4===c.rank,(()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`)),hO(4===l.rank,(()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`)),hO(4===u.rank,(()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`)),hO(1===u.shape[0],(()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`)),hO(1===u.shape[1],(()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`));const h=l.shape[2],p=l.shape[3];hO(u.shape[2]===h*p,(()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*p}, but got ${u.shape[2]}.`));const f=_U(c,l,r,s,i,a),m=vU(f,u,1,"valid",i);return d?Kj(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const OW=async function(e,t){const n=OP(e,"x","setdiff1d"),r=OP(t,"y","setdiff1d");hO(n.dtype===r.dtype,(()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`)),hO(1===n.rank,(()=>`x should be 1D tensor, but got x (${n.shape}).`)),hO(1===r.rank,(()=>`y should be 1D tensor, but got y (${r.shape}).`));const s=await n.data(),a=await r.data(),i=new Set(a);let o=0;for(let c=0;c<s.length;c++)i.has(s[c])||o++;const l=new KL([o],n.dtype),u=new KL([o],"int32");for(let c=0,d=0;c<s.length;c++)i.has(s[c])||(l.values[d]=s[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]};const DW=FP({sign_:function(e){const t={x:OP(e,"x","sign")};return IP.runKernel(CF,t)}});const MW=FP({sin_:function(e){const t={x:OP(e,"x","sin","float32")};return IP.runKernel(SF,t)}});const FW=FP({sinh_:function(e){const t={x:OP(e,"x","sinh")};return IP.runKernel(IF,t)}});const LW=FP({slice1d_:function(e,t,n){const r=OP(e,"x","slice1d");return hO(1===r.rank,(()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`)),eU(r,[t],[n])}});const PW=FP({slice2d_:function(e,t,n){const r=OP(e,"x","slice2d");return hO(2===r.rank,(()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`)),eU(r,t,n)}});const zW=FP({slice3d_:function(e,t,n){const r=OP(e,"x","slice3d");return hO(3===r.rank,(()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`)),eU(r,t,n)}});const BW=FP({slice4d_:function(e,t,n){const r=OP(e,"x","slice4d");return hO(4===r.rank,(()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`)),eU(r,t,n)}});const jW=FP({softmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=OP(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const r={logits:n},s={dim:t};return IP.runKernel($F,r,s)}});const UW=FP({fft_:function(e){hO("complex64"===e.dtype,(()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`));const t={input:e};return IP.runKernel(nM,t)}});const VW=FP({ifft_:function(e){hO("complex64"===e.dtype,(()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`));const t={input:e};return IP.runKernel(pM,t)}});const WW=FP({irfft_:function(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const s=Kj(e,[n,t]);r=VW(s)}else{const s=[n,2*(t-1)],a=Kj(xW(e),[n,t]),i=Kj(dV(e),[n,t]),o=IW(eU(a,[0,1],[n,t-2]),1),l=sB(IW(eU(i,[0,1],[n,t-2]),1),uB(-1)),u=Qj([a,o],1),c=Qj([i,l],1),d=Kj(LP(u,c),[s[0],s[1]]);r=VW(d)}if(r=xW(r),3===e.rank&&0!==e.shape[0]){const t=r,n=e.shape[0];r=Kj(r,[n,r.shape[0]/n,r.shape[1]]),t.dispose()}return r}});const GW=FP({split_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={x:OP(e,"x","split")},s={numOrSizeSplits:t,axis:n};return IP.runKernel(_F,r,s)}});const HW=FP({rfft_:function(e,t){hO("float32"===e.dtype,(()=>`The dtype for rfft() must be real value but got ${e.dtype}`));let n=e.shape[e.shape.length-1];const r=e.size/n;let s;if(null!=t&&t<n){const r=e.shape.map((e=>0)),a=e.shape.map((e=>e));a[e.shape.length-1]=t,s=eU(e,r,a),n=t}else if(null!=t&&t>n){const r=e.shape.map((e=>e));r[e.shape.length-1]=t-n,s=Qj([e,PV(r)],e.shape.length-1),n=t}else s=e;const a=oB(s),i=Kj(LP(s,a),[r,n]),o=UW(i),l=Math.floor(n/2)+1,u=xW(o),c=dV(o),d=GW(u,[l,n-l],u.shape.length-1),h=GW(c,[l,n-l],c.shape.length-1),p=s.shape.slice();return p[s.shape.length-1]=l,Kj(LP(d[0],h[0]),p)}});const qW=FP({squaredDifference_:function(e,t){let n=OP(e,"a","squaredDifference"),r=OP(t,"b","squaredDifference");[n,r]=gP(n,r),CB(n.shape,r.shape);const s={a:n,b:r};return IP.runKernel(PF,s,{})}});const KW=FP({squeeze_:function(e,t){const n=OP(e,"x","squeeze","string_or_numeric");return Kj(n,SO(n.shape,t).newShape)}});const XW=FP({stack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=DP(e,"tensors","stack","string_or_numeric");hO(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&hO(t<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const r=n,s={axis:t};return IP.runKernel(YM,r,s)}});const YW=FP({step_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:OP(e,"x","step")},r={alpha:t};return IP.runKernel(nL,n,r)}});const QW=FP({stridedSlice_:function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const u={x:OP(e,"x","stridedSlice","string_or_numeric")},c={begin:t,end:n,strides:r,beginMask:s,endMask:a,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};return IP.runKernel(jF,u,c)}});const JW=FP({tan_:function(e){const t={x:OP(e,"x","tan","float32")};return IP.runKernel(HF,t)}});function ZW(e,t){fO(e);const n=RP(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return PP(e,null,n,t)}function eG(e,t,n){if(fO(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=RP(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return PP(e,t,r,n)}function tG(e,t,n){if(fO(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");const r=RP(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return PP(e,t,r,n)}function nG(e,t,n){if(fO(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");const r=RP(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return PP(e,t,r,n)}function rG(e,t,n){if(fO(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");const r=RP(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return PP(e,t=t||r,r,n)}function sG(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,s=t.rank>1?t.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(a+` update.rank < ${s}. `);if(e.length<r+(n.rank-s))throw new Error(a+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+e.length-r)throw new Error(a+" update.rank != "+(s+e.length-r));for(let i=0;i<s;++i)if(n.shape[i]!==t.shape[i])throw new Error(a+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${t.shape[i]}).`);for(let i=0;i<n.rank-s;++i)if(n.shape[i+s]!==e[i+r])throw new Error(a+` updates.shape[${i+s}] (${n.shape[i+s]}) != shape[${i+s}] (${e[i+s]})`)}function aG(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if("int32"!==t.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===t.size)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===e.size)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}sG(n,t,e)}function iG(e,t,n){const r=t.shape.length,s=r>1?t.shape[r-1]:1,a=n.length;let i=1;for(let l=s;l<a;++l)i*=n[l];const o=s<1?1:s;return{sliceRank:s,numUpdates:mO(t.shape)/o,sliceSize:i,strides:[...OO(n.slice(0,s)),1],outputSize:mO(n)}}const oG=FP({tensorScatterUpdate_:function(e,t,n){const r=OP(e,"tensor","tensorScatterupdate"),s=OP(t,"indices","tensorScatterupdate","int32"),a=OP(n,"updates","tensorScatterupdate");if(aG(a,s,r.shape),r.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${a.dtype}.`);const i={tensor:r,indices:s,updates:a};return IP.runKernel(vF,i,{})}});const lG=FP({topk_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=OP(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${t}`);const a={x:r},i={k:t,sorted:n},[o,l]=IP.runKernel(XF,a,i);return{values:o,indices:l}}});const uG=FP({truncatedNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(zO(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const a=new dW(t,n,r,!0,s),i=Qz(e,r);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}});const cG=FP({unique_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=OP(e,"x","unique","string_or_numeric");hO(n.rank>0,(()=>"The input tensor must be at least 1D"));const r={x:n},s={axis:t},[a,i]=IP.runKernel(JF,r,s);return{values:a,indices:i}}});const dG=FP({unsortedSegmentSum_:function(e,t,n){const r=OP(e,"x","unsortedSegmentSum"),s=OP(t,"segmentIds","unsortedSegmentSum","int32");hO(yO(n),(()=>"numSegments must be of dtype int"));const a={x:r,segmentIds:s},i={numSegments:n};return IP.runKernel(eL,a,i)}});const hG=FP({unstack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=OP(e,"x","unstack","string_or_numeric");hO(t>=-n.shape.length&&t<n.shape.length,(()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`));const r={value:n},s={axis:t};return IP.runKernel(ZF,r,s)}});function pG(e,t){return $V(e,t,"right")}function fG(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return IP.makeVariable(e,t,n,r)}function mG(e,t){const n=[];for(let a=0;a<t.length;a++)t[a]&&n.push(a);const r=Qz(e,"int32"),s=Qz([n.length,e.length],"int32");for(let a=0;a<n.length;a++){const t=r.indexToLoc(n[a]),i=a*e.length;s.values.set(t,i)}return s.toTensor()}const gG=async function(e){const t=OP(e,"condition","whereAsync","bool"),n=await t.data(),r=mG(t.shape,n);return e!==t&&t.dispose(),r};const yG=async function(e,t,n){const r=OP(e,"tensor","boolMask"),s=OP(t,"mask","boolMask","bool"),a=null==n?0:n,i=s.rank,o=r.shape;hO(i>0,(()=>"mask cannot be scalar")),pO(o.slice(a,a+i),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=a;m<a+i;m++)l*=o[m];const u=o.slice(0,a).concat([l],o.slice(a+i)),c=Kj(r,u),d=Kj(s,[-1]),h=await gG(d),p=KW(h,[1]),f=lV(c,p,a);return e!==r&&r.dispose(),t!==s&&s.dispose(),p.dispose(),c.dispose(),d.dispose(),h.dispose(),f};const vG=FP({transpose_:function(e,t,n){const r=OP(e,"x","transpose");if(null==t&&(t=r.shape.map(((e,t)=>t)).reverse()),hO(r.rank===t.length,(()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`)),t.forEach((e=>{hO(e>=0&&e<r.rank,(()=>"All entries in 'perm' must be between 0 and "+(r.rank-1)+` but got ${t}`))})),r.rank<=1)return r.clone();const s={x:r},a={perm:t};return"complex64"===r.dtype?WP((()=>{let e=xW(r),t=dV(r);return e=IP.runKernel(QF,{x:e},a),t=IP.runKernel(QF,{x:t},a),n&&(t=kV(t)),LP(e,t)})):IP.runKernel(QF,s,a)}});const bG=FP({movingAverage_:function(e,t,n,r){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const a=OP(e,"v","movingAverage"),i=OP(t,"x","movingAverage"),o=OP(n,"decay","movingAverage");!function(e,t){hO(e.dtype===t.dtype,(()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`))}(a,i),hO(gO(a.shape,i.shape),(()=>"Shape mismatch in v and x"));const l=uB(1),u=xB(l,o);let c=sB(xB(i,a),u);if(s){hO(null!=r,(()=>"When using zeroDebias: true, step is required."));const e=OP(r,"step","movingAverage");c=rB(c,xB(l,bB(o,e)))}return tB(a,c)}});const xG=FP({scatterND_:function(e,t,n){zO(n);const r=OP(e,"indices","scatterND","int32"),s=OP(t,"updates","scatterND");aG(s,r,n);const a={indices:r,updates:s},i={shape:n};return IP.runKernel(yF,a,i)}});const wG=FP({sparseToDense_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;zO(n);const s=OP(e,"sparseIndices","sparseToDense","int32"),a=OP(t,"sparseValues","sparseToDense","string_or_numeric"),i=OP(r,"defaultValue","sparseToDense",a.dtype);!function(e,t,n,r){if("int32"!==e.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const s=e.rank>0?e.shape[0]:1,a=e.rank>1?e.shape[1]:1;if(n.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${a}.`);const i=t.size;if(0!==t.rank&&(1!==t.rank||i!==s))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${s}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(s,a,n,i);const o={sparseIndices:s,sparseValues:a,defaultValue:i},l={outputShape:n};return IP.runKernel(LF,o,l)}});const kG=FP({gatherND_:function(e,t){const n=OP(t,"indices","gatherND","int32"),r={params:OP(e,"x","gatherND","string_or_numeric"),indices:n};return IP.runKernel(uM,r)}});const SG=FP({dropout_:function(e,t,n,r){const s=OP(e,"x","dropout");if(hO("float32"===s.dtype,(()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`)),hO(t>=0&&t<1,(()=>`rate must be a float in the range [0, 1), but got ${t}.`)),0===t)return e instanceof JL?s.clone():s;const a=function(e,t){if(null==t)return e.shape.slice();if(gO(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(s,n),i=1-t,o=rB(oV(tB(yW(a,0,1,"float32",r),i)),i);return sB(s,o)}});function IG(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function CG(e,t,n){const r=1-e%2,s=new Float32Array(e);for(let a=0;a<e;++a){const i=2*Math.PI*a/(e+r-1);s[a]=t-n*Math.cos(i)}return ZW(s,"float32")}const TG=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=OP(e,"predictions","inTopK"),s=OP(t,"targets","inTopK");hO(r.rank>1,(()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`)),hO(r.rank-1===s.rank,(()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`)),pO(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=r.shape[r.shape.length-1];hO(n>0&&n<=a,(()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${n}`));const i=await r.data(),o=await s.data(),[l,u]=[i.length/a,a],c=IO("bool",l);for(let d=0;d<l;d++){const e=d*u,t=i.subarray(e,e+u),r=[];for(let n=0;n<t.length;n++)r.push({value:t[n],index:n});r.sort(((e,t)=>t.value-e.value)),c[d]=0;for(let s=0;s<n;s++)if(r[s].index===o[d]){c[d]=1;break}}return e!==r&&r.dispose(),t!==s&&s.dispose(),zP(c,s.shape,"bool")};const NG=FP({conv2DBackpropFilter_:function(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0,o=e;3===e.rank&&(o=Kj(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=Kj(t,[1,t.shape[0],t.shape[1],t.shape[2]])),hO(4===o.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`)),hO(4===l.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`)),hO(4===n.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`));const u="NHWC"===a?o.shape[3]:o.shape[1],c="NHWC"===a?l.shape[3]:l.shape[1];hO(u===n[2],(()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`)),hO(c===n[3],(()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`)),qj("conv2dDerFilter",s,i);const d={x:o,dy:l},h={strides:r,pad:s,dataFormat:a,dimRoundingMode:i,filterShape:n};return IP.runKernel(ND,d,h)}});function EG(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return sB(e,YW(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function AG(e,t){let n=t;const r=IB(e.shape,t.shape);return r.length>0&&(n=JU(n,r)),Kj(n,e.shape)}function RG(e,t,n,r){if("linear"===t)return e;if("relu"===t)return kW(e);if("elu"===t)return zU(e);if("relu6"===t)return SW(e);if("prelu"===t)return sW(e,n);if("leakyrelu"===t)return mV(e,r);if("sigmoid"===t)return Zj(e);throw new Error(`Unknown fused activation ${t}.`)}const _G=(e,t)=>!(e>0)||"linear"===t;const $G=FP({fusedConv2d_:function(e){let{x:t,filter:n,strides:r,pad:s,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:l,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:d}=e;if(u=u||"linear",!1===_G(IP.state.gradientDepth,u)){hO("NHWC"===a,(()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`));let e=vU(t,n,r,s,a,i,o);return null!=l&&(e=tB(e,l)),RG(e,u,c,d)}const h=OP(t,"x","conv2d","float32"),p=OP(n,"filter","conv2d","float32");let f=h,m=!1;3===h.rank&&(m=!0,f=Kj(h,[1,h.shape[0],h.shape[1],h.shape[2]])),hO(4===f.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`)),hO(4===p.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`)),qj("fused conv2d",s,o);const g="NHWC"===a?f.shape[3]:f.shape[1];hO(p.shape[2]===g,(()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${p.shape[2]}.`)),hO(Wj(r,i),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${r} and dilations '${i}'`));const y=Fj(f.shape,p.shape,r,i,s,o);let v,b;if(null!=l&&(v=OP(l,"bias","fused conv2d"),[v]=gP(v,h),"NHWC"===a?CB(y.outShape,v.shape):(hO(v.shape.length<=1,(()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${v.shape.length}.`)),hO(0===v.shape.length||v.shape[0]===y.outChannels||1===v.shape[0],(()=>`Error in fused conv2d: bias shape (${v.shape}) is not compatible with the number of output channels (${y.outChannels})`)))),null!=c){const e=c.shape;if(hO(e.length<=1||3===e.length,(()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${e.length}.`)),1===e.length)hO(1===e[0]||e[0]===y.outChannels,(()=>`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the number of output channels (${y.outChannels}).`));else if(3===e.length)try{CB(e,y.outShape)}catch(Ipe){const n=`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(n)}b=OP(c,"prelu weights","fused conv2d")}const x=(e,t)=>{hO("NHWC"===a,(()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`));const[n,o,l,c]=t,d=EG(e,l,u);hO(Vj(i),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`));const h=[xU(o.shape,d,n,r,s),NG(o,d,n.shape,r,s)];if(null!=c){const e=AG(c,d);h.push(e)}return h},w={x:f,filter:p,bias:v,preluActivationWeights:b},k={strides:r,pad:s,dataFormat:a,dilations:i,dimRoundingMode:o,activation:u,leakyreluAlpha:d};if(null==l){const e=lB(((e,t,n)=>{let r=IP.runKernel(iL,w,k);return n([t,e,r]),m&&(r=Kj(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}}));return e(f,p)}{const e=lB(((e,t,n,r)=>{let s=IP.runKernel(iL,w,k);return r([t,e,s,n]),m&&(s=Kj(s,[s.shape[1],s.shape[2],s.shape[3]])),{value:s,gradFunc:x}}));return e(f,p,v)}}});const OG=FP({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,o=e;3===e.rank&&(o=Kj(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=Kj(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={x:o,dy:l},c={strides:r,pad:s,dimRoundingMode:i,dilations:a,filterShape:n};return IP.runKernel(BD,u,c)}});const DG=FP({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,o=t,l=!1;3===t.rank&&(l=!0,o=Kj(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={dy:o,filter:n},c={strides:r,pad:s,dimRoundingMode:i,dilations:a,inputShape:e},d=IP.runKernel(jD,u,c);return l?Kj(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});const MG=FP({fusedDepthwiseConv2d_:function(e){let{x:t,filter:n,strides:r,pad:s,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:l,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:d}=e;if(!1===_G(IP.state.gradientDepth,u)){let e=_U(t,n,r,s,a,i,o);return null!=l&&(e=tB(e,l)),RG(e,u,c,d)}const h=OP(t,"x","depthwiseConv2d","float32"),p=OP(n,"filter","depthwiseConv2d","float32");let f=h,m=!1;3===h.rank&&(m=!0,f=Kj(h,[1,h.shape[0],h.shape[1],h.shape[2]])),hO(4===f.rank,(()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`)),hO(4===p.rank,(()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`)),hO(f.shape[3]===p.shape[2],(()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`)),null==i&&(i=[1,1]),hO(Wj(r,i),(()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${r} and dilations '${i}'`)),qj("fused depthwiseConv2d",s,o);const g=Fj(f.shape,p.shape,r,i,s,o,!0);let y,v;null!=l&&(y=OP(l,"bias","fused conv2d"),[y]=gP(y,h),CB(g.outShape,y.shape)),null!=c&&(v=OP(c,"prelu weights","fused depthwiseConv2d"));const b=(e,t)=>{hO(Vj(i),(()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`));const[n,a,l,c]=t,d=EG(e,l,u),h=DG(a.shape,d,n,r,s,i,o),p=OG(a,d,n.shape,r,s,i,o);if(null!=c){return[h,p,AG(y,d)]}return[h,p]},x={x:f,filter:p,bias:y,preluActivationWeights:v},w={strides:r,pad:s,dataFormat:a,dilations:i,dimRoundingMode:o,activation:u,leakyreluAlpha:d};if(null==l){const e=lB(((e,t,n)=>{let r=IP.runKernel(oL,x,w);return n([t,e,r]),m&&(r=Kj(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}}));return e(f,p)}{const e=lB(((e,t,n,r)=>{let s=IP.runKernel(oL,x,w);return r([t,e,s,n]),m&&(s=Kj(s,[s.shape[1],s.shape[2],s.shape[3]])),{value:s,gradFunc:b}}));return e(f,p,y)}}});const FG=FP({fusedMatMul_:function(e){let{a:t,b:n,transposeA:r=!1,transposeB:s=!1,bias:a,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:l=.2}=e;if(!1===_G(IP.state.gradientDepth,i)){let e=Jj(t,n,r,s);return null!=a&&(e=tB(e,a)),RG(e,i,o,l)}let u=OP(t,"a","fused matMul"),c=OP(n,"b","fused matMul");[u,c]=gP(u,c);const d=r?u.shape[u.rank-2]:u.shape[u.rank-1],h=s?c.shape[c.rank-1]:c.shape[c.rank-2],p=r?u.shape[u.rank-1]:u.shape[u.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],m=u.shape.slice(0,-2),g=c.shape.slice(0,-2),y=mO(m),v=mO(g);hO(d===h,(()=>`Error in fused matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${u.shape} and ${c.shape} and transposeA=${r} and transposeB=${s} must match.`));const b=CB(u.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,f]),x=Kj(u,r?[y,d,p]:[y,p,d]),w=Kj(c,s?[v,f,h]:[v,h,f]);let k,S;null!=a&&(k=OP(a,"bias","fused matMul"),[k]=gP(k,u),CB(b,k.shape)),null!=o&&(S=OP(o,"prelu weights","fused matMul"));const I=(e,t)=>{const[n,o,l,u]=t,c=EG(Kj(e,l.shape),l,i);let d,h;if(r||s?!r&&s?(d=Jj(c,o,!1,!1),h=Jj(c,n,!0,!1)):r&&!s?(d=Jj(o,c,!1,!0),h=Jj(n,c,!1,!1)):(d=Jj(o,c,!0,!0),h=Jj(c,n,!0,!0)):(d=Jj(c,o,!1,!0),h=Jj(n,c,!0,!1)),null!=a){return[d,h,AG(u,c)]}return[d,h]},C={a:x,b:w,bias:k,preluActivationWeights:S},T={transposeA:r,transposeB:s,activation:i,leakyreluAlpha:l};if(null==a){const e=lB(((e,t,n)=>{const r=IP.runKernel(aL,C,T);return n([e,t,r]),{value:Kj(r,b),gradFunc:I}}));return e(x,w)}{const e=lB(((e,t,n,r)=>{const s=IP.runKernel(aL,C,T);return r([e,t,s,n]),{value:Kj(s,b),gradFunc:I}}));return e(x,w,k)}}});const LG=FP({hammingWindow_:function(e){return CG(e,.54,.46)}});const PG=FP({hannWindow_:function(e){return CG(e,.5,.5)}});const zG=FP({frame_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=0;const i=[];for(;a+t<=e.size;)i.push(eU(e,a,t)),a+=n;if(r)for(;a<e.size;){const r=a+t-e.size,o=Qj([eU(e,a,t-r),yB([r],s)]);i.push(o),a+=n}return 0===i.length?eG([],[0,t]):Kj(Qj(i),[i.length,t])}});const BG=FP({stft_:function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:PG;null==r&&(r=IG(t));const a=zG(e,t,n),i=sB(a,s(t));return HW(i,r)}});const jG=FP({cropAndResize_:function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=OP(e,"image","cropAndResize"),o=OP(t,"boxes","cropAndResize","float32"),l=OP(n,"boxInd","cropAndResize","int32"),u=o.shape[0];hO(4===i.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`)),hO(2===o.rank&&4===o.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`)),hO(1===l.rank&&l.shape[0]===u,(()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`)),hO(2===r.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`)),hO(r[0]>=1&&r[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${r}`)),hO("bilinear"===s||"nearest"===s,(()=>`method must be bilinear or nearest, but was ${s}`));const c={image:i,boxes:o,boxInd:l},d={method:s,extrapolationValue:a,cropSize:r};return IP.runKernel(FD,c,d)}});const UG=FP({flipLeftRight_:function(e){const t=OP(e,"image","flipLeftRight","float32");hO(4===t.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`));const n={image:t};return IP.runKernel(sM,n,{})}});const VG=FP({grayscaleToRGB_:function(e){const t=OP(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];hO(t.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`)),hO(1===r,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`));const s=new Array(t.rank);return s.fill(1,0,n),s[n]=3,aV(t,s)}});const WG=FP({rgbToGrayscale_:function(e){const t=OP(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];hO(t.rank>=2,(()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`)),hO(3===r,(()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`));const s=t.dtype,a=Jz(t,"float32"),i=ZW([.2989,.587,.114]);let o;switch(t.rank){case 2:o=PU("ij,j->i",a,i);break;case 3:o=PU("ijk,k->ij",a,i);break;case 4:o=PU("ijkl,l->ijk",a,i);break;case 5:o=PU("ijklm,m->ijkl",a,i);break;case 6:o=PU("ijklmn,n->ijklm",a,i);break;default:throw new Error("Not a valid tensor rank.")}return o=rV(o,-1),Jz(o,s)}});const GG=FP({rotateWithOffset_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const s=OP(e,"image","rotateWithOffset","float32");hO(4===s.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`));const a={image:s},i={radians:t,fillValue:n,center:r};return IP.runKernel(sL,a,i)}});function HG(e,t,n,r,s,a){null==r&&(r=.5),null==s&&(s=Number.NEGATIVE_INFINITY),null==a&&(a=0);const i=e.shape[0];return n=Math.min(n,i),hO(0<=r&&r<=1,(()=>`iouThreshold must be in [0, 1], but was '${r}'`)),hO(2===e.rank,(()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`)),hO(4===e.shape[1],(()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`)),hO(1===t.rank,(()=>"scores must be a 1D tensor")),hO(t.shape[0]===i,(()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${t.shape[0]}`)),hO(0<=a&&a<=1,(()=>`softNmsSigma must be in [0, 1], but was '${a}'`)),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:a}}const qG=FP({nonMaxSuppression_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const a=OP(e,"boxes","nonMaxSuppression","float32"),i=OP(t,"scores","nonMaxSuppression","float32"),o=HG(a,i,n,r,s);n=o.maxOutputSize,r=o.iouThreshold,s=o.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return IP.runKernel(GM,{boxes:a,scores:i},l)}});function KG(e,t,n){const r=function(e,t,n){return function(e,t,n){let r=0,s=e.length,a=0,i=!1;for(;r<s;){a=r+(s-r>>>1);const o=n(t,e[a]);o>0?r=a+1:(s=a,i=!o)}return i?r:-r-1}(e,t,n||XG)}(e,t,n),s=r<0?-(r+1):r;e.splice(s,0,t)}function XG(e,t){return e>t?1:e<t?-1:0}function YG(e,t,n,r,s){return ZG(e,t,n,r,s,0)}function QG(e,t,n,r,s,a){return ZG(e,t,n,r,s,0,!1,a,!0)}function JG(e,t,n,r,s,a){return ZG(e,t,n,r,s,a,!0)}function ZG(e,t,n,r,s,a){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const u=[];for(let g=0;g<t.length;g++)t[g]>s&&u.push({score:t[g],boxIndex:g,suppressBeginIndex:0});u.sort(nH);const c=a>0?-.5/a:0,d=[],h=[];for(;d.length<n&&u.length>0;){const t=u.pop(),{score:n,boxIndex:a,suppressBeginIndex:i}=t;if(n<s)break;let o=!1;for(let l=d.length-1;l>=i;--l){const n=eH(e,a,d[l]);if(n>=r){o=!0;break}if(t.score=t.score*tH(r,c,n),t.score<=s)break}t.suppressBeginIndex=d.length,o||(t.score===n?(d.push(a),h.push(t.score)):t.score>s&&KG(u,t,nH))}const p=d.length,f=n-p;o&&f>0&&(d.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=h),l&&(m.validOutputs=p),m}function eH(e,t,n){const r=e.subarray(4*t,4*t+4),s=e.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),h=Math.max(s[1],s[3]),p=(o-a)*(l-i),f=(d-u)*(h-c);if(p<=0||f<=0)return 0;const m=Math.max(a,u),g=Math.max(i,c),y=Math.min(o,d),v=Math.min(l,h),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(p+f-b)}function tH(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function nH(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}const rH=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const a=OP(e,"boxes","nonMaxSuppressionAsync"),i=OP(t,"scores","nonMaxSuppressionAsync"),o=HG(a,i,n,r,s);n=o.maxOutputSize,r=o.iouThreshold,s=o.scoreThreshold;const l=await Promise.all([a.data(),i.data()]),u=l[0],c=l[1],{selectedIndices:d}=YG(u,c,n,r,s);return a!==e&&a.dispose(),i!==t&&i.dispose(),ZW(d,"int32")};const sH=FP({nonMaxSuppressionWithScore_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=OP(e,"boxes","nonMaxSuppression"),o=OP(t,"scores","nonMaxSuppression"),l=HG(i,o,n,r,s,a);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,a=l.softNmsSigma;const u={boxes:i,scores:o},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:a},d=IP.runKernel(qM,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}});const aH=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=OP(e,"boxes","nonMaxSuppressionAsync"),o=OP(t,"scores","nonMaxSuppressionAsync"),l=HG(i,o,n,r,s,a);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,a=l.softNmsSigma;const u=await Promise.all([i.data(),o.data()]),c=u[0],d=u[1],{selectedIndices:h,selectedScores:p}=JG(c,d,n,r,s,a);return i!==e&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:ZW(h,"int32"),selectedScores:ZW(p)}};const iH=FP({nonMaxSuppressionPadded_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=OP(e,"boxes","nonMaxSuppression"),o=OP(t,"scores","nonMaxSuppression"),l=HG(i,o,n,r,s,null),u={boxes:i,scores:o},c={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:a},d=IP.runKernel(HM,u,c);return{selectedIndices:d[0],validOutputs:d[1]}}});const oH=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=OP(e,"boxes","nonMaxSuppressionAsync"),o=OP(t,"scores","nonMaxSuppressionAsync"),l=HG(i,o,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[h,p]=await Promise.all([i.data(),o.data()]),{selectedIndices:f,validOutputs:m}=QG(h,p,u,c,d,a);return i!==e&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:ZW(f,"int32"),validOutputs:uB(m,"int32")}};const lH=FP({resizeBilinear_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=OP(e,"images","resizeBilinear");hO(3===s.rank||4===s.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`)),hO(2===t.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`)),hO(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let a=s,i=!1;3===s.rank&&(i=!0,a=Kj(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const[]=t,o={images:a},l={alignCorners:n,halfPixelCenters:r,size:t},u=IP.runKernel(dF,o,l);return i?Kj(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const uH=FP({resizeNearestNeighbor_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=OP(e,"images","resizeNearestNeighbor");hO(3===s.rank||4===s.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`)),hO(2===t.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`)),hO("float32"===s.dtype||"int32"===s.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),hO(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let a=s,i=!1;3===s.rank&&(i=!0,a=Kj(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const[]=t,o={images:a},l={alignCorners:n,halfPixelCenters:r,size:t},u=IP.runKernel(uF,o,l);return i?Kj(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const cH=FP({threshold_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const s=OP(e,"image","threshold"),a=s.shape[0]*s.shape[1];let i,o,l,u,c=sB(ZW([r]),255);if(hO(3===s.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`)),hO(3===s.shape[2]||1===s.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`)),hO("int32"===s.dtype||"float32"===s.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`)),hO("otsu"===t||"binary"===t,(()=>`Method must be binary or otsu, but was ${t}`)),3===s.shape[2]){[i,o,l]=GW(s,[1,1,1],-1);const e=sB(i,.2989),t=sB(o,.587),n=sB(l,.114);u=tB(tB(e,t),n)}else u=e;if("otsu"===t){c=function(e,t){let n,r,s,a,i,o,l=ZW([-1]),u=ZW([0]),c=ZW([0]);for(let d=0;d<e.size-1;d++){n=eU(e,0,d+1),r=eU(e,d+1),i=rB(JU(n),t),o=rB(JU(r),t);const h=JU(sB(n,bW(0,n.size)));s=rB(h,JU(n));const p=yB(r.shape,n.size),f=tB(bW(0,r.size),p),m=sB(r,f);a=rB(JU(m),JU(r));const g=xB(s,a),y=xB(s,a),v=sB(i,o);c=sB(sB(v,g),y);const b=uV(c,u);u=MU(b,c,u),l=MU(b,ZW([d]),l)}return l}(lU(Jz(AW(u),"int32"),zP([]),256),a)}const d=n?yV(u,c):uV(u,c);return Jz(sB(d,255),"int32")}});const dH=FP({transform_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0;const i=OP(e,"image","transform","float32"),o=OP(t,"transforms","transform","float32");hO(4===i.rank,(()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`)),hO(2===o.rank&&(o.shape[0]===i.shape[0]||1===o.shape[0])&&8===o.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),hO(null==a||2===a.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`));const l={image:i,transforms:o},u={interpolation:n,fillMode:r,fillValue:s,outputShape:a};return IP.runKernel(YF,l,u)}});const hH=FP({bandPart_:function(e,t,n){const r=OP(e,"a","bandPart");hO(r.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`));const s=r.shape,[a,i]=r.shape.slice(-2);let o,l;"number"===typeof t?(hO(t%1===0,(()=>`bandPart(): numLower must be an integer, got ${t}.`)),hO(t<=a,(()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${a}).`)),o=OP(t<0?a:t,"numLower","bandPart")):(hO("int32"===t.dtype,(()=>"bandPart(): numLower's dtype must be an int32.")),o=MU(gV(t,0),a,jV(t,a))),"number"===typeof n?(hO(n%1===0,(()=>`bandPart(): numUpper must be an integer, got ${n}.`)),hO(n<=i,(()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`)),l=OP(n<0?i:n,"numUpper","bandPart")):(hO("int32"===n.dtype,(()=>"bandPart(): numUpper's dtype must be an int32.")),l=MU(gV(n,0),i,jV(n,i)));const u=Kj(bW(0,a,1,"int32"),[-1,1]),c=bW(0,i,1,"int32"),d=xB(u,c),h=NV(yV(d,o),cV(d,kV(l))),p=PV([a,i],r.dtype);return Kj(XW(hG(Kj(r,[-1,a,i])).map((e=>MU(h,e,p)))),s)}});const pH=FP({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,hO(null!=e&&e.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=e[0].shape[0];for(let t=1;t<e.length;++t)hO(e[t].shape[0]===n,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[t].shape[0]} vs. ${n})`))}else t=!0,e=GW(e,e.shape[0],0).map((e=>KW(e,[0])));hO(e.length<=e[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`));const n=[],r=e;for(let s=0;s<e.length;++s)n.push(IP.tidy((()=>{let e=r[s];if(s>0)for(let t=0;t<s;++t){const r=sB(JU(sB(n[t],e)),n[t]);e=xB(e,r)}return rB(e,eV(e,"euclidean"))})));return t?XW(n,0):n}});function fH(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return IP.tidy((()=>{hO(2===e.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`));const n=e.shape[0],r=e.shape[1];let s=iV(n),a=Zz(e);const i=eG([[1]],[1,1]);let o=Zz(i);const l=n>=r?r:n;for(let e=0;e<l;++e){const t=a,l=o,u=s;[o,a,s]=IP.tidy((()=>{const t=eU(a,[e,e],[n-e,1]),l=eV(t),u=eU(a,[e,e],[1,1]),c=MU(uV(u,0),eG([[-1]]),eG([[1]])),d=xB(u,sB(c,l)),h=rB(t,d);o=1===h.shape[0]?Zz(i):Qj([i,eU(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);const p=kV(rB(Jj(c,d),l)),f=eU(a,[e,0],[n-e,r]),m=sB(p,o),g=vG(o);if(0===e)a=xB(f,Jj(m,Jj(g,f)));else{const t=xB(f,Jj(m,Jj(g,f)));a=Qj([eU(a,[0,0],[e,r]),t],0)}const y=vG(m),v=eU(s,[0,e],[n,s.shape[1]-e]);if(0===e)s=xB(v,Jj(Jj(v,o),y));else{const t=xB(v,Jj(Jj(v,o),y));s=Qj([eU(s,[0,0],[n,e]),t],1)}return[o,a,s]})),GP([t,l,u])}return!t&&n>r&&(s=eU(s,[0,0],[n,r]),a=eU(a,[0,0],[r,r])),[s,a]}))}const mH=FP({qr_:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(hO(e.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`)),2===e.rank)return fH(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce(((e,t)=>e*t)),r=hG(Kj(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),s=[],a=[];r.forEach((e=>{const[n,r]=fH(e,t);s.push(n),a.push(r)}));return[Kj(XW(s,0),e.shape),Kj(XW(a,0),e.shape)]}}});var gH,yH;(yH=gH||(gH={}))[yH.NONE=0]="NONE",yH[yH.MEAN=1]="MEAN",yH[yH.SUM=2]="SUM",yH[yH.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS";const vH=FP({computeWeightedLoss_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gH.SUM_BY_NONZERO_WEIGHTS;const r=OP(e,"losses","computeWeightedLoss");let s=null;null!=t&&(s=OP(t,"weights","computeWeightedLoss"));const a=null==s?r:sB(r,s);if(n===gH.NONE)return a;if(n===gH.SUM)return JU(a);if(n===gH.MEAN){if(null==s)return LV(a);{const e=r.size/s.size,t=rB(JU(a),JU(s));return e>1?rB(t,uB(e)):t}}if(n===gH.SUM_BY_NONZERO_WEIGHTS){if(null==s)return rB(JU(a),uB(r.size));{const e=sB(s,zV(r.shape)),t=Jz(JU(qV(e,uB(0))),"float32");return rB(JU(a),t)}}throw Error(`Unknown reduction: ${n}`)}});const bH=FP({absoluteDifference_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:gH.SUM_BY_NONZERO_WEIGHTS;const s=OP(e,"labels","absoluteDifference"),a=OP(t,"predictions","absoluteDifference");let i=null;null!=n&&(i=OP(n,"weights","absoluteDifference")),pO(s.shape,a.shape,"Error in absoluteDifference: ");const o=kB(xB(s,a));return vH(o,i,r)}});const xH=FP({cosineDistance_:function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gH.SUM_BY_NONZERO_WEIGHTS;const a=OP(e,"labels","cosineDistance"),i=OP(t,"predictions","cosineDistance");let o=null;null!=r&&(o=OP(r,"weights","cosineDistance")),pO(a.shape,i.shape,"Error in cosineDistance: ");const l=uB(1),u=xB(l,JU(sB(a,i),n,!0));return vH(u,o,s)}});const wH=FP({hingeLoss_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:gH.SUM_BY_NONZERO_WEIGHTS,s=OP(e,"labels","hingeLoss");const a=OP(t,"predictions","hingeLoss");let i=null;null!=n&&(i=OP(n,"weights","hingeLoss")),pO(s.shape,a.shape,"Error in hingeLoss: ");const o=uB(1);s=xB(sB(uB(2),s),o);const l=kW(xB(o,sB(s,a)));return vH(l,i,r)}});const kH=FP({huberLoss_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gH.SUM_BY_NONZERO_WEIGHTS;const a=OP(e,"labels","huberLoss"),i=OP(t,"predictions","huberLoss");let o=null;null!=n&&(o=OP(n,"weights","huberLoss")),pO(a.shape,i.shape,"Error in huberLoss: ");const l=uB(r),u=kB(xB(i,a)),c=jV(u,l),d=xB(u,c),h=tB(sB(uB(.5),iB(c)),sB(l,d));return vH(h,o,s)}});const SH=FP({logLoss_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gH.SUM_BY_NONZERO_WEIGHTS;const a=OP(e,"labels","logLoss"),i=OP(t,"predictions","logLoss");let o=null;null!=n&&(o=OP(n,"weights","logLoss")),pO(a.shape,i.shape,"Error in logLoss: ");const l=uB(1),u=uB(r),c=kV(sB(a,xV(tB(i,u)))),d=sB(xB(l,a),xV(tB(xB(l,i),u))),h=xB(c,d);return vH(h,o,s)}});const IH=FP({meanSquaredError_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:gH.SUM_BY_NONZERO_WEIGHTS;const s=OP(e,"labels","meanSquaredError"),a=OP(t,"predictions","meanSquaredError");let i=null;null!=n&&(i=OP(n,"weights","meanSquaredError")),pO(s.shape,a.shape,"Error in meanSquaredError: ");const o=qW(s,a);return vH(o,i,r)}});const CH=FP({sigmoidCrossEntropy_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gH.SUM_BY_NONZERO_WEIGHTS,a=OP(e,"multiClassLabels","sigmoidCrossEntropy");const i=OP(t,"logits","sigmoidCrossEntropy");let o=null;if(null!=n&&(o=OP(n,"weights","sigmoidCrossEntropy")),pO(a.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){const e=uB(r),t=uB(1),n=uB(.5);a=tB(sB(a,xB(t,e)),sB(n,e))}const l=function(e,t){const n=OP(e,"labels","sigmoidCrossEntropyWithLogits"),r=OP(t,"logits","sigmoidCrossEntropyWithLogits");pO(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=kW(r),a=sB(r,n),i=wV(nV(kV(kB(r))));return tB(xB(s,a),i)}(a,i);return vH(l,o,s)}});const TH=FP({softmaxCrossEntropy_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gH.SUM_BY_NONZERO_WEIGHTS,a=OP(e,"onehotLabels","softmaxCrossEntropy");const i=OP(t,"logits","softmaxCrossEntropy");let o=null;if(null!=n&&(o=OP(n,"weights","softmaxCrossEntropy")),pO(a.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){const e=uB(r),t=uB(1),n=uB(a.shape[1]);a=tB(sB(a,xB(t,e)),rB(e,n))}const l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);const r=lB(((e,t,r)=>{const s=TV(t,[n],!0),a=xB(Jz(t,"float32"),s);r([e,a]);const i=kV(sB(a,e));return{value:JU(i,[n]),gradFunc:(e,t)=>{const[r,s]=t,a=GU(e.shape,[n]);return[sB(Kj(e,a),xB(Jz(r,"float32"),nV(s))),sB(Kj(e,a),xB(nV(s),Jz(r,"float32")))]}}}));return r(e,t)}(a,i);return vH(l,o,s)}});const NH={fft:UW,ifft:VW,rfft:HW,irfft:WW},EH={hammingWindow:LG,hannWindow:PG,frame:zG,stft:BG},AH={flipLeftRight:UG,grayscaleToRGB:VG,resizeNearestNeighbor:uH,resizeBilinear:lH,rgbToGrayscale:WG,rotateWithOffset:GG,cropAndResize:jG,nonMaxSuppression:qG,nonMaxSuppressionAsync:rH,nonMaxSuppressionWithScore:sH,nonMaxSuppressionWithScoreAsync:aH,nonMaxSuppressionPadded:iH,nonMaxSuppressionPaddedAsync:oH,threshold:cH,transform:dH},RH={bandPart:hH,gramSchmidt:pH,qr:mH},_H={absoluteDifference:bH,computeWeightedLoss:vH,cosineDistance:xH,hingeLoss:wH,huberLoss:kH,logLoss:SH,meanSquaredError:IH,sigmoidCrossEntropy:CH,softmaxCrossEntropy:TH},$H={sparseFillEmptyRows:FP({sparseFillEmptyRows_:function(e,t,n,r){const s=OP(e,"indices","sparseFillEmptyRows","int32"),a=OP(t,"values","sparseFillEmptyRows"),i=OP(n,"denseShape","sparseFillEmptyRows","int32"),o=OP(r,"defaultValue","sparseFillEmptyRows",a.dtype);if(2!==s.rank)throw new Error(`Indices should be Tensor2D but received shape\n        ${s.shape}`);if(1!==a.rank)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(1!==i.rank)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(0!==o.rank)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:s,values:a,denseShape:i,defaultValue:o},u=IP.runKernel(OF,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}}),sparseReshape:FP({sparseReshape_:function(e,t,n){const r=OP(e,"inputIndices","sparseReshape","int32"),s=OP(t,"inputShape","sparseReshape","int32"),a=OP(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error(`Input indices should be Tensor2D but received shape\n        ${r.shape}`);if(1!==s.rank)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(1!==a.rank)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const i={inputIndices:r,inputShape:s,newShape:a},o=IP.runKernel(DF,i);return{outputIndices:o[0],outputShape:o[1]}}}),sparseSegmentMean:FP({sparseSegmentMean_:function(e,t,n){const r=OP(e,"data","sparseSegmentMean"),s=OP(t,"indices","sparseSegmentMean","int32"),a=OP(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.rank)throw new Error(`Indices should be Tensor1D but received shape\n          ${s.shape}`);if(1!==a.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n          ${a.shape}`);const i={data:r,indices:s,segmentIds:a};return IP.runKernel(MF,i)}}),sparseSegmentSum:FP({sparseSegmentSum_:function(e,t,n){const r=OP(e,"data","sparseSegmentSum"),s=OP(t,"indices","sparseSegmentSum","int32"),a=OP(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.rank)throw new Error(`Indices should be Tensor1D but received shape\n         ${s.shape}`);if(1!==a.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n         ${a.shape}`);const i={data:r,indices:s,segmentIds:a};return IP.runKernel(FF,i)}})},OH={stringNGrams:FP({stringNGrams_:function(e,t,n,r,s,a,i,o){const l=OP(e,"data","stringNGrams","string");if("string"!==l.dtype)throw new Error("Data must be of datatype string");if(1!==l.shape.length)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=OP(t,"dataSplits","stringNGrams");if("int32"!==u.dtype)throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:s,rightPad:a,padWidth:i,preserveShortSequences:o},d={data:l,dataSplits:u},h=IP.runKernel(UF,d,c);return{nGrams:h[0],nGramsSplits:h[1]}}}),stringSplit:FP({stringSplit_:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=OP(e,"input","stringSplit","string"),s=OP(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(0!==s.rank)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const a={skipEmpty:n},i={input:r,delimiter:s},o=IP.runKernel(VF,i,a);return{indices:o[0],values:o[1],shape:o[2]}}}),stringToHashBucketFast:FP({stringToHashBucketFast_:function(e,t){const n=OP(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return IP.runKernel(WF,s,r)}}),staticRegexReplace:FP({staticRegexReplace_:function(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const s=OP(e,"input","staticRegexReplace","string"),a={pattern:t,rewrite:n,replaceGlobal:r};return IP.runKernel(BF,{x:s},a)}})};const DH=class{static sgd(e){return new EB(e)}static momentum(e,t){return new AB(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}static rmsprop(e){return new RB(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}static adam(){return new wB(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}static adadelta(){return new gB(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}static adamax(){return new NB(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}static adagrad(e){return new vB(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}},MH="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:e=>e();function FH(){return new Promise((e=>MH((()=>e()))))}function LH(e,t){const n=e[0].length;e.forEach(((e,t)=>{hO(e.length===n,(()=>`Error in concat${n}D: rank of tensors[${t}] must be the same as the rank of the rest (${n})`))})),hO(t>=0&&t<n,(()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`));const r=e[0];e.forEach(((e,s)=>{for(let a=0;a<n;a++)hO(a===t||e[a]===r[a],(()=>`Error in concat${n}D: Shape of tensors[${s}] (${e}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`))}))}function PH(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var zH,BH;function jH(e,t,n){let r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const a=n[s],i=r[r.length-n.length+s],o=r[i];if(a>=0)if(o>=0){if(o!==a)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${s+e}] = ${a} but shape[${s+e}] = ${o}`)}else r[i]=a}return r}function UH(e){const t={FIRST_DIM_SIZE:zH.FIRST_DIM_SIZE,VALUE_ROWIDS:zH.VALUE_ROWIDS,ROW_LENGTHS:zH.ROW_LENGTHS,ROW_SPLITS:zH.ROW_SPLITS,ROW_LIMITS:zH.ROW_LIMITS,ROW_STARTS:zH.ROW_STARTS},n=[];for(const r of e){if(!(r in t))break;n.push(t[r])}return n}function VH(e){return 0===e.length?0:e[0]===zH.FIRST_DIM_SIZE?e.length-1:e.length}function WH(e,t){if(null==e||null==t)return;const n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const n=e[s],r=t[s+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${s-e.length}] = ${n} but ragged tensor input.flatValues.shape[${s-e.length}] = ${r}`)}}(BH=zH||(zH={}))[BH.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",BH[BH.VALUE_ROWIDS=1]="VALUE_ROWIDS",BH[BH.ROW_LENGTHS=2]="ROW_LENGTHS",BH[BH.ROW_SPLITS=3]="ROW_SPLITS",BH[BH.ROW_LIMITS=4]="ROW_LIMITS",BH[BH.ROW_STARTS=5]="ROW_STARTS";const GH=30;function HH(e){return e<=GH?e:$O(e,Math.floor(Math.sqrt(e)))}function qH(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function KH(e,t,n){let r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])r=r.concat(t.slice(0)),r.push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);const n=t.length;for(let s=0;s<n;++s)r=r.concat([e[s+1]/t[s],t[s]]);r=r.concat(e.slice(n+1))}return r}function XH(e,t){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(let r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{const r=[],s=[];for(let n=1;n<e;++n)n>=2*t+1||n%2===1?s.push(n):r.push(n);n.push(...r),n.push(0),n.push(...s)}return n}function YH(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const s=[];r?s.push(e[0]/n):s.push(e[0]*n);for(let a=1;a<e.length;++a)a<=t.length?r?s.push(t[a-1]*e[a]):s.push(e[a]/t[a-1]):s.push(e[a]);return s}function QH(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function JH(e,t,n){const r=e.slice(0,1);for(let s=0;s<n;++s)r.push(e[s+1]-t[s][0]-t[s][1]);return r}function ZH(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(0===mO(e.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const s=t.shape,a=s[s.length-1];let i=1;for(let d=0;d<s.length-1;++d)i*=s[d];const o=e.shape,l=s.slice();l.pop();let u=1;for(let d=a;d<n;++d)u*=o[d],l.push(o[d]);const c=[...OO(e.shape).map((e=>e/u)),1].slice(0,a);return[l,i,u,c]}const eq=1.7580993408473768,tq=1.0507009873554805,nq=.3275911,rq=.254829592,sq=-.284496736,aq=1.421413741,iq=-1.453152027,oq=1.061405429;function lq(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function uq(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function cq(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let s=0;s<e.length;s+=4)n[Math.floor(s/4)]=e[s],r[Math.floor(s/4)]=e[s+1];return{real:n,imag:r}}function dq(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let s=2;s<e.length;s+=4)n[Math.floor(s/4)]=e[s],r[Math.floor(s/4)]=e[s+1];return{real:n,imag:r}}function hq(e,t){return{real:e[2*t],imag:e[2*t+1]}}function pq(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function fq(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let s=0;s<Math.ceil(e/2);s++){const a=(t?2:-2)*Math.PI*(s/e);n[s]=Math.cos(a),r[s]=Math.sin(a)}return{real:n,imag:r}}function mq(e,t,n){const r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}const gq="->",yq=/->/g,vq=",",bq="...";function xq(e,t){const n=((e=e.replace(/\s/g,"")).length-e.replace(yq,"").length)/gq.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${gq}").`);const[r,s]=e.split(gq);hO(-1===r.indexOf(bq),(()=>`The ellipsis notation ("${bq}") is not supported yet.`));const a=r.split(vq),i=a.length;if(t!==i)throw new Error(`Expected ${i} input tensors, received ${t}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let d=0;d<s.length;++d){const e=s[d];if(!a.some((t=>-1!==t.indexOf(e))))throw new Error(`Output subscripts contain the label ${e} not present in the input subscripts.`);-1===o.indexOf(e)&&o.push(e)}for(let d=0;d<r.length;++d){const e=r[d];-1===o.indexOf(e)&&e!==vq&&o.push(e)}const l=new Array(a.length);for(let d=0;d<i;++d){if(new Set(a[d].split("")).size!==a[d].length)throw new Error(`Found duplicate axes in input component ${a[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let e=0;e<a[d].length;++e)l[d].push(o.indexOf(a[d][e]))}const u=o.length,c=[];for(let d=s.length;d<u;++d)c.push(d);return{allDims:o,summedDims:c,idDims:l}}function wq(e,t){let n=new Array(e);n.fill(-1);for(let s=0;s<t.length;++s)n[t[s]]=s;const r=[];for(let s=0;s<e;++s)-1===n[s]&&r.push(s);return n=n.filter((e=>-1!==e)),{permutationIndices:n,expandDims:r}}function kq(e,t,n){const r=new Array(e);for(let s=0;s<n.length;++s){const e=n[s].shape;for(let n=0;n<t[s].length;++n)void 0===r[t[s][n]]?r[t[s][n]]=e[n]:hO(r[t[s][n]]===e[n],(()=>`Expected dimension ${r[t[s][n]]} at axis ${n} of input shaped ${JSON.stringify(e)}, but got dimension ${e[n]}`))}}function Sq(e,t){const n=e,r=[];let s=0;0===e.length&&n.push(-1),s=e.length+1;for(let i=0;i<s;++i)r.push([]);const a=[];for(let i=0;i<n.length;++i){const e=Cq(t,n[i]);for(const t of e)-1===a.indexOf(t)&&(r[i].push(t),a.push(t))}return{path:n,steps:r}}function Iq(e){return e.every(((e,t)=>e===t))}function Cq(e,t){const n=[];for(let r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function Tq(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)hO(e.shape[n]%t===0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(t).fill(e.shape[n]/t);else{hO(t.reduce(((e,t)=>(-1===t&&(e+=1),e)),0)<=1,(()=>"There should be only one negative value in split array."));const s=t.indexOf(-1);if(-1!==s){const r=t.reduce(((e,t)=>t>0?e+t:e));t[s]=e.shape[n]-r}hO(e.shape[n]===t.reduce(((e,t)=>e+t)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=t}return r}function Nq(e){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${e}`}function Eq(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function Aq(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}function Rq(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function _q(e,t){return`size ${e} must be non-negative, not ${t}`}function $q(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Oq(e,t){return`Input to reshape is a SparseTensor with ${mO(e)}\n  dense values, but the requested shape requires a multiple of ${mO(t)}. inputShape=${e} outputShape= ${t}`}function Dq(e,t){return`Input to reshape is a tensor with ${mO(e)} dense values, but the requested shape has ${mO(t)}. inputShape=${e} outputShape=${t}`}function Mq(){return"segment ids must be >= 0"}function Fq(){return"segment ids are not increasing"}function Lq(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function Pq(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}function zq(e,t){let n,r=!1;for(e<=GH?(n=e,r=!0):n=$O(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=$O(e,n+1);return n}function Bq(e,t,n){const r=[],s=e.length;for(let a=0;a<s;a++)a!==t?r.push(e[a]):r.push(n);return r}function jq(e,t,n,r){const s=t.shape.length,a=e.shape.length;if(0!==r&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>a)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${a}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(e.shape[d]!==t.shape[d])throw new Error(`x.shape[${d}]: ${e.shape[d]} should be equal to indices.shape[${d}]: ${t.shape[d]}.`);const i=e.shape[n],o=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)o.push(e.shape[d]),l*=e.shape[d];for(let d=r;d<n;d++)o.push(e.shape[d]),u*=e.shape[d];for(let d=r;d<s;d++)o.push(t.shape[d]);for(let d=n+1;d<a;d++)o.push(e.shape[d]),c*=e.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:i,outputShape:o}}function Uq(e){try{return e.map((e=>LL(e)))}catch(Cpe){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${Cpe}`)}}function Vq(e){return e.map((e=>FL(e)))}!function(){for(const e of _B)fB(e)}();const Wq={kernelName:QO,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(e,YW(Jz(n,"float32"),-1))}}},Gq={kernelName:JO,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=iB(Jz(n,"float32")),r=aB(xB(uB(1),t));return kV(rB(e,r))}}}},Hq={kernelName:ZO,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=aB(xB(iB(Jz(n,"float32")),1));return rB(e,t)}}}},qq={kernelName:eD,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,s=CB(n.shape,r.shape);return{a:()=>{let t=e;const r=IB(n.shape,s);return r.length>0&&(t=JU(t,r)),Kj(t,n.shape)},b:()=>{let t=e;const n=IB(r.shape,s);return n.length>0&&(t=JU(t,n)),Kj(t,r.shape)}}}},Kq={kernelName:tD,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach(((t,r)=>{n[r]=()=>e.clone()})),n}},Xq={kernelName:sD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oB(n)}}},Yq={kernelName:aD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oB(n)}}},Qq={kernelName:iD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rB(e,aB(xB(uB(1),iB(Jz(n,"float32")))))}}},Jq={kernelName:oD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=aB(tB(uB(1),iB(Jz(n,"float32"))));return rB(e,t)}}}},Zq={kernelName:cD,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,s=CB(n.shape,r.shape);return{a:()=>{const t=tB(iB(n),iB(r));let a=sB(e,rB(r,t));const i=IB(n.shape,s);return i.length>0&&(a=JU(a,i)),Kj(a,n.shape)},b:()=>{const t=tB(iB(n),iB(r));let a=kV(sB(e,rB(n,t)));const i=IB(r.shape,s);return i.length>0&&(a=JU(a,i)),Kj(a,r.shape)}}}},eK={kernelName:lD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rB(e,tB(iB(Jz(n,"float32")),1))}}},tK={kernelName:uD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rB(e,xB(uB(1),iB(Jz(n,"float32"))))}}};const nK=FP({avgPool3dGrad_:function(e,t,n,r,s,a){const i=OP(e,"dy","avgPool3dGrad"),o=OP(t,"input","avgPool3dGrad");let l=i,u=o,c=!1;4===o.rank&&(c=!0,l=Kj(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),u=Kj(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),hO(5===l.rank,(()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`)),hO(5===u.rank,(()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`)),qj("avgPool3dGrad",s,a);const d={dy:l,input:u},h={filterSize:n,strides:r,pad:s,dimRoundingMode:a},p=IP.runKernel(fD,d,h);return c?Kj(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),rK={kernelName:pD,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:s,strides:a,pad:i,dimRoundingMode:o}=n;return{x:()=>nK(e,r,s,a,i,o)}}};const sK=FP({avgPoolGrad_:function(e,t,n,r,s){const a=OP(e,"dy","avgPoolGrad"),i=OP(t,"input","avgPoolGrad");hO(i.rank===a.rank,(()=>`Rank of input (${i.rank}) does not match rank of dy (${a.rank})`));let o=i,l=a,u=!1;3===i.rank&&(u=!0,o=Kj(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=Kj(a,[1,a.shape[0],a.shape[1],a.shape[2]])),hO(4===l.rank,(()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`)),hO(4===o.rank,(()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`));const c={dy:l,input:o},d={filterSize:n,strides:r,pad:s},h=IP.runKernel(hD,c,d);return u?Kj(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),aK={kernelName:dD,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:s,strides:a,pad:i}=n;return{x:()=>sK(e,r,s,a,i)}}},iK={kernelName:mD,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,s]=t,{transposeA:a,transposeB:i}=n;return a||i?!a&&i?{a:()=>Jj(e,s,!1,!1),b:()=>Jj(e,r,!0,!1)}:a&&!i?{a:()=>Jj(s,e,!1,!0),b:()=>Jj(r,e,!1,!1)}:{a:()=>Jj(s,e,!0,!0),b:()=>Jj(e,r,!0,!0)}:{a:()=>Jj(e,s,!1,!0),b:()=>Jj(r,e,!0,!1)}}},oK={kernelName:gD,gradFunc:(e,t,n)=>{const{blockShape:r,crops:s}=n;return{x:()=>nW(e,r,s)}}},lK={kernelName:"BroadcastTo",gradFunc:(e,t,n)=>{const r=n,s=r.inputShape,a=r.shape,i=Array.from(a);for(let l=s.length-1;l>=0;l--)if(s[l]===a[l])i[l]=1;else if(1!==s[l])throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${a}].`);const o=[];for(let l=0;l<i.length;l++)i[l]>1&&o.push(l);return{x:()=>JU(e,o,!0)}}},uK={kernelName:xD,gradFunc:e=>({x:()=>e.clone()})},cK={kernelName:wD,gradFunc:e=>({x:()=>oB(e)})},dK={kernelName:kD,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:s,clipValueMax:a}=n;return{x:()=>MU(NV(cV(r,s),yV(r,a)),e,oB(e))}}},hK={kernelName:ID,inputsToSave:["x"],gradFunc:Wq.gradFunc},pK={kernelName:CD,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map((e=>e.shape)),{axis:s}=n,a=kO(s,t[0].shape)[0],i=r.map((e=>e[a]));return GW(e,i,a).map((e=>()=>e))}},fK={kernelName:TD,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,s]=t,{dilations:a,strides:i,pad:o,dataFormat:l}=n;return hO(Vj(a),(()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`)),{x:()=>xU(r.shape,e,s,i,o,l),filter:()=>NG(r,e,s.shape,i,o,l)}}},mK={kernelName:ED,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,s]=t,{strides:a,pad:i,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>vU(e,s,a,i,o,1,l),filter:()=>NG(e,r,s.shape,a,i,o,l)}}};const gK=FP({conv3DBackpropFilter_:function(e,t,n,r,s){let a=e;4===e.rank&&(a=Kj(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let i=t;4===i.rank&&(i=Kj(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),hO(5===a.rank,(()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`)),hO(5===i.rank,(()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`)),hO(5===n.length,(()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`)),hO(a.shape[4]===n[3],(()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`)),hO(i.shape[4]===n[4],(()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`));const o={x:a,dy:i},l={strides:r,pad:s,filterShape:n};return IP.runKernel(RD,o,l)}}),yK={kernelName:AD,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:s,pad:a}=n;hO(Vj(r),(()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`));const[i,o]=t;return{x:()=>SU(i.shape,e,o,s,a),filter:()=>gK(i,e,o.shape,s,a)}}},vK={kernelName:$D,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(kV(MW(Jz(n,"float32"))),e)}}},bK={kernelName:OD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(FW(Jz(n,"float32")),e)}}},xK={kernelName:MD,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:s,exclusive:a,reverse:i}=n;return{x:()=>{const t=qU([s],r.rank);let n=EU(e,s,a,!i);return null!=t&&(n=vG(n,t)),n}}}},wK={kernelName:zD,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:s,pad:a,dimRoundingMode:i}=n,o=null==r?[1,1]:r;hO(Vj(o),(()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`));const[l,u]=t;return hO(4===l.rank,(()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`)),hO(4===u.rank,(()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`)),hO(l.shape[3]===u.shape[2],(()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`)),hO(Wj(s,o),(()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${o}'.`)),qj("depthwiseConv2d",a,i),{x:()=>DG(l.shape,e,u,s,a,o,i),filter:()=>OG(l,e,u.shape,s,a,o,i)}}},kK={kernelName:VD,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,s]=t,a={x:r,filter:s,dy:e},i={x:r,filter:s,dy:e};return{x:()=>IP.runKernel(WD,a,n),filter:()=>IP.runKernel(GD,i,n)}}},SK={kernelName:XD,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>IP.runKernel(YD,r)}}},IK={kernelName:QD,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=sB(nV(kV(iB(n))),2/Math.sqrt(Math.PI));return{x:()=>sB(e,r)}}},CK={kernelName:ZD,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(e,n)}}},TK={kernelName:eM,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>Kj(e,n.shape)}}},NK={kernelName:tM,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(e,nV(n))}}},EK={kernelName:aM,gradFunc:e=>({x:()=>oB(e)})},AK={kernelName:iM,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,s=CB(n.shape,r.shape);return{a:()=>{const t=rB(e,Jz(r,"float32")),a=IB(n.shape,s);return a.length>0?Kj(JU(t,a),n.shape):t},b:()=>{let t=sB(e,Jz(n,"float32"));const a=IB(r.shape,s);a.length>0&&(t=Kj(JU(t,a),r.shape));const i=iB(r);return kV(rB(t,Jz(i,"float32")))}}}},RK={kernelName:oM,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[s,a,i,o]=t,l=null==o?uB(1):o,u=IB(a.shape,s.shape),c=[];if(1===a.rank){for(let e=0;e<s.shape.length-1;++e)c.push(s.shape[e]);c.push(1)}const d=xB(s,a),h=sB(e,l),p=RW(tB(i,uB(r))),f=sB(sB(sB(p,p),p),uB(-.5));return{x:()=>1===a.rank?Kj(sB(sB(e,aV(Kj(p,[1,1,1,a.shape[0]]),c)),l),s.shape):Kj(sB(sB(e,p),l),s.shape),mean:()=>{let e=sB(sB(p,uB(-1)),h);return 1===a.rank&&(e=JU(e,u)),Kj(e,a.shape)},variance:()=>{let e=sB(sB(f,d),h);return 1===a.rank&&(e=JU(e,u)),Kj(e,a.shape)},scale:()=>{const t=sB(d,p);let n=sB(e,t);return 1===a.rank&&(n=JU(n,u)),Kj(n,a.shape)},offset:()=>{let t=e;return 1===a.rank&&(t=JU(t,u)),Kj(t,a.shape)}}}},_K={kernelName:lM,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,s]=t,{axis:a,batchDims:i}=n,o=kO(a,r.shape)[0],l=(e,t,n)=>()=>{const r=e.shape,s=t.size,i=r.slice(0,o),l=i.length,u=r.slice(a,r.length).slice(1),c=u.length,d=$K(0,l),h=$K(l+1,l+1+c),p=OK([i,[s],u]),f=Kj(n,p),m=Kj(t,[s]),g=OK([[l],d,h]),y=vG(f,g);let v=dG(y,m,e.shape[o]);const b=KU(g);return v=vG(v,b),v};if(1===i){const t=r.shape[0],n=r.split(t,0);return{x:()=>{const t=XW(n.map(((t,n)=>l(t,s.slice(n,1),e.slice(n,1))())));return t.reshape(r.shape)},indices:()=>s}}return{x:l(r,s,e),indices:()=>s}}};function $K(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function OK(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}const DK={kernelName:dM,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>oB(n),b:()=>oB(r)}}},MK={kernelName:hM,gradFunc:e=>({x:()=>Jz(e,"float32")})},FK={kernelName:mM,gradFunc:e=>({x:()=>oB(e)})},LK={kernelName:gM,gradFunc:e=>({x:()=>oB(e)})},PK={kernelName:yM,gradFunc:e=>({x:()=>oB(e)})},zK={kernelName:vM,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:s}=n,a=uV(r,0);return{x:()=>MU(a,e,sB(e,s))}}},BK={kernelName:SM,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rB(e,tB(n,1))}}},jK={kernelName:kM,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rB(e,Jz(n,"float32"))}}},UK={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:s}=n;return{logits:()=>{const t=nV(r);return xB(e,sB(JU(e,s,!0),t))}}}};const VK=FP({localResponseNormalizationBackprop_:function(e,t,n){const r={x:e,y:t,dy:n},s={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return IP.runKernel(EM,r,s)}}),WK={kernelName:NM,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,s]=t,{depthRadius:a,bias:i,alpha:o,beta:l}=n;return{x:()=>VK(r,s,e,a,i,o,l)}}};function GK(e,t,n,r){return t.rank<n.rank&&(t=Kj(t,GU(t.shape,r))),e.rank<n.rank&&(e=Kj(e,GU(e.shape,r))),{x:()=>sB(e,Jz(DU(n,t),e.dtype))}}const HK={kernelName:AM,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:s}=r,a=t[0],i=GK(e,t[1],a,kO(s,a.shape));return{x:()=>i.x()}}},qK={kernelName:RM,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>sB(e,Jz(cV(n,r),"float32")),b:()=>sB(e,Jz(gV(n,r),"float32"))}}};const KK=FP({maxPool3dGrad_:function(e,t,n,r,s,a,i){const o=OP(e,"dy","maxPool3dGrad"),l=OP(t,"input","maxPool3dGrad"),u=OP(n,"output","maxPool3dGrad");let c=o,d=l,h=u,p=!1;4===l.rank&&(p=!0,c=Kj(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=Kj(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=Kj(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),hO(5===c.rank,(()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`)),hO(5===d.rank,(()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`)),hO(5===h.rank,(()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`)),qj("maxPool3dGrad",a,i);const f={dy:c,input:d,output:h},m={filterSize:r,strides:s,pad:a,dimRoundingMode:i},g=IP.runKernel(DM,f,m);return p?Kj(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),XK={kernelName:OM,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,s]=t,{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=n;return{x:()=>KK(e,r,s,a,i,o,l)}}};const YK=FP({maxPoolGrad_:function(e,t,n,r,s,a,i){const o=OP(e,"dy","maxPoolGrad"),l=OP(t,"input","maxPoolGrad"),u=OP(n,"output","maxPoolGrad");hO(l.rank===o.rank,(()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`)),hO(4===o.rank,(()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`)),hO(4===l.rank,(()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`)),qj("maxPoolGrad",a,i);const c={dy:o,input:l,output:u},d={filterSize:r,strides:s,pad:a,dimRoundingMode:i};return IP.runKernel($M,c,d)}}),QK={kernelName:PM,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>sB(e,Jz(yV(n,r),"float32")),b:()=>sB(e,Jz(uV(n,r),"float32"))}}},JK={kernelName:BM,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,s=CB(n.shape,r.shape);return{a:()=>{const t=IB(n.shape,s);return t.length>0?Kj(JU(e,t),n.shape):e},b:()=>{const t=sB(e,kV(oV(rB(n,r)))),a=IB(r.shape,s);return a.length>0?Kj(JU(t,a),r.shape):t}}}},ZK={kernelName:UM,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,s=CB(n.shape,r.shape);return{a:()=>{const t=sB(e,Jz(r,"float32")),a=IB(n.shape,s);return a.length>0?Kj(JU(t,a),n.shape):t},b:()=>{const t=sB(e,Jz(n,"float32")),a=IB(r.shape,s);return a.length>0?Kj(JU(t,a),r.shape):t}}}},eX={kernelName:QM,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:s}=n,a=s.map((e=>e[0]));return{x:()=>eU(e,a,r.shape)}}},tX={kernelName:JM,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,s]=t,a=n,i=r,o=CB(a.shape,i.shape);return{a:()=>{const t=Jz(i,"float32");let n=sB(e,sB(t,bB(a,xB(t,uB(1)))));const r=IB(a.shape,o);return r.length>0&&(n=JU(n,r)),Kj(n,a.shape)},b:()=>{const t=uV(a,0),n=MU(t,xV(a),oB(a));let r=sB(e,sB(s,n));const l=IB(i.shape,o);return l.length>0&&(r=JU(r,l)),Kj(r,i.shape)}}}};function nX(e,t,n){const r=e.shape.length,s=r-n.length,a=qU(n,r);let i=e;null!=a&&(i=vG(e,a));const o=i.shape.slice(),l=o.splice(r-n.length,n.length).reduce(((e,t)=>e*t),1);o.push(l);let u=function(e,t,n){const r=e.shape.slice();r[n]=1;const s=Kj(t,r),a=NU(e,n,!0,!1),i=NU(e,n,!0,!0),o=sB(a,i);return sB(s,o)}(i.reshape(o),t,s);if(u=u.reshape(i.shape),null!=a){const e=KU(a);u=vG(u,e)}return u}const rX={kernelName:qD,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,s=CB(n.shape,r.shape);return{a:()=>{const t=rB(e,Jz(r,"float32")),a=IB(n.shape,s);return a.length>0?Kj(JU(t,a),n.shape):t},b:()=>{let t=sB(e,Jz(n,"float32"));const a=IB(r.shape,s);a.length>0&&(t=Kj(JU(t,a),r.shape));const i=iB(r);return kV(rB(t,Jz(i,"float32")))}}}},sX={kernelName:RF,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:s}=n;return{x:()=>rU(e,r,s)}}},aX={kernelName:_F,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>Qj(e,r)}}},iX={kernelName:PF,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,s=uB(2);return{a:()=>sB(e,sB(s,xB(n,r))),b:()=>sB(e,sB(s,xB(r,n)))}}},oX={kernelName:GF,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,s=CB(n.shape,r.shape);return{a:()=>{let t=e;const r=IB(n.shape,s);return r.length>0&&(t=JU(t,r)),Kj(t,n.shape)},b:()=>{let t=e;const n=IB(r.shape,s);return n.length>0&&(t=JU(t,n)),Kj(kV(t),r.shape)}}}};const lX=[Wq,Gq,Hq,qq,Kq,Xq,Yq,Qq,Jq,Zq,eK,tK,rK,aK,iK,oK,lK,uK,cK,dK,hK,pK,mK,fK,yK,vK,bK,xK,wK,kK,rX,SK,IK,CK,TK,NK,AK,EK,RK,_K,DK,MK,FK,LK,PK,zK,BK,jK,UK,WK,HK,HK,qK,XK,{kernelName:_M,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,s]=t,{filterSize:a,strides:i,pad:o}=n;return{x:()=>YK(e,r,s,a,i,o)}}},{kernelName:FM,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:s}=n,a=kO(s,r.shape),i=mO(WU(r.shape,a)[1]);return{x:()=>{const t=r.shape.slice();a.forEach((e=>{t[e]=1}));const n=Kj(e,t);return rB(sB(n,zV(r.shape,"float32")),i)}}}},{kernelName:LM,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:s}=r,[a,i]=t,o=GK(e,i,a,kO(s,a.shape));return{x:()=>o.x()}}},QK,{kernelName:zM,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:s}=n,a=s.map((e=>e[0]));return{x:()=>eU(e,a,r.shape)}}},JK,ZK,{kernelName:VM,gradFunc:e=>({x:()=>kV(e)})},{kernelName:XM,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>PV(n.shape,"float32")}}},{kernelName:KM,gradFunc:e=>({x:()=>oB(e)})},{kernelName:YM,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return hG(e,r).map((e=>()=>e))}},eX,eX,tX,{kernelName:ZM,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,s=uV(n,0);return{x:()=>MU(s,e,sB(e,r)),alpha:()=>{let t=MU(s,oB(e),sB(e,n));const a=IB(r.shape,e.shape);return a.length>0&&(t=JU(t,a)),Kj(t,r.shape)}}}},{kernelName:eF,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:s}=n;let a=[];return a=void 0===s||null===s?r.shape.map(((e,t)=>t)):"number"===typeof s?[s]:s,{x:()=>nX(r,e,a)}}},{kernelName:iF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rB(e,kV(iB(n)))}}},{kernelName:pF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=sB(yV(n,6),YW(n));return{x:()=>sB(e,Jz(r,"float32"))}}},{kernelName:oF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(e,Jz(YW(n),"float32"))}}},{kernelName:lF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Kj(e,n.shape)}}},{kernelName:dF,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,s={dy:e,images:r};return{images:()=>IP.runKernel(hF,s,n)}}},{kernelName:uF,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,s={dy:e,images:r};return{images:()=>IP.runKernel(cF,s,n)}}},{kernelName:fF,gradFunc:(e,t,n)=>{const{dims:r}=n,s=kO(r,e.shape);return{x:()=>IW(e,s)}}},{kernelName:mF,gradFunc:e=>({x:()=>oB(e)})},{kernelName:gF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>kV(rB(e,sB(bB(n,1.5),2)))}}},{kernelName:xF,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>Jz(oB(n),"float32"),t:()=>sB(e,Jz(n,e.dtype)),e:()=>sB(e,Jz(EV(n),e.dtype))}}},{kernelName:wF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=uV(n,uB(0)),r=uB(eq),s=uB(tq),a=sB(e,s),i=sB(sB(e,r),nV(Jz(n,"float32")));return MU(t,a,i)}}}},{kernelName:TF,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(e,sB(n,xB(uB(1),n)))}}},{kernelName:CF,gradFunc:e=>({x:()=>oB(e)})},{kernelName:SF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(CU(Jz(n,"float32")),e)}}},{kernelName:IF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(TU(Jz(n,"float32")),e)}}},{kernelName:kF,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:s,size:a}=n,i=r.shape,[o,l]=vj(r,s,a),u=[];for(let c=0;c<e.rank;c++)u.push([o[c],i[c]-o[c]-l[c]]);return{x:()=>QV(e,u)}}},{kernelName:$F,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:s}=n,a=sB(e,r);return{logits:()=>xB(a,sB(JU(a,[s],true),r))}}},{kernelName:NF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(e,Zj(n))}}},sX,sX,aX,aX,{kernelName:EF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rB(e,sB(aB(Jz(n,"float32")),2))}}},iX,{kernelName:zF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(e,sB(Jz(n,"float32"),2))}}},{kernelName:nL,gradFunc:e=>({x:()=>oB(e)})},oX,{kernelName:AF,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,s=r.shape.slice(),{axis:a}=n;kO(a,r.shape).forEach((e=>{s[e]=1}));const i=Kj(e,s),o=sB(i,zV(r.shape,"float32"));return{x:()=>o}}},{kernelName:HF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rB(e,iB(CU(n)))}}},{kernelName:qF,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sB(xB(uB(1),iB(n)),e)}}},{kernelName:KF,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:s}=n;return{x:()=>{let t=oB(r);if(1===r.rank)for(let n=0;n<s[0];++n)t=tB(t,eU(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<s[0];++n)for(let a=0;a<s[1];++a)t=tB(t,eU(e,[n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<s[0];++n)for(let a=0;a<s[1];++a)for(let i=0;i<s[2];++i)t=tB(t,eU(e,[n*r.shape[0],a*r.shape[1],i*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);for(let n=0;n<s[0];++n)for(let a=0;a<s[1];++a)for(let i=0;i<s[2];++i)for(let o=0;o<s[3];++o)t=tB(t,eU(e,[n*r.shape[0],a*r.shape[1],i*r.shape[2],o*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},{kernelName:QF,gradFunc:(e,t,n)=>{const r=n,{perm:s}=r,a=KU(s);return{x:()=>vG(e,a)}}},{kernelName:ZF,gradFunc:(e,t,n)=>{const r=n,{axis:s}=r;return{value:()=>XW(e,s)}}},{kernelName:eL,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>function(e,t){const n=TB(t,oB(t)),r=lV(e,n);let s=cV(t,uB(0,"int32"));const a=r.rank-s.rank;for(let o=0;o<a;++o)s=rV(s,o+1);s=NV(s,zV(r.shape,"bool"));const i=oB(r);return MU(s,r,i)}(e,n)}}},{kernelName:tL,gradFunc:e=>({x:()=>oB(e)})}];for(const n of lX)gL(n);ZL().prototype.abs=function(){return this.throwIfDisposed(),kB(this)},ZL().prototype.acos=function(){return this.throwIfDisposed(),wj(this)},ZL().prototype.acosh=function(){return this.throwIfDisposed(),kj(this)},ZL().prototype.add=function(e){return this.throwIfDisposed(),tB(this,e)},ZL().prototype.all=function(e,t){return this.throwIfDisposed(),Ij(this,e,t)},ZL().prototype.any=function(e,t){return this.throwIfDisposed(),Cj(this,e,t)},ZL().prototype.argMax=function(e){return this.throwIfDisposed(),Tj(this,e)},ZL().prototype.argMin=function(e){return this.throwIfDisposed(),Nj(this,e)},ZL().prototype.asScalar=function(){return this.throwIfDisposed(),hO(1===this.size,(()=>"The array must have only 1 element.")),Kj(this,[])},ZL().prototype.asType=function(e){return this.throwIfDisposed(),Jz(this,e)},ZL().prototype.as1D=function(){return this.throwIfDisposed(),Kj(this,[this.size])},ZL().prototype.as2D=function(e,t){return this.throwIfDisposed(),Kj(this,[e,t])},ZL().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),Kj(this,[e,t,n])},ZL().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),Kj(this,[e,t,n,r])},ZL().prototype.as5D=function(e,t,n,r,s){return this.throwIfDisposed(),Kj(this,[e,t,n,r,s])},ZL().prototype.asin=function(){return this.throwIfDisposed(),Ej(this)},ZL().prototype.asinh=function(){return this.throwIfDisposed(),Aj(this)},ZL().prototype.atan=function(){return this.throwIfDisposed(),Rj(this)},ZL().prototype.atan2=function(e){return this.throwIfDisposed(),_j(this,e)},ZL().prototype.atanh=function(){return this.throwIfDisposed(),$j(this)},ZL().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Xj(this,e,t,n,r)},ZL().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),rU(this,e,t)},ZL().prototype.batchNorm=function(e,t,n,r,s){return this.throwIfDisposed(),sU(this,e,t,n,r,s)},ZL().prototype.broadcastTo=function(e){return this.throwIfDisposed(),dU(this,e)},ZL().prototype.cast=function(e){return this.throwIfDisposed(),Jz(this,e)},ZL().prototype.ceil=function(){return this.throwIfDisposed(),hU(this)},ZL().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),pU(this,e,t)},ZL().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof JL&&(e=[e]),Qj([this,...e],t)},ZL().prototype.conv1d=function(e,t,n,r,s,a){return this.throwIfDisposed(),bU(this,e,t,n,r,s,a)},ZL().prototype.conv2dTranspose=function(e,t,n,r,s){return this.throwIfDisposed(),wU(this,e,t,n,r,s)},ZL().prototype.conv2d=function(e,t,n,r,s,a){return this.throwIfDisposed(),vU(this,e,t,n,r,s,a)},ZL().prototype.cos=function(){return this.throwIfDisposed(),CU(this)},ZL().prototype.cosh=function(){return this.throwIfDisposed(),TU(this)},ZL().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),NU(this,e,t,n)},ZL().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),EU(this,e,t,n)},ZL().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),RU(this,e,t)},ZL().prototype.depthwiseConv2d=function(e,t,n,r,s,a){return this.throwIfDisposed(),_U(this,e,t,n,r,s,a)},ZL().prototype.dilation2d=function(e,t,n,r,s){return this.throwIfDisposed(),OU(this,e,t,n,r,s)},ZL().prototype.divNoNan=function(e){return this.throwIfDisposed(),FU(this,e)},ZL().prototype.div=function(e){return this.throwIfDisposed(),rB(this,e)},ZL().prototype.dot=function(e){return this.throwIfDisposed(),LU(this,e)},ZL().prototype.elu=function(){return this.throwIfDisposed(),zU(this)},ZL().prototype.equal=function(e){return this.throwIfDisposed(),DU(this,e)},ZL().prototype.erf=function(){return this.throwIfDisposed(),jU(this)},ZL().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),tV(this,e,t)},ZL().prototype.exp=function(){return this.throwIfDisposed(),nV(this)},ZL().prototype.expandDims=function(e){return this.throwIfDisposed(),rV(this,e)},ZL().prototype.expm1=function(){return this.throwIfDisposed(),sV(this)},ZL().prototype.fft=function(){return this.throwIfDisposed(),UW(this)},ZL().prototype.flatten=function(){return this.throwIfDisposed(),Kj(this,[this.size])},ZL().prototype.floor=function(){return this.throwIfDisposed(),oV(this)},ZL().prototype.floorDiv=function(e){return this.throwIfDisposed(),nB(this,e)},ZL().prototype.gather=function(e,t,n){return this.throwIfDisposed(),lV(this,e,t,n)},ZL().prototype.greaterEqual=function(e){return this.throwIfDisposed(),cV(this,e)},ZL().prototype.greater=function(e){return this.throwIfDisposed(),uV(this,e)},ZL().prototype.ifft=function(){return this.throwIfDisposed(),VW(this)},ZL().prototype.irfft=function(){return this.throwIfDisposed(),WW(this)},ZL().prototype.isFinite=function(){return this.throwIfDisposed(),hV(this)},ZL().prototype.isInf=function(){return this.throwIfDisposed(),pV(this)},ZL().prototype.isNaN=function(){return this.throwIfDisposed(),fV(this)},ZL().prototype.leakyRelu=function(e){return this.throwIfDisposed(),mV(this,e)},ZL().prototype.lessEqual=function(e){return this.throwIfDisposed(),yV(this,e)},ZL().prototype.less=function(e){return this.throwIfDisposed(),gV(this,e)},ZL().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),bV(this,e,t,n,r)},ZL().prototype.logSigmoid=function(){return this.throwIfDisposed(),IV(this)},ZL().prototype.logSoftmax=function(e){return this.throwIfDisposed(),CV(this,e)},ZL().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),TV(this,e,t)},ZL().prototype.log=function(){return this.throwIfDisposed(),xV(this)},ZL().prototype.log1p=function(){return this.throwIfDisposed(),wV(this)},ZL().prototype.logicalAnd=function(e){return this.throwIfDisposed(),NV(this,e)},ZL().prototype.logicalNot=function(){return this.throwIfDisposed(),EV(this)},ZL().prototype.logicalOr=function(e){return this.throwIfDisposed(),AV(this,e)},ZL().prototype.logicalXor=function(e){return this.throwIfDisposed(),RV(this,e)},ZL().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Jj(this,e,t,n)},ZL().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),DV(this,e,t,n,r)},ZL().prototype.max=function(e,t){return this.throwIfDisposed(),YU(this,e,t)},ZL().prototype.maximum=function(e){return this.throwIfDisposed(),TB(this,e)},ZL().prototype.mean=function(e,t){return this.throwIfDisposed(),LV(this,e,t)},ZL().prototype.min=function(e,t){return this.throwIfDisposed(),QU(this,e,t)},ZL().prototype.minimum=function(e){return this.throwIfDisposed(),jV(this,e)},ZL().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),UV(this,e,t)},ZL().prototype.mod=function(e){return this.throwIfDisposed(),VV(this,e)},ZL().prototype.mul=function(e){return this.throwIfDisposed(),sB(this,e)},ZL().prototype.neg=function(){return this.throwIfDisposed(),kV(this)},ZL().prototype.norm=function(e,t,n){return this.throwIfDisposed(),eV(this,e,t,n)},ZL().prototype.notEqual=function(e){return this.throwIfDisposed(),qV(this,e)},ZL().prototype.oneHot=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),KV(this,e,t,n)},ZL().prototype.onesLike=function(){return this.throwIfDisposed(),XV(this)},ZL().prototype.pad=function(e,t){return this.throwIfDisposed(),QV(this,e,t)},ZL().prototype.pool=function(e,t,n,r,s,a){return this.throwIfDisposed(),rW(this,e,t,n,r,s,a)},ZL().prototype.pow=function(e){return this.throwIfDisposed(),bB(this,e)},ZL().prototype.prelu=function(e){return this.throwIfDisposed(),sW(this,e)},ZL().prototype.prod=function(e,t){return this.throwIfDisposed(),aW(this,e,t)},ZL().prototype.reciprocal=function(){return this.throwIfDisposed(),wW(this)},ZL().prototype.relu=function(){return this.throwIfDisposed(),kW(this)},ZL().prototype.relu6=function(){return this.throwIfDisposed(),SW(this)},ZL().prototype.reshapeAs=function(e){return this.throwIfDisposed(),Kj(this,e.shape)},ZL().prototype.reshape=function(e){return this.throwIfDisposed(),Kj(this,e)},ZL().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),lH(this,e,t,n)},ZL().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),uH(this,e,t,n)},ZL().prototype.reverse=function(e){return this.throwIfDisposed(),IW(this,e)},ZL().prototype.rfft=function(){return this.throwIfDisposed(),HW(this)},ZL().prototype.round=function(){return this.throwIfDisposed(),AW(this)},ZL().prototype.rsqrt=function(){return this.throwIfDisposed(),RW(this)},ZL().prototype.selu=function(){return this.throwIfDisposed(),_W(this)},ZL().prototype.separableConv2d=function(e,t,n,r,s,a){return this.throwIfDisposed(),$W(this,e,t,n,r,s,a)},ZL().prototype.sigmoid=function(){return this.throwIfDisposed(),Zj(this)},ZL().prototype.sign=function(){return this.throwIfDisposed(),DW(this)},ZL().prototype.sin=function(){return this.throwIfDisposed(),MW(this)},ZL().prototype.sinh=function(){return this.throwIfDisposed(),FW(this)},ZL().prototype.slice=function(e,t){return this.throwIfDisposed(),eU(this,e,t)},ZL().prototype.softmax=function(e){return this.throwIfDisposed(),jW(this,e)},ZL().prototype.softplus=function(){return this.throwIfDisposed(),SV(this)},ZL().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),nW(this,e,t)},ZL().prototype.split=function(e,t){return this.throwIfDisposed(),GW(this,e,t)},ZL().prototype.sqrt=function(){return this.throwIfDisposed(),aB(this)},ZL().prototype.square=function(){return this.throwIfDisposed(),iB(this)},ZL().prototype.squaredDifference=function(e){return this.throwIfDisposed(),qW(this,e)},ZL().prototype.squeeze=function(e){return this.throwIfDisposed(),KW(this,e)},ZL().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof JL?[this,e]:[this,...e];return XW(n,t)},ZL().prototype.step=function(e){return this.throwIfDisposed(),YW(this,e)},ZL().prototype.stridedSlice=function(e,t,n,r,s,a,i,o){return this.throwIfDisposed(),QW(this,e,t,n,r,s,a,i,o)},ZL().prototype.sub=function(e){return this.throwIfDisposed(),xB(this,e)},ZL().prototype.sum=function(e,t){return this.throwIfDisposed(),JU(this,e,t)},ZL().prototype.tan=function(){return this.throwIfDisposed(),JW(this)},ZL().prototype.tanh=function(){return this.throwIfDisposed(),tU(this)},ZL().prototype.tile=function(e){return this.throwIfDisposed(),aV(this,e)},ZL().prototype.toBool=function(){return this.throwIfDisposed(),Jz(this,"bool")},ZL().prototype.toFloat=function(){return this.throwIfDisposed(),Jz(this,"float32")},ZL().prototype.toInt=function(){return this.throwIfDisposed(),Jz(this,"int32")},ZL().prototype.topk=function(e,t){return this.throwIfDisposed(),lG(this,e,t)},ZL().prototype.transpose=function(e){return this.throwIfDisposed(),vG(this,e)},ZL().prototype.unique=function(e){return this.throwIfDisposed(),cG(this,e)},ZL().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),dG(this,e,t)},ZL().prototype.unstack=function(e){return this.throwIfDisposed(),hG(this,e)},ZL().prototype.where=function(e,t){return this.throwIfDisposed(),MU(e,this,t)},ZL().prototype.zerosLike=function(){return this.throwIfDisposed(),oB(this)};class uX extends Error{constructor(e){super(e),Object.setPrototypeOf(this,uX.prototype)}}class cX extends Error{constructor(e){super(e),Object.setPrototypeOf(this,cX.prototype)}}class dX extends Error{constructor(e){super(e),Object.setPrototypeOf(this,dX.prototype)}}class hX extends Error{constructor(e){super(e),Object.setPrototypeOf(this,hX.prototype)}}class pX extends Error{constructor(e){super(e),Object.setPrototypeOf(this,pX.prototype)}}Error;class fX{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}}function mX(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}{const n=new Array(t);return n.fill(e),n}}function gX(e,t){if(!e)throw new pX(t)}function yX(e,t){let n=0;for(const r of e)r===t&&n++;return n}function vX(e){return 1===e.length?e[0]:e}function bX(e){return Array.isArray(e)?e:[e]}function xX(e){const t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function wX(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,((e,t)=>t.toUpperCase()))}let kX={};function SX(e){if(null===e||void 0===e)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function IX(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((e=>IX(e)));else{const t=Object.keys(e);for(const n of t){const t=e[n];null!=t&&"object"===typeof t&&(Array.isArray(t)||"ndarray"!==t.type||"number"!==typeof t.value?IX(t):e[n]=t.value)}}}function CX(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){const s=e;let a;if(s in n)a=n[s];else if(s in kX)a=kX[s];else if(a=t[s],null==a)throw new dX(`Unknown ${r}: ${e}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}{const a=e;if(null==a.className||null==a.config)throw new dX(`${r}: Improper config format: ${JSON.stringify(a)}.\n'className' and 'config' must set.`);const i=a.className;let o,l;if(i in n?[o,l]=n[i]:i in kX?[o,l]=kX.className:i in t&&([o,l]=t[i]),null==o)throw new dX(`Unknown ${r}: ${i}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=l){const e={};for(const n of Object.keys(kX))e[n]=kX[n];for(const s of Object.keys(n))e[s]=n[s];a.config.customObjects=e;const t=Object.assign({},kX);for(const s of Object.keys(n))kX[s]=n[s];IX(a.config);const r=l(o,a.config,n,s);return kX=Object.assign({},t),r}{const e=Object.assign({},kX);for(const r of Object.keys(n))kX[r]=n[r];const t=new o(a.config);return kX=Object.assign({},e),t}}}function TX(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function NX(e){if(null==e)return e;const t=[];for(const n of e)-1===t.indexOf(n)&&t.push(n);return t}function EX(e){if(null==e)throw new dX(`Invalid value in obj: ${JSON.stringify(e)}`);for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function AX(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new dX(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function RX(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return gX(n>=0),gX(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((e=>typeof e===t))}function _X(e,t){Array.isArray(e)?(hO(e.length>0,(()=>`${t} is unexpectedly an empty array.`)),e.forEach(((e,n)=>_X(e,`element ${n+1} of ${t}`)))):hO(Number.isInteger(e)&&e>0,(()=>`Expected ${t} to be a positive integer, but got ${$X(e)}.`))}function $X(e){return null===e?"null":Array.isArray(e)?"["+e.map((e=>$X(e))).join(",")+"]":"string"===typeof e?`"${e}"`:`${e}`}function OX(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}let DX=0;function MX(){return DX++}const FX={};function LX(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in FX||(FX[e]=0),FX[e]+=1,e+FX[e].toString()}const PX=["channelsFirst","channelsLast"],zX=["nearest","bilinear"],BX=["valid","same","causal"],jX=["max","avg"],UX=["sum","mul","concat","ave"],VX=new Map;function WX(e){AX(PX,"DataFormat",e)}function GX(e){AX(BX,"PaddingMode",e)}function HX(e){AX(jX,"PoolMode",e)}const qX=[];function KX(e,t){qX.push(e);try{const e=t();return qX.pop(),e}catch(Ipe){throw qX.pop(),Ipe}}function XX(e){if(!JX(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===qX.length?"":qX.join("/")+"/")+e}function YX(e){if(!JX(e))throw new Error("Not a valid tensor name: '"+e+"'");VX.has(e)||VX.set(e,0);const t=VX.get(e);if(VX.set(e,VX.get(e)+1),t>0){const n=`${e}_${t}`;return VX.set(n,1),n}return e}const QX=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function JX(e){return!!e.match(QX)}function ZX(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let r=1;for(let s=t;s<n;++s)r*=e[s];return r}function eY(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function tY(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function nY(e,t){if(t<e)throw new dX(`end (${t}) < begin (${e}) is forbidden.`);const n=[];for(let r=e;r<t;++r)n.push(r);return n}let rY;function sY(){return null==rY&&(rY=KP().epsilon()),rY}function aY(e,t){return Jz(e,t)}function iY(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),Kj(e,n)}function oY(e,t,n){return WP((()=>{switch(e.rank){case 1:return LW(e,t,n);case 2:return PW(e,[t,0],[n,e.shape[1]]);case 3:return zW(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return BW(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return eU(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return eU(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new dX(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function lY(e,t,n){return WP((()=>{switch(e.rank){case 1:return LW(e,t,n);case 2:return PW(e,[0,t],[e.shape[0],n]);case 3:return zW(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return BW(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new dX(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function uY(e,t,n,r){return WP((()=>{switch(e.rank){case 1:return LW(e,t,n);case 2:switch(r){case 1:return oY(e,t,n);case 2:return lY(e,t,n);default:throw new dX(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return oY(e,t,n);case 2:return zW(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return lY(e,t,n);default:throw new dX(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return oY(e,t,n);case 2:return BW(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return BW(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return lY(e,t,n);default:throw new dX(`The axis is not within the rank of the tensor ${r}`)}default:throw new dX(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function cY(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(t=e[0].rank,n=0!==t?t:0),n===e[0].rank&&(n=-1),Qj(e,n)}function dY(e,t){switch(e.rank){case 1:return fU([e,t]);case 2:return mU([e,t],0);case 3:return gU([e,t],0);case 4:return yU([e,t],0);default:throw new dX(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function hY(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new dX(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return aV(e,t)}function pY(e){return mW(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function fY(e,t,n,r){if(e.rank<2||t.rank<2)throw new hX(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){if(e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new hX(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(2===e.rank&&2===t.rank){return FG({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?yY(e.rank,r,"channelsLast"):null,activation:n})}{const s=e.shape.slice(),a=s.pop();e=Kj(e,[-1,a]);const i=t.shape.slice(),o=i.pop(),l=i.pop(),u=[...i,o],c=Array.from({length:t.rank},((e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n));t=Kj(vG(t,c),[l,-1]);const d=[...s,...u];return Kj(FG({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?yY(e.rank,r,"channelsLast"):null,activation:n}),d)}}function mY(e,t,n){return WP((()=>(t=Array.isArray(t)?ZW(t,"int32"):Jz(t,"int32"),lV(e,t,n))))}function gY(e){return sB(e,e)}function yY(e,t,n){const r=t.shape;if(1!==t.rank&&t.rank!==e)throw new dX(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(5===e){if("channelsFirst"===n)return 1===r.length?Kj(t,[1,r[0],1,1,1]):Kj(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?Kj(t,[1,1,1,1,r[0]]):Kj(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?Kj(t,[1,r[0],1,1]):Kj(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?Kj(t,[1,1,1,r[0]]):Kj(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?Kj(t,[1,r[0],1]):Kj(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?Kj(t,[1,1,r[0]]):Kj(t,[1].concat(r))}else if(e<3)return t;throw new dX(`Unsupported input rank by biasAdd: ${t.rank}`)}function vY(e,t,n){return WP((()=>(null==n&&(n="channelsLast"),WX(n),tB(e,yY(e.rank,t,n)))))}function bY(e,t,n,r){return WP((()=>SG(e,t,n,r)))}function xY(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}const wY=["fanIn","fanOut","fanAvg"],kY=["normal","uniform","truncatedNormal"];class SY extends hB{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class IY extends SY{apply(e,t){return PV(e,t)}}IY.className="Zeros",fB(IY);class CY extends SY{apply(e,t){return zV(e,t)}}CY.className="Ones",fB(CY);class TY extends SY{constructor(e){if(super(),"object"!==typeof e)throw new dX(`Expected argument of type ConstantConfig but got ${e}`);if(void 0===e.value)throw new dX(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return WP((()=>sB(uB(this.value),zV(e,t))))}getConfig(){return{value:this.value}}}TY.className="Constant",fB(TY);class NY extends SY{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return yW(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}NY.className="RandomUniform",fB(NY);class EY extends SY{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new hX(`randomNormal does not support dType ${t}.`);return pY(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}EY.className="RandomNormal",fB(EY);class AY extends SY{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new hX(`truncatedNormal does not support dType ${t}.`);return uG(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}AY.className="TruncatedNormal",fB(AY);class RY extends SY{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return WP((()=>{if(2!==e.length||e[0]!==e[1])throw new dX("Identity matrix initializer can only be used for 2D square matrices.");return sB(this.gain,iV(e[0]))}))}getConfig(){return{gain:this.gain}}}RY.className="Identity",fB(RY);class _Y extends SY{constructor(e){if(super(),e.scale<0)throw new dX(`scale must be a positive float. Got: ${e.scale}`);var t;this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,t=this.mode,AX(wY,"FanMode",t),this.distribution=null==e.distribution?"normal":e.distribution,function(e){AX(kY,"Distribution",e)}(this.distribution),this.seed=e.seed}apply(e,t){const n=function(e){let t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(WX(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){const r=ZX(e,2);t=e[1]*r,n=e[0]*r}else if("channelsLast"===r){const r=ZX(e,0,e.length-2);t=e[e.length-2]*r,n=e[e.length-1]*r}}else{const r=ZX(e);t=Math.sqrt(r),n=Math.sqrt(r)}return[t,n]}(e),r=n[0],s=n[1];let a=this.scale;if("fanIn"===this.mode?a/=Math.max(1,r):"fanOut"===this.mode?a/=Math.max(1,s):a/=Math.max(1,(r+s)/2),"normal"===this.distribution){const n=Math.sqrt(a);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new hX(`${this.getClassName()} does not support dType ${t}.`);return uG(e,0,n,t,this.seed)}{const n=Math.sqrt(3*a);return yW(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}_Y.className="VarianceScaling",fB(_Y);class $Y extends _Y{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return _Y.className}}$Y.className="GlorotUniform",fB($Y);class OY extends _Y{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return _Y.className}}OY.className="GlorotNormal",fB(OY);class DY extends _Y{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return _Y.className}}DY.className="HeNormal",fB(DY);class MY extends _Y{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return _Y.className}}MY.className="HeUniform",fB(MY);class FY extends _Y{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return _Y.className}}FY.className="LeCunNormal",fB(FY);class LY extends _Y{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return _Y.className}}LY.className="LeCunUniform",fB(LY);class PY extends SY{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return WP((()=>{if(e.length<2)throw new hX("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError(`Unsupported data type ${t}.`);const n=mO(e.slice(0,-1)),r=e[e.length-1],s=n*r;s>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${s}) elements: Slowness may result.`);const a=pY([Math.max(r,n),Math.min(r,n)],0,1,t,this.seed),i=RH.qr(a,!1);let o=i[0];const l=i[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return o=sB(o,l.sign()),n<r&&(o=o.transpose()),sB(uB(this.gain),o.reshape(e))}))}getConfig(){return{gain:this.gain,seed:this.seed}}}PY.className="Orthogonal",fB(PY);const zY={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function BY(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return CX(e,pB.getMap().classNameMap,t,"initializer")}function jY(e){return SX(e)}function UY(e){if("string"===typeof e){const t=e in zY?zY[e]:e;if("GlorotNormal"===t)return new OY;if("GlorotUniform"===t)return new $Y;if("HeNormal"===t)return new DY;if("HeUniform"===t)return new MY;if("LeCunNormal"===t)return new FY;if("LeCunUniform"===t)return new LY;{const e={};return e.className=t,e.config={},BY(e)}}return e instanceof SY?e:BY(e)}function VY(e){return Array.isArray(e)&&Array.isArray(e[0])}function WY(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function GY(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new dX(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function HY(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new dX(`Expected exactly 1 Shape; got ${e.length}`)}return e}function qY(e){let t=0;for(const n of e)0===n.shape.length?t+=1:t+=n.shape.reduce(((e,t)=>e*t));return t}const KY="Variable";class XY{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:KY,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=MX(),n=null==n?KY:n,this.originalName=XX(n),this.name=YX(this.originalName),this.trainable_=r,this.constraint=s,this.val=fG(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function YY(e){return e.map((e=>e.read()))}function QY(e){e.forEach((e=>{e[0].write(e[1])}))}class JY{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class ZY{constructor(e,t,n,r,s,a,i){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=s,this.outputTensorIndex=i,this.id=MX(),null!=a&&(this.originalName=XX(a),this.name=YX(this.originalName)),this.rank=t.length}}let eQ=0;class tQ{constructor(e,t){this.callArgs=t,this.id=eQ++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const n of e.inboundLayers)null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let nQ=0;class rQ extends hB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=nQ++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const e=this.getClassName();t=xX(e)+"_"+LX(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new cX(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new dX(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return vX(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return vX(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new uX(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(0===this.inboundNodes.length)throw new uX(`Layer ${this.name} is not connected, no input to return.`);return vX(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new uX(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new uX(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return vX(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((e=>e()))}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach((t=>t.trainable=e)),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((e=>e.trainable)):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((e=>!e.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=bX(e);if(null==this.inputSpec||0===this.inputSpec.length)return;const n=bX(this.inputSpec);if(t.length!==n.length)throw new dX(`Layer ${this.name} expects ${n.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let r=0;r<t.length;r++){const e=t[r],s=n[r];if(null==s)continue;const a=e.rank;if(null!=s.ndim&&a!==s.ndim)throw new dX(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${a}`);if(null!=s.maxNDim&&a>s.maxNDim)throw new dX(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${a}`);if(null!=s.minNDim&&a<s.minNDim)throw new dX(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${a}.`);if(null!=s.dtype&&e.dtype!==s.dtype)throw new dX(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${e.dtype}.`);if(s.axes){const t=e.shape;for(const e in s.axes){const n=Number(e),a=s.axes[e],i=n>=0?t[n]:t[t.length+n];if(null!=a&&-1===[a,null].indexOf(i))throw new dX(`Input ${r} is incompatible with layer ${this.name}: expected axis ${n} of input shape to have value ${a} but got shape ${t}.`)}}if(null!=s.shape)for(let t=0;t<s.shape.length;++t){const n=s.shape[t],a=e.shape[t];if(null!=n&&null!=a&&n!==a)throw new dX(`Input ${r} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${e.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const n=bX(e),r=function(e){let t=!0;for(const n of bX(e))if(!(n instanceof ZY)){t=!1;break}return t}(e),s=function(e){let t=!0;for(const n of bX(e))if(n instanceof ZY){t=!1;break}return t}(e);if(r===s)throw new dX("Arguments to apply() must be all SymbolicTensors or all Tensors");return KX(this.name,(()=>{if(!this.built){this.assertInputCompatibility(e);const t=[];for(const n of bX(e))t.push(n.shape);this.build(vX(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&s&&(this._refCount=1)}if(this.assertInputCompatibility(e),s){let r=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,r);const s=bX(r),a=[];for(let e of s)-1!==n.indexOf(e)&&(e=e.clone()),a.push(e);if(r=vX(a),null!=this.activityRegularizer)throw new hX("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(e){e=bX(e);const t=[];for(const n of e)t.push(n.shape);return vX(t)}(e),r=this.computeOutputShape(n);let s;const a="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?n[0]:n),s=null!=r&&r.length>0&&Array.isArray(r[0])?r.map(((n,r)=>new ZY(a,n,this,bX(e),t,this.name,r))):new ZY(a,r,this,bX(e),t,this.name),this.addInboundNode(e,s,null,null,n,r,t),this._refCount++,null!=this.activityRegularizer)throw new hX("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return s}}))}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach(((n,r)=>{null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new uX(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new uX(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new cX(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return qY(this.weights)}build(e){this.built=!0}getWeights(){return YY(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(e){WP((()=>{const t=this.weights;if(t.length!==e.length)throw new dX(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(0===t.length)return;const n=[],r=YY(t);for(let s=0;s<r.length;++s){const a=r[s],i=t[s],o=e[s];if(!gO(a.shape,o.shape))throw new dX(`Layer weight shape ${a.shape} not compatible with provided weight shape ${o.shape}`);n.push([i,o])}QY(n)}))}addWeight(e,t,n,r,s,a,i,o){if(-1!==this._addedWeightNames.indexOf(e))throw new dX(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=o?o():UY("zeros"));const l=r.apply(t,n),u=new XY(l,n,e,a,i);return l.dispose(),null!=s&&this.addLoss((()=>s.apply(u.read()))),null==a&&(a=!0),a?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=bX(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);t.forEach((e=>{if(null!=e)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)}))}return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;const r=this.computeMask(e,n),s=bX(t),a=bX(r);if(s.length!==a.length)throw new Error(`${this.name} outputs ${s.length} tensors but ${s.length} masks for those tensors`);for(let i=0;i<s.length;i++)s[i].kerasMask=a[i]}addInboundNode(e,t,n,r,s,a){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const o=bX(e);t=bX(t),n=bX(n),r=bX(r),s=WY(s),a=WY(a);const l=[],u=[],c=[];for(const d of o)l.push(d.sourceLayer),u.push(d.nodeIndex),c.push(d.tensorIndex);new tQ({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:c,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:s,outputShapes:a},i);for(let d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach((e=>e.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function sQ(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];{const e=t.inboundNodes[n];if(0===e.inboundLayers.length)return e.inputTensors;{const t=[];for(let n=0;n<e.inboundLayers.length;n++){const r=sQ(e.inputTensors[n],e.inboundLayers[n],e.nodeIndices[n]);for(const e of r)-1===t.indexOf(e)&&t.push(e)}return t}}}class aQ extends rQ{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:LX("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new dX("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new dX("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new dX("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];const r=new ZY(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new tQ({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new dX(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}aQ.className="InputLayer",fB(aQ);class iQ{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof iQ)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(null==e)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,n){if(null!=this.id2Value[e.id])throw new dX(`Duplicate key: name=${e.name}, id=${e.id}`);return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return Jz(t,e.dtype)}catch(Cpe){throw new dX(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof ZY){if(null==this.id2Value[e.id])throw new dX(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}{const t=this.name2Id[e];if(null==t)throw new dX(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof ZY){if(null==this.id2Value[e.id])throw new dX(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}{const t=this.name2Id[e];if(null==t)throw new dX(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&GP(this.id2Mask)}}const oQ=new fX,lQ=new fX;function uQ(e,t,n,r){const s=null!=n&&n.training,a=Array.isArray(e),i=a?e:[e],o=i.map((e=>e.name)),l=[],u=t.names();for(const f of o)-1!==u.indexOf(f)?l.push(t.getValue(f)):l.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const c=o.join(",")+"|"+t.names().sort().join(",");let d,h=oQ.get(c);if(null==h){const e=function(e,t){hO(null!=e&&e.length>0,(()=>"Expected at least one fetch, got none"));let n=[],r={};if(1===e.length){const s=dQ(e[0],t);n=s.sorted,r=s.recipientMap}else{const s=new Set;for(const a of e){const{sorted:e,recipientMap:i}=dQ(a,t);for(const t of e)s.has(t.name)||(n.push(t),s.add(t.name));for(const t in i)null==r[t]&&(r[t]=new Set),i[t].forEach((e=>r[t].add(e)))}}return{sorted:n,recipientCounts:cQ(r)}}(i,t);h=e.sorted,d=e.recipientCounts,oQ.put(c,h),lQ.put(c,d)}d={},s||Object.assign(d,lQ.get(c));const p=new iQ(t);for(let f=0;f<h.length;++f){if(null!=r){const e=VP().numTensors;e>r.maxNumTensors&&(r.maxNumTensors=e),e<r.minNumTensors&&(r.minNumTensors=e)}const e=h[f],a=e.sourceLayer;if(a instanceof aQ)continue;const i=[],u=[],c=[];let m=!1;for(const n of e.inputs){const e=p.getValue(n),r=p.getMask(n);i.push(e),u.push(r),null!=r&&(m=!0),s||(d[n.name]--,0!==d[n.name]||t.hasKey(n)||-1!==o.indexOf(n.name)||e.isDisposed||!0===n.sourceLayer.stateful||c.push(e))}m&&((n=n||{}).mask=u[0]);const g=bX(a.apply(i,n));let y=null;a.supportsMasking&&(y=a.computeMask(i,u));const v=hQ(e),b=Array.isArray(v)?v:[v];for(let t=0;t<b.length;++t){p.hasKey(b[t])||p.add(b[t],g[t],Array.isArray(y)?y[0]:y);const e=o.indexOf(b[t].name);-1!==e&&(l[e]=g[t])}s||GP(c)}return p.disposeMasks(),a?l:l[0]}function cQ(e){const t={};for(const n in e)t[n]=e[n].size;return t}function dQ(e,t){const n=new Set,r=[],s={};for(const o of t.names())n.add(o);const a=[],i=[];for(a.push(e);a.length>0;){const e=a[a.length-1];if(n.has(e.name)){a.pop();continue}const t=i[i.length-1]===a.length-1;if(0===e.inputs.length||t)a.pop(),r.push(e),n.add(e.name),t&&i.pop();else{i.push(a.length-1);for(const t of e.inputs)null==s[t.name]&&(s[t.name]=new Set),s[t.name].add(e.name),n.has(t.name)||a.push(t)}}return{sorted:r,recipientMap:s}}function hQ(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(const r of e.sourceLayer.inboundNodes[t].outputTensors)if(r.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}function pQ(e,t){return WP((()=>aB(JU(sB(e,e),t,!0))))}HO().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(()=>100),(function(e){null!=oQ&&oQ.setMaxEntries(e),null!=lQ&&lQ.setMaxEntries(e)}));class fQ extends hB{getConfig(){return{}}}class mQ extends fQ{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return WP((()=>{const t=pQ(e,this.axis),n=pU(t,0,this.maxValue);return sB(e,rB(n,tB(sY(),t)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}mQ.className="MaxNorm",fB(mQ);class gQ extends fQ{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return WP((()=>rB(e,tB(sY(),pQ(e,this.axis)))))}getConfig(){return{axis:this.axis}}}gQ.className="UnitNorm",fB(gQ);class yQ extends fQ{apply(e){return kW(e)}}yQ.className="NonNeg",fB(yQ);class vQ extends fQ{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return WP((()=>{const t=pQ(e,this.axis),n=tB(sB(this.rate,pU(t,this.minValue,this.maxValue)),sB(1-this.rate,t));return sB(e,rB(n,tB(sY(),t)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}vQ.className="MinMaxNorm",fB(vQ);const bQ={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function xQ(e){return SX(e)}function wQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return CX(e,pB.getMap().classNameMap,t,"constraint")}function kQ(e){if(null==e)return null;if("string"===typeof e){return wQ({className:e in bQ?bQ[e]:e,config:{}})}return e instanceof fQ?e:wQ(e)}async function SQ(e){if(null==e)return;const t=[],n=[],r=[];for(const s in e){const a=e[s];if("number"!==typeof a){const e=a;t.push(e.data()),n.push(s),r.push(e)}}if(t.length>0){const s=await Promise.all(t);for(let t=0;t<s.length;++t)e[n[t]]=s[t][0];GP(r)}}function IQ(e){if(null!=e)for(const t in e){const n=e[t];"number"!==typeof n&&n.dispose()}}var CQ,TQ;(TQ=CQ||(CQ={}))[TQ.SILENT=0]="SILENT",TQ[TQ.VERBOSE=1]="VERBOSE";class NQ{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class EQ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class AQ extends NQ{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});const n=null==t.size?0:t.size;this.seen+=n;for(const r in t){const e=t[r];if("number"===typeof e)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+e*n;else{let t;r in this.totals?t=this.totals[r]:this.totals[r]=0;const s=WP((()=>tB(this.totals[r],sB(e,n))));this.totals[r]=s,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(const n of this.params.metrics)null!=this.totals[n]&&("number"===typeof this.totals[n]?t[n]=this.totals[n]/this.seen:WP((()=>{const e=sB(rB(1,this.seen),this.totals[n]);t[n]=e,this.totals[n].dispose(),HP(t[n])})))}}class RQ extends NQ{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){null==t&&(t={}),this.epoch.push(e);for(const n in t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){const e=[],t=[],n=[];for(const s in this.history){const r=this.history[s];for(let a=0;a<r.length;++a)if("number"!==typeof r[a]){const i=r[a];e.push(i.data()),t.push(s),n.push(a)}}const r=await Promise.all(e);for(let s=0;s<r.length;++s){this.history[t[s]][n[s]].dispose(),this.history[t[s]][n[s]]=r[s][0]}}}class _Q extends NQ{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||FH,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");AO(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let r,s=null!=n?n():ML();return function(){const a=null!=n?n():ML();return a-s<t||(s=a,r=e(...arguments)),r}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){const r=[];null!=this.yield&&(await SQ(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await SQ(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const n=[];null!=this.epochEnd&&(await SQ(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await SQ(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const n=[];null!=this.batchEnd&&(await SQ(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):AO(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await SQ(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await SQ(e),await this.trainEnd(e))}}function $Q(e,t){if(null==e&&(e={}),e instanceof NQ)return[e];if(Array.isArray(e)&&e[0]instanceof NQ)return e;return bX(e).map((e=>new _Q(e,t)))}class OQ{constructor(){}static registerCallbackConstructor(e,t){hO(e>=0&&Number.isInteger(e),(()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`)),OQ.checkForDuplicate(t),null==OQ.constructors[e]&&(OQ.constructors[e]=[]),OQ.constructors[e].push(t)}static checkForDuplicate(e){for(const t in OQ.constructors){OQ.constructors[+t].forEach((t=>{if(t===e)throw new dX("Duplicate callback constructor.")}))}}static clear(){OQ.constructors={}}static createCallbacks(e){const t=[];for(const n in OQ.constructors){const r=+n;e>=r&&t.push(...OQ.constructors[r])}return t.map((e=>new e))}}function DQ(e,t,n,r,s,a,i,o,l){const u=new RQ,c=[new AQ,...OQ.createCallbacks(t)];null!=e&&c.push(...e),c.push(u);const d=new EQ(c);return d.setParams({epochs:n,initialEpoch:r,samples:s,steps:a,batchSize:i,verbose:t,doValidation:o,metrics:l}),{callbackList:d,history:u}}function MQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return CX(e,pB.getMap().classNameMap,t,"layer",n)}function FQ(e,t){return WP((()=>{"float32"!==e.dtype&&(e=Jz(e,"float32"));const n=JU(gY(e),t,!0),r=yB(n.shape,sY()),s=aB(TB(n,r));return rB(e,s)}))}function LQ(e,t){return WP((()=>LV(gY(xB(t,e)),-1)))}function PQ(e,t){return WP((()=>LV(kB(xB(t,e)),-1)))}function zQ(e,t){return WP((()=>{const n=xB(e,t),r=pU(kB(e),sY(),Number.MAX_VALUE),s=kB(rB(n,r));return sB(100,LV(s,-1))}))}function BQ(e,t){return WP((()=>{const n=pU(t,sY(),Number.MAX_VALUE),r=xV(tB(1,n)),s=pU(e,sY(),Number.MAX_VALUE),a=xV(tB(1,s));return LV(gY(xB(r,a)),-1)}))}function jQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return WP((()=>{if(n)t=jW(t);else{const e=JU(t,t.shape.length-1,!0);t=rB(t,e)}return t=pU(t,sY(),1-sY()),kV(JU(sB(Jz(e,"float32"),xV(t)),t.shape.length-1))}))}function UQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return WP((()=>{const r=Jz(oV(function(e){const t=[ZX(e.shape)];return Kj(e,t)}(e)),"int32"),s=(t=pU(t,sY(),1-sY())).shape;return jQ(Kj(KV(r,s[s.length-1]),s),t,n)}))}function VQ(e,t){return WP((()=>{let n;return n=pU(t,sY(),1-sY()),n=xV(rB(n,xB(1,n))),LV(function(e,t){if(!gO(e.shape,t.shape))throw new dX(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return WP((()=>{const n=kW(t),r=kV(kB(t));return tB(xB(n,sB(t,e)),wV(nV(r)))}))}(e,n),-1)}))}function WQ(e,t){return WP((()=>{const n=pU(e,sY(),1),r=pU(t,sY(),1);return JU(sB(e,xV(rB(n,r))),-1)}))}function GQ(e,t){return WP((()=>{const n=FQ(e,-1),r=FQ(t,-1),s=sB(n,r);return kV(JU(s,-1))}))}OQ.constructors={};const HQ={meanSquaredError:LQ,meanAbsoluteError:PQ,meanAbsolutePercentageError:zQ,meanSquaredLogarithmicError:BQ,squaredHinge:function(e,t){return WP((()=>{const n=TB(0,xB(1,sB(e,t)));return LV(gY(n),-1)}))},hinge:function(e,t){return WP((()=>{const n=TB(0,xB(1,sB(e,t)));return LV(n,-1)}))},categoricalHinge:function(e,t){return WP((()=>{const n=JU(sB(e,t),-1),r=YU(sB(xB(1,e),t),-1);return TB(0,tB(1,xB(r,n)))}))},logcosh:function(e,t){return WP((()=>{const n=Math.log(2),r=xB(t,e),s=xB(tB(r,SV(sB(-2,r))),n);return LV(s,-1)}))},categoricalCrossentropy:jQ,sparseCategoricalCrossentropy:UQ,binaryCrossentropy:VQ,kullbackLeiblerDivergence:WQ,poisson:function(e,t){return WP((()=>{const n=xV(tB(sY(),t));return LV(xB(t,sB(e,n)),-1)}))},cosineProximity:GQ};function qQ(e){if("string"===typeof e){if(e in HQ)return HQ[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new dX(t)}return e}function KQ(e,t){return WP((()=>{const n=sB(.5,XV(t)),r=aY(uV(t,n),e.dtype);return LV(DU(e,r),-1)}))}function XQ(e,t){return WP((()=>aY(DU(Tj(e,-1),Tj(t,-1)),"float32")))}function YQ(e,t){return WP((()=>Jz(JU(NV(DU(e,1),DU(t,1))),"float32")))}function QQ(e,t){return VQ(e,t)}function JQ(e,t){return e.rank===t.rank&&(e=KW(e,[e.rank-1])),(t=Tj(t,-1)).dtype!==e.dtype&&(t=Jz(t,e.dtype)),Jz(DU(e,t),"float32")}const ZQ=jQ,eJ=UQ,tJ={binaryAccuracy:KQ,categoricalAccuracy:XQ,precision:function(e,t){return WP((()=>{const n=YQ(e,t),r=function(e,t){return WP((()=>Jz(JU(NV(DU(e,0),DU(t,1))),"float32")))}(e,t),s=tB(n,r);return Jz(MU(uV(s,0),rB(n,s),0),"float32")}))},categoricalCrossentropy:ZQ,sparseCategoricalCrossentropy:eJ,mse:LQ,MSE:LQ,mae:PQ,MAE:PQ,mape:zQ,MAPE:zQ,cosine:GQ};function nJ(e){if("string"===typeof e&&e in tJ)return tJ[e];if("string"!==typeof e&&null!=e)return e;throw new dX(`Unknown metric ${e}`)}function rJ(e){if(gX(null!==e,`Unknown LossOrMetricFn ${e}`),"string"===typeof e)return e;{let t;for(const n of Object.keys(HQ))if(HQ[n]===e){t=n;break}if(void 0!==t)return t;for(const n of Object.keys(tJ))if(tJ[n]===e){t=n;break}return void 0!==t?t:e.name}}const sJ=1048576;function aJ(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!iJ(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(e);n.length>sJ&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function iJ(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t){if("string"!==typeof n)return!1;if(!iJ(e[n]))return!1}return!0}if(Array.isArray(e)){for(const t of e)if(!iJ(t))return!1;return!0}return!1}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function oJ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log;const s=function(e){let t=!0;const n=[],r=[];for(const s in e.nodesByDepth)n.push(e.nodesByDepth[s]);for(const s of n){if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push(...s)}if(t)for(const s of e.layers){let e=!1;for(const n of s.inboundNodes)if(-1!==r.indexOf(n)){if(e){t=!1;break}e=!0}if(!t)break}return t}(e),a=["Layer (type)","Input Shape","Output shape","Param #"];let i;if(s?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((e=>Math.floor(t*e)))),!s){a.push("Receives inputs"),i=[];for(const t in e.nodesByDepth)i.push(...e.nodesByDepth[t])}r("_".repeat(t)),lJ(a,n,r),r("=".repeat(t));const o=e.layers;for(let c=0;c<o.length;++c)s?uJ(o[c],n,r):cJ(o[c],n,i,r),r((c===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const l=function(e){let t;t=null!=e.collectedTrainableWeights?qY(e.collectedTrainableWeights):qY(e.trainableWeights);return t}(e),u=qY(e.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(t))}function lJ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="";for(let s=0;s<e.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=e[s],r=r.slice(0,t[s]),r+=" ".repeat(t[s]-r.length);n(r)}function uJ(e,t,n){let r,s;try{s=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(Cpe){s="multiple"}try{r=JSON.stringify(e.outputShape)}catch(Cpe){r="multiple"}lJ([`${e.name} (${e.getClassName()})`,s,r,e.countParams().toString()],t,n)}function cJ(e,t,n,r){let s,a;try{a=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(Cpe){a="multiple"}try{s=JSON.stringify(e.outputShape)}catch(Cpe){s="multiple"}const i=[];for(const c of e.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(c)))for(let e=0;e<c.inboundLayers.length;++e){const t=c.inboundLayers[e].name,n=c.nodeIndices[e],r=c.tensorIndices[e];i.push(`${t}[${n}][${r}]`)}const o=e.name,l=e.getClassName(),u=0===i.length?"":i[0];lJ([`${o} (${l})`,a,s,e.countParams().toString(),u],t,r);for(let c=1;c<i.length;++c)lJ(["","","","",i[c]],t,r)}function dJ(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function hJ(e,t){if(null===e)return null;if("string"===typeof e)return wX(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let s=0;s<r;++s){const r=e[s];dJ(t,s,r)?n.push(r):n.push(hJ(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n];if("name"===n&&"string"===typeof r)t[n]=r;else{const e=wX(n);t[e]=hJ(r,e)}}return t}}function pJ(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return xX(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let s=0;s<r;++s){const r=e[s];dJ(t,s,r)?n.push(r):n.push(pJ(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n],s=xX(n);t[s]="name"!==n&&"className"!==n||"string"!==typeof r?pJ(r,n):r}return t}}const fJ="4.22.0";class mJ extends rQ{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,null==this.name){const e=this.getClassName().toLowerCase();this.name=LX(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],NX(this.inputs).length!==this.inputs.length)throw new dX(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map((e=>e.name))}`);NX(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map((e=>e.name))}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const e=y.sourceLayer,t=y.nodeIndex,n=y.tensorIndex;this.outputLayers.push(e),this.outputLayersNodeIndices.push(t),this.outputLayersTensorIndices.push(n)}for(const y of this.inputs){const e=y.sourceLayer,t=y.nodeIndex,n=y.tensorIndex;gX(0===t,"input layer has >1 nodes"),gX(0===n,"input layer has >1 tensors"),this.inputLayers.push(e),this.inputLayersNodeIndices.push(t),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const t=this.inputLayers[y];if(!(t instanceof aQ))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${y} (0-based) originates from layer type ${t.getClassName()}.`);this.inputNames.push(t.name),this.feedInputShapes.push(t.batchInputShape),this.feedInputNames.push(t.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map((e=>e.shape)),this.internalOutputShapes=this.outputs.map((e=>e.shape));const t={},n={},r={},s={},a={},i=[],o=(e,t,n,r,s,l)=>{null!=r&&null!=s&&null!=l||(r=e.sourceLayer,s=e.nodeIndex,l=e.tensorIndex);const u=r.inboundNodes[s];if(-1!==n.indexOf(u))throw new cX(`The tensor ${e.name} at layer "${r.name}" is part of a cycle.`);if(-1!==t.indexOf(u))return;this.containerNodes.add(mJ.nodeKey(r,s)),r.id in a||(a[r.id]=Object.keys(a).length),-1===n.indexOf(u)&&n.push(u);const c=u.inboundLayers.length;for(let a=0;a<c;a++){const e=u.inputTensors[a],r=u.inboundLayers[a],s=u.nodeIndices[a],i=u.tensorIndices[a];o(e,t,n,r,s,i)}for(t.push(u);n.indexOf(u)>=0;)n.splice(n.indexOf(u),1);i.push(u)},l=[],u=[];for(const y of this.outputs)o(y,l,u);const c=i.slice().reverse();for(const y of c){n[y.id]=y,y.id in t||(t[y.id]=0);let e=t[y.id];const a=null==r[y.outboundLayer.id]?0:r[y.outboundLayer.id];e=Math.max(e,a),r[y.outboundLayer.id]=e,s[y.outboundLayer.id]=y.outboundLayer,t[y.id]=e;for(let r=0;r<y.inboundLayers.length;r++){const s=y.inboundLayers[r],a=y.nodeIndices[r],i=s.inboundNodes[a],o=null==t[i.id]?0:t[i.id];t[i.id]=Math.max(e+1,o),n[i.id]=i}}const d={};for(const y in t){const e=t[y];e in d||(d[e]=[]),d[e].push(n[y])}const h={};for(const y in r){const e=r[y];e in h||(h[e]=[]),h[e].push(s[y])}let p=Object.keys(h).map((e=>parseInt(e,10))).sort(TX);this.layers=[];for(const y of p){const e=h[y];e.sort(((e,t)=>{const n=a[e.id],r=a[t.id];return n<r?-1:n>r?1:0}));for(const t of e)t instanceof mJ&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=h,p=Object.keys(d).map((e=>parseInt(e,10))).sort(TX);const f=this.inputs.slice(),m=[];for(const y of p)for(const e of d[y]){const t=e.outboundLayer;if(null!=t){for(const n of e.inputTensors)if(-1===f.indexOf(n))throw new cX(`Graph disconnected: cannot obtain value for tensor ${n} at layer "${t.name}". The following previous layers were accessed without issue: ${m}`);for(const t of e.outputTensors)f.push(t);m.push(t.name)}}this.nodesByDepth=d;const g=this.layers.map((e=>e.name));for(const y of g){const e=g.filter((e=>e===y)).length;if(1!==e)throw new cX(`The name "${y}" is used ${e} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new tQ({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((e=>null)),outputMasks:this.outputs.map((e=>null)),inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs.map((e=>e.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach((t=>{t._trainableWeights.forEach((t=>t.trainable=e))})),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new dX("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={};let r=0;const s=(e=>{const t=Object.keys(e);if(0===t.length)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(e);s&&this.parseWeights(e);for(const i of this.layers)for(const[e,t]of i.weights.entries()){const a=s?`${t.name.split("/").slice(0,-1).join("/")+"/"}${e}`:t.originalName;if(null!=n[a])throw new dX(`Duplicate weight name: ${a}`);n[a]=t,r++}const a=[];for(const i in e){let r=i;if(null==n[i]){const e=i.split("/");r=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[r])a.push([n[r],e[i]]);else if(t)throw new dX(`Provided weight data has no target variable: ${i}`);delete n[r]}if(t){const e=[];for(const t in n)e.push(t);if(e.length>0)throw new dX(`${e.length} of ${r} weights are not set: ${e}`)}QY(a)}parseWeights(e){for(const t in Object.keys(e)){const n=t.split("/"),r=["vars","layer_checkpoint_dependencies"],s=n.map((e=>e.startsWith("_")?e.slice(1):e)).filter((e=>!r.includes(e))).join("/");s!==t&&(e[s]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${fJ}`,t.backend="TensorFlow.js",t}toJSON(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=pJ(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return WP((()=>{e=bX(e);const n=new iQ;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return uQ(this.outputs,n,t)}))}computeMask(e,t){return WP((()=>{let n;return e=bX(e),n=null==t?mX(null,e.length):bX(t),this.runInternalGraph(e,n)[1]}))}computeOutputShape(e){const t=WY(e);if(t.length!==this.inputLayers.length)throw new dX(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let i=0;i<t.length;i++){const e=this.inputLayers[i],r=t[i];n[e.name+"_0_0"]=r}const r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(TX);if(r.length>1)for(const i of r){const e=this.nodesByDepth[i];for(const t of e){const e=t.outboundLayer;if(-1!==this.inputLayers.map((e=>e.id)).indexOf(e.id))continue;const r=[];for(let i=0;i<t.inboundLayers.length;i++){const e=t.inboundLayers[i],s=t.nodeIndices[i],a=t.tensorIndices[i],o=n[`${e.name}_${s}_${a}`];r.push(o)}const s=WY(e.computeOutputShape(vX(r))),a=e.inboundNodes.indexOf(t);for(let t=0;t<s.length;t++){n[`${e.name}_${a}_${t}`]=s[t]}}}const s=[],a=[];for(let i=0;i<this.outputLayers.length;i++){const e=this.outputLayers[i],t=this.outputLayersNodeIndices[i],n=this.outputLayersTensorIndices[i],r=`${e.name}_${t}_${n}`;a.push(r)}for(let i=0;i<a.length;i++){const e=a[i];gX(e in n),s.push(n[e])}return vX(s)}runInternalGraph(e,t){null==t&&(t=mX(null,e.length));const n={};for(let o=0;o<this.inputs.length;++o){const r=this.inputs[o],s=e[o],a=t[o];n[r.id]=[s,a]}const r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(TX);for(const o of r){const e=this.nodesByDepth[o];for(const t of e){const e=t.outboundLayer,r=t.inputTensors,s=t.outputTensors,a=new Array;for(const t of r)t.id in n&&a.push(n[t.id]);if(a.length===r.length){let r,i,o,l,u={};if(null!=t.callArgs&&(u=t.callArgs),1===a.length){const[t,n]=a[0];null==u.mask&&(u.mask=n),o=bX(e.call(t,u)),l=bX(e.computeMask(t,n)),r=[t],i=[n]}else r=a.map((e=>e[0])),i=a.map((e=>e[1])),null==u.mask&&(u.mask=i),o=bX(e.call(r,u)),l=bX(e.computeMask(r,i));if(e.activityRegularizer)throw new hX("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<s.length;++e){const t=s[e],r=o[e],a=l[e];n[t.id]=[r,a]}}}}const s=[],a=[],i=[];for(const o of this.outputs){gX(o.id in n,`Could not compute output ${o.name} : ${o.id}`);const[e,t]=n[o.id];i.push(e.shape),s.push(e),a.push(t)}return[s,a,i]}buildNodeConversionMap(e){const t={};let n;for(const r of this.layers){n=r instanceof mJ?1:0;for(let e=0;e<r.inboundNodes.length;e++){const s=mJ.nodeKey(r,e);this.containerNodes.has(s)&&(t[s]=n,n+=1)}}return t}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new dX("Provide either a layer name or layer index");if("number"===typeof e)return this.findLayer(e);for(const n of this.layers)if(n.name===e)return n;throw new dX(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new dX(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return WP((()=>{const e=[];for(const t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){const r=mJ.nodeKey(t,n);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e}))}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(const a of this.layers){const e=a.getClassName(),r=a.getConfig(),s=[];for(let n=0;n<a.inboundNodes.length;n++){const e=a.inboundNodes[n],r=mJ.nodeKey(a,n);let i={};if(this.containerNodes.has(r)){if(e.callArgs)try{JSON.stringify(e.callArgs),i=e.callArgs}catch(Cpe){console.warn(`Layer ${a.name} was passed non-serializable keyword arguments: ${e.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),i={}}if(e.inboundLayers.length>0){const n=[];for(let r=0;r<e.inboundLayers.length;r++){const s=e.inboundLayers[r],a=e.nodeIndices[r],o=e.tensorIndices[r];let l=t[mJ.nodeKey(s,a)];null==l&&(l=0),n.push([s.name,l,o,i])}s.push(n)}}}const i={};i.name=a.name,i.className=e,i.config=r,i.inboundNodes=s,n.push(i)}e.layers=n;const r=[];for(let a=0;a<this.inputLayers.length;a++){const e=this.inputLayers[a],n=this.inputLayersNodeIndices[a],s=mJ.nodeKey(e,n);if(!this.containerNodes.has(s))continue;let i=t[s];null!==i&&void 0!==i||(i=0);const o=this.inputLayersTensorIndices[a];r.push([e.name,i,o])}e.inputLayers=r;const s=[];for(let a=0;a<this.outputLayers.length;a++){const e=this.outputLayers[a],n=this.outputLayersNodeIndices[a],r=mJ.nodeKey(e,n);if(!this.containerNodes.has(r))continue;let i=t[r];null!==i&&void 0!==i||(i=0);const o=this.outputLayersTensorIndices[a];s.push([e.name,i,o])}return e.outputLayers=s,e}static fromConfig(e,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={},s={};function a(e,t){e.name in s?s[e.name].push(t):s[e.name]=[t]}function i(e,t){const n=[];let s;for(const i of t){const o=i[0],l=i[1],u=i[2];if(s=null==i[3]?{}:i[3],!(o in r))return void a(e,t);const c=r[o];if(c.inboundNodes.length<=l)return void a(e,t);const d=c.inboundNodes[l];n.push(d.outputTensors[u])}n.length>0&&e.apply(vX(n),s)}function o(e){const s=e.name,i=MQ(e,null!=t.customObjects?t.customObjects:{});i.setFastWeightInitDuringBuild(n),r[s]=i;e.inboundNodes.forEach((e=>{if(!(e instanceof Array))throw new dX(`Corrupted configuration, expected array for nodeData: ${e}`);a(i,e)}))}const l=t.name,u=t.layers;for(const f of u)o(f);for(;!EX(s);)for(const e of u){const t=r[e.name];if(t.name in s){const e=s[t.name];delete s[t.name];for(const n of e)i(t,n)}}const c=[],d=[],h=t.inputLayers;for(const f of h){const e=f[0],t=f[1],n=f[2];gX(e in r);const s=r[e].inboundNodes[t].outputTensors;c.push(s[n])}const p=t.outputLayers;for(const f of p){const e=f[0],t=f[1],n=f[2];gX(e in r);const s=r[e].inboundNodes[t].outputTensors;d.push(s[n])}return new e({inputs:c,outputs:d,name:l})}get stateful(){if(this._stateful)throw new dX("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){WP((()=>{this.layers.forEach((e=>{e.stateful&&e.resetStates()}))}))}}function gJ(e,t,n){const r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>null));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){const n=[];return t.forEach((t=>{t in e?n.push(e[t]):n.push(null)})),n}throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function yJ(e,t){return gJ(e,t,"classWeight")}async function vJ(e,t,n,r){if(null!=t||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const t=WP((()=>{if(1===e.shape.length)return Zz(e);if(2===e.shape.length){if(e.shape[1]>1){return Tj(e,1)}if(1===e.shape[1])return Kj(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)})),r=Array.from(await t.data());GP(t);const s=[];return r.forEach((e=>{if(null==n[e])throw new Error(`classWeight must contain all classes in the training data. The class ${e} exists in the data but not in classWeight`);s.push(n[e])})),ZW(s,"float32")}return null}function bJ(e,t){return sB(e,t)}function xJ(e,t){let n,r;const s=t;n=s.xs,r=s.ys,hO(null!=n&&null!=r,(()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`));const a=wJ("input",e.inputNames,n),i=wJ("output",e.outputNames,r),o=a[0].shape[0];hO(a.length===e.inputs.length,(()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`)),hO(i.length===e.outputs.length,(()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`));for(let l=0;l<a.length;l++)hO(a[l].shape[0]===o,(()=>`Batch size mismatch: input ${e.inputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`));for(let l=0;l<i.length;l++)hO(i[l].shape[0]===o,(()=>`Batch size mismatch: output ${e.outputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`));return{xs:a,ys:i}}function wJ(e,t,n){if(n instanceof JL)return[n];if(Array.isArray(n))return hO(n.length===t.length,(()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`)),n;{const r=[];for(const s of t){if(null==n[s])throw new dX(`The feature data generated by the dataset lacks the required ${e} key '${s}'.`);r.push(n[s])}return r}}async function kJ(e,t,n){const r=null!=n.batchesPerEpoch;if(hO(null!=e.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),hO(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),hO(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`)),hO(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`)),hO(null==n.validationSplit,(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const s=null!=n.validationData;let a,i;if(s)if(SJ(n.validationData))hO(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`));else{const e=function(e){if(3===e.length)throw new hX("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);a=e.xs,i=e.ys}const o=e.makeTrainFunction(),l=e.getDedupedMetricsNames();let u;u=s?l.slice().concat(l.map((e=>"val_"+e))):l.slice();const c=$Q(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,{callbackList:h,history:p}=DQ(c,d,n.epochs,null,null,function(e,t){let n=null;null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size);return n}(t,n),null,s,u);h.setModel(e),e.history=p,await h.onTrainBegin(),e.stopTraining_=!1;let f=null==n.initialEpoch?0:n.initialEpoch,m=await t.iterator();for(;f<n.epochs;){const u={};await h.onEpochBegin(f);let c=0,d=0;for(r||(m=await t.iterator());!r||c<n.batchesPerEpoch;){const t=await m.next();if(r&&t.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${c} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, `+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset.");break}if(null!=t.value){const{xs:r,ys:s}=xJ(e,t.value),a={};a.batch=d,a.size=r[0].shape[0],await h.onBatchBegin(d,a);const i=[];if(null!=n.classWeight){const t=yJ(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)i.push(await vJ(s[e],null,t[e]))}const u=r.concat(s).concat(i),p=o(u);GP(u);for(let e=0;e<l.length;++e){const t=l[e],n=p[e];a[t]=n,HP(n)}await h.onBatchEnd(d,a),IQ(a),d++,c++}if(r?c>=n.batchesPerEpoch:t.done){if(s){let t;t=SJ(n.validationData)?bX(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):bX(e.evaluate(a,i,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)u[`val_${e.metricsNames[n]}`]=t[n]}break}if(e.stopTraining_)break}if(await h.onEpochEnd(f,u),f++,e.stopTraining_)break}return await h.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function SJ(e){return"function"===typeof e.iterator}function IJ(e){hO(e>0&&Number.isInteger(e),(()=>`batchSize is required to be a positive integer, but got ${e}`))}function CJ(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((e=>oY(e,t,n-t))):oY(e,t,n-t)}function TJ(e,t){return WP((()=>null==e?null:Array.isArray(e)?e.map((e=>TJ(e,t))):mY(e,"int32"===t.dtype?t:Jz(t,"int32"))))}function NJ(e,t){const n=[];let r=0,s=null;for(;r<e;)s=r+t,s>=e&&(s=e),n.push([r,s]),r=s;return n}function EJ(e){const t=[];e instanceof JL&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(1===r.rank)t.push(iY(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function AJ(e,t){if(null==e)return;const n=[];if(t instanceof JL)n.push(t.id);else if(Array.isArray(t))t.forEach((e=>n.push(e.id)));else if(null!=t)for(const s in t){const e=t[s];n.push(e.id)}const r=[];if(e instanceof JL)-1===n.indexOf(e.id)&&r.push(e);else if(Array.isArray(e))e.forEach((e=>{-1===n.indexOf(e.id)&&r.push(e)}));else if(null!=e)for(const s in e){const t=e[s];-1===n.indexOf(t.id)&&r.push(t)}r.forEach((e=>{e.isDisposed||e.dispose()}))}function RJ(e){return Array.isArray(e)}function _J(e){return!function(e){return e instanceof JL}(e)&&!RJ(e)}function $J(e,t,n){let r,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){let t=!1;if(RJ(e)&&e.length>0)t=!0;else if(_J(e)){for(const n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new dX(`Error when checking model ${a} expected no data, but got ${e}`)}return[]}if(null==e)return t.map((e=>null));if(_J(e)){r=[];for(const n of t){if(null==e[n])throw new dX(`No data provided for "${n}". Need data for each key in: ${t}`);r.push(e[n])}}else if(RJ(e)){if(e.length!==t.length)throw new dX(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);r=e}else{if(t.length>1)throw new dX(`The model ${a} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);r=[e]}if(r=EJ(r),null!=n)for(let i=0;i<t.length;++i){if(null==n[i])continue;const e=r[i];if(e.shape.length!==n[i].length)throw new dX(`Error when checking ${a}: expected ${t[i]} to have ${n[i].length} dimension(s). but got array with shape ${e.shape}`);for(let t=0;t<n[i].length;++t){if(0===t&&!s)continue;const r=e.shape[t],o=n[i][t];if(null!=o&&o>=0&&r!==o)throw new dX(`${a} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${a} received an input with ${e.shape[0]} examples, each with shape [${e.shape.slice(1,e.shape.length)}] (tensor shape [${e.shape}])`)}}return r}function OJ(e,t,n){let r,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new dX(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);r=e}else{if(t.length>1)throw new dX(`The model expects ${t.length} ${a} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);r=[e]}if(null!=n)for(let i=0;i<t.length;++i){if(null==n[i])continue;const e=r[i];if(e.shape.length!==n[i].length)throw new dX(`Error when checking ${a}: expected ${t[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(e.shape)}`);for(let r=0;r<n[i].length;++r){if(0===r&&!s)continue;const o=e.shape[r],l=n[i][r];if(null!=l&&l!==o)throw new dX(`Error when checking ${a}: expected ${t[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(e.shape)}.`)}}}class DJ extends mJ{constructor(e){super(e),this.isTraining=!1}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new dX("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");oJ(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){const t={Adagrad:()=>DH.adagrad(.01),Adadelta:()=>DH.adadelta(1,.95,sY()),Adam:()=>DH.adam(.001,.9,.999,sY()),Adamax:()=>DH.adamax(.002,.9,.999,sY(),0),RMSProp:()=>DH.rmsprop(.001,.9,0,sY()),SGD:()=>DH.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new dX(`Unknown Optimizer ${e}`)}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof mB))throw new dX("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new dX(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);const n=e.loss;t=n.map((e=>qQ(e)))}else{const n=qQ(e.loss);this.outputs.forEach((e=>{t.push(n)}))}else{e.loss=e.loss;for(const t in e.loss)if(-1===this.outputNames.indexOf(t))throw new dX(`Unknown entry in loss dictionary: "${t}". Only expected the following keys: ${this.outputNames}`);for(const n of this.outputNames)null==e.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),t.push(qQ(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const e=this.internalOutputShapes[a],t=this.outputNames[a];this.feedOutputNames.push(t),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[a])}const n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],KX("loss",(()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;const t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}}));const r=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>[]));let n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);n=e}if(Array.isArray(n))return t.map((e=>n));{const e=[];for(const r of t){let t=n.hasOwnProperty(r)?n[r]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),s=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};KX("metric",(()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;(t=>{let n,r,a;for(const i of t){if("string"===typeof i&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(i)){const t=this.internalOutputShapes[e];let s;1===t[t.length-1]||this.lossFunctions[e]===VQ?-1!==["accuracy","acc"].indexOf(i)?r=KQ:-1!==["crossentropy","ce"].indexOf(i)&&(r=QQ):this.lossFunctions[e]===UQ?-1!==["accuracy","acc"].indexOf(i)?r=JQ:-1!==["crossentropy","ce"].indexOf(i)&&(r=eJ):-1!==["accuracy","acc"].indexOf(i)?r=XQ:-1!==["crossentropy","ce"].indexOf(i)&&(r=ZQ),-1!==["accuracy","acc"].indexOf(i)?s="acc":-1!==["crossentropy","ce"].indexOf(i)&&(s="ce"),a=r,n=""+s}else{const e=nJ(i);a=e,n=""+rJ(i)}let t;KX(n,(()=>{t=a})),s(e,n,t)}})(r[e])}})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=null==n.batchSize?32:n.batchSize;IJ(r);const s=this.standardizeUserDataXY(e,t,!0,r);try{const e=s[0].concat(s[1]);this.makeTestFunction();const t=this.testFunction;return vX(this.testLoop(t,e,r,n.verbose,n.steps))}finally{AJ(s[0],e),AJ(s[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),async function(e,t,n){const r=null!=(n=n||{}).batches,s=e.testFunction;let a=[];if(n.verbose>0)throw new hX("Verbose mode is not implemented yet.");hO(!r||n.batches>0&&Number.isInteger(n.batches),(()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`));const i="function"===typeof t.next?t:await t.iterator();let o=0,l=0;for(;!r||l<n.batches;){const t=await i.next();if(a=WP((()=>{if(t.value){const{xs:n,ys:r}=xJ(e,t.value),i=n.concat(r),u=WP((()=>s(i)));if(GP(i),0===l)for(let e=0;e<u.length;++e)a.push(uB(0));const c=i[0].shape[0];for(let e=0;e<u.length;++e){const t=u[e],n=a[e];a[e]=WP((()=>tB(a[e],sB(c,t)))),l>0&&GP(n)}GP(u),o+=c,++l}return a})),t.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<a.length;++u){const e=a[u];a[u]=rB(a[u],o),GP(e)}return vX(a)}(this,e,t)}checkNumSamples(e,t,n){let r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new dX(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else{if(null==e)throw new dX(`Either the input data should have a defined shape, or ${s} shoud be specified.`);r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new dX("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(t),r=n?t:[t],s=this.retrieveSymbolicTensors(r),a=new iQ;if(e instanceof JL&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new dX(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let t=0;t<this.inputs.length;++t)a.add(this.inputs[t],e[t])}else for(const o of this.inputs){const t=e[o.name];if(null==t)throw new dX(`No value is provided for the model's input ${o.name}`);a.add(o,t)}const i=uQ(s,a);return n?i:i[0]}retrieveSymbolicTensors(e){const t=mX(null,e.length);let n=e.length;for(const r of this.layers){const s=Array.isArray(r.output)?r.output:[r.output],a=s.map((e=>e.name));for(let r=0;r<e.length;++r){const i=a.indexOf(e[r]);if(-1!==i&&(t[r]=s[i],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw t.forEach(((t,r)=>{null==t&&n.push(e[r])})),new dX(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(n)}`)}return t}predictLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return WP((()=>{const r=this.checkNumSamples(e);if(n)throw new hX("Verbose predictLoop() is not implemented yet.");const s=NJ(r,t),a=this.outputs.map((e=>[]));for(let t=0;t<s.length;++t){WP((()=>{const n=s[t][0],r=s[t][1],a=CJ(e,n,r),i=[];if(Array.isArray(a))for(let e=0;e<a.length;++e)i.push({key:this.inputs[e],value:a[e]});else i.push({key:this.inputs[0],value:a});const o=new iQ(i);return uQ(this.outputs,o)})).forEach(((e,t)=>a[t].push(e)))}return vX(a.map((e=>Qj(e,0))))}))}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=EJ(e);OJ(n,this.inputNames,this.feedInputShapes,!1);try{const e=null==t.batchSize?32:t.batchSize;return IJ(e),this.predictLoop(n,e)}finally{AJ(n,e)}}predictOnBatch(e){OJ(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new cX("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let s=0;s<this.feedOutputShapes.length;++s){const e=this.feedOutputShapes[s];this.feedLossFns[s]===UQ?r.push(e.slice(0,e.length-1).concat([1])):r.push(e)}if(function(e,t){const n=NX(e.map((e=>e.shape[0])));n.sort();const r=NX(t.map((e=>e.shape[0])));if(r.sort(),n.length>1)throw new dX(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map((e=>e.shape)))}`);if(r.length>1)throw new dX(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map((e=>e.shape)))}`);if(n.length>0&&r.length>0&&!gO(n,r))throw new dX(`Input Tensors should have the same number of samples as target Tensors. Found ${n[0]} input sample(s) and ${r[0]} target sample(s).`)}(e=$J(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=$J(t,this.feedOutputNames,r,!1,"target")),function(e,t,n){const r=[LQ,VQ,jQ];for(let s=0;s<e.length;++s){const a=e[s],i=t[s],o=n[s];if(null!=i){if(i===jQ&&1===a.shape[a.shape.length-1])throw new dX(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(i)){const e=a.shape.slice(1),t=o.slice(1);for(let n=0;n<e.length;++n){const r=e[n],s=t[n];if(null!=s&&r!==s)throw new dX(`A target Tensor with shape ${a.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new dX(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${n}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,n,r){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5?arguments[5]:void 0;const[i,o]=this.standardizeUserDataXY(e,t,s,a);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=r){const e=yJ(r,this.outputNames);l=[];for(let t=0;t<e.length;++t)l.push(await vJ(o[t],null,e[t]))}return[i,o,l]}testLoop(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0;return WP((()=>{const a=this.checkNumSamples(t,n,s,"steps"),i=[];if(r>0)throw new hX("Verbose mode is not implemented yet.");if(null!=s)throw new hX("steps mode in testLoop() is not implemented yet");{const r=NJ(a,n),s=ZW(nY(0,a));for(let n=0;n<r.length;++n){const a=r[n][0],o=r[n][1],l=oY(s,a,o-a),u=TJ(t,l),c=e(u);if(0===n)for(let e=0;e<c.length;++e)i.push(uB(0));for(let e=0;e<c.length;++e){const t=c[e];i[e]=tB(i[e],sB(o-a,t))}}for(let e=0;e<i.length;++e)i[e]=rB(i[e],a)}return i}))}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){const r=e[n];let s=r;if(yX(e,r)>1){s+=`_${yX(e.slice(0,n),r)}`}t.push(s)}return t}makeTrainFunction(){return e=>{const t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),a=[],i=this.collectedTrainableWeights.map((e=>e.read()));return[this.optimizer_.minimize((()=>{const e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});const i=new iQ(e),o=uQ(this.outputs,i,{training:!0});let l;for(let n=0;n<this.lossFunctions.length;++n){let e=(0,this.lossFunctions[n])(r[n],o[n]);null!=s[n]&&(e=bJ(e,s[n]));const a=LV(e);t.push(a),l=0===n?e:tB(l,e)}for(let n=0;n<this.metricsTensors.length;++n){let e;if(this.outputs.length>1&&n<this.outputs.length)e=t[n];else{const t=this.metricsTensors[n][0],s=this.metricsTensors[n][1];e=LV(t(r[s],o[s]))}HP(e),a.push(e)}return l=LV(l),this.calculateLosses().forEach((e=>{l=tB(l,e)})),l}),!0,i)].concat(a)}}makeTestFunction(){this.testFunction=e=>WP((()=>{const t=[];let n;const r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let e=0;e<this.inputs.length;++e)a.push({key:this.inputs[e],value:r[e]});const i=new iQ(a),o=uQ(this.outputs,i);for(let e=0;e<this.lossFunctions.length;++e){const r=this.lossFunctions[e],a=LV(r(s[e],o[e]));n=0===e?a:tB(n,a),t.push(n)}for(let e=0;e<this.metricsTensors.length;++e){const n=this.metricsTensors[e][0],r=this.metricsTensors[e][1],a=LV(n(s[r],o[r]));t.push(a)}return t}))}async fit(e,t){let n,r,s,a,i,o,l,u,c,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{const h=null==d.batchSize?32:d.batchSize;IJ(h);const p=!1,f=await this.standardizeUserData(e,t,d.sampleWeight,d.classWeight,p,h);n=f[0],r=f[1],c=f[2];let m,g=!1;if(null!=d.validationData&&d.validationData.length>0){if(g=!0,2!==d.validationData.length)throw 3===d.validationData.length?new hX("validationData including sample weights is not supported yet."):new dX(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${d.validationData} is invalid.`);i=d.validationData[0],o=d.validationData[1];const e=!0,t=await this.standardizeUserData(i,o,null,null,e,h);l=t[0],u=t[1],m=l.concat(u)}else if(null!=d.validationSplit&&d.validationSplit>0&&d.validationSplit<1){g=!0;const e=Math.floor(n[0].shape[0]*(1-d.validationSplit)),t=n[0].shape[0];l=CJ(n,e,t),s=n,n=CJ(n,0,e),u=CJ(r,e,t),a=r,r=CJ(r,0,e),m=l.concat(u)}else null!=d.validationSteps&&(g=!0);const y=n.concat(r).concat(c);this.checkTrainableWeightsConsistency();const v=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let x,w;g?(this.makeTestFunction(),x=this.testFunction,w=b.slice().concat(b.map((e=>"val_"+e)))):(x=null,m=[],w=b.slice());const k=$Q(d.callbacks,d.yieldEvery);return await this.fitLoop(v,y,b,h,d.epochs,d.verbose,k,x,m,d.shuffle,w,d.initialEpoch,null,null)}finally{this.isTraining=!1,AJ(n,e),AJ(r,t),AJ(s,e),AJ(a,t),AJ(l,i),AJ(u,o),null!=c&&GP(c)}}async fitLoop(e,t,n,r,s,a,i,o,l,u,c,d,h,p){null==r&&(r=32),null==s&&(s=1),null==u&&(u=!0),null==d&&(d=0);let f=!1;if(null!=o&&null!=l&&(f=!0),null!=p&&(f=!0,null==h))throw new dX("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(t,r,h,"steps_per_epoch");let g;null!=m&&(g=nY(0,m)),null==a&&(a=1);const{callbackList:y,history:v}=DQ(i,a,s,d,m,h,r,f,c);y.setModel(this),this.history=v,await y.onTrainBegin(),this.stopTraining_=!1;for(let b=d;b<s;++b){await y.onEpochBegin(b);const s={};if(null!=h)throw new hX("stepsPerEpoch mode is not implemented yet.");{if("batch"===u)throw new hX("batch shuffling is not implemneted yet");u&&lO(g);const a=ZW(g),i=NJ(m,r);for(let u=0;u<i.length;++u){const c={};if(await y.onBatchBegin(u,c),WP((()=>{const d=i[u][0],h=i[u][1],p=oY(a,d,h-d);c.batch=u,c.size=h-d;const m=TJ(t,p),g=e(m);for(let e=0;e<n.length;++e){const t=n[e],r=g[e];c[t]=r,HP(r)}if(u===i.length-1&&f){const e=this.testLoop(o,l,r);for(let t=0;t<n.length;++t){const r=n[t],a=e[t];HP(a),s["val_"+r]=a}}})),await y.onBatchEnd(u,c),IQ(c),this.stopTraining_)break}a.dispose()}if(await y.onEpochEnd(b,s),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return kJ(this,e,t)}async trainOnBatch(e,t){const n=await this.standardizeUserData(e,t),r=n[0],s=n[1],a=this.makeTrainFunction()(r.concat(s)),i=[];for(const o of a){const e=await o.data();i.push(e[0])}return GP(a),AJ(n[0],e),AJ(n[1],t),vX(i)}getNamedWeights(e){const t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,s=this.getWeights(n);for(let a=0;a<r.length;++a)n&&!r[a].trainable||t.push({name:r[a].originalName,tensor:s[a]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const t=VP().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-VP().numTensors}return e}getLossIdentifiers(){let e;if("string"===typeof this.loss)e=xX(this.loss);else if(Array.isArray(this.loss)){for(const e of this.loss)if("string"!==typeof e)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map((e=>xX(e)))}else{const t=Object.keys(this.loss);e={};const n=this.loss;for(const r of t){if("string"!==typeof n[r])throw new Error("Serialization of non-string loss is not supported.");e[r]=xX(n[r])}}return e}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[xX(rJ(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((e=>xX(rJ(e))));{const e={};for(const t in this.metrics)e[t]=xX(rJ(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const t=MQ(hJ(e.optimizer_config));let n,r;if("string"===typeof e.loss)n=wX(e.loss);else if(Array.isArray(e.loss))n=e.loss.map((e=>wX(e)));else if(null!=e.loss){n={};for(const t in e.loss)n[t]=wX(e.loss[t])}if(Array.isArray(e.metrics))r=e.metrics.map((e=>wX(e)));else if(null!=e.metrics){r={};for(const t in e.metrics)r[t]=wX(e.metrics[t])}this.compile({loss:n,metrics:r,optimizer:t})}async save(e,t){if("string"===typeof e){const t=gz(e);if(0===t.length)throw new dX(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new dX(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}if(null==e.save)throw new dX("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await YP(this.getNamedWeights(t)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:`TensorFlow.js tfjs-layers v${fJ}`,convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();const e="optimizer",{data:t,specs:s}=await YP(await this.optimizer.getWeights(),e);n.specs.push(...s),n.data=iz([n.data,t])}if(null!=this.userDefinedMetadata){const e=!0;aJ(this.userDefinedMetadata,this.name,e),r.userDefinedMetadata=this.userDefinedMetadata}return r.weightData=n.data,r.weightSpecs=n.specs,e.save(r)}setUserDefinedMetadata(e){aJ(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}DJ.className="Model",fB(DJ);class MJ extends DJ{}MJ.className="Functional",fB(MJ);class FJ extends DJ{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:LX("sequential_"),null!=e.layers)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some((e=>e<0)))throw new dX(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof FJ||e instanceof DJ;let n;if(t){if(n=e,1!==n.outputs.length)throw new dX("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new dX("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new dX("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const t=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new dX("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new aQ({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(t)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==e.inboundNodes.length)throw new dX(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(1!==e.inboundNodes[0].outputTensors.length)throw new dX("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=sQ(this.outputs[0])}this.inboundNodes=[],new tQ({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:mX(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs[0].shape})}else{const t=e.apply(this.outputs[0]);if(Array.isArray(t))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[t],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(HY(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new DJ({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new cX("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new cX("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new cX("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new cX("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t){let n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new dX("Legacy serialization format not supported yet.");n=t}else hO(null!=t.layers,(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),n=t.layers,delete t.layers,s=t;const a=new e(s);if(!(a instanceof FJ))throw new hX(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const i of n){const e=MQ(i,void 0,r);r&&e.setFastWeightInitDuringBuild(!0),a.add(e)}return a}set stopTraining(e){if(null==this.model)throw new dX("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new dX("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}FJ.className="Sequential",fB(FJ);class LJ extends hB{getConfig(){return{}}}class PJ extends LJ{apply(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new hX(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return zU(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}PJ.className="elu",fB(PJ);class zJ extends LJ{apply(e){return _W(e)}}zJ.className="selu",fB(zJ);class BJ extends LJ{apply(e){return kW(e)}}BJ.className="relu",fB(BJ);class jJ extends LJ{apply(e){return WP((()=>jV(6,kW(e))))}}jJ.className="relu6",fB(jJ);class UJ extends LJ{apply(e){return e}}UJ.className="linear",fB(UJ);class VJ extends LJ{apply(e){return Zj(e)}}VJ.className="sigmoid",fB(VJ);class WJ extends LJ{apply(e){return function(e){return WP((()=>{const t=tB(.5,sB(.2,e));return pU(t,0,1)}))}(e)}}WJ.className="hardSigmoid",fB(WJ);class GJ extends LJ{apply(e){return SV(e)}}GJ.className="softplus",fB(GJ);class HJ extends LJ{apply(e){return function(e){return WP((()=>rB(e,tB(kB(e),1))))}(e)}}HJ.className="softsign",fB(HJ);class qJ extends LJ{apply(e){return tU(e)}}qJ.className="tanh",fB(qJ);class KJ extends LJ{apply(e){return jW(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}KJ.className="softmax",fB(KJ);class XJ extends LJ{apply(e){return CV(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}XJ.className="logSoftmax",fB(XJ);class YJ extends LJ{apply(e){return WP((()=>WP((()=>{const t=Math.sqrt(2),n=sB(.5,tB(1,jU(rB(e,t))));return sB(e,n)}))))}}YJ.className="gelu",fB(YJ);class QJ extends LJ{apply(e){return WP((()=>sB(.5,sB(e,tB(1,tU(sB(aB(rB(2,Math.PI)),tB(e,sB(.044715,bB(e,3))))))))))}}QJ.className="gelu_new",fB(QJ);class JJ extends LJ{apply(e){return WP((()=>sB(e,tU(SV(e)))))}}JJ.className="mish",fB(JJ);class ZJ extends LJ{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return WP((()=>sB(Zj(sB(e,t)),e)))}}function eZ(e){return e.getClassName()}function tZ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return CX(e,pB.getMap().classNameMap,t,"activation")}function nZ(e){if(null==e){const e={className:"linear",config:{}};return tZ(e)}if("string"===typeof e){const t={};return t.className=e,t.config={},tZ(t)}return e instanceof LJ?e:tZ(e)}function rZ(e){if(null!=e&&"object"!==typeof e)throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}ZJ.className="swish",fB(ZJ);class sZ extends hB{}class aZ extends sZ{constructor(e){super(),rZ(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return WP((()=>{let t=PV([1]);return this.hasL1&&(t=tB(t,JU(sB(this.l1,kB(e))))),this.hasL2&&(t=tB(t,JU(sB(this.l2,gY(e))))),Kj(t,[])}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}aZ.className="L1L2",fB(aZ);const iZ={l1l2:"L1L2"};function oZ(e){return SX(e)}function lZ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return CX(e,pB.getMap().classNameMap,t,"regularizer")}function uZ(e){if(null==e)return null;if("string"===typeof e){return lZ({className:e in iZ?iZ[e]:e,config:{}})}return e instanceof sZ?e:lZ(e)}class cZ extends rQ{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=GY(e);let n=kW(e);return null!=this.maxValue&&(n=pU(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}cZ.className="ReLU",fB(cZ);class dZ extends rQ{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=GY(e);return mV(n,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}dZ.className="LeakyReLU",fB(dZ);class hZ extends rQ{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=UY(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=uZ(e.alphaRegularizer),this.alphaConstraint=kQ(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new dX(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`);this.sharedAxes=[e.sharedAxes]}}build(e){const t=(e=HY(e)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<e.length;++r)n[r]=e[r];this.inputSpec=[new JY({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=GY(e),sW(e,this.alpha.read())}getConfig(){const e={alphaInitializer:jY(this.alphaInitializer),alphaRegularizer:oZ(this.alphaRegularizer),alphaConstraint:xQ(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}hZ.className="PReLU",fB(hZ);class pZ extends rQ{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new hX(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=GY(e);return zU(n)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}pZ.className="ELU",fB(pZ);class fZ extends rQ{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){const n=GY(e);return sB(n,Jz(uV(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}fZ.className="ThresholdedReLU",fB(fZ);class mZ extends rQ{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new KJ).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){return WP((()=>{let n=GY(e);const r=t.mask;if(null!=r){const e=sB(xB(zV(n.shape),Jz(r,n.dtype)),uB(-1e9));n=tB(n,e)}return this.axis instanceof Array?this.axis.length>1?nV(xB(n,TV(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)}))}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function gZ(e,t,n){if("number"===typeof e)return mX(e,t);if(e.length!==t)throw new dX(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let s=0;s<t;++s){const a=e[s];if((r=a)!==parseInt(r.toString(),10))throw new dX(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${a}`)}return e;var r}function yZ(e,t,n,r){if(null==e)return e;let s;return s="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((s+r-1)/r)}function vZ(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+tY([n-t,0]);else{if("same"!==r)throw new dX(`Unsupport padding mode: ${r}.`);e*=t}return e}function bZ(e,t){return WP((()=>(WX(t),"channelsFirst"===t?vG(e,[0,2,3,1]):e)))}function xZ(e,t){return WP((()=>(WX(t),"channelsFirst"===t?vG(e,[0,2,3,4,1]):e)))}function wZ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return WP((()=>{if(null==a&&(a="channelsLast"),WX(a),3!==e.shape.length)throw new dX(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(3!==t.shape.length)throw new dX(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(null!=n&&1!==n.shape.length)throw new dX(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if("channelsFirst"===a&&(e=vG(e,[0,2,1])),"causal"===s)throw new hX("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=bU(e,t,r,"same"===s?"same":"valid","NWC",i);return null!=n&&(o=vY(o,n)),o}))}function kZ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return WP((()=>{if(null==a&&(a="channelsLast"),WX(a),3!==e.rank&&4!==e.rank)throw new dX(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(3!==t.rank&&4!==t.rank)throw new dX(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=bZ(e,a);if("causal"===s)throw new hX("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=$G({x:l,filter:t,strides:r,pad:"same"===s?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:o}),"channelsFirst"===a&&(l=vG(l,[0,3,1,2])),l}))}function SZ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;return WP((()=>{if(null==a&&(a="channelsLast"),WX(a),4!==e.rank&&5!==e.rank)throw new dX(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(4!==t.rank&&5!==t.rank)throw new dX(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let o=xZ(e,a);if("causal"===s)throw new hX("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=kU(o,t,r,"same"===s?"same":"valid","NDHWC",i),null!=n&&(o=vY(o,n)),"channelsFirst"===a&&(o=vG(o,[0,4,1,2,3])),o}))}mZ.className="Softmax",fB(mZ);class IZ extends rQ{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",IZ.verifyArgs(t),this.rank=e,_X(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new hX(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=gZ(t.kernelSize,e,"kernelSize"),this.strides=gZ(null==t.strides?1:t.strides,e,"strides"),this.padding=null==t.padding?"valid":t.padding,GX(this.padding),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,WX(this.dataFormat),this.activation=nZ(t.activation),this.useBias=null==t.useBias||t.useBias,this.biasInitializer=UY(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=kQ(t.biasConstraint),this.biasRegularizer=uZ(t.biasRegularizer),this.activityRegularizer=uZ(t.activityRegularizer),this.dilationRate=gZ(null==t.dilationRate?1:t.dilationRate,e,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new dX(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new dX(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new dX(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(e){if(gX("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!RX(e.kernelSize,"number",1,3))throw new dX(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:eZ(this.activation),useBias:this.useBias,biasInitializer:jY(this.biasInitializer),biasRegularizer:oZ(this.biasRegularizer),activityRegularizer:oZ(this.activityRegularizer),biasConstraint:xQ(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class CZ extends IZ{constructor(e,t){super(e,t),this.kernel=null,CZ.verifyArgs(t),this.filters=t.filters,_X(this.filters,"filters"),this.kernelInitializer=UY(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=kQ(t.kernelConstraint),this.kernelRegularizer=uZ(t.kernelRegularizer)}build(e){e=HY(e);const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new dX(`The channel dimension of the input should be defined. Found ${e[t]}`);const n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return WP((()=>{let t;e=GY(e);const n=null==this.bias?null:this.bias.read(),r=OX(this.activation.getClassName());if(null!=r&&2===this.rank)t=kZ(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)t=wZ(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=kZ(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new hX("convolutions greater than 3D are not implemented yet.");t=SZ(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(t=this.activation.apply(t))}return t}))}computeOutputShape(e){e=HY(e);const t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let s=0;s<n.length;++s){const e=yZ(n[s],this.kernelSize[s],this.padding,this.strides[s],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[s]);t.push(e)}let r=[e[0]];return"channelsLast"===this.dataFormat?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:jY(this.kernelInitializer),kernelRegularizer:oZ(this.kernelRegularizer),kernelConstraint:xQ(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new dX(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class TZ extends CZ{constructor(e){super(2,e),TZ.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!RX(e.kernelSize,"number",1,2))throw new dX(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}TZ.className="Conv2D",fB(TZ);class NZ extends CZ{constructor(e){super(3,e),NZ.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new dX(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}NZ.className="Conv3D",fB(NZ);class EZ extends TZ{constructor(e){if(super(e),this.inputSpec=[new JY({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new dX(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(4!==(e=HY(e)).length)throw new dX("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new dX("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new JY({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return WP((()=>{let t=GY(e);if(4!==t.shape.length)throw new dX(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${t.shape.length}`);const n=t.shape,r=n[0];let s,a;"channelsFirst"===this.dataFormat?(s=2,a=3):(s=1,a=2);const i=n[s],o=n[a],l=this.kernelSize[0],u=this.kernelSize[1],c=this.strides[0],d=this.strides[1],h=[r,vZ(i,c,l,this.padding),vZ(o,d,u,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=vG(t,[0,2,3,1]));let p=wU(t,this.kernel.read(),h,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=vG(p,[0,3,1,2])),null!=this.bias&&(p=vY(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p}))}computeOutputShape(e){const t=(e=HY(e)).slice();let n,r,s;"channelsFirst"===this.dataFormat?(n=1,r=2,s=3):(n=3,r=1,s=2);const a=this.kernelSize[0],i=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return t[n]=this.filters,t[r]=vZ(t[r],o,a,this.padding),t[s]=vZ(t[s],l,i,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}EZ.className="Conv2DTranspose",fB(EZ);class AZ extends NZ{constructor(e){if(super(e),this.inputSpec=[new JY({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new dX(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(5!==(e=HY(e)).length)throw new dX("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new dX("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new JY({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return WP((()=>{let t=GY(e);if(5!==t.shape.length)throw new dX(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${t.shape.length}`);const n=t.shape,r=n[0];let s,a,i;"channelsFirst"===this.dataFormat?(i=2,s=3,a=4):(i=1,s=2,a=3);const o=n[i],l=n[s],u=n[a],c=this.kernelSize[0],d=this.kernelSize[1],h=this.kernelSize[2],p=this.strides[0],f=this.strides[1],m=this.strides[2],g=[r,vZ(o,p,c,this.padding),vZ(l,f,d,this.padding),vZ(u,m,h,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=vG(t,[0,2,3,4,1]));let y=IU(t,this.kernel.read(),g,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(y=vG(y,[0,4,1,2,3])),null!==this.bias&&(y=vY(y,this.bias.read(),this.dataFormat)),null!==this.activation&&(y=this.activation.apply(y)),y}))}computeOutputShape(e){const t=(e=HY(e)).slice();let n,r,s,a;"channelsFirst"===this.dataFormat?(n=1,r=2,s=3,a=4):(n=4,r=1,s=2,a=3);const i=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],u=this.strides[0],c=this.strides[1],d=this.strides[2];return t[n]=this.filters,t[r]=vZ(t[r],u,i,this.padding),t[s]=vZ(t[s],c,o,this.padding),t[a]=vZ(t[a],d,l,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}AZ.className="Conv3DTranspose",fB(AZ);class RZ extends CZ{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new dX("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new dX("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new dX(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=UY(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=uZ(t.depthwiseRegularizer),this.depthwiseConstraint=kQ(t.depthwiseConstraint),this.pointwiseInitializer=UY(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=uZ(t.pointwiseRegularizer),this.pointwiseConstraint=kQ(t.pointwiseConstraint)}build(e){if((e=HY(e)).length<this.rank+2)throw new dX(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new dX(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),s=[];for(let i=0;i<this.rank;++i)s.push(1);s.push(n*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new JY({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return WP((()=>{let t;if(e=GY(e),1===this.rank)throw new hX("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=vG(e,[0,2,3,1])),t=$W(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=vY(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=vG(t,[0,3,1,2])),t}))}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=jY(this.depthwiseInitializer),e.pointwiseInitializer=jY(this.pointwiseInitializer),e.depthwiseRegularizer=oZ(this.depthwiseRegularizer),e.pointwiseRegularizer=oZ(this.pointwiseRegularizer),e.depthwiseConstraint=xQ(this.depthwiseConstraint),e.pointwiseConstraint=xQ(this.pointwiseConstraint),e}}RZ.className="SeparableConv";class _Z extends RZ{constructor(e){super(2,e)}}_Z.className="SeparableConv2D",fB(_Z);class $Z extends CZ{constructor(e){super(1,e),$Z.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!RX(e.kernelSize,"number",1,1))throw new dX(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}$Z.className="Conv1D",fB($Z);class OZ extends rQ{constructor(e){super(e),"number"===typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return WP((()=>{if(e=GY(e),"channelsLast"===this.dataFormat){const t=uY(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return uY(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const t=uY(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return uY(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}OZ.className="Cropping2D",fB(OZ);class DZ extends rQ{constructor(e){var t;super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,WX(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,t=this.interpolation,AX(zX,"InterpolationFormat",t)}computeOutputShape(e){if("channelsFirst"===this.dataFormat){const t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{const t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return WP((()=>{let t=GY(e);const n=t.shape;if("channelsFirst"===this.dataFormat){t=vG(t,[0,2,3,1]);const e=this.size[0]*n[2],r=this.size[1]*n[3],s="nearest"===this.interpolation?AH.resizeNearestNeighbor(t,[e,r]):AH.resizeBilinear(t,[e,r]);return vG(s,[0,3,1,2])}{const e=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?AH.resizeNearestNeighbor(t,[e,r]):AH.resizeBilinear(t,[e,r])}}))}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}DZ.className="UpSampling2D",fB(DZ);class MZ extends IZ{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=UY(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=kQ(e.depthwiseConstraint),this.depthwiseRegularizer=uZ(e.depthwiseRegularizer)}build(e){if((e=HY(e)).length<4)throw new dX(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new dX(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return WP((()=>{let t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",s=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return WP((()=>{null==s&&(s="channelsLast"),WX(s);let i=bZ(e,s);if(4!==e.rank)throw new dX(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(4!==t.rank)throw new dX(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return i=_U(i,t,n,"same"===r?"same":"valid","NHWC",a),"channelsFirst"===s&&(i=vG(i,[0,3,1,2])),i}))}(e=GY(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=vY(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t}))}computeOutputShape(e){e=HY(e);const t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,s=yZ(t,this.kernelSize[0],this.padding,this.strides[0]),a=yZ(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,s,a]:[e[0],s,a,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=jY(this.depthwiseInitializer),e.depthwiseRegularizer=oZ(this.depthwiseRegularizer),e.depthwiseConstraint=xQ(this.depthwiseRegularizer),e}}function FZ(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new dX("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function s(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=s(t),constants:n=s(n)}}function LZ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return WP((()=>{const l=t.shape.length;if(l<3)throw new dX(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(nY(2,l));if(t=vG(t,u),null!=a)throw new hX("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=s&&(s=Jz(Jz(s,"bool"),"float32"),s.rank===l-1&&(s=rV(s,-1)),s=vG(s,u)),r&&(t=IW(t,0),null!=s&&(s=IW(s,0)));const c=[];let d,h=n;const p=t.shape[0],f=hG(t);let m,g;null!=s&&(m=hG(s));for(let t=0;t<p;++t){const n=f[t],r=WP((()=>e(n,h)));if(null==s)d=r[0],h=r[1];else{const e=WP((()=>{const e=m[t],n=xB(XV(e),e);return{output:tB(sB(r[0],e),sB(h[0],n)),newStates:h.map(((t,s)=>tB(sB(r[1][s],e),sB(t,n))))}}));d=e.output,h=e.newStates}o&&c.push(d)}if(o){g=XW(c,1)}return[d,g,h]}))}MZ.className="DepthwiseConv2D",fB(MZ);class PZ extends rQ{constructor(e){let t;if(super(e),null==e.cell)throw new dX("cell property is missing for the constructor of RNN.");if(t=Array.isArray(e.cell)?new HZ({cells:e.cell}):e.cell,null==t.stateSize)throw new dX("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new JY({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return nY(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((e=>null))}return this.states_}setStates(e){this.states_=e}computeOutputShape(e){VY(e)&&(e=e[0]);let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const n=t[0];let r;if(r=this.returnSequences?[e[0],e[1],n]:[e[0],n],this.returnState){const n=[];for(const r of t)n.push([e[0],r]);return[r].concat(n)}return r}computeMask(e,t){return WP((()=>{Array.isArray(t)&&(t=t[0]);const e=this.returnSequences?t:null;if(this.returnState){const t=this.states.map((e=>null));return[e].concat(t)}return e}))}get states(){if(null==this.states_){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new hX("Constants support is not implemented in RNN yet.");VY(e)&&(e=e[0]);const t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new JY({shape:[t,null,...n]});const r=[e[0]].concat(e.slice(2));let s;if(this.cell.build(r),s=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!gO(this.stateSpec.map((e=>e.shape[e.shape.length-1])),s))throw new dX(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=s.map((e=>new JY({shape:[null,e]})));this.stateful&&this.resetStates()}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];WP((()=>{if(!this.stateful)throw new uX("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new dX("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>PV([n,e]))):this.states_=[PV([n,this.cell.stateSize])];else if(null==e)GP(this.states_),null!=this.keptStates&&(GP(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>PV([n,e]))):this.states_[0]=PV([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new dX(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);!0===t?this.keptStates.push(this.states_.slice()):GP(this.states_);for(let t=0;t<this.states_.length;++t){const r=e[t],s=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,a=[n,s];if(!gO(r.shape,a))throw new dX(`State ${t} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${r.shape}`);this.states_[t]=r}}this.states_=this.states_.map((e=>HP(e.clone())))}))}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const s=FZ(e,n,r,this.numConstants);e=s.inputs,n=s.initialState,r=s.constants;let a=[],i=[];if(null!=n){t.initialState=n,a=a.concat(n),this.stateSpec=[];for(const e of n)this.stateSpec.push(new JY({shape:e.shape}));i=i.concat(this.stateSpec)}null!=r&&(t.constants=r,a=a.concat(r),this.numConstants=r.length);if(a[0]instanceof ZY){const n=[e].concat(a),r=this.inputSpec.concat(i),s=this.inputSpec;this.inputSpec=r;const o=super.apply(n,t);return this.inputSpec=s,o}return super.apply(e,t)}call(e,t){return WP((()=>{const n=null==t?null:t.mask,r=null==t?null:t.training;let s=null==t?null:t.initialState;e=GY(e),null==s&&(s=this.stateful?this.states_:this.getInitialState(e));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==a)throw new dX(`RNN Layer has ${a} state(s) but was passed ${s.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const i={training:r},o=LZ(((e,t)=>{const n=this.cell.call([e].concat(t),i);return[n[0],n.slice(1)]}),e,s,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],u=o[1],c=o[2];this.stateful&&this.resetStates(c,r);const d=this.returnSequences?u:l;return this.returnState?[d].concat(c):d}))}getInitialState(e){return WP((()=>{let t=PV(e.shape);return t=JU(t,[1,2]),t=iY(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((e=>e>1?hY(t,[1,e]):t)):this.cell.stateSize>1?[hY(t,[1,this.cell.stateSize])]:[t]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===PZ.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=MQ(t.cell,n);return new e(Object.assign(t,{cell:r}))}}PZ.className="RNN",fB(PZ);class zZ extends rQ{}class BZ extends zZ{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,_X(this.units,"units"),this.activation=nZ(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=UY(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=UY(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=UY(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=uZ(e.kernelRegularizer),this.recurrentRegularizer=uZ(e.recurrentRegularizer),this.biasRegularizer=uZ(e.biasRegularizer),this.kernelConstraint=kQ(e.kernelConstraint),this.recurrentConstraint=kQ(e.recurrentConstraint),this.biasConstraint=kQ(e.biasConstraint),this.dropout=eY([1,tY([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=eY([1,tY([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=HY(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return WP((()=>{if(2!==e.length)throw new dX(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let n=e[1];e=e[0];const r=null!=t.training&&t.training;let s;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=qZ({ones:()=>XV(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=qZ({ones:()=>XV(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;s=fY(null!=a?sB(e,a):e,this.kernel.read()),null!=this.bias&&(s=vY(s,this.bias.read())),null!=i&&(n=sB(n,i));let o=tB(s,fY(n,this.recurrentKernel.read()));return null!=this.activation&&(o=this.activation.apply(o)),[o,o]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:eZ(this.activation),useBias:this.useBias,kernelInitializer:jY(this.kernelInitializer),recurrentInitializer:jY(this.recurrentInitializer),biasInitializer:jY(this.biasInitializer),kernelRegularizer:oZ(this.kernelRegularizer),recurrentRegularizer:oZ(this.recurrentRegularizer),biasRegularizer:oZ(this.biasRegularizer),activityRegularizer:oZ(this.activityRegularizer),kernelConstraint:xQ(this.kernelConstraint),recurrentConstraint:xQ(this.recurrentConstraint),biasConstraint:xQ(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}BZ.className="SimpleRNNCell",fB(BZ);class jZ extends PZ{constructor(e){e.cell=new BZ(e),super(e)}call(e,t){return WP((()=>{null!=this.cell.dropoutMask&&(GP(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(GP(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,s=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:s})}))}static fromConfig(e,t){return new e(t)}}jZ.className="SimpleRNN",fB(jZ);class UZ extends zZ{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new dX("GRUCell does not support reset_after parameter set to true.");this.units=e.units,_X(this.units,"units"),this.activation=nZ(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=nZ(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=UY(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=UY(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=UY(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=uZ(e.kernelRegularizer),this.recurrentRegularizer=uZ(e.recurrentRegularizer),this.biasRegularizer=uZ(e.biasRegularizer),this.kernelConstraint=kQ(e.kernelConstraint),this.recurrentConstraint=kQ(e.recurrentConstraint),this.biasConstraint=kQ(e.biasConstraint),this.dropout=eY([1,tY([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=eY([1,tY([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){const t=(e=HY(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return WP((()=>{if(2!==e.length)throw new dX(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const n=null!=t.training&&t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=qZ({ones:()=>XV(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=qZ({ones:()=>XV(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,a=this.recurrentDropoutMask;let i,o,l;0<this.dropout&&this.dropout<1&&(e=sB(e,s[0]));let u=fY(e,this.kernel.read());this.useBias&&(u=vY(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=sB(r,a[0]));const c=this.recurrentKernel.read(),[d,h]=GW(c,[2*this.units,this.units],c.rank-1),p=fY(r,d),[f,m,g]=GW(u,3,u.rank-1),[y,v]=GW(p,2,p.rank-1);i=this.recurrentActivation.apply(tB(f,y)),o=this.recurrentActivation.apply(tB(m,v));const b=fY(sB(o,r),h);l=this.activation.apply(tB(g,b));const x=tB(sB(i,r),sB(tB(1,kV(i)),l));return[x,x]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:eZ(this.activation),recurrentActivation:eZ(this.recurrentActivation),useBias:this.useBias,kernelInitializer:jY(this.kernelInitializer),recurrentInitializer:jY(this.recurrentInitializer),biasInitializer:jY(this.biasInitializer),kernelRegularizer:oZ(this.kernelRegularizer),recurrentRegularizer:oZ(this.recurrentRegularizer),biasRegularizer:oZ(this.biasRegularizer),activityRegularizer:oZ(this.activityRegularizer),kernelConstraint:xQ(this.kernelConstraint),recurrentConstraint:xQ(this.recurrentConstraint),biasConstraint:xQ(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}UZ.className="GRUCell",fB(UZ);class VZ extends PZ{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new UZ(e),super(e)}call(e,t){return WP((()=>{null!=this.cell.dropoutMask&&(GP(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(GP(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,s=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:s})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}VZ.className="GRU",fB(VZ);class WZ extends zZ{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,_X(this.units,"units"),this.activation=nZ(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=nZ(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=UY(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=UY(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=UY(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=uZ(e.kernelRegularizer),this.recurrentRegularizer=uZ(e.recurrentRegularizer),this.biasRegularizer=uZ(e.biasRegularizer),this.kernelConstraint=kQ(e.kernelConstraint),this.recurrentConstraint=kQ(e.recurrentConstraint),this.biasConstraint=kQ(e.biasConstraint),this.dropout=eY([1,tY([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=eY([1,tY([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;const n=(e=HY(e))[e.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const e=this.biasInitializer,n=this.units;r=new((t=class extends SY{apply(t,r){const s=e.apply([n]),a=(new CY).apply([n]),i=e.apply([2*n]);return dY(dY(s,a),i)}}).className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return WP((()=>{const n=null!=t.training&&t.training;if(3!==e.length)throw new dX(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const s=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=qZ({ones:()=>XV(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=qZ({ones:()=>XV(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let o,l,u,c;0<this.dropout&&this.dropout<1&&(e=sB(e,a[0]));let d=fY(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=sB(r,i[0])),d=tB(d,fY(r,this.recurrentKernel.read())),this.useBias&&(d=vY(d,this.bias.read()));const[h,p,f,m]=GW(d,4,d.rank-1);o=this.recurrentActivation.apply(h),l=this.recurrentActivation.apply(p),u=tB(sB(l,s),sB(o,this.activation.apply(f))),c=this.recurrentActivation.apply(m);const g=sB(c,this.activation.apply(u));return[g,g,u]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:eZ(this.activation),recurrentActivation:eZ(this.recurrentActivation),useBias:this.useBias,kernelInitializer:jY(this.kernelInitializer),recurrentInitializer:jY(this.recurrentInitializer),biasInitializer:jY(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:oZ(this.kernelRegularizer),recurrentRegularizer:oZ(this.recurrentRegularizer),biasRegularizer:oZ(this.biasRegularizer),activityRegularizer:oZ(this.activityRegularizer),kernelConstraint:xQ(this.kernelConstraint),recurrentConstraint:xQ(this.recurrentConstraint),biasConstraint:xQ(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}WZ.className="LSTMCell",fB(WZ);class GZ extends PZ{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new WZ(e),super(e)}call(e,t){return WP((()=>{null!=this.cell.dropoutMask&&(GP(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(GP(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,s=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:s})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}GZ.className="LSTM",fB(GZ);class HZ extends zZ{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return WP((()=>{let n=e.slice(1);const r=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?r.push(n.splice(0,e.stateSize.length)):r.push(n.splice(0,1));r.reverse();const s=[];let a;for(let i=0;i<this.cells.length;++i){const o=this.cells[i];n=r[i],a=0===i?[e[0]].concat(n):[a[0]].concat(n),a=o.call(a,t),s.push(a.slice(1))}n=[];for(const e of s.slice().reverse())n.push(...e);return[a[0]].concat(n)}))}build(e){let t;VY(e)&&(e=e[0]),this.cells.forEach(((n,r)=>{KX(`RNNCell_${r}`,(()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}getConfig(){const e=super.getConfig(),t={cells:this.cells.map((e=>({className:e.getClassName(),config:e.getConfig()})))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];for(const s of t.cells)r.push(MQ(s,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return YY(e)}setWeights(e){const t=[];for(const n of this.cells){const r=n.weights.length,s=e.splice(r);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],s[e]])}QY(t)}}function qZ(e){const{ones:t,rate:n,training:r=!1,count:s=1,dropoutFunc:a}=e,i=()=>null!=a?a(t(),n):bY(t(),n),o=()=>xY(i,t,r);if(!s||s<=1)return HP(o().clone());return Array(s).fill(void 0).map(o).map((e=>HP(e.clone())))}HZ.className="StackedRNNCells",fB(HZ);var KZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n};class XZ extends PZ{constructor(e){if(e.unroll)throw new hX("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new hX("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new JY({ndim:5})]}call(e,t){return WP((()=>{if(null!=this.cell.dropoutMask&&(GP(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(GP(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new dX("ConvRNN2D cell does not support constants");const n=null==t?null:t.mask,r=null==t?null:t.training,s=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:s})}))}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return WP((()=>{const{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),s=PV([r[0],...r.slice(2)]);return Array.isArray(t)?Array(t.length).fill(s):[s]}))}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];WP((()=>{if(!this.stateful)throw new uX("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),s=[r[0],...r.slice(2)];if(null==n[0])throw new dX("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>PV(s))):this.states_=[PV(s)];else if(null==e)GP(this.states_),null!=this.keptStates&&(GP(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>PV(s))):this.states_[0]=PV(s);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new dX(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):GP(this.states_);for(let t=0;t<this.states_.length;++t){const n=e[t],r=s;if(!gO(n.shape,r))throw new dX(`State ${t} is incompatible with layer ${this.name}: expected shape=${r}, received shape=${n.shape}`);this.states_[t]=n}}this.states_=this.states_.map((e=>HP(e.clone())))}))}computeSingleOutputShape(e){const{dataFormat:t,filters:n,kernelSize:r,padding:s,strides:a,dilationRate:i}=this.cell,o="channelsFirst"===t,l=e[o?3:2],u=e[o?4:3],c=yZ(l,r[0],s,a[0],i[0]),d=yZ(u,r[1],s,a[1],i[1]);return[...e.slice(0,2),...o?[n,c,d]:[c,d,n]]}}XZ.className="ConvRNN2D";class YZ extends WZ{constructor(e){const{filters:t,kernelSize:n,strides:r,padding:s,dataFormat:a,dilationRate:i}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,_X(this.filters,"filters"),this.kernelSize=gZ(n,2,"kernelSize"),this.kernelSize.forEach((e=>_X(e,"kernelSize"))),this.strides=gZ(r||1,2,"strides"),this.strides.forEach((e=>_X(e,"strides"))),this.padding=s||"valid",GX(this.padding),this.dataFormat=a||"channelsLast",WX(this.dataFormat),this.dilationRate=gZ(i||1,2,"dilationRate"),this.dilationRate.forEach((e=>_X(e,"dilationRate")))}build(e){var t;e=HY(e);const n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new dX(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],s=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;e=new((t=class extends SY{apply(e,t){return cY([n.apply([r]),zV([r]),n.apply([2*r])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return WP((()=>{if(3!==e.length)throw new dX(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const n=t.training||!1,r=e[0],s=e[1],a=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=qZ({ones:()=>XV(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=(e,t,n)=>t&&t[n]?sB(t[n],e):e;let l=o(r,i,0),u=o(r,i,1),c=o(r,i,2),d=o(r,i,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=qZ({ones:()=>XV(s),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const h=this.recurrentDropoutMask;let p=o(s,h,0),f=o(s,h,1),m=o(s,h,2),g=o(s,h,3);const[y,v,b,x]=GW(this.kernel.read(),4,3),[w,k,S,I]=this.useBias?GW(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,y,w,this.padding),u=this.inputConv(u,v,k,this.padding),c=this.inputConv(c,b,S,this.padding),d=this.inputConv(d,x,I,this.padding);const[C,T,N,E]=GW(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,C),f=this.recurrentConv(f,T),m=this.recurrentConv(m,N),g=this.recurrentConv(g,E);const A=this.recurrentActivation.apply(tB(l,p)),R=this.recurrentActivation.apply(tB(u,f)),_=tB(sB(R,a),sB(A,this.activation.apply(tB(c,m)))),$=sB(this.recurrentActivation.apply(tB(d,g)),this.activation.apply(_));return[$,$,_]}))}getConfig(){const e=super.getConfig(),{units:t}=e,n=KZ(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,t,n,r){const s=vU(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?vY(s,n,this.dataFormat):s}recurrentConv(e,t){return vU(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}YZ.className="ConvLSTM2DCell",fB(YZ);class QZ extends XZ{constructor(e){const t=new YZ(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}QZ.className="ConvLSTM2D",fB(QZ);class JZ extends rQ{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;const t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}call(e,t){return WP((()=>{this.invokeCallHook(e,t);const n=GY(e);if(0<this.rate&&this.rate<1){const e=null!=t.training&&t.training,r=this.getNoiseShape(n);return xY((()=>bY(n,this.rate,r,this.seed)),(()=>n),e)}return e}))}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}JZ.className="Dropout",fB(JZ);class ZZ extends JZ{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}ZZ.className="SpatialDropout1D",fB(ZZ);class e0 extends rQ{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,_X(this.units,"units"),this.activation=nZ(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=UY(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=UY(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=kQ(e.kernelConstraint),this.biasConstraint=kQ(e.biasConstraint),this.kernelRegularizer=uZ(e.kernelRegularizer),this.biasRegularizer=uZ(e.biasRegularizer),this.activityRegularizer=uZ(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){const t=(e=HY(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){const t=(e=HY(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return WP((()=>{this.invokeCallHook(e,t);const n=GY(e),r=OX(this.activation.getClassName());let s;return null!=r?s=fY(n,this.kernel.read(),r,this.bias?this.bias.read():null):(s=fY(n,this.kernel.read()),null!=this.bias&&(s=vY(s,this.bias.read())),null!=this.activation&&(s=this.activation.apply(s))),s}))}getConfig(){const e={units:this.units,activation:eZ(this.activation),useBias:this.useBias,kernelInitializer:jY(this.kernelInitializer),biasInitializer:jY(this.biasInitializer),kernelRegularizer:oZ(this.kernelRegularizer),biasRegularizer:oZ(this.biasRegularizer),activityRegularizer:oZ(this.activityRegularizer),kernelConstraint:xQ(this.kernelConstraint),biasConstraint:xQ(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}e0.className="Dense",fB(e0);class t0 extends rQ{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=HY(e);for(const t of e.slice(1))if(null==t)throw new dX(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],ZX(e,1)]}call(e,t){return WP((()=>{this.invokeCallHook(e,t);let n=GY(e);if("channelsFirst"===this.dataFormat&&n.rank>1){const e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=vG(n,e)}return function(e){if(e.rank<=1)throw new dX(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);const t=[e.shape[0],ZX(e.shape,1)];return Kj(e,t)}(n)}))}getConfig(){const e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}t0.className="Flatten",fB(t0);class n0 extends rQ{constructor(e){super(e),this.supportsMasking=!0,this.activation=nZ(e.activation)}call(e,t){return WP((()=>{this.invokeCallHook(e,t);const n=GY(e);return this.activation.apply(n)}))}getConfig(){const e={activation:eZ(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}n0.className="Activation",fB(n0);class r0 extends rQ{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return WP((()=>{return e=GY(e),t=e,n=this.n,WP((()=>{if(2!==t.shape.length)throw new dX(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);return hY(iY(t,1),[1,n,1])}));var t,n}))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}r0.className="RepeatVector",fB(r0);class s0 extends rQ{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){const n="Total size of new array must be unchanged.",r=t.slice();let s=1,a=null;for(let o=0;o<r.length;++o){const e=r[o];if(this.isUnknown(e)){if(null!==a)throw new dX("Can only specifiy one unknown dimension.");a=o}else s*=e}const i=ZX(e);if(null!==a){if(0===s||i%s!==0)throw new dX(n);r[a]=i/s}else if(i!==s)throw new dX(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return WP((()=>{this.invokeCallHook(e,t);const n=GY(e),r=n.shape,s=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return Kj(n,s)}))}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}s0.className="Reshape",fB(s0);class a0 extends rQ{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=nY(1,e.dims.length+1);if(!gO(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new JY({ndim:this.dims.length+1})]}computeOutputShape(e){const t=(e=HY(e)).slice();return this.dims.forEach(((n,r)=>{t[r+1]=e[n]})),t}call(e,t){return vG(GY(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}a0.className="Permute",fB(a0);class i0 extends rQ{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const n=GY(e);return Cj(qV(n,this.maskValue),-1)}call(e,t){return WP((()=>{this.invokeCallHook(e,t);const n=GY(e),r=Cj(qV(n,this.maskValue),-1,!0);return sB(n,Jz(r,n.dtype))}))}}i0.className="Masking",fB(i0);class o0 extends rQ{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(bX(e.inputLength))}this.inputDim=e.inputDim,_X(this.inputDim,"inputDim"),this.outputDim=e.outputDim,_X(this.outputDim,"outputDim"),this.embeddingsInitializer=UY(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=uZ(e.embeddingsRegularizer),this.activityRegularizer=uZ(e.activityRegularizer),this.embeddingsConstraint=kQ(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return WP((()=>this.maskZero?(e=GY(e),qV(e,oB(e))):null))}computeOutputShape(e){if(e=HY(e),null==this.inputLength)return[...e,this.outputDim];const t=bX(this.inputLength);if(t.length!==e.length-1)throw new dX(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let n=0;for(let r=0;r<t.length;++r){const s=t[r],a=e[r+1];if(null!=s&&null!=a&&s!==a)throw new dX(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);null==s&&(t[n]=a),n++}}return[e[0],...t,this.outputDim]}call(e,t){return WP((()=>{this.invokeCallHook(e,t);let n=GY(e);"int32"!==n.dtype&&(n=aY(n,"int32"));const r=mY(this.embeddings.read(),Kj(n,[n.size]));return Kj(r,HY(this.computeOutputShape(n.shape)))}))}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:jY(this.embeddingsInitializer),embeddingsRegularizer:oZ(this.embeddingsRegularizer),activityRegularizer:oZ(this.activityRegularizer),embeddingsConstraint:xQ(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}o0.className="Embedding",fB(o0);class l0 extends rQ{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new hX}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;const n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const s=e[e.length-t.length+r],a=t[r];if(null==s||null==a||s<0||a<0)n.push(null);else if(1===s)n.push(a);else if(1===a)n.push(s);else{if(s!==a)throw new dX("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(s)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[HY(e)]),e.length<2)throw new dX(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const s of e)null!=s&&null!==s[0]&&t.push(s[0]);if(t=NX(t),t.length>1)throw new dX(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let n=null==e[0]?null:e[0].slice(1);for(let s=1;s<e.length;++s){const t=null==e[s]?null:e[s].slice(1);n=this.computeElementwiseOpOutputShape(n,t)}const r=e.map((e=>e.length));-1===e.indexOf(null)&&1===NX(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return WP((()=>{if(this.reshapeRequired){const t=[],n=e.map((e=>e.rank));if(-1===n.indexOf(null)){const r=tY(n);for(let n of e){const e=n.rank;for(let t=0;t<r-e;++t)n=iY(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(const a of e){const e=a.rank;if(null==e){const e=a.shape,r=e[0],s=e.slice(1).concat([r]);let i=Kj(a,[r].concat(ZX(e.slice(1))));i=vG(i,[1,0]),i=Kj(i,s),t.push(i),n=!0}else if(e>1){const r=nY(1,e).concat([0]);t.push(vG(a,r)),n=!0}else t.push(a)}let r=this.mergeFunction(t);const s=r.rank;if(n)if(null==s){const e=r.shape,t=e[e.length-1],n=[t].concat(e.slice(0,e.length-1));r=Kj(vG(Kj(r,[-1,t]),[1,0]),n)}else if(s>1){const e=[s-1].concat(nY(0,s-1));r=vG(r,e)}return r}}return this.mergeFunction(e)}))}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let r=1;r<e.length;++r){const n=null==e[r]?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}let n=[];for(const r of e)null!=r&&null!==r[0]&&n.push(r[0]);return n=NX(n),t=1===n.length?n.concat(t):[null].concat(t),t}computeMask(e,t){return WP((()=>{if(null==t)return null;if(!Array.isArray(t))throw new dX("`mask` should be an Array");if(!Array.isArray(e))throw new dX("`inputs` should be an Array");if(t.length!==e.length)throw new dX(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every((e=>null==e)))return null;let n=(t=t.map((e=>null==e?e:rV(e,0))))[0];for(let e=1;e<t.length-1;++e)n=NV(n,t[e]);return n}))}}class u0 extends l0{constructor(e){super(e)}mergeFunction(e){return WP((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=tB(t,e[n]);return t}))}}u0.className="Add",fB(u0);class c0 extends l0{constructor(e){super(e)}mergeFunction(e){return WP((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=sB(t,e[n]);return t}))}}c0.className="Multiply",fB(c0);class d0 extends l0{constructor(e){super(e)}mergeFunction(e){return WP((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=tB(t,e[n]);return sB(1/e.length,t)}))}}d0.className="Average",fB(d0);class h0 extends l0{constructor(e){super(e)}mergeFunction(e){return WP((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=TB(t,e[n]);return t}))}}h0.className="Maximum",fB(h0);class p0 extends l0{constructor(e){super(e)}mergeFunction(e){return WP((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=jV(t,e[n]);return t}))}}p0.className="Minimum",fB(p0);class f0 extends l0{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new dX("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(const r of e)if(null!=r){t=!1;break}if(t)return;const n=[];for(let r=0;r<e.length;++r){const t=e[r].slice();t.splice(this.axis,1);let s=!1;for(const e of n)if(gO(e,t)){s=!0;break}s||n.push(t)}if(n.length>1)throw new dX("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return WP((()=>cY(e,this.axis)))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new dX("A `Concatenate` layer should be called on a list of inputs.");const t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const s of t.slice(1)){if(null==n[r]||null==s[r]){n[r]=null;break}n[r]+=s[r]}return n}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new dX("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new dX("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new dX(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return WP((()=>{let n=!0;if(t.forEach((e=>{null==e||(n=!1)})),n)return null;const r=[];for(let a=0;a<e.length;++a)null==t[a]?r.push(Jz(XV(e[a]),"bool")):t[a].rank<e[a].rank?r.push(rV(t[a],-1)):r.push(t[a]);const s=Qj(r,this.axis);return Ij(s,-1,!1)}))}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function m0(e,t){for(;e<0;)e+=t;return e}f0.className="Concatenate",fB(f0);class g0 extends l0{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){hO(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const t=e[0],n=e[1];if(t.length>3||n.length>3)throw new hX("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new dX(`Dimension incompatibility: ${t[r[0]]} !== ${n[r[1]]}`)}mergeFunction(e){if(2!==e.length)throw new dX(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map(((t,n)=>m0(t,e[n].shape.length))):[m0(this.axes,n.shape.length),m0(this.axes,r.shape.length)],this.normalize&&(n=FQ(n,t[0]),r=FQ(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new hX("batchDot is not implemented for tensors of 4D or higher rank yet");if(hO(e.shape.length>=2,(()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`)),hO(e.shape.length>=2,(()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`)),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new hX("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,s=t.shape.length;null==n&&(n=[r-1,s-2]);const a=n;return WP((()=>{let n,i;if(r>s){n=r-s;const e=[];for(let t=0;t<n;++t)e.push(1);t=Kj(t,t.shape.concat(e))}else if(s>r){n=s-r;const t=[];for(let e=0;e<n;++e)t.push(1);e=Kj(e,e.shape.concat(t))}else n=0;if(2===e.shape.length&&2===t.shape.length)i=a[0]===a[1]?JU(sB(e,t),a[0]):JU(sB(vG(e,[1,0]),t),a[1]);else{const n=a[0]!==e.shape.length-1,r=a[1]===t.shape.length-1;i=Jj(e,t,n,r)}if(n>0){let e;e=r>s?r+s-3:r-1;const t=[];for(let r=e;r<e+n;++r)t.push(r);i=KW(i,t)}return 1===i.shape.length&&(i=rV(i,1)),i}))}(n,r,t)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[m0(this.axes,e.length),m0(this.axes,t.length)],n}computeOutputShape(e){hO(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new hX("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const s=t.concat(n);return 1===s.length&&s.push(1),s}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}g0.className="Dot",fB(g0);class y0 extends rQ{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return WP((()=>{this.invokeCallHook(e,t);const n=GY(e);return xY((()=>tB(pY(n.shape,0,this.stddev),n)),(()=>n),t.training||!1)}))}}y0.className="GaussianNoise",fB(y0);class v0 extends rQ{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return WP((()=>{this.invokeCallHook(e,t);const n=GY(e);if(this.rate>0&&this.rate<1){return xY((()=>{const e=Math.sqrt(this.rate/(1-this.rate));return sB(n,pY(n.shape,1,e))}),(()=>n),t.training||!1)}return n}))}}v0.className="GaussianDropout",fB(v0);class b0 extends rQ{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||GY(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return WP((()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(e),r=()=>{const t=GY(e),r=-1.7580993408473766;let s=cV(yW(n),this.rate);s=aY(s,"float32");const a=((1-this.rate)*(1+this.rate*r**2))**-.5,i=-a*r*this.rate,o=tB(sB(t,s),sB(tB(s,-1),r));return tB(sB(o,a),i)};return xY(r,(()=>GY(e)),t.training||!1)}return e}))}}function x0(e,t,n,r,s){let a,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)a=aU(e,t,n,r,s,i);else if(3===e.rank)a=iU(e,t,n,r,s,i);else{if(4!==e.rank)throw new hX(`batchNormalization is not implemented for array of rank ${e.rank} yet`);a=oU(e,t,n,r,s,i)}return a}function w0(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return gO(r.slice().sort(),nY(0,e.rank-1))?function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return WP((()=>{const a=WV(e,r),i=a.mean,o=a.variance;return[x0(e,i,o,n,t,s),i,o]}))}(e,t,n,r,s):function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return WP((()=>{const a=WV(e,r),i=a.mean,o=a.variance,l=[];for(const t of nY(0,e.rank))-1!==r.indexOf(t)?l.push(1):l.push(e.shape[t]);const u=Kj(i,l),c=Kj(o,l),d=null==t?null:Kj(t,l),h=null==n?null:Kj(n,l);return[x0(e,u,c,h,d,s),i,o]}))}(e,t,n,r,s)}b0.className="AlphaDropout",fB(b0);class k0 extends rQ{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=UY(e.betaInitializer||"zeros"),this.gammaInitializer=UY(e.gammaInitializer||"ones"),this.movingMeanInitializer=UY(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=UY(e.movingVarianceInitializer||"ones"),this.betaConstraint=kQ(e.betaConstraint),this.gammaConstraint=kQ(e.gammaConstraint),this.betaRegularizer=uZ(e.betaRegularizer),this.gammaRegularizer=uZ(e.gammaRegularizer)}build(e){e=HY(e);const t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new dX(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new JY({ndim:e.length,axes:{[t]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return WP((()=>{const n=null!=t.training&&t.training,r=GY(e),s=r.shape,a=s.length,i=nY(0,a),o=this.axis>=0?this.axis:this.axis+a;i.splice(o,1);const l=mX(1,a);l[o]=s[o];const u=i.slice();u.sort();const c=!gO(u,nY(0,a).slice(0,a-1));if(!n)return(()=>{if(c){const e=Kj(this.movingMean.read(),l),t=Kj(this.movingVariance.read(),l),n=this.center?Kj(this.beta.read(),l):null,s=this.scale?Kj(this.gamma.read(),l):null;return x0(r,e,t,n,s,this.epsilon)}return x0(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[d,h,p]=w0(r,this.gamma.read(),this.beta.read(),i,this.epsilon),f=(e,t,n)=>{WP((()=>{const r=1-n,s=e.read(),a=sB(xB(s,t),r);e.write(xB(s,a))}))};return(()=>{f(this.movingMean,h,this.momentum),f(this.movingVariance,p,this.momentum)})(),d}))}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:jY(this.betaInitializer),gammaInitializer:jY(this.gammaInitializer),movingMeanInitializer:jY(this.movingMeanInitializer),movingVarianceInitializer:jY(this.movingVarianceInitializer),betaRegularizer:oZ(this.betaRegularizer),gammaRegularizer:oZ(this.gammaRegularizer),betaConstraint:xQ(this.betaConstraint),gammaConstraint:xQ(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}k0.className="BatchNormalization",fB(k0);class S0 extends rQ{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);for(const e of this.axis)if(!Number.isInteger(e))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=UY(e.betaInitializer||"zeros"),this.gammaInitializer=UY(e.gammaInitializer||"ones"),this.betaRegularizer=uZ(e.betaRegularizer),this.gammaRegularizer=uZ(e.gammaRegularizer),this.supportsMasking=!0}build(e){const t=(e=HY(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let s=0;s<this.axis.length;++s)this.axis[s]<0&&(this.axis[s]+=t);for(const s of this.axis)if(s<0||s>=t)throw new Error(`Invalid axis: ${s}`);if(this.axis.length!==NX(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const n=this.axis.map((t=>e[t])),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const n=GY(e),r=n.shape,s=r.length;return WP((()=>{let{mean:e,variance:t}=WV(n,this.axis,!0);const a=mX(1,s);for(const n of this.axis)a[n]=r[n];const i=e=>null!=e&&e.shape.length!==s?Kj(e,a):e;let o=this.scale?i(this.gamma.read()):null,l=this.center?i(this.beta.read()):null;const u=[],c=[];for(let n=0;n<s;++n)-1!==this.axis.indexOf(n)?(u.push(r[n]),c.push(1)):(u.push(1),c.push(r[n]));return e=aV(e,u),t=aV(t,u),null!=o&&(o=aV(o,c)),null!=l&&(l=aV(l,c)),x0(n,e,t,l,o,this.epsilon)}))}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:jY(this.betaInitializer),gammaInitializer:jY(this.gammaInitializer),betaRegularizer:oZ(this.betaRegularizer),gammaRegularizer:oZ(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}S0.className="LayerNormalization",fB(S0);class I0 extends rQ{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new dX(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,n;if("number"===typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new dX(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],2!==e.padding[1].length)throw new dX(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new JY({ndim:4})]}computeOutputShape(e){let t,n;return e=HY(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return WP((()=>{return t=GY(e),n=this.padding,r=this.dataFormat,WP((()=>{if(4!==t.rank)throw new dX(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new dX("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==r&&(r="channelsLast"),"channelsLast"!==r&&"channelsFirst"!==r)throw new dX(`Unknown data format: ${r}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let e;return e="channelsFirst"===r?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],QV(t,e)}));var t,n,r}))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}function C0(e,t,n,r,s,a){return WP((()=>{let i;WX(s),HX(a),GX(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==s&&(s="channelsLast"),null==a&&(a="max"),e=bZ(e,s);const o="same"===r?"same":"valid";return i="max"===a?DV(e,t,n,o):Xj(e,t,n,o),"channelsFirst"===s&&(i=vG(i,[0,3,1,2])),i}))}function T0(e,t,n,r,s,a){return WP((()=>{let i;WX(s),HX(a),GX(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==s&&(s="channelsLast"),null==a&&(a="max"),e=xZ(e,s);const o="same"===r?"same":"valid";return i="max"===a?MV(e,t,n,o):Yj(e,t,n,o),"channelsFirst"===s&&(i=vG(i,[0,4,1,2,3])),i}))}I0.className="ZeroPadding2D",fB(I0);class N0 extends rQ{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"===typeof e.poolSize)this.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new dX(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);this.poolSize=e.poolSize}if(_X(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"===typeof e.strides)this.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new dX(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);this.strides=e.strides}_X(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,GX(this.padding),this.inputSpec=[new JY({ndim:3})]}computeOutputShape(e){const t=yZ((e=HY(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return WP((()=>{this.invokeCallHook(e,t),e=iY(GY(e),2);const n=this.poolingFunction(GY(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return KW(n,[2])}))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class E0 extends N0{constructor(e){super(e)}poolingFunction(e,t,n,r,s){return WX(s),GX(r),C0(e,t,n,r,s,"max")}}E0.className="MaxPooling1D",fB(E0);class A0 extends N0{constructor(e){super(e)}poolingFunction(e,t,n,r,s){return WX(s),GX(r),C0(e,t,n,r,s,"avg")}}A0.className="AveragePooling1D",fB(A0);class R0 extends rQ{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new dX(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];_X(this.poolSize,"poolSize"),_X(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,WX(this.dataFormat),GX(this.padding),this.inputSpec=[new JY({ndim:4})]}computeOutputShape(e){e=HY(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=yZ(t,this.poolSize[0],this.padding,this.strides[0]),n=yZ(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return WP((()=>(this.invokeCallHook(e,t),this.poolingFunction(GY(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class _0 extends R0{constructor(e){super(e)}poolingFunction(e,t,n,r,s){return WX(s),GX(r),C0(e,t,n,r,s,"max")}}_0.className="MaxPooling2D",fB(_0);class $0 extends R0{constructor(e){super(e)}poolingFunction(e,t,n,r,s){return WX(s),GX(r),C0(e,t,n,r,s,"avg")}}$0.className="AveragePooling2D",fB($0);class O0 extends rQ{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new dX(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];_X(this.poolSize,"poolSize"),_X(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,WX(this.dataFormat),GX(this.padding),this.inputSpec=[new JY({ndim:5})]}computeOutputShape(e){e=HY(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=yZ(t,this.poolSize[0],this.padding,this.strides[0]),n=yZ(n,this.poolSize[1],this.padding,this.strides[1]),r=yZ(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return WP((()=>(this.invokeCallHook(e,t),this.poolingFunction(GY(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class D0 extends O0{constructor(e){super(e)}poolingFunction(e,t,n,r,s){return WX(s),GX(r),T0(e,t,n,r,s,"max")}}D0.className="MaxPooling3D",fB(D0);class M0 extends O0{constructor(e){super(e)}poolingFunction(e,t,n,r,s){return WX(s),GX(r),T0(e,t,n,r,s,"avg")}}M0.className="AveragePooling3D",fB(M0);class F0 extends rQ{constructor(e){super(e),this.inputSpec=[new JY({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new hX}}class L0 extends F0{constructor(e){super(e||{})}call(e,t){return WP((()=>{const t=GY(e);return LV(t,1)}))}}L0.className="GlobalAveragePooling1D",fB(L0);class P0 extends F0{constructor(e){super(e||{})}call(e,t){return WP((()=>{const t=GY(e);return YU(t,1)}))}}P0.className="GlobalMaxPooling1D",fB(P0);class z0 extends rQ{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,WX(this.dataFormat),this.inputSpec=[new JY({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new hX}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class B0 extends z0{call(e,t){return WP((()=>{const t=GY(e);return"channelsLast"===this.dataFormat?LV(t,[1,2]):LV(t,[2,3])}))}}B0.className="GlobalAveragePooling2D",fB(B0);class j0 extends z0{call(e,t){return WP((()=>{const t=GY(e);return"channelsLast"===this.dataFormat?YU(t,[1,2]):YU(t,[2,3])}))}}j0.className="GlobalMaxPooling2D",fB(j0);class U0 extends rQ{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=MQ(t.layer,n);delete t.layer;const s={layer:r};return Object.assign(s,t),new e(s)}}class V0 extends U0{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=HY(e)).length<3)throw new dX(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){const t=[(e=HY(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return WP((()=>LZ(((e,n)=>[GY(this.layer.call(e,t)),[]]),e=GY(e),[],!1,null,null,!1,!0)[1]))}}V0.className="TimeDistributed",fB(V0);class W0 extends U0{constructor(e){super(e);const t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=MQ(n),t.goBackwards=!0!==t.goBackwards;const r={};var s;if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=MQ(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,s=this.mergeMode,AX(UX,"BidirectionalMergeMode",s),e.weights)throw new hX("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,r,s=this.forwardLayer.computeOutputShape(e);return Array.isArray(s)&&Array.isArray(s[0])||(s=[s]),this.returnState?(r=s.slice(1),t=s[0]):t=s[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):vX(n)}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const s=FZ(e,n,r,this.numConstants);if(e=s.inputs,n=s.initialState,r=s.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==r)return super.apply(e,t);const a=[],i=[];if(null!=n){const e=n.length;if(e%2>0)throw new dX("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,a.push(...n);const r=n.map((e=>new JY({shape:e.shape})));this.forwardLayer.stateSpec=r.slice(0,e/2),this.backwardLayer.stateSpec=r.slice(e/2),i.push(...r)}if(null!=r)throw new hX("Support for constants in Bidirectional layers is not implemented yet.");const o=a[0]instanceof ZY;for(const l of a)if(l instanceof ZY!==o)throw new dX("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){const n=[e].concat(a),r=this.inputSpec.concat(i),s=this.inputSpec;this.inputSpec=r;const o=super.apply(n,t);return this.inputSpec=s,o}return super.apply(e,t)}call(e,t){return WP((()=>{const n=t.initialState;let r,s,a,i;if(null==n)r=this.forwardLayer.call(e,t),s=this.backwardLayer.call(e,t);else{const a=n.slice(0,n.length/2),i=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:a})),s=this.backwardLayer.call(e,Object.assign(t,{initialState:i}))}return this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(s.slice(1))),r=r[0],s=s[0]),this.returnSequences&&(s=IW(s,1)),"concat"===this.mergeMode?i=cY([r,s]):"sum"===this.mergeMode?i=tB(r,s):"ave"===this.mergeMode?i=sB(.5,tB(r,s)):"mul"===this.mergeMode?i=sB(r,s):null==this.mergeMode&&(i=[r,s]),this.returnState?null==this.mergeMode?i.concat(a):[i].concat(a):i}))}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){KX(this.forwardLayer.name,(()=>{this.forwardLayer.build(e)})),KX(this.backwardLayer.name,(()=>{this.backwardLayer.build(e)})),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){const e=this.forwardLayer.states.map((e=>null));return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const n=MQ(t.layer);if(delete t.layer,null!=t.numConstants)throw new hX("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=n,new e(r)}}W0.className="Bidirectional",fB(W0);class G0 extends rQ{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return WP((()=>("float32"!==(e=GY(e)).dtype&&(e=aY(e,"float32")),tB(sB(e,this.scale),this.offset))))}}G0.className="Rescaling",fB(G0);const{resizeBilinear:H0,cropAndResize:q0}=AH;class K0 extends rQ{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,s,a,i,o){return WP((()=>{let l,u=!1;const c=[t/a,n/i,(r+t)/a,(s+n)/i],d=[];3===e.rank?(u=!0,l=XW([e])):l=e;for(let e=0;e<l.shape[0];e++)d.push(c);const h=zP(d,[d.length,4]),p=bW(0,d.length,1,"int32"),f=q0(l,h,p,[r,s],"nearest");return aY(u?GY(hG(f)):f,o)}))}upsize(e,t,n,r){return WP((()=>aY(H0(e,[t,n]),r)))}call(e,t){return WP((()=>{const t=GY(e),n=t.dtype,r=t.shape,s=r[r.length-3],a=r[r.length-2];let i=0;s!==this.height&&(i=Math.floor((s-this.height)/2));let o=0;return a!==this.width&&(o=Math.floor((a-this.width)/2),0===o&&(o=1)),i>=0&&o>=0?this.centerCrop(t,i,o,this.height,this.width,s,a,n):this.upsize(e,this.height,this.width,n)}))}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=HY(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}K0.className="CenterCrop",fB(K0);class X0 extends rQ{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return null==(e=HY(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return WP((()=>{let n;if("int32"!==(e=GY(e)).dtype&&(e=aY(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==this.outputMode)throw new dX(`countWeights is not used when outputMode !== count.\n              Received countWeights=${t.countWeights}`);n=GY(t.countWeights)}const r=YU(e),s=QU(e),a=uV(this.numTokens,r).bufferSync().get(0),i=cV(s,0).bufferSync().get(0);if(!a||!i)throw new dX(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return function(e,t,n,r){let s=GY(e);if("int32"!==s.dtype&&(s=aY(s,"int32")),"int"===t)return s;const a=s.shape;if(0===s.rank&&(s=rV(s,-1)),"oneHot"===t&&1!==s.shape[s.shape.length-1]&&(s=rV(s,-1)),s.rank>2)throw new dX(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${a} which would result in output rank ${s.rank}.`);const i=["multiHot","oneHot"].includes(t);let o;if(o=AU(s,"undefined"!==typeof r&&"count"===t?r:[],n,i),"tfIdf"!==t)return o;if(r)return sB(o,r);throw new dX("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)}))}}X0.className="CategoryEncoding",fB(X0);const Y0=new Set(["bilinear","nearest"]);class Q0 extends rQ{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!Y0.has(e.interpolation))throw new dX(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){const t=(e=HY(e))[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return WP((()=>{const t=[this.height,this.width];if("bilinear"===this.interpolation)return AH.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return AH.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...Y0]} are supported`)}))}}Q0.className="Resizing",fB(Q0);class J0{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}}J0.className="RandomSeed";class Z0 extends rQ{constructor(e){super(e),this.randomGenerator=new J0(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}Z0.className="BaseRandomLayer";const e1=new Set(["bilinear","nearest"]);class t1 extends Z0{constructor(e){super(e);const{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new dX(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new dX(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new dX(`factor cannot have upper bound less than lower bound.\n        Got upper bound: ${this.widthUpper}.\n        Got lower bound: ${this.widthLower}\n      `);if(n){if(!e1.has(n))throw new dX(`Invalid interpolation parameter: ${n} is not implemented`);this.interpolation=n}}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=HY(e))[2];return[this.imgHeight,-1,t]}call(e,t){return WP((()=>{const t=GY(e);this.imgHeight=t.shape[t.shape.length-3];const n=t.shape[t.shape.length-2];this.widthFactor=yW([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*n;r=Math.round(r);const s=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return AH.resizeBilinear(e,s);case"nearest":return AH.resizeNearestNeighbor(e,s);default:throw new Error(`Interpolation is ${this.interpolation}\n          but only ${[...e1]} are supported`)}}))}}t1.className="RandomWidth",fB(t1);var n1,r1,s1;HO().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),(r1=n1||(n1={}))[r1.DT_INVALID=0]="DT_INVALID",r1[r1.DT_FLOAT=1]="DT_FLOAT",r1[r1.DT_DOUBLE=2]="DT_DOUBLE",r1[r1.DT_INT32=3]="DT_INT32",r1[r1.DT_UINT8=4]="DT_UINT8",r1[r1.DT_INT16=5]="DT_INT16",r1[r1.DT_INT8=6]="DT_INT8",r1[r1.DT_STRING=7]="DT_STRING",r1[r1.DT_COMPLEX64=8]="DT_COMPLEX64",r1[r1.DT_INT64=9]="DT_INT64",r1[r1.DT_BOOL=10]="DT_BOOL",r1[r1.DT_QINT8=11]="DT_QINT8",r1[r1.DT_QUINT8=12]="DT_QUINT8",r1[r1.DT_QINT32=13]="DT_QINT32",r1[r1.DT_BFLOAT16=14]="DT_BFLOAT16",r1[r1.DT_QINT16=15]="DT_QINT16",r1[r1.DT_QUINT16=16]="DT_QUINT16",r1[r1.DT_UINT16=17]="DT_UINT16",r1[r1.DT_COMPLEX128=18]="DT_COMPLEX128",r1[r1.DT_HALF=19]="DT_HALF",r1[r1.DT_RESOURCE=20]="DT_RESOURCE",r1[r1.DT_VARIANT=21]="DT_VARIANT",r1[r1.DT_UINT32=22]="DT_UINT32",r1[r1.DT_UINT64=23]="DT_UINT64",r1[r1.DT_FLOAT_REF=101]="DT_FLOAT_REF",r1[r1.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",r1[r1.DT_INT32_REF=103]="DT_INT32_REF",r1[r1.DT_UINT8_REF=104]="DT_UINT8_REF",r1[r1.DT_INT16_REF=105]="DT_INT16_REF",r1[r1.DT_INT8_REF=106]="DT_INT8_REF",r1[r1.DT_STRING_REF=107]="DT_STRING_REF",r1[r1.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",r1[r1.DT_INT64_REF=109]="DT_INT64_REF",r1[r1.DT_BOOL_REF=110]="DT_BOOL_REF",r1[r1.DT_QINT8_REF=111]="DT_QINT8_REF",r1[r1.DT_QUINT8_REF=112]="DT_QUINT8_REF",r1[r1.DT_QINT32_REF=113]="DT_QINT32_REF",r1[r1.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",r1[r1.DT_QINT16_REF=115]="DT_QINT16_REF",r1[r1.DT_QUINT16_REF=116]="DT_QUINT16_REF",r1[r1.DT_UINT16_REF=117]="DT_UINT16_REF",r1[r1.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",r1[r1.DT_HALF_REF=119]="DT_HALF_REF",r1[r1.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",r1[r1.DT_VARIANT_REF=121]="DT_VARIANT_REF",r1[r1.DT_UINT32_REF=122]="DT_UINT32_REF",r1[r1.DT_UINT64_REF=123]="DT_UINT64_REF",function(e){let t;!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(s1||(s1={}));const a1={};function i1(e){return a1[e]}function o1(e,t,n,r,s){const a=t.inputParams[e];if(a&&void 0!==a.inputIndexStart){const e=a.inputIndexStart,i=0===a.inputIndexEnd?void 0:void 0===a.inputIndexEnd?e+1:a.inputIndexEnd,o=e<0?t.inputNames.length+e:e;if("tensor"===a.type)return l1(t.inputNames[o],n,r,s);if("tensors"===a.type){const a=t.inputs.slice(e,i);return t.inputNames.slice(e,i).filter(((e,t)=>{var n;return"NoOp"!==(null===(n=a[t])||void 0===n?void 0:n.op)})).map((e=>l1(e,n,r,s)))}const l=l1(t.inputNames[o],n,r,s),u=l.dataSync();return"number"===a.type?u[0]:MO(l.shape,u)}const i=t.attrParams[e];return i&&i.value}function l1(e,t,n,r){const[s,a]=h1(e,n);if(null!=r){const e=r.getHashTableHandleByName(s);if(null!=e)return e}const i=n.currentContextIds.find((e=>!!t[d1(s,e)]));return void 0!==i?t[d1(s,i)][a]:void 0}function u1(e,t,n){return t[d1(e,n.currentContextId)]}function c1(e,t){const[n,r,s]=h1(e,t);return[d1(n,t&&t.currentContextId),r,s]}function d1(e,t){return t?`${e}-${t}`:e}function h1(e,t){if(""===e)return["",0,void 0];const n=null!=t&&null!=t.parseNodeNameCache;if(n){const n=t.parseNodeNameCache.get(e);if(null!=n)return n}const r=e.split(":");let s;if(1===r.length)s=[e,0,void 0];else{const e=r[0],t=3===r.length?r[1]:void 0;s=[e,Number(r[r.length-1]),t]}return n&&t.parseNodeNameCache.set(e,s),s}function p1(e,t,n){let r=o1("pad",e,t,n);if("explicit"===r){r=o1("explicitPaddings",e,t,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)s[e][0]=r[2*e],s[e][1]=r[2*e+1];return s}return r}function f1(e){return e.kept?e:Zz(e)}const m1=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],g1=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],y1=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],v1=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],b1=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],x1=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],w1=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],k1=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],S1=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],I1=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],C1=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],T1=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],N1=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],E1=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],A1=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],R1=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],_1=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],$1=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],O1=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class D1{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[].concat(...[i,o,l,u,c,d,h,p,f,m,g,y,v,b,x,w,k,S,I].map((e=>e.json)));this.opMappers=e.reduce(((e,t)=>(e[t.tfOpName]=t,e)),{})}transformGraph(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.node,r=[],s=[],a=[],i=n.reduce(((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?r.push(e[t.name]):"Const"===t.op?s.push(e[t.name]):null!=t.input&&0!==t.input.length||a.push(e[t.name]),e)),{});let o=[];const l=[];let u={},c={};null!=t&&(u=this.mapSignatureEntries(t.inputs),c=this.mapSignatureEntries(t.outputs));const d=Object.keys(i);d.forEach((e=>{const t=i[e];t.inputNames.forEach(((e,n)=>{const[r,,s]=c1(e),a=i[r];if(null!=a.outputs){const e=a.outputs.indexOf(s);if(-1!==e){const s=`${r}:${e}`;t.inputNames[n]=s}}t.inputs.push(a),a.children.push(t)}))})),0===Object.keys(c).length?d.forEach((e=>{const t=i[e];0===t.children.length&&l.push(t)})):Object.keys(c).forEach((e=>{const[t]=c1(e),n=i[t];null!=n&&(n.signatureKey=c[e],l.push(n))})),Object.keys(u).length>0?Object.keys(u).forEach((e=>{const[t]=c1(e),n=i[t];n&&(n.signatureKey=u[e],o.push(n))})):o=r;let h={};null!=e.library&&null!=e.library.function&&(h=e.library.function.reduce(((e,t)=>(e[t.signature.name]=this.mapFunction(t),e)),{}));const p={nodes:i,inputs:o,outputs:l,weights:s,placeholders:r,signature:t,functions:h};return a.length>0&&(p.initNodes=a),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce(((t,n)=>(t[e[n].name]=n,t)),{})}mapNode(e){const t=i1(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((e=>e.startsWith("^")?e.slice(1):e)),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce(((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e)),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce(((t,n)=>{const r=n.type;let s;switch(n.type){case"string":s=F1(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=F1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":s=H1(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=H1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":s=P1(e.attr,n.tfName,n.defaultValue||0),void 0===s&&n.tfDeprecatedName&&(s=P1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":s=G1(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=G1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":s=L1(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=L1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":s=K1(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=K1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":s=W1(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=W1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":s=q1(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=q1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":s=j1(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=j1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":s=U1(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=U1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":s=B1(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=B1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${n.type} for op: ${e.op}`)}return t[n.name]={value:s,type:r},t}),{})),n}mapFunction(e){const t=e.nodeDef,n=[];let r={};null!=t&&(r=t.reduce(((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&n.push(e[t.name]),e)),{}));const s=[],a=[];e.signature.inputArg.forEach((e=>{const[t]=c1(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:z1(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,s.push(n),r[t]=n}));Object.keys(r).forEach((e=>{const t=r[e];t.inputNames.forEach(((e,n)=>{const[s,,a]=c1(e),i=r[s];if(null!=i.outputs){const e=i.outputs.indexOf(a);if(-1!==e){const r=`${s}:${e}`;t.inputNames[n]=r}}t.inputs.push(i),i.children.push(t)}))}));const i=e.ret;e.signature.outputArg.forEach((e=>{const[t,n]=c1(i[e.name]),s=r[t];null!=s&&(s.defaultOutput=n,a.push(s))}));const o=this.mapArgsToSignature(e);return{nodes:r,inputs:s,outputs:a,weights:n,placeholders:[],signature:o}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce(((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e)),{}),outputs:e.signature.outputArg.reduce(((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t)),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}function M1(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const t=HO().global;if("undefined"!==typeof t.atob)return t.atob(e);if("undefined"!==typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function F1(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=e[t];return null!=s?M1(s.s,r):n}function L1(e,t,n){const r=e[t];return r?r.b:n}function P1(e,t,n){const r=e[t]||{},s=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof s?s:parseInt(s,10)}function z1(e){switch("string"===typeof e&&(e=n1[e]),e){case n1.DT_FLOAT:case n1.DT_HALF:return"float32";case n1.DT_INT32:case n1.DT_INT64:case n1.DT_INT8:case n1.DT_UINT8:return"int32";case n1.DT_BOOL:return"bool";case n1.DT_DOUBLE:return"float32";case n1.DT_STRING:return"string";case n1.DT_COMPLEX64:case n1.DT_COMPLEX128:return"complex64";default:return null}}function B1(e,t,n){const r=e[t];return r&&r.func?r.func.name:n}function j1(e,t,n){const r=e[t];return r&&r.type?z1(r.type):n}function U1(e,t,n){const r=e[t];return r&&r.list&&r.list.type?r.list.type.map((e=>z1(e))):n}function V1(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((e=>"number"===typeof e.size?e.size:parseInt(e.size,10))):[]}function W1(e,t,n){const r=e[t];return r&&r.shape?V1(r.shape):n}function G1(e,t,n){const r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((e=>"number"===typeof e?e:parseInt(e,10))):n}function H1(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=e[t];return s&&s.list&&s.list.s?s.list.s.map((e=>M1(e,r))):n}function q1(e,t,n){const r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((e=>V1(e))):n}function K1(e,t,n){const r=e[t];return r&&r.list&&r.list.b?r.list.b:n}class X1{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((e=>this.getInput(e))),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce(((e,t)=>(e[t]=this.getAttr(t),e)),{}))}getInput(e){return l1(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(null!=n.tensor)return l1(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return P1(this.node.rawAttrs,e,t);if(null!=n.s)return F1(this.node.rawAttrs,e,t);if(null!=n.b)return L1(this.node.rawAttrs,e,t);if(null!=n.shape)return W1(this.node.rawAttrs,e,t);if(null!=n.type)return j1(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return G1(this.node.rawAttrs,e,t);if(null!=n.list.s)return H1(this.node.rawAttrs,e,t);if(null!=n.list.shape)return q1(this.node.rawAttrs,e,t);if(null!=n.list.b)return K1(this.node.rawAttrs,e,t);if(null!=n.list.type)return U1(this.node.rawAttrs,e,t)}return t}}function Y1(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof e&&"number"!==typeof t){hO(e.length===t.length,(()=>n+` Shapes ${e} and ${t} must match`));for(let r=0;r<e.length;r++){const s=e[r],a=t[r];hO(s<0||a<0||s===a,(()=>n+` Shapes ${e} and ${t} must match`))}}}function Q1(e){return"number"!==typeof e&&!e.some((e=>e<0))}function J1(e,t,n){let r=Z1(e,n);const s=!Q1(r);if(s&&0===t.length)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&t.forEach((e=>{r=Z1(e.shape,r)})),!Q1(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function Z1(e,t){if("number"===typeof e)return t;if("number"===typeof t)return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);const n=[];for(let r=0;r<e.length;++r){const s=e[r],a=t[r];if(s>=0&&a>=0&&s!==a)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[r]=s>=0?s:a}return n}class e2{constructor(e,t,n,r,s,a,i){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=s,this.dynamicSize=a,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=uB(0),HP(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map((e=>this.read(e)))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},\n          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),Y1(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);n.tensor=t,HP(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach(((e,n)=>this.write(e,t[n])))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return zP([],[0].concat(this.elementShape));const n=this.readMany(e);return Y1(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),XW(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(0===this.size())return zP([],[0].concat(this.elementShape));const t=[];for(let r=0;r<this.size();r++)t.push(r);const n=this.readMany(t);return Y1(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),Qj(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(e,hG(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let n=0;const r=e.map((e=>(n+=e,n)));if(n!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const s=0===n?0:t.size/n,a=[];WP((()=>{t=Kj(t,[1,n,s]);for(let n=0;n<e.length;++n){const i=[0,0===n?0:r[n-1],0],o=[1,e[n],s];a[n]=Kj(eU(t,i,o),this.elementShape)}return a}));const i=[];for(let o=0;o<e.length;o++)i[o]=o;this.writeMany(i,a)}}class t2{get id(){return this.idTensor.id}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this.tensors=e,this.elementShape=t,this.elementDtype=n,null!=e&&e.forEach((e=>{if(n!==e.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${e.dtype}`);Y1(t,e.shape,"TensorList shape mismatch: "),HP(e)})),this.idTensor=uB(0),this.maxNumElements=r,HP(this.idTensor)}copy(){return new t2([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(-1!==n&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);Y1(e,this.elementShape,"TensorList shape mismatch: ");const r=J1(this.elementShape,this.tensors,e);return WP((()=>{const e=this.tensors.map((e=>Kj(e,r)));return XW(e,0)}))}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=J1(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,Y1(r.shape,e,"TensorList shape mismatch: "),Kj(r,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Y1(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");HP(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new t2([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[e])throw new Error(`element at index ${e} is null.`);Y1(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=J1(this.elementShape,this.tensors,t);return Kj(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Y1(this.elementShape,t.shape,"TensorList shape mismatch: "),HP(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);Y1(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=J1(this.elementShape,this.tensors,n);return 0===e.length?zP([],[0].concat(r)):WP((()=>{const t=e.map((e=>Kj(this.tensors[e],r)));return XW(t,0)}))}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Y1(this.elementShape,t,"TensorList shape mismatch: ");const n=J1(this.elementShape,this.tensors,t);return 0===this.size()?zP([],[0].concat(n)):WP((()=>{const e=this.tensors.map((e=>Kj(e,n)));return Qj(e,0)}))}}const n2=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const r=o1("thenBranch",e,t,n),s=o1("elseBranch",e,t,n),a=o1("cond",e,t,n),i=o1("args",e,t,n);return(await a.data())[0]?n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=o1("body",e,t,n),s=o1("cond",e,t,n),a=o1("args",e,t,n),i=await n.functionMap[s].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap),o=a.map((e=>e.id));let l=await i[0].data();i.forEach((e=>{e.kept||-1!==o.indexOf(e.id)||e.dispose()}));let u=a;for(;l[0];){const e=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const t=u.map((e=>e.id));e.forEach((e=>{e.kept||-1!==o.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}));const a=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await a[0].data(),a.forEach((e=>{e.kept||-1!==o.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}))}return u}case"LoopCond":return[f1(o1("pred",e,t,n))];case"Switch":{const r=o1("pred",e,t,n);let s=o1("data",e,t,n);return s.kept||(s=f1(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=e.inputNames.find((e=>void 0!==l1(e,t,n)));if(r){return[f1(l1(r,t,n))]}return}case"Enter":{const r=o1("frameName",e,t,n),s=o1("tensor",e,t,n);return n.enterFrame(r),[f1(s)]}case"Exit":{const r=o1("tensor",e,t,n);return n.exitFrame(),[f1(r)]}case"NextIteration":{const r=o1("tensor",e,t,n);return n.nextIteration(),[f1(r)]}case"TensorArrayV3":{const r=o1("size",e,t,n),s=o1("dtype",e,t,n),a=o1("elementShape",e,t,n),i=o1("dynamicSize",e,t,n),o=o1("clearAfterRead",e,t,n),l=o1("identicalElementShapes",e,t,n),u=o1("name",e,t,n),c=new e2(u,s,r,a,l,i,o);return n.addTensorArray(c),[c.idTensor,uB(1)]}case"TensorArrayWriteV3":{const r=o1("tensorArrayId",e,t,n),s=o1("index",e,t,n),a=o1("tensor",e,t,n),i=n.getTensorArray(r.id);return i.write(s,a),[i.idTensor]}case"TensorArrayReadV3":{const r=o1("tensorArrayId",e,t,n),s=o1("index",e,t,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=o1("tensorArrayId",e,t,n),s=o1("indices",e,t,n),a=o1("dtype",e,t,n);return[n.getTensorArray(r.id).gather(s,a)]}case"TensorArrayScatterV3":{const r=o1("tensorArrayId",e,t,n),s=o1("indices",e,t,n),a=o1("tensor",e,t,n),i=n.getTensorArray(r.id);return i.scatter(s,a),[i.idTensor]}case"TensorArrayConcatV3":{const r=o1("tensorArrayId",e,t,n),s=n.getTensorArray(r.id),a=o1("dtype",e,t,n);return[s.concat(a)]}case"TensorArraySplitV3":{const r=o1("tensorArrayId",e,t,n),s=o1("tensor",e,t,n),a=o1("lengths",e,t,n),i=n.getTensorArray(r.id);return i.split(a,s),[i.idTensor]}case"TensorArraySizeV3":{const r=o1("tensorArrayId",e,t,n);return[uB(n.getTensorArray(r.id).size(),"int32")]}case"TensorArrayCloseV3":{const r=o1("tensorArrayId",e,t,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=o1("tensorListId",e,t,n),s=o1("index",e,t,n),a=o1("tensor",e,t,n),i=n.getTensorList(r.id);return i.setItem(s,a),[i.idTensor]}case"TensorListGetItem":{const r=o1("tensorListId",e,t,n),s=o1("index",e,t,n),a=o1("elementShape",e,t,n),i=o1("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(s,a,i)]}case"TensorListScatterV2":case"TensorListScatter":{const r=o1("indices",e,t,n),s=function(e,t,n,r){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const s=Math.max(...t);if(null!=r&&-1!==r&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const a=new t2([],n,e.dtype,r),i=hG(e,0);return t.forEach(((e,t)=>{a.setItem(e,i[t])})),a}(o1("tensor",e,t,n),r,o1("elementShape",e,t,n),o1("numElements",e,t,n));return n.addTensorList(s),[s.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=o1("elementShape",e,t,n),s=o1("elementDType",e,t,n);let a;a="TensorListReserve"===e.op?"numElements":"maxNumElements";const i=o1(a,e,t,n),o=function(e,t,n,r){return new t2([],e,t,r)}(r,s,0,"TensorListReserve"===e.op?-1:i);return n.addTensorList(o),[o.idTensor]}case"TensorListGather":{const r=o1("tensorListId",e,t,n),s=o1("indices",e,t,n),a=o1("elementShape",e,t,n),i=o1("elementDType",e,t,n);return[n.getTensorList(r.id).gather(s,i,a)]}case"TensorListStack":{const r=o1("tensorListId",e,t,n),s=o1("elementShape",e,t,n),a=o1("elementDType",e,t,n),i=o1("numElements",e,t,n);return[n.getTensorList(r.id).stack(s,a,i)]}case"TensorListFromTensor":{const r=function(e,t,n){const r=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);Y1(e.shape.slice(1),t,"TensorList shape mismatch: ");const s=hG(e);return new t2(s,t,r)}(o1("tensor",e,t,n),o1("elementShape",e,t,n),o1("elementDType",e,t,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=o1("tensorListId",e,t,n),s=n.getTensorList(r.id),a=o1("dtype",e,t,n),i=o1("elementShape",e,t,n);return[s.concat(a,i)]}case"TensorListPushBack":{const r=o1("tensorListId",e,t,n),s=o1("tensor",e,t,n),a=n.getTensorList(r.id);return a.pushBack(s),[a.idTensor]}case"TensorListPopBack":{const r=o1("tensorListId",e,t,n),s=o1("elementShape",e,t,n),a=o1("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(s,a)]}case"TensorListSplit":{const r=o1("tensor",e,t,n),s=o1("elementShape",e,t,n),a=function(e,t,n){let r=0;const s=t.map((e=>(r+=e,r)));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${e.shape}`);const a=Z1(e.shape.slice(1),n),i=0===r?0:e.size/r,o=WP((()=>{const n=[];e=Kj(e,[1,r,i]);for(let r=0;r<t.length;++r){const o=[0,0===r?0:s[r-1],0],l=[1,t[r],i];n[r]=Kj(eU(e,o,l),a)}return e.dispose(),n})),l=new t2([],n,e.dtype,t.length);for(let u=0;u<o.length;u++)l.setItem(u,o[u]);return l}(r,o1("lengths",e,t,n),s);return n.addTensorList(a),[a.idTensor]}case"TensorListLength":{const r=o1("tensorListId",e,t,n);return[uB(n.getTensorList(r.id).size(),"int32")]}case"TensorListResize":{const r=o1("tensorListId",e,t,n),s=o1("size",e,t,n),a=n.getTensorList(r.id).resize(s);return n.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};function r2(e,t,n){const[r,s]=o1("fusedOps",e,t,n),a="biasadd"===r,i=!a,o="prelu"===s,l="fusedbatchnorm"===r,u=o1("numArgs",e,t,n);if(a){if(o&&2!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&a&&1!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=o1("strides",e,t,n),d=p1(e,t,n),h=o1("dataFormat",e,t,n).toUpperCase(),p=o1("dilations",e,t,n);let[f,m]=o1("args",e,t,n);i&&(m=f,f=void 0);return{stride:c,pad:d,dataFormat:h,dilations:p,biasArg:f,preluArg:m,activationFunc:s,leakyreluAlpha:o1("leakyreluAlpha",e,t,n)}}function s2(e,t,n){return{boxes:o1("boxes",e,t,n),scores:o1("scores",e,t,n),maxOutputSize:o1("maxOutputSize",e,t,n),iouThreshold:o1("iouThreshold",e,t,n),scoreThreshold:o1("scoreThreshold",e,t,n),softNmsSigma:o1("softNmsSigma",e,t,n)}}class a2{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=uB(0),this.tensorMap=new Map,HP(this.handle)}clearAndClose(){this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return uB(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),WP((()=>{const e=hG(t),r=n.length,s=e.length;hO(r===s,(()=>`The number of elements doesn't match, keys has ${r} elements, the values has ${s} elements.`));for(let t=0;t<r;t++){const r=n[t],s=e[t];HP(s),this.tensorMap.set(r,s)}return this.handle}))}async find(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return WP((()=>{const e=[];for(let r=0;r<n.length;r++){const s=n[r],a=this.findWithDefault(s,t);e.push(a)}return XW(e)}))}findWithDefault(e,t){const n=this.tensorMap.get(e);return null!=n?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}function i2(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:WP;const a=((e,t,n)=>{switch(e.category){case"arithmetic":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(o1("a",e,t,n),o1("b",e,t,n))];case"AddN":return[r.addN(o1("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(o1("a",e,t,n),o1("b",e,t,n))];case"Mul":return[r.mul(o1("a",e,t,n),o1("b",e,t,n))];case"RealDiv":case"Div":return[r.div(o1("a",e,t,n),o1("b",e,t,n))];case"DivNoNan":return[r.divNoNan(o1("a",e,t,n),o1("b",e,t,n))];case"FloorDiv":return[r.floorDiv(o1("a",e,t,n),o1("b",e,t,n))];case"Sub":return[r.sub(o1("a",e,t,n),o1("b",e,t,n))];case"Minimum":return[r.minimum(o1("a",e,t,n),o1("b",e,t,n))];case"Maximum":return[r.maximum(o1("a",e,t,n),o1("b",e,t,n))];case"Pow":return[r.pow(o1("a",e,t,n),o1("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(o1("a",e,t,n),o1("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"basic_math":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(o1("x",e,t,n))];case"Acos":return[r.acos(o1("x",e,t,n))];case"Acosh":return[r.acosh(o1("x",e,t,n))];case"Asin":return[r.asin(o1("x",e,t,n))];case"Asinh":return[r.asinh(o1("x",e,t,n))];case"Atan":return[r.atan(o1("x",e,t,n))];case"Atan2":return[r.atan2(o1("x",e,t,n),o1("y",e,t,n))];case"Atanh":return[r.atanh(o1("x",e,t,n))];case"Ceil":return[r.ceil(o1("x",e,t,n))];case"Complex":return[r.complex(o1("real",e,t,n),o1("imag",e,t,n))];case"Cos":return[r.cos(o1("x",e,t,n))];case"Cosh":return[r.cosh(o1("x",e,t,n))];case"Elu":return[r.elu(o1("x",e,t,n))];case"Erf":return[r.erf(o1("x",e,t,n))];case"Exp":return[r.exp(o1("x",e,t,n))];case"Expm1":return[r.expm1(o1("x",e,t,n))];case"Floor":return[r.floor(o1("x",e,t,n))];case"Log":return[r.log(o1("x",e,t,n))];case"Log1p":return[r.log1p(o1("x",e,t,n))];case"Imag":return[r.imag(o1("x",e,t,n))];case"Neg":return[r.neg(o1("x",e,t,n))];case"Reciprocal":return[r.reciprocal(o1("x",e,t,n))];case"Real":return[r.real(o1("x",e,t,n))];case"Relu":return[r.relu(o1("x",e,t,n))];case"Round":return[r.round(o1("x",e,t,n))];case"Selu":return[r.selu(o1("x",e,t,n))];case"Sigmoid":return[r.sigmoid(o1("x",e,t,n))];case"Sin":return[r.sin(o1("x",e,t,n))];case"Sign":return[r.sign(o1("x",e,t,n))];case"Sinh":return[r.sinh(o1("x",e,t,n))];case"Softplus":return[r.softplus(o1("x",e,t,n))];case"Sqrt":return[r.sqrt(o1("x",e,t,n))];case"Square":return[r.square(o1("x",e,t,n))];case"Tanh":return[r.tanh(o1("x",e,t,n))];case"Tan":return[r.tan(o1("x",e,t,n))];case"ClipByValue":return[r.clipByValue(o1("x",e,t,n),o1("clipValueMin",e,t,n),o1("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(o1("x",e,t,n))];case"Rsqrt":return[r.rsqrt(l1(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(o1("x",e,t,n),o1("alpha",e,t,n))];case"Prelu":return[r.prelu(o1("x",e,t,n),o1("alpha",e,t,n))];case"IsNan":return[r.isNaN(l1(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(l1(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(l1(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"control":return n2(e,t,n);case"convolution":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Conv1D":{const s=o1("stride",e,t,n),a=o1("pad",e,t,n),i=o1("dataFormat",e,t,n).toUpperCase(),o=o1("dilation",e,t,n);return[r.conv1d(o1("x",e,t,n),o1("filter",e,t,n),s,a,i,o)]}case"Conv2D":{const s=o1("strides",e,t,n),a=p1(e,t,n),i=o1("dataFormat",e,t,n).toUpperCase(),o=o1("dilations",e,t,n);return[r.conv2d(o1("x",e,t,n),o1("filter",e,t,n),[s[1],s[2]],a,i,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:s,pad:a,dataFormat:i,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=r2(e,t,n);return[r.fused.conv2d({x:o1("x",e,t,n),filter:o1("filter",e,t,n),strides:[s[1],s[2]],pad:a,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:a,dataFormat:i,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=r2(e,t,n);return[r.fused.depthwiseConv2d({x:o1("x",e,t,n),filter:o1("filter",e,t,n),strides:[s[1],s[2]],pad:a,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=o1("outputShape",e,t,n),a=o1("strides",e,t,n),i=p1(e,t,n);return[r.conv2dTranspose(o1("x",e,t,n),o1("filter",e,t,n),s,[a[1],a[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=o1("strides",e,t,n),a=p1(e,t,n),i=o1("dilations",e,t,n),o=o1("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(o1("input",e,t,n),o1("filter",e,t,n),[s[1],s[2]],a,o,[i[1],i[2]])]}case"Conv3D":{const s=o1("strides",e,t,n),a=o1("pad",e,t,n),i=o1("dataFormat",e,t,n).toUpperCase(),o=o1("dilations",e,t,n);return[r.conv3d(o1("x",e,t,n),o1("filter",e,t,n),[s[1],s[2],s[3]],a,i,[o[1],o[2],o[3]])]}case"AvgPool":{const s=o1("strides",e,t,n),a=o1("pad",e,t,n),i=o1("kernelSize",e,t,n);return[r.avgPool(o1("x",e,t,n),[i[1],i[2]],[s[1],s[2]],a)]}case"MaxPool":{const s=o1("strides",e,t,n),a=o1("pad",e,t,n),i=o1("kernelSize",e,t,n);return[r.maxPool(o1("x",e,t,n),[i[1],i[2]],[s[1],s[2]],a)]}case"MaxPoolWithArgmax":{const s=o1("strides",e,t,n),a=o1("pad",e,t,n),i=o1("kernelSize",e,t,n),o=o1("includeBatchInIndex",e,t,n),{result:l,indexes:u}=r.maxPoolWithArgmax(o1("x",e,t,n),[i[1],i[2]],[s[1],s[2]],a,o);return[l,u]}case"AvgPool3D":{const s=o1("strides",e,t,n),a=o1("pad",e,t,n),i=o1("kernelSize",e,t,n);return[r.avgPool3d(o1("x",e,t,n),[i[1],i[2],i[3]],[s[1],s[2],s[3]],a)]}case"MaxPool3D":{const s=o1("strides",e,t,n),a=o1("pad",e,t,n),i=o1("kernelSize",e,t,n);return[r.maxPool3d(o1("x",e,t,n),[i[1],i[2],i[3]],[s[1],s[2],s[3]],a)]}case"Dilation2D":{const s=o1("strides",e,t,n),a=o1("pad",e,t,n),i=o1("dilations",e,t,n),o=s[1],l=s[2],u=i[1],c=i[2];return[r.dilation2d(o1("x",e,t,n),o1("filter",e,t,n),[o,l],a,[u,c],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"creation":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Fill":{const s=o1("shape",e,t,n),a=o1("dtype",e,t,n),i=o1("value",e,t,n);return[r.fill(s,i,a)]}case"LinSpace":{const s=o1("start",e,t,n),a=o1("stop",e,t,n),i=o1("num",e,t,n);return[r.linspace(s,a,i)]}case"Multinomial":{const s=o1("logits",e,t,n),a=o1("numSamples",e,t,n),i=o1("seed",e,t,n);return[r.multinomial(s,a,i)]}case"OneHot":{const s=o1("indices",e,t,n),a=o1("depth",e,t,n),i=o1("onValue",e,t,n),o=o1("offValue",e,t,n),l=o1("dtype",e,t,n);return[r.oneHot(s,a,i,o,l)]}case"Ones":return[r.ones(o1("shape",e,t,n),o1("dtype",e,t,n))];case"OnesLike":return[r.onesLike(o1("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(o1("shape",e,t,n),o1("dtype",e,t,n),o1("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(o1("shape",e,t,n),o1("minval",e,t,n),o1("maxval",e,t,n),o1("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(o1("shape",e,t,n),o1("minval",e,t,n),o1("maxval",e,t,n),o1("seed",e,t,n))];case"Range":{const s=o1("start",e,t,n),a=o1("stop",e,t,n),i=o1("step",e,t,n);return[r.range(s,a,i,o1("dtype",e,t,n))]}case"TruncatedNormal":{const s=o1("shape",e,t,n),a=o1("mean",e,t,n),i=o1("stdDev",e,t,n),o=o1("seed",e,t,n);return[r.truncatedNormal(s,a,i,o1("dtype",e,t,n),o)]}case"Zeros":return[r.zeros(o1("shape",e,t,n),o1("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(o1("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"dynamic":return async function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:C;switch(e.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:a,maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=s2(e,t,n),c=await s.image.nonMaxSuppressionWithScoreAsync(r,a,i,o,l,u);return[c.selectedIndices,c.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:a,maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s2(e,t,n),u=o1("padToMaxOutputSize",e,t,n),c=await s.image.nonMaxSuppressionPaddedAsync(r,a,i,o,l,u);return[c.selectedIndices,c.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:a,maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s2(e,t,n);return[await s.image.nonMaxSuppressionAsync(r,a,i,o,l)]}case"Where":{const r=s.cast(o1("condition",e,t,n),"bool"),a=[await s.whereAsync(r)];return r.dispose(),a}case"ListDiff":return s.setdiff1dAsync(o1("x",e,t,n),o1("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n);case"evaluation":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"LowerBound":{const s=o1("sortedSequence",e,t,n),a=o1("values",e,t,n);return[r.lowerBound(s,a)]}case"TopKV2":{const s=o1("x",e,t,n),a=o1("k",e,t,n),i=o1("sorted",e,t,n),o=r.topk(s,a,i);return[o.values,o.indices]}case"UpperBound":{const s=o1("sortedSequence",e,t,n),a=o1("values",e,t,n);return[r.upperBound(s,a)]}case"Unique":{const s=o1("x",e,t,n),a=r.unique(s);return[a.values,a.indices]}case"UniqueV2":{const s=o1("x",e,t,n),a=o1("axis",e,t,n),i=r.unique(s,a);return[i.values,i.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"image":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"ResizeBilinear":{const s=o1("images",e,t,n),a=o1("size",e,t,n),i=o1("alignCorners",e,t,n),o=o1("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(s,[a[0],a[1]],i,o)]}case"ResizeNearestNeighbor":{const s=o1("images",e,t,n),a=o1("size",e,t,n),i=o1("alignCorners",e,t,n),o=o1("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(s,[a[0],a[1]],i,o)]}case"CropAndResize":{const s=o1("image",e,t,n),a=o1("boxes",e,t,n),i=o1("boxInd",e,t,n),o=o1("cropSize",e,t,n),l=o1("method",e,t,n),u=o1("extrapolationValue",e,t,n);return[r.image.cropAndResize(s,a,i,o,l,u)]}case"ImageProjectiveTransformV3":{const s=o1("images",e,t,n),a=o1("transforms",e,t,n),i=o1("outputShape",e,t,n),o=o1("fillValue",e,t,n),l=o1("interpolation",e,t,n),u=o1("fillMode",e,t,n);return[r.image.transform(s,a,l.toLowerCase(),u.toLowerCase(),o,i)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"graph":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const s=o1("default",e,t,n);return[l1(e.name,t,n)||s];case"Placeholder":return[l1(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[f1(o1("x",e,t,n))];case"IdentityN":return o1("x",e,t,n).map((e=>f1(e)));case"Shape":return[r.tensor1d(o1("x",e,t,n).shape,"int32")];case"ShapeN":return o1("x",e,t,n).map((e=>r.tensor1d(e.shape)));case"Size":return[r.scalar(o1("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(o1("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const a=o1("x",e,t,n),i=o1("data",e,t,n),o=o1("message",e,t,n),l=o1("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(let e=0;e<i.length;e++)console.log(Array.prototype.slice.call(i[e].dataSync()).slice(0,l));return[a];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"logical":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Equal":return[r.equal(o1("a",e,t,n),o1("b",e,t,n))];case"NotEqual":return[r.notEqual(o1("a",e,t,n),o1("b",e,t,n))];case"Greater":return[r.greater(o1("a",e,t,n),o1("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(o1("a",e,t,n),o1("b",e,t,n))];case"Less":return[r.less(o1("a",e,t,n),o1("b",e,t,n))];case"LessEqual":return[r.lessEqual(o1("a",e,t,n),o1("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(o1("a",e,t,n),o1("b",e,t,n))];case"LogicalNot":return[r.logicalNot(o1("a",e,t,n))];case"LogicalOr":return[r.logicalOr(o1("a",e,t,n),o1("b",e,t,n))];case"Select":case"SelectV2":return[r.where(o1("condition",e,t,n),o1("a",e,t,n),o1("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(o1("a",e,t,n),o1("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"matrices":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(o1("a",e,t,n),o1("b",e,t,n),o1("transposeA",e,t,n),o1("transposeB",e,t,n))];case"Einsum":return[r.einsum(o1("equation",e,t,n),...o1("tensors",e,t,n))];case"Transpose":return[r.transpose(o1("x",e,t,n),o1("perm",e,t,n))];case"_FusedMatMul":const[s,a]=o1("fusedOps",e,t,n),i="biasadd"===s,o="prelu"===a,l=o1("numArgs",e,t,n),u=o1("leakyreluAlpha",e,t,n);if(i){if(o&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=o1("args",e,t,n);return[r.fused.matMul({a:o1("a",e,t,n),b:o1("b",e,t,n),transposeA:o1("transposeA",e,t,n),transposeB:o1("transposeB",e,t,n),bias:c,activation:a,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[r.linalg.bandPart(o1("a",e,t,n),o1("numLower",e,t,n),o1("numUpper",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"normalization":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(o1("x",e,t,n),o1("axis",e,t,n),o1("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(o1("x",e,t,n),o1("mean",e,t,n),o1("variance",e,t,n),o1("offset",e,t,n),o1("scale",e,t,n),o1("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(o1("x",e,t,n),o1("radius",e,t,n),o1("bias",e,t,n),o1("alpha",e,t,n),o1("beta",e,t,n))];case"Softmax":return[r.softmax(o1("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(o1("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"ragged":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"RaggedGather":{const{outputNestedSplits:s,outputDenseValues:a}=r.raggedGather(o1("paramsNestedSplits",e,t,n),o1("paramsDenseValues",e,t,n),o1("indices",e,t,n),o1("outputRaggedRank",e,t,n));return s.concat(a)}case"RaggedRange":{const{rtNestedSplits:s,rtDenseValues:a}=r.raggedRange(o1("starts",e,t,n),o1("limits",e,t,n),o1("splits",e,t,n));return[s,a]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(o1("shape",e,t,n),o1("values",e,t,n),o1("defaultValue",e,t,n),o1("rowPartitionTensors",e,t,n),o1("rowPartitionTypes",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"reduction":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Max":{const s=o1("axis",e,t,n),a=o1("keepDims",e,t,n);return[r.max(o1("x",e,t,n),s,a)]}case"Mean":{const s=o1("axis",e,t,n),a=o1("keepDims",e,t,n);return[r.mean(o1("x",e,t,n),s,a)]}case"Min":{const s=o1("axis",e,t,n),a=o1("keepDims",e,t,n);return[r.min(o1("x",e,t,n),s,a)]}case"Sum":{const s=o1("axis",e,t,n),a=o1("keepDims",e,t,n);return[r.sum(o1("x",e,t,n),s,a)]}case"All":{const s=o1("axis",e,t,n),a=o1("keepDims",e,t,n);return[r.all(o1("x",e,t,n),s,a)]}case"Any":{const s=o1("axis",e,t,n),a=o1("keepDims",e,t,n);return[r.any(o1("x",e,t,n),s,a)]}case"ArgMax":{const s=o1("axis",e,t,n);return[r.argMax(o1("x",e,t,n),s)]}case"ArgMin":{const s=o1("axis",e,t,n);return[r.argMin(o1("x",e,t,n),s)]}case"Prod":{const s=o1("axis",e,t,n),a=o1("keepDims",e,t,n);return[r.prod(o1("x",e,t,n),s,a)]}case"Cumprod":{const s=o1("axis",e,t,n),a=o1("exclusive",e,t,n),i=o1("reverse",e,t,n);return[r.cumprod(o1("x",e,t,n),s,a,i)]}case"Cumsum":{const s=o1("axis",e,t,n),a=o1("exclusive",e,t,n),i=o1("reverse",e,t,n);return[r.cumsum(o1("x",e,t,n),s,a,i)]}case"Bincount":const s=o1("x",e,t,n),a=o1("weights",e,t,n),i=o1("size",e,t,n);return[r.bincount(s,a,i)];case"DenseBincount":{const s=o1("x",e,t,n),a=o1("weights",e,t,n),i=o1("size",e,t,n),o=o1("binaryOutput",e,t,n);return[r.denseBincount(s,a,i,o)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"slice_join":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"ConcatV2":case"Concat":{const s=o1("n",e,t,n),a=o1("axis",e,t,n);let i=o1("tensors",e,t,n);return i=i.slice(0,s),[r.concat(i,a)]}case"Gather":{const s=o1("x",e,t,n),a=o1("indices",e,t,n);return[r.gather(s,r.cast(a,"int32"),0)]}case"GatherV2":{const s=o1("axis",e,t,n),a=o1("batchDims",e,t,n),i=o1("x",e,t,n),o=o1("indices",e,t,n);return[r.gather(i,r.cast(o,"int32"),s,a)]}case"Reverse":{const s=o1("dims",e,t,n),a=[];for(let e=0;e<s.length;e++)s[e]&&a.push(e);const i=o1("x",e,t,n);return[r.reverse(i,a)]}case"ReverseV2":{const s=o1("axis",e,t,n),a=o1("x",e,t,n);return[r.reverse(a,s)]}case"Slice":{const s=o1("begin",e,t,n),a=o1("size",e,t,n);return[r.slice(o1("x",e,t,n),s,a)]}case"StridedSlice":{const s=o1("begin",e,t,n),a=o1("end",e,t,n),i=o1("strides",e,t,n),o=o1("beginMask",e,t,n),l=o1("endMask",e,t,n),u=o1("ellipsisMask",e,t,n),c=o1("newAxisMask",e,t,n),d=o1("shrinkAxisMask",e,t,n),h=o1("x",e,t,n);return[r.stridedSlice(h,s,a,i,o,l,u,c,d)]}case"Pack":return WP((()=>{const s=o1("axis",e,t,n),a=o1("tensors",e,t,n),i=a[0].shape,o=r.squeeze(a[0]).shape,l=a.map((e=>{const t=gO(e.shape,i);if(!t&&!gO(r.squeeze(e).shape,o))throw new Error("the input tensors shape does not match");return t?e:r.reshape(e,i)}));return[r.stack(l,s)]}));case"Unpack":{const s=o1("axis",e,t,n),a=o1("tensor",e,t,n);return r.unstack(a,s)}case"Tile":{const s=o1("reps",e,t,n);return[r.tile(o1("x",e,t,n),s)]}case"Split":case"SplitV":{const s=o1("axis",e,t,n),a=o1("numOrSizeSplits",e,t,n),i=o1("x",e,t,n);return r.split(i,a,s)}case"ScatterNd":{const s=o1("indices",e,t,n),a=o1("values",e,t,n),i=o1("shape",e,t,n);return[r.scatterND(s,a,i)]}case"GatherNd":{const s=o1("x",e,t,n),a=o1("indices",e,t,n);return[r.gatherND(s,a)]}case"SparseToDense":{const s=o1("sparseIndices",e,t,n),a=o1("outputShape",e,t,n),i=o1("sparseValues",e,t,n),o=o1("defaultValue",e,t,n);return[r.sparseToDense(s,i,a,i.dtype===o.dtype?o:r.cast(o,i.dtype))]}case"TensorScatterUpdate":{const s=o1("indices",e,t,n),a=o1("values",e,t,n),i=o1("tensor",e,t,n);return[r.tensorScatterUpdate(i,s,a)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"sparse":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:a,emptyRowIndicator:i,reverseIndexMap:o}=r.sparse.sparseFillEmptyRows(o1("indices",e,t,n),o1("values",e,t,n),o1("denseShape",e,t,n),o1("defaultValue",e,t,n));return[s,a,i,o]}case"SparseReshape":{const{outputIndices:s,outputShape:a}=r.sparse.sparseReshape(o1("inputIndices",e,t,n),o1("inputShape",e,t,n),o1("newShape",e,t,n));return[s,a]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(o1("data",e,t,n),o1("indices",e,t,n),o1("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(o1("data",e,t,n),o1("indices",e,t,n),o1("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"spectral":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"FFT":return[r.fft(o1("x",e,t,n))];case"IFFT":return[r.ifft(o1("x",e,t,n))];case"RFFT":return[r.rfft(o1("x",e,t,n))];case"IRFFT":return[r.irfft(o1("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"string":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(o1("input",e,t,n),o1("pattern",e,t,n),o1("rewrite",e,t,n),o1("replaceGlobal",e,t,n))];case"StringNGrams":{const{nGrams:s,nGramsSplits:a}=r.string.stringNGrams(o1("data",e,t,n),o1("dataSplits",e,t,n),o1("separator",e,t,n),o1("nGramWidths",e,t,n),o1("leftPad",e,t,n),o1("rightPad",e,t,n),o1("padWidth",e,t,n),o1("preserveShortSequences",e,t,n));return[s,a]}case"StringSplit":{const{indices:s,values:a,shape:i}=r.string.stringSplit(o1("input",e,t,n),o1("delimiter",e,t,n),o1("skipEmpty",e,t,n));return[s,a,i]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(o1("input",e,t,n),o1("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"transformation":return s((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Cast":return[r.cast(o1("x",e,t,n),o1("dtype",e,t,n))];case"ExpandDims":{const s=o1("axis",e,t,n);return[r.expandDims(o1("x",e,t,n),s)]}case"Squeeze":{const s=o1("axis",e,t,n);return[r.squeeze(o1("x",e,t,n),s)]}case"Reshape":return[r.reshape(o1("x",e,t,n),o1("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(o1("x",e,t,n),o1("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(o1("x",e,t,n),o1("padding",e,t,n),o1("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(o1("x",e,t,n),o1("padding",e,t,n),o1("constantValue",e,t,n))];case"SpaceToBatchND":{const s=o1("blockShape",e,t,n),a=o1("paddings",e,t,n);return[r.spaceToBatchND(o1("x",e,t,n),s,a)]}case"BatchToSpaceND":{const s=o1("blockShape",e,t,n),a=o1("crops",e,t,n);return[r.batchToSpaceND(o1("x",e,t,n),s,a)]}case"DepthToSpace":{const s=o1("blockSize",e,t,n),a=o1("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(o1("x",e,t,n),s,a)]}case"BroadcastTo":return[r.broadcastTo(o1("x",e,t,n),o1("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(o1("s0",e,t,n),o1("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}}(e,t,n)));case"hash_table":return(async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{const s=r.getHashTableHandleByName(e.name);if(null!=s)return[s];{const s=o1("keyDType",e,t,n),a=o1("valueDType",e,t,n),i=new a2(s,a);return r.addHashTable(e.name,i),[i.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=o1("tableHandle",e,t,n,r),a=o1("keys",e,t,n),i=o1("values",e,t,n),o=r.getHashTableById(s.id);return[await o.import(a,i)]}case"LookupTableFind":case"LookupTableFindV2":{const s=o1("tableHandle",e,t,n,r),a=o1("keys",e,t,n),i=o1("defaultValue",e,t,n),o=r.getHashTableById(s.id);return[await o.find(a,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=o1("tableHandle",e,t,n,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n,r);case"custom":const a=i1(e.op);if(a&&a.customExecutor)return a.customExecutor(new X1(e,t,n));throw TypeError(`Custom op ${e.op} is not registered.`);default:throw TypeError(`Unknown op '${e.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return UO(a)?a.then((e=>[].concat(e))):[].concat(a)}class o2{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map((e=>0===e.id&&0===e.iterationId?"":`${e.frameName}-${e.iterationId}`)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}function l2(e,t,n,r){const s=new Set,a=[];let i=null,o=null;const l=new Set,u=new Set(Object.keys(e).map((e=>h1(e)[0])));r=r||[];const c=new Set(r.map((e=>h1(e.name)[0]))),d=[...t];for(;d.length>0;){const e=d.pop();(f2(e)||m2(e)||g2(e))&&null==i&&(i=e,o=i.children.map((e=>e.name)).filter((e=>s.has(e)))),s.add(e.name),null==n[e.name]&&(u.has(e.name)||c.has(e.name)||(0!==e.inputs.length?e.inputs.forEach((e=>{l.has(e.name)||(l.add(e.name),d.push(e))})):a.push(e.name)))}return{inputs:e,outputs:t,usedNodes:s,missingInputs:a,dynamicNode:i,syncInputs:o}}function u2(e,t){const{usedNodes:n,inputs:r}=t,s=Object.keys(r).map((e=>h1(e)[0])).map((t=>e.nodes[t])),a=e.initNodes||[],i=e=>n.has("string"===typeof e?e:e.name);function o(e){return[...new Map(e.map((e=>[e.name,e]))).values()]}const l=o([...s,...e.weights,...a]).filter(i),u=o([...l,...Object.values(e.nodes)]).filter(i),c=new Map(u.map((e=>[e.name,e]))),d={};for(const m of u){d[m.name]=d[m.name]||0;for(const e of m.children)i(e)||(d[e.name]=Number.POSITIVE_INFINITY),d[e.name]=(d[e.name]||0)+1}const h=Object.entries(d).filter((e=>{let[,t]=e;return 0===t})).map((e=>{let[t]=e;return t})),p=[...h];for(;h.length>0;){const e=h.pop(),t=c.get(e);for(const n of t.children.filter(i))0===--d[n.name]&&(p.push(n.name),h.push(n.name))}const f=function(e,t){const n=new Map(e.map((e=>[e.name,e]))),r=t.map((e=>e.name)),s=new Set(r);for(;r.length>0;){const e=r.pop(),t=n.get(e);for(const a of t.children)n.has(a.name)&&!s.has(a.name)&&(s.add(a.name),r.push(a.name))}const a=e.filter((e=>s.has(e.name)));return a}(p.map((e=>c.get(e))),l);return function(e,t){const n=new Map(e.map(((e,t)=>[e.name,t]))),r=new Set(t.map((e=>e.name))),s=e=>r.has("string"===typeof e?e:e.name),a=new Set(e.map((e=>e.name))),i=e=>a.has("string"===typeof e?e:e.name);for(const o of e){for(const e of o.children.filter(i)){if(!n.has(e.name))throw new c2(`Child ${e.name} of node ${o.name} is unreachable.`);if(n.get(o.name)>n.get(e.name))throw new c2(`Node ${o.name} is scheduled to run after its child ${e.name}.`)}if(!s(o))for(const e of o.inputs){if(!n.has(e.name))throw new c2(`Input ${e.name} of node ${o.name} is unreachable.`);if(n.get(e.name)>n.get(o.name))throw new c2(`Node ${o.name} is scheduled to run before its input ${e.name}.`)}}}(f,l),f}class c2 extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}const d2=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),h2=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),p2=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function f2(e){return d2.has(e.op)}function m2(e){return h2.has(e.op)}function g2(e){return p2.has(e.op)}class y2{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map((t=>e[t].map((e=>e.id))));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get outputs(){return this._outputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get inputNodes(){return this._inputs.map((e=>e.signatureKey||e.name))}get outputNodes(){return this._outputs.map((e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t}))}get functions(){return Object.keys(this._functions).reduce(((e,t)=>(e[t]=this._functions[t].signature,e)),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach((t=>{this._functionExecutorMap[t]=new y2(e.functions[t],this)}))}getCompilationKey(e,t){const n=e.map((e=>e.name)).sort(),r=t.map((e=>e.name)).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,t){const n=l2(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:s,syncInputs:a}=n;if(null!=s)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${a}]`);if(r.length>0){const n=t.map((e=>e.name)),s=Object.keys(e);throw new Error(`Cannot compute the outputs [${n}] from the provided inputs [${s}]. Missing the following inputs: [${r}]`)}const i=u2(this.graph,n),o=function(e){const t=new Map(e.map(((e,t)=>[e.name,t]))),n=Number.MAX_SAFE_INTEGER,r=e.map(((e,t)=>f2(e)?n:t)),s=e=>{const n=r[t.get(e.name)];return null==n?-1:n},a=e.map(((e,t)=>e.children.map(s).reduce(((e,t)=>Math.max(e,t)),r[t]))),i=new Map;for(let o=0;o<e.length;++o){const t=a[o];if(t===n)continue;const r=e[o],s=e[t];i.has(s.name)||i.set(s.name,[]),i.get(s.name).push(r)}return i}(i);return{orderedNodes:i,nodeLiveUntilMap:o}}cloneAndKeepTensor(e){if(null==e)return null;const t=e.clone();return HP(t),t}cloneTensorList(e){if(!e)return null;return e.map((e=>this.cloneAndKeepTensor(e)))}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map((e=>{let[t,n]=e;return[t,this.cloneTensorList(n)]})))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=n.map((e=>this.graph.nodes[h1(e)[0]])),s=t.map((e=>h1(e)[0])),a=new Set(s);let i=s.map((e=>this.graph.nodes[e]));0===i.length&&(i=this._outputs);const o=this.getCompilationKey(r,i);let l=this.compiledMap.get(o);null==l&&(l=this.compile(e,i),this.compiledMap.set(o,l));try{this.keepIntermediateTensors=HO().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(Ipe){this.keepIntermediateTensors=!1,console.warn(Ipe.message)}const u={},c={};return WP((()=>{const n=new o2(this.weightMap,u,c,this.functionExecutorMap,this.parseNodeNameCache),r=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach((t=>{const[s,a]=h1(t,n),i=[];i[a]=e[t],r[s]=i,this.keepIntermediateTensors&&(this.clonedTensorsMap[s]=this.cloneTensorList(i))}));const s=this.getFrozenTensorIds(r),{orderedNodes:i,nodeLiveUntilMap:o}=l;for(const e of i){if(r[e.name])continue;const t=i2(e,r,n,this._resourceManager);if(UO(t))throw new Error(`The execution of the op '${e.op}' returned a promise. Please use model.executeAsync() instead.`);r[e.name]=t,this.keepIntermediateTensors&&(this.clonedTensorsMap[e.name]=this.cloneTensorList(t)),this.checkTensorForDisposalWithNodeLiveUntilInfo(e,r,n,s,a,o.get(e.name))}return null==this.parent&&n.dispose(s),t.map((e=>l1(e,r,n)))}))}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map((t=>e[t])).map((e=>e.map((e=>e.id)))));return new Set(t)}checkTensorForDisposal(e,t,n,r,s,a,i){if(!f2(t)&&!a.has(e)){for(const r of n[e])null!=r&&(i[r.id]=(i[r.id]||0)+t.children.length);for(const e of t.inputs){if(f2(e))continue;const t=u1(e.name,n,r);if(null!=t)for(const e of t){if(!e||e.kept||s.has(e.id))continue;const t=i[e.id];1===t?(e.dispose(),delete i[e.id]):null!=t&&i[e.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,r,s,a){function i(e){return f2(e)||s.has(e.name)}if(!f2(e)&&null!=a)for(const o of a){if(i(o))continue;const e=u1(o.name,t,n);for(const t of e)!t||t.kept||r.has(t.id)||t.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach((e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()})),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=HO().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(Ipe){this.keepIntermediateTensors=!1,console.warn(Ipe.message)}const a=new o2(this.weightMap,r,s,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const i=await this.executeWithControlFlow(e,a,t,n),o=t.map((e=>l1(e,i,a))),l=o.map((e=>e.id)),u=Object.keys(e).map((t=>e[t].id)),c=new Set([...l,...u,...this.weightIds]);return Object.values(i).forEach((e=>{e.forEach((e=>{!e||e.isDisposed||c.has(e.id)||e.dispose()}))})),null==this.parent&&a.dispose(c),o}async executeFunctionAsync(e,t,n){const r=e.reduce(((e,t,n)=>(e[this.inputs[n].name]=t,e)),{});return this._executeAsync(r,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,r){const s=Object.keys(e),a=s.map((e=>this.graph.nodes[h1(e)[0]])),i=n.map((e=>h1(e)[0])),o=new Set(i);let l=i.map((e=>this.graph.nodes[e]));0===l.length&&(l=this._outputs);const{usedNodes:u,missingInputs:c,dynamicNode:d,syncInputs:h}=l2(e,l,this.weightMap,this._initNodes),p=[...a,...this.graph.weights,...this._initNodes||[]].map((e=>({node:e,contexts:t.currentContext}))),f=Object.assign({},this.weightMap);Object.keys(e).forEach((t=>{const[n,r]=h1(t),s=[];s[r]=e[t],f[n]=s}));const m={},g=this.getFrozenTensorIds(f),y={};for(;p.length>0;){const e=this.processStack(a,p,t,f,y,g,o,m,u);await Promise.all(e)}null!=d||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const v=l.filter((e=>!f2(e)&&!l1(e.name,f,t))).map((e=>e.name));if(v.length>0){let e="";throw null!=d&&(e=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${v}] from the provided inputs [${s}]. Consider providing the following inputs: [${c}]. ${e}`)}return f}processStack(e,t,n,r,s,a,i,o,l){const u=[];for(;t.length>0;){const e=t.pop();n.currentContext=e.contexts;let c="";if("Enter"===e.node.op&&o1("isConstant",e.node,r,n)&&([c]=c1(e.node.name,n)),null==r[e.node.name]){const d=i2(e.node,r,n,this._resourceManager);c||([c]=c1(e.node.name,n));const h=n.currentContext;UO(d)?u.push(d.then((u=>(r[c]=u,this.keepIntermediateTensors&&(this.clonedTensorsMap[c]=this.cloneTensorList(u)),n.currentContext=h,this.checkTensorForDisposal(c,e.node,r,n,a,i,o),this.processChildNodes(e.node,t,n,r,s,l),u)))):(r[c]=d,this.keepIntermediateTensors&&(this.clonedTensorsMap[c]=this.cloneTensorList(d)),this.checkTensorForDisposal(c,e.node,r,n,a,i,o),this.processChildNodes(e.node,t,n,r,s,l))}else this.processChildNodes(e.node,t,n,r,s,l)}return u}processChildNodes(e,t,n,r,s,a){e.children.forEach((e=>{const[i]=c1(e.name,n);!s[i]&&a.has(e.name)&&("Merge"===e.op?e.inputNames.some((e=>!!l1(e,r,n)))&&(s[i]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((e=>!!l1(e,r,n)))&&(s[i]=!0,t.push({contexts:n.currentContext,node:e})))}))}dispose(){Object.keys(this.weightMap).forEach((e=>this.weightMap[e].forEach((e=>e.dispose()))))}checkInputShapeAndType(e){Object.keys(e).forEach((t=>{const n=e[t],[r]=h1(t),s=this.graph.nodes[r];if(s.attrParams.shape&&s.attrParams.shape.value){const e=s.attrParams.shape.value;hO(e.length===n.shape.length&&n.shape.every(((t,n)=>-1===e[n]||e[n]===t)),(()=>`The shape of dict['${s.name}'] provided in model.execute(dict) must be [${e}], but was [${n.shape}]`))}s.attrParams.dtype&&s.attrParams.dtype.value&&hO(n.dtype===s.attrParams.dtype.value,(()=>`The dtype of dict['${s.name}'] provided in model.execute(dict) must be ${s.attrParams.dtype.value}, but was ${n.dtype}`))}))}mapInputs(e){var t,n;const r={};for(const s in e){const a=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[s];null!=a?r[a.name]=e[s]:r[s]=e[s]}return r}checkInputs(e){const t=Object.keys(e).filter((e=>{const[t]=h1(e);return null==this.graph.nodes[t]}));if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map((e=>{var t,n;const r=null===(n=null===(t=this._signature)||void 0===t?void 0:t.outputs)||void 0===n?void 0:n[e];return null!=r?r.name:e}),{})}checkOutputs(e){e.forEach((e=>{const[t]=h1(e);if(!this.graph.nodes[t])throw new Error(`The output '${e}' is not found in the graph`)}))}}class v2{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}const b2="?tfjs-format=file",x2="model.json";class w2{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.modelUrl=t,this.loadOptions=n,this.version="n/a",this.io=r,null==n&&(this.loadOptions={}),this.resourceManager=new v2}findIOHandler(){const e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return UO(e)?e.then((e=>null==e.getWeightStream?this.loadSync(e):this.loadStreaming(e))):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(null==e.getWeightStream)throw new Error("Model artifacts missing streamWeights function");const t=await nz(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const n=this.artifacts.modelTopology;let r=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const e=this.artifacts.userDefinedMetadata;null!=e.signature&&(r=e.signature),null!=e.structuredOutputKeys&&(this.structuredOutputKeys=e.structuredOutputKeys)}if(this.signature=r,this.version=`${n.versions.producer}.${n.versions.minConsumer}`,this.executor=new y2(D1.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){const t=D1.Instance.transformGraph(e.modelInitializer);this.initializer=new y2(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if("string"===typeof e){const t=this.io.getSaveHandlers(e);if(0===t.length)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new Error(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t={};return(e instanceof JL?[e]:e).forEach(((e,n)=>t[this.structuredOutputKeys[n]]=e)),t}return e}predict(e,t){const n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){const n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof JL)&&!Array.isArray(e)){const n=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=n)for(const t in n){const r=n[t];null!=r.resourceId&&(e[t]=this.resourceIdToCapturedInput[r.resourceId])}return e}e=Array.isArray(e)?e:[e];const n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-n} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce(((t,n)=>{var s,a,i;const o=null===(i=null===(a=null===(s=this.signature)||void 0===s?void 0:s.inputs)||void 0===a?void 0:a[n])||void 0===i?void 0:i.resourceId;return t[n]=null!=o?this.resourceIdToCapturedInput[o]:e[r++],t}),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,n=Object.keys(t);for(let r=0;r<n.length;r++){const s=t[n[r]];this.resourceIdToCapturedInput[s.resourceId]=e[r]}}}execute(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce(((t,n)=>(t[n]=[e[n]],t)),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&GP(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function k2(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==n&&(n={}),n.fromTFHub&&"string"===typeof t&&(t=function(e){e.endsWith("/")||(e+="/");return`${e}${x2}${b2}`}(t));const s=new w2(t,n,r);return await s.load(),s}function S2(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);const s=t(e);if(s.recurse&&null!==s.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(s.recurse){if(N2(e)){const s=Array.isArray(e)?[]:{};r.add(e);for(const a in e){const i=S2(e[a],t,n,r);s[a]=i}return r.delete(e),e.__proto__&&(s.__proto__=e.__proto__),s}throw new Error(`Can't recurse into non-iterable type: ${e}`)}return n.set(e,s.value),s.value}function I2(e){return C2(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:T2)}function C2(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");const s=t(e);if(s.recurse&&null!==s.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(s.recurse){if(N2(r)){const s=Array.isArray(r)?[]:{};n.add(r);for(const a in r){const r=C2(e.map((e=>e[a])),t,n);s[a]=r}return n.delete(r),s}throw new Error(`Can't recurse into non-iterable type: ${r}`)}return s.value}function T2(e){return null===e?null:N2(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function N2(e){let t=!1;if(HO().get("IS_BROWSER"))t=e instanceof TextDecoder;else{const{StringDecoder:r}=n(551);t=e instanceof r}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof JL)&&!(e instanceof Promise)&&!t)}function E2(e){return S2(e,A2)}function A2(e){return e instanceof JL?{value:e.clone(),recurse:!1}:N2(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}class R2{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}class _2 extends R2{constructor(){super(_2.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=2*this.capacity,t=new Array(e),n=this.length();for(let r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function $2(e){return new F2(e)}function O2(e,t){return new q2(e,t)}_2.INITIAL_CAPACITY=32;class D2{async toArray(){const e=[];let t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),t=[];let n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new V2(this,e)}filter(e){return new j2(this,e)}map(e){return new U2(this,e)}mapAsync(e){return new W2(this,e)}serialMapAsync(e){return new W2(this,e).serial()}flatmap(e){return new H2(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile((e=>!0===e))}rowMajorBatch(e){return new B2(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T2;return this.rowMajorBatch(e,t).map((e=>I2(e,n)))}concatenate(e,t){return new q2(new M2([this,e]),t)}take(e){return e<0||null==e?this:new z2(this,e)}skip(e){return e<0||null==e?this:new P2(this,e)}prefetch(e){return new X2(this,e)}shuffle(e,t){return new Y2(this,e,t)}serial(){return new L2(this)}}class M2 extends D2{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:E2(e),done:!1}}}class F2 extends D2{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(Ipe){throw Ipe.message=`Error thrown while iterating through a dataset: ${Ipe.message}`,Ipe}}}class L2 extends D2{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){return this.upstream.next()}}class P2 extends D2{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;GP(e.value)}return this.upstream.next()}}class z2 extends D2{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class B2 extends D2{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}}class j2 extends D2{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;GP(e.value)}}}class U2 extends D2{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=vP(e.value),n=this.transform(e.value),r=vP(n);for(const s of t)yP(s,r)||s.dispose();return{value:n,done:!1}}}class V2 extends D2{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(Ipe){if(!this.handler(Ipe))return{value:null,done:!0}}}}class W2 extends D2{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=vP(e.value),n=await this.transform(e.value),r=vP(n);for(const s of t)yP(s,r)||s.dispose();return{value:n,done:!1}}}class G2 extends D2{constructor(){super(),this.outputQueue=new _2,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class H2 extends G2{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const e=await this.upstream.next();if(e.done)return!1;const t=vP(e.value),n=this.transform(e.value),r=vP(n);this.outputQueue.pushAll(n);for(const s of t)yP(s,r)||s.dispose();return!0}}class q2 extends D2{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){const e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}}var K2;!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(K2||(K2={}));class X2 extends D2{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new R2(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class Y2 extends X2{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=cW.alea(n||ML().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}}class Q2{constructor(){this.size=null}batch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this;let r;return hO(e>0,(()=>`batchSize needs to be positive, but it is\n      ${e}`)),r=this.size===1/0||null==this.size?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e),J2((async()=>(await n.iterator()).columnMajorBatch(e,t,Z2)),r)}concatenate(e){const t=this;let n;return n=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,J2((async()=>(await t.iterator()).concatenate(await e.iterator())),n)}filter(e){const t=this;let n;return n=this.size===1/0?1/0:null,J2((async()=>(await t.iterator()).filter((t=>WP((()=>e(t)))))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const t=this;return J2((async()=>(await t.iterator()).map((t=>WP((()=>e(t)))))),this.size)}mapAsync(e){const t=this;return J2((async()=>(await t.iterator()).mapAsync(e)),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const t=this;return J2((async()=>(await t.iterator()).prefetch(e)),this.size)}repeat(e){const t=this;let n;return n=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,J2((async()=>O2($2((async()=>({value:await t.iterator(),done:!1}))).take(e))),n)}skip(e){const t=this;let n;return n=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,J2((async()=>(await t.iterator()).skip(e)),n)}shuffle(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,s=cW.alea(t||ML().toString());return J2((async()=>{let t=s.int32();return n&&(t+=s.int32()),(await r.iterator()).shuffle(e,t.toString())}),this.size)}take(e){const t=this;let n;return n=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,J2((async()=>(await t.iterator()).take(e)),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function J2(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends Q2{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function Z2(e){if(null===e)return null;if(function(e){return null==e||null===(t=e)||"object"!==typeof t&&"function"!==typeof t||Array.isArray(e)||"object"===typeof e&&e instanceof JL||PL(e);var t}(e[0])){return{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof JL?XW(e):zP(e)}(e),recurse:!1}}return{value:null,recurse:!0}}Q2.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function e3(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&hO("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the CPU backend.`))}))}const t3=mG;class n3 extends iO{nextDataId(){return n3.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new aO(this,UP())}write(e,t,n){this.firstUse&&(this.firstUse=!1,HO().get("IS_NODE")&&lL("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&EO(n[0])){const s=n.map((e=>FL(e)));r=this.write(s,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){if(this.data.has(e)){return this.data.get(e).refCount}return 0}incRef(e){this.data.get(e).refCount++}decRef(e){if(this.data.has(e)){this.data.get(e).refCount--}}move(e,t,n,r,s){this.data.set(e,{values:t,dtype:r,refCount:s})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){return lq(this.readSync(n.real.dataId),this.readSync(n.imag.dataId))}return function(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>LL(e)));return Qz(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Qz(e.shape,e.dtype,t)}makeOutput(e,t,n){return UP().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=ML();e();return{kernelMs:ML()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){e3([e],"where");const t=this.readSync(e.dataId);return t3(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}n3.nextDataId=0;function r3(e){return(t,n,r)=>{const s=CO(n,t.length);for(let a=0;a<t.length;++a)s[a]=e(t[a],r);return s}}function s3(e,t,n){return a3(e,r3(t),n)}function a3(e,t,n){return r=>{let{inputs:s,attrs:a,backend:i}=r;const{x:o}=s;e3(o,e);const l=i,u=l.data.get(o.dataId).values;let c;if("string"===o.dtype){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");c=Uq(u)}else c=u;const d=n||o.dtype,h=t(c,d,a);return l.makeTensorInfo(o.shape,d,h)}}qP("cpu",(()=>new n3),1);const i3=s3(XD,(e=>e>=0?e:Math.exp(e)-1)),o3={kernelName:XD,backendName:"cpu",kernelFunc:i3};function l3(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const u3={kernelName:hM,backendName:"cpu",kernelFunc:l3};function c3(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{alpha:a}=r;e3([s],"leakyRelu");const i=mO(s.shape),o=n.data.get(s.dataId).values,l=IO("float32",i);for(let u=0;u<o.length;u++)l[u]=o[u]<0?a*o[u]:o[u];return n.makeTensorInfo(s.shape,"float32",l)}const d3={kernelName:vM,backendName:"cpu",kernelFunc:c3};function h3(e){return(t,n,r,s,a)=>{const i=CB(t,n),o=i.length,l=OO(i),u=IO(a,mO(i)),c=t.length,d=n.length,h=OO(t),p=OO(n),f=SB(t,i),m=SB(n,i);if(f.length+m.length===0)for(let g=0;g<u.length;++g)u[g]=e(r[g%r.length],s[g%s.length]);else for(let g=0;g<u.length;++g){const t=jO(g,o,l),n=t.slice(-c);f.forEach((e=>n[e]=0));const a=BO(n,c,h),i=t.slice(-d);m.forEach((e=>i[e]=0));const y=BO(i,d,p);u[g]=e(r[a],s[y])}return[u,i]}}const p3=h3(((e,t)=>e<0?t*e:e));function f3(e){const{inputs:t,backend:n}=e,{x:r,alpha:s}=t;e3([r,s],"prelu");const a=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values,[o,l]=p3(r.shape,s.shape,a,i,"float32");return n.makeTensorInfo(l,"float32",o)}const m3={kernelName:ZM,backendName:"cpu",kernelFunc:f3},g3=s3(oF,(e=>Math.max(0,e))),y3={kernelName:oF,backendName:"cpu",kernelFunc:g3},v3=s3(pF,(e=>Math.min(Math.max(0,e),6))),b3={kernelName:pF,backendName:"cpu",kernelFunc:v3},x3=r3((e=>1/(1+Math.exp(-e)))),w3=s3(TF,(e=>1/(1+Math.exp(-e)))),k3={kernelName:TF,backendName:"cpu",kernelFunc:w3};function S3(e,t,n,r,s){if("linear"===n)return l3({inputs:{x:t},backend:e});if("relu"===n)return g3({inputs:{x:t},backend:e});if("elu"===n)return i3({inputs:{x:t},backend:e});if("relu6"===n)return v3({inputs:{x:t},backend:e});if("prelu"===n)return f3({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return c3({inputs:{x:t},backend:e,attrs:{alpha:s}});if("sigmoid"===n)return w3({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}function I3(e){const{inputs:t,backend:n}=e,{real:r,imag:s}=t,a=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values,o=n.makeTensorInfo(r.shape,"complex64");return n.data.get(o.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",a),imag:n.makeTensorInfo(s.shape,"float32",i)},o}const C3={kernelName:SD,backendName:"cpu",kernelFunc:I3};function T3(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return I3({inputs:{real:T3(e,t,"float32"),imag:T3(e,t,"float32")},backend:e})}const r=LO(mO(t),n);return e.makeTensorInfo(t,n,r)}function N3(e){const{inputs:t,backend:n}=e,{input:r}=t,s=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,a)}const E3={kernelName:aF,backendName:"cpu",kernelFunc:N3};function A3(e,t,n,r){if("int32"===r){return[t,"int32",Int32Array.from(e)]}if("bool"===r){const r=DL([0],n),[s,a]=h3(((e,t)=>e!==t?1:0))(t,[],e,r,"bool");return[a,"bool",s]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function R3(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{dtype:a}=r;if("complex64"===a){if("complex64"===s.dtype)return l3({inputs:{x:s},backend:n});const e=T3(n,s.shape,s.dtype),t=R3({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),r=I3({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if("complex64"===s.dtype){const e=N3({inputs:{input:s},backend:n}),t=R3({inputs:{x:e},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(e),t}if(!TO(s.dtype,a)){const e=l3({inputs:{x:s},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:a}}const i=n.data.get(s.dataId).values,[o,l,u]=A3(i,s.shape,s.dtype,a);return n.makeTensorInfo(o,l,u)}const _3={kernelName:xD,backendName:"cpu",kernelFunc:R3};function $3(e,t,n,r){return null==n?n=>{let{inputs:s,backend:a}=n;const{a:i,b:o}=s,l=a;e3([i,o],e);const u=l.data.get(i.dataId).values,c=l.data.get(o.dataId).values,d="string"===i.dtype?Uq(u):u,h="string"===i.dtype?Uq(c):c,p=r||i.dtype,[f,m]=t(i.shape,o.shape,d,h,p);return l.makeTensorInfo(m,p,f)}:e=>{let{inputs:s,backend:a}=e;const{a:i,b:o}=s,l=a;if("complex64"===i.dtype||"complex64"===o.dtype){const e=R3({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),t=l.data.get(e.dataId),r=t.complexTensorInfos.real,s=t.complexTensorInfos.imag,a=l.data.get(r.dataId).values,u=l.data.get(s.dataId).values,c=R3({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),d=l.data.get(c.dataId),h=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,f=l.data.get(h.dataId).values,m=l.data.get(p.dataId).values,[g,y,v]=n(i.shape,o.shape,a,u,f,m),b=l.makeTensorInfo(v,"float32",g),x=l.makeTensorInfo(v,"float32",y),w=I3({inputs:{real:b,imag:x},backend:l});return l.disposeIntermediateTensorInfo(e),l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(b),l.disposeIntermediateTensorInfo(x),w}{const e=l.data.get(i.dataId).values,n=l.data.get(o.dataId).values,s=r||i.dtype,[a,u]=t(i.shape,o.shape,e,n,s);return l.makeTensorInfo(u,s,a)}}}function O3(e){return(t,n,r,s,a,i)=>{const o=CB(t,n),l=mO(o),u=o.length,c=OO(o),d=IO("float32",l),h=IO("float32",l),p=SB(t,o),f=SB(n,o),m=lq(r,s),g=lq(a,i),y=t.length,v=OO(t),b=n.length,x=OO(n);if(p.length+f.length===0)for(let w=0;w<d.length;w++){const t=w%m.length,n=w%g.length,r=e(m[2*t],m[2*t+1],g[2*n],g[2*n+1]);d[w]=r.real,h[w]=r.imag}else for(let w=0;w<d.length;w++){const t=jO(w,u,c),n=t.slice(-y);p.forEach((e=>n[e]=0));const r=BO(n,y,v),s=t.slice(-b);f.forEach((e=>s[e]=0));const a=BO(s,b,x),i=e(m[2*r],m[2*r+1],g[2*a],g[2*a+1]);d[w]=i.real,h[w]=i.imag}return[d,h,o]}}const D3=h3(((e,t)=>e+t)),M3=O3(((e,t,n,r)=>({real:e+n,imag:t+r}))),F3=$3(eD,D3,M3),L3={kernelName:eD,backendName:"cpu",kernelFunc:F3};function P3(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{shape:a}=r,i=mO(s.shape),o=wO(a,i),l=mO(o);hO(i===l,(()=>`The new shape (${o}) has ${l} elements and the old shape (${s.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`)),n.incRef(s.dataId);const u=n.data.get(s.dataId);if(null!=u.complexTensorInfos){const e=u.complexTensorInfos.real,t=u.complexTensorInfos.imag;e.shape=o,t.shape=o}return{dataId:s.dataId,shape:o,dtype:s.dtype}}const z3={kernelName:lF,backendName:"cpu",kernelFunc:P3};function B3(e){const{inputs:t,backend:n,attrs:r}=e,{a:s,b:a}=t,{transposeA:i,transposeB:o}=r;e3([s,a],"matMul");const l=s.shape.length,u=a.shape.length,c=i?s.shape[l-2]:s.shape[l-1],d=o?a.shape[u-1]:a.shape[u-2],h=i?s.shape[l-1]:s.shape[l-2],p=o?a.shape[u-2]:a.shape[u-1],f=s.shape.slice(0,-2),m=a.shape.slice(0,-2),g=mO(f),y=mO(m),v=CB(s.shape.slice(0,-2),a.shape.slice(0,-2)).concat([h,p]);hO(c===d,(()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${s.shape} and ${a.shape} and transposeA=${i} and transposeB=${o} must match.`));const b=o?[y,p,d]:[y,d,p],x=P3({inputs:{x:s},backend:n,attrs:{shape:i?[g,c,h]:[g,h,c]}}),w=P3({inputs:{x:a},backend:n,attrs:{shape:b}}),k=i?x.shape[1]:x.shape[2],S=i?x.shape[2]:x.shape[1],I=o?w.shape[1]:w.shape[2],C=Math.max(g,y),T=n.data.get(x.dataId).values,N=n.data.get(w.dataId).values,E=OO(x.shape),A=OO(w.shape),[R,_,$]=i?[E[0],1,E[1]]:[E[0],E[1],1],[O,D,M]=o?[1,A[1],A[0]]:[A[1],1,A[0]],F=S*I,L=Qz([C,S,I],x.dtype),P=L.values,z=n.blockSize;for(let B=0;B<C;B++){const e=B%g,t=B%y;for(let n=0;n<S;n+=z){const r=Math.min(n+z,S);for(let s=0;s<I;s+=z){const a=Math.min(s+z,I);for(let i=0;i<k;i+=z){const o=Math.min(i+z,k);for(let l=n;l<r;l++)for(let n=s;n<a;n++){let r=0;for(let s=i;s<o;s++){r+=T[e*R+l*_+s*$]*N[s*O+n*D+t*M]}P[B*F+(l*I+n)]+=r}}}}}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(v,L.dtype,L.values)}const j3={kernelName:mD,backendName:"cpu",kernelFunc:B3};const U3={kernelName:aL,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:s,b:a,bias:i,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;let h,p,f;const m=[];h=B3({inputs:{a:s,b:a},attrs:{transposeA:l,transposeB:u},backend:n}),i&&(p=F3({inputs:{a:h,b:i},backend:n}),m.push(h),h=p),c&&(f=S3(n,h,c,o,d),m.push(h),h=f);for(const g of m)n.disposeIntermediateTensorInfo(g);return h}};function V3(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const W3={kernelName:QO,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend;e3(t,"abs");let r=new Float32Array(mO(t.shape));return r=V3(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}},G3=s3(JO,(e=>Math.acos(e))),H3={kernelName:JO,backendName:"cpu",kernelFunc:G3},q3=s3(ZO,(e=>Math.acosh(e))),K3={kernelName:ZO,backendName:"cpu",kernelFunc:q3};const X3={kernelName:tD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,r=t;e3(t,"addN");const s=r.map((e=>n.data.get(e.dataId).values)),a=Qz(r[0].shape,r[0].dtype),i=a.values;for(let o=0;o<r.length;o++){const e=s[o];for(let t=0;t<i.length;t++)i[t]+=e[t]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}};function Y3(e,t,n,r,s){const a=t.length,i=mO(t),o=OO(t),l=OO(s),u=IO(n,mO(s));for(let c=0;c<i;++c){const t=jO(c,a,o),n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t[r[e]];u[BO(n,a,l)]=e[c]}return u}function Q3(e){const{inputs:t,attrs:n,backend:r}=e,{x:s}=t,{perm:a}=n;e3(s,"transpose");const i=s.shape.length,o=new Array(i);for(let u=0;u<o.length;u++)o[u]=s.shape[a[u]];const l=Y3(r.data.get(s.dataId).values,s.shape,s.dtype,a,o);return{dataId:r.write(l,o,s.dtype),shape:o,dtype:s.dtype}}const J3={kernelName:QF,backendName:"cpu",kernelFunc:Q3};const Z3={kernelName:nD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r;e3(s,"all");const o=kO(a,s.shape);let l=o;const u=qU(l,s.shape.length);let c=s;null!=u&&(c=Q3({inputs:{x:s},backend:n,attrs:{perm:u}}),l=XU(l.length,s.shape.length)),HU("all",l,c.shape.length);const[d,h]=WU(c.shape,l),p=mO(h),f=LO(mO(d),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<f.length;++y){const e=y*p;let t=m[e];for(let n=0;n<p;++n){const r=m[e+n];t=t&&r}f[y]=t}null!=u&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(d,c.dtype,f);if(i){const e=P3({inputs:{x:g},backend:n,attrs:{shape:GU(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const e4={kernelName:rD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r;e3(s,"any");const o=kO(a,s.shape);let l=o;const u=qU(l,s.shape.length);let c=s;null!=u&&(c=Q3({inputs:{x:s},backend:n,attrs:{perm:u}}),l=XU(l.length,s.shape.length)),HU("any",l,c.shape.length);const[d,h]=WU(c.shape,l),p=mO(h),f=LO(mO(d),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<f.length;++y){const e=y*p;let t=m[e];for(let n=0;n<p;++n){const r=m[e+n];t=t||r}f[y]=t}null!=u&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(d,c.dtype,f);if(i){const e=P3({inputs:{x:g},backend:n,attrs:{shape:GU(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const t4={kernelName:sD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a}=r;e3(s,"argMax");let i=kO(a,s.shape);const o=qU(i,s.shape.length);let l=s;const u=[];null!=o&&(l=Q3({inputs:{x:s},backend:n,attrs:{perm:o}}),u.push(l),i=XU(i.length,l.shape.length)),i=[i[0]],HU("argMax",i,l.shape.length);const[c,d]=WU(l.shape,i),h=LO(mO(c),"int32"),p=mO(d),f=n.data.get(l.dataId).values;for(let m=0;m<h.length;++m){const e=m*p;let t=f[e],n=0;for(let r=0;r<p;++r){const s=f[e+r];s>t&&(t=s,n=r)}h[m]=n}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(c,"int32",h)}};const n4={kernelName:aD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a}=r;e3(s,"argMin");let i=kO(a,s.shape);const o=qU(i,s.shape.length);let l=s;const u=[];null!=o&&(l=Q3({inputs:{x:s},backend:n,attrs:{perm:o}}),u.push(l),i=XU(i.length,l.shape.length)),i=[i[0]],HU("argMin",i,l.shape.length);const[c,d]=WU(l.shape,i),h=LO(mO(c),"int32"),p=mO(d),f=n.data.get(l.dataId).values;for(let m=0;m<h.length;++m){const e=m*p;let t=f[e],n=0;for(let r=0;r<p;++r){const s=f[e+r];s<t&&(t=s,n=r)}h[m]=n}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(c,"int32",h)}},r4=s3(iD,(e=>Math.asin(e))),s4={kernelName:iD,backendName:"cpu",kernelFunc:r4},a4=s3(oD,(e=>Math.asinh(e))),i4={kernelName:oD,backendName:"cpu",kernelFunc:a4},o4=s3(lD,(e=>Math.atan(e))),l4={kernelName:lD,backendName:"cpu",kernelFunc:o4},u4=h3(((e,t)=>Math.atan2(e,t))),c4=$3(cD,u4),d4={kernelName:cD,backendName:"cpu",kernelFunc:c4},h4=s3(uD,(e=>Math.atanh(e))),p4={kernelName:uD,backendName:"cpu",kernelFunc:h4};function f4(e,t,n,r,s,a){const i=s.strideHeight,o=s.strideWidth,l=s.dilationHeight,u=s.dilationWidth,c=s.effectiveFilterHeight,d=s.effectiveFilterWidth,h=s.padInfo.top,p=s.padInfo.left,f="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Qz(s.outShape,n),g=m.values,y=s.outShape[1]*s.outShape[2]*s.outShape[3],v=s.outShape[2]*s.outShape[3],b=s.outShape[3];for(let x=0;x<s.batchSize;++x){const t=x*y,n=x*r[0];for(let m=0;m<s.inChannels;++m)for(let y=0;y<s.outHeight;++y){const x=y*i-h,w=Math.max(0,x),k=Math.min(s.inHeight,c+x),S=t+y*v;for(let t=0;t<s.outWidth;++t){const i=t*o-p,c=Math.max(0,i),h=Math.min(s.inWidth,d+i);let y=f,v=0,x=0;for(let t=w;t<k;t+=l){const s=n+t*r[1];for(let t=c;t<h;t+=u){const n=e[s+t*r[2]+m];"max"===a&&n>y?y=n:"avg"===a&&(v+=n,x++)}if(isNaN(y))break}g[S+t*b+m]="avg"===a?v/x:y}}}return m}function m4(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=Qz(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.top,f=r.padInfo.left,m=Qz(t,n,e);for(let g=0;g<r.batchSize;++g)for(let e=0;e<r.inChannels;++e)for(let t=0;t<r.outHeight;++t){const n=t*o-p;let y=n;for(;y<0;)y+=u;const v=Math.min(r.inHeight,d+n);for(let o=0;o<r.outWidth;++o){const d=o*l-f;let p=d;for(;p<0;)p+=c;const b=Math.min(r.inWidth,h+d);let x=Number.NEGATIVE_INFINITY,w=-1;for(let t=y;t<v;t+=u){const i=t-n;for(let n=p;n<b;n+=c){const o=n-d,l=m.get(g,t,n,e);l>x&&(x=l,w=s?a?((g*r.inHeight+t)*r.inWidth+n)*r.inChannels+e:(t*r.inWidth+n)*r.inChannels+e:i*h+o)}}i.set(w,g,t,o,e)}}return i}function g4(e,t,n,r,s,a){const i=s.strideDepth,o=s.strideHeight,l=s.strideWidth,u=s.dilationDepth,c=s.dilationHeight,d=s.dilationWidth,h=s.effectiveFilterDepth,p=s.effectiveFilterHeight,f=s.effectiveFilterWidth,m=s.padInfo.front,g=s.padInfo.top,y=s.padInfo.left,v="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Qz(s.outShape,n),x=b.values,w=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],k=s.outShape[2]*s.outShape[3]*s.outShape[4],S=s.outShape[3]*s.outShape[4],I=s.outShape[4];for(let C=0;C<s.batchSize;++C){const t=C*w,n=C*r[0];for(let b=0;b<s.inChannels;++b)for(let w=0;w<s.outDepth;++w){const C=w*i-m;let T=C;for(;T<0;)T+=u;const N=Math.min(s.inDepth,h+C),E=t+w*k;for(let t=0;t<s.outHeight;++t){const i=t*o-g;let h=i;for(;h<0;)h+=c;const m=Math.min(s.inHeight,p+i),w=E+t*S;for(let t=0;t<s.outWidth;++t){const i=t*l-y;let o=i;for(;o<0;)o+=d;const p=Math.min(s.inWidth,f+i),g=w+t*I;let k=v,S=0,C=0;for(let t=T;t<N;t+=u){const s=n+t*r[1];for(let t=h;t<m;t+=c){const n=s+t*r[2];for(let t=o;t<p;t+=d){const s=e[n+t*r[3]+b];if("max"===a&&s>k?k=s:"avg"===a&&(S+=s,C++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}x[g+b]="avg"===a?S/Math.max(C,1):k}}}}return b}const y4={kernelName:dD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t;e3(s,"avgPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=r;hO(Wj(i,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '1'`));const u=Dj(s.shape,a,i,1,o,l);let c;if(1===u.filterWidth&&1===u.filterHeight&&gO(u.inShape,u.outShape))c=l3({inputs:{x:s},backend:n});else{const e=n.data.get(s.dataId).values,t=OO(s.shape),r=f4(e,s.shape,s.dtype,t,u,"avg");c=n.makeTensorInfo(u.outShape,s.dtype,r.values)}return c}};const v4={kernelName:pD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:u}=r;e3(s,"avgPool3d");const c=Mj(s.shape,a,i,1,o,l,u),d=g4(n.data.get(s.dataId).values,s.shape,s.dtype,OO(s.shape),c,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}};const b4={kernelName:fD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,input:a}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:u}=r;e3([s,a],"avgPool3DGrad");const c=Mj(a.shape,i,o,1,l,u),d=c.strideDepth,h=c.strideHeight,p=c.strideWidth,f=c.filterDepth,m=c.filterHeight,g=c.filterWidth,y=c.dilationDepth,v=c.dilationHeight,b=c.dilationWidth,x=c.effectiveFilterDepth,w=c.effectiveFilterHeight,k=c.effectiveFilterWidth,S=x-1-c.padInfo.front,I=k-1-c.padInfo.left,C=w-1-c.padInfo.top,T=Qz(a.shape,"float32"),N=1/(f*m*g),E=n.bufferSync(s);for(let A=0;A<c.batchSize;++A)for(let e=0;e<c.inChannels;++e)for(let t=0;t<c.inDepth;++t)for(let n=0;n<c.inHeight;++n)for(let r=0;r<c.inWidth;++r){const s=t-S,a=n-C,i=r-I;let o=0;for(let t=0;t<x;t+=y){const n=(s+t)/d;if(!(n<0||n>=c.outDepth||Math.floor(n)!==n))for(let t=0;t<w;t+=v){const r=(a+t)/h;if(!(r<0||r>=c.outHeight||Math.floor(r)!==r))for(let t=0;t<k;t+=b){const s=(i+t)/p;if(s<0||s>=c.outWidth||Math.floor(s)!==s)continue;o+=E.get(A,n,r,s,e)}}}T.set(o*N,A,t,n,r,e)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}};const x4={kernelName:hD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,input:a}=t,i=a;e3([s,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=r,c=Dj(i.shape,o,l,1,u),d=c.strideHeight,h=c.strideWidth,p=c.filterHeight,f=c.filterWidth,m=c.dilationHeight,g=c.dilationWidth,y=c.effectiveFilterHeight,v=c.effectiveFilterWidth,b=v-1-c.padInfo.left,x=y-1-c.padInfo.top,w=Qz(i.shape,"float32"),k=1/(p*f),S=n.data.get(s.dataId).values,I=Qz(s.shape,"float32",S);for(let C=0;C<c.batchSize;++C)for(let e=0;e<c.inChannels;++e)for(let t=0;t<c.inHeight;++t)for(let n=0;n<c.inWidth;++n){const r=t-x,s=n-b;let a=0;for(let t=0;t<y;t+=m){const n=(r+t)/d;if(!(n<0||n>=c.outHeight||Math.floor(n)!==n))for(let t=0;t<v;t+=g){const r=(s+t)/h;if(r<0||r>=c.outWidth||Math.floor(r)!==r)continue;a+=I.get(C,n,r,e)}}w.set(a*k,C,t,n,e)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};const w4={kernelName:oM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,scale:a,offset:i,mean:o,variance:l}=t;hO(o.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),hO(null==i||o.shape.length===i.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),hO(null==a||o.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),e3([s,o,l,a,i],"batchNorm");let{varianceEpsilon:u}=r;null==u&&(u=.001);const c=n.data.get(s.dataId).values,d=n.data.get(o.dataId).values,h=n.data.get(l.dataId).values,p=a?n.data.get(a.dataId).values:new Float32Array([1]),f=i?n.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(c.length),g=f.length,y=p.length,v=h.length,b=d.length;let x=0,w=0,k=0,S=0;for(let I=0;I<c.length;++I)m[I]=f[x++]+(c[I]-d[w++])*p[k++]/Math.sqrt(h[S++]+u),x>=g&&(x=0),w>=b&&(w=0),k>=y&&(k=0),S>=v&&(S=0);return n.makeTensorInfo(s.shape,s.dtype,m)}};function k4(e,t,n,r,s){const a=gj(r,t,n),i=mO(n),o=OO(r);if(a){const n=yj(t,o);return"string"===s?e.slice(n,n+i):e.subarray(n,n+i)}const l=Qz(r,s,"string"===s?Uq(e):e),u=Qz(n,s);for(let c=0;c<u.size;++c){const e=u.indexToLoc(c),n=e.map(((e,n)=>e+t[n]));u.set(l.get(...n),...e)}return"string"===s?Vq(u.values):u.values}function S4(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{begin:a,size:i}=r;e3(s,"slice");const[o,l]=vj(s,a,i);sj(s,o,l);const u=k4(n.data.get(s.dataId).values,o,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,u)}const I4={kernelName:kF,backendName:"cpu",kernelFunc:S4};const C4={kernelName:gD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{blockShape:a,crops:i}=r;e3([s],"batchToSpaceND");const o=a.reduce(((e,t)=>e*t)),l=KH(s.shape,a,o),u=XH(l.length,a.length),c=YH(s.shape,a,o),d=QH(i,a.length),h=JH(c,i,a.length),p=P3({inputs:{x:s},backend:n,attrs:{shape:l}}),f=Q3({inputs:{x:p},backend:n,attrs:{perm:u}}),m=P3({inputs:{x:f},backend:n,attrs:{shape:c}}),g=S4({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}};function T4(e,t,n,r,s){const a=mO(r),i=LO(s,n);for(let o=0;o<e.length;o++){const n=e[o];if(n<0)throw new Error("Input x must be non-negative!");n>=s||(i[n]+=a>0?t[o]:1)}return i}function N4(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=e.shape[0],a=e.shape[1],i=Qz([s,n],t.dtype);for(let o=0;o<s;o++)for(let s=0;s<a;s++){const a=e.get(o,s);if(a<0)throw new Error("Input x must be non-negative!");a>=n||(r?i.set(1,o,a):t.size>0?i.set(i.get(o,a)+t.get(o,s),o,a):i.set(i.get(o,a)+1,o,a))}return i}const E4={kernelName:yD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,weights:a}=t,{size:i}=r,o=T4(n.data.get(s.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,o)}},A4=h3(((e,t)=>e&t)),R4=$3(vD,A4),_4={kernelName:vD,backendName:"cpu",kernelFunc:R4};const $4={kernelName:bD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:s}=t,a=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values,o=CB(Array.from(a),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},O4=r3((e=>Math.ceil(e))),D4=a3(wD,O4),M4={kernelName:wD,backendName:"cpu",kernelFunc:D4},F4=s3(kD,((e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),L4={kernelName:kD,backendName:"cpu",kernelFunc:F4},P4={kernelName:ID,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array(mO(t.shape)),s=n.data.get(t.dataId),a=s.complexTensorInfos.real,i=s.complexTensorInfos.imag,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values;for(let u=0;u<o.length;u++){const e=o[u],t=l[u];r[u]=Math.hypot(e,t)}return n.makeOutput(r,t.shape,"float32")}};function z4(e,t,n,r){const s=CO(n,mO(t));if(r&&"string"!==n){let t=0;e.forEach((e=>{const n=mO(e.shape);s.set(e.vals,t),t+=n}))}else{let r=0;e.forEach((e=>{const a="string"===n?Uq(e.vals):e.vals;let i=0;for(let n=0;n<e.shape[0];++n){const o=n*t[1]+r;for(let t=0;t<e.shape[1];++t)s[o+t]=a[i++]}r+=e.shape[1]}))}return s}function B4(e){const{inputs:t,backend:n}=e,{input:r}=t,s=n.data.get(r.dataId).complexTensorInfos.imag,a=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,a)}const j4={kernelName:fM,backendName:"cpu",kernelFunc:B4};function U4(e){const{inputs:t,backend:n,attrs:r}=e,{axis:s}=r,a=kO(s,t[0].shape)[0];LH(t.map((e=>e.shape)),a);let i=PH(t.map((e=>e.shape)),a);if(0===mO(i))return n.makeTensorInfo(i,t[0].dtype,[]);const o=t.filter((e=>mO(e.shape)>0));if(1===o.length)return l3({inputs:{x:o[0]},backend:n});if("complex64"===o[0].dtype){const e=o.map((e=>N3({inputs:{input:e},backend:n}))),t=o.map((e=>B4({inputs:{input:e},backend:n}))),r=U4({inputs:e,backend:n,attrs:{axis:a}}),s=U4({inputs:t,backend:n,attrs:{axis:a}}),i=I3({inputs:{real:r,imag:s},backend:n});return e.forEach((e=>n.disposeIntermediateTensorInfo(e))),t.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(s),i}const l=o.map((e=>{const t=mO(e.shape.slice(a));return P3({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),u=l.map((e=>({vals:n.data.get(e.dataId).values,shape:e.shape})));i=PH(l.map((e=>e.shape)),1);const c=1===l[0].shape[0],d=z4(u,i,t[0].dtype,c),h=PH(o.map((e=>e.shape)),a),p=n.makeTensorInfo(h,t[0].dtype,d);return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),p}const V4={kernelName:CD,backendName:"cpu",kernelFunc:U4};function W4(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a}=t,{strides:i,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=r;e3([s,a],"conv2d");const d=Hj(l),h=Fj(s.shape,a.shape,i,u,o,c,!1,d),p=h.filterHeight,f=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.padInfo.left,v=h.padInfo.top,b="channelsLast"===h.dataFormat,x=new KL(h.outShape,s.dtype),w=OO(s.shape),k=OO(a.shape),S=w[0],I=b?w[1]:w[2],C=b?w[2]:1,T=b?1:w[1],N=x.strides[0],E=b?x.strides[1]:x.strides[2],A=b?x.strides[2]:1,R=b?1:x.strides[1],_=n.data.get(s.dataId).values,$=n.data.get(a.dataId).values,O=x.values;for(let D=0;D<h.batchSize;++D){const e=D*S,t=D*N;for(let n=0;n<h.outHeight;++n){const r=t+n*E,s=n*h.strideHeight-v;for(let t=0;t<p;++t){const n=s+t*m;if(n<0||n>=h.inHeight)continue;const a=t*k[0],i=e+n*I;for(let e=0;e<h.outWidth;++e){const t=r+e*A,n=e*h.strideWidth-y;for(let e=0;e<f;++e){const r=n+e*g;if(r<0||r>=h.inWidth)continue;const s=i+r*C;let o=a+e*k[1];for(let e=0;e<h.inChannels;++e){const n=_[s+e*T];for(let e=0;e<h.outChannels;++e)O[t+e*R]+=n*$[o+e];o+=h.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,O)}const G4={kernelName:TD,backendName:"cpu",kernelFunc:W4};const H4={kernelName:ND,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,dy:a}=t,{strides:i,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;e3([s,a],"conv2dBackpropFilter");const d=Hj(l),h=Fj(s.shape,c,i,1,o,u,!1,d),{strideHeight:p,strideWidth:f,filterHeight:m,filterWidth:g}=h,y="channelsLast"===h.dataFormat,v=new KL(h.filterShape,"float32"),b=h.padInfo.left,x=h.padInfo.top,w=n.data.get(s.dataId).values,k=n.data.get(a.dataId).values,S=new KL(s.shape,s.dtype,w),I=new KL(a.shape,a.dtype,k);for(let C=0;C<m;++C){const e=Math.max(0,Math.ceil((x-C)/p)),t=Math.min(h.outHeight,(h.inHeight+x-C)/p);for(let n=0;n<g;++n){const r=Math.max(0,Math.ceil((b-n)/f)),s=Math.min(h.outWidth,(h.inWidth+b-n)/f);for(let a=0;a<h.inChannels;++a)for(let i=0;i<h.outChannels;++i){let o=0;for(let l=0;l<h.batchSize;++l)for(let u=e;u<t;++u){const e=C+u*p-x;for(let t=r;t<s;++t){const r=n+t*f-b;o+=y?S.get(l,e,r,a)*I.get(l,u,t,i):S.get(l,a,e,r)*I.get(l,i,u,t)}}v.set(o,C,n,a,i)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const q4={kernelName:ED,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,filter:a}=t,{inputShape:i,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=r;e3([s,a],"conv2dBackpropInput");const d=OO(a.shape),h=OO(s.shape);let p=Hj(u);const f=Fj(i,a.shape,o,1,l,c,!1,p),m=new KL(f.inShape,"float32"),g=m.values,y=n.data.get(s.dataId).values,v=n.data.get(a.dataId).values,[b,x,w]=d,{batchSize:k,filterHeight:S,filterWidth:I,inChannels:C,inHeight:T,inWidth:N,outChannels:E,outHeight:A,outWidth:R,strideHeight:_,strideWidth:$}=f;p=f.dataFormat;const O=S-1-f.padInfo.top,D=I-1-f.padInfo.left,M="channelsLast"===p,F=m.strides[0],L=M?m.strides[1]:m.strides[2],P=M?m.strides[2]:1,z=M?1:m.strides[1],B=h[0],j=M?h[1]:h[2],U=M?h[2]:1,V=M?1:h[1];for(let W=0;W<k;++W)for(let e=0;e<C;++e)for(let t=0;t<T;++t){const n=t-O,r=Math.max(0,Math.ceil(n/_)),s=Math.min(A,(S+n)/_);for(let a=0;a<N;++a){const i=a-D,o=Math.max(0,Math.ceil(i/$)),l=Math.min(R,(I+i)/$);let u=0;for(let t=r;t<s;++t){const r=t*_-n;for(let n=o;n<l;++n){const s=B*W+j*t+U*n,a=b*(S-1-r)+x*(I-1-(n*$-i))+w*e;for(let e=0;e<E;++e){u+=y[s+V*e]*v[a+e]}}}g[F*W+L*t+P*a+z*e]=u}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};const K4={kernelName:AD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a}=t,{strides:i,pad:o,dilations:l}=r;e3([s,a],"conv3d");const u=Lj(s.shape,a.shape,i,l,o),{filterDepth:c,filterHeight:d,filterWidth:h,dilationDepth:p,dilationHeight:f,dilationWidth:m,padInfo:g}=u,y=g.front,v=g.left,b=g.top,x=new KL(u.outShape,s.dtype),w=n.data.get(s.dataId).values,k=n.data.get(a.dataId).values,S=x.values,I=OO(s.shape),C=OO(a.shape);for(let T=0;T<u.batchSize;++T){const e=T*I[0],t=T*x.strides[0];for(let n=0;n<u.outDepth;++n){const r=t+n*x.strides[1],s=n*u.strideDepth-y;for(let t=0;t<c;++t){const n=s+t*p;if(n<0||n>=u.inDepth)continue;const a=t*C[0],i=e+n*I[1];for(let e=0;e<u.outHeight;++e){const t=r+e*x.strides[2],n=e*u.strideHeight-b;for(let e=0;e<d;++e){const r=n+e*f;if(r<0||r>=u.inHeight)continue;const s=a+e*C[1],o=i+r*I[2];for(let e=0;e<u.outWidth;++e){const n=t+e*u.outChannels,r=e*u.strideWidth-v;for(let e=0;e<h;++e){const t=r+e*m;if(t<0||t>=u.inWidth)continue;const a=s+e*C[2],i=o+t*u.inChannels;let l=a;for(let e=0;e<u.inChannels;++e){const t=w[i+e];for(let e=0;e<u.outChannels;++e)S[n+e]+=t*k[l+e];l+=u.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};const X4={kernelName:RD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,dy:a}=t,{strides:i,pad:o,filterShape:l}=r;e3([s,a],"conv3dBackpropFilterV2");const u=OO(s.shape),c=OO(a.shape),d=Lj(s.shape,l,i,1,o),h=d.strideDepth,p=d.strideHeight,f=d.strideWidth,m=d.filterDepth,g=d.filterHeight,y=d.filterWidth,v=new KL(d.filterShape,"float32"),b=v.values,[x,w,k,S]=v.strides,I=n.data.get(a.dataId).values,[C,T,N,E]=c,A=n.data.get(s.dataId).values,[R,_,$,O]=u,D=d.padInfo.front,M=d.padInfo.left,F=d.padInfo.top;for(let L=0;L<m;++L){const e=Math.max(0,Math.ceil((D-L)/h)),t=Math.min(d.outDepth,(d.inDepth+D-L)/h),n=L*x;for(let r=0;r<g;++r){const s=Math.max(0,Math.ceil((F-r)/p)),a=Math.min(d.outHeight,(d.inHeight+F-r)/p),i=r*w+n;for(let n=0;n<y;++n){const o=Math.max(0,Math.ceil((M-n)/f)),l=Math.min(d.outWidth,(d.inWidth+M-n)/f),u=n*k+i;for(let i=0;i<d.inChannels;++i){const c=i*S+u;for(let u=0;u<d.outChannels;++u){let m=0;for(let c=0;c<d.batchSize;++c){const d=c*R,g=c*C;for(let c=e;c<t;++c){const e=(L+c*h-D)*_+d,t=c*T+g;for(let c=s;c<a;++c){const s=(r+c*p-F)*$+e,a=c*N+t;for(let e=o;e<l;++e){const t=e*E+a;m+=A[(n+e*f-M)*O+s+i]*I[t+u]}}}}b[c+u]=m}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const Y4={kernelName:_D,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,filter:a}=t,{pad:i,strides:o,inputShape:l}=r;e3([s],"conv3dBackpropInputV2");const u=OO(s.shape),c=OO(a.shape),d=Lj(l,a.shape,o,1,i),h=new KL(d.inShape,"float32"),p=h.values,[f,m,g,y]=h.strides,v=n.data.get(s.dataId).values,[b,x,w,k]=u,S=n.data.get(a.dataId).values,[I,C,T,N]=c,{batchSize:E,filterDepth:A,filterHeight:R,filterWidth:_,inChannels:$,inDepth:O,inHeight:D,inWidth:M,outChannels:F,outDepth:L,outHeight:P,outWidth:z,strideDepth:B,strideHeight:j,strideWidth:U}=d,V=A-1-d.padInfo.front,W=R-1-d.padInfo.top,G=_-1-d.padInfo.left;for(let H=0;H<E;++H)for(let e=0;e<$;++e)for(let t=0;t<O;++t){const n=t-V,r=Math.max(0,Math.ceil(n/B)),s=Math.min(L,(A+n)/B);for(let a=0;a<D;++a){const i=a-W,o=Math.max(0,Math.ceil(i/j)),l=Math.min(P,(R+i)/j);for(let u=0;u<M;++u){const c=u-G,d=Math.max(0,Math.ceil(c/U)),h=Math.min(z,(_+c)/U);let E=0;for(let t=r;t<s;++t){const r=t*B-n;for(let n=o;n<l;++n){const s=n*j-i;for(let a=d;a<h;++a){const i=b*H+x*t+w*n+k*a,o=I*(A-1-r)+C*(R-1-s)+T*(_-1-(a*U-c))+N*e;for(let e=0;e<F;++e){E+=v[i+e]*S[o+e]}}}}p[f*H+m*t+g*a+y*u+e]=E}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}},Q4=s3($D,(e=>Math.cos(e))),J4={kernelName:$D,backendName:"cpu",kernelFunc:Q4},Z4=s3(OD,(e=>Math.cosh(e))),e5={kernelName:OD,backendName:"cpu",kernelFunc:Z4};const t5={kernelName:FD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:s,boxes:a,boxInd:i}=t,{cropSize:o,method:l,extrapolationValue:u}=r,[c,d,h,p]=s.shape,f=a.shape[0],[m,g]=o,y=Qz([f,m,g,p],"float32"),v=n.data.get(a.dataId).values,b=n.data.get(i.dataId).values,x=n.data.get(s.dataId).values,w=OO(s.shape),k=OO(y.shape);for(let S=0;S<f;S++){const e=4*S,t=v[e],n=v[e+1],r=v[e+2],s=v[e+3],a=b[S];if(a>=c)continue;const i=m>1?(r-t)*(d-1)/(m-1):0,o=g>1?(s-n)*(h-1)/(g-1):0;for(let c=0;c<m;c++){const e=m>1?t*(d-1)+c*i:.5*(t+r)*(d-1);if(e<0||e>d-1)for(let t=0;t<g;t++)for(let e=0;e<p;e++){const n=e+t*k[2]+c*k[1]+S*k[0];y.values[n]=u}else if("bilinear"===l){const t=Math.floor(e),r=Math.ceil(e),i=e-t;for(let e=0;e<g;e++){const l=g>1?n*(h-1)+e*o:.5*(n+s)*(h-1);if(l<0||l>h-1){for(let t=0;t<p;t++){const n=t+e*k[2]+c*k[1]+S*k[0];y.values[n]=u}continue}const d=Math.floor(l),f=Math.ceil(l),m=l-d;for(let n=0;n<p;n++){let s=n+d*w[2]+t*w[1]+a*w[0];const o=x[s];s=n+f*w[2]+t*w[1]+a*w[0];const l=x[s];s=n+d*w[2]+r*w[1]+a*w[0];const u=x[s];s=n+f*w[2]+r*w[1]+a*w[0];const h=o+(l-o)*m,p=u+(x[s]-u)*m;s=n+e*k[2]+c*k[1]+S*k[0],y.values[s]=h+(p-h)*i}}}else for(let t=0;t<g;++t){const r=g>1?n*(h-1)+t*o:.5*(n+s)*(h-1);if(r<0||r>h-1){for(let e=0;e<p;e++){const n=e+t*k[2]+c*k[1]+S*k[0];y.values[n]=u}continue}const i=Math.round(r),l=Math.round(e);for(let e=0;e<p;e++){const n=e+i*w[2]+l*w[1]+a*w[0],r=e+t*k[2]+c*k[1]+S*k[0];y.values[r]=x[n]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const n5={kernelName:DD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,exclusive:i,reverse:o}=r;e3(s,"cumprod");const l=qU([a],s.shape.length);let u=s;null!=l&&(u=Q3({inputs:{x:s},backend:n,attrs:{perm:l}}));const c=XU(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=hP(u.dtype,"int32"),h=FO(mO(u.shape),d),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let y=0;y<p.length;y+=f)for(let e=0;e<f;e++){const t=m(y,e);if(0===e)h[t]=i?1:p[t];else{const n=m(y,e-1);h[t]=i?p[n]*h[n]:p[t]*h[n]}}const g=n.makeTensorInfo(u.shape,d,h);if(null!=l){const e=Q3({inputs:{x:g},backend:n,attrs:{perm:KU(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),e}return g}};const r5={kernelName:MD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,exclusive:i,reverse:o}=r;e3(s,"cumsum");const l=qU([a],s.shape.length);let u=s;null!=l&&(u=Q3({inputs:{x:s},backend:n,attrs:{perm:l}}));const c=XU(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=hP(u.dtype,"int32"),h=LO(mO(u.shape),d),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=o?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let y=0;y<p.length;y+=f)for(let e=0;e<f;e++){const t=m(y,e);if(0===e)h[t]=i?0:p[t];else{const n=m(y,e-1);h[t]=i?p[n]+h[n]:p[t]+h[n]}}const g=n.makeTensorInfo(u.shape,d,h);if(null!=l){const e=Q3({inputs:{x:g},backend:n,attrs:{perm:KU(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),e}return g}};const s5={kernelName:LD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,weights:a}=t,{size:i,binaryOutput:o}=r;if(1===s.shape.length){const e=T4(n.data.get(s.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,e)}if(2===s.shape.length){const e=N4(n.bufferSync(s),n.bufferSync(a),i,o);return n.makeTensorInfo(e.shape,a.dtype,e.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}};const a5={kernelName:PD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{blockSize:a,dataFormat:i}=r;hO("NHWC"===i,(()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`));const o=s.shape[0],l=s.shape[1],u=s.shape[2],c=s.shape[3],d=l*a,h=u*a,p=c/(a*a),f=n.data.get(s.dataId).values,m=new Float32Array(o*d*h*p);let g=0;for(let y=0;y<o;++y)for(let e=0;e<d;++e){const t=Math.floor(e/a),n=e%a;for(let e=0;e<h;++e){const r=Math.floor(e/a),s=(n*a+e%a)*p;for(let e=0;e<p;++e){const n=e+s+c*(r+u*(t+l*y));m[g++]=f[n]}}}return n.makeTensorInfo([o,d,h,p],s.dtype,m)}};function i5(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a}=t,{strides:i,pad:o,dilations:l,dimRoundingMode:u}=r;e3([s,a],"depthwiseConv2DNative");const c=OO(s.shape),d=OO(a.shape);let h=l;null==h&&(h=[1,1]),hO(Wj(i,h),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`));const p=Fj(s.shape,a.shape,i,h,o,u,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:v}=p,b=v.left,x=v.top,w=p.outChannels/p.inChannels,k=new KL(p.outShape,s.dtype),S=n.data.get(s.dataId).values,I=n.data.get(a.dataId).values,C=k.values;for(let T=0;T<p.batchSize;++T){const e=T*c[0],t=T*k.strides[0];for(let n=0;n<p.outHeight;++n){const r=t+n*k.strides[1],s=n*p.strideHeight-x;for(let t=0;t<f;++t){const n=s+t*g;if(n<0||n>=p.inHeight)continue;const a=t*d[0],i=e+n*c[1];for(let e=0;e<p.outWidth;++e){const t=r+e*k.strides[2],n=e*p.strideWidth-b;for(let e=0;e<m;++e){const r=n+e*y;if(r<0||r>=p.inWidth)continue;const s=a+e*d[1],o=i+r*p.inChannels;let l=t,u=s;for(let e=0;e<p.inChannels;++e){const t=S[o+e];for(let e=0;e<w;++e)C[l+e]+=t*I[u+e];l+=w,u+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const o5={kernelName:zD,backendName:"cpu",kernelFunc:i5};const l5={kernelName:BD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,dy:a}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r;e3([s,a],"depthwiseConv2dNativeBackpropFilter");const d=Fj(s.shape,c,i,o,l,u,!0),{strideHeight:h,strideWidth:p,filterHeight:f,filterWidth:m}=d,g=new KL(d.filterShape,"float32"),y=d.padInfo.left,v=d.padInfo.top,b=d.outChannels/d.inChannels,x=n.data.get(s.dataId).values,w=new KL(s.shape,s.dtype,x),k=n.data.get(a.dataId).values,S=new KL(a.shape,a.dtype,k);for(let I=0;I<f;++I){const e=Math.max(0,Math.ceil((v-I)/h)),t=Math.min(d.outHeight,(d.inHeight+v-I)/h);for(let n=0;n<m;++n){const r=Math.max(0,Math.ceil((y-n)/p)),s=Math.min(d.outWidth,(d.inWidth+y-n)/p);for(let a=0;a<d.outChannels;++a){const i=Math.trunc(a/b),o=a%b;let l=0;for(let u=0;u<d.batchSize;++u)for(let o=e;o<t;++o){const e=I+o*h-v;for(let t=r;t<s;++t){const r=n+t*p-y;l+=w.get(u,e,r,i)*S.get(u,o,t,a)}}g.set(l,I,n,i,o)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};const u5={kernelName:jD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,filter:a}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=r;e3([s,a],"depthwiseConv2DNativeBackpropInput");const d=OO(s.shape),h=OO(a.shape),p=Fj(c,a.shape,i,o,l,u,!0),f=new KL(p.inShape,"float32"),m=f.values,[g,y,v]=f.strides,b=n.data.get(s.dataId).values,[x,w,k]=d,S=n.data.get(a.dataId).values,[I,C,T]=h,{batchSize:N,filterHeight:E,filterWidth:A,inChannels:R,inHeight:_,inWidth:$,outChannels:O,outHeight:D,outWidth:M,strideHeight:F,strideWidth:L}=p,P=E-1-p.padInfo.top,z=A-1-p.padInfo.left,B=O/R;for(let j=0;j<N;++j)for(let e=0;e<R;++e)for(let t=0;t<_;++t){const n=t-P,r=Math.max(0,Math.ceil(n/F)),s=Math.min(D,(E+n)/F);for(let a=0;a<$;++a){const i=a-z,o=Math.max(0,Math.ceil(i/L)),l=Math.min(M,(A+i)/L);let u=0;for(let t=r;t<s;++t){const r=t*F-n;for(let n=o;n<l;++n){const s=x*j+w*t+k*n,a=I*(E-1-r)+C*(A-1-(n*L-i))+T*e;for(let t=0;t<B;++t){u+=b[s+(e*B+t)]*S[a+t]}}}m[g*j+y*t+v*a+e]=u}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}};const c5={kernelName:UD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,s=mO(r.shape),a=n.data.get(r.dataId).values,i=Qz([s,s],r.dtype),o=i.values;for(let u=0;u<a.length;u++)o[u*s+u]=a[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,i.dtype,i.values)}},d5={kernelName:VD,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:s,filter:a}=t,{strides:i,pad:o,dilations:l}=r,u=n,c=u.data.get(s.dataId).values,d=s.shape.length,h=u.data.get(a.dataId).values,p=a.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:y,outHeight:v,outWidth:b,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:S,filterWidth:I,dilationHeight:C,dilationWidth:T,outShape:N}=Oj(s.shape,a.shape,i,o,"NHWC",l),E=mO(N),A=N.length,R=CO(s.dtype,E);for(let _=0;_<f;++_)for(let e=0;e<v;++e){const t=e*w-x.top;for(let n=0;n<b;++n){const r=n*k-x.left;for(let i=0;i<y;++i){let o=Number.MIN_SAFE_INTEGER;for(let e=0;e<S;++e){const n=t+e*C;if(n>=0&&n<m)for(let t=0;t<I;++t){const l=r+t*T;if(l>=0&&l<g){const r=BO([_,n,l,i],d,OO(s.shape)),u=BO([e,t,i],p,OO(a.shape)),f=c[r]+h[u];f>o&&(o=f)}}}R[BO([_,e,n,i],A,OO(N))]=o}}}return{dataId:u.write(DL(R,s.dtype),N,s.dtype),shape:N,dtype:s.dtype}}},h5={kernelName:GD,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:s,filter:a,dy:i}=t,{strides:o,pad:l,dilations:u}=r,c=n,d=MO(s.shape,c.data.get(s.dataId).values),h=MO(a.shape,c.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:v,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:I,dilationWidth:C,outShape:T}=Oj(s.shape,a.shape,o,l,"NHWC",u);hO(i.rank===T.length,(()=>`Error in ${GD}, dy must have the same rank as output ${T.length}, but got ${i.rank}`));const N=MO(T,c.data.get(i.dataId).values),E=PO(a.shape,a.dtype);for(let A=0;A<p;++A)for(let e=0;e<y;++e){const t=e*x-b.top;for(let n=0;n<v;++n){const r=n*w-b.left;for(let s=0;s<g;++s){let a=Number.MIN_SAFE_INTEGER,i=0,o=0;for(let e=0;e<k;++e){const n=t+e*I;if(n>=0&&n<f)for(let t=0;t<S;++t){const l=r+t*C;if(l>=0&&l<m){const r=d[A][n][l][s]+h[e][t][s];r>a&&(a=r,i=e,o=t)}}}E[i][o][s]+=N[A][e][n][s]}}}return{dataId:c.write(DL(E,s.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},p5={kernelName:WD,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:s,filter:a,dy:i}=t,{strides:o,pad:l,dilations:u}=r,c=n,d=MO(s.shape,c.data.get(s.dataId).values),h=MO(a.shape,c.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:v,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:I,dilationWidth:C,outShape:T}=Oj(s.shape,a.shape,o,l,"NHWC",u);hO(i.rank===T.length,(()=>`Error in ${WD}, dy must have the same rank as output ${T.length}, but got ${i.rank}`));const N=MO(T,c.data.get(i.dataId).values),E=PO(s.shape,s.dtype);for(let A=0;A<p;++A)for(let e=0;e<y;++e){const t=e*x-b.top;for(let n=0;n<v;++n){const r=n*w-b.left;for(let s=0;s<g;++s){let a=Number.MIN_SAFE_INTEGER,i=t<0?0:t,o=r<0?0:r;for(let e=0;e<k;++e){const n=t+e*I;if(n>=0&&n<f)for(let t=0;t<S;++t){const l=r+t*C;if(l>=0&&l<m){const r=d[A][n][l][s]+h[e][t][s];r>a&&(a=r,i=n,o=l)}}}E[A][i][o][s]+=N[A][e][n][s]}}}return{dataId:c.write(DL(E,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};const f5={kernelName:HD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:s}=t,{canvas:a,options:i}=r,{contextOptions:o,imageOptions:l}=i||{},u=(null===l||void 0===l?void 0:l.alpha)||1,c=(null===o||void 0===o?void 0:o.contextType)||"2d";if("2d"!==c)throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const d=a.getContext(c,(null===o||void 0===o?void 0:o.contextAttributes)||{});if(null==d)throw new Error(`Could not get the context with ${c} type.`);const[h,p]=s.shape.slice(0,2),f=2===s.shape.length?1:s.shape[2],m=n.data.get(s.dataId).values,g="float32"===s.dtype?255:1,y=new Uint8ClampedArray(p*h*4);for(let b=0;b<h*p;++b){const e=[0,0,0,255*u];for(let n=0;n<f;n++){const t=m[b*f+n];if("float32"===s.dtype){if(t<0||t>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${t}.`)}else if("int32"===s.dtype&&(t<0||t>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${t}.`);1===f?(e[0]=t*g,e[1]=t*g,e[2]=t*g):e[n]=t*g}const t=4*b;y[t+0]=Math.round(e[0]),y[t+1]=Math.round(e[1]),y[t+2]=Math.round(e[2]),y[t+3]=Math.round(e[3])}a.width=p,a.height=h;const v=new ImageData(y,p,h);return d.putImageData(v,0,0),s}},m5=h3(((e,t)=>e*t)),g5=O3(((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n}))),y5=$3(UM,m5,g5),v5={kernelName:UM,backendName:"cpu",kernelFunc:y5};function b5(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r;let o;e3(s,"sum"),o="bool"===s.dtype?R3({inputs:{x:s},backend:n,attrs:{dtype:"int32"}}):l3({inputs:{x:s},backend:n});const l=o.shape.length,u=kO(a,o.shape),c=qU(u,l);let d=u,h=o;null!=c&&(h=Q3({inputs:{x:o},backend:n,attrs:{perm:c}}),d=XU(d.length,l)),HU("sum",d,h.shape.length);const[p,f]=WU(h.shape,d);let m=T3(n,p,hP(h.dtype,"int32"));const g=mO(f),y=n.data.get(m.dataId).values,v=n.data.get(h.dataId).values;for(let b=0;b<y.length;++b){const e=b*g;let t=0;for(let n=0;n<g;++n)t+=v[e+n];y[b]=t}if(i){const e=m;m=P3({inputs:{x:m},backend:n,attrs:{shape:GU(m.shape,u)}}),n.disposeIntermediateTensorInfo(e)}return n.disposeIntermediateTensorInfo(o),null!=c&&n.disposeIntermediateTensorInfo(h),m}const x5={kernelName:AF,backendName:"cpu",kernelFunc:b5};const w5={kernelName:KD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:s}=r,a=t,{allDims:i,summedDims:o,idDims:l}=xq(s,a.length);kq(i.length,l,a);const{path:u,steps:c}=Sq(o,l),d=c.length;let h=null,p=i.length;const f=[];for(let m=0;m<d;++m){for(const e of c[m]){const{permutationIndices:t,expandDims:r}=wq(p,l[e]);let s;Iq(t)?s=a[e]:(s=Q3({inputs:{x:a[e]},backend:n,attrs:{perm:t}}),f.push(s));const i=s.shape.slice();for(let e=0;e<r.length;++e)i.splice(r[e],0,1);gO(s.shape,i)||(s=P3({inputs:{x:s},backend:n,attrs:{shape:i}}),f.push(s)),null===h?h=s:(h=y5({inputs:{a:s,b:h},backend:n}),f.push(h))}m<d-1&&(u[m]>=0&&(h=b5({inputs:{x:h},backend:n,attrs:{axis:u[m]-(i.length-p),keepDims:!1}}),f.push(h)),p--)}for(const m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}};const k5={kernelName:YD,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{dy:r,y:s}=t;e3([r,s],"eluGrad");const a=new Float32Array(mO(s.shape)),i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<i.length;++l){const e=i[l];a[l]=e>=0?o[l]:o[l]*(e+1)}return n.makeTensorInfo(s.shape,"float32",a)}},S5=h3(((e,t)=>e===t?1:0)),I5=$3(JD,S5,null,"bool"),C5={kernelName:JD,backendName:"cpu",kernelFunc:I5},T5=nq,N5=rq,E5=sq,A5=aq,R5=iq,_5=oq,$5=s3(QD,(e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+T5*n);return t*(1-((((_5*r+R5)*r+A5)*r+E5)*r+N5)*r*Math.exp(-n*n))})),O5={kernelName:QD,backendName:"cpu",kernelFunc:$5},D5=r3((e=>Math.exp(e))),M5=a3(ZD,D5,"float32"),F5={kernelName:ZD,backendName:"cpu",kernelFunc:M5};function L5(e){const{inputs:t,backend:n,attrs:r}=e,{input:s}=t,{dim:a}=r,i=s.shape.length,o=s.shape.slice();let l=a;return a<0&&(hO(-(i+1)<=a,(()=>`Axis must be in the interval [${-(i+1)}, ${i}]`)),l=i+a+1),o.splice(l,0,1),P3({inputs:{x:s},backend:n,attrs:{shape:o}})}const P5={kernelName:eM,backendName:"cpu",kernelFunc:L5},z5=r3((e=>Math.expm1(e))),B5=a3(tM,z5),j5={kernelName:tM,backendName:"cpu",kernelFunc:B5},U5=h3(((e,t)=>e/t)),V5=$3(qD,U5),W5={kernelName:qD,backendName:"cpu",kernelFunc:V5},G5=h3(((e,t)=>e-t)),H5=O3(((e,t,n,r)=>({real:e-n,imag:t-r}))),q5=$3(GF,G5,H5),K5={kernelName:GF,backendName:"cpu",kernelFunc:q5};function X5(e,t,n){const r=e.shape,s=r[0],a=r[1],i=n.data.get(e.dataId),o=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,u=[s,a],c=mO(u),d=IO("float32",c),h=IO("float32",c);for(let g=0;g<s;g++){const e=S4({inputs:{x:o},backend:n,attrs:{begin:[g,0],size:[1,a]}}),r=S4({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,a]}}),s=I3({inputs:{real:e,imag:r},backend:n}),{real:i,imag:u}=Y5(s,t,n),c=lq(i,u);for(let t=0;t<a;t++){const e=hq(c,t);d[g*a+t]=e.real,h[g*a+t]=e.imag}n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(s)}const p=n.makeTensorInfo(u,"float32",d),f=n.makeTensorInfo(u,"float32",h),m=I3({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}function Y5(e,t,n){const r=mO(e.shape),s=n.data.get(e.dataId),a=n.data.get(s.complexTensorInfos.real.dataId).values,i=n.data.get(s.complexTensorInfos.imag.dataId).values;if(0===((o=r)&o-1)){const s=Q5(a,i,r,t,n),o=[e.shape[0],e.shape[1]];if(t){const e=n.makeTensorInfo(o,"float32",s.real),t=n.makeTensorInfo(o,"float32",s.imag),a=n.makeTensorInfo([],"float32",OL(r,"float32")),i=l3({inputs:{x:a},backend:n}),l=W5.kernelFunc({inputs:{a:e,b:a},backend:n}),u=W5.kernelFunc({inputs:{a:t,b:i},backend:n}),c=n.data.get(l.dataId).values,d=n.data.get(u.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),{real:c,imag:d}}return s}{const e=function(e,t,n){const r=new Float32Array(2*t);for(let s=0;s<t;s++){let a=0,i=0;for(let r=0;r<t;r++){const o=mq(s*r,t,n),l=hq(e,r);a+=l.real*o.real-l.imag*o.imag,i+=l.real*o.imag+l.imag*o.real}n&&(a/=t,i/=t),pq(r,a,i,s)}return r}(lq(a,i),r,t);return uq(e)}var o}function Q5(e,t,n,r,s){if(1===n)return{real:e,imag:t};const a=lq(e,t),i=n/2,o=cq(a),l=o.real,u=o.imag,c=[l.length],d=s.makeTensorInfo(c,"float32",l),h=s.makeTensorInfo(c,"float32",u),p=I3({inputs:{real:d,imag:h},backend:s}),f=dq(a),m=f.real,g=f.imag,y=[m.length],v=s.makeTensorInfo(y,"float32",m),b=s.makeTensorInfo(y,"float32",g),x=I3({inputs:{real:v,imag:b},backend:s}),w=Q5(l,u,i,r,s),k=w.real,S=w.imag,I=[k.length],C=s.makeTensorInfo(I,"float32",k),T=s.makeTensorInfo(I,"float32",S),N=I3({inputs:{real:C,imag:T},backend:s}),E=Q5(m,g,i,r,s),A=E.real,R=E.imag,_=[A.length],$=s.makeTensorInfo(_,"float32",A),O=s.makeTensorInfo(_,"float32",R),D=I3({inputs:{real:$,imag:O},backend:s}),M=fq(n,r),F=[M.real.length],L=s.makeTensorInfo(F,"float32",M.real),P=s.makeTensorInfo(F,"float32",M.imag),z=I3({inputs:{real:L,imag:P},backend:s}),B=y5({inputs:{a:z,b:D},backend:s}),j=F3({inputs:{a:N,b:B},backend:s}),U=q5({inputs:{a:N,b:B},backend:s}),V=N3({inputs:{input:j},backend:s}),W=N3({inputs:{input:U},backend:s}),G=B4({inputs:{input:j},backend:s}),H=B4({inputs:{input:U},backend:s}),q=U4({inputs:[V,W],backend:s,attrs:{axis:0}}),K=U4({inputs:[G,H],backend:s,attrs:{axis:0}}),X=s.data.get(q.dataId).values,Y=s.data.get(K.dataId).values;return s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(p),s.disposeIntermediateTensorInfo(v),s.disposeIntermediateTensorInfo(b),s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(C),s.disposeIntermediateTensorInfo(T),s.disposeIntermediateTensorInfo(N),s.disposeIntermediateTensorInfo($),s.disposeIntermediateTensorInfo(O),s.disposeIntermediateTensorInfo(D),s.disposeIntermediateTensorInfo(L),s.disposeIntermediateTensorInfo(P),s.disposeIntermediateTensorInfo(z),s.disposeIntermediateTensorInfo(B),s.disposeIntermediateTensorInfo(j),s.disposeIntermediateTensorInfo(U),s.disposeIntermediateTensorInfo(V),s.disposeIntermediateTensorInfo(G),s.disposeIntermediateTensorInfo(W),s.disposeIntermediateTensorInfo(H),s.disposeIntermediateTensorInfo(q),s.disposeIntermediateTensorInfo(K),{real:X,imag:Y}}const J5={kernelName:nM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,s=mO(r.shape),a=r.shape[r.shape.length-1],i=P3({inputs:{x:r},backend:n,attrs:{shape:[s/a,a]}}),o=X5(i,!1,n),l=P3({inputs:{x:o},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}};function Z5(e){const{backend:t,attrs:n}=e,{shape:r,value:s,dtype:a}=n,i=a||RO(s),o=CO(i,mO(r));return function(e,t){e.fill(t)}(o,s),t.makeTensorInfo(r,i,o)}const e6={kernelName:rM,backendName:"cpu",kernelFunc:Z5};const t6={kernelName:sM,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:s}=t,a=r,i=IO(s.dtype,mO(s.shape)),[o,l,u,c]=s.shape,d=a.data.get(s.dataId).values;for(let h=0;h<o;h++){const e=h*u*l*c;for(let t=0;t<l;t++){const n=t*(u*c);for(let t=0;t<u;t++){const r=t*c;for(let s=0;s<c;s++){const a=Math.round(u-t-1),o=e+n+r+s;let l=d[o];if(a>=0&&a<u){l=d[e+n+a*c+s]}i[o]=l}}}}return{dataId:a.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}},n6=r3((e=>Math.floor(e))),r6=a3(aM,n6),s6={kernelName:aM,backendName:"cpu",kernelFunc:r6},a6=h3(((e,t)=>Math.floor(e/t))),i6=$3(iM,a6,null,"int32"),o6={kernelName:iM,backendName:"cpu",kernelFunc:i6};const l6={kernelName:iL,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a,bias:i,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r;let m=W4({inputs:{x:s,filter:a},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h}});if(i){const e=m;if("NCHW"===c&&1===i.shape.length&&1!==i.shape[0]){const e=P3({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});m=F3({inputs:{a:m,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else m=F3({inputs:{a:m,b:i},backend:n});n.disposeIntermediateTensorInfo(e)}if(p){const e=m;if("NCHW"===c&&"prelu"===p&&1===o.shape.length&&1!==o.shape[0]){const e=P3({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=S3(n,m,p,e,f),n.disposeIntermediateTensorInfo(e)}else m=S3(n,m,p,o,f);n.disposeIntermediateTensorInfo(e)}return m}};const u6={kernelName:oL,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a,bias:i,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r;let m=i5({inputs:{x:s,filter:a},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h}});if(i){const e=m;m=F3({inputs:{a:m,b:i},backend:n}),n.disposeIntermediateTensorInfo(e)}if(p){const e=m;m=S3(n,m,p,o,f),n.disposeIntermediateTensorInfo(e)}return m}};function c6(e,t,n,r,s,a,i,o,l){const u=Qz([r,a],n);for(let c=0;c<r;c++){const n=[];let r=0;for(let t=0;t<s;t++){const a=e[c*s+t];r+=a*i[t],n.push(a)}if(r<0||r>=l/a)throw new Error(`Invalid indices: ${n} does not index into ${o}`);for(let e=0;e<a;e++)u.values[c*a+e]=t.get(...t.indexToLoc(r*a+e))}return u}const d6={kernelName:uM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:s}=t,a=mO(r.shape),i=s.shape,o=i[i.length-1],[l,u,c,d]=ZH(r,s);if(0===u)return n.makeTensorInfo(l,r.dtype,[]);const h=c6(n.data.get(s.dataId).values,n.bufferSync(r),r.dtype,u,o,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,h.values)}};function h6(e,t,n){const r=Qz(n,e.dtype);for(let s=0;s<r.size;++s){const n=r.indexToLoc(s).slice(),a=n[0],i=n[2],o=t.locToIndex([a,i]);n[2]=t.values[o];const l=e.locToIndex(n);0<=l&&l<e.values.length&&(r.values[s]=e.values[l])}return r}const p6={kernelName:lM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,indices:a}=t,{axis:i,batchDims:o}=r;e3([s,a],"gatherV2");const l=kO(i,s.shape)[0],u=n.data.get(a.dataId).values,c=s.shape[l];for(let b=0;b<u.length;++b){const e=u[b];hO(e<=c-1&&e>=0,(()=>`GatherV2: the index value ${e} is not in [0, ${c-1}]`))}let d=o;null==o&&(d=0);const h=mO(a.shape),p=jq(s,a,l,d),f=P3({inputs:{x:s},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),m=P3({inputs:{x:a},backend:n,attrs:{shape:[p.batchSize,h/p.batchSize]}}),g=[p.batchSize,p.outerSize,h/p.batchSize,p.sliceSize],y=n.bufferSync(m),v=h6(n.bufferSync(f),y,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(p.outputShape,v.dtype,v.values)}},f6=h3(((e,t)=>e>t?1:0)),m6=$3(cM,f6,null,"bool"),g6={kernelName:cM,backendName:"cpu",kernelFunc:m6},y6=h3(((e,t)=>e>=t?1:0)),v6=$3(dM,y6,null,"bool"),b6={kernelName:dM,backendName:"cpu",kernelFunc:v6};const x6={kernelName:pM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,s=mO(r.shape),a=r.shape[r.shape.length-1],i=P3({inputs:{x:r},backend:n,attrs:{shape:[s/a,a]}}),o=X5(i,!0,n),l=P3({inputs:{x:o},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}},w6=s3(mM,(e=>Number.isFinite(e)?1:0),"bool"),k6={kernelName:mM,backendName:"cpu",kernelFunc:w6},S6=s3(gM,(e=>Math.abs(e)===1/0?1:0),"bool"),I6={kernelName:gM,backendName:"cpu",kernelFunc:S6},C6=s3(yM,(e=>Number.isNaN(e)?1:0),"bool"),T6={kernelName:yM,backendName:"cpu",kernelFunc:C6},N6=h3(((e,t)=>e<t?1:0)),E6=$3(bM,N6,null,"bool"),A6={kernelName:bM,backendName:"cpu",kernelFunc:E6},R6=h3(((e,t)=>e<=t?1:0)),_6=$3(xM,R6,null,"bool"),$6={kernelName:xM,backendName:"cpu",kernelFunc:_6};function O6(e,t,n){const r=(t-e)/(n-1),s=LO(n,"float32");s[0]=e;for(let a=1;a<s.length;a++)s[a]=s[a-1]+r;return s}const D6={kernelName:wM,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:s,num:a}=n,i=O6(r,s,a);return t.makeTensorInfo([i.length],"float32",i)}},M6=r3((e=>Math.log(e))),F6=a3(kM,M6),L6={kernelName:kM,backendName:"cpu",kernelFunc:F6},P6=s3(SM,(e=>Math.log1p(e))),z6={kernelName:SM,backendName:"cpu",kernelFunc:P6},B6=h3(((e,t)=>e&&t)),j6=$3(IM,B6,null,"bool"),U6={kernelName:IM,backendName:"cpu",kernelFunc:j6},V6=s3(CM,(e=>e?0:1),"bool"),W6={kernelName:CM,backendName:"cpu",kernelFunc:V6},G6=h3(((e,t)=>e||t)),H6=$3(TM,G6,null,"bool"),q6={kernelName:TM,backendName:"cpu",kernelFunc:H6};const K6={kernelName:NM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{depthRadius:a,bias:i,alpha:o,beta:l}=r;e3(s,"LRN");const u=s.shape[3],c=u-1,d=n.data.get(s.dataId).values,h=mO(s.shape),p=new Float32Array(h);function f(e){const t=e%u;let n=e-t+Math.max(0,t-a);const r=e-t+Math.min(t+a,c);let s=0;for(;n<=r;n++){const e=d[n];s+=e*e}return s}for(let m=0;m<h;m++){const e=f(m),t=d[m]*Math.pow(i+o*e,-l);p[m]=t}return n.makeTensorInfo(s.shape,s.dtype,p)}};const X6={kernelName:EM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,y:a,dy:i}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=r;e3(i,"LRNGrad");const d=mO(i.shape),h=i.shape[3],p=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,m=n.data.get(a.dataId).values,g=new Float32Array(d),y=d;for(let v=0;v<y;v++){const e=v%h,t=v-e+Math.max(0,e-o),n=v-e+Math.min(h,e+o+1);let r=0;for(let s=t;s<n;s++)r+=Math.pow(f[s],2);r=u*r+l;for(let s=t;s<n;s++){let e=-2*u*c*f[s]*m[v]/r;v===s&&(e+=Math.pow(r,-c)),e*=p[v],g[s]+=e}}return n.makeTensorInfo(i.shape,s.dtype,g)}};function Y6(e,t,n,r){const s=IO(r,mO(n));for(let a=0;a<s.length;++a){const n=a*t;let r=e[n];for(let s=0;s<t;++s){const t=e[n+s];(Number.isNaN(t)||t>r)&&(r=t)}s[a]=r}return s}function Q6(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{reductionIndices:a,keepDims:i}=r,o=n;let l=s.shape;const u=l.length,c=kO(a,l);let d=c;const h=qU(d,u);let p=o.data.get(s.dataId).values;if(null!=h){const e=new Array(u);for(let t=0;t<e.length;t++)e[t]=l[h[t]];p=Y3(p,l,s.dtype,h,e),d=XU(d.length,u),l=e}e3(s,"max"),HU("max",d,u);const[f,m]=WU(l,d),g=Y6(p,mO(m),f,s.dtype),y=o.write(g,f,s.dtype);let v=f;if(i){v=GU(f,c)}return{dataId:y,shape:v,dtype:s.dtype}}const J6={kernelName:AM,backendName:"cpu",kernelFunc:Q6},Z6=h3(((e,t)=>Math.max(e,t))),e9=$3(RM,Z6),t9={kernelName:RM,backendName:"cpu",kernelFunc:e9};const n9={kernelName:_M,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t;e3(s,"maxPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=r;hO(Wj(i,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '1'`));const u=Dj(s.shape,a,i,1,o,l);let c;if(1===u.filterWidth&&1===u.filterHeight&&gO(u.inShape,u.outShape))c=l3({inputs:{x:s},backend:n});else{const e=n.data.get(s.dataId).values,t=OO(s.shape),r=f4(e,s.shape,s.dtype,t,u,"max");c=n.makeTensorInfo(u.outShape,s.dtype,r.values)}return c}};const r9={kernelName:OM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:u}=r;e3(s,"maxPool3d");const c=Mj(s.shape,a,i,1,o,l,u),d=g4(n.data.get(s.dataId).values,s.shape,s.dtype,OO(s.shape),c,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}};const s9={kernelName:DM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,input:a}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:u}=r;e3([s,a],"maxPool3DGrad");const c=Mj(a.shape,i,o,1,l,u),d=function(e,t){const n=Qz(t.outShape,"int32"),r=t.strideDepth,s=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.front,p=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let y=0;y<t.outDepth;++y){const v=y*r-h;let b=v;for(;b<0;)b+=i;const x=Math.min(t.inDepth,u+v);for(let r=0;r<t.outHeight;++r){const u=r*s-p;let h=u;for(;h<0;)h+=o;const w=Math.min(t.inHeight,c+u);for(let s=0;s<t.outWidth;++s){const p=s*a-f;let k=p;for(;k<0;)k+=l;const S=Math.min(t.inWidth,d+p);let I=Number.NEGATIVE_INFINITY,C=-1;for(let t=b;t<x;t+=i){const n=t-v;for(let r=h;r<w;r+=o){const s=r-u;for(let a=k;a<S;a+=l){const i=a-p,o=e.get(m,t,r,a,g);o>=I&&(I=o,C=n*c*d+s*c+i)}}}n.set(C,m,y,r,s,g)}}}return n}(n.bufferSync(a),c),h=c.strideDepth,p=c.strideHeight,f=c.strideWidth,m=c.dilationDepth,g=c.dilationHeight,y=c.dilationWidth,v=c.effectiveFilterDepth,b=c.effectiveFilterHeight,x=c.effectiveFilterWidth,w=v-1-c.padInfo.front,k=x-1-c.padInfo.left,S=b-1-c.padInfo.top,I=Qz(a.shape,"float32"),C=n.bufferSync(s);for(let T=0;T<c.batchSize;++T)for(let e=0;e<c.inChannels;++e)for(let t=0;t<c.inDepth;++t)for(let n=0;n<c.inHeight;++n)for(let r=0;r<c.inWidth;++r){const s=t-w,a=n-S,i=r-k;let o=0;for(let t=0;t<v;t+=m){const n=(s+t)/h;if(!(n<0||n>=c.outDepth||Math.floor(n)!==n))for(let r=0;r<b;r+=g){const s=(a+r)/p;if(!(s<0||s>=c.outHeight||Math.floor(s)!==s))for(let a=0;a<x;a+=y){const l=(i+a)/f;if(l<0||l>=c.outWidth||Math.floor(l)!==l)continue;const u=v*b*x-1-d.get(T,n,s,l,e)===t*b*x+r*x+a?1:0;if(0===u)continue;o+=C.get(T,n,s,l,e)*u}}}I.set(o,T,t,n,r,e)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}};const a9={kernelName:$M,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,input:a,output:i}=t,o=a;e3([a,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,h=Dj(o.shape,l,u,1,c,d),p=n.data.get(o.dataId).values,f=Qz(h.outShape,o.dtype,m4(p,o.shape,o.dtype,h).values),m=h.strideHeight,g=h.strideWidth,y=h.dilationHeight,v=h.dilationWidth,b=h.effectiveFilterHeight,x=h.effectiveFilterWidth,w=x-1-h.padInfo.left,k=b-1-h.padInfo.top,S=Qz(o.shape,"float32"),I=n.data.get(s.dataId).values,C=Qz(s.shape,"float32",I);for(let T=0;T<h.batchSize;++T)for(let e=0;e<h.inChannels;++e)for(let t=0;t<h.inHeight;++t)for(let n=0;n<h.inWidth;++n){const r=t-k,s=n-w;let a=0;for(let t=0;t<b;t+=y){const n=(r+t)/m;if(!(n<0||n>=h.outHeight||Math.floor(n)!==n))for(let r=0;r<x;r+=v){const i=(s+r)/g;if(i<0||i>=h.outWidth||Math.floor(i)!==i)continue;const o=b*x-1-f.get(T,n,i,e)===t*x+r?1:0;if(0===o)continue;a+=C.get(T,n,i,e)*o}}S.set(a,T,t,n,e)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};const i9={kernelName:MM,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:s}=t,{filterSize:a,strides:i,pad:o,includeBatchInIndex:l}=n,u=r;e3(s,"MaxPoolWithArgmax");const c=u.data.get(s.dataId).values,d=Dj(s.shape,a,i,[1,1],o),[h,p]=function(e,t,n,r,s){const a=f4(e,0,n,OO(t),s,"max"),i=m4(e,t,n,s,!0,r);return[a.values,i.values]}(c,s.shape,s.dtype,l,d),f=u.write(h,d.outShape,s.dtype),m=u.write(p,d.outShape,s.dtype);return[{dataId:f,shape:d.outShape,dtype:s.dtype},{dataId:m,shape:d.outShape,dtype:"int32"}]}};const o9={kernelName:FM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r,o=kO(a,s.shape),l=mO(WU(s.shape,o)[1]),u=[],c=n.makeTensorInfo([],"float32",new Float32Array([l]));u.push(c);const d=R3({inputs:{x:s},backend:n,attrs:{dtype:"float32"}});u.push(d);const h=V5({inputs:{a:d,b:c},backend:n});u.push(h);const p=b5({inputs:{x:h},backend:n,attrs:{axis:a,keepDims:i}});return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),p}};const l9={kernelName:LM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r;e3(s,"min");const o=kO(a,s.shape);let l=o;const u=qU(l,s.shape.length);let c=s;null!=u&&(c=Q3({inputs:{x:s},backend:n,attrs:{perm:u}}),l=XU(l.length,s.shape.length)),HU("min",l,c.shape.length);const[d,h]=WU(c.shape,l),p=mO(h),f=LO(mO(d),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<f.length;++y){const e=y*p;let t=m[e];for(let n=0;n<p;++n){const r=m[e+n];(Number.isNaN(r)||r<t)&&(t=r)}f[y]=t}null!=u&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(d,c.dtype,f);if(i){const e=P3({inputs:{x:g},backend:n,attrs:{shape:GU(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}},u9=h3(((e,t)=>Math.min(e,t))),c9=$3(PM,u9),d9={kernelName:PM,backendName:"cpu",kernelFunc:c9};const h9={kernelName:zM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{paddings:a,mode:i}=r;e3(s,"mirrorPad");const o=a.map(((e,t)=>e[0]+s.shape[t]+e[1])),l=a.map((e=>e[0])),u=a.map(((e,t)=>e[0]+s.shape[t])),c="reflect"===i?0:1,d=n.data.get(s.dataId).values,h=s.shape.length,p=OO(s.shape),f=mO(o),m=o.length,g=OO(o),y=IO(s.dtype,f);for(let v=0;v<f;v++){let e=jO(v,m,g);for(let n=0;n<m;n++)e[n]<l[n]?e[n]=2*l[n]-e[n]-c:e[n]>=u[n]&&(e[n]=2*(u[n]-1)-e[n]+c);e=e.map(((e,t)=>e-l[t]));const t=BO(e,h,p);y[v]=d[t]}return{dataId:n.write(y,o,s.dtype),shape:o,dtype:s.dtype}}},p9=h3(((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),f9=$3(BM,p9),m9={kernelName:BM,backendName:"cpu",kernelFunc:f9};function g9(e){const{inputs:t,backend:n,attrs:r}=e,{logits:s}=t,{dim:a}=r,i=s.shape.length;let o=a;if(-1===o&&(o=i-1),o!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${o}`);const l=kO([o],s.shape),u=Q6({inputs:{x:s},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=GU(u.shape,l),d=P3({inputs:{x:u},backend:n,attrs:{shape:c}}),h=q5({inputs:{a:s,b:d},backend:n}),p=M5({inputs:{x:h},backend:n}),f=b5({inputs:{x:p},backend:n,attrs:{axis:l,keepDims:!1}}),m=P3({inputs:{x:f},backend:n,attrs:{shape:c}}),g=V5({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const y9={kernelName:$F,backendName:"cpu",kernelFunc:g9};const v9={kernelName:jM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:s}=t,{numSamples:a,seed:i,normalized:o}=r;e3(s,"multinomial");const l=o?s:g9({inputs:{logits:s},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,h=[u,a],p=LO(mO(h),"int32");for(let f=0;f<u;++f){const e=f*c,t=new Float32Array(c-1);t[0]=d[e];for(let s=1;s<t.length;++s)t[s]=t[s-1]+d[e+s];const n=cW.alea(i.toString()),r=f*a;for(let s=0;s<a;++s){const e=n();p[r+s]=t.length;for(let n=0;n<t.length;n++)if(e<t[n]){p[r+s]=n;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",p)}};function b9(e,t,n){const r=OL(-1,n);return m5([],t,r,e,n)}const x9={kernelName:VM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;e3(r,"neg");const s=n.data.get(r.dataId).values,[a,i]=b9(s,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,a)}},w9=YG;const k9={kernelName:GM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:s,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=r;e3(s,"NonMaxSuppression");const u=n.data.get(s.dataId).values,c=n.data.get(a.dataId).values,{selectedIndices:d}=w9(u,c,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},S9=QG;const I9={kernelName:HM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:s,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r;e3(s,"NonMaxSuppressionPadded");const c=n.data.get(s.dataId).values,d=n.data.get(a.dataId).values,{selectedIndices:h,validOutputs:p}=S9(c,d,i,o,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},C9=JG;const T9={kernelName:qM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:s,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r;e3(s,"NonMaxSuppressionWithScore");const c=n.data.get(s.dataId).values,d=n.data.get(a.dataId).values,h=i,p=o,f=l,m=u,{selectedIndices:g,selectedScores:y}=C9(c,d,h,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}},N9=h3(((e,t)=>e!==t?1:0)),E9=$3(WM,N9,null,"bool"),A9={kernelName:WM,backendName:"cpu",kernelFunc:E9};const R9={kernelName:XM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:s}=t,{dtype:a,depth:i,onValue:o,offValue:l}=r;e3(s,"oneHot");const u=mO(s.shape),c=new Float32Array(u*i);c.fill(l);const d=n.data.get(s.dataId).values;for(let h=0;h<u;++h)d[h]>=0&&d[h]<i&&(c[h*i+d[h]]=o);return n.makeTensorInfo([...s.shape,i],a,c)}};function _9(e){const{inputs:t,backend:n}=e,{x:r}=t;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const e=N3({inputs:{input:r},backend:n}),t=_9({inputs:{x:e},backend:n}),s=B4({inputs:{input:r},backend:n}),a=_9({inputs:{x:s},backend:n}),i=I3({inputs:{real:t,imag:a},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),i}return Z5({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const $9={kernelName:tL,backendName:"cpu",kernelFunc:_9};const O9={kernelName:KM,backendName:"cpu",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:s}=n;if("string"===s.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===s.dtype){const t=N3({inputs:{input:s},backend:r}),n=e({inputs:{x:t},backend:r}),a=B4({inputs:{input:s},backend:r}),i=_9({inputs:{x:a},backend:r}),o=I3({inputs:{real:n,imag:i},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(i),o}return Z5({backend:r,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}};function D9(e){const{inputs:t,backend:n,attrs:r}=e,{axis:s}=r;if(1===t.length)return L5({inputs:{input:t[0]},backend:n,attrs:{dim:s}});const a=t[0].shape,i=t[0].dtype;t.forEach((e=>{pO(a,e.shape,"All tensors passed to stack must have matching shapes"),hO(i===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const o=[],l=U4({inputs:t.map((e=>{const t=L5({inputs:{input:e},backend:n,attrs:{dim:s}});return o.push(t),t})),backend:n,attrs:{axis:s}});return o.forEach((e=>n.disposeIntermediateTensorInfo(e))),l}const M9={kernelName:YM,backendName:"cpu",kernelFunc:D9};const F9={kernelName:QM,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{paddings:a,constantValue:i}=r;e3(s,"pad");const o=a.map(((e,t)=>e[0]+s.shape[t]+e[1])),l=a.map((e=>e[0])),u=n.data.get(s.dataId).values,c=mO(s.shape),d=s.shape.length,h=OO(s.shape),p=mO(o),f=o.length,m=OO(o),g=IO(s.dtype,p);0!==i&&g.fill(i);for(let y=0;y<c;y++){g[BO(jO(y,d,h).map(((e,t)=>e+l[t])),f,m)]=u[y]}return{dataId:n.write(g,o,s.dtype),shape:o,dtype:s.dtype}}},L9=h3(((e,t)=>Math.pow(e,t))),P9=$3(JM,L9),z9={kernelName:JM,backendName:"cpu",kernelFunc:P9};function B9(e,t,n,r){const[s,a]=WU(e,r),i=hP(t,"int32"),o=LO(mO(s),i),l=mO(a);for(let u=0;u<o.length;++u){const e=u*l;let t=1;for(let r=0;r<l;++r)t*=n[e+r];o[u]=t}return{outVals:o,outShape:s,outDtype:i}}const j9={kernelName:eF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r;e3(s,"prod");const o=s.shape.length,l=kO(a,s.shape),u=qU(l,o);let c=l,d=s;const h=[];null!=u&&(d=Q3({inputs:{x:s},backend:n,attrs:{perm:u}}),h.push(d),c=XU(c.length,o));const p=n.data.get(d.dataId).values,{outVals:f,outShape:m,outDtype:g}=B9(d.shape,d.dtype,p,c);let y=m;return i&&(y=GU(m,l)),h.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(y,g,f)}};function U9(e,t,n,r){const s=[];let a=0;const i=t.length-1+n.length,o=new Array(i).fill(null).map((()=>[0]));!function(e,t){for(let n=0;n<e.length;++n){const r=e[n],s=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let e=1;e<r.length;++e)if(r[e-1]>r[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let l=1;for(let u=0;u<t.length-1;++u){l*=t[u];const e=t[u+1];for(let t=1;t<l+1;++t)o[u].push(t*e)}for(let u=0;u<e.length;++u){let r=e[u],i=e[u]+1;for(let e=0;e<n.length;++e){const s=n[e],a=e+t.length-1;if(a>=0){const e=o[a],t=e[e.length-1]-s[r];for(let n=r;n<i;++n)o[a].push(s[n+1]+t)}r=s[r],i=s[i]}i!==r&&(s.push([r,i]),a+=i-r)}return{outSplits:o,valueSlices:s,numValues:a}}function V9(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function W9(e,t,n,r,s){const a=t.slice();a[0]=s;const i=CO(n,mO(a)),o=e.length;return function(e,t,n,r,s,a){const i=V9(t,2)[1],o=V9(a,2)[1];let l=0;for(const u of n)for(let t=u[0];t<u[1];++t){for(let n=0;n<r;++n)s[l*o+n]=e[t*i+n];++l}}(e,t,r,0===o?0:o/t[0],i,a),[i,a]}function G9(e,t,n,r,s,a,i,o){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach(((e,r)=>{if(e<0||e>=n){const s=jO(r,t.length,OO(t)).join(",");throw new Error(`indices[${s}] = ${e} is not in [0, ${n})`)}}))}(a,i,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const l=r[0],{outSplits:u,valueSlices:c,numValues:d}=U9(a,i,e,l),h=function(e){const t=[];for(let n=0;n<e.length;++n){const r=CO("int32",e[n].length);t.push(r),e[n].forEach(((e,t)=>r[t]=e))}return t}(u),p=W9(n,r,s,c,d);return[h,p[0],p[1]]}const H9={kernelName:tF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:s,paramsDenseValues:a,indices:i}=t,{outputRaggedRank:o}=r,l=s.map((e=>n.data.get(e.dataId).values)),u=s.map((e=>e.shape)),c=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,[h,p,f]=G9(l,u,c,a.shape,a.dtype,d,i.shape),m=h.map((e=>n.makeTensorInfo([e.length],"int32",e))),g=n.makeTensorInfo(f,a.dtype,p);return m.concat([g])}},q9=2147483647;function K9(e,t,n,r,s,a,i){if(t.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const o=0===t.length,l=0===s.length,u=0===i.length,c=[];o||c.push(t[0]),l||c.push(s[0]),u||c.push(i[0]);for(let m=1;m<c.length;++m)if(c[m]!==c[m-1])throw new Error("starts, limits, and deltas must have the same shape");const d=0===c.length?1:c[0],h=CO("int32",d+1);h[0]=0;for(let m=0;m<d;++m){const t=o?e[0]:e[m],n=l?r[0]:r[m],s=u?a[0]:a[m];if(0===s)throw new Error("Requires delta != 0");let i;if(s>0&&n<t||s<0&&n>t)i=0;else if(i=Math.ceil(Math.abs((n-t)/s)),i>q9)throw new Error(`Requires ((limit - start) / delta) <= ${q9}`);h[m+1]=h[m]+i}const p=CO(n,h[d]);let f=0;for(let m=0;m<d;++m){const t=h[m+1]-h[m];let n=o?e[0]:e[m];const r=u?a[0]:a[m];for(let e=0;e<t;++e)p[f++]=n,n+=r}return[h,p]}const X9={kernelName:nF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:s,deltas:a}=t,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values,[u,c]=K9(i,r.shape,r.dtype,o,s.shape,l,a.shape);return[n.makeTensorInfo([u.length],"int32",u),n.makeTensorInfo([c.length],r.dtype,c)]}};var Y9=zH;class Q9{constructor(e,t,n,r,s,a,i,o,l,u){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=s,this.defaultValue=a,this.defaultValueShape=i,this.rowPartitionValues=o,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=UH(u),this.raggedRank=VH(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Y9.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Y9.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Y9.VALUE_ROWIDS:return Q9.getMaxWidthValueRowID(t);case Y9.ROW_SPLITS:return Q9.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Y9[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(0===t||1===t)return 0;let n=0;for(let r=0;r<t-1;++r){const t=e[r+1]-e[r];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(0===t)return 0;let n=0,r=e[0],s=0;for(let a=1;a<t;++a){const t=e[a];t!==r&&(r=t,s=Math.max(a-n,s),n=a)}return Math.max(t-n,s)}tensorShapeFromTensor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Z9(e,n)}calculateOutputSize(e){const t=this.valuesShape;WH(this.defaultValueShape,t);const n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=jH(this.raggedRank,n,t);r[0]<0&&(r[0]=e);for(let s=1;s<=this.raggedRank;++s)r[s]<0&&(r[s]=this.getMaxWidth(s));return r}calculateFirstParentOutputIndex(e,t,n){const r=Math.min(e,n),s=[];let a=0;for(let i=0;i<r;++i,a+=t)s.push(a);for(let i=r;i<e;++i)s.push(-1);return hO(s.length===e,(()=>"Final length of result must be equal to firstDimension.")),s}calculateOutputIndexRowSplit(e,t,n,r){const s=e.length,a=[];for(let i=0;i<s-1;++i){const s=e[i+1]-e[i];let o=Math.min(r,s),l=t[i];-1===l&&(o=0);for(let e=0;e<o;++e)a.push(l),l+=n;for(let e=0;e<s-o;++e)a.push(-1)}if(s>0&&a.length!==e[s-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(e,t,n,r){const s=e.length,a=[];if(0===s)return[];let i=0,o=e[0];if(o>=t.length)throw new Error(`Got currentValueRowId=${o}, which is not less than ${t.length}`);let l=t[o];a.push(l);for(let u=1;u<s;++u){const s=e[u];if(s===o)l>=0&&(++i,i<r?l+=n:l=-1);else{if(i=0,o=s,s>=t.length)throw new Error(`Got nextValueRowId=${s} which is not less than ${t.length}`);l=t[s]}a.push(l)}if(a.length!==e.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(e,t,n,r){const s=this.getRowPartitionTensor(e),a=this.getRowPartitionTypeByDimension(e);switch(a){case Y9.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,t,n,r);case Y9.ROW_SPLITS:if(s.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(s,t,n,r);default:throw new Error(`Unsupported partition type: ${Y9[a]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Y9.FIRST_DIM_SIZE:return e[0];case Y9.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Y9.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Y9[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let a=n.length-2;a>=0;--a)n[a]=n[a+1]*t[a+1];const r=Z9(t,!1),s=CO(this.valuesDType,mO(r));if(n[0]*t[0]>0){let a=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e){a=this.calculateOutputIndex(e-1,a,n[e],t[e])}this.setOutput(this.raggedRank,a,s,r)}return[r,s]}setOutput(e,t,n,r){if(0===n.length)return;const s=this.values,a=n;let i=r.slice();i=i.slice(e+1);const o=mO(i),l=t.length;let u=this.defaultValue;if(u.length!==o&&1!==u.length){const e=this.defaultValueShape;WP((()=>{const t=Kj(u,e),n=dU(t,i);u=n.dataSync()}))}let c=0,d=0,h=0;for(let p=0;p<=l;++p){let e=p<l?t[p]:-1;if(e!==h){if(d<h){const e=s.subarray(c*o);J9(a.subarray(d*o),e,(h-d)*o)}if(p>=l){const t=n.length;e=Math.floor(t/o)}if(e>h)if(1===this.defaultValue.length)a.subarray(h*o,e*o).fill(this.defaultValue[0]),h=e;else for(;e>h;){J9(a.slice(h*o),u,o),++h}e<0?(c=p+1,d=h):(c=p,d=h,h=d+1)}else++h}}}function J9(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function Z9(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function e8(e,t,n,r,s,a,i,o,l,u){return new Q9(e,t,n,r,s,a,i,o,l,u).compute()}const t8={kernelName:rF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:s,values:a,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.data.get(s.dataId).values,c=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,h=o.map((e=>n.data.get(e.dataId).values)),p=o.map((e=>e.shape)),[f,m]=e8(u,s.shape,c,a.shape,a.dtype,d,i.shape,h,p,l);return n.makeTensorInfo(f,a.dtype,m)}};function n8(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return LO(0,r);const s=LO(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),s[0]=e;for(let a=1;a<s.length;a++)s[a]=s[a-1]+n;return s}const r8={kernelName:sF,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:s,dtype:a,step:i}=n,o=n8(r,s,i,a);return t.makeTensorInfo([o.length],a,o)}},s8=s3(iF,(e=>1/e)),a8={kernelName:iF,backendName:"cpu",kernelFunc:s8};const i8={kernelName:dF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:s}=t,{alignCorners:a,halfPixelCenters:i,size:o}=r;e3(s,"resizeBilinear");const l=OO(s.shape),[u,c]=o,[d,h,p,f]=s.shape,m=n.data.get(s.dataId).values,g=new Float32Array(mO([d,u,c,f])),y=[a&&u>1?h-1:h,a&&c>1?p-1:p],v=[a&&u>1?u-1:u,a&&c>1?c-1:c];let b=0;const x=y[0]/v[0],w=y[1]/v[1];for(let k=0;k<d;k++)for(let e=0;e<u;e++){let t;t=i?x*(e+.5)-.5:x*e;const n=Math.max(0,Math.floor(t)),r=t-n,s=Math.min(h-1,Math.ceil(t)),a=k*l[0]+n*l[1],o=k*l[0]+s*l[1];for(let e=0;e<c;e++){let t;t=i?w*(e+.5)-.5:w*e;const n=Math.max(0,Math.floor(t)),s=t-n,u=Math.min(p-1,Math.ceil(t)),c=a+n*l[2],d=o+n*l[2],h=a+u*l[2],y=o+u*l[2];for(let e=0;e<f;e++){const t=m[c+e],n=m[d+e],a=t+(m[h+e]-t)*s,i=a+(n+(m[y+e]-n)*s-a)*r;g[b++]=i}}}return n.makeTensorInfo([d,u,c,f],"float32",g)}};const o8={kernelName:hF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:s,dy:a}=t,{alignCorners:i}=r;e3([a,s],"resizeBilinearGrad");const o=OO(s.shape),[l,u,c,d]=s.shape,[,h,p]=a.shape,f=new Float32Array(l*u*c*d),m=[i&&h>1?u-1:u,i&&p>1?c-1:c],g=[i&&h>1?h-1:h,i&&p>1?p-1:p],y=m[0]/g[0],v=m[1]/g[1],b=n.data.get(a.dataId).values;let x=0;for(let w=0;w<l;w++){const e=w*o[0];for(let t=0;t<h;t++){const n=t*y,r=Math.floor(n),s=Math.min(Math.ceil(n),u-1),a=e+r*o[1],i=e+s*o[1],l=n-r,h=1-l;for(let e=0;e<p;e++){const t=e*v,n=Math.floor(t),r=Math.min(Math.ceil(t),c-1),s=t-n,u=1-s,p=a+n*o[2],m=a+r*o[2],g=i+n*o[2],y=i+r*o[2],w=h*u,k=h*s,S=l*u,I=l*s;for(let e=0;e<d;e++){const t=b[x++];f[p+e]+=t*w,f[m+e]+=t*k,f[g+e]+=t*S,f[y+e]+=t*I}}}}return n.makeTensorInfo([l,c,u,d],"float32",f)}};const l8={kernelName:uF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:s}=t,{alignCorners:a,halfPixelCenters:i,size:o}=r;e3(s,"resizeNearestNeighbor");const l=OO(s.shape),[u,c]=o,[d,h,p,f]=s.shape,m=n.data.get(s.dataId).values,g=new Float32Array(d*u*c*f),y=[a&&u>1?h-1:h,a&&c>1?p-1:p],v=[a&&u>1?u-1:u,a&&c>1?c-1:c],b=y[0]/v[0],x=y[1]/v[1];let w=0;for(let k=0;k<d;k++){const e=k*l[0];for(let t=0;t<u;t++){const n=i?b*(t+.5):b*t;let r=Math.min(h-1,a?Math.round(n):Math.floor(n));i&&(r=Math.max(0,r));const s=e+r*l[1];for(let e=0;e<c;e++){const t=i?x*(e+.5):x*e;let n=Math.min(p-1,a?Math.round(t):Math.floor(t));i&&(n=Math.max(0,n));const r=s+n*l[2];for(let e=0;e<f;e++){const t=m[r+e];g[w++]=t}}}}return n.makeTensorInfo([d,u,c,f],s.dtype,g)}};const u8={kernelName:cF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:s,dy:a}=t,{alignCorners:i}=r;e3([a,s],"resizeNearestNeighborGrad");const o=OO(s.shape),l=OO(a.shape),[u,c,d,h]=s.shape,[,p,f]=a.shape,m=new Float32Array(u*c*d*h),g=n.data.get(a.dataId).values,y=[i&&p>1?c-1:c,i&&f>1?d-1:d],v=[i&&p>1?p-1:p,i&&f>1?f-1:f],b=y[0]/v[0],x=y[1]/v[1],w=1/b,k=1/x,S=2*Math.ceil(w)+2,I=2*Math.ceil(k)+2;for(let C=0;C<u;C++){const e=C*o[0];for(let t=0;t<c;t++){const n=e+t*o[1],r=Math.floor(t*w),s=Math.floor(r-S/2);for(let a=0;a<d;a++){const r=n+a*o[2],u=Math.floor(a*k),y=Math.floor(u-I/2);for(let n=0;n<h;n++){let o=0;for(let r=0;r<S;r++){const u=r+s;if(u<0||u>=p)continue;const h=e+u*l[1],m=u*b;if(t===Math.min(c-1,i?Math.round(m):Math.floor(m)))for(let e=0;e<I;e++){const t=e+y;if(t<0||t>=f)continue;const r=h+t*l[2],s=t*x;a===Math.min(d-1,i?Math.round(s):Math.floor(s))&&(o+=g[r+n])}}m[r+n]=o}}}}return n.makeTensorInfo(s.shape,s.dtype,m)}};const c8={kernelName:fF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{dims:a}=r;e3(s,"reverse");const i=s.shape.length,o=kO(a,s.shape);if(0===i)return l3({inputs:{x:s},backend:n});const l=new KL(s.shape,s.dtype),u=n.bufferSync(s);for(let c=0;c<l.size;c++){const e=l.indexToLoc(c),t=e.slice();o.forEach((e=>t[e]=s.shape[e]-1-t[e])),l.set(u.get(...t),...e)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}},d8={kernelName:sL,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:s}=t,{radians:a,fillValue:i,center:o}=n,l=r,u=IO(s.dtype,mO(s.shape)),[c,d,h,p]=s.shape,[f,m]=qH(o,d,h),g=Math.sin(a),y=Math.cos(a),v=l.data.get(s.dataId).values;for(let b=0;b<c;b++){const e=b*h*d*p;for(let t=0;t<d;t++){const n=t*(h*p);for(let r=0;r<h;r++){const s=r*p;for(let a=0;a<p;a++){const o=[c,t,r,a],l=o[2],b=o[1];let x=(l-f)*y-(b-m)*g,w=(l-f)*g+(b-m)*y;x=Math.round(x+f),w=Math.round(w+m);let k=i;if("number"!==typeof i&&(k=3===a?255:i[a]),x>=0&&x<h&&w>=0&&w<d){k=v[e+w*(h*p)+x*p+a]}u[e+n+s+a]=k}}}}return{dataId:l.write(u,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}},h8=s3(mF,(e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),p8={kernelName:mF,backendName:"cpu",kernelFunc:h8},f8=r3((e=>1/Math.sqrt(e))),m8=a3(gF,f8),g8={kernelName:gF,backendName:"cpu",kernelFunc:m8};function y8(e,t,n,r,s,a,i,o,l,u){const c=[r/s,s],d=e.values,h=t.values;if(0===r)return Qz(n,t.dtype);const p=l instanceof KL?l:Qz(c,t.dtype);"string"===typeof l||"number"===typeof l?p.values.fill(l):"boolean"===typeof l&&p.values.fill(+l);for(let f=0;f<a;f++){const e=[];let a=0;for(let t=0;t<i;t++){const n=d[f*i+t];e.push(n),a+=n*o[t]}if(a<0||a>=r/s)throw new Error(`Invalid indices: ${e} does not index into ${n}`);for(let n=0;n<s;n++)u?p.values[a*s+n]+=h[f*s+n]:p.values[a*s+n]=0===t.rank?h[0]:h[f*s+n]}return p}const v8={kernelName:yF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:s,updates:a}=t,{shape:i}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=iG(0,s,i),h=y8(n.bufferSync(s),n.bufferSync(a),i,d,u,l,o,c,0,!0);return n.makeTensorInfo(i,h.dtype,h.values)}};function b8(e,t){let n=0,r=e.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),e[s]<t?n=s+1:r=s;return r}function x8(e,t){let n=0,r=e.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),e[s]<=t?n=s+1:r=s;return r}const w8={kernelName:bF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:s,values:a}=t,{side:i}=r,o=function(e,t,n,r,s,a){const i=CO("int32",n*s);for(let o=0;o<n;++o){const n=e.slice(o*r,(o+1)*r),l=o*s;for(let e=0;e<s;++e)i[l+e]="left"===a?b8(n,t[e+l]):x8(n,t[e+l])}return i}(n.data.get(s.dataId).values,n.data.get(a.dataId).values,s.shape[0],s.shape[1],a.shape[1],i);return n.makeTensorInfo(a.shape,"int32",o)}};const k8={kernelName:xF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:s,e:a}=t;e3([r,s,a],"select");const i=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=n.data.get(a.dataId).values,c=hP(s.dtype,a.dtype),d=LO(mO(s.shape),c);let h=0;const p=0===i||i>1||1===s.shape.length?1:mO(s.shape.slice(1));for(let f=0;f<o.length;f++)for(let e=0;e<p;e++)1===o[f]?d[h++]=l[f]:d[h++]=u[f];return n.makeTensorInfo(s.shape,c,d)}},S8=eq,I8=tq,C8=s3(wF,(e=>e>=0?I8*e:S8*(Math.exp(e)-1))),T8={kernelName:wF,backendName:"cpu",kernelFunc:C8},N8=s3(CF,(e=>e<0?-1:e>0?1:0)),E8={kernelName:CF,backendName:"cpu",kernelFunc:N8},A8=s3(SF,(e=>Math.sin(e))),R8={kernelName:SF,backendName:"cpu",kernelFunc:A8},_8=s3(IF,(e=>Math.sinh(e))),$8={kernelName:IF,backendName:"cpu",kernelFunc:_8},O8=Math.log(1.1920928955078125e-7)+2,D8=s3(NF,(e=>{const t=e>-O8,n=e<O8,r=Math.exp(e);let s;return s=n?r:t?e:Math.log(1+r),s})),M8={kernelName:NF,backendName:"cpu",kernelFunc:D8};const F8={kernelName:RF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{blockShape:a,paddings:i}=r;e3([s],"spaceToBatchND");const o=mO(a),l=[[0,0]];l.push(...i);for(let g=1+a.length;g<s.shape.length;++g)l.push([0,0]);const u=F9.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),c=KH(u.shape,a,o,!1),d=XH(c.length,a.length,!1),h=YH(u.shape,a,o,!1),p=P3({inputs:{x:u},backend:n,attrs:{shape:c}}),f=Q3({inputs:{x:p},backend:n,attrs:{perm:d}}),m=P3({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}};function L8(e,t,n,r,s,a,i){const o=t[0],l=a[0],u=new Array(l),c=new Array(o),d=t[1];if(0===l){if(0!==o)throw new Error(Nq(o));return[CO(n,0),[0,d],CO(s,0),u,c]}let h=!0,p=0;const f=new Array(l).fill(0);for(let g=0;g<o;++g){const t=e[g*d];if(t<0)throw new Error(Eq(g,t));if(t>=l)throw new Error(Aq(g,t,l));++f[t],h=h&&t>=p,p=t}let m=!0;for(let g=0;g<l;++g){const e=0===f[g];u[g]=e,m=m&&!e,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&h){const t=e,n=r;for(let e=0;e<o;++e)c[e]=e;return[t,[o,d],n,u,c]}{const t=f[l-1],a=CO(n,t*d),h=CO(s,t),p=new Array(l).fill(0);for(let n=0;n<o;++n){const t=e[n*d],s=p[t],i=(0===t?0:f[t-1])+s;p[t]++;for(let r=0;r<d;++r)a[i*d+r]=e[n*d+r];h[i]=r[n],c[n]=i}for(let e=0;e<l;++e){if(0===p[e]){const t=0===e?0:f[e-1];a[t*d+0]=e;for(let e=1;e<d;++e)a[t*d+e]=0;h[t]=i}}return[a,[t,d],h,u,c]}}const P8={kernelName:OF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:s,denseShape:a,defaultValue:i}=t;if(1!==a.shape.length)throw new Error(`Dense shape must be a vector, saw:\n        ${a.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n        ${r.shape}`);if(1!==s.shape.length)throw new Error(`Values must be a vector, saw:\n        ${s.shape}`);if(0!==i.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${i.shape}`);const o=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values[0],[d,h,p,f,m]=L8(o,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],s.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};function z8(e,t,n,r,s){const a=mO(r),i=t[0],o=s.length,l=[];let u=1,c=-1;for(let m=0;m<o;++m){const e=s[m];if(-1===e){if(-1!==c)throw new Error(Rq(c,m));c=m,l.push(1)}else{if(e<0)throw new Error(_q(m,e));u*=e,l.push(e)}}if(-1!==c){if(u<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const e=Math.trunc(a/u);if(u*e!==a)throw new Error(Oq(r,l));l[c]=e}if(mO(l)!==a)throw new Error(Dq(r,l));const d=r.length,h=[];if(d>0){h[d-1]=1;for(let e=d-2;e>=0;--e)h[e]=h[e+1]*r[e+1]}const p=[];if(o>0){p[o-1]=1;for(let e=o-2;e>=0;--e)p[e]=p[e+1]*l[e+1]}const f=CO(n,i*o);for(let m=0;m<i;++m){let t=0;for(let n=0;n<d;++n)t+=e[m*d+n]*h[n];for(let e=0;e<o;++e)f[m*o+e]=Math.trunc(t/p[e]),t%=p[e]}return[f,[i,o],l]}const B8={kernelName:DF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:s,newShape:a}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${r.shape}`);if(1!==s.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${s.shape}`);if(1!==a.shape.length)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(n.data.get(s.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(a.dataId).values),[u,c,d]=z8(o,r.shape,r.dtype,i,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}};function j8(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const o=r.length,l=[t[0],e.length/t[0]],u=l[1],c=o>0?s[o-1]+1:0;if(c<0)throw new Error("segment ids must be >= 0");const d=t.slice();d[0]=c;const h=CO(n,d.reduce(((e,t)=>e*t),1));if(0===o)return c>0&&h.fill(i),[h,d];if(c<=0)throw new Error("segment ids must be >= 0");let p=0,f=1,m=0,g=s[p];for(;;){let t=0;if(f<o){if(t=s[f],g===t){++f;continue}if(g>=t)throw new Error("segment ids are not increasing")}if(g<0||g>=c)throw new Error(Lq(g,c));g>m&&h.fill(i,m*u,g*u);for(let n=p;n<f;++n){const t=r[n];if(t<0||t>=l[0])throw new Error(Pq(n,r[n],l[0]));for(let n=0;n<u;n++)h[g*u+n]+=e[t*u+n]}if(a)for(let e=0;e<u;e++)h[g*u+e]/=f-p;if(p=f,++f,m=g+1,g=t,f>o)break}return m<c&&h.fill(i,m*u,c*u),[h,d]}const U8={kernelName:MF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:s,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error(`Indices should be a vector but received shape\n          ${s.shape}`);if(1!==a.shape.length)throw new Error(`Segment ids should be a vector but received shape\n          ${a.shape}`);if(s.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values,[u,c]=j8(i,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(c,r.dtype,u)}};const V8={kernelName:FF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:s,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error(`Indices should be a vector but received shape\n         ${s.shape}`);if(1!==a.shape.length)throw new Error(`Segment ids should be a vector but received shape\n         ${a.shape}`);if(s.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values,[u,c]=j8(i,r.shape,r.dtype,o,l);return n.makeTensorInfo(c,r.dtype,u)}};const W8={kernelName:LF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:s,sparseValues:a,defaultValue:i}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=iG(0,s,o),p=!1,f=n.bufferSync(s);let m;switch(a.dtype){case"bool":m=y8(f,n.bufferSync(a),o,h,c,u,l,d,Boolean(n.data.get(i.dataId).values[0]),p);break;case"float32":m=y8(f,n.bufferSync(a),o,h,c,u,l,d,n.data.get(i.dataId).values[0],p);break;case"int32":m=y8(f,n.bufferSync(a),o,h,c,u,l,d,n.data.get(i.dataId).values[0],p);break;case"string":m=y8(f,n.bufferSync(a),o,h,c,u,l,d,LL(n.data.get(i.dataId).values[0]),p);break;default:throw new Error(`Unsupported type ${a.dtype}`)}return n.makeTensorInfo(o,m.dtype,m.values)}};const G8={kernelName:_F,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{numOrSizeSplits:a,axis:i}=r,o=kO(i,s.shape)[0],l=Tq(s,a,o),u=new Array(s.shape.length).fill(0),c=s.shape.slice();return l.map((e=>{const t=[...c];t[o]=e;const r=S4({inputs:{x:s},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,r}))}},H8=r3((e=>Math.sqrt(e))),q8=s3(EF,(e=>Math.sqrt(e))),K8={kernelName:EF,backendName:"cpu",kernelFunc:q8},X8={kernelName:zF,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{x:r}=t,s=n;e3(r,"square");const a=s.data.get(r.dataId).values,i=new Float32Array(a.length);for(let o=0;o<a.length;++o){const e=a[o];i[o]=e*e}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Y8=h3(((e,t)=>{const n=e-t;return n*n})),Q8=$3(PF,Y8),J8={kernelName:PF,backendName:"cpu",kernelFunc:Q8},Z8=r3(((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=t;return e.replace(new RegExp(n,r?"g":""),s)})),e7=a3(BF,Z8),t7={kernelName:BF,backendName:"cpu",kernelFunc:e7},n7=s3(nL,((e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),r7={kernelName:nL,backendName:"cpu",kernelFunc:n7};function s7(e,t,n,r){const s=Qz(e,t.dtype);for(let a=0;a<s.size;a++){const e=s.indexToLoc(a),i=new Array(e.length);for(let t=0;t<i.length;t++)i[t]=e[t]*n[t]+r[t];s.set(t.get(...i),...e)}return s}const a7={kernelName:jF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{begin:a,end:i,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=r;e3(s,"stridedSlice");const{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:x}=bj(s.shape,a,i,o,l,u,c,d,h);let w;if(m)w=P3({inputs:{x:s},backend:n,attrs:{shape:f}});else if(g||y){hO(s.shape.length>=1,(()=>`Input must have rank at least 1, got: ${s.shape.length}`));const e=ij(v,b,x),t=S4({inputs:{x:s},backend:n,attrs:{begin:v,size:e}});w=P3({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{const e=s7(p,n.bufferSync(s),x,v);w=n.makeTensorInfo(f,e.dtype,e.values)}return w}};class i7{constructor(e,t,n,r,s,a){this.separator=FL(e),this.nGramWidths=t,this.leftPad=FL(n),this.rightPad=FL(r),this.padWidth=s,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,s,a){for(let i=0;i<s;++i){const o=this.getPadWidth(a),l=Math.max(0,o-i),u=Math.max(0,o-(s-(i+1))),c=a-(l+u),d=t+(l>0?0:i-o);let h=0;h+=l*this.leftPad.length;for(let t=0;t<c;++t)h+=e[d+t].length;h+=u*this.rightPad.length;h+=(l+u+c-1)*this.separator.length,n[r+i]=new Uint8Array(h);const p=n[r+i];let f=0;const m=e=>e.forEach((e=>p[f++]=e));for(let e=0;e<l;++e)m(this.leftPad),m(this.separator);for(let t=0;t<c-1;++t)m(e[d+t]),m(this.separator);if(c>0){m(e[d+c-1]);for(let e=0;e<u;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<u-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){const n=e.length,r=t.length;if(r>0){let e=t[0];if(0!==e)throw new Error(`First split value must be 0, got ${e}`);for(let s=1;s<r;++s){let r=t[s]>=e;if(r=r&&t[s]<=n,!r)throw new Error(`Invalid split value ${t[s]}, must be in [${e}, ${n}]`);e=t[s]}if(e!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${e}`)}const s=r-1,a=CO("int32",r);if(0===n||0===r){const e=new Array(n);for(let t=0;t<=s;++t)a[t]=0;return[e,a]}a[0]=0;for(let o=1;o<=s;++o){const e=t[o]-t[o-1];let n=0;this.nGramWidths.forEach((t=>{n+=this.getNumNGrams(e,t)})),this.preserveShort&&e>0&&0===n&&(n=1),a[o]=a[o-1]+n}const i=new Array(a[s]);for(let o=0;o<s;++o){const n=t[o];let r=a[o];if(this.nGramWidths.forEach((s=>{const a=t[o+1]-t[o],l=this.getNumNGrams(a,s);this.createNGrams(e,n,i,r,l,s),r+=l})),this.preserveShort&&r===a[o]){const s=t[o+1]-t[o];if(0===s)continue;const a=s+2*this.padWidth,l=1;this.createNGrams(e,n,i,r,l,a)}}return[i,a]}}function o7(e,t,n,r,s,a,i,o){return new i7(n,r,s,a,i,o).compute(e,t)}const l7={kernelName:UF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:s,nGramWidths:a,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=t,h=n.data.get(c.dataId).values,p=n.data.get(d.dataId).values,[f,m]=o7(h,p,s,a,i,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}};function u7(e,t,n,r){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(1===t.length){const s=t[0];let a=e.indexOf(s);for(;-1!==a;){const t=e.subarray(0,a);n&&0===t.length||r.push(t),a=(e=e.subarray(a+1)).indexOf(s)}return void(n&&0===e.length||r.push(e))}let s=0;for(let a=0;a<e.length+1;a++)if(a===e.length||-1!==t.indexOf(e[a])){const t=e.subarray(s,a);n&&0===t.length||r.push(t),s=a+1}}function c7(e,t,n){const r=e.length,s=[];let a=0,i=0;const o=new Array(r);for(let h=0;h<r;++h){const r=s.length;u7(e[h],t,n,s);const l=s.length-r;o[h]=l,a+=l,i=Math.max(i,l)}const l=CO("int32",2*a),u=new Array(a),c=[r,i];let d=0;for(let h=0;h<r;++h)for(let e=0;e<o[h];++e)l[2*d]=h,l[2*d+1]=e,u[d]=s[d],++d;return[l,u,c]}const d7={kernelName:VF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:s}=r,{input:a,delimiter:i}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(0!==i.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values[0],[u,c,d]=c7(o,l,s),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};function h7(e,t){const n=CO("int32",e.length);for(let r=0;r<e.length;++r)n[r]=$L(e[r]).modulo(t).getLowBitsUnsigned();return n}const p7={kernelName:WF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:s}=r,{input:a}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=h7(n.data.get(a.dataId).values,s);return n.makeTensorInfo(a.shape,"int32",i)}},f7=s3(HF,(e=>Math.tan(e))),m7={kernelName:HF,backendName:"cpu",kernelFunc:f7},g7=s3(qF,(e=>Math.tanh(e)));function y7(e,t){const n=new Array(e.rank);for(let s=0;s<n.length;s++)n[s]=e.shape[s]*t[s];const r=Qz(n,e.dtype);for(let s=0;s<r.values.length;++s){const t=r.indexToLoc(s),n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=t[r]%e.shape[r];const a=e.locToIndex(n);r.values[s]=e.values[a]}return r}const v7=(e,t)=>{const n=t.value-e.value;return 0===n?e.index-t.index:n};function b7(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;for(;r>n;){if(r-n>600){const s=r-n+1,a=t-n+1,i=Math.log(s),o=.5*Math.exp(2*i/3),l=.5*Math.sqrt(i*o*(s-o)/s)*Math.sign(a-s/2);b7(e,t,Math.max(n,Math.floor(t-a*o/s+l)),Math.min(r,Math.floor(t+(s-a)*o/s+l)))}const s=e[t];let a=n,i=r;for(dO(e,n,t),v7(e[r],s)>0&&dO(e,n,r);a<i;){for(dO(e,a,i),a++,i--;v7(e[a],s)<0;)a+=1;for(;v7(e[i],s)>0;)i-=1}0===v7(e[n],s)?dO(e,n,i):(i+=1,dO(e,i,r)),i<=t&&(n=i+1),t<=i&&(r=i-1)}}function x7(e,t,n,r,s){const a=t[t.length-1],[i,o]=[e.length/a,a],l=IO(n,i*r),u=IO("int32",i*r);for(let d=0;d<i;d++){const t=d*o,n=e.subarray(t,t+o);let a=new Array(n.length);n.forEach(((e,t)=>a[t]={value:e,index:t})),r<a.length&&(b7(a,r),a=a.slice(0,r)),s&&a.sort(v7);const i=d*r,c=l.subarray(i,i+r),h=u.subarray(i,i+r);for(let e=0;e<r;e++)c[e]=a[e].value,h[e]=a[e].index}const c=t.slice();return c[c.length-1]=r,[Qz(c,n,l),Qz(c,"int32",u)]}function w7(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{const e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return uO(0,n,t-1)}(e,t);case"wrap":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{const e=t-1;n-=t*Math.trunc(n/e)}return uO(0,n,t-1)}(e,t);case"nearest":return function(e,t){return uO(0,e,t-1)}(e,t);default:return function(e){return e}(e)}}function k7(e,t,n,r,s,a,i,o,l,u,c){return 0<=o&&o<t&&0<=l&&l<n?e[i*r+o*s+l*a+u]:c}function S7(e,t,n,r,s,a,i,o,l,u,c){return k7(e,t,n,r,s,a,i,Math.round(o),Math.round(l),u,c)}function I7(e,t,n,r,s,a,i,o,l,u,c){const d=Math.floor(o),h=Math.floor(l),p=d+1,f=h+1;return(p-o)*((f-l)*k7(e,t,n,r,s,a,i,d,h,u,c)+(l-h)*k7(e,t,n,r,s,a,i,d,f,u,c))+(o-d)*((f-l)*k7(e,t,n,r,s,a,i,p,h,u,c)+(l-h)*k7(e,t,n,r,s,a,i,p,f,u,c))}function C7(e,t,n,r){const s=kO(t,n)[0],a=[1,n[0],1];for(let f=0;f<s;f++)a[0]*=n[f];a[1]=n[s];for(let f=s+1;f<n.length;f++)a[2]*=n[f];const i=new Map,o=new Int32Array(n[s]),l=new KL(a,r,e),u=[],c=1===a[0]&&1===a[2];for(let f=0;f<n[s];f++){let t;if(c)t=e[f].toString();else{const e=[];for(let t=0;t<a[0];t++)for(let n=0;n<a[2];n++)e.push(l.get(t,f,n));t=e.join(",")}const n=i.get(t);if(null!=n)o[f]=n;else{const e=i.size;i.set(t,e),o[f]=e,u.push(f)}}const d=a.slice();d[1]=i.size;const h=new KL(d,r);u.forEach(((e,t)=>{for(let n=0;n<a[0];n++)for(let r=0;r<a[2];r++)h.set(l.get(n,e,r),n,t,r)}));const p=n.slice();return p[s]=d[1],{outputValues:h.values,outputShape:p,indices:o}}const T7=[U3,W3,H3,K3,L3,X3,Z3,e4,t4,n4,s4,i4,l4,d4,p4,y4,v4,b4,x4,j3,w4,C4,E4,_4,$4,_3,M4,L4,C3,P4,V4,G4,H4,q4,K4,X4,Y4,J4,e5,t5,n5,r5,s5,a5,o5,l5,u5,c5,d5,h5,p5,f5,w5,o3,k5,C5,O5,F5,P5,j5,J5,e6,t6,s6,o6,l6,u6,d6,p6,g6,b6,u3,x6,j4,k6,I6,T6,d3,A6,$6,D6,L6,z6,U6,W6,q6,K6,X6,J6,t9,n9,r9,s9,a9,i9,o9,l9,d9,h9,m9,v9,v5,x9,k9,I9,T9,A9,R9,O9,M9,F9,z9,m3,j9,H9,X9,t8,r8,E3,W5,a8,y3,b3,z3,i8,o8,l8,u8,c8,d8,p8,g8,v8,w8,k8,T8,k3,E8,R8,$8,I4,y9,M8,F8,P8,B8,U8,V8,W8,G8,K8,X8,J8,t7,r7,a7,l7,d7,p7,K5,x5,m7,{kernelName:qF,backendName:"cpu",kernelFunc:g7},{kernelName:vF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{tensor:r,indices:s,updates:a}=t,{sliceRank:i,numUpdates:o,sliceSize:l,strides:u,outputSize:c}=iG(0,s,r.shape),d=n.bufferSync(s),h=n.bufferSync(a),p=n.bufferSync(r),f=y8(d,h,r.shape,c,l,o,i,u,p,!1);return n.makeTensorInfo(r.shape,f.dtype,f.values)}},{kernelName:KF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{reps:a}=r;e3(s,"tile");const i=y7(n.bufferSync(s),a);return n.makeTensorInfo(i.shape,i.dtype,i.values)}},{kernelName:XF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{k:a,sorted:i}=r;e3(s,"topk");const o=n.data.get(s.dataId).values,[l,u]=x7(o,s.shape,s.dtype,a,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}},{kernelName:YF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{image:s,transforms:a}=t,{interpolation:i,fillMode:o,fillValue:l,outputShape:u}=n,[c,d,h,p]=s.shape,[f,m]=null!=u?u:[d,h],g=[c,f,m,p],y=OO(s.shape),v=y[0],b=y[1],x=y[2],w=OO(g),k=w[0],S=w[1],I=w[2],C=IO(s.dtype,mO(g));C.fill(l);const T=r.data.get(s.dataId).values,N=r.data.get(a.dataId).values;for(let E=0;E<c;++E){const e=1===a.shape[0]?N:N.subarray(8*E,8*E+8);for(let t=0;t<f;++t)for(let n=0;n<m;++n)for(let r=0;r<p;++r){let s;const a=e[6]*n+e[7]*t+1;if(0===a)continue;const u=(e[0]*n+e[1]*t+e[2])/a,c=(e[3]*n+e[4]*t+e[5])/a,p=w7(u,h,o),f=w7(c,d,o);switch(i){case"nearest":s=S7(T,d,h,v,b,x,E,f,p,r,l);break;case"bilinear":s=I7(T,d,h,v,b,x,E,f,p,r,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}C[E*k+t*S+n*I+r]=s}return r.makeTensorInfo(g,s.dtype,C)}return{dataId:r.write(C,g,s.dtype),shape:s.shape,dtype:s.dtype}}},J3,{kernelName:JF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:s}=n,{x:a}=t;e3(a,"unique");const i=r.data.get(a.dataId).values,{outputValues:o,outputShape:l,indices:u}=C7(i,s,a.shape,a.dtype);return[r.makeTensorInfo(l,a.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}},{kernelName:ZF,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:s}=t;let{axis:a}=r;a<0&&(a+=s.shape.length);const i=s.shape.length,o=s.shape[a],l=new Array(i-1);let u=0;for(let p=0;p<i;p++)p!==a&&(l[u++]=s.shape[p]);const c=new Array(i).fill(0),d=s.shape.slice();d[a]=1;const h=new Array(o);for(let p=0;p<h.length;p++){c[a]=p;const e=S4({inputs:{x:s},backend:n,attrs:{begin:c,size:d}});h[p]=P3({inputs:{x:e},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(e)}return h}},{kernelName:eL,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,segmentIds:a}=t,{numSegments:i}=r;e3(s,"unsortedSegmentSum");const o=[],l=[],u=s.shape.length-a.shape.length;let c=a;for(let h=0;h<u;++h){const e=L5({inputs:{input:c},backend:n,attrs:{dim:h+1}});c=e,l.push(e)}for(let h=0;h<i;++h){const e=OL(h,"int32"),t=n.makeTensorInfo([],"int32",e),r=I5({inputs:{a:t,b:c},backend:n}),a=R3({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),i=y5({inputs:{a:a,b:s},backend:n}),u=b5({inputs:{x:i},backend:n,attrs:{axis:0,keepDims:!1}});o.push(u),l.push(t),l.push(r),l.push(a),l.push(i),l.push(u)}const d=D9({inputs:o,backend:n,attrs:{axis:0}});return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),d}},$9];for(const n of T7)mL(n);const N7={},E7={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function A7(e,t){if(!(e in N7)||null!=t){const n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==t?function(e){if(HO().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==e){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;n.addEventListener("webglcontextlost",(t=>{t.preventDefault(),delete N7[e]}),!1),HO().getBool("SOFTWARE_WEBGL_ENABLED")&&(E7.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",E7)||n.getContext("experimental-webgl",E7);return n.getContext("webgl2",E7)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;N7[e]=n}const n=N7[e];return null==n||n.isContextLost()?(delete N7[e],A7(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),N7[e])}var R7,_7,$7,O7,D7,M7;function F7(e,t){return[t,e]}function L7(e){const t=mO(e);return vO(Math.ceil(t/4))}function P7(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function z7(e,t){const n=e;let r,s,a,i,o,l,u,c,d,h;return 2===HO().getNumber("WEBGL_VERSION")?(r=n.R32F,s=n.R16F,a=n.RGBA16F,i=n.RGBA32F,o=n.RED,u=4,c=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(r=e.RGBA,s=e.RGBA,a=e.RGBA,i=n.RGBA,o=e.RGBA,u=4,c=4,d=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:h}}function B7(e,t){const n=t();return HO().getBool("DEBUG")&&function(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}(e,t))}(e),n}(_7=R7||(R7={}))[_7.DENSE=0]="DENSE",_7[_7.SHARED_BATCH=1]="SHARED_BATCH",(O7=$7||($7={}))[O7.RENDER=0]="RENDER",O7[O7.UPLOAD=1]="UPLOAD",O7[O7.PIXELS=2]="PIXELS",O7[O7.DOWNLOAD=3]="DOWNLOAD",(M7=D7||(D7={}))[M7.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",M7[M7.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",M7[M7.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",M7[M7.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",M7[M7.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16";function j7(e){return!!(HO().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function U7(e,t){return Q7(e,(()=>e.getExtension(t)),'Extension "'+t+'" not supported on this browser.')}const V7=/ERROR: [0-9]+:([0-9]+):/g;function W7(e,t){const n=V7.exec(t);if(null==n)return console.log(`Couldn't parse line number in error: ${t}`),void console.log(e);const r=+n[1],s=e.split("\n"),a=s.length.toString().length+2,i=s.map(((e,t)=>bO((t+1).toString(),a)+e));let o=0;for(let d=0;d<i.length;d++)o=Math.max(i[d].length,o);const l=i.slice(0,r-1),u=i.slice(r-1,r),c=i.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${bO(u[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join("\n"))}function G7(e,t){if(B7(e,(()=>e.validateProgram(t))),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function H7(e,t,n,r,s,a,i){const o=e.getAttribLocation(t,n);return-1!==o&&(B7(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,r))),B7(e,(()=>e.vertexAttribPointer(o,s,e.FLOAT,!1,a,i))),B7(e,(()=>e.enableVertexAttribArray(o))),!0)}function q7(e,t,n,r){B7(e,(()=>function(e,t,n){J7(e,n),B7(e,(()=>e.activeTexture(e.TEXTURE0+n))),B7(e,(()=>e.bindTexture(e.TEXTURE_2D,t)))}(e,t,r))),B7(e,(()=>e.uniform1i(n,r)))}function K7(e,t,n){B7(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,n))),B7(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)))}function X7(e,t){B7(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,t))),B7(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)))}function Y7(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}(e,t))}function Q7(e,t,n){const r=B7(e,(()=>t()));if(null==r)throw new Error(n);return r}function J7(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){throw new Error(`textureUnit must be in ${`[gl.TEXTURE0, gl.TEXTURE${n}]`}.`)}}function Z7(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return mO(e.slice(0,e.length-t))}function eee(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function tee(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[Z7(e),...eee(e)]),t}function nee(e){return e%2===0}function ree(e,t){if(gO(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r)return!0;if(nee(n)&&nee(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&nee(e[0])&&nee(t[0])}let see,aee;function iee(e,t){return null!=e.getExtension(t)}function oee(e){try{if(null!=A7(e))return!0}catch(Ipe){return console.log("Error when getting WebGL context: ",Ipe),!1}return!1}function lee(e){if(0===e)return!1;const t=A7(e);if(1!==e){if(iee(t,"EXT_color_buffer_float"))return uee(t);const e="EXT_color_buffer_half_float";if(iee(t,e)){const n=t.getExtension(e);return function(e,t){const n=z7(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const s=1,a=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,s,a,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),o}(t,n)}return!1}if(!iee(t,"OES_texture_float"))return!1;if(!iee(t,"WEBGL_color_buffer_float"))return!1;return uee(t)}function uee(e){const t=z7(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),s}function cee(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&hO("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the WebGL backend.`))}))}const dee=HO();function hee(){let e,t,n,r,s,a,i,o,l,u;return 2===HO().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",s="texture",a="outputColor",i="out vec4 outputColor;",o=HO().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",s="texture2D",a="gl_FragColor",i="",o="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:s,output:a,defineOutput:i,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}function pee(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=OO(t);return r.map(((t,s)=>`${`int ${e[s]} = ${n} / ${t}`}; ${s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${t}`:`index -= ${e[s]} * ${t}`};`)).join("")}function fee(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=OO(t);return r.map(((t,s)=>`${`int ${e[s]} = ${n} / outShapeStrides[${s}]`}; ${s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * outShapeStrides[${s}]`:`index -= ${e[s]} * outShapeStrides[${s}]`};`)).join("")}function mee(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=function(e,t){const n=e.length,r=e.map((e=>`${t}[${e}]`)),s=new Array(n-1);s[n-2]=r[n-1];for(let a=n-3;a>=0;--a)s[a]=`(${s[a+1]} * ${r[a+1]})`;return s}(e.map(((e,t)=>t)),t);return r.map(((t,s)=>`${`int ${e[s]} = ${n} / ${r[s]}`}; ${s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${r[s]}`:`index -= ${e[s]} * ${r[s]}`};`)).join("")}function gee(e){const t=OO(e).map((e=>e.toString()));return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;\n  }\n`}dee.registerFlag("HAS_WEBGL",(()=>dee.getNumber("WEBGL_VERSION")>0)),dee.registerFlag("WEBGL_VERSION",(()=>oee(2)?2:oee(1)?1:0)),dee.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),dee.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===dee.get("WEBGL_VERSION"))),dee.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),dee.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),dee.registerFlag("WEBGL_PACK",(()=>dee.getBool("HAS_WEBGL"))),dee.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_PACK_CLIP",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_PACK_REDUCE",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_LAZILY_UNPACK",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_CONV_IM2COL",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",(()=>dee.getBool("WEBGL_PACK"))),dee.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>function(e){if(null==see){const t=A7(e);see=t.getParameter(t.MAX_TEXTURE_SIZE)}return see}(dee.getNumber("WEBGL_VERSION")))),dee.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>function(e){if(null==aee){const t=A7(e);aee=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,aee)}(dee.getNumber("WEBGL_VERSION")))),dee.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const e=dee.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;let t;const n=A7(e);return t=iee(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:iee(n,"EXT_disjoint_timer_query")?1:0,t}(e)})),dee.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>dee.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!NP())),dee.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>function(e){if(0===e)return!1;const t=A7(e);if(1===e){if(!iee(t,"OES_texture_float"))return!1}else if(!iee(t,"EXT_color_buffer_float"))return!1;return uee(t)}(dee.getNumber("WEBGL_VERSION")))),dee.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!dee.getBool("WEBGL_FORCE_F16_TEXTURES")&&dee.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),dee.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>lee(dee.getNumber("WEBGL_VERSION")))),dee.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>{return 2===(e=dee.getNumber("WEBGL_VERSION"))&&null!=A7(e).fenceSync;var e})),dee.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>dee.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),dee.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(e=>{if("number"!==typeof e)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&-1!==e)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)})),dee.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>NP()?1:-1),(e=>{if("number"!==typeof e)throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&-1!==e)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)})),dee.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),dee.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),dee.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),dee.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),dee.registerFlag("WEBGL_EXP_CONV",(()=>!1)),dee.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>dee.getBool("IS_TEST"))),dee.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),dee.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),dee.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1)),dee.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1));const yee="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:vee}=a;function bee(e,t,n){const r=[];if(e.forEach((e=>{const t=mO(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push(`uniform float ${e.name}${t>1?`[${t}]`:""};`):(r.push(`uniform sampler2D ${e.name};`),r.push(`uniform int offset${e.name};`)),n.enableShapeUniforms){const{uniformShape:t}=Ree(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:r.push(`uniform int ${e.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${e.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${e.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${e.name}Shape;`)}r.push(`uniform ivec2 ${e.name}TexShape;`)}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((e=>{r.push(`uniform ${e.type} ${e.name}${e.arrayIndex?`[${e.arrayIndex}]`:""};`)}));const s=r.join("\n"),a=e.map((e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,s="";s+=n?wee(e,r):xee(e,r);const a=e.shapeInfo.logicalShape,i=t.logicalShape;a.length<=i.length&&(s+=n?function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",a=e.shapeInfo.logicalShape.length,i=t.logicalShape.length,o=vee(e.shapeInfo.logicalShape,t.logicalShape),l=Aee(i),u=i-a;let c;const d=["x","y","z","w","u","v"];c=0===a?"":i<2&&o.length>=1?"coords = 0;":o.map((e=>`coords.${d[e+u]} = 0;`)).join("\n");let h="";h=i<2&&a>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${d[t+u]}`)).join(", ");let p="return outputValue;";const f=1===mO(e.shapeInfo.logicalShape),m=mO(t.logicalShape),g=1===m;if(1!==a||f||g){if(f&&!g)p=1===i?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(o.length){const e=a-2,t=a-1;o.indexOf(e)>-1&&o.indexOf(t)>-1?p="return vec4(outputValue.x);":o.indexOf(e)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(t)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${s}() {\n      ${l} coords = getOutputCoords();\n      ${c}\n      vec4 outputValue = get${r}(${h});\n      ${p}\n    }\n  `}(e,t):function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",a=t.texShape,i=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&null==e.shapeInfo.flatOffset&&gO(i,a))return`\n      float ${s}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;const u=Aee(l),c=vee(e.shapeInfo.logicalShape,t.logicalShape),d=l-o;let h;const p=["x","y","z","w","u","v"];h=0===o?"":l<2&&c.length>=1?"coords = 0;":c.map((e=>`coords.${p[e+d]} = 0;`)).join("\n");let f="";f=l<2&&o>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${p[t+d]}`)).join(", ");return`\n    float ${s}() {\n      ${u} coords = getOutputCoords();\n      ${h}\n      return get${r}(${f});\n    }\n  `}(e,t));return s}(e,t,n.packedInputs,n.enableShapeUniforms))).join("\n"),i=t.texShape,o=hee(),l=function(e){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${e.texture2D}(textureSampler, uv).r;\n    }\n  `}(o);let u,c,d=function(e){const t=`${e.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${e.varyingFs} vec2 resultUV;\n    ${e.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${e.defineSpecialNaN}\n    ${e.defineSpecialInf}\n    ${e.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${kee}\n    ${See}\n    ${Iee}\n  `;return t}(o);t.isPacked?(u=function(e,t,n){switch(e.length){case 0:return Tee();case 1:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${r[1]}.0);\n      }\n    `;if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${r[0]}.0);\n      }\n    `;if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);\n    }\n  `}(0,t,n);case 2:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(gO(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));\n      }\n    `;const s=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n      int r = 2 * (index / ${s});\n      int c = imod(index, ${s}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],s=Math.ceil(e[2]/2),a=s*Math.ceil(e[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      int b = index / ${a};\n      index -= b * ${a};\n\n      int r = 2 * (index / ${s});\n      int c = imod(index, ${s}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],s=Math.ceil(e[e.length-1]/2),a=s*Math.ceil(e[e.length-2]/2);let i=a,o="",l="b, r, c";for(let u=2;u<e.length-1;u++)i*=e[e.length-u-1],o=`\n      int b${u} = index / ${i};\n      index -= b${u} * ${i};\n    `+o,l=`b${u}, `+l;return`\n    ivec${e.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      ${o}\n\n      int b = index / ${a};\n      index -= b * ${a};\n\n      int r = 2 * (index / ${s});\n      int c = imod(index, ${s}) * 2;\n\n      return ivec${e.length}(${l});\n    }\n  `}(e,t,n)}}(t.logicalShape,i,n.enableShapeUniforms),c=function(e){return`\n    void setOutput(vec4 val) {\n      ${e.output} = val;\n    }\n  `}(o)):(u=function(e,t,n){switch(e.length){case 0:return Tee();case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${t[1]}.0);\n      }\n    `;if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${t[0]}.0);\n      }\n    `;if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      return resTexRC.x * ${t[1]} + resTexRC.y;\n    }\n  `}(0,t,n);case 2:return function(e,t,n){if(gO(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));\n      }\n    `;if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `;if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `;if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      int r = index / ${e[1]};\n      int c = index - r * ${e[1]};\n      return ivec2(r, c);\n    }\n  `}(e,t,n);case 3:return function(e,t,n){if(n){return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${fee(["r","c","d"],e)}\n    return ivec3(r, c, d);\n  }\n`}const r=pee(["r","c","d"],e);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec3(r, c, d);\n    }\n  `}(e,t,n);case 4:return function(e,t,n){if(n){return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${fee(["r","c","d","d2"],e)}\n      return ivec4(r, c, d, d2);\n    }\n  `}const r=pee(["r","c","d","d2"],e);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec4(r, c, d, d2);\n    }\n  `}(e,t,n);case 5:return function(e,t){const n=pee(["r","c","d","d2","d3"],e);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},\n                             ${t[1]}));\n\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(e,t);case 6:return function(e,t){const n=pee(["r","c","d","d2","d3","d4"],e);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}(t.logicalShape,i,n.enableShapeUniforms),c=function(e){return`\n    void setOutput(float val) {\n      ${e.output} = vec4(val, 0, 0, 0);\n    }\n  `}(o)),n.packedInputs&&(d+=Cee);return[d,l,c,s,u,a,n.userCode].join("\n")}function xee(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,a]=e.shapeInfo.texShape;if(1===s&&1===a)return`\n      float ${r}() {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const i=Nee(n);if(t)return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});\n      return sampleTexture(${n}, uv);\n    }\n  `;const[o,l]=e.shapeInfo.texShape;return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${o}, ${l}, ${i});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`\n      float ${r}(int index) {\n        ${Eee(e)}\n      }\n    `;const s=e.shapeInfo.texShape,a=s[0],i=s[1];if(1===i&&1===a)return`\n      float ${r}(int index) {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const o=Nee(n);if(1===i)return t?`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${a}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(1===a)return t?`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${i}.0, 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(t)return`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});\n      return sampleTexture(${n}, uv);\n    }\n  `;return`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${a}, ${i}, index + ${o});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape;if(null!=a&&gO(n,a)){if(t)return`\n      float ${s}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `;const e=a[0];return`\n    float ${s}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${a[1]}.0, ${e}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `}const{newShape:i,keptDims:o}=SO(n),l=i;if(l.length<n.length){const n=["row","col"];return`\n      ${xee(_ee(e,l),t)}\n      float ${s}(int row, int col) {\n        return ${s}(${$ee(n,o)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${s}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));\n        ${Eee(e)}\n      }\n    `;const u=a[0],c=a[1],d=Nee(r);if(1===c)return t?`\n      float ${s}(int row, int col) {\n        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${s}(int row, int col) {\n      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;if(1===u)return t?`\n      float ${s}(int row, int col) {\n        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${s}(int row, int col) {\n      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);\n      return sampleTexture(${r}, uv);\n    }\n  `;if(t)return`\n      float ${s}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r}Shape[1] + col + ${d};\n        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n        return sampleTexture(${r}, uv);\n      }\n    `;return`\n  float ${s}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${n[1]} + col + ${d};\n    vec2 uv = uvFromFlat(${u}, ${c}, index);\n    return sampleTexture(${r}, uv);\n  }\n`}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[1]*n[2],i=n[2],{newShape:o,keptDims:l}=SO(n),u=o;if(u.length<n.length){const n=["row","col","depth"];return`\n        ${xee(_ee(e,u),t)}\n        float ${s}(int row, int col, int depth) {\n          return ${s}(${$ee(n,l)});\n        }\n      `}if(e.shapeInfo.isUniform)return`\n      float ${s}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${a}, ${i}, 1)));\n        ${Eee(e)}\n      }\n    `;const c=e.shapeInfo.texShape,d=c[0],h=c[1],p=e.shapeInfo.flatOffset;if(h===a&&null==p)return t?`\n      float ${s}(int row, int col, int depth) {\n        int stride1 = ${r}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n        float ${s}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${i}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${h}.0, ${d}.0);\n          return sampleTexture(${r}, uv);\n        }\n      `;if(h===i&&null==p)return t?`\n      float ${s}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${s}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const f=Nee(r);if(t)return`\n    float ${s}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${r}Shape[1] * ${r}Shape[2];\n      int stride1 = ${r}Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ${f};\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n      return sampleTexture(${r}, uv);\n    }\n    `;return`\n      float ${s}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${a} + col * ${i} + depth + ${f};\n        vec2 uv = uvFromFlat(${d}, ${h}, index);\n        return sampleTexture(${r}, uv);\n      }\n  `}(e,t);case 4:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[3],i=n[2]*a,o=n[1]*i,{newShape:l,keptDims:u}=SO(n);if(l.length<n.length){const n=["row","col","depth","depth2"];return`\n      ${xee(_ee(e,l),t)}\n      float ${s}(int row, int col, int depth, int depth2) {\n        return ${s}(${$ee(n,u)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${s}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${o}, ${i}, ${a}, 1)));\n        ${Eee(e)}\n      }\n    `;const c=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1],f=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(p===o&&null==c)return t?`\n      float ${s}(int row, int col, int depth, int depth2) {\n        ${f}\n        ${m}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${s}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${i}, ${a}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${h}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(p===a&&null==c)return t?`\n      float ${s}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${s}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${n[1]*n[2]}, ${n[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${h}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const y=Nee(r);if(t)return`\n    float ${s}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${f}\n      ${m}\n      ${g}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});\n      return sampleTexture(${r}, uv);\n    }\n  `;return`\n    float ${s}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${o} + col * ${i} +\n          depth * ${a} + depth2;\n      vec2 uv = uvFromFlat(${h}, ${p}, index + ${y});\n      return sampleTexture(${r}, uv);\n    }\n  `}(e,t);case 5:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t[4],a=t[3]*s,i=t[2]*a,o=t[1]*i,{newShape:l,keptDims:u}=SO(t);if(l.length<t.length){const t=["row","col","depth","depth2","depth3"];return`\n      ${xee(_ee(e,l))}\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        return ${r}(${$ee(t,u)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${o}, ${i}, ${a}, ${s})) +\n          depth3;\n        ${Eee(e)}\n      }\n    `;const c=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1];if(p===o&&null==c)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${i}, ${a}, ${s}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(p===s&&null==c)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]},\n               ${t[2]*t[3]}, ${t[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const f=Nee(n);return`\n    float ${r}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${o} + col * ${i} + depth * ${a} +\n          depth2 * ${s} + depth3 + ${f};\n      vec2 uv = uvFromFlat(${h}, ${p}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(e);case 6:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:a}=SO(t);if(s.length<t.length){const t=["row","col","depth","depth2","depth3","depth4"];return`\n      ${xee(_ee(e,s))}\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${r}(${$ee(t,a)});\n      }\n    `}const i=t[5],o=t[4]*i,l=t[3]*o,u=t[2]*l,c=t[1]*u;if(e.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${c}, ${u}, ${l}, ${o})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${i}, 1)));\n        ${Eee(e)}\n      }\n    `;const d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],f=h[1];if(f===c&&null==d)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${u}, ${l}, ${o}, ${i})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(f===i&&null==d)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]*t[4]},\n               ${t[2]*t[3]*t[4]},\n               ${t[3]*t[4]},\n               ${t[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const m=Nee(n);return`\n    float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${c} + col * ${u} + depth * ${l} +\n          depth2 * ${o} + depth3 * ${i} + depth4 + ${m};\n      vec2 uv = uvFromFlat(${p}, ${f}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function wee(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=hee();return`\n    vec4 ${n}() {\n      return ${r.texture2D}(${t}, halfCR);\n    }\n  `}(e);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e.shapeInfo.texShape,a=hee();if(t)return`\n    vec4 ${r}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${a.texture2D}(${n}, uv);\n    }\n  `;const i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`\n    vec4 ${r}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${i[0]}, ${i[1]}, index);\n      return ${a.texture2D}(${n}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,i=a[0],o=a[1],l=hee();if(null!=a&&gO(n,a))return t?`\n      vec4 ${s}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n\n        return ${l.texture2D}(${r}, uv);\n      }\n    `:`\n      vec4 ${s}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${i}.0);\n\n        return ${l.texture2D}(${r}, uv);\n      }\n    `;if(t)return`\n    vec4 ${s}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `;const u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=Math.ceil(n[1]/2);return`\n    vec4 ${s}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);\n      return ${l.texture2D}(${r}, uv);\n    }\n  `}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===n[0]){const r=[1,2],a=["b","row","col"];return`\n        ${wee(_ee(e,n.slice(1)),t)}\n        vec4 ${s}(int b, int row, int col) {\n          return ${s}(${$ee(a,r)});\n        }\n      `}const o=hee();if(t)return`\n    vec4 ${s}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${o.texture2D}(${r}, uv);\n    }\n  `;const l=i[0],u=i[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`\n    vec4 ${s}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${l}, ${u}, ${d}, ${c}, b, row, col);\n      return ${o.texture2D}(${r}, uv);\n    }\n  `}(e,t);default:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=hee();if(t)return`\n    vec4 ${r}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${n}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);\n    }\n  `;const a=e.shapeInfo.logicalShape,i=a.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=l[0],c=l[1],d=Math.ceil(a[i-1]/2);let h=d*Math.ceil(a[i-2]/2),p="int b, int row, int col",f=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<i-1;m++)p=`int b${m}, `+p,h*=a[i-m-1],f=`b${m} * ${h} + `+f;return`\n    vec4 ${r}(${p}) {\n      int index = ${f};\n      int texR = index / ${c};\n      int texC = index - texR * ${c};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});\n      return ${s.texture2D}(${n}, uv);\n    }\n  `}(e,t)}}const kee="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",See="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Iee="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Cee="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Tee(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function Nee(e){return`offset${e}`}function Eee(e){const t=e.name,n=mO(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${t}[i];\n      }\n    }\n  `}function Aee(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function Ree(e,t,n){const{newShape:r,keptDims:s}=SO(t),a=t.length,i=e&&3===a&&1===t[0],o=i?t.slice(1):r,l=!e&&a>1&&!gO(t,n)&&r.length<a||i;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:s}}function _ee(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function $ee(e,t){return t.map((t=>e[t])).join(", ")}function Oee(e,t,n,r){const s=n.map(((e,n)=>{const r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),a=s.map((e=>e.shapeInfo)),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=bee(s,i,t),l=function(e,t){const n=Q7(e,(()=>e.createShader(e.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(B7(e,(()=>e.shaderSource(n,t))),B7(e,(()=>e.compileShader(n))),HO().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw W7(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,o),u=e.createProgram(l);return HO().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:a,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(u),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:a,outShapeInfo:i},Dee(e,t,u)))}function Dee(e,t,n){const r=[],s=[];let a,i,o,l=null,u=null;u=e.getUniformLocation(n,"NAN",!1),1===HO().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of t.variableNames){const s={name:d,uniform:e.getUniformLocation(n,d,c),offset:e.getUniformLocation(n,`offset${d}`,c)};t.enableShapeUniforms&&(s.shape=e.getUniformLocation(n,`${d}Shape`,c),s.texShape=e.getUniformLocation(n,`${d}TexShape`,c)),r.push(s)}if(t.enableShapeUniforms&&(a=e.getUniformLocation(n,"outShape",c),o=e.getUniformLocation(n,"outShapeStrides",c),i=e.getUniformLocation(n,"outTexShape",c)),t.customUniforms)for(const d of t.customUniforms)s.push(e.getUniformLocation(n,d.name,c));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:u,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:i}}function Mee(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach(((e,n)=>{const r=e.logicalShape,s=t[n],a=s.shape;if(!gO(r,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${a} must match`);if(e.isUniform&&s.isUniform)return;const i=e.texShape,o=s.isUniform?null:s.texData.texShape;if(!gO(i,o))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${i} and ${o} must match`)}))}function Fee(e){return HO().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class Lee{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=R7.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=hee();this.outputShape=e,this.enableShapeUniforms=Fee(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?fee(["r","c","d"],e):pee(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${t.output} = result;\n      }\n    `}}class Pee{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=R7.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=hee();this.outputShape=e,this.enableShapeUniforms=Fee(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?fee(["r","c","d"],e):pee(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${t.output} = result;\n      }\n    `}}class zee{constructor(e){this.variableNames=["A"],this.outTexUsage=$7.DOWNLOAD;const t=hee();this.outputShape=e,this.userCode=`\n      ${yee}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${t.output} = encode_float(x);\n      }\n    `}}class Bee{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=$7.DOWNLOAD;const t=hee();this.outputShape=e,this.userCode=`\n      ${yee}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${t.output} = encode_float(x);\n      }\n    `}}const jee={R:0,G:1,B:2,A:3};class Uee{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=hee();this.outputShape=e,this.enableShapeUniforms=Fee(this.outputShape.length);let s="result";t&&(s="floor(result * 255. + 0.5)");let a="";for(let i=0;i<n.length;i++){const e=n[i];a+=`\n          if(offset == ${i}) {\n            result = values[${jee[e]}];\n          }`}this.userCode=`\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":gee(e)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ${n.length});\n\n        flatIndex = idiv(flatIndex, ${n.length}, 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ${r.texture2D}(A, uv);\n          ${a}\n        }\n        ${r.output} = vec4(${s}, 0., 0., 0.);\n      }\n    `}}class Vee{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=hee();this.outputShape=e,this.enableShapeUniforms=Fee(this.outputShape.length);let r="",s="result";t&&(s="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let t=0;t<=1;t++){const s=2*a+t;r+=`\n          localCoords = coords;\n          if(localCoords[2] + ${t} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {\n          localCoords[2] += ${t};\n          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {\n            localCoords[1] += ${a};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${n.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${s}] = values[0];\n            } else if (offset == 1) {\n              result[${s}] = values[1];\n            } else if (offset == 2) {\n              result[${s}] = values[2];\n            } else {\n              result[${s}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":gee(e)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${r}\n\n          ${n.output} = ${s};\n        }\n    `}}function Wee(e){const t=hee();return function(e,t){const n=Q7(e,(()=>e.createShader(e.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(B7(e,(()=>e.shaderSource(n,t))),B7(e,(()=>e.compileShader(n))),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,`${t.version}\n    precision highp float;\n    ${t.attribute} vec3 clipSpacePos;\n    ${t.attribute} vec2 uv;\n    ${t.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}function Gee(e){return function(e,t){const n=Q7(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return B7(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),B7(e,(()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW))),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Hee(e){return function(e,t){const n=Q7(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return B7(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n))),B7(e,(()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW))),n}(e,new Uint16Array([0,1,2,2,1,3]))}function qee(e,t,n,r,s,a){!function(e,t){const n=HO().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0)throw new Error(`Requested texture size [${e}x${t}] is invalid.`);if(e>n||t>n)throw new Error(`Requested texture size [${e}x${t}] greater than WebGL maximum on this browser / GPU [${n}x${n}].`)}(t,n);const i=function(e){return Q7(e,(()=>e.createTexture()),"Unable to create WebGLTexture.")}(e),o=e.TEXTURE_2D;return B7(e,(()=>e.bindTexture(o,i))),B7(e,(()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE))),B7(e,(()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE))),B7(e,(()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST))),B7(e,(()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST))),1===HO().getNumber("WEBGL_VERSION")?B7(e,(()=>e.texImage2D(o,0,r,t,n,0,s,a,null))):B7(e,(()=>e.texStorage2D(o,1,r,t,n))),B7(e,(()=>e.bindTexture(e.TEXTURE_2D,null))),{texture:i,texShape:[n,t]}}function Kee(e){return e.internalFormatFloat}function Xee(e){return e.internalFormatHalfFloat}function Yee(e){return e.downloadTextureFormat}function Qee(e){return e.internalFormatPackedFloat}function Jee(e){return e.internalFormatPackedHalfFloat}function Zee(e,t,n,r,s,a,i,o){const l=e,u=new Float32Array(function(e,t){const[n,r]=P7(e,t);return n*r*4}(a,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}class ete{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=HO().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,function(e,t){N7[e]=t}(t,e)):this.gl=A7(t),e=this.gl,2===HO().getNumber("WEBGL_VERSION")){const t=e;this.createVertexArray=()=>B7(t,(()=>t.createVertexArray())),this.bindVertexArray=e=>B7(t,(()=>t.bindVertexArray(e))),this.deleteVertexArray=e=>B7(t,(()=>t.deleteVertexArray(e))),this.getVertexArray=()=>B7(t,(()=>t.getParameter(t.VERTEX_ARRAY_BINDING)))}else if(null!=e){const t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>B7(e,(()=>t.createVertexArrayOES())),this.bindVertexArray=n=>B7(e,(()=>t.bindVertexArrayOES(n))),this.deleteVertexArray=n=>B7(e,(()=>t.deleteVertexArrayOES(n))),this.getVertexArray=()=>B7(e,(()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES)))}let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===HO().getNumber("WEBGL_VERSION")){const e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=U7(this.gl,e),iee(this.gl,t))this.textureHalfFloatExtension=U7(this.gl,t);else if(HO().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),iee(this.gl,r))this.colorBufferHalfFloatExtension=U7(this.gl,r);else if(HO().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",iee(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!iee(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=Gee(this.gl),this.indexBuffer=Hee(this.gl),this.framebuffer=function(e){return Q7(e,(()=>e.createFramebuffer()),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=z7(this.gl,this.textureHalfFloatExtension)}get debug(){return HO().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;B7(e,(()=>e.finish())),B7(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,null))),B7(e,(()=>e.deleteFramebuffer(this.framebuffer))),B7(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,null))),B7(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null))),B7(e,(()=>e.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[s,a]=F7(t,n);return qee(e,s,a,Kee(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[s,a]=F7(t,n);return qee(e,s,a,Xee(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[s,a]=F7(t,n);return qee(e,s,a,Yee(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),function(e,t,n){B7(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),n.data instanceof Uint8Array?2===HO().getNumber("WEBGL_VERSION")?B7(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data))):B7(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data))):2===HO().getNumber("WEBGL_VERSION")?B7(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n))):B7(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n))),B7(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,s,a){let i,o,l;B7(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),s instanceof Uint8Array?(i=new Uint8Array(n*r*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(i=new Float32Array(n*r*4),o=e.FLOAT,l=a.internalFormatPackedFloat),i.set(s),2===HO().getNumber("WEBGL_VERSION")?B7(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,o,i))):B7(e,(()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,o,i))),B7(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[s,a]=P7(t,n);return qee(e,s,a,Jee(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[s,a]=P7(t,n);return qee(e,s,a,Qee(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(X7(this.gl,this.framebuffer),this.outputTexture=null),B7(this.gl,(()=>this.gl.deleteTexture(e)))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>function(e,t,n,r){const[s,a]=F7(t,n),i=new Uint8Array(t*n*4);return B7(e,(()=>e.readPixels(0,0,s,a,r.downloadTextureFormat,e.UNSIGNED_BYTE,i))),new Float32Array(i.buffer)}(this.gl,t,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(e,t,n,r,s,a){return Zee(this.gl,e,0,0,0,s,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return function(e,t,n){const r=e,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const r=function(e,t,n){const r=e.createBuffer();B7(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r)));const s=16*t*n;return B7(e,(()=>e.bufferData(e.PIXEL_PACK_BUFFER,s,e.STREAM_READ))),B7(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0))),B7(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null))),r}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(HO().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,s=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const e=r.clientWaitSync(s,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=s}else HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>function(e,t,n){const r=new Float32Array(t*n*4);return B7(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r))),r}(this.gl,t,n)))}createProgram(e){this.throwIfDisposed();const t=this.gl;null==this.vertexShader&&(this.vertexShader=Wee(t));const n=function(e){return Q7(e,(()=>e.createProgram()),"Unable to create WebGLProgram.")}(t);B7(t,(()=>t.attachShader(n,this.vertexShader))),B7(t,(()=>t.attachShader(n,e))),function(e,t){if(B7(e,(()=>e.linkProgram(t))),!HO().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&G7(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;B7(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer))),function(e,t,n){B7(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),H7(e,t,"clipSpacePos",n,3,20,0)&&H7(e,t,"uv",n,2,20,12)}(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(B7(this.gl,(()=>this.gl.deleteProgram(e))),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&G7(this.gl,this.program),B7(this.gl,(()=>this.gl.useProgram(e)))}getUniformLocation(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return Q7(e,(()=>e.getUniformLocation(t,n)),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),B7(this.gl,(()=>this.gl.getAttribLocation(e,t)))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),q7(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[r,s]=P7(t,n);this.setOutputMatrixTextureDriver(e,r,s)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&G7(this.gl,this.program),Y7(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}B7(e,(()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),B7(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=U7(this.gl,2===HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await xO((()=>this.disposed||this.isQueryAvailable(e,HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(e,HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){const t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{const t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){const t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){const e=function(e){let t=0;for(;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in HO().platform&&(n=HO().platform.setTimeoutCustom.bind(HO().platform)),xO((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),K7(this.gl,e,this.framebuffer),this.debug&&Y7(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(K7(this.gl,this.outputTexture,this.framebuffer),this.debug&&Y7(this.gl)):X7(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const r=this.gl;K7(r,e,this.framebuffer),this.debug&&Y7(r),this.outputTexture=e,B7(r,(()=>r.viewport(0,0,t,n))),B7(r,(()=>r.scissor(0,0,t,n)))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),B7(this.gl,(()=>this.gl.scissor(e,t,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{mx:tte,XI:nte,Nk:rte,f6:ste,ct:ate,YG:ite,hH:ote,z3:lte,sG:ute,uM:cte,vS:dte,qB:hte,GG:pte,rq:fte,lg:mte,WR:gte,cu:yte,GE:vte,px:bte,jC:xte,He:wte,hE:kte,BF:Ste,Dk:Ite,cl:Cte,_B:Tte,ub:Nte,_f:Ete,Ku:Ate,qy:Rte,Zy:_te,bu:$te,zv:Ote,dH:Dte,HS:Mte,yH:Fte,l3:Lte,z9:Pte,x6:zte,_m:Bte,eW:jte,GK:Ute,SP:Vte,yr:Wte,dl:Gte,Dw:Hte,xT:qte,_X:Kte,wz:Xte}=T;function Yte(e,t){return["x","y","z","w","u","v"].slice(0,t).map((t=>`${e}.${t}`))}function Qte(e,t){return 1===t?[e]:Yte(e,t)}class Jte{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Fee(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=Qte("rc",this.rank),t=Aee(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),s=this.getOutput(e);this.userCode=`\n        void main() {\n          ${t} rc = getOutputCoords();\n\n          if(${n}) {\n            setOutput(vec4(0));\n          } else {\n            ${r}\n\n            setOutput(vec4(${s}));\n          }\n        }\n      `}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let s=`${0===n?"r":"rp1"}, ${0===r?"c":"cp1"}`;for(let t=2;t<this.rank;t++)s=`${e[e.length-1-t]},`+s;t.push(s)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";const t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`\n      int r = ${t[0]};\n      int c = ${t[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${n};\n      bool rEdge = rp1 >= ${r};\n    `}getOutput(e){const t=this.getSourceCoordsArr(e);if(1===this.rank){return`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`}return`getA(${t[0]}),\n            cEdge ? 0. : getA(${t[1]}),\n            rEdge ? 0. : getA(${t[2]}),\n            rEdge || cEdge ? 0. : getA(${t[3]})`}}class Zte{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Fee(this.outputShape.length);let n="";for(let a=0;a<4;a++){let e="thisRC = rc;";a%2===1&&(e+="thisRC.z += 1;"),a>1&&(e+="thisRC.y += 1;"),n+=`\n        ${e}\n        ${a>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${a}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${a>0?"}":""}\n      `}var r,s;this.userCode=`\n      ${r=t,s=this.enableShapeUniforms,`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${s?mee(["r","c","d"],"inputShape"):pee(["r","c","d"],r)}\n      return ivec3(r, c, d);\n    }\n  `}\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":gee(e)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}}class ene{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){const r=nne(t,n),s=rne(e,r,n);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const a=tne(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const e=this.freeTextures[s].pop();return this.usedTextures[s].push(e),e}let i;return r===D7.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===D7.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===D7.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===D7.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===D7.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[s].push(i),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),i}releaseTexture(e,t,n,r){if(null==this.freeTextures)return;const s=nne(n,r),a=rne(t,s,r);a in this.freeTextures||(this.freeTextures[a]=[]);const i=tne(t,s,this.gpgpu.gl,this.gpgpu.textureConfig,r),o=HO().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==o&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;const l=this.usedTextures[a],u=l&&l.indexOf(e);if(null==u||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[u]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const e in this.freeTextures)this.freeTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));for(const e in this.usedTextures)this.usedTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function tne(e,t,n,r,s){const a=function(e,t){switch(e){case D7.PACKED_2X2_FLOAT32:return Qee(t);case D7.PACKED_2X2_FLOAT16:return Jee(t);case D7.UNPACKED_FLOAT32:return Kee(t);case D7.UNPACKED_FLOAT16:return Xee(t);case D7.PACKED_4X1_UNSIGNED_BYTE:return Yee(t);default:throw new Error(`Unknown physical texture type ${e}`)}}(t,r);let i;if(s){const[t,n]=P7(e[0],e[1]);i=t*n}else{const[t,n]=F7(e[0],e[1]);i=t*n}const o=function(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}(n,a);return i*o}function nne(e,t){if(e===$7.UPLOAD)return D7.PACKED_2X2_FLOAT32;if(e===$7.RENDER||null==e)return function(e){return HO().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?D7.PACKED_2X2_FLOAT32:D7.UNPACKED_FLOAT32:e?D7.PACKED_2X2_FLOAT16:D7.UNPACKED_FLOAT16}(t);if(e===$7.DOWNLOAD||e===$7.PIXELS)return D7.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function rne(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}class sne{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Fee(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${t}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const ane="if (isnan(x)) return x;",ine="return abs(x);";const one=ane+"\n  return (x < 0.0) ? 0.0 : x;\n",lne=ane+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",une="return x;";class cne{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Fee(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${t}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class dne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Fee(this.outputShape.length);const t=e.length,n=Qte("rc",t),r=Aee(t),s=function(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),a=n.slice(-2),i=t<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`\n      void main() {\n        ${r} rc = getOutputCoords();\n        vec4 packedInput = getA(${s});\n\n        setOutput(getChannel(packedInput, ${i}));\n      }\n    `}}const hne=mG,pne={};const fne=HO().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class mne extends iO{nextDataId(){return mne.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!HO().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof ete)t=e;else{const n=A7(HO().getNumber("WEBGL_VERSION"),e);t=new ete(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const e=A7(HO().getNumber("WEBGL_VERSION"));t=new ete(e),this.binaryCache=((n=HO().getNumber("WEBGL_VERSION"))in pne||(pne[n]={}),pne[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new ene(this.gpgpu),this.numMBBeforeWarning=null==HO().global.screen?1024:HO().global.screen.height*HO().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new aO(this,UP())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,s,a){const i=this.makeTensorInfo(t,n),o=this.texData.get(i.dataId);o.isPacked=!1,o.texture={texture:e,texShape:[r,s]},o.texShape=[r,s];const l=tee(t),u=new Uee(l,!1,a),c=this.runWebGLProgram(u,[i],n,[[r,s]]);return c.shape=t,o.texture=null,this.disposeIntermediateTensorInfo(i),c.dataId}write(e,t,n){if((HO().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||HO().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:$7.UPLOAD,refCount:1}),r}refCount(e){if(this.texData.has(e)){return this.texData.get(e).refCount}return 0}incRef(e){this.texData.get(e).refCount++}decRef(e){if(this.texData.has(e)){this.texData.get(e).refCount--}}move(e,t,n,r,s){if(HO().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:$7.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:s,slice:a,shape:i,isPacked:o}=t;if(null!=a){let t;t=o?new cne(i,une):new sne(i,une);const n=this.runWebGLProgram(t,[{dataId:e,shape:i,dtype:r}],r),s=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),s}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;const l=null!=this.activeTimers;let u,c;if(l&&(u=ML()),"complex64"===r){c=lq(this.readSync(s.real.dataId),this.readSync(s.imag.dataId))}else c=this.getValuesFromTexture(e);return l&&(this.downloadWaitMs+=ML()-u),this.convertAndCacheOnCPU(e,c)}async read(e){if(this.pendingRead.has(e)){const t=this.pendingRead.get(e);return new Promise((e=>t.push(e)))}const t=this.texData.get(e),{values:n,shape:r,slice:s,dtype:a,complexTensorInfos:i,isPacked:o}=t;if(null!=s){let t;t=o?new cne(r,une):new sne(r,une);const n=this.runWebGLProgram(t,[{dataId:e,shape:r,dtype:a}],a),s=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),s}if(null!=n)return this.convertAndCacheOnCPU(e);if(HO().getBool("DEBUG")&&!HO().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===HO().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,u,c=null;if("complex64"!==a&&HO().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(e);const t=this.texData.get(l.dataId);c=this.gpgpu.createBufferFromTexture(t.texture.texture,...L7(r))}if(this.pendingRead.set(e,[]),"complex64"!==a&&await this.gpgpu.createAndWaitForFence(),"complex64"===a){const e=await Promise.all([this.read(i.real.dataId),this.read(i.imag.dataId)]);u=lq(e[0],e[1])}else if(null==c)u=this.getValuesFromTexture(e);else{const e=mO(r);u=this.gpgpu.downloadFloat32MatrixFromBuffer(c,e)}if(null!=l&&this.disposeIntermediateTensorInfo(l),null!=c){const e=this.gpgpu.gl;B7(e,(()=>e.deleteBuffer(c)))}const d=this.convertAndCacheOnCPU(e,u),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach((e=>e(d))),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&UP().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(e),{values:r,shape:s,slice:a,dtype:i,isPacked:o,texture:l}=n;if("complex64"===i)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=a){let n;n=o?new cne(s,une):new sne(s,une);const r=this.runWebGLProgram(n,[{dataId:e,shape:s,dtype:i}],i),a=this.readToGPU(r,t);return this.disposeIntermediateTensorInfo(r),a}if(null==l)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,t.customTexShape),c=UP().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:c},d.texture)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>LL(e)));return Qz(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Qz(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){const n=e[t];if(!j7(n)){if(HO().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:r}=this.texData.get(e),s=mO(t);if(HO().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(e),r=this.texData.get(n.dataId),a=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...L7(t)).subarray(0,s);return this.disposeIntermediateTensorInfo(n),a}const a=HO().getBool("WEBGL_PACK")&&!0===r,i=a?tee(t):t,o=a?new Bee(i):new zee(i),l=this.runWebGLProgram(o,[{shape:i,dtype:n,dataId:e}],"float32"),u=this.texData.get(l.dataId),c=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(l),c}timerAvailable(){return HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();const s=zL(this.activeTimers.map((e=>e.query))).filter((e=>null!=e)),a=zL(this.activeTimers.map((e=>e.name))).filter((e=>null!=e));this.activeTimers=t,r&&(this.programTimersStack=null);const i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const e=await Promise.all(s);i.kernelMs=function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}(e),i.getExtraProfileInfo=()=>e.map(((e,t)=>({name:a[t],ms:e}))).map((e=>`${e.name}: ${e.ms}`)).join(", ")}else i.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,i})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ML(),endMs:null}}endTimer(e){return HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=ML(),e)}async getQueryTime(e){if(HO().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:r,usage:s,isPacked:a,slice:i}=this.texData.get(e),o=i&&i.origDataId||e,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),null!=t&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,s,a)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fne;return HO().getBool("WEBGL_CPU_FORWARD")&&e.every((e=>null==this.texData.get(e.dataId).texture&&mO(e.shape)<t))}getGPGPUContext(){return this.gpgpu}where(e){lL("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return hne(e.shape,t)}packedUnaryOp(e,t,n){const r=new cne(e.shape,t),s=this.compileAndRun(r,[e],n);return UP().makeTensorFromTensorInfo(s)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const t=Dte(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(HO().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ine,e.dtype);const t=new sne(e.shape,ine),n=this.compileAndRun(t,[e]);return UP().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&EO(n[0])){const s=n.map((e=>FL(e)));r=this.write(s,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return UP().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new dne(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new Jte(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[Z7(e.shape),...eee(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},s=[Z7(t),...eee(t)],a=new Zte(s,n),i=[n],o=this.runWebGLProgram(a,[r],e.dtype,i,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:r,shape:s,dtype:a}=n;if(null!=t){hO(mO(s)<=t[0]*t[1]*4,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."))}const i=tee(s);let o;o=r?new Pee(i):new Lee(i);const l=[null!=t?t:L7(i)];return{dtype:a,shape:s,dataId:this.runWebGLProgram(o,[{shape:i,dtype:a,dataId:e}],a,l,!0,t).dataId}}runWebGLProgram(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5?arguments[5]:void 0;const i=this.makeTensorInfo(e.outputShape,n),o=this.texData.get(i.dataId);if(e.packedOutput&&(o.isPacked=!0),e.outPackingScheme===R7.DENSE){const t=null!=a?a:L7(e.outputShape);o.texShape=t.map((e=>2*e))}if(null!=e.outTexUsage&&(o.usage=e.outTexUsage),0===mO(i.shape))return o.values=IO(i.dtype,0),i;const l=[],u=t.map((t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&mO(t.shape)<=HO().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),l.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!ree(n.shape,t.shape)){const e=t,r=t.shape;t.shape=n.shape,t=this.packedReshape(t,r),l.push(t),n=this.texData.get(t.dataId),e.shape=r}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(i.dataId);const c={shape:i.shape,texData:o,isUniform:!1},d=function(e,t,n){let r="";t.concat(n).forEach((t=>{const s=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){const a=t.texData.texShape,{useSqueezeShape:i,uniformShape:o,keptDims:l}=Ree(e.packedInputs,t.shape,a);let u="",c="",d="";if(1===o.length&&e.packedInputs){const e=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];u=`${e[0]>1}_${e[1]>1}`}else if(2!==o.length||e.packedInputs){if(o.length>2&&!e.packedInputs){const e=OO(o);d=`${e[0]===a[1]}_${e[e.length-1]===a[1]}`}}else c=`${o[0]>1}_${o[1]>1}`;const h=t.shape.length,p=2===o.length&&gO(t.shape,a),f=1===mO(t.shape),m=SB(t.shape,n.shape),g=!e.packedInputs&&h===n.shape.length&&gO(a,n.texData.texShape),y=e.packedInputs||o.length>2?"":`${a[0]>1}_${a[1]>1}`;r+=`${h}_${g}_${i?l:""}_${o.length}_${f}_${m}_${p}_${u}_${c}_${d}_${y}_${s}`}else{const e=t.isUniform?"uniform":t.texData.texShape;r+=`${t.shape}_${e}_${s}`}}));const s=e.userCode;let a=e.constructor.name;return a+="_"+r+"_"+s+`${HO().getNumber("WEBGL_VERSION")}`,a}(e,u,c),h=this.getAndSaveBinary(d,(()=>Oee(this.gpgpu,e,u,c))),p=null!=this.activeTimers;let f;p&&(f=this.startTimer()),HO().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,s){t.program.enableShapeUniforms||(Mee(t.inShapeInfos,n),Mee([t.outShapeInfo],[r]));const a=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(a.texture,i[0],i[1]):e.setOutputMatrixTexture(a.texture,i[0],i[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===HO().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){const r=n[l],{uniform:s,offset:a,shape:i,texShape:o}=t.variablesLocations[l];if(i){const{uniformShape:n}=Ree(t.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(i,new Int32Array(n));break;case 2:e.gl.uniform2iv(i,new Int32Array(n));break;case 3:e.gl.uniform3iv(i,new Int32Array(n));break;case 4:e.gl.uniform4iv(i,new Int32Array(n))}}if(o&&e.gl.uniform2i(o,r.texData.texShape[0],r.texData.texShape[1]),null!=s)if(r.isUniform)if(mO(r.shape)<2)e.gl.uniform1f(s,r.uniformValues[0]);else{let t=r.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(s,t)}else null!=r.texData.slice&&null!=a&&e.gl.uniform1i(a,r.texData.slice.flatOffset),e.setInputMatrixTexture(r.texData.texture.texture,s,l)}const o=t.outShapeLocation;if(o)switch(r.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(r.shape))}if(t.outShapeStridesLocation){const n=OO(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&s)for(let l=0;l<t.program.customUniforms.length;++l){const n=t.program.customUniforms[l],r=t.customUniformLocations[l],a=s[l];if("float"===n.type)e.gl.uniform1fv(r,a);else if("vec2"===n.type)e.gl.uniform2fv(r,a);else if("vec3"===n.type)e.gl.uniform3fv(r,a);else if("vec4"===n.type)e.gl.uniform4fv(r,a);else if("int"===n.type)e.gl.uniform1iv(r,a);else if("ivec2"===n.type)e.gl.uniform2iv(r,a);else if("ivec3"===n.type)e.gl.uniform3iv(r,a);else{if("ivec4"!==n.type)throw Error(`uniform type ${n.type} is not supported yet.`);e.gl.uniform4iv(r,a)}}e.executeProgram()}(this.gpgpu,h,u,c,r),l.forEach((e=>this.disposeIntermediateTensorInfo(e))),p&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));const m=HO().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const e=ML();e-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!HO().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&!1===s){const e=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),e}return i}compileAndRun(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;return this.runWebGLProgram(e,t,n,r,s)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!HO().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach((e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}))}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=WP((()=>{if(!HO().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=HO().getBool("DEBUG");HO().set("DEBUG",!1);const t=this.abs(uB(1e-8)).dataSync()[0];if(HO().set("DEBUG",e),t>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:r,values:s,texture:a,usage:i,isPacked:o}=t;if(null!=a)return;const l=null!=this.activeTimers;let u;l&&(u=ML());let c=t.texShape;if(null==c&&(c=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=HO().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=HO().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&HO().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map(((t,n)=>n>=e.length-2?cO(e[n]):e[n]))).length&&(e=[2,e[0]])),2!==e.length){const t=SO(e);e=t.newShape}let s=mO(e),a=null;e.length<=1&&s<=n?a=[1,s]:2===e.length&&e[0]<=n&&e[1]<=n?a=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?a=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?a=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?a=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(a=[e[0],e[1]*e[2]*e[3]]);const i=null!=a&&Math.max(...a)>r&&Math.min(...a)<=(t?2:1)&&Math.min(...a)>0;if(null==a||i)if(t){const t=Z7(e);let n=2,r=2;e.length&&([n,r]=eee(e)),s=t*(n/2)*(r/2),a=vO(s).map((e=>2*e))}else a=vO(s);return a}(n,o),t.texShape=c),null!=s){const e=tee(n);let a,i=c[1],d=c[0];const h=s instanceof Uint8Array||s instanceof Uint8ClampedArray;!o&&h||([i,d]=P7(c[0],c[1])),a=o?new Vee(e,h):new Uee(e,h);const p=h?[d,i]:c,f=this.makeTensorInfo(p,r),m=this.texData.get(f.dataId);m.usage=h?$7.PIXELS:$7.UPLOAD,m.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),i,d,s);const g=[[d,i]],y=!0,v=this.runWebGLProgram(a,[f],r,g,y),b=this.texData.get(v.dataId);t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,HO().get("ENGINE_COMPILE_ONLY")?this.disposeData(v.dataId):(t.texture=b.texture,t.values=null,this.texData.delete(v.dataId)),this.disposeIntermediateTensorInfo(f),l&&(this.uploadWaitMs+=ML()-u)}else{const e=this.acquireTexture(c,i,r,o);t.texture=e}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:r}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){const n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error(`Unknown dtype ${t}`)}(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${e} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*NO(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise((e=>{try{this.checkCompletion_(t),e(!0)}catch(n){throw n}}));e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await FH(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw W7(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:s,outShapeLocation:a,outShapeStridesLocation:i,outTexShapeLocation:o}=Dee(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=s,e.outShapeLocation=a,e.outShapeStridesLocation=i,e.outTexShapeLocation=o}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";const{texture:r,height:s,width:a,channels:i}=e,o=UP().backend;if(!o.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=o.writeTexture(r,t,n,s,a,i);return UP().makeTensorFromDataId(l,t,n,o)}}mne.nextDataId=0;EP()&&qP("webgl",(()=>new mne),2);const gne="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class yne{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=CB(t,n),this.enableShapeUniforms=Fee(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${e}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}const vne="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class bne{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=CB(t,n);const s=this.outputShape.length;this.enableShapeUniforms=Fee(s);let a="";if(r)if(0===s||1===mO(this.outputShape))a="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{if(a=`\n          ${Aee(s)} coords = getOutputCoords();\n        `,1===s)this.enableShapeUniforms?a+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":a+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const e=Qte("coords",s);this.enableShapeUniforms?a+=`\n            bool nextRowOutOfBounds =\n              (${e[s-2]} + 1) >= outShape[${s} - 2];\n            bool nextColOutOfBounds =\n              (${e[s-1]} + 1) >= outShape[${s} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:a+=`\n            bool nextRowOutOfBounds =\n              (${e[s-2]} + 1) >= ${this.outputShape[s-2]};\n            bool nextColOutOfBounds =\n              (${e[s-1]} + 1) >= ${this.outputShape[s-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${e}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${a}\n\n        setOutput(result);\n      }\n    `}}function xne(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const wne={kernelName:hM,backendName:"webgl",kernelFunc:xne};function kne(e){const{inputs:t,backend:n}=e,{real:r,imag:s}=t,a=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(a.dataId),o=xne({inputs:{x:r},backend:n}),l=xne({inputs:{x:s},backend:n});return i.complexTensorInfos={real:o,imag:l},a}const Sne={kernelName:SD,backendName:"webgl",kernelFunc:kne},Ine="return (a < 0.) ? b * a : a;",Cne="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const Tne={kernelName:vM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{alpha:a}=r,i=n.makeTensorInfo([],"float32",OL(a,"float32")),o=HO().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bne(Cne,s.shape,i.shape):new yne(Ine,s.shape,i.shape),l=n.runWebGLProgram(o,[s,i],"float32");return n.disposeIntermediateTensorInfo(i),l}},Nne="return (a < 0.) ? b * a : a;",Ene="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const Ane={kernelName:ZM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r,alpha:s}=t,a=HO().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bne(Ene,r.shape,s.shape):new yne(Nne,r.shape,s.shape);return n.runWebGLProgram(a,[r,s],"float32")}},Rne="if (isnan(x)) return x;";function _ne(e){let{opSnippet:t,packedOpSnippet:n,cpuKernelImpl:r,dtype:s}=e;return e=>{let{inputs:a,backend:i}=e;const{x:o}=a,l=i,u=s||o.dtype;if(l.shouldExecuteOnCPU([o])&&null!=r){const e=l.texData.get(o.dataId),t=r(e.values,u);return l.makeTensorInfo(o.shape,u,t)}let c;return c=HO().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new cne(o.shape,n):new sne(o.shape,t),l.runWebGLProgram(c,[o],u)}}function $ne(e){let{opSnippet:t,packedOpSnippet:n,checkOutOfBounds:r=!1,supportsComplex:s=!1,cpuKernelImpl:a,dtype:i}=e;return e=>{let{inputs:o,backend:l}=e;const{a:u,b:c}=o,d=l;if(s&&"complex64"===u.dtype){const e=d.texData.get(u.dataId),n=d.texData.get(c.dataId),[r,s]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((e=>{const[n,r]=e,s={dataId:n.dataId,dtype:n.dtype,shape:u.shape},a={dataId:r.dataId,dtype:r.dtype,shape:c.shape},i=new yne(t,u.shape,c.shape);return d.runWebGLProgram(i,[s,a],hP(n.dtype,r.dtype))})),a=kne({inputs:{real:r,imag:s},backend:d});return d.disposeIntermediateTensorInfo(r),d.disposeIntermediateTensorInfo(s),a}const h=i||hP(u.dtype,c.dtype);if(("string"===u.dtype||"string"===c.dtype||d.shouldExecuteOnCPU([u,c]))&&null!=a){const e=d.texData.get(u.dataId).values,t=d.texData.get(c.dataId).values,n="string"===u.dtype?Uq(e):e,r="string"===u.dtype?Uq(t):t,[s,i]=a(u.shape,c.shape,n,r,h),o=d.makeTensorInfo(i,h);return d.texData.get(o.dataId).values=s,o}let p;return p=HO().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new bne(n,u.shape,c.shape,r):new yne(t,u.shape,c.shape),d.runWebGLProgram(p,[u,c],h)}}function One(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":one;if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":lne;if("prelu"===e)return t?Ene:Nne;if("leakyrelu"===e)return t?Cne:Ine;if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}class Dne{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=Fee(this.outputShape.length);const u=r?e[1]:e[2],c=Math.ceil(u/2),d=r?"i * 2, rc.y":"rc.y, i * 2",h=s?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",g="";i&&(m=o?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${i}\n        }`:l?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${i}\n        }`:`vec4 activation(vec4 x) {\n          ${i}\n        }`,g="result = activation(result);");const y=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";e[0]<t[0]?v=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(b=`imod(rc.x, ${t[0]})`),this.userCode=`\n      ${m}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${c}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ${v};\n        int batchB = ${b};\n        for (int i = 0; i < ${c}; i++) {\n          vec4 a = getMatrixA(batchA, ${d});\n          vec4 b = getMatrixB(batchB, ${h});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${p[0]} * ${f[0]});\n          result += (${p[1]} * ${f[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${y}\n\n        ${g}\n\n        setOutput(result);\n      }\n    `}}const Mne="return areal * breal - aimag * bimag;",Fne="return areal * bimag + aimag * breal;";class Lne{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=CB(t,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${e}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const Pne="return a * b;";function zne(e){const{inputs:t,backend:n}=e,{a:r,b:s}=t,a=hP(r.dtype,s.dtype);if("complex64"===r.dtype){const e=n.texData.get(r.dataId),t=n.texData.get(s.dataId),a=new Lne(Mne,r.shape,s.shape),i=new Lne(Fne,r.shape,s.shape),o=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:s.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:s.shape}],l=n.runWebGLProgram(a,o,"float32"),u=n.runWebGLProgram(i,o,"float32"),c=kne({inputs:{real:l,imag:u},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),c}if(n.shouldExecuteOnCPU([r,s])){const e=n.texData.get(r.dataId),t=n.texData.get(s.dataId),[i,o]=Ste(r.shape,s.shape,e.values,t.values,a),l=n.makeTensorInfo(o,a);return n.texData.get(l.dataId).values=i,l}let i;return i=HO().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bne(Pne,r.shape,s.shape):new yne(Pne,r.shape,s.shape),n.runWebGLProgram(i,[r,s],a)}const Bne={kernelName:UM,backendName:"webgl",kernelFunc:zne};function jne(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{shape:a}=r,i=n,o=mO(s.shape),l=wO(a,o),u=mO(l);hO(o===u,(()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`));const c=i.texData.get(s.dataId);return!c.isPacked||ree(s.shape,l)||null!==c.texture&&ree(c.shape,l)?(i.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype}):function(e,t,n){const r=[Z7(e.shape),...eee(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},a=[Z7(t),...eee(t)],i=new Zte(a,r),o=[r],l=n.runWebGLProgram(i,[s],e.dtype,o,!0);return{dataId:l.dataId,shape:t,dtype:l.dtype}}(s,l,i)}const Une={kernelName:lF,backendName:"webgl",kernelFunc:jne};class Vne{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:s,outSize:a}=e;this.outputShape=[r,a];const i=4*Math.floor(n/4),o=n%4;let l="sumValue += dot(values, ones);";if(null!=t){const e=1/t;l=`sumValue += dot(values * ${yO(e)?e.toPrecision(2):e}, ones);`}let u="";s%n>0&&(u=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${u}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${i}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${l}\n        }\n\n        int inIdx = inOffset + ${i};\n        if (${1===o}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${l}\n        } else if (${2===o}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${l}\n        } else if (${3===o}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${l}\n        }\n        setOutput(sumValue);\n      }\n    `}}class Wne{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:s,outSize:a}=e;this.outputShape=[r,a];let i="0.0",o="";"prod"===t?i="1.0":"min"===t?(i="1.0 / 1e-20",o="min"):"max"===t&&(i="-1.0 / 1e-20",o="max");let l=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");const u=4*Math.floor(n/4),c=n%4;let d=`\n      if (${"sum"===t}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===t}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${o}(values, minMaxValue);\n        if (${"min"===t} || ${"max"===t}) {\n          minMaxValue = ${o}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,h="vec4";"all"===t?(i="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(i="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");let p="";s%n>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${i};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${p}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${i});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${d}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===c}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${d}\n        } else if (${2===c}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${d}\n        } else if (${3===c}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${d}\n        }\n        setOutput(${l});\n      }\n    `}}function Gne(e,t,n,r){const s=function(e){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const n=t.length?t[t.length-1].outSize:e[1],r=HH(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape);let a=e;for(let i=0;i<s.length;i++){const{inSize:o,windowSize:l,outSize:u}=s[i];let c,d;c="mean"===n?0===i?new Vne({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u},o):new Vne({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u}):new Wne({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:u},n),d=a,a=r.runWebGLProgram(c,[a],t),d.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(d)}return a}class Hne{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];this.outputShape=n,this.rank=n.length;const r=Aee(this.rank),s=function(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let s=0;s<e.length;s++)r[e[s]]=n[s];return r.join()}(t);this.userCode=`\n    void main() {\n      ${r} resRC = getOutputCoords();\n      setOutput(getA(${s}));\n    }\n    `}}class qne{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let u=0;u<n.length;u++)n[u]=e[t[u]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=Aee(this.rank),s=Yte("rc",this.rank),a=new Array(this.rank);for(let u=0;u<t.length;u++)a[t[u]]=s[u];const i=`vec2(${a.slice(-2).join()})`,o=`++${s[this.rank-1]} < ${n[this.rank-1]}`,l=`getChannel(getA(${a.join()}), ${i})`;this.userCode=`\n    void main() {\n      ${r} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${l};\n      if(${o}) {\n        result[1] = ${l};\n      }\n      --${s[this.rank-1]};\n      if(++${s[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${l};\n        if(${o}) {\n          result[3] = ${l};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function Kne(e,t,n){const r=HO().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new qne(e.shape,t):new Hne(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function Xne(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r;return function(e,t,n,r){const s=t,a=e.shape.length,i=kO(s,e.shape);let o=i;const l=qU(o,a),u=null!=l;let c=e;u&&(c=Kne(e,l,r),o=XU(o.length,a)),HU("sum",o,a);const[d,h]=WU(c.shape,o);let p=d;n&&(p=GU(d,i));const f=mO(h),m=jne({inputs:{x:c},attrs:{shape:[mO(e.shape)/f,f]},backend:r}),g=Gne(m,pP(e.dtype),"sum",r),y=jne({inputs:{x:g},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),u&&r.disposeIntermediateTensorInfo(c),y}(s,a,i,n)}const Yne={kernelName:AF,backendName:"webgl",kernelFunc:Xne};function Qne(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{perm:a}=r,i=n,o=s.shape.length,l=new Array(o);for(let c=0;c<l.length;c++)l[c]=s.shape[a[c]];let u;if(i.shouldExecuteOnCPU([s])){const e=i.texData.get(s.dataId).values,t=Kte(e,s.shape,s.dtype,a,l);u=i.makeTensorInfo(l,s.dtype);i.texData.get(u.dataId).values=t}else u=Kne(s,a,i);return u}const Jne={kernelName:QF,backendName:"webgl",kernelFunc:Qne};function Zne(e){let{a:t,b:n,transposeA:r,transposeB:s,backend:a,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:u=null}=e;const c=t.shape.length,d=n.shape.length,h=r?t.shape[c-2]:t.shape[c-1],p=s?n.shape[d-1]:n.shape[d-2],f=r?t.shape[c-1]:t.shape[c-2],m=s?n.shape[d-2]:n.shape[d-1],g=t.shape.slice(0,-2),y=n.shape.slice(0,-2),v=mO(g),b=mO(y),x=CB(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,m]);hO(h===p,(()=>`Error in matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${t.shape} and ${n.shape} and transposeA=${r} and transposeB=${s} must match.`));const w=r?[v,h,f]:[v,f,h],k=s?[b,m,p]:[b,p,m],S=jne({inputs:{x:t},backend:a,attrs:{shape:w}}),I=jne({inputs:{x:n},backend:a,attrs:{shape:k}}),C=[S,I],T=Math.max(v,b),N=r?S.shape[1]:S.shape[2],E=null!=i,A=null!=o,R="leakyrelu"===u,_=null!=u?One(u,!0):null;let $;if((1===f||1===m)&&N>1e3&&!1===(E||A||R||null!=_)){let e=S,t=I;r&&(e=Qne({inputs:{x:S},backend:a,attrs:{perm:[0,2,1]}}),C.push(e)),s&&(t=Qne({inputs:{x:I},backend:a,attrs:{perm:[0,2,1]}}),C.push(t));const n=1===m;let i=e;1!==m&&(i=jne({inputs:{x:e},backend:a,attrs:{shape:[T,N,1]}}),C.push(i));const o=1===m?2:1;let l=t;n&&(l=jne({inputs:{x:t},backend:a,attrs:{shape:[T,1,N]}}),C.push(l));const u=zne({inputs:{a:i,b:l},backend:a});$=Xne({inputs:{x:u},backend:a,attrs:{axis:o,keepDims:!0}}),C.push(u)}else{const e=hP(t.dtype,n.dtype),u=new Dne(w,k,[T,f,m],r,s,E,_,A,R),c=[S,I];if(null!=i&&c.push(i),A&&c.push(o),R){const e=a.makeTensorInfo([],"float32",OL(l,"float32"));c.push(e),C.push(e)}$=a.runWebGLProgram(u,c,e)}const O=jne({inputs:{x:$},backend:a,attrs:{shape:x}});C.push($);for(const D of C)a.disposeIntermediateTensorInfo(D);return O}const ere={kernelName:aL,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:s,b:a,bias:i,preluActivationWeights:o}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return Zne({a:s,b:a,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:o,leakyreluAlpha:d,activation:c})}},tre="return abs(x);";const nre={kernelName:QO,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const e=n.texData.get(r.dataId),t=Dte(e.values);return n.makeTensorInfo(r.shape,r.dtype,t)}let s;return s=HO().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new cne(r.shape,tre):new sne(r.shape,tre),n.runWebGLProgram(s,[r],r.dtype)}},rre=_ne({opSnippet:ane+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),sre={kernelName:JO,backendName:"webgl",kernelFunc:rre},are=_ne({opSnippet:ane+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),ire={kernelName:ZO,backendName:"webgl",kernelFunc:are},ore="return a + b;",lre=$ne({opSnippet:ore,packedOpSnippet:ore,supportsComplex:!0,cpuKernelImpl:tte}),ure={kernelName:eD,backendName:"webgl",kernelFunc:lre};class cre{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(((e,t)=>`T${t}`));const n=[];this.variableNames.forEach((e=>{n.push(`float v${e} = get${e}AtOutCoords();`)}));const r=this.variableNames.map((e=>`v${e}`)).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        float result = ${r};\n        setOutput(result);\n      }\n    `}}class dre{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(((e,t)=>`T${t}`));const n=[];this.variableNames.forEach((e=>{n.push(`vec4 v${e} = get${e}AtOutCoords();`)}));const r=this.variableNames.map((e=>`v${e}`)).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        vec4 result = ${r};\n        setOutput(result);\n      }\n    `}}const hre={kernelName:tD,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,s=n;if(1===s.length)return xne({inputs:{x:s[0]},backend:r});if(s.length>HO().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(s.length/2),n=e({inputs:s.slice(0,t),backend:r}),a=e({inputs:s.slice(t),backend:r});return e({inputs:[n,a],backend:r})}const a=s.map((e=>e.dtype)).reduce(((e,t)=>hP(e,t))),i=s.map((e=>e.shape)),o=HO().getBool("WEBGL_PACK")?new dre(s[0].shape,i):new cre(s[0].shape,i);return r.runWebGLProgram(o,s,a)}};const pre={kernelName:nD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r,o=s.shape.length,l=kO(a,s.shape);let u=l;const c=qU(u,o);let d=s;null!=c&&(d=Qne({inputs:{x:s},backend:n,attrs:{perm:c}}),u=XU(u.length,o)),HU("all",u,o);const[h,p]=WU(d.shape,u),f=jne({inputs:{x:d},backend:n,attrs:{shape:[-1,mO(p)]}}),m=Gne(f,f.dtype,"all",n);let g;if(i){g=jne({inputs:{x:m},backend:n,attrs:{shape:GU(h,l)}})}else g=jne({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(d),g}};const fre={kernelName:rD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r,o=s.shape.length,l=kO(a,s.shape);let u=l;const c=qU(u,o);let d=s;null!=c&&(d=Qne({inputs:{x:s},backend:n,attrs:{perm:c}}),u=XU(u.length,o)),HU("any",u,o);const[h,p]=WU(d.shape,u),f=jne({inputs:{x:d},backend:n,attrs:{shape:[-1,mO(p)]}}),m=Gne(f,f.dtype,"any",n);let g;if(i){g=jne({inputs:{x:m},backend:n,attrs:{shape:GU(h,l)}})}else g=jne({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(d),g}};class mre{constructor(e,t,n){this.variableNames=["A"];const{windowSize:r,batchSize:s,outSize:a}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[s,a];const i="max"===t?">":"<",o=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${r}; i++) {\n          int inIdx = ${o};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${i} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}class gre{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,hO(e.length>2,(()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`));const s=e[e.length-1],a=Math.ceil(s/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");const i=this.outputShape,o=i.length,l=Aee(o),u=Qte("coords",o);let c,d;if(1===a){d=o+1;const e=Aee(d);c=`\n        ${e} sourceLocR = ${e}(${u.join()}, 0);\n        ++${u[o-1]};\n        ${e} sourceLocG = ${e}(${u.join()}, 0);\n        ++${u[o-2]};\n        ${e} sourceLocA = ${e}(${u.join()}, 0);\n        --${u[o-1]};\n        ${e} sourceLocB = ${e}(${u.join()}, 0);\n        --${u[o-2]};`}else d=o,c=`\n        ${l} sourceLocR = coords;\n        ++${u[o-1]};\n        ${l} sourceLocG = coords;\n        ++${u[o-2]};\n        ${l} sourceLocA = coords;\n        --${u[o-1]};\n        ${l} sourceLocB = coords;\n        --${u[o-2]};`;const h=["x","y","z","w","u","v"].slice(0,d),p="."+h[d-1],f=h.map((e=>"int "+e)),m=Qte("sourceLocR",d-1).concat("inIdx.r"),g=Qte("sourceLocG",d-1).concat("inIdx.g"),y=Qte("sourceLocB",d-1).concat("inIdx.b"),v=Qte("sourceLocA",d-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",x=r?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${y.join()}),\n                             getBestIndicesAChannel(${v.join()})));`,w=`vec4(\n            getAChannel(${m.join()}),\n            hasNextCol ? getAChannel(${g.join()}) : 0.,\n            hasNextRow ? getAChannel(${y.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,k=r?"":`\n      float getBestIndicesAChannel(${f.join()}) {\n        return getChannel(getBestIndicesA(${h.join()}),\n                                          vec2(${h.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${f.join()}) {\n        return getChannel(getA(${h.join()}),\n                               vec2(${h.slice(-2).join()}));\n      }\n      ${k}\n      void main() {\n        ${l} coords = getOutputCoords();\n        bool hasNextCol = ${u[o-1]} < ${i[o-1]-1};\n        bool hasNextRow = ${u[o-2]} < ${i[o-2]-1};\n        ${c}\n        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},\n          sourceLocB${p}, sourceLocA${p}) * ${t};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${w};\n\n        for (int i = 0; i < ${t}; i++) {\n          inIdx = srcIdx;\n          ${x}\n          vec4 candidate = ${w};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}function yre(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=t.shape[0],a=t.shape[1];null!=r&&(s=r.shape[0],a=r.shape[1]);const i=HH(a),o={windowSize:i,inSize:a,batchSize:s,outSize:Math.ceil(a/i)},l=new mre(o,n,null==r),u=[t];null!=r&&u.push(r);const c=e.runWebGLProgram(l,u,"int32");if(1===c.shape[1])return c;const d=yre(e,t,n,c);return e.disposeIntermediateTensorInfo(c),d}function vre(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const s=null!=r?r.shape:t.shape,a=HH(s[s.length-1]),i=new gre(s,a,n,null==r),o=null==r?[t]:[t,r],l=e.runWebGLProgram(i,o,"int32");if(l.shape.length===t.shape.length){const r=vre(e,t,n,l);return e.disposeIntermediateTensorInfo(l),r}return l}function bre(e,t,n,r){const s=[n];if(HU("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,t.shape.length),!HO().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const n=[],a=e.texData.get(t.dataId);let i=t;null!==a&&a.isPacked&&(i=e.unpackTensor(t),n.push(i));const[o,l]=WU(i.shape,s),u=mO(l),c=jne({inputs:{x:i},backend:e,attrs:{shape:[-1,u]}});n.push(c);const d=yre(e,c,r);n.push(d);const h=jne({inputs:{x:d},backend:e,attrs:{shape:o}});return n.forEach((t=>e.disposeIntermediateTensorInfo(t))),h}return vre(e,t,r)}const xre={kernelName:sD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a}=r;let i=kO(a,s.shape);const o=qU(i,s.shape.length);let l=s;const u=[];null!=o&&(l=Qne({inputs:{x:s},backend:n,attrs:{perm:o}}),u.push(l),i=XU(i.length,l.shape.length)),HU("argMax",[i[0]],l.shape.length);const c=bre(n,l,i[0],"max");return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}};const wre={kernelName:aD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a}=r;let i=kO(a,s.shape);const o=qU(i,s.shape.length);let l=s;const u=[];null!=o&&(l=Qne({inputs:{x:s},backend:n,attrs:{perm:o}}),u.push(l),i=XU(i.length,l.shape.length)),HU("argMin",[i[0]],l.shape.length);const c=bre(n,l,i[0],"min");return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}},kre=_ne({opSnippet:ane+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),Sre={kernelName:iD,backendName:"webgl",kernelFunc:kre},Ire=_ne({opSnippet:ane+"return log(x + sqrt(x * x + 1.0));"}),Cre={kernelName:oD,backendName:"webgl",kernelFunc:Ire},Tre=_ne({opSnippet:ane+"\n  return atan(x);\n"}),Nre={kernelName:lD,backendName:"webgl",kernelFunc:Tre},Ere=$ne({opSnippet:gne+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+vne+"\n  return result;\n"}),Are={kernelName:cD,backendName:"webgl",kernelFunc:Ere},Rre=_ne({opSnippet:ane+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),_re={kernelName:uD,backendName:"webgl",kernelFunc:Rre};class $re{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,i=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const f="avg"===t,m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let y="0.0";if(f||(y="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode=`\n        const ivec2 strides = ivec2(${i}, ${o});\n        const ivec2 pads = ivec2(${h}, ${p});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${c};\n              wR += ${l}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d};\n                wC += ${u}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ${t} currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${r?s?m:g:`wR * ${d} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let v=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(v="avgValue / max(count, 1.0)");const b=4*Math.floor(a/4),x=a%4,w=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${i}, ${o});\n      const ivec2 pads = ivec2(${h}, ${p});\n      const float initializationValue = ${y};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${y});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${c};\n            wR += ${l}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${b}; wC += 4) {\n            int xC = xCCorner + wC * ${u};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              getValue(batch, xR, xC + 3 * ${u}, d)\n            );\n\n            ${w}\n          }\n\n          int xC = xCCorner + ${b};\n          if (${1===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${w}\n          } else if (${2===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${w}\n          } else if (${3===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              initializationValue\n            );\n\n            ${w}\n          }\n        }\n        setOutput(${v});\n      }\n    `}}class Ore{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,i=e.strideDepth,o=e.strideHeight,l=e.strideWidth,u=e.dilationDepth,c=e.dilationHeight,d=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const v="avg"===t;let b="0.0";if(v||(b="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${i}, ${o}, ${l});\n        const ivec3 pads = ivec3(${m}, ${g}, ${y});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${h};\n              wD += ${u}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${e.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${p};\n                wR += ${c}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${e.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${f};\n                  wC += ${d}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${e.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ${t} currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${r?s?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${f} +\n                      wR * ${f} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let x=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(x="avgValue / max(count, 1.0)");const w=4*Math.floor(a/4),k=a%4,S=`\n      if (${v}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${i}, ${o}, ${l});\n      const ivec3 pads = ivec3(${m}, ${g}, ${y});\n      const float initializationValue = ${b};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${b});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${h};\n            wD += ${u}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${e.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${p};\n            wR += ${c}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${w}; wC += 4) {\n              int xC = xCCorner + wC * ${d};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${d}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${d}, ch)\n              );\n\n              ${S}\n            }\n\n            int xC = xCCorner + ${w};\n            if (${1===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${2===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${3===k}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${d}, ch),\n                initializationValue\n              );\n\n              ${S}\n            }\n          }\n        }\n        setOutput(${x});\n      }\n    `}}const Dre={kernelName:dD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t;cee(s,"avgPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=r;hO(Wj(i,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '1'`));const u=Dj(s.shape,a,i,1,o,l);if(1===u.filterWidth&&1===u.filterHeight&&gO(u.inShape,u.outShape))return xne({inputs:{x:s},backend:n});const c=new $re(u,"avg",!1);return n.runWebGLProgram(c,[s],"float32")}};const Mre={kernelName:pD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:u}=r,c=Mj(s.shape,a,i,[1,1,1],o,l,u),d=new Ore(c,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}};class Fre{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,s=e.strideWidth,a=e.dilationHeight,i=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=o-1-e.padInfo.top,c=l-1-e.padInfo.left,d=1/(t*n);this.userCode=`\n      const ivec2 pads = ivec2(${u}, ${c});\n      const float avgMultiplier = float(${d});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${o};\n            wR += ${a}) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${l};\n            wC+= ${i}) {\n            float dyC = float(dyCCorner + wC) / ${s}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Lre{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,s=e.strideDepth,a=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=c-1-e.padInfo.front,f=d-1-e.padInfo.top,m=h-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`\n      const ivec3 pads = ivec3(${p}, ${f}, ${m});\n      const float avgMultiplier = float(${g});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${c};\n            wD += ${o}) {\n          float dyD = float(dyDCorner + wD) / ${s}.0;\n\n          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${d};\n              wR += ${l}) {\n            float dyR = float(dyRCorner + wR) / ${a}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${h};\n                wC += ${u}) {\n              float dyC = float(dyCCorner + wC) / ${i}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const Pre={kernelName:fD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,input:a}=t,i=a,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,d=Mj(i.shape,o,l,[1,1,1],u,c),h=new Lre(d);return n.runWebGLProgram(h,[s],i.dtype)}};const zre={kernelName:hD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,input:a}=t,i=a;cee([s,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=r,c=Dj(i.shape,o,l,1,u),d=new Fre(c);return n.runWebGLProgram(d,[s],i.dtype)}};const Bre={kernelName:mD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:s,b:a}=t,{transposeA:i,transposeB:o}=r;return Zne({a:s,b:a,transposeA:i,transposeB:o,backend:n})}};class jre{constructor(e,t,n,r,s,a){this.outputShape=[],this.variableNames=["x","mean","variance"],CB(e,t),CB(e,n);let i="0.0";null!=r&&(CB(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let o="1.0";null!=s&&(CB(e,s),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${i};\n        float scale = ${o};\n        float inv = scale * inversesqrt(variance + float(${a}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}class Ure{constructor(e,t,n,r,s,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],CB(e,t),CB(e,n);let i="vec4(0.0)";null!=r&&(CB(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let o="vec4(1.0)";null!=s&&(CB(e,s),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`\n      void main() {\n        vec4 offset = ${i};\n        vec4 scale = ${o};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${a}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}const Vre={kernelName:oM,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:s,mean:a,variance:i,offset:o,scale:l}=t;hO(a.shape.length===i.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),hO(null==o||a.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),hO(null==l||a.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:u}=r;null==u&&(u=.001);const c=[s,a,i];let d=null;null!=o&&(d=o.shape,c.push(o));let h=null;null!=l&&(h=l.shape,c.push(l));const p=HO().getBool("WEBGL_PACK_NORMALIZATION")?new Ure(s.shape,a.shape,i.shape,d,h,u):new jre(s.shape,a.shape,i.shape,d,h,u);return n.runWebGLProgram(p,c,c[0].dtype)}};class Wre{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=Aee(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(e){if(1===e)return"sourceLoc";if(e<=6)return Gre.slice(0,e).map((e=>"sourceLoc."+e)).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}(this.rank);let r;r=`\n        ${t} sourceLoc;\n        ${t} coords = getOutputCoords();\n        ${e.map(((e,t)=>`sourceLoc.${Gre[t]} = start[${t}] + coords.${Gre[t]};`)).join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${r}\n        setOutput(getSource(${n}));\n      }\n    `}}const Gre=["x","y","z","w","u","v"];class Hre{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=Aee(this.rank),n=Qte("coords",this.rank),r=Qte("sourceLoc",this.rank),s=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,a=`getChannel(getSource(${r.join()}), ${s})`,i=`\n      result.x = ${a};\n      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {\n        ++${r[this.rank-1]};\n        result.y = ${a};\n        --${r[this.rank-1]};\n      }\n    `,o=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {\n        ++${r[this.rank-2]};\n        result.z = ${a};\n        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {\n          ++${r[this.rank-1]};\n          result.w = ${a};\n        }\n      }\n    `,l=this.rank<=4?`sourceLoc = coords +\n            ${t}(${e.map(((e,t)=>`start[${t}]`)).join()});`:e.map(((e,t)=>`${r[t]} = ${n[t]} + start[${t}];`)).join("\n");this.userCode=`\n      void main() {\n        ${t} coords = getOutputCoords();\n        ${t} sourceLoc;\n        ${l}\n        vec4 result = vec4(0.);\n        ${i}\n        ${o}\n        setOutput(result);\n      }\n    `}}function qre(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{begin:a,size:i}=r,[o,l]=vj(s,a,i);if(sj(s,o,l),0===mO(l))return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||"string"===s.dtype){const e=n.texData.get(s.dataId),t=Mte(e.values,o,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,t)}const{isPacked:u}=n.texData.get(s.dataId),c=gj(s.shape,o,l);if(u||!c){const e=HO().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hre(l):new Wre(l),t=[o];return n.runWebGLProgram(e,[s],s.dtype,t)}return n.uploadToGPU(s.dataId),function(e,t,n,r){const s=r.texData.get(e.dataId),a=r.makeTensorInfo(n,e.dtype),i=r.texData.get(a.dataId);Object.assign(i,s),i.refCount=1,i.shape=n,i.dtype=e.dtype;let o=yj(t,OO(e.shape));s.slice&&(o+=s.slice.flatOffset),i.slice={flatOffset:o,origDataId:s.slice&&s.slice.origDataId||e.dataId};const l=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,l+1),a}(s,o,l,n)}const Kre={kernelName:kF,backendName:"webgl",kernelFunc:qre},Xre={kernelName:gD,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{blockShape:a,crops:i}=r;hO(s.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const o=a.reduce(((e,t)=>e*t)),l=KH(s.shape,a,o),u=XH(l.length,a.length),c=YH(s.shape,a,o),d=QH(i,a.length),h=JH(c,i,a.length),p=[],f=jne({inputs:{x:s},backend:n,attrs:{shape:l}}),m=Qne({inputs:{x:f},backend:n,attrs:{perm:u}}),g=jne({inputs:{x:m},backend:n,attrs:{shape:c}}),y=qre({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(m),p.push(g),p.forEach((e=>n.disposeIntermediateTensorInfo(e))),y}};const Yre={kernelName:yD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,weights:a}=t,{size:i}=r,o=n.readSync(s.dataId),l=n.readSync(a.dataId),u=nte(o,l,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,u)}};const Qre={kernelName:vD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{a:r,b:s}=t,a=HO().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=HO().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||1===i){const e=n.texData.get(r.dataId).values,t=n.texData.get(s.dataId).values,[a,i]=ste(r.shape,s.shape,e,t,r.dtype),o=n.makeTensorInfo(i,r.dtype);return n.texData.get(o.dataId).values=a,o}let o;return o=a?new bne("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,s.shape,!1):new yne("\n  return float(int(a.r) & int(b.r));\n",r.shape,s.shape),n.runWebGLProgram(o,[r,s],r.dtype)}};const Jre={kernelName:bD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:s}=t,a=n.readSync(r.dataId),i=n.readSync(s.dataId),o=CB(Array.from(a),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},Zre=$ne({opSnippet:"return float(a != b);",cpuKernelImpl:Cte,dtype:"bool"}),ese={kernelName:WM,backendName:"webgl",kernelFunc:Zre};function tse(e){const{inputs:t,backend:n}=e,{input:r}=t;return xne({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const nse={kernelName:aF,backendName:"webgl",kernelFunc:tse};const rse={kernelName:xD,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r,attrs:s}=t,{x:a}=n,{dtype:i}=s;if("complex64"===i){if("complex64"===a.dtype)return xne({inputs:{x:a},backend:r});const t=PV(a.shape),n=e({inputs:{x:a},backend:r,attrs:{dtype:"float32"}}),s=kne({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeIntermediateTensorInfo(n),s}if("complex64"===a.dtype){const t=tse({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:i}});return r.disposeIntermediateTensorInfo(t),n}if(!TO(a.dtype,i)){const e=xne({inputs:{x:a},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:i}}if(r.shouldExecuteOnCPU([a])){const e=r.texData.get(a.dataId).values,[t,n,s]=ate(e,a.shape,a.dtype,i);return r.makeTensorInfo(t,n,s)}if("int32"===i)return function(e,t){const n=new sne(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(a,r);if("bool"===i){const e=r.makeTensorInfo([],"bool",IO("bool",1)),t=Zre({inputs:{a:a,b:e},backend:r});return r.disposeIntermediateTensorInfo(e),t}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${i}`)}},sse="return ceil(x);",ase=_ne({opSnippet:sse,packedOpSnippet:sse,cpuKernelImpl:ite}),ise={kernelName:wD,backendName:"webgl",kernelFunc:ase};class ose{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class lse{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const use={kernelName:kD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{clipValueMin:a,clipValueMax:i}=r;let o;o=HO().getBool("WEBGL_PACK_CLIP")?new lse(s.shape):new ose(s.shape);const l=[[a],[i]];return n.runWebGLProgram(o,[s],s.dtype,l)}};class cse{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function dse(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}const hse={kernelName:ID,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,s=n.texData.get(r.dataId),a=new cse(r.shape),i=[dse(r,s.complexTensorInfos.real),dse(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(a,i,i[0].dtype)}};class pse{constructor(e){this.outputShape=[],this.outputShape=PH(e,1),this.variableNames=e.map(((e,t)=>`T${t}`));const t=new Array(e.length-1);t[0]=e[0][1];for(let a=1;a<t.length;a++)t[a]=t[a-1]+e[a][1];const n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<t.length;a++){const e=t[a-1];n.push(`else if (yC < ${t[a]}) setOutput(getT${a}(yR, yC-${e}));`)}const r=t.length,s=t[t.length-1];n.push(`else setOutput(getT${r}(yR, yC-${s}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}}class fse{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=PH(e,t);const n=this.outputShape,r=n.length,s=Aee(r),a=Qte("coords",r),i=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(((e,t)=>`T${t}`));const o=new Array(e.length-1);o[0]=e[0][t];for(let f=1;f<o.length;f++)o[f]=o[f-1]+e[f][t];const l=i[t],u=i.slice(-2),c=i.join();let d=`if (${l} < ${o[0]}) {\n        return getChannel(\n            getT0(${c}), vec2(${u.join()}));\n        }`;for(let f=1;f<o.length;f++){const e=o[f-1];d+=`\n        if (${l} < ${o[f]}  && ${l} >= ${o[f-1]}) {\n          return getChannel(\n            getT${f}(${mse(i,l,e)}),\n            vec2(${mse(u,l,e)}));\n        }`}const h=o.length,p=o[o.length-1];d+=`\n        return getChannel(\n          getT${h}(${mse(i,l,p)}),\n          vec2(${mse(u,l,p)}));`,this.userCode=`\n      float getValue(${i.map((e=>"int "+e))}) {\n        ${d}\n      }\n\n      void main() {\n        ${s} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${a}), 0., 0., 0.);\n\n        ${a[r-1]} = ${a[r-1]} + 1;\n        if (${a[r-1]} < ${n[r-1]}) {\n          result.g = getValue(${a});\n        }\n\n        ${a[r-2]} = ${a[r-2]} + 1;\n        if (${a[r-2]} < ${n[r-2]}) {\n          result.a = getValue(${a});\n        }\n\n        ${a[r-1]} = ${a[r-1]} - 1;\n        if (${a[r-2]} < ${n[r-2]} &&\n            ${a[r-1]} < ${n[r-1]}) {\n          result.b = getValue(${a});\n        }\n        setOutput(result);\n      }\n    `}}function mse(e,t,n){const r=e.indexOf(t);return e.map(((e,t)=>t===r?`${e} - ${n}`:e)).join()}function gse(e){const{inputs:t,backend:n}=e,{input:r}=t;return xne({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const yse={kernelName:fM,backendName:"webgl",kernelFunc:gse};function vse(e,t,n){const r=e[0].dtype;if("complex64"===r){const r=e.map((e=>tse({inputs:{input:e},backend:n}))),s=e.map((e=>gse({inputs:{input:e},backend:n}))),a=vse(r,t,n),i=vse(s,t,n),o=kne({inputs:{real:a,imag:i},backend:n});return r.forEach((e=>n.disposeIntermediateTensorInfo(e))),s.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}let s=n.shouldExecuteOnCPU(e);if("string"===r&&(s=!0),s){const s=e.map((e=>{const r=mO(e.shape.slice(t));return jne({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),a=s.map((e=>({vals:n.readSync(e.dataId),shape:e.shape}))),i=PH(s.map((e=>e.shape)),1),o=1===s[0].shape[0],l=ote(a,i,r,o),u=PH(e.map((e=>e.shape)),t),c=n.makeTensorInfo(u,r,l);return s.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}const a=e.filter((e=>mO(e.shape)>0)),i=HO().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(1===a.length){const t=i?new sne(e[0].shape,une):new cne(e[0].shape,une);return n.runWebGLProgram(t,e,r)}const o=HO().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>o){const e=[];for(let s=0;s<a.length;s+=o){const r=a.slice(s,s+o);e.push(vse(r,t,n))}const r=vse(e,t,n);for(const t of e)n.disposeIntermediateTensorInfo(t);return r}if(i){const e=new fse(a.map((e=>e.shape)),t);return n.runWebGLProgram(e,a,r)}const{tensors2D:l,outShape:u}=function(e,t,n){const r=PH(e.map((e=>e.shape)),t),s=e.map((e=>jne({inputs:{x:e},attrs:{shape:[-1,mO(e.shape.slice(t))]},backend:n})));return{tensors2D:s,outShape:r}}(a,t,n),c=new pse(l.map((e=>e.shape))),d=n.runWebGLProgram(c,l,r);l.forEach((e=>n.disposeIntermediateTensorInfo(e)));const h=jne({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),h}function bse(e){const{inputs:t,backend:n,attrs:r}=e,{axis:s}=r,a=kO(s,t[0].shape)[0];LH(t.map((e=>e.shape)),a);const i=PH(t.map((e=>e.shape)),a);if(0===mO(i))return n.makeTensorInfo(i,t[0].dtype,[]);const o=t.filter((e=>mO(e.shape)>0));return 1===o.length?xne({inputs:{x:o[0]},backend:n}):vse(o,a,n)}const xse={kernelName:CD,backendName:"webgl",kernelFunc:bse};class wse{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=e.outShape;const a=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,g=m?1:2,y=m?2:3,v=m?3:1;let b="",x="";n&&(b=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:s?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,x="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${b}\n\n      const ivec2 strides = ivec2(${o}, ${l});\n      const ivec2 pads = ivec2(${a}, ${i});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${v}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${g}], coords[${y}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${d}; wR++) {\n          int xR = xRCorner + wR * ${u};\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${h}; wC++) {\n            int xC = xCCorner + wC * ${c};\n\n            if (xC < 0 || xC >= ${e.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${p}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${m}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===f}) {\n\n              if (${m}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${p}) *\n                    getW(wR, wC, ${p}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${p}, xR, xC) *\n                    getW(wR, wC, ${p}, d2);\n              }\n\n            } else if (${2===f}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2)\n              );\n\n              if (${m}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===f}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2),\n                getW(wR, wC, ${p} + 2, d2)\n              );\n\n              if (${m}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1),\n                  getX(batch, xR, xC, ${p} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC),\n                  getX(batch, ${p} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${w}\n        ${x}\n        setOutput(result);\n      }\n    `}}class kse{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,s=e.strideDepth,a=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.filterDepth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${s}, ${a}, ${i});\n      const ivec3 pads = ivec3(${t}, ${n}, ${r});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${c}; wF++) {\n          int xF = xFCorner + wF * ${o};\n\n          if (xF < 0 || xF >= ${e.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${d}; wR++) {\n            int xR = xRCorner + wR * ${l};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${h}; wC++) {\n              int xC = xCCorner + wC * ${u};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${p}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===f}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${p}) *\n                  getW(wF, wR, wC, ${p}, d2);\n              } else if (${2===f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1),\n                  getX(batch, xF, xR, xC, ${p} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2),\n                  getW(wF, wR, wC, ${p} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Sse{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Fee(this.outputShape.length);const a=e.padInfo.left,i=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,c=u;let d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<u;m++)d+=`\n           vec4 xTexelC${2*m};\n           int xTexelC${2*m}Ready;\n           vec4 xTexelC${2*m+1};\n           int xTexelC${2*m+1}Ready;\n           vec4 xC${m};`;d+=`\n     for (int r = 0; r < ${l}; r++) {\n      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {\n       `;for(let m=0;m<u;m++)d+=`\n           xTexelC${2*m} = vec4(0.0);\n           xTexelC${2*m}Ready = 0;\n           xTexelC${2*m+1} = vec4(0.0);\n           xTexelC${2*m+1}Ready = 0;\n           xC${m} = vec4(0.0);`;d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(c+1)/2;m++){const t=2*m;if(d+=`\n           xC = xCCorner + ${t*o};\n           `,1===i){if(t<u&&(a%2===1?(d+=`\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n               `,d+=1===o&&t>0?`\n                 xC${t} = vec4(xTexelC${t-2}.zw, xTexelC${t}.xy);\n                 `:`\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC${t} = vec4(previous.zw, xTexelC${t}.xy);\n                   } else {\n                     xC${t} = vec4(0.0, 0.0, xTexelC${t}.xy);\n                   }\n                   `):d+=`\n                 if (xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n\n                 xC${t} = xTexelC${t};\n                 `,t+1<u)){const e=a%2===0?cO(o):o;o%2===0&&a%2===1||o%2!==0&&a%2!==1?(d+=`\n                   xCOffset = xC + imod(pads[1], 2) + ${e};\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                     xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC${t+1}.zw = vec2(0.0);\n                     }\n                     xTexelC${t+1}Ready = 1;\n                   }\n                   `,d+=o>1?`\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC${t+1} = vec4(previous.zw, xTexelC${t+1}.xy);\n                     } else {\n                      xC${t+1} = vec4(0.0, 0.0, xTexelC${t+1}.xy);\n                     }\n                     `:`\n                     xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.xy);\n                     `):d+=1===e?`\n                     xC${t+1} = xTexelC${t};\n                     `:`\n                     xCOffset = xC + ${e};\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                       xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC${t+1}.zw = vec2(0.0);\n                       }\n                       xTexelC${t+1}Ready = 1;\n                     }\n\n                     xC${t+1} = xTexelC${t+1};\n                     `}}else t<u&&(a%2===1?(d+=`\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${t+1}Ready == 0) {\n                   xTexelC${t+1} = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC${t+1}.zw = vec2(0.0);\n                   }\n                   xTexelC${t+1}Ready = 1;\n                 }\n\n                 xC${t} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n               `,t+1<u&&(d+=`\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC${t+1} = vec4(xTexelC${t+1}.xy, final.xy);\n                 `)):(d+=`\n                 if(xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                   xTexelC${t} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${t}.zw = vec2(0.0);\n                   }\n                   xTexelC${t}Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                   xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${t+1}.zw = vec2(0.);\n                   }\n                   xTexelC${t+1}Ready = 1;\n                 }\n\n                 xC${t} = vec4(\n                   xTexelC${t}.xy, xTexelC${t+1}.xy);\n               `,t+1<u&&(d+=`\n                   xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n                 `)));t<u&&(d+=`\n             wTexel = getW(r, ${t}, d1, d2);\n             dotProd += xC${t}.xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ${e.inChannels}) {\n               dotProd += xC${t}.yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           `,t+1<u&&(d+=`\n               wTexel = getW(r, ${t+1}, d1, d2);\n               dotProd += xC${t+1}.xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ${e.inChannels}) {\n                 dotProd += xC${t+1}.yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             `))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";let h="",p="";n&&(h=r?`vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ${n}\n         }`:s?`vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ${n}\n         }`:`vec4 activation(vec4 x) {\n           ${n}\n         }`,p="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n       ${h}\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ${d}\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ${f}\n         ${p}\n         setOutput(result);\n       }\n     `}}class Ise{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Fee(this.outputShape.length);const{dataFormat:n}=t,r=hee(),s="channelsLast"===n,a=s?1:2,i=s?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let l="";for(let u=0;u<=1;u++)for(let e=0;e<=1;e++)l+=`\n          blockIndex = rc.z + ${e};\n          pos = rc.y + ${u};\n\n          ${o}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${a}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${i}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${s}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*u+e}] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*u+e}] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${l}\n\n        ${r.output} = result;\n      }\n    `}}function Cse(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function Tse(e){let{x:t,filter:n,convInfo:r,backend:s,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}=e;const u=t.shape,c=s.texData.get(t.dataId),d=r.inChannels,h=u[0]*u[1]*u[2],p=r.outChannels,f="channelsLast"===r.dataFormat,m=!1;let g;const y=[];if(null!=i){const e=Cse(i.shape,f);null!=e&&(i=jne({inputs:{x:i},backend:s,attrs:{shape:e}}),y.push(i))}if(null!=a){const e=Cse(a.shape,f);null!=e&&(a=jne({inputs:{x:a},backend:s,attrs:{shape:e}}),y.push(a))}if(!((1===h||1===p)&&d>1e3)&&c.isPacked&&f&&null!=c.texture&&u[2]%2!==0&&gO(c.shape.slice(-3),u.slice(-3))){const e=u[0]*u[1]*(u[2]+1),d={dataId:t.dataId,shape:[1,e,r.inChannels],dtype:t.dtype},h=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,hO(ree(c.shape,d.shape),(()=>`packed reshape ${c.shape} to ${d.shape} isn't free`));const p=jne({inputs:{x:n},backend:s,attrs:{shape:[1,r.inChannels,r.outChannels]}});y.push(p);const f=Zne({a:d,b:p,backend:s,transposeA:false,transposeB:m,bias:a,activation:l,preluActivationWeights:i,leakyreluAlpha:o}),v=s.texData.get(f.dataId);hO(v.isPacked,(()=>"batchMatMul result is expected to be packed")),c.shape=h,v.shape=r.outShape,g=xne({inputs:{x:f},backend:s}),g.shape=r.outShape,y.push(f)}else{const e=r.outHeight*r.outWidth,u=jne({inputs:{x:t},backend:s,attrs:{shape:f?[r.batchSize,e,r.inChannels]:[r.batchSize,r.inChannels,e]}}),c=jne({inputs:{x:n},backend:s,attrs:{shape:[1,r.inChannels,r.outChannels]}}),d=Zne({a:f?u:c,b:f?c:u,transposeA:!f,transposeB:m,backend:s,bias:a,activation:l,preluActivationWeights:i,leakyreluAlpha:o});g=jne({inputs:{x:d},backend:s,attrs:{shape:r.outShape}}),y.push(u),y.push(c),y.push(d)}for(const v of y)s.disposeIntermediateTensorInfo(v);return g}function Nse(e){let{x:t,filter:n,convInfo:r,backend:s,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}=e;const{filterWidth:u,filterHeight:c,inChannels:d,outWidth:h,outHeight:p,dataFormat:f}=r,m="channelsLast"===f,g=u*c*d,y=p*h,v=[r.batchSize,g,y],b=[];if(null!=i){const e=Cse(i.shape,m);null!=e&&(i=jne({inputs:{x:i},backend:s,attrs:{shape:e}}),b.push(i))}if(null!=a){const e=Cse(a.shape,m);null!=e&&(a=jne({inputs:{x:a},backend:s,attrs:{shape:e}}),b.push(a))}const x=jne({inputs:{x:n},backend:s,attrs:{shape:[1,g,mO(n.shape)/g]}});b.push(x);const w=new Ise(v,r),k=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],S=s.runWebGLProgram(w,[t],"float32",k),I=jne({inputs:{x:S},backend:s,attrs:{shape:v}});b.push(S),b.push(I);const C=null!=a,T=null!=i,N="leakyrelu"===l,E=l?One(l,!0):null,A=new Dne(m?I.shape:x.shape,m?x.shape:I.shape,m?[r.batchSize,y,r.outChannels]:[r.batchSize,r.outChannels,y],!0,!1,C,E,T,N),R=m?[I,x]:[x,I];if(a&&R.push(a),T&&R.push(i),N){const e=s.makeTensorInfo([],"float32",OL(o,"float32"));R.push(e),b.push(e)}const _=s.runWebGLProgram(A,R,"float32"),$=jne({inputs:{x:_},backend:s,attrs:{shape:r.outShape}});b.push(_);for(const O of b)s.disposeIntermediateTensorInfo(O);return $}const Ese={kernelName:TD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a}=t,{strides:i,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=Hj(l),h=Fj(s.shape,a.shape,i,u,o,c,!1,d);let p;if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===d&&HO().getBool("WEBGL_EXP_CONV")){const e=new Sse(h),t=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];p=n.runWebGLProgram(e,[s,a],"float32",t)}else if(HO().getBool("WEBGL_CONV_IM2COL"))p=Nse({x:s,filter:a,convInfo:h,backend:n});else{const e=new wse(h);p=n.runWebGLProgram(e,[s,a],"float32")}else p=Tse({x:s,filter:a,convInfo:h,backend:n});const f=jne({inputs:{x:p},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(p),f}};class Ase{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,s=e.padInfo.left,a="channelsLast"===e.dataFormat;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yR = 0; yR < ${e.outHeight}; yR++) {\n            int xR = wR + yR * ${t} - ${r};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${e.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${s};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              ${a?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);"}\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Rse{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,s=e.strideWidth,a="channelsLast"===e.dataFormat,i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,l=a?1:2,u=a?2:3,c=a?3:1;this.userCode=`\n      const ivec2 pads = ivec2(${i}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${c}];\n\n        ivec2 dyCorner = ivec2(coords[${l}], coords[${u}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${s}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n\n              if (${a}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class _se{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,s=e.padInfo.front,a=e.padInfo.top,i=e.padInfo.left;this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yF = 0; yF < ${e.outDepth}; yF++) {\n            int xF = wF + yF * ${t} - ${s};\n\n            if (xF < 0 || xF >= ${e.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${e.outHeight}; yR++) {\n              int xR = wR + yR * ${n} - ${a};\n\n              if (xR < 0 || xR >= ${e.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${e.outWidth}; yC++) {\n                int xC = wC + yC * ${r} - ${i};\n\n                if (xC < 0 || xC >= ${e.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class $se{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,s=e.strideDepth,a=e.strideHeight,i=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`\n      const ivec3 pads = ivec3(${o}, ${l}, ${u});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${t}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${s}.0;\n\n          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${t} - 1 - wF;\n\n          for (int wR = 0; wR < ${n}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${a}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${n} - 1 - wR;\n\n            for (int wC = 0; wC < ${r}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${i}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${r} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const Ose={kernelName:ND,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,dy:a}=t,{strides:i,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=Hj(l),h=Fj(s.shape,c,i,1,o,u,!1,d),p=new Ase(h);return n.runWebGLProgram(p,[s,a],"float32")}};class Dse{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Fee(this.outputShape.length);const t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,s=n-1-e.padInfo.left;this.userCode=`\n      const ivec2 pads = ivec2(${r}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            int wCPerm = ${n} - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    `}}const Mse={kernelName:ED,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,filter:a}=t,{inputShape:i,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=Hj(u),h=Fj(i,a.shape,o,1,l,c,!1,d);if(HO().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===d){const e=[[h.strideHeight,h.strideWidth]],t=new Dse(h);return n.runWebGLProgram(t,[s,a],"float32",e)}{const e=new Rse(h);return n.runWebGLProgram(e,[s,a],"float32")}}};const Fse={kernelName:AD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a}=t,{strides:i,pad:o,dilations:l}=r,u=Lj(s.shape,a.shape,i,l,o),c=new kse(u);return n.runWebGLProgram(c,[s,a],"float32")}};const Lse={kernelName:RD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,dy:a}=t,{strides:i,pad:o,filterShape:l}=r,u=Lj(s.shape,l,i,1,o),c=new _se(u);return n.runWebGLProgram(c,[s,a],"float32")}};const Pse={kernelName:_D,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,filter:a}=t,{pad:i,strides:o,inputShape:l}=r,u=Lj(l,a.shape,o,1,i),c=new $se(u);return n.runWebGLProgram(c,[s,a],"float32")}},zse=_ne({opSnippet:Rne+"\n  return cos(x);\n",packedOpSnippet:`\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ${vne}\n  return result;\n`}),Bse={kernelName:$D,backendName:"webgl",kernelFunc:zse},jse=_ne({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),Use={kernelName:OD,backendName:"webgl",kernelFunc:jse};class Vse{constructor(e,t,n,r,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,i,o,l]=e,[u]=t,[c,d]=n;this.outputShape=[u,c,d,l];const h="bilinear"===r?1:0,[p,f]=[i-1+".0",o-1+".0"],[m,g,y]=c>1?[""+(i-1)/(c-1),"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[v,b,x]=d>1?[""+(o-1)/(d-1),"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${v});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${a}) {\n          return;\n        }\n\n        float height_scale = ${g};\n        float width_scale = ${b};\n\n        float in_y = ${y};\n        if( in_y < 0.0 || in_y > ${p} ) {\n          setOutput(float(${s}));\n          return;\n        }\n        float in_x = ${x};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${s}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${h} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}const Wse={kernelName:FD,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{image:s,boxes:a,boxInd:i}=t,{cropSize:o,method:l,extrapolationValue:u}=r,c=new Vse(s.shape,a.shape,o,l,u);return n.runWebGLProgram(c,[s,a,i],"float32")}};var Gse,Hse;(Hse=Gse||(Gse={})).Prod="*",Hse.Sum="+";class qse{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,a=this.op===Gse.Prod?"1.0":"0.0",i=n?a:`getX(${Kse(s,"coords",this.op)})`,o=this.outputShape[this.outputShape.length-1];let l="",u="";n?(l=r?"end != "+(o-1):"end != 0",u=r?"end + 1":"end - 1"):(l=r?`end + pow2 < ${o}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`\n      void main() {\n        ${Aee(s)} coords = getOutputCoords();\n        int end = ${Xse(s,"coords",this.op)};\n        float val = ${i};\n        int pow2 = int(pow(2.0, index));\n        if (${l}) {\n          int idx = ${u};\n          ${Xse(s,"coords",this.op)} = idx;\n          val ${this.op}= getX(${Kse(s,"coords",this.op)});\n        }\n        setOutput(val);\n      }\n    `}}function Kse(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.x, ${t}.y`;if(3===e)return`${t}.x, ${t}.y, ${t}.z`;if(4===e)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function Xse(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.y`;if(3===e)return`${t}.z`;if(4===e)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function Yse(e,t,n,r,s,a){const i=t.shape.length,o=qU([r],i);let l=t;null!=o&&(l=Qne({inputs:{x:t},backend:n,attrs:{perm:o}}));const u=XU(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=xne({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const t=new qse(e,l.shape,!1,a),r=[[h]],s=d;d=n.runWebGLProgram(t,[d],d.dtype,r),n.disposeIntermediateTensorInfo(s)}if(s){const t=new qse(e,l.shape,s,a),r=d;d=n.runWebGLProgram(t,[d],d.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=o){const e=Qne({inputs:{x:d},backend:n,attrs:{perm:KU(o)}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),e}return d}const Qse={kernelName:DD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,exclusive:i,reverse:o}=r;return Yse(Gse.Prod,s,n,a,i,o)}};const Jse={kernelName:MD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,exclusive:i,reverse:o}=r;return Yse(Gse.Sum,s,n,a,i,o)}};const Zse={kernelName:LD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,weights:a}=t,{size:i,binaryOutput:o}=r;if(1===s.shape.length){const e=n.readSync(s.dataId),t=n.readSync(a.dataId),r=nte(e,t,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,r)}if(2===s.shape.length){const e=n.bufferSync(s),t=n.bufferSync(a),r=rte(e,t,i,o);return n.makeTensorInfo(r.shape,a.dtype,r.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}};class eae{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${t};\n      int offset_h = imod(h, ${t});\n      int in_w = w / ${t};\n      int offset_w = imod(w, ${t});\n      int offset_d = (offset_h * ${t} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const tae={kernelName:PD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{blockSize:a,dataFormat:i}=r,o=s.shape[0],l=("NHWC"===i?s.shape[1]:s.shape[2])*a,u=("NHWC"===i?s.shape[2]:s.shape[3])*a,c=("NHWC"===i?s.shape[3]:s.shape[1])/(a*a),d=new eae("NHWC"===i?[o,l,u,c]:[o,c,l,u],a,i);return n.runWebGLProgram(d,[s],s.dtype)}};class nae{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Fee(this.outputShape.length);const a=e.filterHeight,i=e.filterWidth,o=e.outChannels/e.inChannels;let l="",u="";n&&(l=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:s?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,u="result = activation(result);");const c=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${l}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${o};\n        int q = d2 - d1 * ${o};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${a}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${i}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${c}\n        ${u}\n        setOutput(result);\n      }\n    `}}class rae{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Fee(this.outputShape.length);const a=e.outChannels/e.inChannels,i=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<c;g++)h+=`\n          vec4 xTexelC${2*g};\n          int xTexelC${2*g}Ready;\n          vec4 xTexelC${2*g+1};\n          int xTexelC${2*g+1}Ready;\n          vec4 xC${g};`;h+=`\n    for (int r = 0; r < ${u}; r++) {\n      `;for(let g=0;g<c;g++)h+=`\n          xTexelC${2*g} = vec4(0.0);\n          xTexelC${2*g}Ready = 0;\n          xTexelC${2*g+1} = vec4(0.0);\n          xTexelC${2*g+1}Ready = 0;\n          xC${g} = vec4(0.0);`;h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(d+1)/2;g++){const e=2*g;if(h+=`\n          xC = xCCorner + ${e*l};\n          `,1===o){if(e<c&&(i%2===1?(h+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n              `,h+=1===l&&e>0?`\n                xC${e} = vec4(xTexelC${e-2}.zw, xTexelC${e}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${e} = vec4(previous.zw, xTexelC${e}.xy);\n                  } else {\n                    xC${e} = vec4(0.0, 0.0, xTexelC${e}.xy);\n                  }\n                  `):h+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n\n                xC${e} = xTexelC${e};\n                `,e+1<c)){const t=i%2===0?cO(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(h+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${t};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                    xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${e+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${e+1}Ready = 1;\n                  }\n                  `,h+=l>1?`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC${e+1} = vec4(previous.zw, xTexelC${e+1}.xy);\n                    } else {\n                     xC${e+1} = vec4(0.0, 0.0, xTexelC${e+1}.xy);\n                    }\n                    `:`\n                    xC${e+1} = vec4(xTexelC${e}.zw, xTexelC${e+1}.xy);\n                    `):h+=1===t?`\n                    xC${e+1} = xTexelC${e};\n                    `:`\n                    xCOffset = xC + ${t};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                      xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${e+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${e+1}Ready = 1;\n                    }\n\n                    xC${e+1} = xTexelC${e+1};\n                    `}}else e<c&&(i%2===1?(h+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${e+1}Ready == 0) {\n                  xTexelC${e+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${e+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${e+1}Ready = 1;\n                }\n\n                xC${e} = vec4(xTexelC${e}.zw, xTexelC${e+1}.zw);\n              `,e+1<c&&(h+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${e+1} = vec4(xTexelC${e+1}.xy, final.xy);\n                `)):(h+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${e}Ready == 0) {\n                  xTexelC${e} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${e}.zw = vec2(0.0);\n                  }\n                  xTexelC${e}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                  xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${e+1}.zw = vec2(0.);\n                  }\n                  xTexelC${e+1}Ready = 1;\n                }\n\n                xC${e} = vec4(\n                  xTexelC${e}.xy, xTexelC${e+1}.xy);\n              `,e+1<c&&(h+=`\n                  xC${e+1} = vec4(xTexelC${e}.zw, xTexelC${e+1}.zw);\n                `)));e<c&&(h+=`\n            wTexel = getW(r, ${e}, d1, q);\n            dotProd += xC${e} * vec4(wTexel.xz, wTexel.xz);\n          `,e+1<c&&(h+=`\n              wTexel = getW(r, ${e+1}, d1, q);\n              dotProd += xC${e+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}h+="\n    }\n  ",h+="\n      }\n    ";let p="",f="";n&&(p=r?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:s?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,f="result = activation(result);");const m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${p}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${a};\n        int q = d2 - d1 * ${a};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${h}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${m}\n        ${f}\n        setOutput(result);\n      }\n    `}}const sae={kernelName:zD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a}=t,{strides:i,pad:o,dilations:l,dimRoundingMode:u}=r;let c=l;null==c&&(c=[1,1]),hO(Wj(i,c),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`));const d=Fj(s.shape,a.shape,i,c,o,u,!0);let h;h=HO().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?new rae(d):new nae(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[s,a],"float32",p)}};class aae{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,s=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${a} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yR = 0; yR < ${e.outHeight}; yR++) {\n            int xR = wR + yR * ${t} - ${r};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${e.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${s};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class iae{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,s=e.strideWidth,a=t-1-e.padInfo.top,i=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${a}, ${i});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${s}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${o}; dm++) {\n              int d2 = d1 * ${o} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const oae={kernelName:BD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,dy:a}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r,d=Fj(s.shape,c,i,o,l,u,!0),h=new aae(d);return n.runWebGLProgram(h,[s,a],"float32")}};const lae={kernelName:jD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,filter:a}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=r,d=Fj(c,a.shape,i,o,l,u,!0),h=new iae(d);return n.runWebGLProgram(h,[s,a],"float32")}};class uae{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const cae={kernelName:UD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,s=[...r.shape,...r.shape],a=mO(r.shape),i=jne({inputs:{x:r},backend:n,attrs:{shape:[a]}}),o=new uae(a),l=n.runWebGLProgram(o,[i],i.dtype),u=jne({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}};class dae{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:r,strideHeight:s,strideWidth:a,filterHeight:i,filterWidth:o,dilationHeight:l,dilationWidth:u}=e,{top:c,left:d}=r;this.userCode=`\n      const ivec2 strides = ivec2(${s}, ${a});\n      const ivec2 pads = ivec2(${c}, ${d});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${i}; h++) {\n          int hIn = hBeg + h * ${l};\n\n          if (hIn >= 0 && hIn < ${t}) {\n            for (int w = 0; w < ${o}; w++) {\n              int wIn = wBeg + w * ${u};\n\n              if (wIn >= 0 && wIn < ${n}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}const hae={kernelName:VD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a}=t,{strides:i,pad:o,dilations:l}=r,u=Oj(s.shape,a.shape,i,o,"NHWC",l);let c;const d=new dae(u);c=n.runWebGLProgram(d,[s,a],"float32");const h=jne({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),h}};const pae={kernelName:KD,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:s}=r,a=t,{allDims:i,summedDims:o,idDims:l}=xq(s,a.length);kq(i.length,l,a);const{path:u,steps:c}=Sq(o,l),d=c.length;let h=null,p=i.length;const f=[];for(let m=0;m<d;++m){for(const e of c[m]){const{permutationIndices:t,expandDims:r}=wq(p,l[e]);let s;Iq(t)?s=a[e]:(s=Qne({inputs:{x:a[e]},backend:n,attrs:{perm:t}}),f.push(s));const i=s.shape.slice();for(let e=0;e<r.length;++e)i.splice(r[e],0,1);gO(s.shape,i)||(s=jne({inputs:{x:s},backend:n,attrs:{shape:i}}),f.push(s)),null===h?h=s:(h=zne({inputs:{a:s,b:h},backend:n}),f.push(h))}m<d-1&&(u[m]>=0&&(h=Xne({inputs:{x:h},backend:n,attrs:{axis:u[m]-(i.length-p),keepDims:!1}}),f.push(h)),p--)}for(const m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}},fae=_ne({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),mae={kernelName:XD,backendName:"webgl",kernelFunc:fae},gae={kernelName:YD,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n}=e,{dy:r,y:s}=t,a=HO().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bne("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,s.shape):new yne("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,s.shape);return n.runWebGLProgram(a,[r,s],r.dtype)}},yae=$ne({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:lte}),vae={kernelName:JD,backendName:"webgl",kernelFunc:yae},bae=_ne({opSnippet:`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${nq};\n  float a1 = ${rq};\n  float a2 = ${sq};\n  float a3 = ${aq};\n  float a4 = ${iq};\n  float a5 = ${oq};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`}),xae={kernelName:QD,backendName:"webgl",kernelFunc:bae},wae=_ne({opSnippet:Rne+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:ute,dtype:"float32"}),kae={kernelName:ZD,backendName:"webgl",kernelFunc:wae};function Sae(e){const{inputs:t,attrs:n,backend:r}=e,{dim:s}=n,{input:a}=t,i=a.shape.length,o=a.shape.slice();let l=s;return s<0&&(hO(-(i+1)<=s,(()=>`Axis must be in the interval [${-(i+1)}, ${i}]`)),l=i+s+1),o.splice(l,0,1),jne({inputs:{x:a},backend:r,attrs:{shape:o}})}const Iae={kernelName:eM,backendName:"webgl",kernelFunc:Sae},Cae="return exp(x) - 1.0;",Tae=_ne({opSnippet:Cae,packedOpSnippet:Cae,cpuKernelImpl:cte}),Nae={kernelName:tM,backendName:"webgl",kernelFunc:Tae};class Eae{constructor(e,t,n){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const s=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=n?`${r}.0`:"1.0";let i;if("real"===e)i="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);i="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${s};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${i}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${r});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${r}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${a};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}function Aae(e,t,n){const r=n.texData.get(e.dataId),s=mO(e.shape),a=e.shape[e.shape.length-1],i=jne({inputs:{x:e},backend:n,attrs:{shape:[s/a,a]}}),o=i.shape,l=new Eae("real",o,t),u=new Eae("imag",o,t),c=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:o},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:o}],d=n.runWebGLProgram(l,c,"float32"),h=n.runWebGLProgram(u,c,"float32"),p=kne({inputs:{real:d,imag:h},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h);const f=jne({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(p),f}const Rae={kernelName:nM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return Aae(r,!1,n)}};class _ae{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function $ae(e){const{backend:t,attrs:n}=e,{shape:r,value:s}=n;let{dtype:a}=n;if(a=a||RO(s),"string"===a){const e=CO(a,mO(r));return e.fill(s),t.makeTensorInfo(r,a,e)}{const e=new _ae(r,s),n=[[s]];return t.runWebGLProgram(e,[],a,n)}}const Oae={kernelName:rM,backendName:"webgl",kernelFunc:$ae};class Dae{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${t} - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${t}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const Mae={kernelName:sM,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{image:r}=t,s=n,a=new Dae(r.shape);return s.runWebGLProgram(a,[r],r.dtype)}},Fae="return floor(x);",Lae=_ne({opSnippet:Fae,packedOpSnippet:Fae,cpuKernelImpl:dte}),Pae={kernelName:aM,backendName:"webgl",kernelFunc:Lae},zae=$ne({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),Bae={kernelName:iM,backendName:"webgl",kernelFunc:zae};class jae{constructor(e){this.variableNames=["A"];const t=hee(),[n,r]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);\n\n        vec4 values = ${t.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class Uae{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=hee(),[n,r]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${r}.0, ${n}.0);\n            vec4 values = ${t.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${t.output} = result;\n      }\n    `}}const Vae={kernelName:rL,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:s}=t;const{numChannels:a}=r,i="undefined"!==typeof HTMLVideoElement&&s instanceof HTMLVideoElement,o="undefined"!==typeof HTMLImageElement&&s instanceof HTMLImageElement,[l,u]=i?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[u,l],d=[u,l,a];if(o||i){const e=HO().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=Wae&&e===Gae||(Gae=e,Wae=document.createElement("canvas").getContext("2d",{willReadFrequently:Gae})),Wae.canvas.width=l,Wae.canvas.height=u,Wae.drawImage(s,0,0,l,u),s=Wae.canvas}const h=n.makeTensorInfo(c,"int32");n.texData.get(h.dataId).usage=$7.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),s);const p=HO().getBool("WEBGL_PACK")?new Uae(d):new jae(d),f=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),f}};let Wae,Gae=HO().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const Hae={kernelName:iL,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a,bias:i,preluActivationWeights:o}=t,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,m=Hj(c),g=Fj(s.shape,a.shape,l,d,u,h,!1,m);let y;const v=[],b=null!=i,x=null!=o,w="leakyrelu"===p,k=()=>{const e=[s,a],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){const t=jne({inputs:{x:e},backend:n,attrs:{shape:[e.shape[0],1,1]}});return v.push(t),t}return e};if(b&&e.push(t(i,c)),x&&e.push(t(o,c)),w){const t=n.makeTensorInfo([],"float32",OL(f,"float32"));e.push(t),v.push(t)}return e};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===m&&HO().getBool("WEBGL_EXP_CONV")){const e=p?One(p,!0):null,t=new Sse(g,b,e,x,w),r=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],s=k();y=n.runWebGLProgram(t,s,"float32",r)}else if(HO().getBool("WEBGL_CONV_IM2COL"))y=Nse({x:s,filter:a,convInfo:g,backend:n,bias:i,activation:p,preluActivationWeights:o,leakyreluAlpha:f});else{const e=p?One(p,!1):null,t=new wse(g,b,e,x,w),r=k();y=n.runWebGLProgram(t,r,"float32")}else y=Tse({x:s,filter:a,convInfo:g,backend:n,bias:i,activation:p,preluActivationWeights:o,leakyreluAlpha:f});const S=jne({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return v.push(y),v.forEach((e=>n.disposeIntermediateTensorInfo(e))),S}};const qae={kernelName:oL,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,filter:a,bias:i,preluActivationWeights:o}=t,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r,f=[];let m=c;null==m&&(m=[1,1]),hO(Wj(l,m),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`));const g=Fj(s.shape,a.shape,l,m,u,d,!0),y=HO().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,v=h?One(h,y):null,b=[s,a],x=null!=i,w=null!=o,k="leakyrelu"===h;if(x&&b.push(i),w&&b.push(o),k){const e=n.makeTensorInfo([],"float32",OL(p,"float32"));b.push(e),f.push(e)}let S;S=y?new rae(g,x,v,w,k):new nae(g,x,v,w,k);const I=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],C=n.runWebGLProgram(S,b,"float32",I);return f.forEach((e=>n.disposeIntermediateTensorInfo(e))),C}};class Kae{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const s=Aee(n.length);let a="\n    int index;";for(let i=0;i<this.sliceDim;i++)a+=`\n          index = round(getIndices(coords[0], ${i}));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[i]};\n          flattenIndex += index * ${this.strides[i]};`;this.userCode=`\n         void main() {\n          ${s} coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ${a}\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      `}}const Xae={kernelName:uM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:s}=t,a=s.shape,i=a[a.length-1],o=mO(r.shape),[l,u,c,d]=ZH(r,s),h=jne({inputs:{x:s},backend:n,attrs:{shape:[u,i]}}),p=jne({inputs:{x:r},backend:n,attrs:{shape:[mO(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||"string"===r.dtype){const e=n.readSync(s.dataId),t=n.bufferSync(r),a=hte(e,t,r.dtype,u,i,c,d,r.shape,o);return n.makeTensorInfo(l,r.dtype,a.values)}const f=new Kae(i,d,[u,c],r.shape),m=n.runWebGLProgram(f,[p,h],p.dtype),g=jne({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}};class Yae{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=Aee(this.rank),r=function(e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<e.length;r++)2===r?n.push("index"):n.push(`${t[r]}`);return n.join()}(e);this.userCode=`\n      void main() {\n        ${n} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${r}));\n      }\n    `}}function Qae(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,indices:a}=t,{axis:i,batchDims:o}=r,l=kO(i,s.shape)[0];if(HO().get("DEBUG")){const e=n.readSync(a.dataId),t=s.shape[l];for(let n=0;n<e.length;++n){const r=e[n];hO(r<=t-1&&r>=0,(()=>`GatherV2: the index value ${r} is not in [0, ${t-1}]`))}}const u=jq(s,a,l,o),c=mO(a.shape),d=[],h=jne({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=jne({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(h),d.push(p);const f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,a])||"string"===s.dtype){const e=n.bufferSync(p),t=n.bufferSync(h),r=pte(t,e,f);return d.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(u.outputShape,r.dtype,r.values)}const m=new Yae(h.shape,f),g=n.runWebGLProgram(m,[h,p],h.dtype);d.push(g);const y=jne({inputs:{x:g},backend:n,attrs:{shape:u.outputShape}});return d.forEach((e=>n.disposeIntermediateTensorInfo(e))),y}const Jae={kernelName:lM,backendName:"webgl",kernelFunc:Qae},Zae=$ne({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:fte,dtype:"bool"}),eie={kernelName:cM,backendName:"webgl",kernelFunc:Zae},tie=$ne({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:mte}),nie={kernelName:dM,backendName:"webgl",kernelFunc:tie};const rie={kernelName:pM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return Aae(r,!0,n)}},sie=_ne({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),aie={kernelName:mM,backendName:"webgl",kernelFunc:sie},iie=_ne({opSnippet:"return float(isinf(x));",dtype:"bool"}),oie={kernelName:gM,backendName:"webgl",kernelFunc:iie},lie=_ne({opSnippet:"return float(isnan(x));",dtype:"bool"}),uie={kernelName:yM,backendName:"webgl",kernelFunc:lie},cie=$ne({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:gte,dtype:"bool"}),die={kernelName:bM,backendName:"webgl",kernelFunc:cie},hie=$ne({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:yte,dtype:"bool"}),pie={kernelName:xM,backendName:"webgl",kernelFunc:hie};const fie={kernelName:wM,backendName:"webgl",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:s,num:a}=n,i=vte(r,s,a);return t.makeTensorInfo([i.length],"float32",i)}},mie=_ne({opSnippet:Rne+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:bte}),gie={kernelName:kM,backendName:"webgl",kernelFunc:mie},yie=_ne({opSnippet:Rne+"\n  return log(1.0 + x);\n"}),vie={kernelName:SM,backendName:"webgl",kernelFunc:yie},bie=$ne({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),xie={kernelName:IM,backendName:"webgl",kernelFunc:bie},wie=_ne({opSnippet:"return float(!(x >= 1.0));"}),kie={kernelName:CM,backendName:"webgl",kernelFunc:wie},Sie=$ne({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),Iie={kernelName:TM,backendName:"webgl",kernelFunc:Sie};class Cie{constructor(e,t,n,r,s){this.variableNames=["x"],this.outputShape=[];const a=t,i=e[3]-1;let o;this.outputShape=e;const l=`float(${n}) + float(${r}) * sum`;o=.5===s?`inversesqrt(${l})`:1===s?`1.0/(${l})`:`exp(log(${l}) * float(-${s}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${a}; j <= ${a}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${i}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${o};\n        setOutput(val);\n      }\n    `}}class Tie{constructor(e,t,n,r,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=t,i=e[3]-1;let o;this.outputShape=e;const l=`float(${n}) + float(${r}) * sum`;o=.5===s?`inversesqrt(${l})`:1===s?`1.0/(${l})`:`exp(log(${l}) * float(-${s}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${a};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${a}; j <= ${a}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${i}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${o};\n        setOutput(result);\n      }\n    `}}const Nie={kernelName:NM,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{depthRadius:a,bias:i,alpha:o,beta:l}=r,u=HO().getBool("WEBGL_PACK_NORMALIZATION")?new Tie(s.shape,a,i,o,l):new Cie(s.shape,a,i,o,l);return n.runWebGLProgram(u,[s],s.dtype)}};class Eie{constructor(e,t,n,r,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=s,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${t})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${t} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${r}) * norm + float(${n});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${r})\n                * float(${s})\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${s});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}const Aie={kernelName:EM,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:s,y:a,dy:i}=t,{depthRadius:o,bias:l,alpha:u,beta:c}=r,d=new Eie(s.shape,o,l,u,c);return n.runWebGLProgram(d,[s,a,i],s.dtype)}};function Rie(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{reductionIndices:a,keepDims:i}=r,o=s.shape.length,l=kO(a,s.shape);let u=l;const c=qU(u,o),d=null!=c,h=n.shouldExecuteOnCPU([s]);let p=s;if(d){if(h){const e=n.texData.get(p.dataId).values,t=new Array(o);for(let n=0;n<t.length;n++)t[n]=s.shape[c[n]];const r=Kte(e,s.shape,s.dtype,c,t);p=n.makeTensorInfo(t,s.dtype);n.texData.get(p.dataId).values=r}else p=Kne(s,c,n);u=XU(u.length,o)}HU("max",u,o);const[f,m]=WU(p.shape,u);let g,y=f;if(i&&(y=GU(f,l)),h){const e=n.texData.get(p.dataId).values,t=xte(e,mO(m),y,s.dtype);g=n.makeTensorInfo(y,s.dtype);n.texData.get(g.dataId).values=t}else g=function(e,t,n,r){const s=mO(t),a=jne({inputs:{x:e},attrs:{shape:[mO(e.shape)/s,s]},backend:r}),i=Gne(a,e.dtype,"max",r),o=jne({inputs:{x:i},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(i),o}(p,m,y,n);return d&&n.disposeIntermediateTensorInfo(p),g}const _ie={kernelName:AM,backendName:"webgl",kernelFunc:Rie},$ie=$ne({opSnippet:gne+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+vne+"\n  return result;\n",cpuKernelImpl:wte}),Oie={kernelName:RM,backendName:"webgl",kernelFunc:$ie};const Die={kernelName:_M,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t;cee(s,"maxPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=r;hO(Wj(i,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '1'`));const u=Dj(s.shape,a,i,1,o,l);if(1===u.filterWidth&&1===u.filterHeight&&gO(u.inShape,u.outShape))return xne({inputs:{x:s},backend:n});const c=new $re(u,"max",!1);return n.runWebGLProgram(c,[s],s.dtype)}};const Mie={kernelName:OM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{filterSize:a,strides:i,pad:o,dataFormat:l,dimRoundingMode:u}=r,c=Mj(s.shape,a,i,[1,1,1],o,u,l),d=new Ore(c,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}};class Fie{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,s=e.effectiveFilterHeight,a=e.effectiveFilterWidth,i=s-1-e.padInfo.top,o=a-1-e.padInfo.left,l=s*a-1;this.userCode=`\n      const ivec2 pads = ivec2(${i}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${s};\n          wR += ${r}) {\n          float dyR = float(dyRCorner + wR) / ${t}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${a}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${n}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${a} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Lie{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,s=e.dilationDepth,a=e.dilationHeight,i=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=o-1-e.padInfo.front,d=l-1-e.padInfo.top,h=u-1-e.padInfo.left,p=o*l*u-1;this.userCode=`\n      const ivec3 pads = ivec3(${c}, ${d}, ${h});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${o};\n           wD += ${s}) {\n          float dyD = float(dyDCorner + wD) / ${t}.0;\n\n          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${l};\n              wR += ${a}) {\n            float dyR = float(dyRCorner + wR) / ${n}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${u};\n                wC += ${i}) {\n              float dyC = float(dyCCorner + wC) / ${r}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${p} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${l} * ${u} +\n                  wR * ${u} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const Pie={kernelName:DM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,input:a}=t,i=a,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,d=Mj(i.shape,o,l,[1,1,1],u,c),h=new Ore(d,"max",!0),p=n.runWebGLProgram(h,[i],i.dtype),f=new Lie(d),m=n.runWebGLProgram(f,[s,p],i.dtype);return n.disposeIntermediateTensorInfo(p),m}};const zie={kernelName:$M,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:s,input:a,output:i}=t,o=a;cee([a,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,h=Dj(o.shape,l,u,1,c,d),p=new $re(h,"max",!0),f=n.runWebGLProgram(p,[o],o.dtype),m=new Fie(h),g=n.runWebGLProgram(m,[s,f],o.dtype);return n.disposeIntermediateTensorInfo(f),g}};const Bie={kernelName:MM,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:s}=t,{filterSize:a,strides:i,pad:o,includeBatchInIndex:l}=n,u=r;hO(4===s.shape.length,(()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`));const c=[1,1];hO(Wj(i,c),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`));const d=Dj(s.shape,a,i,c,o),[h,p]=function(e,t,n,r){let s=new $re(n,"max",!1);const a=r.runWebGLProgram(s,[e],"float32");return s=new $re(n,"max",!0,!0,t),[a,r.runWebGLProgram(s,[e],"float32")]}(s,l,d,u);return[h,p]}};const jie={kernelName:FM,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:s}=t,{keepDims:a,axis:i}=n,o=r,l=s.shape.length,u=kO(i,s.shape);let c=u;const d=qU(c,l),h=null!=d,p=o.shouldExecuteOnCPU([s]),f=[];let m=s;if(h){if(p){const e=o.texData.get(m.dataId).values,t=new Array(l);for(let r=0;r<t.length;r++)t[r]=s.shape[d[r]];const n=Kte(e,s.shape,s.dtype,d,t);m=o.makeTensorInfo(t,s.dtype);o.texData.get(m.dataId).values=n}else m=Kne(s,d,o);f.push(m),c=XU(c.length,l)}HU("sum",c,l);const[g,y]=WU(m.shape,c);let v=g;a&&(v=GU(g,u));const b=function(e,t,n,r){const s=mO(t),a=jne({inputs:{x:e},attrs:{shape:[mO(e.shape)/s,s]},backend:r}),i=Gne(a,"float32","mean",r),o=jne({inputs:{x:i},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(i),o}(m,y,v,o);for(const x of f)o.disposeIntermediateTensorInfo(x);return b}};const Uie={kernelName:LM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r,o=s.shape.length,l=kO(a,s.shape);let u=l;const c=qU(u,o);let d=s;null!=c&&(d=Qne({inputs:{x:s},backend:n,attrs:{perm:c}}),u=XU(u.length,s.shape.length)),HU("min",u,o);const[h,p]=WU(d.shape,u),f=jne({inputs:{x:d},backend:n,attrs:{shape:[-1,mO(p)]}}),m=Gne(f,f.dtype,"min",n);let g;if(i){g=jne({inputs:{x:m},backend:n,attrs:{shape:GU(h,l)}})}else g=jne({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=c&&n.disposeIntermediateTensorInfo(d),g}},Vie=$ne({opSnippet:gne+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+vne+"\n  return result;\n",cpuKernelImpl:kte}),Wie={kernelName:PM,backendName:"webgl",kernelFunc:Vie};class Gie{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,s=Aee(r),a=t.map((e=>e[0])).join(","),i=t.map(((t,n)=>t[0]+e[n])).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l="reflect"===n?0:1;this.userCode=1!==r?`\n      ${s} start = ${s}(${a});\n      ${s} end = ${s}(${i});\n\n      void main() {\n        ${s} outC = getOutputCoords();\n        for (int i = 0; i < ${r}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${l};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};\n          }\n        }\n        ${s} coords = outC - start;\n        setOutput(getX(${o}));\n      }\n    `:`\n        int start = ${a};\n        int end = ${i};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${l};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${l};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}class Hie{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,s=Aee(r),a=t.map((e=>e[0])).join(","),i=t.map(((t,n)=>t[0]+e[n])).join(","),o=Qte("rc",r),l=Qte("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${l.slice(-2).join()})`,d="reflect"===n?0:1;let h="";if(1===r){const e=`\n        ${s} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${d};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${d};\n        }\n        source -= start;\n      `;h=`\n        ${s} rc = outputLoc;\n        ${e}\n        result[0] = getChannel(getX(${l.join()}), ${c});\n        ${o[r-1]} += 1;\n        if(${u}) {\n          ${e}\n          result[1] = getChannel(getX(${l.join()}), ${c});\n        }\n      `}else{const e=`\n        ${s} source = rc;\n        ${s} lt = ${s}(lessThan(source, start));\n        ${s} gte = ${s}(greaterThanEqual(source, end));\n        ${s} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${d}) +\n                gte * ((end - 1) * 2 - source + ${d});\n        source -= start;\n      `;h=`\n        ${s} rc = outputLoc;\n        ${e}\n        result[0] = getChannel(getX(${l.join()}), ${c});\n        ${o[r-1]} += 1;\n        if(${u}) {\n          ${e}\n          result[1] = getChannel(getX(${l.join()}), ${c});\n        }\n        rc = outputLoc;\n        ${o[r-2]} += 1;\n        if(${o[r-2]} < ${this.outputShape[r-2]}) {\n          ${e}\n          result[2] = getChannel(getX(${l.join()}), ${c});\n          ${o[r-1]} += 1;\n          if(${u}) {\n            ${e}\n            result[3] = getChannel(getX(${l.join()}), ${c});\n          }\n        }\n      `}this.userCode=`\n      const ${s} start = ${s}(${a});\n      const ${s} end = ${s}(${i});\n\n      void main() {\n        ${s} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${h}\n        setOutput(result);\n      }\n    `}}const qie={kernelName:zM,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:s}=t,{paddings:a,mode:i}=r,o=HO().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hie(s.shape,a,i):new Gie(s.shape,a,i);return n.runWebGLProgram(o,[s],s.dtype)}},Kie=$ne({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+vne+"\n  return result;\n"}),Xie={kernelName:BM,backendName:"webgl",kernelFunc:Kie};class Yie{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${t-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${t-1}));\n      }\n    `}}const Qie=$ne({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),Jie={kernelName:qD,backendName:"webgl",kernelFunc:Qie},Zie="return a - b;",eoe=$ne({opSnippet:Zie,packedOpSnippet:Zie,supportsComplex:!0,cpuKernelImpl:Gte}),toe={kernelName:GF,backendName:"webgl",kernelFunc:eoe};function noe(e){const{inputs:t,backend:n,attrs:r}=e,{logits:s}=t,{dim:a}=r,i=kO([a],s.shape),o=Rie({inputs:{x:s},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=GU(o.shape,i),u=jne({inputs:{x:o},backend:n,attrs:{shape:l}}),c=eoe({inputs:{a:s,b:u},backend:n}),d=wae({inputs:{x:c},backend:n}),h=Xne({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),p=jne({inputs:{x:h},backend:n,attrs:{shape:l}}),f=Qie({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}const roe={kernelName:$F,backendName:"webgl",kernelFunc:noe};const soe={kernelName:jM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:s}=t,{numSamples:a,seed:i,normalized:o}=r,l=o?s:noe({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new Yie(u,c,a),h=[[i]],p=n.runWebGLProgram(d,[l],"int32",h);return o||n.disposeIntermediateTensorInfo(l),p}},aoe=ane+"\n  return -x;\n";const ioe={kernelName:VM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const e=n.texData.get(r.dataId),[t,s]=Ite(e.values,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,t)}let s;return s=HO().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new cne(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new sne(r.shape,aoe),n.runWebGLProgram(s,[r],r.dtype)}},ooe=YG;const loe={kernelName:GM,backendName:"webgl",kernelFunc:function(e){lL("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:s,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(a.dataId),{selectedIndices:d}=ooe(u,c,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},uoe=QG;const coe={kernelName:HM,backendName:"webgl",kernelFunc:function(e){lL("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:s,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(s.dataId),d=n.readSync(a.dataId),{selectedIndices:h,validOutputs:p}=uoe(c,d,i,o,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},doe=JG;const hoe={kernelName:qM,backendName:"webgl",kernelFunc:function(e){lL("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:s,scores:a}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(a.dataId),h=i,p=o,f=l,m=u,{selectedIndices:g,selectedScores:y}=doe(c,d,h,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};class poe{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${r}), float(${n}),\n                      float(index == coords.y)));\n      }\n    `}}const foe={kernelName:XM,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:s}=t,{dtype:a,depth:i,onValue:o,offValue:l}=r,u=mO(s.shape),c=new poe(u,i,o,l),d=jne({inputs:{x:s},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[d],a);n.disposeIntermediateTensorInfo(d);const p=jne({inputs:{x:h},backend:n,attrs:{shape:[...s.shape,i]}});return n.disposeIntermediateTensorInfo(h),p}};function moe(e){const{inputs:t,backend:n}=e,{x:r}=t;if("complex64"===r.dtype){const e=tse({inputs:{input:r},backend:n}),t=moe({inputs:{x:e},backend:n}),s=gse({inputs:{input:r},backend:n}),a=moe({inputs:{x:s},backend:n}),i=kne({inputs:{real:t,imag:a},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),i}return $ae({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const goe={kernelName:tL,backendName:"webgl",kernelFunc:moe};const yoe={kernelName:KM,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:s}=n;if("string"===s.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===s.dtype){const t=tse({inputs:{input:s},backend:r}),n=e({inputs:{x:t},backend:r}),a=gse({inputs:{input:s},backend:r}),i=moe({inputs:{x:a},backend:r}),o=kne({inputs:{real:n,imag:i},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(i),o}return $ae({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:r})}};const voe={kernelName:YM,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:s}=r;if(1===t.length)return Sae({inputs:{input:t[0]},backend:n,attrs:{dim:s}});const a=t[0].shape,i=t[0].dtype;t.forEach((e=>{pO(a,e.shape,"All tensors passed to stack must have matching shapes"),hO(i===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const o=[],l=bse({inputs:t.map((e=>{const t=Sae({inputs:{input:e},backend:n,attrs:{dim:s}});return o.push(t),t})),backend:n,attrs:{axis:s}});return o.forEach((e=>n.disposeIntermediateTensorInfo(e))),l}};class boe{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,s=Aee(r),a=t.map((e=>e[0])).join(","),i=t.map(((t,n)=>t[0]+e[n])).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?`\n      ${s} start = ${s}(${a});\n      ${s} end = ${s}(${i});\n\n      void main() {\n        ${s} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${s} coords = outC - start;\n          setOutput(getX(${o}));\n        }\n      }\n    `:`\n        int start = ${a};\n        int end = ${i};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class xoe{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,s=Aee(r),a=t.map((e=>e[0])).join(","),i=t.map(((t,n)=>t[0]+e[n])).join(","),o=Qte("rc",r),l=Qte("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${l.slice(-2).join()})`,d=[`${s} rc = outputLoc;`,`${o[r-1]} += 1;\n       if(${u}) {\n      `,1===r?"":`}\n       rc = outputLoc;\n       ${o[r-2]} += 1;\n       if(${o[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${o[r-1]} += 1;\n         if(${u}) {`],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,m=1===r?2:4;f<m;f++)p+=`\n        ${d[f]}\n        if (${h}) {\n          result[${f}] = float(value);\n        } else {\n          ${s} source = rc - start;\n          result[${f}] = getChannel(getX(${l.join()}), ${c});\n        }\n      `;p+=1===r?"} ":"}}",this.userCode=`\n      const ${s} start = ${s}(${a});\n      const ${s} end = ${s}(${i});\n\n      void main() {\n        ${s} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}const woe=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{paddings:a,constantValue:i}=r;if(0===mO(s.shape)){return $ae({backend:n,attrs:{shape:a.map(((e,t)=>e[0]+s.shape[t]+e[1])),value:i,dtype:s.dtype}})}const o=HO().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xoe(s.shape,a,i):new boe(s.shape,a,i),l=[[i]];return n.runWebGLProgram(o,[s],s.dtype,l)},koe={kernelName:QM,backendName:"webgl",kernelFunc:woe},Soe=$ne({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+vne+"\n  return result;\n"}),Ioe={kernelName:JM,backendName:"webgl",kernelFunc:Soe};const Coe={kernelName:eF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{axis:a,keepDims:i}=r,o=s.shape.length,l=[],u=kO(a,s.shape);let c=u;const d=qU(c,o);let h,p=s;if(null!=d&&(p=Qne({inputs:{x:s},backend:n,attrs:{perm:d}}),c=XU(c.length,o),l.push(p)),HU("prod",c,o),n.shouldExecuteOnCPU([p])){const e=n.texData.get(p.dataId).values,{outVals:t,outShape:r,outDtype:s}=Tte(p.shape,p.dtype,e,c);h=n.makeTensorInfo(r,s,t)}else{const[e,t]=WU(p.shape,c),r=mO(t),a=jne({inputs:{x:p},backend:n,attrs:{shape:[-1,r]}}),i=Gne(a,pP(s.dtype),"prod",n);h=jne({inputs:{x:i},backend:n,attrs:{shape:e}}),l.push(a),l.push(i)}if(i){l.push(h);const e=GU(h.shape,u);h=jne({inputs:{x:h},backend:n,attrs:{shape:e}})}return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),h}};const Toe={kernelName:tF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:s,paramsDenseValues:a,indices:i}=t,{outputRaggedRank:o}=r,l=s.map((e=>n.readSync(e.dataId))),u=s.map((e=>e.shape)),c=n.readSync(a.dataId),d=n.readSync(i.dataId),[h,p,f]=Nte(l,u,c,a.shape,a.dtype,d,i.shape,o),m=h.map((e=>n.makeTensorInfo([e.length],"int32",e))),g=n.makeTensorInfo(f,a.dtype,p);return m.concat([g])}};const Noe={kernelName:nF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:s,deltas:a}=t,i=n.readSync(r.dataId),o=n.readSync(s.dataId),l=n.readSync(a.dataId),[u,c]=Ete(i,r.shape,r.dtype,o,s.shape,l,a.shape);return[n.makeTensorInfo([u.length],"int32",u),n.makeTensorInfo([c.length],r.dtype,c)]}};const Eoe={kernelName:rF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:s,values:a,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,u=n.readSync(s.dataId),c=n.readSync(a.dataId),d=n.readSync(i.dataId),h=o.map((e=>n.readSync(e.dataId))),p=o.map((e=>e.shape)),[f,m]=Ate(u,s.shape,c,a.shape,a.dtype,d,i.shape,h,p,l);return n.makeTensorInfo(f,a.dtype,m)}},Aoe=e=>{const{backend:t,attrs:n}=e,{start:r,stop:s,step:a,dtype:i}=n,o=Rte(r,s,a,i);return t.makeTensorInfo([o.length],i,o)},Roe={kernelName:sF,backendName:"webgl",kernelFunc:Aoe},_oe=_ne({opSnippet:"return 1.0 / x;"}),$oe={kernelName:iF,backendName:"webgl",kernelFunc:_oe},Ooe=_ne({opSnippet:ane+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Doe={kernelName:oF,backendName:"webgl",kernelFunc:Ooe},Moe=_ne({opSnippet:ane+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Foe={kernelName:pF,backendName:"webgl",kernelFunc:Moe};class Loe{constructor(e,t,n,r,s){this.variableNames=["A"],this.outputShape=[];const[a,i,o,l]=e;this.outputShape=[a,t,n,l];const u=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];let d;d=s?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${i}.0, ${o}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${d};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class Poe{constructor(e,t,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,i,o,l]=e;this.outputShape=[a,t,n,l];const u=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];let d;d=s?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]},\n          ${u[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${i}.0, ${o}.0,\n                                     ${o}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${d};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}const zoe={kernelName:dF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:s}=t,{alignCorners:a,halfPixelCenters:i,size:o}=r,[l,u]=o,c=HO().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Poe(s.shape,l,u,a,i):new Loe(s.shape,l,u,a,i);return n.runWebGLProgram(c,[s],"float32")}};class Boe{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,s]=t,[,a,i]=e,o=[n&&a>1?r-1:r,n&&i>1?s-1:s],l=[n&&a>1?a-1:a,n&&i>1?i-1:i],u=o[0]/l[0],c=o[1]/l[1],d=1/u,h=1/c,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${d});\n        const float invWidthScale = float(${h});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${a}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${i}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const joe={kernelName:hF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:s,dy:a}=t,{alignCorners:i}=r,o=new Boe(a.shape,s.shape,i);return n.runWebGLProgram(o,[a],a.dtype)}};class Uoe{constructor(e,t,n,r,s){this.variableNames=["A"],this.outputShape=[];const[a,i,o,l]=e;this.outputShape=[a,t,n,l];const u=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0";let h;h=s?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${i}.0, ${o}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${h};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}class Voe{constructor(e,t,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,i,o,l]=e;this.outputShape=[a,t,n,l];const u=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0";let h;h=s?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]},\n          ${u[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${i}.0, ${o}.0,\n                                     ${o}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${h};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `}}const Woe={kernelName:uF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:s}=t,{alignCorners:a,halfPixelCenters:i,size:o}=r,[l,u]=o,c=HO().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Voe(s.shape,l,u,a,i):new Uoe(s.shape,l,u,a,i);return n.runWebGLProgram(c,[s],s.dtype)}};class Goe{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,s]=t,[,a,i]=e,o=[n&&a>1?r-1:r,n&&i>1?s-1:s],l=[n&&a>1?a-1:a,n&&i>1?i-1:i],u=o[0]/l[0],c=o[1]/l[1],d=1/u,h=1/c,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${d});\n        const float invWidthScale = float(${h});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${a}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${i}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${o[0]}) *\n                (float(dyR) / float(${l[0]}));\n\n            float sourceFracCol =\n                float(${o[1]}) *\n                  (float(dyC) / float(${l[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${r}) - 1),\n                ${n} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${s}) - 1),\n                ${n} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const Hoe={kernelName:cF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:s,dy:a}=t,{alignCorners:i}=r,o=new Goe(a.shape,s.shape,i);return n.runWebGLProgram(o,[a],a.dtype)}};class qoe{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${e[0]} - coord - 1));\n        }\n      `);const r=e.map(((n,r)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - coords[${n}] - 1`:`coords[${n}]`)(r))).join(","),s=Aee(n);this.userCode=`\n      void main() {\n        ${s} coords = getOutputCoords();\n        setOutput(getX(${r}));\n      }\n    `}}class Koe{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;const r=Qte("rc",n),s=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,a=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,i=Aee(n);function o(n){const r=e.map(((r,s)=>function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - ${r[n]} - 1`:`${r[n]}`}(s,n)));return`getChannel(getX(${r.join(",")}), vec2(${r.slice(-2).join(",")}))`}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${e[0]} - rc - 1),\n            ${e[0]} - rc - 1);\n          if(${s}){\n              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),\n                ${e[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${i} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(e){return o(e)}(r.slice())};\n          if(${s}){\n            result.g = ${function(e){return e[n-1]="("+e[n-1]+" + 1)",o(e)}(r.slice())};\n          }\n          if(${a}) {\n            result.b = ${function(e){return e[n-2]="("+e[n-2]+" + 1)",o(e)}(r.slice())};\n            if(${s}) {\n              result.a = ${function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",o(e)}(r.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}const Xoe={kernelName:fF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{dims:a}=r,i=s.shape.length,o=kO(a,s.shape);if(0===i)return xne({inputs:{x:s},backend:n});const l=HO().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Koe(s.shape,o):new qoe(s.shape,o);return n.runWebGLProgram(l,[s],s.dtype)}};class Yoe{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],r=e[2];this.outputShape=e;let s="";s="number"===typeof t?`float outputValue = ${t.toFixed(2)};`:`\n        vec3 fill = vec3(${t.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ${s}\n          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const Qoe={kernelName:sL,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:s}=t,{radians:a,fillValue:i,center:o}=n,l=r,u=new Yoe(s.shape,i),[c,d]=qH(o,s.shape[1],s.shape[2]),h=[[c,d,Math.sin(a),Math.cos(a)]];return l.runWebGLProgram(u,[s],s.dtype,h)}},Joe=_ne({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),Zoe={kernelName:mF,backendName:"webgl",kernelFunc:Joe},ele=_ne({opSnippet:"return inversesqrt(x);",cpuKernelImpl:_te}),tle={kernelName:gF,backendName:"webgl",kernelFunc:ele};class nle{constructor(e,t,n,r,s,a){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const o=Aee(s.length),l=Aee(a.length);let u="";1===n?u="i":2===n&&(u="i, j");const c=`getIndices(${u})`;let d="";1===r?d="i":2===r&&(d="i, coords[1]");const h=`getUpdates(${d})`;let p="";i&&(p="coords[0], coords[1]");const f=`getDefaultValue(${p})`,m=t>1?"strides[j]":"strides";this.userCode=`\n        ${o} strides = ${o}(${s});\n\n        void main() {\n          ${l} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${e}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${t}; j++) {\n              int index = round(${c});\n              flattenedIndex += index * ${m};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ${h};\n              found = true;\n            }\n          }\n          setOutput(mix(${f}, sum, float(found)));\n        }\n      `}}class rle{constructor(e,t,n,r,s,a){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;const o=Aee(s.length),l=Aee(a.length);let u="";1===n?u="i":2===n&&(u="i, j");const c=`getIndices(${u})`;let d="";1===r?d="i":2===r&&(d="i, coords[1]");const h=`getUpdates(${d})`;let p="";i&&(p="coords[0], coords[1]");const f=`getDefaultValue(${p})`,m=t>1?"strides[j]":"strides",g=t>1?"strides[j + 1]":"strides";this.userCode=`\n        ${o} strides = ${o}(${s});\n\n        void main() {\n          ${l} coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ${e}; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ${t}; j+=2) {\n              ivec4 index = round(${c});\n              flattenedIndex += index.xz * ${m};\n              if (j + 1 < ${t}) {\n                flattenedIndex += index.yw * ${g};\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ${h};\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(${f}, sum, found));\n        }\n      `}}const sle={kernelName:yF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:s,updates:a}=t,{shape:i}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=iG(0,s,i),h=[d/u,u];if(0===d)return n.makeTensorInfo(i,s.dtype);const p=jne({inputs:{x:s},backend:n,attrs:{shape:[l,o]}}),f=jne({inputs:{x:a},backend:n,attrs:{shape:[l,u]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;g=HO().getBool("WEBGL_PACK")?new rle(l,o,p.shape.length,f.shape.length,c,h):new nle(l,o,p.shape.length,f.shape.length,c,h);const y=n.runWebGLProgram(g,[f,p,m],f.dtype),v=jne({inputs:{x:y},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),v}};class ale{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const s=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,a=2===HO().getNumber("WEBGL_VERSION")?"while (left < right) {":s,i="left"===r?"<":"<=";this.userCode=`\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ${a}\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ${i} value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     `}}const ile={kernelName:bF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:s,values:a}=t,{side:i}=r,o=new ale(s.shape[0],s.shape[1],a.shape[1],i),l=[[s.shape[1]]];return n.runWebGLProgram(o,[s,a],"int32",l)}};class ole{constructor(e,t,n){let r,s;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)s="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],i=[];for(let r=0;r<t.length;r++)i.push(`${n[r]}`),r<e&&a.push(`${n[r]}`);r=a.join(),s=i.join()}const a=Aee(n);this.userCode=`\n      void main() {\n        ${a} resRC = getOutputCoords();\n        float cVal = getC(${r});\n        if (cVal >= 1.0) {\n          setOutput(getA(${s}));\n        } else {\n          setOutput(getB(${s}));\n        }\n      }\n    `}}const lle={kernelName:xF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:s,e:a}=t,i=new ole(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(i,[r,s,a],hP(s.dtype,a.dtype))}},ule=_ne({opSnippet:`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${eq};\n  float scale = ${tq};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`}),cle={kernelName:wF,backendName:"webgl",kernelFunc:ule},dle=_ne({opSnippet:Rne+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:Ote}),hle={kernelName:TF,backendName:"webgl",kernelFunc:dle},ple=_ne({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),fle={kernelName:CF,backendName:"webgl",kernelFunc:ple},mle=_ne({opSnippet:Rne+"\n  return sin(x);\n",packedOpSnippet:`\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ${vne}\n  return result;\n`}),gle={kernelName:SF,backendName:"webgl",kernelFunc:mle},yle=_ne({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),vle={kernelName:IF,backendName:"webgl",kernelFunc:yle},ble=_ne({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),xle={kernelName:NF,backendName:"webgl",kernelFunc:ble},wle={kernelName:RF,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{blockShape:a,paddings:i}=r;hO(s.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const o=a.reduce(((e,t)=>e*t)),l=[[0,0]];l.push(...i);for(let y=1+a.length;y<s.shape.length;++y)l.push([0,0]);const u=[],c=woe({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),d=KH(c.shape,a,o,!1),h=XH(d.length,a.length,!1),p=YH(c.shape,a,o,!1),f=jne({inputs:{x:c},backend:n,attrs:{shape:d}}),m=Qne({inputs:{x:f},backend:n,attrs:{perm:h}}),g=jne({inputs:{x:m},backend:n,attrs:{shape:p}});return u.push(c),u.push(f),u.push(m),u.forEach((e=>n.disposeIntermediateTensorInfo(e))),g}};const kle={kernelName:OF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:s,denseShape:a,defaultValue:i}=t;if(1!==a.shape.length)throw new Error(`Dense shape must be a vector, saw:\n         ${a.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n         ${r.shape}`);if(1!==s.shape.length)throw new Error(`Values must be a vector, saw:\n         ${s.shape}`);if(0!==i.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${i.shape}`);const o=n.readSync(r.dataId),l=n.readSync(s.dataId),u=n.readSync(a.dataId),c=n.readSync(i.dataId)[0],[d,h,p,f,m]=Fte(o,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],s.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};const Sle={kernelName:DF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:s,newShape:a}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(1!==s.shape.length)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(1!==a.shape.length)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(n.readSync(s.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(a.dataId)),[u,c,d]=Lte(o,r.shape,r.dtype,i,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}};const Ile={kernelName:MF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:s,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error(`Indices should be a vector but received shape\n              ${s.shape}`);if(1!==a.shape.length)throw new Error(`Segment ids should be a vector but received shape\n              ${a.shape}`);const i=n.readSync(r.dataId),o=n.readSync(s.dataId),l=n.readSync(a.dataId),[u,c]=Pte(i,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(c,r.dtype,u)}};const Cle={kernelName:FF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:s,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error(`Indices should be a vector but received shape\n             ${s.shape}`);if(1!==a.shape.length)throw new Error(`Segment ids should be a vector but received shape\n             ${a.shape}`);const i=n.readSync(r.dataId),o=n.readSync(s.dataId),l=n.readSync(a.dataId),[u,c]=Pte(i,r.shape,r.dtype,o,l);return n.makeTensorInfo(c,r.dtype,u)}};const Tle={kernelName:LF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:s,sparseValues:a,defaultValue:i}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=iG(0,s,o),p=!1;if("string"===a.dtype){const e=n.bufferSync(s),t=n.bufferSync(a),r=LL(n.readSync(i.dataId)[0]),f=$te(e,t,o,h,c,u,l,d,r,p);return n.makeTensorInfo(o,f.dtype,f.values)}const f=new nle(u,l,s.shape.length,a.shape.length,d,[h,1],p),m=n.runWebGLProgram(f,[a,s,i],a.dtype),g=jne({inputs:{x:m},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(m),g}};const Nle={kernelName:_F,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{numOrSizeSplits:a,axis:i}=r,o=kO(i,s.shape)[0],l=Tq(s,a,o),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map((e=>{const t=[...d];t[o]=e;const r=qre({inputs:{x:s},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,r}))}},Ele="return sqrt(x);",Ale=_ne({opSnippet:Ele,packedOpSnippet:Ele,cpuKernelImpl:zte}),Rle={kernelName:EF,backendName:"webgl",kernelFunc:Ale},_le={kernelName:zF,backendName:"webgl",kernelFunc:_ne({opSnippet:"return x * x;"})},$le="return (a - b) * (a - b);",Ole=$ne({opSnippet:$le,packedOpSnippet:$le}),Dle={kernelName:PF,backendName:"webgl",kernelFunc:Ole};const Mle={kernelName:BF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");const a=Uq(n.readSync(s.dataId)),i=Bte(a,"string",r);return n.makeTensorInfo(s.shape,"string",i)}};const Fle={kernelName:nL,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e;const{x:s}=t,a=ane+`\n    return x > 0.0 ? 1.0 : float(${n.alpha});\n  `,i=new sne(s.shape,a);return r.runWebGLProgram(i,[s],s.dtype)}};class Lle{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,s=Aee(n.length),a=Aee(n.length);let i="";if(1===r)i="coords * strides + begin";else{let e=0;i=n.map(((t,r)=>(e++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${e-1}] * strides[${r}] + begin[${r}]`))).join(",")}this.userCode=`\n      ${s} begin = ${s}(${e});\n      ${s} strides = ${s}(${t});\n\n      void main() {\n        ${a} coords = getOutputCoords();\n        setOutput(getX(${i}));\n      }\n    `}}const Ple={kernelName:jF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{begin:a,end:i,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:x}=bj(s.shape,a,i,o,l,u,c,d,h);let w;if(m)w=jne({inputs:{x:s},backend:n,attrs:{shape:f}});else if(g||y){hO(s.shape.length>=1,(()=>`Input must have rank at least 1, got: ${s.shape.length}`));const e=ij(v,b,x),t=qre({inputs:{x:s},backend:n,attrs:{begin:v,size:e}});w=jne({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{if(n.shouldExecuteOnCPU([s])){const e=n.readSync(s.dataId),t=Qz(s.shape,s.dtype,e),r=jte(p,t,x,v);w=n.makeTensorInfo(f,s.dtype,r.values)}else{const e=new Lle(v,x,p);w=n.runWebGLProgram(e,[s],s.dtype)}}const k=jne({inputs:{x:w},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(w),k}};const zle={kernelName:UF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:s,nGramWidths:a,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=t,h=n.readSync(c.dataId),p=n.readSync(d.dataId),[f,m]=Ute(h,p,s,a,i,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}};const Ble={kernelName:VF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:s}=r,{input:a,delimiter:i}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(0!==i.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=n.readSync(a.dataId),l=n.readSync(i.dataId)[0],[u,c,d]=Vte(o,l,s),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};const jle={kernelName:WF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:s}=r,{input:a}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(a.dataId),o=Wte(i,s);return n.makeTensorInfo(a.shape,"int32",o)}},Ule=_ne({opSnippet:"return tan(x);"}),Vle={kernelName:HF,backendName:"webgl",kernelFunc:Ule},Wle=_ne({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),Gle={kernelName:qF,backendName:"webgl",kernelFunc:Wle};const Hle={kernelName:vF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:s,indices:a,updates:i}=t,{}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=iG(0,a,s.shape),h=[d/u,u];if(0===d)return n.makeTensorInfo(s.shape,a.dtype);const p=jne({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),f=jne({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),m=jne({inputs:{x:s},backend:n,attrs:{shape:h}}),g=new nle(l,o,p.shape.length,f.shape.length,c,h,!1,!0),y=n.runWebGLProgram(g,[f,p,m],m.dtype),v=jne({inputs:{x:y},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),v}};class qle{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[a]*t[a];this.outputShape=n,this.rank=n.length;const r=Aee(this.rank),s=function(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(1===t)return`imod(resRC, ${e[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<e.length;s++)r.push(`imod(${n[s]}, ${e[s]})`);return r.join()}(e);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        setOutput(getA(${s}));\n      }\n    `}}function Kle(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{reps:a}=r;if("string"===s.dtype||s.shape.length>5){const e=n.readSync(s.dataId),t="string"===s.dtype?e.map((e=>LL(e))):e,r=Qz(s.shape,s.dtype,t),i=Hte(r,a);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const i=new qle(s.shape,a);return n.runWebGLProgram(i,[s],s.dtype)}const Xle={kernelName:KF,backendName:"webgl",kernelFunc:Kle};class Yle{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class Qle{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function Jle(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function Zle(e){let t=1;for(;t<e;)t*=2;return t}const eue={kernelName:XF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s}=t,{k:a,sorted:i}=r,o=HO().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=HO().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([s])||c<o||a>l){const e=n.readSync(s.dataId),[t,r]=qte(e,u,s.dtype,a,i);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===a)return u[u.length-1]=0,[n.makeTensorInfo(u,s.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(1===c)return[s,$ae({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),h=null!==d&&d.isPacked,p=h?n.unpackTensor(s):s,f=mO(u)/c,m=jne({inputs:{x:p},attrs:{shape:[f,c]},backend:n});h&&Jle(n,p);const g=Zle(a),y=Zle(c);let v=null;const b=()=>null===v?[m,m]:[m,v],x=(e,t,r)=>{const s=b(),a=new Yle(r),i=[[c],[null===v?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],o=v;v=n.runWebGLProgram(a,s,"int32",i),Jle(n,o)};for(let C=1;C<g;C*=2){const e=2*C;for(let t=C;t>=1;t/=2)x(e,t,[f,y])}for(let C=y;C>g;C/=2){const e=b(),t=new Qle([f,C/2]),r=[[c],[null===v?1:0],[g]],s=v;v=n.runWebGLProgram(t,e,"int32",r),Jle(n,s);const a=g/2,i=2*a;for(let n=a;n>=1;n/=2)x(i,n,v.shape)}let w=v;v=qre({inputs:{x:v},backend:n,attrs:{begin:0,size:[f,a]}}),Jle(n,w);let k=Qae({inputs:{x:m,indices:v},backend:n,attrs:{axis:1,batchDims:1}});Jle(n,m);const S=u.slice(0,-1);S.push(a),w=v,v=jne({inputs:{x:v},attrs:{shape:S},backend:n}),Jle(n,w);const I=k;return k=jne({inputs:{x:k},attrs:{shape:S},backend:n}),Jle(n,I),[k,v]}};class tue{constructor(e,t,n,r,s,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const i="nearest"===n?1:2;let o;switch(r){case"constant":default:o=1;break;case"reflect":o=2;break;case"wrap":o=3;break;case"nearest":o=4}this.userCode=`\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(${o} == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${o} == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${o} == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(${s});\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(${s});\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(${t}));\n                float mapY = mapCoord(inY, float(${e}));\n\n                if (${i} == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        `}}const nue={kernelName:YF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:s,transforms:a}=t,{interpolation:i,fillMode:o,fillValue:l,outputShape:u}=r,[c,d,h,p]=s.shape,[f,m]=null!=u?u:[d,h],g=new tue(d,h,i,o,l,[c,f,m,p]);return n.runWebGLProgram(g,[s,a],"float32")}};const rue={kernelName:JF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:s}=n,{x:a}=t;cee(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=r.readSync(a.dataId),{outputValues:o,outputShape:l,indices:u}=Xte(i,s,a.shape,a.dtype);return[r.makeTensorInfo(l,a.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}};const sue={kernelName:ZF,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:s}=t;let{axis:a}=r;a<0&&(a+=s.shape.length);const i=s,o=i.shape.length,l=s.shape[a],u=new Array(o-1);let c=0;for(let m=0;m<o;m++)m!==a&&(u[c++]=i.shape[m]);const d=[],h=new Array(o).fill(0),p=i.shape.slice();p[a]=1;const f=new Array(l);for(let m=0;m<f.length;m++){h[a]=m;const e=qre({inputs:{x:i},backend:n,attrs:{begin:h,size:p}}),t=jne({inputs:{x:e},backend:n,attrs:{shape:u}});f[m]=t,d.push(e)}return d.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}};class aue{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,r=e.batchSize,s=e.inSize,a=e.numSegments,i=a*Math.ceil(s/n);this.outputShape=[r,i];const o=4*Math.floor(n/4),l=n%4,u="\n        sumValue += dot(values, segFilter);\n    ";let c="";s%n>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return initializationValue;\n        }\n      `);let d="";s%n>0&&(d=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${c}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${d}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${a})) * float(${n}));\n        int currentSeg = int(mod(float(outIdx), float(${a})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${o}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${o};\n        if (${1===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${u}\n        } else if (${2===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${u}\n        } else if (${3===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}const iue=[ere,nre,sre,ire,ure,hre,pre,fre,xre,wre,Sre,Cre,Nre,Are,_re,Dre,Mre,Pre,zre,Bre,Vre,Xre,Yre,Qre,Jre,rse,ise,use,Sne,hse,xse,Ese,Ose,Mse,Fse,Lse,Pse,Bse,Use,Wse,Qse,Jse,Zse,tae,sae,oae,lae,cae,hae,pae,mae,gae,vae,xae,kae,Iae,Nae,Rae,Oae,Mae,Pae,Bae,Vae,Hae,qae,Xae,Jae,eie,nie,wne,rie,yse,aie,oie,uie,Tne,die,pie,fie,gie,vie,xie,kie,Iie,Nie,Aie,_ie,Oie,Die,Mie,Pie,zie,Bie,jie,Uie,Wie,qie,Xie,soe,Bne,ioe,loe,coe,hoe,ese,foe,yoe,voe,koe,Ioe,Ane,Coe,Toe,Noe,Eoe,Roe,nse,Jie,$oe,Doe,Foe,Une,zoe,joe,Woe,Hoe,Xoe,Qoe,Zoe,tle,sle,ile,lle,cle,hle,fle,gle,vle,Kre,roe,xle,wle,kle,Sle,Ile,Cle,Tle,Nle,Rle,_le,Dle,Mle,Fle,Ple,zle,Ble,jle,toe,Yne,Vle,Gle,Hle,Xle,eue,nue,Jne,rue,sue,{kernelName:eL,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:s,segmentIds:a}=t,{numSegments:i}=r,o=s.shape.length,l=[];let u=0;const c=qU([u],o);let d=s;null!=c&&(d=Qne({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=XU(1,o)[0]);const h=Bq(d.shape,u,i),p=mO([d.shape[u]]),f=jne({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});l.push(f);const m=pP(s.dtype),g=(e,t,r,s,a)=>{const i=e.shape[0],o=e.shape[1],u=zq(o,a),c=new aue({windowSize:u,inSize:o,batchSize:i,numSegments:a},t),d=n.compileAndRun(c,[e,r],s);if(l.push(d),d.shape[1]===a)return d;const h=Aoe({backend:n,attrs:{start:0,stop:a,step:1,dtype:"float32"}}),p=Kle({inputs:{x:h},backend:n,attrs:{reps:[o/u]}});l.push(h),l.push(p);return g(d,t,p,s,a)},y=jne({inputs:{x:g(f,"unsortedSegmentSum",a,m,i)},backend:n,attrs:{shape:h}});let v=y;if(null!=c){l.push(y);const e=KU(c);v=Qne({inputs:{x:v},backend:n,attrs:{perm:e}})}return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),v}},goe];for(const n of iue)mL(n);const oue=(0,A.createContext)();function lue(){return(0,A.useContext)(oue)}function uue(e){let{children:t}=e;const[n,r]=(0,A.useState)([]),[s,a]=(0,A.useState)([]),[i,o]=(0,A.useState)(!0),[l,u]=(0,A.useState)("default"),[c,d]=(0,A.useState)(null),{currentUser:h}=fS();async function p(e){if(!h)return null;try{const t={userId:h.uid,timestamp:Yd.now(),read:!1,...e};return{id:(await Mb(Ev(cS,"alerts"),t)).id,...t}}catch(t){return console.error("Error creating alert:",t),null}}(0,A.useEffect)((()=>{h&&async function(){try{if("Notification"in window){const e=await Notification.requestPermission();if(u(e),"granted"===e&&h){const e=await hS();if(e){const t=await async function(e,t){return eS(e=kn(e),t)}(e,{vapidKey:"BHS9FiDvrQ3H6ldUNLCwSn34inyJf3tcG_GLnp82eNIhLAf58Ialoe1CDuOK--JI-vIg8rPOEd0soSOrIyuTYqkW"});d(t),await Mb(Ev(cS,"fcmTokens"),{token:t,userId:h.uid,createdAt:Yd.now()}),oS(e,(e=>{console.log("Message received:",e);const t=e.notification.title,n={body:e.notification.body,icon:"/logo192.png"};if(new Notification(t,n),e.data){const n={id:Date.now().toString(),title:t,message:e.notification.body,timestamp:new Date,read:!1,...e.data};r((e=>[n,...e]))}}))}}}}catch(e){console.error("Error setting up notifications:",e)}}()}),[h]),(0,A.useEffect)((()=>{if(!h)return r([]),void o(!1);return Fb(pb(Ev(cS,"alerts"),function(e,t,n){const r=t,s=ub("where",e);return fb._create(s,r,n)}("userId","==",h.uid),yb("timestamp","desc"),bb(20)),(e=>{const t=e.docs.map((e=>{var t;return{id:e.id,...e.data(),timestamp:null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate()}}));r(t),o(!1)}),(e=>{console.error("Error fetching notifications:",e),o(!1)}))}),[h]),(0,A.useEffect)((()=>{if(!h)return void a([]);return Fb(pb(Ev(cS,"systemNotifications"),yb("timestamp","desc"),bb(20)),(e=>{const t=e.docs.map((e=>{var t;return{id:e.id,...e.data(),timestamp:null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate()}}));a(t),t.forEach((e=>{var t;null!==(t=e.processedByUser)&&void 0!==t&&t.includes(h.uid)||(p({type:e.type,severity:e.severity,title:e.title,message:e.message,systemNotificationId:e.id}),async function(e){if(!h)return;try{const t=Av(cS,"systemNotifications",e),n=await _b(t);if(!n.exists())return;const r=n.data().processedByUser||[];r.includes(h.uid)||await Db(t,{processedByUser:[...r,h.uid]})}catch(t){console.error("Error updating system notification:",t)}}(e.id))}))}),(e=>{console.error("Error fetching system notifications:",e)}))}),[h]);const f={notifications:n,systemNotifications:s,loading:i,permission:l,fcmToken:c,createAlert:p,markAlertAsRead:async function(e){if(!h)return!1;try{const t=Av(cS,"alerts",e);return await Db(t,{read:!0}),r((t=>t.map((t=>t.id===e?{...t,read:!0}:t)))),!0}catch(t){return console.error("Error marking alert as read:",t),!1}},createSystemNotification:async function(e){if(!h)return null;try{const t={createdByUserId:h.uid,timestamp:Yd.now(),processedByUser:[h.uid],systemNotification:!0,...e};return{id:(await Mb(Ev(cS,"systemNotifications"),t)).id,...t}}catch(t){return console.error("Error creating system notification:",t),null}},testNotification:async function(){return p({type:"test",severity:"info",title:"Test Notification",message:"This is a test notification to verify that alerts are working correctly."})}};return(0,st.jsx)(oue.Provider,{value:f,children:t})}var cue=n(2374);function due(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function hue(e){return e instanceof due(e).Element||e instanceof Element}function pue(e){return e instanceof due(e).HTMLElement||e instanceof HTMLElement}function fue(e){return"undefined"!==typeof ShadowRoot&&(e instanceof due(e).ShadowRoot||e instanceof ShadowRoot)}var mue=Math.max,gue=Math.min,yue=Math.round;function vue(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function bue(){return!/^((?!chrome|android).)*safari/i.test(vue())}function xue(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),s=1,a=1;t&&pue(e)&&(s=e.offsetWidth>0&&yue(r.width)/e.offsetWidth||1,a=e.offsetHeight>0&&yue(r.height)/e.offsetHeight||1);var i=(hue(e)?due(e):window).visualViewport,o=!bue()&&n,l=(r.left+(o&&i?i.offsetLeft:0))/s,u=(r.top+(o&&i?i.offsetTop:0))/a,c=r.width/s,d=r.height/a;return{width:c,height:d,top:u,right:l+c,bottom:u+d,left:l,x:l,y:u}}function wue(e){var t=due(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function kue(e){return e?(e.nodeName||"").toLowerCase():null}function Sue(e){return((hue(e)?e.ownerDocument:e.document)||window.document).documentElement}function Iue(e){return xue(Sue(e)).left+wue(e).scrollLeft}function Cue(e){return due(e).getComputedStyle(e)}function Tue(e){var t=Cue(e),n=t.overflow,r=t.overflowX,s=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+s+r)}function Nue(e,t,n){void 0===n&&(n=!1);var r=pue(t),s=pue(t)&&function(e){var t=e.getBoundingClientRect(),n=yue(t.width)/e.offsetWidth||1,r=yue(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),a=Sue(t),i=xue(e,s,n),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&(("body"!==kue(t)||Tue(a))&&(o=function(e){return e!==due(e)&&pue(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:wue(e);var t}(t)),pue(t)?((l=xue(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):a&&(l.x=Iue(a))),{x:i.left+o.scrollLeft-l.x,y:i.top+o.scrollTop-l.y,width:i.width,height:i.height}}function Eue(e){var t=xue(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function Aue(e){return"html"===kue(e)?e:e.assignedSlot||e.parentNode||(fue(e)?e.host:null)||Sue(e)}function Rue(e){return["html","body","#document"].indexOf(kue(e))>=0?e.ownerDocument.body:pue(e)&&Tue(e)?e:Rue(Aue(e))}function _ue(e,t){var n;void 0===t&&(t=[]);var r=Rue(e),s=r===(null==(n=e.ownerDocument)?void 0:n.body),a=due(r),i=s?[a].concat(a.visualViewport||[],Tue(r)?r:[]):r,o=t.concat(i);return s?o:o.concat(_ue(Aue(i)))}function $ue(e){return["table","td","th"].indexOf(kue(e))>=0}function Oue(e){return pue(e)&&"fixed"!==Cue(e).position?e.offsetParent:null}function Due(e){for(var t=due(e),n=Oue(e);n&&$ue(n)&&"static"===Cue(n).position;)n=Oue(n);return n&&("html"===kue(n)||"body"===kue(n)&&"static"===Cue(n).position)?t:n||function(e){var t=/firefox/i.test(vue());if(/Trident/i.test(vue())&&pue(e)&&"fixed"===Cue(e).position)return null;var n=Aue(e);for(fue(n)&&(n=n.host);pue(n)&&["html","body"].indexOf(kue(n))<0;){var r=Cue(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var Mue="top",Fue="bottom",Lue="right",Pue="left",zue="auto",Bue=[Mue,Fue,Lue,Pue],jue="start",Uue="end",Vue="viewport",Wue="popper",Gue=Bue.reduce((function(e,t){return e.concat([t+"-"+jue,t+"-"+Uue])}),[]),Hue=[].concat(Bue,[zue]).reduce((function(e,t){return e.concat([t,t+"-"+jue,t+"-"+Uue])}),[]),que=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Kue(e){var t=new Map,n=new Set,r=[];function s(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&s(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||s(e)})),r}function Xue(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}var Yue={placement:"bottom",modifiers:[],strategy:"absolute"};function Que(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"===typeof e.getBoundingClientRect)}))}function Jue(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,s=t.defaultOptions,a=void 0===s?Yue:s;return function(e,t,n){void 0===n&&(n=a);var s={placement:"bottom",orderedModifiers:[],options:Object.assign({},Yue,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},i=[],o=!1,l={state:s,setOptions:function(n){var o="function"===typeof n?n(s.options):n;u(),s.options=Object.assign({},a,s.options,o),s.scrollParents={reference:hue(e)?_ue(e):e.contextElement?_ue(e.contextElement):[],popper:_ue(t)};var c=function(e){var t=Kue(e);return que.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,s.options.modifiers)));return s.orderedModifiers=c.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,a=e.effect;if("function"===typeof a){var o=a({state:s,name:t,instance:l,options:r}),u=function(){};i.push(o||u)}})),l.update()},forceUpdate:function(){if(!o){var e=s.elements,t=e.reference,n=e.popper;if(Que(t,n)){s.rects={reference:Nue(t,Due(n),"fixed"===s.options.strategy),popper:Eue(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<s.orderedModifiers.length;r++)if(!0!==s.reset){var a=s.orderedModifiers[r],i=a.fn,u=a.options,c=void 0===u?{}:u,d=a.name;"function"===typeof i&&(s=i({state:s,options:c,name:d,instance:l})||s)}else s.reset=!1,r=-1}}},update:Xue((function(){return new Promise((function(e){l.forceUpdate(),e(s)}))})),destroy:function(){u(),o=!0}};if(!Que(e,t))return l;function u(){i.forEach((function(e){return e()})),i=[]}return l.setOptions(n).then((function(e){!o&&n.onFirstUpdate&&n.onFirstUpdate(e)})),l}}var Zue={passive:!0};function ece(e){return e.split("-")[0]}function tce(e){return e.split("-")[1]}function nce(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function rce(e){var t,n=e.reference,r=e.element,s=e.placement,a=s?ece(s):null,i=s?tce(s):null,o=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2;switch(a){case Mue:t={x:o,y:n.y-r.height};break;case Fue:t={x:o,y:n.y+n.height};break;case Lue:t={x:n.x+n.width,y:l};break;case Pue:t={x:n.x-r.width,y:l};break;default:t={x:n.x,y:n.y}}var u=a?nce(a):null;if(null!=u){var c="y"===u?"height":"width";switch(i){case jue:t[u]=t[u]-(n[c]/2-r[c]/2);break;case Uue:t[u]=t[u]+(n[c]/2-r[c]/2)}}return t}var sce={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ace(e){var t,n=e.popper,r=e.popperRect,s=e.placement,a=e.variation,i=e.offsets,o=e.position,l=e.gpuAcceleration,u=e.adaptive,c=e.roundOffsets,d=e.isFixed,h=i.x,p=void 0===h?0:h,f=i.y,m=void 0===f?0:f,g="function"===typeof c?c({x:p,y:m}):{x:p,y:m};p=g.x,m=g.y;var y=i.hasOwnProperty("x"),v=i.hasOwnProperty("y"),b=Pue,x=Mue,w=window;if(u){var k=Due(n),S="clientHeight",I="clientWidth";if(k===due(n)&&"static"!==Cue(k=Sue(n)).position&&"absolute"===o&&(S="scrollHeight",I="scrollWidth"),s===Mue||(s===Pue||s===Lue)&&a===Uue)x=Fue,m-=(d&&k===w&&w.visualViewport?w.visualViewport.height:k[S])-r.height,m*=l?1:-1;if(s===Pue||(s===Mue||s===Fue)&&a===Uue)b=Lue,p-=(d&&k===w&&w.visualViewport?w.visualViewport.width:k[I])-r.width,p*=l?1:-1}var C,T=Object.assign({position:o},u&&sce),N=!0===c?function(e,t){var n=e.x,r=e.y,s=t.devicePixelRatio||1;return{x:yue(n*s)/s||0,y:yue(r*s)/s||0}}({x:p,y:m},due(n)):{x:p,y:m};return p=N.x,m=N.y,l?Object.assign({},T,((C={})[x]=v?"0":"",C[b]=y?"0":"",C.transform=(w.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",C)):Object.assign({},T,((t={})[x]=v?m+"px":"",t[b]=y?p+"px":"",t.transform="",t))}var ice={left:"right",right:"left",bottom:"top",top:"bottom"};function oce(e){return e.replace(/left|right|bottom|top/g,(function(e){return ice[e]}))}var lce={start:"end",end:"start"};function uce(e){return e.replace(/start|end/g,(function(e){return lce[e]}))}function cce(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&fue(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function dce(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function hce(e,t,n){return t===Vue?dce(function(e,t){var n=due(e),r=Sue(e),s=n.visualViewport,a=r.clientWidth,i=r.clientHeight,o=0,l=0;if(s){a=s.width,i=s.height;var u=bue();(u||!u&&"fixed"===t)&&(o=s.offsetLeft,l=s.offsetTop)}return{width:a,height:i,x:o+Iue(e),y:l}}(e,n)):hue(t)?function(e,t){var n=xue(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):dce(function(e){var t,n=Sue(e),r=wue(e),s=null==(t=e.ownerDocument)?void 0:t.body,a=mue(n.scrollWidth,n.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),i=mue(n.scrollHeight,n.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),o=-r.scrollLeft+Iue(e),l=-r.scrollTop;return"rtl"===Cue(s||n).direction&&(o+=mue(n.clientWidth,s?s.clientWidth:0)-a),{width:a,height:i,x:o,y:l}}(Sue(e)))}function pce(e,t,n,r){var s="clippingParents"===t?function(e){var t=_ue(Aue(e)),n=["absolute","fixed"].indexOf(Cue(e).position)>=0&&pue(e)?Due(e):e;return hue(n)?t.filter((function(e){return hue(e)&&cce(e,n)&&"body"!==kue(e)})):[]}(e):[].concat(t),a=[].concat(s,[n]),i=a[0],o=a.reduce((function(t,n){var s=hce(e,n,r);return t.top=mue(s.top,t.top),t.right=gue(s.right,t.right),t.bottom=gue(s.bottom,t.bottom),t.left=mue(s.left,t.left),t}),hce(e,i,r));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function fce(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function mce(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function gce(e,t){void 0===t&&(t={});var n=t,r=n.placement,s=void 0===r?e.placement:r,a=n.strategy,i=void 0===a?e.strategy:a,o=n.boundary,l=void 0===o?"clippingParents":o,u=n.rootBoundary,c=void 0===u?Vue:u,d=n.elementContext,h=void 0===d?Wue:d,p=n.altBoundary,f=void 0!==p&&p,m=n.padding,g=void 0===m?0:m,y=fce("number"!==typeof g?g:mce(g,Bue)),v=h===Wue?"reference":Wue,b=e.rects.popper,x=e.elements[f?v:h],w=pce(hue(x)?x:x.contextElement||Sue(e.elements.popper),l,c,i),k=xue(e.elements.reference),S=rce({reference:k,element:b,strategy:"absolute",placement:s}),I=dce(Object.assign({},b,S)),C=h===Wue?I:k,T={top:w.top-C.top+y.top,bottom:C.bottom-w.bottom+y.bottom,left:w.left-C.left+y.left,right:C.right-w.right+y.right},N=e.modifiersData.offset;if(h===Wue&&N){var E=N[s];Object.keys(T).forEach((function(e){var t=[Lue,Fue].indexOf(e)>=0?1:-1,n=[Mue,Fue].indexOf(e)>=0?"y":"x";T[e]+=E[n]*t}))}return T}const yce={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var s=n.mainAxis,a=void 0===s||s,i=n.altAxis,o=void 0===i||i,l=n.fallbackPlacements,u=n.padding,c=n.boundary,d=n.rootBoundary,h=n.altBoundary,p=n.flipVariations,f=void 0===p||p,m=n.allowedAutoPlacements,g=t.options.placement,y=ece(g),v=l||(y===g||!f?[oce(g)]:function(e){if(ece(e)===zue)return[];var t=oce(e);return[uce(e),t,uce(t)]}(g)),b=[g].concat(v).reduce((function(e,n){return e.concat(ece(n)===zue?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,s=n.boundary,a=n.rootBoundary,i=n.padding,o=n.flipVariations,l=n.allowedAutoPlacements,u=void 0===l?Hue:l,c=tce(r),d=c?o?Gue:Gue.filter((function(e){return tce(e)===c})):Bue,h=d.filter((function(e){return u.indexOf(e)>=0}));0===h.length&&(h=d);var p=h.reduce((function(t,n){return t[n]=gce(e,{placement:n,boundary:s,rootBoundary:a,padding:i})[ece(n)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:n,boundary:c,rootBoundary:d,padding:u,flipVariations:f,allowedAutoPlacements:m}):n)}),[]),x=t.rects.reference,w=t.rects.popper,k=new Map,S=!0,I=b[0],C=0;C<b.length;C++){var T=b[C],N=ece(T),E=tce(T)===jue,A=[Mue,Fue].indexOf(N)>=0,R=A?"width":"height",_=gce(t,{placement:T,boundary:c,rootBoundary:d,altBoundary:h,padding:u}),$=A?E?Lue:Pue:E?Fue:Mue;x[R]>w[R]&&($=oce($));var O=oce($),D=[];if(a&&D.push(_[N]<=0),o&&D.push(_[$]<=0,_[O]<=0),D.every((function(e){return e}))){I=T,S=!1;break}k.set(T,D)}if(S)for(var M=function(e){var t=b.find((function(t){var n=k.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return I=t,"break"},F=f?3:1;F>0;F--){if("break"===M(F))break}t.placement!==I&&(t.modifiersData[r]._skip=!0,t.placement=I,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function vce(e,t,n){return mue(e,gue(t,n))}function bce(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function xce(e){return[Mue,Lue,Fue,Pue].some((function(t){return e[t]>=0}))}var wce=Jue({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,s=r.scroll,a=void 0===s||s,i=r.resize,o=void 0===i||i,l=due(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&u.forEach((function(e){e.addEventListener("scroll",n.update,Zue)})),o&&l.addEventListener("resize",n.update,Zue),function(){a&&u.forEach((function(e){e.removeEventListener("scroll",n.update,Zue)})),o&&l.removeEventListener("resize",n.update,Zue)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=rce({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,s=void 0===r||r,a=n.adaptive,i=void 0===a||a,o=n.roundOffsets,l=void 0===o||o,u={placement:ece(t.placement),variation:tce(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:s,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ace(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:i,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ace(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},s=t.elements[e];pue(s)&&kue(s)&&(Object.assign(s.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?s.removeAttribute(e):s.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],s=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});pue(r)&&kue(r)&&(Object.assign(r.style,a),Object.keys(s).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]},{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,s=n.offset,a=void 0===s?[0,0]:s,i=Hue.reduce((function(e,n){return e[n]=function(e,t,n){var r=ece(e),s=[Pue,Mue].indexOf(r)>=0?-1:1,a="function"===typeof n?n(Object.assign({},t,{placement:e})):n,i=a[0],o=a[1];return i=i||0,o=(o||0)*s,[Pue,Lue].indexOf(r)>=0?{x:o,y:i}:{x:i,y:o}}(n,t.rects,a),e}),{}),o=i[t.placement],l=o.x,u=o.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=u),t.modifiersData[r]=i}},yce,{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,s=n.mainAxis,a=void 0===s||s,i=n.altAxis,o=void 0!==i&&i,l=n.boundary,u=n.rootBoundary,c=n.altBoundary,d=n.padding,h=n.tether,p=void 0===h||h,f=n.tetherOffset,m=void 0===f?0:f,g=gce(t,{boundary:l,rootBoundary:u,padding:d,altBoundary:c}),y=ece(t.placement),v=tce(t.placement),b=!v,x=nce(y),w="x"===x?"y":"x",k=t.modifiersData.popperOffsets,S=t.rects.reference,I=t.rects.popper,C="function"===typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,T="number"===typeof C?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),N=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,E={x:0,y:0};if(k){if(a){var A,R="y"===x?Mue:Pue,_="y"===x?Fue:Lue,$="y"===x?"height":"width",O=k[x],D=O+g[R],M=O-g[_],F=p?-I[$]/2:0,L=v===jue?S[$]:I[$],P=v===jue?-I[$]:-S[$],z=t.elements.arrow,B=p&&z?Eue(z):{width:0,height:0},j=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},U=j[R],V=j[_],W=vce(0,S[$],B[$]),G=b?S[$]/2-F-W-U-T.mainAxis:L-W-U-T.mainAxis,H=b?-S[$]/2+F+W+V+T.mainAxis:P+W+V+T.mainAxis,q=t.elements.arrow&&Due(t.elements.arrow),K=q?"y"===x?q.clientTop||0:q.clientLeft||0:0,X=null!=(A=null==N?void 0:N[x])?A:0,Y=O+H-X,Q=vce(p?gue(D,O+G-X-K):D,O,p?mue(M,Y):M);k[x]=Q,E[x]=Q-O}if(o){var J,Z="x"===x?Mue:Pue,ee="x"===x?Fue:Lue,te=k[w],ne="y"===w?"height":"width",re=te+g[Z],se=te-g[ee],ae=-1!==[Mue,Pue].indexOf(y),ie=null!=(J=null==N?void 0:N[w])?J:0,oe=ae?re:te-S[ne]-I[ne]-ie+T.altAxis,le=ae?te+S[ne]+I[ne]-ie-T.altAxis:se,ue=p&&ae?function(e,t,n){var r=vce(e,t,n);return r>n?n:r}(oe,te,le):vce(p?oe:re,te,p?le:se);k[w]=ue,E[w]=ue-te}t.modifiersData[r]=E}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,s=e.options,a=n.elements.arrow,i=n.modifiersData.popperOffsets,o=ece(n.placement),l=nce(o),u=[Pue,Lue].indexOf(o)>=0?"height":"width";if(a&&i){var c=function(e,t){return fce("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:mce(e,Bue))}(s.padding,n),d=Eue(a),h="y"===l?Mue:Pue,p="y"===l?Fue:Lue,f=n.rects.reference[u]+n.rects.reference[l]-i[l]-n.rects.popper[u],m=i[l]-n.rects.reference[l],g=Due(a),y=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,v=f/2-m/2,b=c[h],x=y-d[u]-c[p],w=y/2-d[u]/2+v,k=vce(b,w,x),S=l;n.modifiersData[r]=((t={})[S]=k,t.centerOffset=k-w,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!==typeof r||(r=t.elements.popper.querySelector(r)))&&cce(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,s=t.rects.popper,a=t.modifiersData.preventOverflow,i=gce(t,{elementContext:"reference"}),o=gce(t,{altBoundary:!0}),l=bce(i,r),u=bce(o,s,a),c=xce(l),d=xce(u);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}}]});function kce(e){return Vt("MuiPopper",e)}Wt("MuiPopper",["root"]);const Sce=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],Ice=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function Cce(e){return"function"===typeof e?e():e}function Tce(e){return void 0!==e.nodeType}const Nce={},Ece=A.forwardRef((function(e,t){var n;const{anchorEl:r,children:s,direction:a,disablePortal:i,modifiers:o,open:l,placement:u,popperOptions:c,popperRef:d,slotProps:h={},slots:p={},TransitionProps:f}=e,m=(0,qe.A)(e,Sce),g=A.useRef(null),y=EI(g,t),v=A.useRef(null),b=EI(v,d),x=A.useRef(b);UI((()=>{x.current=b}),[b]),A.useImperativeHandle(d,(()=>v.current),[]);const w=function(e,t){if("ltr"===t)return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(u,a),[k,S]=A.useState(w),[I,C]=A.useState(Cce(r));A.useEffect((()=>{v.current&&v.current.forceUpdate()})),A.useEffect((()=>{r&&C(Cce(r))}),[r]),UI((()=>{if(!I||!l)return;let e=[{name:"preventOverflow",options:{altBoundary:i}},{name:"flip",options:{altBoundary:i}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:e=>{let{state:t}=e;S(t.placement)}}];null!=o&&(e=e.concat(o)),c&&null!=c.modifiers&&(e=e.concat(c.modifiers));const t=wce(I,g.current,(0,He.A)({placement:w},c,{modifiers:e}));return x.current(t),()=>{t.destroy(),x.current(null)}}),[I,i,o,l,c,w]);const T={placement:k};null!==f&&(T.TransitionProps=f);const N=(e=>{const{classes:t}=e;return _S({root:["root"]},kce,t)})(e),E=null!=(n=p.root)?n:"div",R=MN({elementType:E,externalSlotProps:h.root,externalForwardedProps:m,additionalProps:{role:"tooltip",ref:y},ownerState:e,className:N.root});return(0,st.jsx)(E,(0,He.A)({},R,{children:"function"===typeof s?s(T):s}))})),Ace=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],Rce=eI(A.forwardRef((function(e,t){const{anchorEl:n,children:r,container:s,direction:a="ltr",disablePortal:i=!1,keepMounted:o=!1,modifiers:l,open:u,placement:c="bottom",popperOptions:d=Nce,popperRef:h,style:p,transition:f=!1,slotProps:m={},slots:g={}}=e,y=(0,qe.A)(e,Ice),[v,b]=A.useState(!0);if(!o&&!u&&(!f||v))return null;let x;if(s)x=s;else if(n){const e=Cce(n);x=e&&Tce(e)?oT(e).body:oT(null).body}const w=u||!o||f&&!v?void 0:"none",k=f?{in:u,onEnter:()=>{b(!1)},onExited:()=>{b(!0)}}:void 0;return(0,st.jsx)(xE,{disablePortal:i,container:x,children:(0,st.jsx)(Ece,(0,He.A)({anchorEl:n,direction:a,disablePortal:i,modifiers:l,ref:t,open:f?!v:u,placement:c,popperOptions:d,popperRef:h,slotProps:m,slots:g},y,{style:(0,He.A)({position:"fixed",top:0,left:0,display:w},p),TransitionProps:k,children:r}))})})),{name:"MuiPopper",slot:"Root",overridesResolver:(e,t)=>t.root})({}),_ce=A.forwardRef((function(e,t){var n;const r=(0,cue.A)(),s=sI({props:e,name:"MuiPopper"}),{anchorEl:a,component:i,components:o,componentsProps:l,container:u,disablePortal:c,keepMounted:d,modifiers:h,open:p,placement:f,popperOptions:m,popperRef:g,transition:y,slots:v,slotProps:b}=s,x=(0,qe.A)(s,Ace),w=null!=(n=null==v?void 0:v.root)?n:null==o?void 0:o.Root,k=(0,He.A)({anchorEl:a,container:u,disablePortal:c,keepMounted:d,modifiers:h,open:p,placement:f,popperOptions:m,popperRef:g,transition:y},x);return(0,st.jsx)(Rce,(0,He.A)({as:i,direction:null==r?void 0:r.direction,slots:{root:w},slotProps:null!=b?b:l},k,{ref:t}))})),$ce=iT;function Oce(e){return Vt("MuiTooltip",e)}const Dce=Wt("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),Mce=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];const Fce=eI(_ce,{name:"MuiTooltip",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.popper,!n.disableInteractive&&t.popperInteractive,n.arrow&&t.popperArrow,!n.open&&t.popperClose]}})((e=>{let{theme:t,ownerState:n,open:r}=e;return(0,He.A)({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none"},!n.disableInteractive&&{pointerEvents:"auto"},!r&&{pointerEvents:"none"},n.arrow&&{[`&[data-popper-placement*="bottom"] .${Dce.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Dce.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Dce.arrow}`]:(0,He.A)({},n.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${Dce.arrow}`]:(0,He.A)({},n.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})})),Lce=eI("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.tooltip,n.touch&&t.touch,n.arrow&&t.tooltipArrow,t[`tooltipPlacement${XS(n.placement.split("-")[0])}`]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:(0,dt.X4)(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium},n.arrow&&{position:"relative",margin:0},n.touch&&{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:(r=16/14,Math.round(1e5*r)/1e5)+"em",fontWeight:t.typography.fontWeightRegular},{[`.${Dce.popper}[data-popper-placement*="left"] &`]:(0,He.A)({transformOrigin:"right center"},n.isRtl?(0,He.A)({marginLeft:"14px"},n.touch&&{marginLeft:"24px"}):(0,He.A)({marginRight:"14px"},n.touch&&{marginRight:"24px"})),[`.${Dce.popper}[data-popper-placement*="right"] &`]:(0,He.A)({transformOrigin:"left center"},n.isRtl?(0,He.A)({marginRight:"14px"},n.touch&&{marginRight:"24px"}):(0,He.A)({marginLeft:"14px"},n.touch&&{marginLeft:"24px"})),[`.${Dce.popper}[data-popper-placement*="top"] &`]:(0,He.A)({transformOrigin:"center bottom",marginBottom:"14px"},n.touch&&{marginBottom:"24px"}),[`.${Dce.popper}[data-popper-placement*="bottom"] &`]:(0,He.A)({transformOrigin:"center top",marginTop:"14px"},n.touch&&{marginTop:"24px"})});var r})),Pce=eI("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(e,t)=>t.arrow})((e=>{let{theme:t}=e;return{overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:(0,dt.X4)(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}}));let zce=!1;const Bce=new qI;let jce={x:0,y:0};function Uce(e,t){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];t&&t(n,...s),e(n,...s)}}const Vce=A.forwardRef((function(e,t){var n,r,s,a,i,o,l,u,c,d,h,p,f,m,g,y,v,b,x;const w=sI({props:e,name:"MuiTooltip"}),{arrow:k=!1,children:S,components:I={},componentsProps:C={},describeChild:T=!1,disableFocusListener:N=!1,disableHoverListener:E=!1,disableInteractive:R=!1,disableTouchListener:_=!1,enterDelay:$=100,enterNextDelay:O=0,enterTouchDelay:D=700,followCursor:M=!1,id:F,leaveDelay:L=0,leaveTouchDelay:P=1500,onClose:z,onOpen:B,open:j,placement:U="bottom",PopperComponent:V,PopperProps:W={},slotProps:G={},slots:H={},title:q,TransitionComponent:K=mE,TransitionProps:X}=w,Y=(0,qe.A)(w,Mce),Q=A.isValidElement(S)?S:(0,st.jsx)("span",{children:S}),J=oE(),Z=$N(),[ee,te]=A.useState(),[ne,re]=A.useState(null),se=A.useRef(!1),ae=R||M,ie=KI(),oe=KI(),le=KI(),ue=KI(),[ce,de]=bA({controlled:j,default:!1,name:"Tooltip",state:"open"});let he=ce;const pe=$ce(F),fe=A.useRef(),me=WI((()=>{void 0!==fe.current&&(document.body.style.WebkitUserSelect=fe.current,fe.current=void 0),ue.clear()}));A.useEffect((()=>me),[me]);const ge=e=>{Bce.clear(),zce=!0,de(!0),B&&!he&&B(e)},ye=WI((e=>{Bce.start(800+L,(()=>{zce=!1})),de(!1),z&&he&&z(e),ie.start(J.transitions.duration.shortest,(()=>{se.current=!1}))})),ve=e=>{se.current&&"touchstart"!==e.type||(ee&&ee.removeAttribute("title"),oe.clear(),le.clear(),$||zce&&O?oe.start(zce?O:$,(()=>{ge(e)})):ge(e))},be=e=>{oe.clear(),le.start(L,(()=>{ye(e)}))},{isFocusVisibleRef:xe,onBlur:we,onFocus:ke,ref:Se}=sC(),[,Ie]=A.useState(!1),Ce=e=>{we(e),!1===xe.current&&(Ie(!1),be(e))},Te=e=>{ee||te(e.currentTarget),ke(e),!0===xe.current&&(Ie(!0),ve(e))},Ne=e=>{se.current=!0;const t=Q.props;t.onTouchStart&&t.onTouchStart(e)},Ee=e=>{Ne(e),le.clear(),ie.clear(),me(),fe.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",ue.start(D,(()=>{document.body.style.WebkitUserSelect=fe.current,ve(e)}))},Ae=e=>{Q.props.onTouchEnd&&Q.props.onTouchEnd(e),me(),le.start(P,(()=>{ye(e)}))};A.useEffect((()=>{if(he)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){"Escape"!==e.key&&"Esc"!==e.key||ye(e)}}),[ye,he]);const Re=jI(EN(Q),Se,te,t);q||0===q||(he=!1);const _e=A.useRef(),$e={},Oe="string"===typeof q;T?($e.title=he||!Oe||E?null:q,$e["aria-describedby"]=he?pe:null):($e["aria-label"]=Oe?q:null,$e["aria-labelledby"]=he&&!Oe?pe:null);const De=(0,He.A)({},$e,Y,Q.props,{className:Xe(Y.className,Q.props.className),onTouchStart:Ne,ref:Re},M?{onMouseMove:e=>{const t=Q.props;t.onMouseMove&&t.onMouseMove(e),jce={x:e.clientX,y:e.clientY},_e.current&&_e.current.update()}}:{});const Me={};_||(De.onTouchStart=Ee,De.onTouchEnd=Ae),E||(De.onMouseOver=Uce(ve,De.onMouseOver),De.onMouseLeave=Uce(be,De.onMouseLeave),ae||(Me.onMouseOver=ve,Me.onMouseLeave=be)),N||(De.onFocus=Uce(Te,De.onFocus),De.onBlur=Uce(Ce,De.onBlur),ae||(Me.onFocus=Te,Me.onBlur=Ce));const Fe=A.useMemo((()=>{var e;let t=[{name:"arrow",enabled:Boolean(ne),options:{element:ne,padding:4}}];return null!=(e=W.popperOptions)&&e.modifiers&&(t=t.concat(W.popperOptions.modifiers)),(0,He.A)({},W.popperOptions,{modifiers:t})}),[ne,W]),Le=(0,He.A)({},w,{isRtl:Z,arrow:k,disableInteractive:ae,placement:U,PopperComponentProp:V,touch:se.current}),Pe=(e=>{const{classes:t,disableInteractive:n,arrow:r,touch:s,placement:a}=e;return _S({popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",s&&"touch",`tooltipPlacement${XS(a.split("-")[0])}`],arrow:["arrow"]},Oce,t)})(Le),ze=null!=(n=null!=(r=H.popper)?r:I.Popper)?n:Fce,Be=null!=(s=null!=(a=null!=(i=H.transition)?i:I.Transition)?a:K)?s:mE,je=null!=(o=null!=(l=H.tooltip)?l:I.Tooltip)?o:Lce,Ue=null!=(u=null!=(c=H.arrow)?c:I.Arrow)?u:Pce,Ve=RI(ze,(0,He.A)({},W,null!=(d=G.popper)?d:C.popper,{className:Xe(Pe.popper,null==W?void 0:W.className,null==(h=null!=(p=G.popper)?p:C.popper)?void 0:h.className)}),Le),We=RI(Be,(0,He.A)({},X,null!=(f=G.transition)?f:C.transition),Le),Ge=RI(je,(0,He.A)({},null!=(m=G.tooltip)?m:C.tooltip,{className:Xe(Pe.tooltip,null==(g=null!=(y=G.tooltip)?y:C.tooltip)?void 0:g.className)}),Le),Ke=RI(Ue,(0,He.A)({},null!=(v=G.arrow)?v:C.arrow,{className:Xe(Pe.arrow,null==(b=null!=(x=G.arrow)?x:C.arrow)?void 0:b.className)}),Le);return(0,st.jsxs)(A.Fragment,{children:[A.cloneElement(Q,De),(0,st.jsx)(ze,(0,He.A)({as:null!=V?V:_ce,placement:U,anchorEl:M?{getBoundingClientRect:()=>({top:jce.y,left:jce.x,right:jce.x,bottom:jce.y,width:0,height:0})}:ee,popperRef:_e,open:!!ee&&he,id:pe,transition:!0},Me,Ve,{popperOptions:Fe,children:e=>{let{TransitionProps:t}=e;return(0,st.jsx)(Be,(0,He.A)({timeout:J.transitions.duration.shorter},t,We,{children:(0,st.jsxs)(je,(0,He.A)({},Ge,{children:[q,k?(0,st.jsx)(Ue,(0,He.A)({},Ke,{ref:re})):null]}))}))}}))]})})),Wce=WC((0,st.jsx)("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"}),"Pause"),Gce=WC((0,st.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),Hce=WC((0,st.jsx)("path",{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11z"}),"Videocam"),qce=WC((0,st.jsx)("path",{d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"}),"Fullscreen"),Kce=e=>{let{isStreaming:t,toggleStreaming:n,isProcessing:r,selectCamera:s,selectedCamera:a}=e;const[i,o]=(0,A.useState)([]),[l,u]=(0,A.useState)(!1),{userProfile:c}=fS();(0,A.useEffect)((()=>{!async function(){u(!0);try{const e=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"videoinput"===e.kind));o(e)}catch(e){console.error("Error getting cameras:",e)}finally{u(!1)}}()}),[]);const d="patient"===(null===c||void 0===c?void 0:c.role);return(0,st.jsxs)(qt,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,flexWrap:"wrap"},children:[d?(0,st.jsx)(OR,{variant:t?"outlined":"contained",color:t?"error":"primary",startIcon:t?(0,st.jsx)(Wce,{}):(0,st.jsx)(Gce,{}),onClick:n,disabled:l,children:t?"Stop Streaming":"Start Streaming"}):(0,st.jsx)(OR,{variant:"contained",color:"primary",disabled:!0,startIcon:(0,st.jsx)(Hce,{}),children:"Viewer Mode"}),(0,st.jsxs)(eR,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mt:{xs:2,sm:0},mb:{xs:2,sm:0}},children:[d&&(0,st.jsxs)(wN,{sx:{minWidth:200},children:[(0,st.jsx)(mN,{id:"camera-select-label",children:"Select Camera"}),(0,st.jsx)(zA,{labelId:"camera-select-label",id:"camera-select",value:a||"",onChange:e=>s(e.target.value),label:"Select Camera",disabled:t||l,children:i.map((e=>(0,st.jsx)(J_,{value:e.deviceId,children:e.label||`Camera ${e.deviceId.slice(0,5)}`},e.deviceId)))})]}),r&&(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center"},children:[(0,st.jsx)(KR,{size:24,sx:{mr:1}}),"Analyzing..."]})]}),(0,st.jsxs)(eR,{direction:"row",spacing:1,children:[(0,st.jsx)(Vce,{title:"Video Settings",children:(0,st.jsx)(OR,{size:"small",variant:"outlined",color:"primary",startIcon:(0,st.jsx)(nO,{}),disabled:!d,children:"Video Settings"})}),(0,st.jsx)(Vce,{title:"Fullscreen",children:(0,st.jsx)(OR,{size:"small",variant:"outlined",color:"primary",startIcon:(0,st.jsx)(qce,{}),children:"Fullscreen"})})]})]})},Xce=WC((0,st.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error"),Yce=e=>{let{status:t}=e,n=null,r="",s="";switch(t){case"normal":n=(0,st.jsx)(eO,{}),r="Normal Activity",s="success.main";break;case"warning":n=(0,st.jsx)(tO,{}),r="Unusual Movement Detected",s="warning.main";break;case"alert":n=(0,st.jsx)(Xce,{}),r="Potential Emergency",s="error.main";break;default:n=(0,st.jsx)(eO,{}),r="Status Normal",s="success.main"}return(0,st.jsx)(Vce,{title:r,children:(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center"},children:[(0,st.jsx)(qt,{sx:{color:s,mr:1,display:"flex"},children:n}),(0,st.jsx)(hI,{variant:"body2",color:s,children:r})]})})};let Qce=null,Jce=null;function Zce(){const e=(0,A.useRef)(null),t=(0,A.useRef)(null),[n,r]=(0,A.useState)(!1),[s,a]=(0,A.useState)(!1),[i,o]=(0,A.useState)(!1),[l,u]=(0,A.useState)("normal"),[c,d]=(0,A.useState)(50),[h,p]=(0,A.useState)([]),[f,m]=(0,A.useState)(""),[g,y]=(0,A.useState)({detectionFrequency:500,motionThreshold:.3,fallThreshold:.7,enableFallDetection:!0,enableMotionTracking:!0}),[v,b]=(0,A.useState)(null),{currentUser:x,userProfile:w}=fS(),{createAlert:k}=lue(),[S,I]=(0,A.useState)(!1),C=(0,A.useRef)(null);(0,A.useEffect)((()=>{if(x&&w){const e=async()=>{try{const e={type:"user_login",severity:"info",title:"User Logged In",message:`${w.firstName} ${w.lastName} (${w.role}) has logged in at ${(new Date).toLocaleTimeString()}`,timestamp:Yd.now(),systemNotification:!0};await Mb(Ev(cS,"systemNotifications"),e)}catch(v){console.error("Error logging user login:",v)}};e()}}),[x,w]),(0,A.useEffect)((()=>(async function(){try{Qce||(await IP.ready(),e="webgl",IP.setBackend(e),console.log("Loading MoveNet model..."),Jce=await k2("https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4",{fromTFHub:!0}),console.log("Model loaded successfully"),Qce={loaded:!0,detect:async e=>{if(!Jce)return[];const t=tj(e),n=Jz(t,"int32"),r=AH.resizeBilinear(n,[192,192]),s=rB(r,255),a=rV(s,0),i=await Jce.predict(a),o=i.arraySync()[0];t.dispose(),n.dispose(),r.dispose(),s.dispose(),a.dispose(),i.dispose();const l=[];for(let u=0;u<17;u++){const t=o[3*u],n=o[3*u+1],r=o[3*u+2];l.push({position:{x:n*e.width,y:t*e.height},score:r})}return[{score:l.reduce(((e,t)=>e+t.score),0)/17,keypoints:l}]}},a(!0))}catch(v){console.error("Error loading ML models:",v),b("Failed to load detection models. Please refresh the page.")}var e}(),()=>{o(!1)})),[]),(0,A.useEffect)((()=>{let e=null;return n&&s&&g.enableMotionTracking?(o(!0),e=setInterval((()=>{T()}),g.detectionFrequency)):o(!1),()=>{e&&clearInterval(e)}}),[n,s,g]);const T=async()=>{if(e.current&&e.current.video&&4===e.current.video.readyState&&Qce){const n=e.current.video;try{const e=await Qce.detect(n);if(e.length>0){const r=e[0],s=r.keypoints.map((e=>e.score)),a=s.reduce(((e,t)=>e+t),0)/s.length,i=r.keypoints.filter((e=>e.score>.3));let o=0,l=0;if(i.length>0){const e=i.map((e=>e.position.y)),s=Math.min(...e),u=Math.max(...e);if(o=(u-s)/n.height,l=Math.min(1,Math.max(0,a*(.5*Math.random()+.5))),t.current){const e=t.current.getContext("2d");e.clearRect(0,0,t.current.width,t.current.height),e.fillStyle="#00FF00",e.strokeStyle="#FF0000",e.lineWidth=2,r.keypoints.forEach((t=>{t.score>.3&&(e.beginPath(),e.arc(t.position.x,t.position.y,5,0,2*Math.PI),e.fill())}))}}p((e=>{const t=[...e,l];return t.length>20?t.slice(t.length-20):t}));const d=.7-.4*(c/100);o<.3&&g.enableFallDetection&&l>.6?(u("alert"),k({type:"fall_detected",severity:"critical",title:"Fall Detected",message:"Potential fall detected in the monitoring area. Please check immediately."})):l>d?(u("warning"),l>.85&&k({type:"motion_detected",severity:"warning",title:"Significant Movement",message:"Unusual activity detected in the monitoring area."})):u("normal")}}catch(v){console.error("Error in motion detection:",v)}}},N=(e,t)=>{y((n=>({...n,[e]:t})))},E="patient"===(null===w||void 0===w?void 0:w.role);return(0,st.jsx)(aI,{maxWidth:"xl",children:(0,st.jsxs)(qt,{sx:{mt:4,mb:4},children:[v&&(0,st.jsx)(rT,{severity:"error",sx:{mb:3},children:v}),(0,st.jsx)(hI,{variant:"h4",component:"h1",gutterBottom:!0,children:"Patient Monitoring Dashboard"}),(0,st.jsxs)(j_,{container:!0,spacing:3,children:[(0,st.jsx)(j_,{item:!0,xs:12,md:8,children:(0,st.jsxs)(vI,{elevation:2,sx:{p:2},ref:C,children:[(0,st.jsxs)(qt,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,st.jsx)(hI,{variant:"h6",children:"Live Video Feed"}),(0,st.jsx)(Yce,{status:l})]}),(0,st.jsx)(o$,{sx:{mb:2}}),(0,st.jsxs)(qt,{className:"video-container",sx:{position:"relative"},children:[n?(0,st.jsx)(sO(),{ref:e,audio:!1,width:"100%",height:400,screenshotFormat:"image/jpeg",videoConstraints:f?{deviceId:{exact:f}}:{facingMode:"user"},style:{borderRadius:8}}):(0,st.jsx)(qt,{sx:{height:400,backgroundColor:"#000",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:1},children:(0,st.jsx)(hI,{variant:"body1",color:"white",children:E?"Click Start Streaming to begin monitoring":"Waiting for patient to start streaming..."})}),(0,st.jsx)("canvas",{ref:t,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1}}),(0,st.jsx)("div",{className:`status-indicator status-${l}`})]}),(0,st.jsx)(Kce,{isStreaming:n,toggleStreaming:()=>{"patient"===(null===w||void 0===w?void 0:w.role)&&r((e=>!e))},isProcessing:i,selectCamera:e=>{m(e)},selectedCamera:f})]})}),(0,st.jsx)(j_,{item:!0,xs:12,md:4,children:(0,st.jsxs)(j_,{container:!0,spacing:3,direction:"column",children:[(0,st.jsx)(j_,{item:!0,children:(0,st.jsx)(kI,{children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Monitoring Status"}),(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center",mt:2},children:["normal"===l?(0,st.jsx)(eO,{sx:{color:"success.main",mr:1}}):"warning"===l?(0,st.jsx)(tO,{sx:{color:"warning.main",mr:1}}):(0,st.jsx)(tO,{sx:{color:"error.main",mr:1}}),(0,st.jsx)(hI,{variant:"body1",children:"normal"===l?"Normal Activity":"warning"===l?"Unusual Movement Detected":"Potential Fall Detected"})]}),(0,st.jsxs)(qt,{sx:{mt:2},children:[(0,st.jsxs)(hI,{variant:"body2",gutterBottom:!0,children:["ML Analysis: ",i?"Active":"Inactive"]}),(0,st.jsx)(g$,{label:n?"Streaming":"Offline",color:n?"success":"default",size:"small",sx:{mr:1}}),(0,st.jsx)(g$,{label:s?"Model Loaded":"Loading Model",color:s?"primary":"warning",size:"small"})]})]})})}),(0,st.jsx)(j_,{item:!0,children:(0,st.jsx)(kI,{children:(0,st.jsxs)(TI,{children:[(0,st.jsxs)(qt,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Detection Settings"}),(0,st.jsx)(nO,{})]}),(0,st.jsx)(hI,{variant:"body2",gutterBottom:!0,children:"Adjust sensitivity for motion detection alerts"}),(0,st.jsxs)(qt,{sx:{mt:3},children:[(0,st.jsxs)(hI,{id:"sensitivity-slider",gutterBottom:!0,children:["Alert Sensitivity: ",c,"%"]}),(0,st.jsx)(G$,{value:c,onChange:(e,t)=>{d(t)},"aria-labelledby":"sensitivity-slider",valueLabelDisplay:"auto",step:5,marks:!0,min:0,max:100})]}),(0,st.jsx)(qt,{sx:{mt:3},children:(0,st.jsx)(iR,{control:(0,st.jsx)(Z$,{checked:g.enableFallDetection,onChange:e=>N("enableFallDetection",e.target.checked),color:"primary"}),label:"Fall Detection"})}),(0,st.jsx)(qt,{sx:{mt:1},children:(0,st.jsx)(iR,{control:(0,st.jsx)(Z$,{checked:g.enableMotionTracking,onChange:e=>N("enableMotionTracking",e.target.checked),color:"primary"}),label:"Motion Analysis"})})]})})}),(0,st.jsx)(j_,{item:!0,children:(0,st.jsx)(kI,{children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Patient Information"}),(0,st.jsxs)(hI,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["Connected as: ",null===w||void 0===w?void 0:w.firstName," ",null===w||void 0===w?void 0:w.lastName," (",null===w||void 0===w?void 0:w.role,")"]}),(0,st.jsx)(OR,{variant:"outlined",size:"small",onClick:()=>{k({type:"test",severity:"info",title:"Test Alert",message:"This is a test notification to verify that the alert system is working."})},sx:{mt:1},children:"Test Alert System"})]})})})]})})]})]})})}const ede=WC((0,st.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function tde(e){return Vt("MuiAvatar",e)}Wt("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const nde=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],rde=eI("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],n.colorDefault&&t.colorDefault]}})((e=>{let{theme:t}=e;return{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:(0,He.A)({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:(0,He.A)({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]}})),sde=eI("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(e,t)=>t.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),ade=eI(ede,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(e,t)=>t.fallback})({width:"75%",height:"75%"});const ide=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiAvatar"}),{alt:r,children:s,className:a,component:i="div",slots:o={},slotProps:l={},imgProps:u,sizes:c,src:d,srcSet:h,variant:p="circular"}=n,f=(0,qe.A)(n,nde);let m=null;const g=function(e){let{crossOrigin:t,referrerPolicy:n,src:r,srcSet:s}=e;const[a,i]=A.useState(!1);return A.useEffect((()=>{if(!r&&!s)return;i(!1);let e=!0;const a=new Image;return a.onload=()=>{e&&i("loaded")},a.onerror=()=>{e&&i("error")},a.crossOrigin=t,a.referrerPolicy=n,a.src=r,s&&(a.srcset=s),()=>{e=!1}}),[t,n,r,s]),a}((0,He.A)({},u,{src:d,srcSet:h})),y=d||h,v=y&&"error"!==g,b=(0,He.A)({},n,{colorDefault:!v,component:i,variant:p}),x=(e=>{const{classes:t,variant:n,colorDefault:r}=e;return _S({root:["root",n,r&&"colorDefault"],img:["img"],fallback:["fallback"]},tde,t)})(b),[w,k]=PI("img",{className:x.img,elementType:sde,externalForwardedProps:{slots:o,slotProps:{img:(0,He.A)({},u,l.img)}},additionalProps:{alt:r,src:d,srcSet:h,sizes:c},ownerState:b});return m=v?(0,st.jsx)(w,(0,He.A)({},k)):s||0===s?s:y&&r?r[0]:(0,st.jsx)(ade,{ownerState:b,className:x.fallback}),(0,st.jsx)(rde,(0,He.A)({as:i,ownerState:b,className:Xe(x.root,a),ref:t},f,{children:m}))})),ode=ide;let lde;function ude(){if(lde)return lde;const e=document.createElement("div"),t=document.createElement("div");return t.style.width="10px",t.style.height="1px",e.appendChild(t),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e),lde="reverse",e.scrollLeft>0?lde="default":(e.scrollLeft=1,0===e.scrollLeft&&(lde="negative")),document.body.removeChild(e),lde}function cde(e,t){const n=e.scrollLeft;if("rtl"!==t)return n;switch(ude()){case"negative":return e.scrollWidth-e.clientWidth+n;case"reverse":return e.scrollWidth-e.clientWidth-n;default:return n}}function dde(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}const hde=["onChange"],pde={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};const fde=WC((0,st.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft"),mde=WC((0,st.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight");function gde(e){return Vt("MuiTabScrollButton",e)}const yde=Wt("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),vde=["className","slots","slotProps","direction","orientation","disabled"],bde=eI(OC,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.orientation&&t[n.orientation]]}})((e=>{let{ownerState:t}=e;return(0,He.A)({width:40,flexShrink:0,opacity:.8,[`&.${yde.disabled}`]:{opacity:0}},"vertical"===t.orientation&&{width:"100%",height:40,"& svg":{transform:`rotate(${t.isRtl?-90:90}deg)`}})})),xde=A.forwardRef((function(e,t){var n,r;const s=sI({props:e,name:"MuiTabScrollButton"}),{className:a,slots:i={},slotProps:o={},direction:l}=s,u=(0,qe.A)(s,vde),c=$N(),d=(0,He.A)({isRtl:c},s),h=(e=>{const{classes:t,orientation:n,disabled:r}=e;return _S({root:["root",n,r&&"disabled"]},gde,t)})(d),p=null!=(n=i.StartScrollButtonIcon)?n:fde,f=null!=(r=i.EndScrollButtonIcon)?r:mde,m=MN({elementType:p,externalSlotProps:o.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:d}),g=MN({elementType:f,externalSlotProps:o.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:d});return(0,st.jsx)(bde,(0,He.A)({component:"div",className:Xe(h.root,a),ref:t,role:null,ownerState:d,tabIndex:null},u,{children:"left"===l?(0,st.jsx)(p,(0,He.A)({},m)):(0,st.jsx)(f,(0,He.A)({},g))}))}));function wde(e){return Vt("MuiTabs",e)}const kde=Wt("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),Sde=["aria-label","aria-labelledby","action","centered","children","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","slots","slotProps","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"],Ide=(e,t)=>e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:e.firstChild,Cde=(e,t)=>e===t?e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:e.lastChild,Tde=(e,t,n)=>{let r=!1,s=n(e,t);for(;s;){if(s===e.firstChild){if(r)return;r=!0}const t=s.disabled||"true"===s.getAttribute("aria-disabled");if(s.hasAttribute("tabindex")&&!t)return void s.focus();s=n(e,s)}},Nde=eI("div",{name:"MuiTabs",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${kde.scrollButtons}`]:t.scrollButtons},{[`& .${kde.scrollButtons}`]:n.scrollButtonsHideMobile&&t.scrollButtonsHideMobile},t.root,n.vertical&&t.vertical]}})((e=>{let{ownerState:t,theme:n}=e;return(0,He.A)({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},t.vertical&&{flexDirection:"column"},t.scrollButtonsHideMobile&&{[`& .${kde.scrollButtons}`]:{[n.breakpoints.down("sm")]:{display:"none"}}})})),Ede=eI("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.scroller,n.fixed&&t.fixed,n.hideScrollbar&&t.hideScrollbar,n.scrollableX&&t.scrollableX,n.scrollableY&&t.scrollableY]}})((e=>{let{ownerState:t}=e;return(0,He.A)({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},t.fixed&&{overflowX:"hidden",width:"100%"},t.hideScrollbar&&{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},t.scrollableX&&{overflowX:"auto",overflowY:"hidden"},t.scrollableY&&{overflowY:"auto",overflowX:"hidden"})})),Ade=eI("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.flexContainer,n.vertical&&t.flexContainerVertical,n.centered&&t.centered]}})((e=>{let{ownerState:t}=e;return(0,He.A)({display:"flex"},t.vertical&&{flexDirection:"column"},t.centered&&{justifyContent:"center"})})),Rde=eI("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(e,t)=>t.indicator})((e=>{let{ownerState:t,theme:n}=e;return(0,He.A)({position:"absolute",height:2,bottom:0,width:"100%",transition:n.transitions.create()},"primary"===t.indicatorColor&&{backgroundColor:(n.vars||n).palette.primary.main},"secondary"===t.indicatorColor&&{backgroundColor:(n.vars||n).palette.secondary.main},t.vertical&&{height:"100%",width:2,right:0})})),_de=eI((function(e){const{onChange:t}=e,n=(0,qe.A)(e,hde),r=A.useRef(),s=A.useRef(null),a=()=>{r.current=s.current.offsetHeight-s.current.clientHeight};return vT((()=>{const e=YN((()=>{const e=r.current;a(),e!==r.current&&t(r.current)})),n=QN(s.current);return n.addEventListener("resize",e),()=>{e.clear(),n.removeEventListener("resize",e)}}),[t]),A.useEffect((()=>{a(),t(r.current)}),[t]),(0,st.jsx)("div",(0,He.A)({style:pde},n,{ref:s}))}))({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),$de={};const Ode=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiTabs"}),r=oE(),s=$N(),{"aria-label":a,"aria-labelledby":i,action:o,centered:l=!1,children:u,className:c,component:d="div",allowScrollButtonsMobile:h=!1,indicatorColor:p="primary",onChange:f,orientation:m="horizontal",ScrollButtonComponent:g=xde,scrollButtons:y="auto",selectionFollowsFocus:v,slots:b={},slotProps:x={},TabIndicatorProps:w={},TabScrollButtonProps:k={},textColor:S="primary",value:I,variant:C="standard",visibleScrollbar:T=!1}=n,N=(0,qe.A)(n,Sde),E="scrollable"===C,R="vertical"===m,_=R?"scrollTop":"scrollLeft",$=R?"top":"left",O=R?"bottom":"right",D=R?"clientHeight":"clientWidth",M=R?"height":"width",F=(0,He.A)({},n,{component:d,allowScrollButtonsMobile:h,indicatorColor:p,orientation:m,vertical:R,scrollButtons:y,textColor:S,variant:C,visibleScrollbar:T,fixed:!E,hideScrollbar:E&&!T,scrollableX:E&&!R,scrollableY:E&&R,centered:l&&!E,scrollButtonsHideMobile:!h}),L=(e=>{const{vertical:t,fixed:n,hideScrollbar:r,scrollableX:s,scrollableY:a,centered:i,scrollButtonsHideMobile:o,classes:l}=e;return _S({root:["root",t&&"vertical"],scroller:["scroller",n&&"fixed",r&&"hideScrollbar",s&&"scrollableX",a&&"scrollableY"],flexContainer:["flexContainer",t&&"flexContainerVertical",i&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",o&&"scrollButtonsHideMobile"],scrollableX:[s&&"scrollableX"],hideScrollbar:[r&&"hideScrollbar"]},wde,l)})(F),P=MN({elementType:b.StartScrollButtonIcon,externalSlotProps:x.startScrollButtonIcon,ownerState:F}),z=MN({elementType:b.EndScrollButtonIcon,externalSlotProps:x.endScrollButtonIcon,ownerState:F});const[B,j]=A.useState(!1),[U,V]=A.useState($de),[W,G]=A.useState(!1),[H,q]=A.useState(!1),[K,X]=A.useState(!1),[Y,Q]=A.useState({overflow:"hidden",scrollbarWidth:0}),J=new Map,Z=A.useRef(null),ee=A.useRef(null),te=()=>{const e=Z.current;let t,n;if(e){const n=e.getBoundingClientRect();t={clientWidth:e.clientWidth,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,scrollLeftNormalized:cde(e,s?"rtl":"ltr"),scrollWidth:e.scrollWidth,top:n.top,bottom:n.bottom,left:n.left,right:n.right}}if(e&&!1!==I){const e=ee.current.children;if(e.length>0){const t=e[J.get(I)];0,n=t?t.getBoundingClientRect():null}}return{tabsMeta:t,tabMeta:n}},ne=WI((()=>{const{tabsMeta:e,tabMeta:t}=te();let n,r=0;if(R)n="top",t&&e&&(r=t.top-e.top+e.scrollTop);else if(n=s?"right":"left",t&&e){const a=s?e.scrollLeftNormalized+e.clientWidth-e.scrollWidth:e.scrollLeft;r=(s?-1:1)*(t[n]-e[n]+a)}const a={[n]:r,[M]:t?t[M]:0};if(isNaN(U[n])||isNaN(U[M]))V(a);else{const e=Math.abs(U[n]-a[n]),t=Math.abs(U[M]-a[M]);(e>=1||t>=1)&&V(a)}})),re=function(e){let{animation:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t?function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>{};const{ease:a=dde,duration:i=300}=r;let o=null;const l=t[e];let u=!1;const c=()=>{u=!0},d=r=>{if(u)return void s(new Error("Animation cancelled"));null===o&&(o=r);const c=Math.min(1,(r-o)/i);t[e]=a(c)*(n-l)+l,c>=1?requestAnimationFrame((()=>{s(null)})):requestAnimationFrame(d)};l===n?s(new Error("Element already at target position")):requestAnimationFrame(d)}(_,Z.current,e,{duration:r.transitions.duration.standard}):Z.current[_]=e},se=e=>{let t=Z.current[_];R?t+=e:(t+=e*(s?-1:1),t*=s&&"reverse"===ude()?-1:1),re(t)},ae=()=>{const e=Z.current[D];let t=0;const n=Array.from(ee.current.children);for(let r=0;r<n.length;r+=1){const s=n[r];if(t+s[D]>e){0===r&&(t=e);break}t+=s[D]}return t},ie=()=>{se(-1*ae())},oe=()=>{se(ae())},le=A.useCallback((e=>{Q({overflow:null,scrollbarWidth:e})}),[]),ue=WI((e=>{const{tabsMeta:t,tabMeta:n}=te();if(n&&t)if(n[$]<t[$]){const r=t[_]+(n[$]-t[$]);re(r,{animation:e})}else if(n[O]>t[O]){const r=t[_]+(n[O]-t[O]);re(r,{animation:e})}})),ce=WI((()=>{E&&!1!==y&&X(!K)}));A.useEffect((()=>{const e=YN((()=>{Z.current&&ne()}));let t;const n=n=>{n.forEach((e=>{e.removedNodes.forEach((e=>{var n;null==(n=t)||n.unobserve(e)})),e.addedNodes.forEach((e=>{var n;null==(n=t)||n.observe(e)}))})),e(),ce()},r=QN(Z.current);let s;return r.addEventListener("resize",e),"undefined"!==typeof ResizeObserver&&(t=new ResizeObserver(e),Array.from(ee.current.children).forEach((e=>{t.observe(e)}))),"undefined"!==typeof MutationObserver&&(s=new MutationObserver(n),s.observe(ee.current,{childList:!0})),()=>{var n,a;e.clear(),r.removeEventListener("resize",e),null==(n=s)||n.disconnect(),null==(a=t)||a.disconnect()}}),[ne,ce]),A.useEffect((()=>{const e=Array.from(ee.current.children),t=e.length;if("undefined"!==typeof IntersectionObserver&&t>0&&E&&!1!==y){const n=e[0],r=e[t-1],s={root:Z.current,threshold:.99},a=new IntersectionObserver((e=>{G(!e[0].isIntersecting)}),s);a.observe(n);const i=new IntersectionObserver((e=>{q(!e[0].isIntersecting)}),s);return i.observe(r),()=>{a.disconnect(),i.disconnect()}}}),[E,y,K,null==u?void 0:u.length]),A.useEffect((()=>{j(!0)}),[]),A.useEffect((()=>{ne()})),A.useEffect((()=>{ue($de!==U)}),[ue,U]),A.useImperativeHandle(o,(()=>({updateIndicator:ne,updateScrollButtons:ce})),[ne,ce]);const de=(0,st.jsx)(Rde,(0,He.A)({},w,{className:Xe(L.indicator,w.className),ownerState:F,style:(0,He.A)({},U,w.style)}));let he=0;const pe=A.Children.map(u,(e=>{if(!A.isValidElement(e))return null;const t=void 0===e.props.value?he:e.props.value;J.set(t,he);const n=t===I;return he+=1,A.cloneElement(e,(0,He.A)({fullWidth:"fullWidth"===C,indicator:n&&!B&&de,selected:n,selectionFollowsFocus:v,onChange:f,textColor:S,value:t},1!==he||!1!==I||e.props.tabIndex?{}:{tabIndex:0}))})),fe=(()=>{const e={};e.scrollbarSizeListener=E?(0,st.jsx)(_de,{onChange:le,className:Xe(L.scrollableX,L.hideScrollbar)}):null;const t=E&&("auto"===y&&(W||H)||!0===y);return e.scrollButtonStart=t?(0,st.jsx)(g,(0,He.A)({slots:{StartScrollButtonIcon:b.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:P},orientation:m,direction:s?"right":"left",onClick:ie,disabled:!W},k,{className:Xe(L.scrollButtons,k.className)})):null,e.scrollButtonEnd=t?(0,st.jsx)(g,(0,He.A)({slots:{EndScrollButtonIcon:b.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:z},orientation:m,direction:s?"left":"right",onClick:oe,disabled:!H},k,{className:Xe(L.scrollButtons,k.className)})):null,e})();return(0,st.jsxs)(Nde,(0,He.A)({className:Xe(L.root,c),ownerState:F,ref:t,as:d},N,{children:[fe.scrollButtonStart,fe.scrollbarSizeListener,(0,st.jsxs)(Ede,{className:L.scroller,ownerState:F,style:{overflow:Y.overflow,[R?"margin"+(s?"Left":"Right"):"marginBottom"]:T?void 0:-Y.scrollbarWidth},ref:Z,children:[(0,st.jsx)(Ade,{"aria-label":a,"aria-labelledby":i,"aria-orientation":"vertical"===m?"vertical":null,className:L.flexContainer,ownerState:F,onKeyDown:e=>{const t=ee.current,n=AN(t).activeElement;if("tab"!==n.getAttribute("role"))return;let r="horizontal"===m?"ArrowLeft":"ArrowUp",a="horizontal"===m?"ArrowRight":"ArrowDown";switch("horizontal"===m&&s&&(r="ArrowRight",a="ArrowLeft"),e.key){case r:e.preventDefault(),Tde(t,n,Cde);break;case a:e.preventDefault(),Tde(t,n,Ide);break;case"Home":e.preventDefault(),Tde(t,null,Ide);break;case"End":e.preventDefault(),Tde(t,null,Cde)}},ref:ee,role:"tablist",children:pe}),B&&de]}),fe.scrollButtonEnd]}))})),Dde=Ode;function Mde(e){return Vt("MuiTab",e)}const Fde=Wt("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper"]),Lde=["className","disabled","disableFocusRipple","fullWidth","icon","iconPosition","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"],Pde=eI(OC,{name:"MuiTab",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.label&&n.icon&&t.labelIcon,t[`textColor${XS(n.textColor)}`],n.fullWidth&&t.fullWidth,n.wrapped&&t.wrapped,{[`& .${Fde.iconWrapper}`]:t.iconWrapper}]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({},t.typography.button,{maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center"},n.label&&{flexDirection:"top"===n.iconPosition||"bottom"===n.iconPosition?"column":"row"},{lineHeight:1.25},n.icon&&n.label&&{minHeight:72,paddingTop:9,paddingBottom:9,[`& > .${Fde.iconWrapper}`]:(0,He.A)({},"top"===n.iconPosition&&{marginBottom:6},"bottom"===n.iconPosition&&{marginTop:6},"start"===n.iconPosition&&{marginRight:t.spacing(1)},"end"===n.iconPosition&&{marginLeft:t.spacing(1)})},"inherit"===n.textColor&&{color:"inherit",opacity:.6,[`&.${Fde.selected}`]:{opacity:1},[`&.${Fde.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}},"primary"===n.textColor&&{color:(t.vars||t).palette.text.secondary,[`&.${Fde.selected}`]:{color:(t.vars||t).palette.primary.main},[`&.${Fde.disabled}`]:{color:(t.vars||t).palette.text.disabled}},"secondary"===n.textColor&&{color:(t.vars||t).palette.text.secondary,[`&.${Fde.selected}`]:{color:(t.vars||t).palette.secondary.main},[`&.${Fde.disabled}`]:{color:(t.vars||t).palette.text.disabled}},n.fullWidth&&{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},n.wrapped&&{fontSize:t.typography.pxToRem(12)})})),zde=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiTab"}),{className:r,disabled:s=!1,disableFocusRipple:a=!1,fullWidth:i,icon:o,iconPosition:l="top",indicator:u,label:c,onChange:d,onClick:h,onFocus:p,selected:f,selectionFollowsFocus:m,textColor:g="inherit",value:y,wrapped:v=!1}=n,b=(0,qe.A)(n,Lde),x=(0,He.A)({},n,{disabled:s,disableFocusRipple:a,selected:f,icon:!!o,iconPosition:l,label:!!c,fullWidth:i,textColor:g,wrapped:v}),w=(e=>{const{classes:t,textColor:n,fullWidth:r,wrapped:s,icon:a,label:i,selected:o,disabled:l}=e;return _S({root:["root",a&&i&&"labelIcon",`textColor${XS(n)}`,r&&"fullWidth",s&&"wrapped",o&&"selected",l&&"disabled"],iconWrapper:["iconWrapper"]},Mde,t)})(x),k=o&&c&&A.isValidElement(o)?A.cloneElement(o,{className:Xe(w.iconWrapper,o.props.className)}):o;return(0,st.jsxs)(Pde,(0,He.A)({focusRipple:!a,className:Xe(w.root,r),ref:t,role:"tab","aria-selected":f,disabled:s,onClick:e=>{!f&&d&&d(e,y),h&&h(e)},onFocus:e=>{m&&!f&&d&&d(e,y),p&&p(e)},ownerState:x,tabIndex:f?0:-1},b,{children:["top"===l||"start"===l?(0,st.jsxs)(A.Fragment,{children:[k,c]}):(0,st.jsxs)(A.Fragment,{children:[c,k]}),u]}))}));function Bde(e){return Vt("MuiListItem",e)}const jde=Wt("MuiListItem",["root","container","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","padding","button","secondaryAction","selected"]);const Ude=Wt("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function Vde(e){return Vt("MuiListItemSecondaryAction",e)}Wt("MuiListItemSecondaryAction",["root","disableGutters"]);const Wde=["className"],Gde=eI("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.disableGutters&&t.disableGutters]}})((e=>{let{ownerState:t}=e;return(0,He.A)({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"},t.disableGutters&&{right:0})})),Hde=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiListItemSecondaryAction"}),{className:r}=n,s=(0,qe.A)(n,Wde),a=A.useContext(FN),i=(0,He.A)({},n,{disableGutters:a.disableGutters}),o=(e=>{const{disableGutters:t,classes:n}=e;return _S({root:["root",t&&"disableGutters"]},Vde,n)})(i);return(0,st.jsx)(Gde,(0,He.A)({className:Xe(o.root,r),ownerState:i,ref:t},s))}));Hde.muiName="ListItemSecondaryAction";const qde=Hde,Kde=["className"],Xde=["alignItems","autoFocus","button","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disabled","disableGutters","disablePadding","divider","focusVisibleClassName","secondaryAction","selected","slotProps","slots"],Yde=eI("div",{name:"MuiListItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,"flex-start"===n.alignItems&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters,!n.disablePadding&&t.padding,n.button&&t.button,n.hasSecondaryAction&&t.secondaryAction]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left"},!n.disablePadding&&(0,He.A)({paddingTop:8,paddingBottom:8},n.dense&&{paddingTop:4,paddingBottom:4},!n.disableGutters&&{paddingLeft:16,paddingRight:16},!!n.secondaryAction&&{paddingRight:48}),!!n.secondaryAction&&{[`& > .${Ude.root}`]:{paddingRight:48}},{[`&.${jde.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${jde.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,dt.X4)(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${jde.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,dt.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${jde.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}},"flex-start"===n.alignItems&&{alignItems:"flex-start"},n.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},n.button&&{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${jde.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:(0,dt.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,dt.X4)(t.palette.primary.main,t.palette.action.selectedOpacity)}}},n.hasSecondaryAction&&{paddingRight:48})})),Qde=eI("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,t)=>t.container})({position:"relative"}),Jde=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiListItem"}),{alignItems:r="center",autoFocus:s=!1,button:a=!1,children:i,className:o,component:l,components:u={},componentsProps:c={},ContainerComponent:d="li",ContainerProps:{className:h}={},dense:p=!1,disabled:f=!1,disableGutters:m=!1,disablePadding:g=!1,divider:y=!1,focusVisibleClassName:v,secondaryAction:b,selected:x=!1,slotProps:w={},slots:k={}}=n,S=(0,qe.A)(n.ContainerProps,Kde),I=(0,qe.A)(n,Xde),C=A.useContext(FN),T=A.useMemo((()=>({dense:p||C.dense||!1,alignItems:r,disableGutters:m})),[r,C.dense,p,m]),N=A.useRef(null);vT((()=>{s&&N.current&&N.current.focus()}),[s]);const E=A.Children.toArray(i),R=E.length&&gN(E[E.length-1],["ListItemSecondaryAction"]),_=(0,He.A)({},n,{alignItems:r,autoFocus:s,button:a,dense:T.dense,disabled:f,disableGutters:m,disablePadding:g,divider:y,hasSecondaryAction:R,selected:x}),$=(e=>{const{alignItems:t,button:n,classes:r,dense:s,disabled:a,disableGutters:i,disablePadding:o,divider:l,hasSecondaryAction:u,selected:c}=e;return _S({root:["root",s&&"dense",!i&&"gutters",!o&&"padding",l&&"divider",a&&"disabled",n&&"button","flex-start"===t&&"alignItemsFlexStart",u&&"secondaryAction",c&&"selected"],container:["container"]},Bde,r)})(_),O=jI(N,t),D=k.root||u.Root||Yde,M=w.root||c.root||{},F=(0,He.A)({className:Xe($.root,M.className,o),disabled:f},I);let L=l||"li";return a&&(F.component=l||"div",F.focusVisibleClassName=Xe(jde.focusVisible,v),L=OC),R?(L=F.component||l?L:"div","li"===d&&("li"===L?L="div":"li"===F.component&&(F.component="div")),(0,st.jsx)(FN.Provider,{value:T,children:(0,st.jsxs)(Qde,(0,He.A)({as:d,className:Xe($.container,h),ref:O,ownerState:_},S,{children:[(0,st.jsx)(D,(0,He.A)({},M,!AI(D)&&{as:L,ownerState:(0,He.A)({},_,M.ownerState)},F,{children:E})),E.pop()]}))})):(0,st.jsx)(FN.Provider,{value:T,children:(0,st.jsxs)(D,(0,He.A)({},M,{as:L,ref:O},!AI(D)&&{ownerState:(0,He.A)({},_,M.ownerState)},F,{children:[E,b&&(0,st.jsx)(qde,{children:b})]}))})}));function Zde(e){return Vt("MuiListItemAvatar",e)}Wt("MuiListItemAvatar",["root","alignItemsFlexStart"]);const ehe=["className"],the=eI("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"flex-start"===n.alignItems&&t.alignItemsFlexStart]}})((e=>{let{ownerState:t}=e;return(0,He.A)({minWidth:56,flexShrink:0},"flex-start"===t.alignItems&&{marginTop:8})})),nhe=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiListItemAvatar"}),{className:r}=n,s=(0,qe.A)(n,ehe),a=A.useContext(FN),i=(0,He.A)({},n,{alignItems:a.alignItems}),o=(e=>{const{alignItems:t,classes:n}=e;return _S({root:["root","flex-start"===t&&"alignItemsFlexStart"]},Zde,n)})(i);return(0,st.jsx)(the,(0,He.A)({className:Xe(o.root,r),ownerState:i,ref:t},s))})),rhe=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],she=eI("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${q_.primary}`]:t.primary},{[`& .${q_.secondary}`]:t.secondary},t.root,n.inset&&t.inset,n.primary&&n.secondary&&t.multiline,n.dense&&t.dense]}})((e=>{let{ownerState:t}=e;return(0,He.A)({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},t.primary&&t.secondary&&{marginTop:6,marginBottom:6},t.inset&&{paddingLeft:56})})),ahe=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiListItemText"}),{children:r,className:s,disableTypography:a=!1,inset:i=!1,primary:o,primaryTypographyProps:l,secondary:u,secondaryTypographyProps:c}=n,d=(0,qe.A)(n,rhe),{dense:h}=A.useContext(FN);let p=null!=o?o:r,f=u;const m=(0,He.A)({},n,{disableTypography:a,inset:i,primary:!!p,secondary:!!f,dense:h}),g=(e=>{const{classes:t,inset:n,primary:r,secondary:s,dense:a}=e;return _S({root:["root",n&&"inset",a&&"dense",r&&s&&"multiline"],primary:["primary"],secondary:["secondary"]},H_,t)})(m);return null==p||p.type===hI||a||(p=(0,st.jsx)(hI,(0,He.A)({variant:h?"body2":"body1",className:g.primary,component:null!=l&&l.variant?void 0:"span",display:"block"},l,{children:p}))),null==f||f.type===hI||a||(f=(0,st.jsx)(hI,(0,He.A)({variant:"body2",className:g.secondary,color:"text.secondary",display:"block"},c,{children:f}))),(0,st.jsxs)(she,(0,He.A)({className:Xe(g.root,s),ownerState:m,ref:t},d,{children:[p,f]}))})),ihe=WC([(0,st.jsx)("circle",{cx:"12",cy:"12",r:"3.2"},"0"),(0,st.jsx)("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"PhotoCamera"),ohe=WC((0,st.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save"),lhe=WC((0,st.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel"),uhe=WC((0,st.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit"),che=WC((0,st.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person"),dhe=WC((0,st.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-2 12H6v-2h12zm0-3H6V9h12zm0-3H6V6h12z"}),"Message"),hhe=WC((0,st.jsx)("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2"}),"Timeline"),phe=WC((0,st.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");function fhe(e){const{children:t,value:n,index:r,...s}=e;return(0,st.jsx)("div",{role:"tabpanel",hidden:n!==r,id:`profile-tabpanel-${r}`,"aria-labelledby":`profile-tab-${r}`,...s,children:n===r&&(0,st.jsx)(qt,{sx:{p:3},children:t})})}function mhe(){var e;const{currentUser:t,userProfile:n,updateUserProfile:r}=fS(),{createAlert:s}=lue(),[a,i]=(0,A.useState)(!1),[o,l]=(0,A.useState)(!1),[u,c]=(0,A.useState)(""),[d,h]=(0,A.useState)(""),[p,f]=(0,A.useState)(0),[m,g]=(0,A.useState)([]),[y,v]=(0,A.useState)(""),[b,x]=(0,A.useState)(""),[w,k]=(0,A.useState)({firstName:"",lastName:"",bio:"",phoneNumber:"",address:"",emergencyContact:"",preferences:{theme:"light",notifications:!0}});(0,A.useEffect)((()=>{n&&(k({firstName:n.firstName||"",lastName:n.lastName||"",bio:n.bio||"",phoneNumber:n.phoneNumber||"",address:n.address||"",emergencyContact:n.emergencyContact||"",preferences:n.preferences||{theme:"light",notifications:!0}}),n.profileImageUrl&&x(n.profileImageUrl))}),[n]),(0,A.useEffect)((()=>{if(!t)return;return Fb(pb(Ev(cS,"familyMessages"),yb("timestamp","desc")),(e=>{const t=e.docs.map((e=>{var t;return{id:e.id,...e.data(),timestamp:null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate()}}));g(t)}))}),[t]);return(0,st.jsx)(aI,{maxWidth:"lg",children:(0,st.jsxs)(qt,{sx:{mt:4,mb:8},children:[(0,st.jsx)(hI,{variant:"h4",component:"h1",gutterBottom:!0,children:"User Profile"}),u&&(0,st.jsx)(rT,{severity:"error",sx:{mb:2},children:u}),d&&(0,st.jsx)(rT,{severity:"success",sx:{mb:2},children:d}),(0,st.jsxs)(vI,{elevation:3,sx:{p:0,overflow:"hidden"},children:[(0,st.jsx)(qt,{sx:{p:4,background:"linear-gradient(45deg, #2196F3 30%, #21CBF3 90%)",color:"white",position:"relative"},children:(0,st.jsxs)(j_,{container:!0,spacing:3,alignItems:"center",children:[(0,st.jsx)(j_,{item:!0,children:(0,st.jsxs)(qt,{sx:{position:"relative"},children:[(0,st.jsxs)(ode,{src:b,alt:`${w.firstName} ${w.lastName}`,sx:{width:120,height:120,border:"4px solid white"},children:[w.firstName.charAt(0),w.lastName.charAt(0)]}),(0,st.jsx)("input",{accept:"image/*",style:{display:"none"},id:"icon-button-file",type:"file",onChange:async e=>{const n=e.target.files[0];if(n){l(!0),c("");try{const e=(o=dS,d=`profileImages/${t.uid}`,Qx(o=kn(o),d));await(s=e,a=n,qx(s=kn(s),a,i));const l=await function(e){return Kx(e=kn(e))}(e);await r({profileImageUrl:l}),x(l),h("Profile image updated successfully!"),setTimeout((()=>h("")),3e3)}catch(u){c("Failed to upload image: "+u.message)}finally{l(!1)}var s,a,i,o,d}}}),(0,st.jsx)("label",{htmlFor:"icon-button-file",children:(0,st.jsx)(PC,{color:"primary","aria-label":"upload picture",component:"span",sx:{position:"absolute",bottom:0,right:0,bgcolor:"white","&:hover":{bgcolor:"#f5f5f5"}},children:(0,st.jsx)(ihe,{})})})]})}),(0,st.jsxs)(j_,{item:!0,xs:!0,children:[(0,st.jsxs)(hI,{variant:"h4",children:[w.firstName," ",w.lastName]}),(0,st.jsx)(hI,{variant:"subtitle1",children:"patient"===(null===n||void 0===n?void 0:n.role)?"Patient":"primary_caregiver"===(null===n||void 0===n?void 0:n.role)?"Primary Caregiver":"secondary_caregiver"===(null===n||void 0===n?void 0:n.role)?"Secondary Caregiver":"Family Member"}),(0,st.jsx)(hI,{variant:"body1",sx:{mt:1},children:a?(0,st.jsx)(GA,{multiline:!0,fullWidth:!0,variant:"outlined",size:"small",placeholder:"Write a short bio...",value:w.bio,onChange:e=>k({...w,bio:e.target.value}),sx:{bgcolor:"rgba(255, 255, 255, 0.8)",mt:1}}):w.bio||"No bio provided yet."})]}),(0,st.jsx)(j_,{item:!0,children:a?(0,st.jsxs)(qt,{children:[(0,st.jsx)(OR,{variant:"contained",startIcon:(0,st.jsx)(ohe,{}),onClick:async()=>{l(!0),c("");try{await r({firstName:w.firstName,lastName:w.lastName,bio:w.bio,phoneNumber:w.phoneNumber,address:w.address,emergencyContact:w.emergencyContact,preferences:w.preferences}),i(!1),h("Profile updated successfully!"),s({type:"profile_update",severity:"info",title:"Profile Updated",message:"Your profile information has been updated successfully."}),setTimeout((()=>h("")),3e3)}catch(u){c("Failed to update profile: "+u.message)}finally{l(!1)}},disabled:o,sx:{mr:1},children:"Save"}),(0,st.jsx)(OR,{variant:"outlined",startIcon:(0,st.jsx)(lhe,{}),onClick:()=>i(!1),sx:{bgcolor:"white"},children:"Cancel"})]}):(0,st.jsx)(OR,{variant:"contained",startIcon:(0,st.jsx)(uhe,{}),onClick:()=>i(!0),sx:{bgcolor:"white",color:"primary.main"},children:"Edit Profile"})})]})}),(0,st.jsx)(qt,{sx:{borderBottom:1,borderColor:"divider"},children:(0,st.jsxs)(Dde,{value:p,onChange:(e,t)=>{f(t)},"aria-label":"profile tabs",children:[(0,st.jsx)(zde,{label:"Profile Information",icon:(0,st.jsx)(che,{}),iconPosition:"start"}),(0,st.jsx)(zde,{label:"Family Board",icon:(0,st.jsx)(dhe,{}),iconPosition:"start"}),(0,st.jsx)(zde,{label:"Activity",icon:(0,st.jsx)(hhe,{}),iconPosition:"start"})]})}),(0,st.jsx)(fhe,{value:p,index:0,children:(0,st.jsxs)(j_,{container:!0,spacing:3,children:[(0,st.jsx)(j_,{item:!0,xs:12,md:6,children:(0,st.jsx)(kI,{variant:"outlined",sx:{mb:2},children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Contact Information"}),(0,st.jsxs)(j_,{container:!0,spacing:2,children:[(0,st.jsx)(j_,{item:!0,xs:12,children:(0,st.jsx)(GA,{fullWidth:!0,label:"First Name",value:w.firstName,onChange:e=>k({...w,firstName:e.target.value}),disabled:!a,margin:"normal"})}),(0,st.jsx)(j_,{item:!0,xs:12,children:(0,st.jsx)(GA,{fullWidth:!0,label:"Last Name",value:w.lastName,onChange:e=>k({...w,lastName:e.target.value}),disabled:!a,margin:"normal"})}),(0,st.jsx)(j_,{item:!0,xs:12,children:(0,st.jsx)(GA,{fullWidth:!0,label:"Email Address",value:null===t||void 0===t?void 0:t.email,disabled:!0,margin:"normal"})}),(0,st.jsx)(j_,{item:!0,xs:12,children:(0,st.jsx)(GA,{fullWidth:!0,label:"Phone Number",value:w.phoneNumber,onChange:e=>k({...w,phoneNumber:e.target.value}),disabled:!a,margin:"normal"})})]})]})})}),(0,st.jsxs)(j_,{item:!0,xs:12,md:6,children:[(0,st.jsx)(kI,{variant:"outlined",sx:{mb:2},children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Additional Information"}),(0,st.jsxs)(j_,{container:!0,spacing:2,children:[(0,st.jsx)(j_,{item:!0,xs:12,children:(0,st.jsx)(GA,{fullWidth:!0,label:"Address",value:w.address,onChange:e=>k({...w,address:e.target.value}),disabled:!a,margin:"normal",multiline:!0,rows:2})}),(0,st.jsx)(j_,{item:!0,xs:12,children:(0,st.jsx)(GA,{fullWidth:!0,label:"Emergency Contact",value:w.emergencyContact,onChange:e=>k({...w,emergencyContact:e.target.value}),disabled:!a,margin:"normal"})})]})]})}),(0,st.jsx)(kI,{variant:"outlined",children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Account Settings"}),(0,st.jsxs)(qt,{sx:{mt:2},children:[(0,st.jsx)(g$,{label:`Role: ${(null===n||void 0===n?void 0:n.role)||"User"}`,color:"primary",sx:{mr:1,mb:1}}),(0,st.jsx)(g$,{label:`Account Created: ${(null===t||void 0===t||null===(e=t.metadata)||void 0===e?void 0:e.creationTime)||"Unknown"}`,variant:"outlined",sx:{mb:1}})]})]})})]})]})}),(0,st.jsxs)(fhe,{value:p,index:1,children:[(0,st.jsxs)(qt,{sx:{mb:3},children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Family Message Board"}),(0,st.jsx)(hI,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Use this board to leave messages, notes, and updates for your family members."}),(0,st.jsxs)(qt,{sx:{mt:3,display:"flex"},children:[(0,st.jsx)(GA,{fullWidth:!0,label:"Write a message to the family",multiline:!0,rows:2,value:y,onChange:e=>v(e.target.value),sx:{mr:2}}),(0,st.jsx)(OR,{variant:"contained",endIcon:(0,st.jsx)(phe,{}),onClick:async()=>{if(y.trim())try{await Mb(Ev(cS,"familyMessages"),{userId:t.uid,senderName:`${n.firstName} ${n.lastName}`,senderRole:n.role,message:y,timestamp:Yd.now()}),v(""),s({type:"new_message",severity:"info",title:"New Family Message",message:`${n.firstName} has posted a new message to the family board.`})}catch(u){c("Failed to send message: "+u.message)}},disabled:!y.trim(),sx:{alignSelf:"flex-end",mb:1},children:"Send"})]})]}),(0,st.jsx)(o$,{sx:{my:3}}),(0,st.jsx)(BN,{sx:{width:"100%",bgcolor:"background.paper"},children:0===m.length?(0,st.jsx)(hI,{variant:"body2",color:"text.secondary",align:"center",sx:{p:3},children:"No messages yet. Be the first to post!"}):m.map((e=>{var t;return(0,st.jsxs)(A.Fragment,{children:[(0,st.jsxs)(Jde,{alignItems:"flex-start",children:[(0,st.jsx)(nhe,{children:(0,st.jsx)(ode,{children:e.senderName.charAt(0)})}),(0,st.jsx)(ahe,{primary:(0,st.jsxs)(qt,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,st.jsxs)(hI,{component:"span",variant:"subtitle1",children:[e.senderName,(0,st.jsx)(g$,{label:e.senderRole,size:"small",sx:{ml:1,height:20,fontSize:"0.7rem"}})]}),(0,st.jsx)(hI,{component:"span",variant:"body2",color:"text.secondary",children:(null===(t=e.timestamp)||void 0===t?void 0:t.toLocaleString())||"Just now"})]}),secondary:e.message})]}),(0,st.jsx)(o$,{variant:"inset",component:"li"})]},e.id)}))})]}),(0,st.jsxs)(fhe,{value:p,index:2,children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Recent Activity"}),(0,st.jsx)(ghe,{})]})]})]})})}function ghe(){return(0,st.jsx)(qt,{sx:{p:2},children:(0,st.jsx)(BN,{children:[...Array(5)].map(((e,t)=>(0,st.jsxs)(Jde,{sx:{pb:2},children:[(0,st.jsx)(nhe,{children:(0,st.jsx)(ode,{sx:{bgcolor:t%2===0?"primary.main":"secondary.main"},children:t%2===0?(0,st.jsx)(che,{}):(0,st.jsx)(hhe,{})})}),(0,st.jsx)(ahe,{primary:`${t%2===0?"Login Activity":"Profile Update"} ${t+1}`,secondary:`${new Date(Date.now()-864e5*t).toLocaleDateString()} - ${t%2===0?"User logged in successfully":"User updated their profile information"}`})]},t)))})})}const yhe=e=>{const t=A.useRef({});return A.useEffect((()=>{t.current=e})),t.current};const vhe=function(e){const{badgeContent:t,invisible:n=!1,max:r=99,showZero:s=!1}=e,a=yhe({badgeContent:t,max:r});let i=n;!1!==n||0!==t||s||(i=!0);const{badgeContent:o,max:l=r}=i?a:e;return{badgeContent:o,invisible:i,max:l,displayValue:o&&Number(o)>l?`${l}+`:o}};function bhe(e){return Vt("MuiBadge",e)}const xhe=Wt("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),whe=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],khe=eI("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),She=eI("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${XS(n.anchorOrigin.vertical)}${XS(n.anchorOrigin.horizontal)}${XS(n.overlap)}`],"default"!==n.color&&t[`color${XS(n.color)}`],n.invisible&&t.invisible]}})((e=>{let{theme:t}=e;var n;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(12),minWidth:20,lineHeight:1,padding:"0 6px",height:20,borderRadius:10,zIndex:1,transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.enteringScreen}),variants:[...Object.keys((null!=(n=t.vars)?n:t).palette).filter((e=>{var n,r;return(null!=(n=t.vars)?n:t).palette[e].main&&(null!=(r=t.vars)?r:t).palette[e].contrastText})).map((e=>({props:{color:e},style:{backgroundColor:(t.vars||t).palette[e].main,color:(t.vars||t).palette[e].contrastText}}))),{props:{variant:"dot"},style:{borderRadius:4,height:8,minWidth:8,padding:0}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${xhe.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${xhe.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${xhe.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${xhe.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${xhe.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${xhe.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${xhe.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${xhe.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.leavingScreen})}}]}})),Ihe=A.forwardRef((function(e,t){var n,r,s,a,i,o;const l=sI({props:e,name:"MuiBadge"}),{anchorOrigin:u={vertical:"top",horizontal:"right"},className:c,component:d,components:h={},componentsProps:p={},children:f,overlap:m="rectangular",color:g="default",invisible:y=!1,max:v=99,badgeContent:b,slots:x,slotProps:w,showZero:k=!1,variant:S="standard"}=l,I=(0,qe.A)(l,whe),{badgeContent:C,invisible:T,max:N,displayValue:E}=vhe({max:v,invisible:y,badgeContent:b,showZero:k}),A=yhe({anchorOrigin:u,color:g,overlap:m,variant:S,badgeContent:b}),R=T||null==C&&"dot"!==S,{color:_=g,overlap:$=m,anchorOrigin:O=u,variant:D=S}=R?A:l,M="dot"!==D?E:void 0,F=(0,He.A)({},l,{badgeContent:C,invisible:R,max:N,displayValue:M,showZero:k,anchorOrigin:O,color:_,overlap:$,variant:D}),L=(e=>{const{color:t,anchorOrigin:n,invisible:r,overlap:s,variant:a,classes:i={}}=e;return _S({root:["root"],badge:["badge",a,r&&"invisible",`anchorOrigin${XS(n.vertical)}${XS(n.horizontal)}`,`anchorOrigin${XS(n.vertical)}${XS(n.horizontal)}${XS(s)}`,`overlap${XS(s)}`,"default"!==t&&`color${XS(t)}`]},bhe,i)})(F),P=null!=(n=null!=(r=null==x?void 0:x.root)?r:h.Root)?n:khe,z=null!=(s=null!=(a=null==x?void 0:x.badge)?a:h.Badge)?s:She,B=null!=(i=null==w?void 0:w.root)?i:p.root,j=null!=(o=null==w?void 0:w.badge)?o:p.badge,U=MN({elementType:P,externalSlotProps:B,externalForwardedProps:I,additionalProps:{ref:t,as:d},ownerState:F,className:Xe(null==B?void 0:B.className,L.root,c)}),V=MN({elementType:z,externalSlotProps:j,ownerState:F,className:Xe(L.badge,null==j?void 0:j.className)});return(0,st.jsxs)(P,(0,He.A)({},U,{children:[f,(0,st.jsx)(z,(0,He.A)({},V,{children:M}))]}))})),Che=Ihe,The=WC((0,st.jsx)("path",{d:"M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4"}),"PersonOutline"),Nhe=WC((0,st.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info"),Ehe=WC((0,st.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),Ahe=WC((0,st.jsx)("path",{d:"M7.58 4.08 6.15 2.65C3.75 4.48 2.17 7.3 2.03 10.5h2c.15-2.65 1.51-4.97 3.55-6.42m12.39 6.42h2c-.15-3.2-1.73-6.02-4.12-7.85l-1.42 1.43c2.02 1.45 3.39 3.77 3.54 6.42M18 11c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-6 11c.14 0 .27-.01.4-.04.65-.14 1.18-.58 1.44-1.18.1-.24.15-.5.15-.78h-4c.01 1.1.9 2 2.01 2"}),"NotificationsActive"),Rhe=WC((0,st.jsx)("path",{d:"m17.34 20-3.54-3.54 1.41-1.41 2.12 2.12 4.24-4.24L23 14.34zM12 17c0-3.87 3.13-7 7-7 1.08 0 2.09.25 3 .68V4c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v18l4-4h6c0-.17.01-.33.03-.5-.02-.16-.03-.33-.03-.5"}),"MarkChatRead"),_he=WC([(0,st.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,st.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"AccessTime"),$he=WC((0,st.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");function Ohe(e){const{children:t,value:n,index:r,...s}=e;return(0,st.jsx)("div",{role:"tabpanel",hidden:n!==r,id:`notifications-tabpanel-${r}`,"aria-labelledby":`notifications-tab-${r}`,...s,children:n===r&&(0,st.jsx)(qt,{sx:{p:3},children:t})})}function Dhe(){const{notifications:e,systemNotifications:t,markAlertAsRead:n}=lue(),[r,s]=(0,A.useState)(0),a=e.filter((e=>!e.read)).length,i=async e=>{await n(e)},o=e=>"fall_detected"===e.type||"critical"===e.severity?(0,st.jsx)(Xce,{color:"error"}):"motion_detected"===e.type||"warning"===e.severity?(0,st.jsx)(tO,{color:"warning"}):"user_login"===e.type||"profile_update"===e.type?(0,st.jsx)(The,{color:"info"}):(0,st.jsx)(Nhe,{color:"primary"});return(0,st.jsx)(aI,{maxWidth:"lg",children:(0,st.jsxs)(qt,{sx:{mt:4,mb:8},children:[(0,st.jsxs)(qt,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,st.jsx)(hI,{variant:"h4",component:"h1",children:"Notifications"}),(0,st.jsx)(Che,{badgeContent:a,color:"error",children:(0,st.jsx)(Ehe,{color:"action"})})]}),(0,st.jsxs)(vI,{elevation:3,sx:{mb:4},children:[(0,st.jsx)(qt,{sx:{borderBottom:1,borderColor:"divider"},children:(0,st.jsxs)(Dde,{value:r,onChange:(e,t)=>{s(t)},"aria-label":"notification tabs",children:[(0,st.jsx)(zde,{label:(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center"},children:[(0,st.jsx)(Ehe,{sx:{mr:1}}),"My Notifications",a>0&&(0,st.jsx)(g$,{label:a,color:"error",size:"small",sx:{ml:1,height:20,minWidth:20}})]})}),(0,st.jsx)(zde,{label:(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center"},children:[(0,st.jsx)(Ahe,{sx:{mr:1}}),"System Alerts"]})})]})}),(0,st.jsx)(Ohe,{value:r,index:0,children:0===e.length?(0,st.jsxs)(qt,{sx:{textAlign:"center",py:4},children:[(0,st.jsx)(Ehe,{sx:{fontSize:60,color:"text.secondary",mb:2}}),(0,st.jsx)(hI,{variant:"h6",color:"text.secondary",children:"No notifications"}),(0,st.jsx)(hI,{variant:"body2",color:"text.secondary",children:"You don't have any notifications yet"})]}):(0,st.jsx)(BN,{children:e.map((e=>{var t;return(0,st.jsxs)(A.Fragment,{children:[(0,st.jsxs)(Jde,{alignItems:"flex-start",secondaryAction:!e.read&&(0,st.jsx)(PC,{edge:"end","aria-label":"mark as read",onClick:()=>i(e.id),children:(0,st.jsx)(Rhe,{})}),sx:{bgcolor:e.read?"transparent":"action.hover",position:"relative"},children:[(0,st.jsx)(nhe,{children:(0,st.jsx)(ode,{sx:{bgcolor:"critical"===e.severity?"error.main":"warning"===e.severity?"warning.main":"primary.main"},children:o(e)})}),(0,st.jsx)(ahe,{primary:(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center"},children:[(0,st.jsx)(hI,{variant:"subtitle1",sx:{fontWeight:e.read?"normal":"bold"},children:e.title}),!e.read&&(0,st.jsx)(g$,{label:"New",color:"primary",size:"small",sx:{ml:1,height:20}})]}),secondary:(0,st.jsxs)(st.Fragment,{children:[(0,st.jsx)(hI,{component:"span",variant:"body2",color:"text.primary",sx:{display:"block"},children:e.message}),(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center",mt:1},children:[(0,st.jsx)(_he,{fontSize:"small",sx:{mr:.5,fontSize:16,color:"text.secondary"}}),(0,st.jsx)(hI,{component:"span",variant:"caption",color:"text.secondary",children:(null===(t=e.timestamp)||void 0===t?void 0:t.toLocaleString())||"Just now"})]})]})})]}),(0,st.jsx)(o$,{variant:"inset",component:"li"})]},e.id)}))})}),(0,st.jsx)(Ohe,{value:r,index:1,children:0===t.length?(0,st.jsxs)(qt,{sx:{textAlign:"center",py:4},children:[(0,st.jsx)(Ahe,{sx:{fontSize:60,color:"text.secondary",mb:2}}),(0,st.jsx)(hI,{variant:"h6",color:"text.secondary",children:"No system alerts"}),(0,st.jsx)(hI,{variant:"body2",color:"text.secondary",children:"There are no system-wide notifications at this time"})]}):(0,st.jsx)(BN,{children:t.map((e=>{var t;return(0,st.jsxs)(A.Fragment,{children:[(0,st.jsxs)(Jde,{alignItems:"flex-start",sx:{position:"relative"},children:[(0,st.jsx)(nhe,{children:(0,st.jsx)(ode,{sx:{bgcolor:"info.main"},children:o(e)})}),(0,st.jsx)(ahe,{primary:(0,st.jsx)(hI,{variant:"subtitle1",children:e.title}),secondary:(0,st.jsxs)(st.Fragment,{children:[(0,st.jsx)(hI,{component:"span",variant:"body2",color:"text.primary",sx:{display:"block"},children:e.message}),(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center",mt:1},children:[(0,st.jsx)(_he,{fontSize:"small",sx:{mr:.5,fontSize:16,color:"text.secondary"}}),(0,st.jsx)(hI,{component:"span",variant:"caption",color:"text.secondary",children:(null===(t=e.timestamp)||void 0===t?void 0:t.toLocaleString())||"Just now"})]})]})})]}),(0,st.jsx)(o$,{variant:"inset",component:"li"})]},e.id)}))})})]}),(0,st.jsxs)(j_,{container:!0,spacing:3,children:[(0,st.jsx)(j_,{item:!0,xs:12,md:4,children:(0,st.jsx)(kI,{children:(0,st.jsxs)(TI,{children:[(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,st.jsx)(Che,{badgeContent:a,color:"error",sx:{mr:2},children:(0,st.jsx)(Ehe,{fontSize:"large",color:"primary"})}),(0,st.jsx)(hI,{variant:"h6",children:"My Notifications"})]}),(0,st.jsxs)(hI,{variant:"body2",color:"text.secondary",children:["You have ",a," unread ",1===a?"notification":"notifications"," and ",e.length," total."]}),(0,st.jsx)(OR,{variant:"outlined",size:"small",startIcon:(0,st.jsx)($he,{}),sx:{mt:2},disabled:0===a,onClick:()=>{e.forEach((e=>{e.read||i(e.id)}))},children:"Mark All as Read"})]})})}),(0,st.jsx)(j_,{item:!0,xs:12,md:4,children:(0,st.jsx)(kI,{children:(0,st.jsxs)(TI,{children:[(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,st.jsx)(tO,{fontSize:"large",color:"warning",sx:{mr:2}}),(0,st.jsx)(hI,{variant:"h6",children:"Alerts"})]}),(0,st.jsxs)(hI,{variant:"body2",color:"text.secondary",children:[e.filter((e=>"warning"===e.severity||"critical"===e.severity)).length," alert notifications in the last 24 hours."]})]})})}),(0,st.jsx)(j_,{item:!0,xs:12,md:4,children:(0,st.jsx)(kI,{children:(0,st.jsxs)(TI,{children:[(0,st.jsxs)(qt,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,st.jsx)(Nhe,{fontSize:"large",color:"info",sx:{mr:2}}),(0,st.jsx)(hI,{variant:"h6",children:"System Status"})]}),(0,st.jsxs)(hI,{variant:"body2",color:"text.secondary",children:["All systems operational. ",t.length," system ",1===t.length?"notification":"notifications"," available."]})]})})})]})]})})}function Mhe(e){return Vt("MuiAppBar",e)}Wt("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const Fhe=["className","color","enableColorOnDark","position"],Lhe=(e,t)=>e?`${null==e?void 0:e.replace(")","")}, ${t})`:t,Phe=eI(vI,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${XS(n.position)}`],t[`color${XS(n.color)}`]]}})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[900];return(0,He.A)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===n.position&&{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===n.position&&{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},"sticky"===n.position&&{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},"static"===n.position&&{position:"static"},"relative"===n.position&&{position:"relative"},!t.vars&&(0,He.A)({},"default"===n.color&&{backgroundColor:r,color:t.palette.getContrastText(r)},n.color&&"default"!==n.color&&"inherit"!==n.color&&"transparent"!==n.color&&{backgroundColor:t.palette[n.color].main,color:t.palette[n.color].contrastText},"inherit"===n.color&&{color:"inherit"},"dark"===t.palette.mode&&!n.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===n.color&&(0,He.A)({backgroundColor:"transparent",color:"inherit"},"dark"===t.palette.mode&&{backgroundImage:"none"})),t.vars&&(0,He.A)({},"default"===n.color&&{"--AppBar-background":n.enableColorOnDark?t.vars.palette.AppBar.defaultBg:Lhe(t.vars.palette.AppBar.darkBg,t.vars.palette.AppBar.defaultBg),"--AppBar-color":n.enableColorOnDark?t.vars.palette.text.primary:Lhe(t.vars.palette.AppBar.darkColor,t.vars.palette.text.primary)},n.color&&!n.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":n.enableColorOnDark?t.vars.palette[n.color].main:Lhe(t.vars.palette.AppBar.darkBg,t.vars.palette[n.color].main),"--AppBar-color":n.enableColorOnDark?t.vars.palette[n.color].contrastText:Lhe(t.vars.palette.AppBar.darkColor,t.vars.palette[n.color].contrastText)},!["inherit","transparent"].includes(n.color)&&{backgroundColor:"var(--AppBar-background)"},{color:"inherit"===n.color?"inherit":"var(--AppBar-color)"},"transparent"===n.color&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))})),zhe=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiAppBar"}),{className:r,color:s="primary",enableColorOnDark:a=!1,position:i="fixed"}=n,o=(0,qe.A)(n,Fhe),l=(0,He.A)({},n,{color:s,position:i,enableColorOnDark:a}),u=(e=>{const{color:t,position:n,classes:r}=e;return _S({root:["root",`color${XS(t)}`,`position${XS(n)}`]},Mhe,r)})(l);return(0,st.jsx)(Phe,(0,He.A)({square:!0,component:"header",ownerState:l,elevation:4,className:Xe(u.root,r,"fixed"===i&&"mui-fixed"),ref:t},o))}));function Bhe(e){return Vt("MuiToolbar",e)}Wt("MuiToolbar",["root","gutters","regular","dense"]);const jhe=["className","component","disableGutters","variant"],Uhe=eI("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableGutters&&t.gutters,t[n.variant]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({position:"relative",display:"flex",alignItems:"center"},!n.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}},"dense"===n.variant&&{minHeight:48})}),(e=>{let{theme:t,ownerState:n}=e;return"regular"===n.variant&&t.mixins.toolbar})),Vhe=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiToolbar"}),{className:r,component:s="div",disableGutters:a=!1,variant:i="regular"}=n,o=(0,qe.A)(n,jhe),l=(0,He.A)({},n,{component:s,disableGutters:a,variant:i}),u=(e=>{const{classes:t,disableGutters:n,variant:r}=e;return _S({root:["root",!n&&"gutters",r]},Bhe,t)})(l);return(0,st.jsx)(Uhe,(0,He.A)({as:s,className:Xe(u.root,r),ref:t,ownerState:l},o))})),Whe=Vhe;function Ghe(e){return Vt("MuiLink",e)}const Hhe=Wt("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]);var qhe=n(7162);const Khe={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Xhe=e=>{let{theme:t,ownerState:n}=e;const r=(e=>Khe[e]||e)(n.color),s=(0,qhe.Yn)(t,`palette.${r}`,!1)||n.color,a=(0,qhe.Yn)(t,`palette.${r}Channel`);return"vars"in t&&a?`rgba(${a} / 0.4)`:(0,dt.X4)(s,.4)},Yhe=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],Qhe=eI(hI,{name:"MuiLink",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`underline${XS(n.underline)}`],"button"===n.component&&t.button]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({},"none"===n.underline&&{textDecoration:"none"},"hover"===n.underline&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},"always"===n.underline&&(0,He.A)({textDecoration:"underline"},"inherit"!==n.color&&{textDecorationColor:Xhe({theme:t,ownerState:n})},{"&:hover":{textDecorationColor:"inherit"}}),"button"===n.component&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Hhe.focusVisible}`]:{outline:"auto"}})})),Jhe=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiLink"}),{className:r,color:s="primary",component:a="a",onBlur:i,onFocus:o,TypographyClasses:l,underline:u="always",variant:c="inherit",sx:d}=n,h=(0,qe.A)(n,Yhe),{isFocusVisibleRef:p,onBlur:f,onFocus:m,ref:g}=sC(),[y,v]=A.useState(!1),b=jI(t,g),x=(0,He.A)({},n,{color:s,component:a,focusVisible:y,underline:u,variant:c}),w=(e=>{const{classes:t,component:n,focusVisible:r,underline:s}=e;return _S({root:["root",`underline${XS(s)}`,"button"===n&&"button",r&&"focusVisible"]},Ghe,t)})(x);return(0,st.jsx)(Qhe,(0,He.A)({color:s,className:Xe(w.root,r),classes:l,component:a,onBlur:e=>{f(e),!1===p.current&&v(!1),i&&i(e)},onFocus:e=>{m(e),!0===p.current&&v(!0),o&&o(e)},ref:b,ownerState:x,variant:c,sx:[...Object.keys(Khe).includes(s)?[]:[{color:s}],...Array.isArray(d)?d:[d]]},h))})),Zhe=Jhe,epe=["className"],tpe=eI("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"flex-start"===n.alignItems&&t.alignItemsFlexStart]}})((e=>{let{theme:t,ownerState:n}=e;return(0,He.A)({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex"},"flex-start"===n.alignItems&&{marginTop:8})})),npe=A.forwardRef((function(e,t){const n=sI({props:e,name:"MuiListItemIcon"}),{className:r}=n,s=(0,qe.A)(n,epe),a=A.useContext(FN),i=(0,He.A)({},n,{alignItems:a.alignItems}),o=(e=>{const{alignItems:t,classes:n}=e;return _S({root:["root","flex-start"===t&&"alignItemsFlexStart"]},W_,n)})(i);return(0,st.jsx)(tpe,(0,He.A)({className:Xe(o.root,r),ownerState:i,ref:t},s))})),rpe=WC((0,st.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),spe=WC((0,st.jsx)("path",{d:"M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8zm0-18v6h8V3z"}),"Dashboard"),ape=WC((0,st.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout");function ipe(){var e;const[t,n]=(0,A.useState)(null),[r,s]=(0,A.useState)(null),[a,i]=(0,A.useState)(null),{currentUser:o,userProfile:l,logout:u}=fS(),{notifications:c}=lue(),d=Te(),h=[{title:"Dashboard",path:"/dashboard"},{title:"Notifications",path:"/notifications"},{title:"Profile",path:"/profile"},{title:"Settings",path:"/settings"}],p=()=>{n(null)},f=()=>{s(null)},m=()=>{i(null)},g=c.filter((e=>!e.read)).length;return(0,st.jsx)(zhe,{position:"static",children:(0,st.jsx)(aI,{maxWidth:"xl",children:(0,st.jsxs)(Whe,{disableGutters:!0,children:[(0,st.jsx)(hI,{variant:"h6",noWrap:!0,component:TS,to:"/dashboard",sx:{mr:2,display:{xs:"none",md:"flex"},fontWeight:700,color:"inherit",textDecoration:"none"},children:"BAADI"}),(0,st.jsxs)(qt,{sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:[(0,st.jsx)(PC,{size:"large","aria-label":"navigation menu","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:e=>{n(e.currentTarget)},color:"inherit",children:(0,st.jsx)(rpe,{})}),(0,st.jsx)(lA,{id:"menu-appbar",anchorEl:t,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:Boolean(t),onClose:p,sx:{display:{xs:"block",md:"none"}},children:h.map((e=>(0,st.jsx)(J_,{onClick:()=>{p(),d(e.path)},children:(0,st.jsx)(hI,{textAlign:"center",children:e.title})},e.title)))})]}),(0,st.jsx)(hI,{variant:"h5",noWrap:!0,component:"div",sx:{flexGrow:1,display:{xs:"flex",md:"none"},fontWeight:700},children:"BAADI"}),(0,st.jsx)(qt,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:h.map((e=>(0,st.jsx)(OR,{component:TS,to:e.path,onClick:p,sx:{my:2,color:"white",display:"block"},children:e.title},e.title)))}),(0,st.jsxs)(qt,{sx:{flexGrow:0,display:"flex"},children:[(0,st.jsx)(Vce,{title:"Notifications",children:(0,st.jsx)(PC,{onClick:e=>{i(e.currentTarget)},sx:{mr:1},color:"inherit",children:(0,st.jsx)(Che,{badgeContent:g,color:"error",children:(0,st.jsx)(Ehe,{})})})}),(0,st.jsxs)(lA,{sx:{mt:"45px"},id:"menu-notifications",anchorEl:a,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(a),onClose:m,children:[(0,st.jsx)(hI,{sx:{p:2},children:"Notifications"}),(0,st.jsx)(o$,{}),0===c.length?(0,st.jsx)(J_,{children:(0,st.jsx)(hI,{variant:"body2",children:"No notifications"})}):c.slice(0,5).map((e=>{var t;return(0,st.jsx)(J_,{onClick:m,children:(0,st.jsxs)(qt,{sx:{display:"flex",flexDirection:"column",minWidth:240,maxWidth:300},children:[(0,st.jsx)(hI,{variant:"subtitle2",sx:{fontWeight:e.read?"normal":"bold",color:"critical"===e.severity?"error.main":"text.primary"},children:e.title}),(0,st.jsx)(hI,{variant:"body2",noWrap:!0,children:e.message}),(0,st.jsx)(hI,{variant:"caption",color:"text.secondary",children:(null===(t=e.timestamp)||void 0===t?void 0:t.toLocaleString())||"Just now"})]})},e.id)})),c.length>5&&(0,st.jsx)(qt,{sx:{textAlign:"center",p:1},children:(0,st.jsx)(Zhe,{component:TS,to:"/notifications",onClick:m,underline:"hover",children:"View all notifications"})})]}),(0,st.jsx)(Vce,{title:"Open user menu",children:(0,st.jsx)(PC,{onClick:e=>{s(e.currentTarget)},sx:{p:0,ml:1},children:(0,st.jsx)(ode,{alt:(null===o||void 0===o?void 0:o.displayName)||"User",src:"/static/avatar.jpg",sx:{bgcolor:"primary.main"},children:(null===o||void 0===o||null===(e=o.displayName)||void 0===e?void 0:e.charAt(0))||"U"})})}),(0,st.jsxs)(lA,{sx:{mt:"45px"},id:"menu-appbar",anchorEl:r,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(r),onClose:f,children:[(0,st.jsxs)(qt,{sx:{px:2,py:1},children:[(0,st.jsx)(hI,{variant:"subtitle1",children:null===o||void 0===o?void 0:o.displayName}),(0,st.jsx)(hI,{variant:"body2",color:"text.secondary",children:null===o||void 0===o?void 0:o.email}),(0,st.jsx)(hI,{variant:"caption",color:"text.secondary",children:"primary_caregiver"===(null===l||void 0===l?void 0:l.role)?"Primary Caregiver":"secondary_caregiver"===(null===l||void 0===l?void 0:l.role)?"Secondary Caregiver":"healthcare_professional"===(null===l||void 0===l?void 0:l.role)?"Healthcare Professional":"Family Member"})]}),(0,st.jsx)(o$,{}),(0,st.jsxs)(J_,{onClick:()=>{f(),d("/dashboard")},children:[(0,st.jsx)(npe,{children:(0,st.jsx)(spe,{fontSize:"small"})}),"Dashboard"]}),(0,st.jsxs)(J_,{onClick:()=>{f(),d("/profile")},children:[(0,st.jsx)(npe,{children:(0,st.jsx)(che,{fontSize:"small"})}),"Profile"]}),(0,st.jsxs)(J_,{onClick:()=>{f(),d("/settings")},children:[(0,st.jsx)(npe,{children:(0,st.jsx)(nO,{fontSize:"small"})}),"Settings"]}),(0,st.jsx)(o$,{}),(0,st.jsxs)(J_,{onClick:()=>{f(),(async()=>{try{await u(),d("/login")}catch(e){console.error("Failed to log out",e)}})()},children:[(0,st.jsx)(npe,{children:(0,st.jsx)(ape,{fontSize:"small"})}),"Logout"]})]})]})]})})})}const ope=()=>{var e,t,n;const{userProfile:r,updateUserProfile:s}=fS(),[a,i]=(0,A.useState)((null===r||void 0===r?void 0:r.settings)||{alertSensitivity:"medium",motionThreshold:.5,fallThreshold:.7,notificationPreferences:{email:!0,push:!0,sms:!1}}),[o,l]=(0,A.useState)(!1),[u,c]=(0,A.useState)(""),[d,h]=(0,A.useState)(!1),p=(e,t)=>n=>{i(e?r=>({...r,[e]:{...r[e],[t]:n.target.checked}}):e=>({...e,[t]:n.target.checked}))},f=e=>(t,n)=>{i((t=>({...t,[e]:n})))};return(0,st.jsx)(aI,{maxWidth:"md",children:(0,st.jsxs)(qt,{sx:{mt:4,mb:4},children:[(0,st.jsx)(hI,{variant:"h4",component:"h1",gutterBottom:!0,children:"Settings"}),o&&(0,st.jsx)(rT,{severity:"success",sx:{mb:3},children:"Settings saved successfully!"}),u&&(0,st.jsx)(rT,{severity:"error",sx:{mb:3},children:u}),(0,st.jsxs)(j_,{container:!0,spacing:3,children:[(0,st.jsx)(j_,{item:!0,xs:12,children:(0,st.jsx)(kI,{children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Notification Preferences"}),(0,st.jsx)(o$,{sx:{mb:2}}),(0,st.jsx)(iR,{control:(0,st.jsx)(Z$,{checked:(null===(e=a.notificationPreferences)||void 0===e?void 0:e.email)||!1,onChange:p("notificationPreferences","email")}),label:"Email Notifications"}),(0,st.jsx)(hI,{variant:"body2",color:"text.secondary",sx:{ml:3,mb:2},children:"Receive alerts via email for critical events"}),(0,st.jsx)(iR,{control:(0,st.jsx)(Z$,{checked:(null===(t=a.notificationPreferences)||void 0===t?void 0:t.push)||!1,onChange:p("notificationPreferences","push")}),label:"Push Notifications"}),(0,st.jsx)(hI,{variant:"body2",color:"text.secondary",sx:{ml:3,mb:2},children:"Receive mobile push notifications for immediate alerts"}),(0,st.jsx)(iR,{control:(0,st.jsx)(Z$,{checked:(null===(n=a.notificationPreferences)||void 0===n?void 0:n.sms)||!1,onChange:p("notificationPreferences","sms")}),label:"SMS Notifications"}),(0,st.jsx)(hI,{variant:"body2",color:"text.secondary",sx:{ml:3},children:"Receive text messages for critical alerts"})]})})}),(0,st.jsx)(j_,{item:!0,xs:12,md:6,children:(0,st.jsx)(kI,{sx:{height:"100%"},children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Alert Settings"}),(0,st.jsx)(o$,{sx:{mb:2}}),(0,st.jsx)(hI,{gutterBottom:!0,children:"Motion Threshold"}),(0,st.jsx)(G$,{value:a.motionThreshold||.5,onChange:f("motionThreshold"),step:.1,marks:!0,min:.1,max:1,valueLabelDisplay:"auto",sx:{mb:3}}),(0,st.jsx)(hI,{gutterBottom:!0,children:"Fall Detection Threshold"}),(0,st.jsx)(G$,{value:a.fallThreshold||.7,onChange:f("fallThreshold"),step:.1,marks:!0,min:.1,max:1,valueLabelDisplay:"auto"})]})})}),(0,st.jsx)(j_,{item:!0,xs:12,md:6,children:(0,st.jsx)(kI,{sx:{height:"100%"},children:(0,st.jsxs)(TI,{children:[(0,st.jsx)(hI,{variant:"h6",gutterBottom:!0,children:"Emergency Contacts"}),(0,st.jsx)(o$,{sx:{mb:2}}),(0,st.jsx)(GA,{label:"Primary Emergency Contact",fullWidth:!0,margin:"normal",variant:"outlined",placeholder:"Phone Number",value:a.emergencyContact1||"",onChange:e=>i((t=>({...t,emergencyContact1:e.target.value})))}),(0,st.jsx)(GA,{label:"Secondary Emergency Contact",fullWidth:!0,margin:"normal",variant:"outlined",placeholder:"Phone Number",value:a.emergencyContact2||"",onChange:e=>i((t=>({...t,emergencyContact2:e.target.value})))})]})})}),(0,st.jsx)(j_,{item:!0,xs:12,children:(0,st.jsx)(qt,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,st.jsx)(OR,{variant:"contained",color:"primary",size:"large",onClick:async()=>{try{h(!0),c(""),l(!1),await s({settings:a}),l(!0)}catch(u){console.error("Error saving settings:",u),c("Failed to save settings.")}finally{h(!1)}},disabled:d,children:d?"Saving...":"Save Settings"})})})]})]})})},lpe=()=>(0,st.jsx)(aI,{maxWidth:"md",children:(0,st.jsxs)(qt,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80vh",textAlign:"center"},children:[(0,st.jsx)(hI,{variant:"h1",component:"h1",gutterBottom:!0,children:"404"}),(0,st.jsx)(hI,{variant:"h4",component:"h2",gutterBottom:!0,children:"Page Not Found"}),(0,st.jsx)(hI,{variant:"body1",paragraph:!0,children:"The page you are looking for doesn't exist or has been moved."}),(0,st.jsx)(OR,{component:TS,to:"/",variant:"contained",color:"primary",size:"large",children:"Back to Home"})]})});const upe=function(){const{currentUser:e,loading:t}=fS();return t?(0,st.jsx)(qt,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:"Loading..."}):(0,st.jsxs)("div",{className:"app-container",children:[e&&(0,st.jsx)(ipe,{}),(0,st.jsx)("div",{className:"main-content",children:(0,st.jsxs)(We,{children:[(0,st.jsx)(Ue,{path:"/",element:e?(0,st.jsx)(je,{to:"/dashboard",replace:!0}):(0,st.jsx)(XR,{})}),(0,st.jsx)(Ue,{path:"/login",element:(0,st.jsx)(XR,{})}),(0,st.jsx)(Ue,{path:"/register",element:(0,st.jsx)(t$,{})}),(0,st.jsx)(Ue,{path:"/forgot-password",element:(0,st.jsx)(n$,{})}),(0,st.jsx)(Ue,{path:"/dashboard",element:(0,st.jsx)(gS,{children:(0,st.jsx)(Zce,{})})}),(0,st.jsx)(Ue,{path:"/profile",element:(0,st.jsx)(gS,{children:(0,st.jsx)(mhe,{})})}),(0,st.jsx)(Ue,{path:"/notifications",element:(0,st.jsx)(gS,{children:(0,st.jsx)(Dhe,{})})}),(0,st.jsx)(Ue,{path:"/settings",element:(0,st.jsx)(gS,{children:(0,st.jsx)(ope,{})})}),(0,st.jsx)(Ue,{path:"*",element:(0,st.jsx)(lpe,{})})]})})]})},cpe=e=>{e&&e instanceof Function&&n.e(488).then(n.bind(n,2488)).then((t=>{let{getCLS:n,getFID:r,getFCP:s,getLCP:a,getTTFB:i}=t;n(e),r(e),s(e),a(e),i(e)}))};const dpe=A.createContext(null);function hpe(){return A.useContext(dpe)}const ppe="function"===typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__";const fpe=function(e){const{children:t,theme:n}=e,r=hpe(),s=A.useMemo((()=>{const e=null===r?n:function(e,t){if("function"===typeof t)return t(e);return(0,He.A)({},e,t)}(r,n);return null!=e&&(e[ppe]=null!==r),e}),[n,r]);return(0,st.jsx)(dpe.Provider,{value:s,children:t})},mpe={};function gpe(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return A.useMemo((()=>{const s=e&&t[e]||t;if("function"===typeof n){const a=n(s),i=e?(0,He.A)({},t,{[e]:a}):a;return r?()=>i:i}return e?(0,He.A)({},t,{[e]:n}):(0,He.A)({},t,n)}),[e,t,n,r])}const ype=function(e){const{children:t,theme:n,themeId:r}=e,s=tt(mpe),a=hpe()||mpe,i=gpe(r,s,n),o=gpe(r,a,n,!0),l="rtl"===i.direction;return(0,st.jsx)(fpe,{theme:o,children:(0,st.jsx)(et.T.Provider,{value:i,children:(0,st.jsx)(ON,{value:l,children:(0,st.jsx)(rI,{value:null==i?void 0:i.components,children:t})})})})},vpe=["theme"];function bpe(e){let{theme:t}=e,n=(0,qe.A)(e,vpe);const r=t[jt];let s=r||t;return"function"!==typeof t&&(r&&!r.vars?s=(0,He.A)({},r,{vars:null}):t&&!t.vars&&(s=(0,He.A)({},t,{vars:null}))),(0,st.jsx)(ype,(0,He.A)({},n,{themeId:r?jt:void 0,theme:s}))}const xpe=(e,t)=>(0,He.A)({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},t&&!e.vars&&{colorScheme:e.palette.mode}),wpe=e=>(0,He.A)({color:(e.vars||e).palette.text.primary},e.typography.body1,{backgroundColor:(e.vars||e).palette.background.default,"@media print":{backgroundColor:(e.vars||e).palette.common.white}});const kpe=function(e){const t=sI({props:e,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=t;return(0,st.jsxs)(A.Fragment,{children:[(0,st.jsx)(wT,{styles:e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n;const r={};t&&e.colorSchemes&&Object.entries(e.colorSchemes).forEach((t=>{let[n,s]=t;var a;r[e.getColorSchemeSelector(n).replace(/\s*&/,"")]={colorScheme:null==(a=s.palette)?void 0:a.mode}}));let s=(0,He.A)({html:xpe(e,t),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:(0,He.A)({margin:0},wpe(e),{"&::backdrop":{backgroundColor:(e.vars||e).palette.background.default}})},r);const a=null==(n=e.components)||null==(n=n.MuiCssBaseline)?void 0:n.styleOverrides;return a&&(s=[s,a]),s}(e,r)}),n]})},Spe=Bt({palette:{primary:{main:"#2196f3",light:"#64b5f6",dark:"#0d47a1",contrastText:"#ffffff"},secondary:{main:"#f50057",light:"#ff4081",dark:"#c51162",contrastText:"#ffffff"},error:{main:"#f44336",light:"#e57373",dark:"#d32f2f"},warning:{main:"#ff9800",light:"#ffb74d",dark:"#f57c00"},info:{main:"#2196f3",light:"#64b5f6",dark:"#1976d2"},success:{main:"#4caf50",light:"#81c784",dark:"#388e3c"},background:{default:"#f5f5f5",paper:"#ffffff"}},typography:{fontFamily:["Roboto",'"Helvetica Neue"',"Arial","sans-serif"].join(","),h1:{fontSize:"2.5rem",fontWeight:500},h2:{fontSize:"2rem",fontWeight:500},h3:{fontSize:"1.75rem",fontWeight:500},h4:{fontSize:"1.5rem",fontWeight:500},h5:{fontSize:"1.25rem",fontWeight:500},h6:{fontSize:"1rem",fontWeight:500}},shape:{borderRadius:8},components:{MuiButton:{styleOverrides:{root:{textTransform:"none",borderRadius:8,padding:"8px 16px"},contained:{boxShadow:"none","&:hover":{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"}}}},MuiPaper:{styleOverrides:{root:{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)"},elevation1:{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)"},elevation2:{boxShadow:"0 3px 6px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.12)"},elevation3:{boxShadow:"0 10px 20px rgba(0, 0, 0, 0.15), 0 3px 6px rgba(0, 0, 0, 0.10)"},elevation4:{boxShadow:"0 15px 25px rgba(0, 0, 0, 0.15), 0 5px 10px rgba(0, 0, 0, 0.05)"}}},MuiAppBar:{styleOverrides:{root:{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)"}}},MuiCard:{styleOverrides:{root:{borderRadius:12,boxShadow:"0 3px 6px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.12)"}}}}});_.createRoot(document.getElementById("root")).render((0,st.jsx)(A.StrictMode,{children:(0,st.jsx)(SS,{children:(0,st.jsxs)(bpe,{theme:Spe,children:[(0,st.jsx)(kpe,{}),(0,st.jsx)(mS,{children:(0,st.jsx)(uue,{children:(0,st.jsx)(upe,{})})})]})})})),cpe()})()})();
//# sourceMappingURL=main.35b0eee8.js.map